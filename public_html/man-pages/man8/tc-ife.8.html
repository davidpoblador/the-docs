<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>tc-ife: Encapsulate/decapsulate metadata</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Encapsulate/decapsulate metadata">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">tc-ife<small> (8)</small></h1>
        <p class="lead">Encapsulate/decapsulate metadata</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/tc-ife.8.html">
      <span itemprop="name">tc-ife: Encapsulate/decapsulate metadata</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/iproute2/">
      <span itemprop="name">iproute2</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/tc-ife.8.html">
      <span itemprop="name">tc-ife: Encapsulate/decapsulate metadata</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>tc</strong> ... <strong>action</strong>ife" <em>DIRECTION ACTION</em> [ <strong>dst</strong> <em>DMAC</em> ]  [ <strong>src</strong> <em>SMAC</em> ]  [ <strong>type</strong> <em>TYPE</em> ]  [  <em>CONTROL</em> ]  [ <strong>index</strong> <em>INDEX</em> ] </p><p><em>DIRECTION</em> := {  <strong>decode</strong> | <strong>encode</strong> }</p><p><em>ACTION</em> := {  <strong>allow</strong> | <strong>use</strong> }</p><p><em>CONTROL</em> := {  <strong>reclassify</strong> | <strong>use</strong> | <strong>pipe</strong> | <strong>drop</strong> | <strong>continue</strong> | <strong>ok</strong> }</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <strong>ife</strong> action allows for a sending side to encapsulate arbitrary metadata, which is then decapsulated by the receiving end. The sender runs in encoding mode and the receiver in decode mode. Both sender and receiver must specify the same ethertype. In the future, a registered ethertype may be available as a default.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>decode</strong></p>
  </dt>
  <dd>
    <p>For the receiving side; decode the metadata if the packet matches.</p>
  </dd>
  <dt>
    <p><strong>encode</strong></p>
  </dt>
  <dd>
    <p>For the sending side. Encode the specified metadata if the packet matches.</p>
  </dd>
  <dt>
    <p><strong>allow</strong></p>
  </dt>
  <dd>
    <p>Encode direction only. Allows encoding specified metadata.</p>
  </dd>
  <dt>
    <p><strong>use</strong></p>
  </dt>
  <dd>
    <p>Encode direction only. Enforce static encoding of specified metadata.</p>
  </dd>
  <dt>
    <p><strong>dmac</strong><em></em> <em>DMAC</em> <strong>smac</strong><em></em> <em>SMAC</em></p>
  </dt>
  <dd>
    <p>Optional six byte destination or source MAC address to encode.</p>
  </dd>
  <dt>
    <p><strong>type</strong><em></em> <em>TYPE</em></p>
  </dt>
  <dd>
    <p>Optional 16-bit ethertype to encode.</p>
  </dd>
  <dt>
    <p><strong>CONTROL</strong></p>
  </dt>
  <dd>
    <p>Action to take following an encode/decode.</p>
  </dd>
  <dt>
    <p><strong>index</strong><em></em> <em>INDEX</em></p>
  </dt>
  <dd>
    <p>Assign a unique ID to this action instead of letting the kernel choose one automatically. <em>INDEX</em> is a 32bit unsigned integer greater than zero.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>On the receiving side, match packets with ethertype 0xdead and restart classification so that it will match ICMP on the next rule, at prio 3:</p>
<pre>
# tc qdisc add dev eth0 handle ffff: ingress
# tc filter add dev eth0 parent ffff: prio 2 protocol 0xdead &#92;
	u32 match u32 0 0 flowid 1:1 &#92;
	action ife decode reclassify
# tc filter add dev eth0 parent ffff: priod 3 protocol ip &#92;
	u32 match ip protocol 0xff flowid 1:1 &#92;
	action continue
</pre>
<p>Match with skb mark of 17:</p>
<pre>
# tc filter add dev eth0 parent ffff: prio 4 protocol ip &#92;
	handle 0x11 fw flowid 1:1 &#92;
	action ok
</pre>
<p>Configure the sending side to encode for the filters above. Use a destination IP address of 192.168.122.237/24, then tag with skb mark of decimal 17. Encode the packaet with ethertype 0xdead, add skb-&gt;mark to whitelist of metadatum to send, and rewrite the destination MAC address to 02:15:15:15:15:15.</p>
<pre>
# tc qdisc add dev eth0 root handle 1: prio
# tc filter add dev eth0 parent 1: protocol ip prio 10 u32 &#92;
	match ip dst 192.168.122.237/24 &#92;
	match ip protocol 1 0xff &#92;
	flowid 1:2 &#92;
	action skbedit mark 17 &#92;
	action ife encode &#92;
	type 0xDEAD &#92;
	allow mark &#92;
	dst 02:15:15:15:15:15
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO tc-ife&hellip;</h2>
        <div class="sectioncontent">
<p><strong>tc</strong>(8), <a href="../man8/tc-u32.8.html"><strong>tc-u32</strong>(8)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="tc-htb.8.html"><span aria-hidden="true">&larr;</span> tc-htb.8: Hierarchy token bucket</a></li>
   <li class="next"><a href="tc-mirred.8.html">tc-mirred.8: Mirror/redirect action <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
