<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>fstrim: Discard unused blocks on a mounted filesystem</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Discard unused blocks on a mounted filesystem">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">fstrim<small> (8)</small></h1>
        <p class="lead">Discard unused blocks on a mounted filesystem</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/fstrim.8.html">
      <span itemprop="name">fstrim: Discard unused blocks on a mounted filesystem</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/util-linux/">
      <span itemprop="name">util-linux</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/fstrim.8.html">
      <span itemprop="name">fstrim: Discard unused blocks on a mounted filesystem</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p><strong>fstrim</strong> [<strong>-a</strong>] [<strong>-o</strong> <em>offset</em>] [<strong>-l</strong> <em>length</em>] [<strong>-m</strong> <em>minimum-size</em>] [<strong>-v</strong>] <em>mountpoint</em></p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p><strong>fstrim</strong> is used on a mounted filesystem to discard (or "trim") blocks which are not in use by the filesystem.  This is useful for solid-state drives (SSDs) and thinly-provisioned storage.</p>
<p class='spacer'>

<p>By default, <strong>fstrim</strong> will discard all unused blocks in the filesystem.  Options may be used to modify this behavior based on range or size, as explained below.</p>
<p class='spacer'>

<p>The <em>mountpoint</em> argument is the pathname of the directory where the filesystem is mounted.</p>
<p class='spacer'>

<p>Running <strong>fstrim</strong> frequently, or even using <strong>mount -o discard</strong>, might negatively affect the lifetime of poor-quality SSD devices.  For most desktop and server systems a sufficient trimming frequency is once a week. Note that not all devices support a queued trim, so each trim command incurs a performance penalty on whatever else might be trying to use the disk at the time.</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<p>The <em>offset</em>, <em>length</em>, and <em>minimum-size</em> arguments may be followed by the multiplicative suffixes KiB (=1024), MiB (=1024*1024), and so on for GiB, TiB, PiB, EiB, ZiB and YiB (the "iB" is optional, e.g., "K" has the same meaning as "KiB") or the suffixes KB (=1000), MB (=1000*1000), and so on for GB, TB, PB, EB, ZB and YB.</p>
<p class='spacer'>

  <dl class='dl-horizontal'>
    <dt><strong>-a, --all</strong></dt>
    <dd>
  <p>Trim all mounted filesystems on devices that support the discard operation. The other supplied options, like <strong>--offset</strong>, <strong>--length</strong> and <strong>--minimum</strong>, are applied to all these devices. Errors from filesystems that do not support the discard operation are silently ignored.</p>
    </dd>
    <dt><strong>-o, --offset</strong> <em>offset</em></dt>
    <dd>
  <p>Byte offset in the filesystem from which to begin searching for free blocks to discard.  The default value is zero, starting at the beginning of the filesystem.</p>
    </dd>
    <dt><strong>-l, --length</strong> <em>length</em></dt>
    <dd>
  <p>The number of bytes (after the starting point) to search for free blocks to discard.  If the specified value extends past the end of the filesystem, <strong>fstrim</strong> will stop at the filesystem size boundary.  The default value extends to the end of the filesystem.</p>
    </dd>
    <dt><strong>-m, --minimum</strong> <em>minimum-size</em></dt>
    <dd>
  <p>Minimum contiguous free range to discard, in bytes. (This value is internally rounded up to a multiple of the filesystem block size.)  Free ranges smaller than this will be ignored.  By increasing this value, the fstrim operation will complete more quickly for filesystems with badly fragmented freespace, although not all blocks will be discarded.  The default value is zero, discarding every free block.</p>
    </dd>
    <dt><strong>-v, --verbose</strong></dt>
    <dd>
  <p>Verbose execution.  With this option <strong>fstrim</strong> will output the number of bytes passed from the filesystem down the block stack to the device for potential discard.  This number is a maximum discard amount from the storage device's perspective, because <em>FITRIM</em> ioctl called repeated will keep sending the same sectors for discard repeatedly.</p>
<p class='spacer'>

    <p><strong>fstrim</strong> will report the same potential discard bytes each time, but only sectors which had been written to between the discards would actually be discarded by the storage device.  Further, the kernel block layer reserves the right to adjust the discard ranges to fit raid stripe geometry, non-trim capable devices in a LVM setup, etc.  These reductions would not be reflected in fstrim_range.len (the <strong>--length</strong> option).</p>
    <dl class='dl-vertical'>
      <dt><strong>-V</strong>,<strong> --version</strong></dt>
      <dd>
    <p>Display version information and exit.</p>
      </dd>
      <dt><strong>-h</strong>,<strong> --help</strong></dt>
      <dd>
    <p>Display help text and exit.</p>
<p class='spacer'>

      </dd>
    </dl>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN CODES</h2>
        <div class="sectioncontent">

  <dl class='dl-horizontal'>
    <dt>0</dt>
    <dd>
  <p>success</p>
    </dd>
    <dt>1</dt>
    <dd>
  <p>failure</p>
    </dd>
    <dt>32</dt>
    <dd>
  <p>all failed</p>
    </dd>
    <dt>64</dt>
    <dd>
  <p>some filesystem discards have succeeded, some failed</p>
    </dd>
  </dl>
<p class='spacer'>

<p>The command <strong>fstrim --all</strong> returns 0 (all succeeded), 32 (all failed) or 64 (some failed, some succeeded).</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">

<pre>Lukas Czerner &lt;lczerner@redhat.com&gt;
Karel Zak &lt;kzak@redhat.com&gt;</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AVAILABILITY</h2>
        <div class="sectioncontent">

<p>The fstrim command is part of the util-linux package and is available from ftp://ftp.kernel.org/pub/linux/utils/util-linux/.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO fstrim&hellip;</h2>
        <div class="sectioncontent">

<p><a href="../man8/mount.8.html"><strong>mount</strong>(8)</a>, <a href="../man8/blkdiscard.8.html"><strong>blkdiscard</strong>(8)</a></p>
        </div>
      </section>

<nav>
  <ul class="pager">
   <li class="previous"><a href="fsfreeze.8.html"><span aria-hidden="true">&larr;</span> fsfreeze.8: Suspend access to a filesystem (ext3/4, reiserfs, jfs, xfs)</a></li>
   <li class="next"><a href="genhomedircon.8.html">genhomedircon.8: Generate selinux file context configuration entries for user home directories <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
