<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ip-xfrm: Transform configuration</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Transform configuration">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="ip-xfrm (8) manual">
  <meta name="twitter:description" content="Transform configuration">
  <meta name="twitter:image" content="https://www.carta.tech/images/iproute2-ip-xfrm-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/ip-xfrm.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ip-xfrm (8) manual" />
  <meta property="og:description" content="Transform configuration" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/iproute2-ip-xfrm-8.png" />

</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">ip-xfrm<small> (8)</small></h1>
        <p class="lead">Transform configuration</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/ip-xfrm.8.html">
      <span itemprop="name">ip-xfrm: Transform configuration</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/iproute2/">
      <span itemprop="name">iproute2</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/ip-xfrm.8.html">
      <span itemprop="name">ip-xfrm: Transform configuration</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>ip</strong> [ <em>OPTIONS</em> ] <strong>xfrm</strong>  { <em>COMMAND</em> |  <strong>help</strong> }</p><p><strong>ip xfrm</strong> <em>XFRM-OBJECT</em> { <em>COMMAND</em> |  <strong>help</strong> }</p><p><em>XFRM-OBJECT</em> := <strong>state</strong> | <strong>policy</strong> | <strong>monitor</strong></p><p><strong>ip xfrm state</strong> { <strong>add</strong> | <strong>update</strong> }  <em>ID</em> [ <em>ALGO-LIST</em> ] [ <strong>mode</strong> <em>MODE</em> ] [ <strong>mark</strong> <em>MARK</em> [ <strong>mask</strong> <em>MASK</em> ] ] [ <strong>reqid</strong> <em>REQID</em> ] [ <strong>seq</strong> <em>SEQ</em> ] [ <strong>replay-window</strong> <em>SIZE</em> ] [ <strong>replay-seq</strong> <em>SEQ</em> ] [ <strong>replay-oseq</strong> <em>SEQ</em> ] [ <strong>replay-seq-hi</strong> <em>SEQ</em> ] [ <strong>replay-oseq-hi</strong> <em>SEQ</em> ] [ <strong>flag</strong> <em>FLAG-LIST</em> ] [ <strong>sel</strong> <em>SELECTOR</em> ] [ <em>LIMIT-LIST</em> ] [ <strong>encap</strong> <em>ENCAP</em> ] [ <strong>coa</strong> <em>ADDR</em>[/<em>PLEN</em>] ] [ <strong>ctx</strong> <em>CTX</em> ] [ <strong>extra-flag</strong> <em>EXTRA-FLAG-LIST</em> ]</p><p><strong>ip xfrm state allocspi</strong> <em>ID</em> [ <strong>mode</strong> <em>MODE</em> ] [ <strong>mark</strong> <em>MARK</em> [ <strong>mask</strong> <em>MASK</em> ] ] [ <strong>reqid</strong> <em>REQID</em> ] [ <strong>seq</strong> <em>SEQ</em> ] [ <strong>min</strong> <em>SPI</em> <strong>max</strong> <em>SPI</em> ]</p><p><strong>ip xfrm state</strong> { <strong>delete</strong> | <strong>get</strong> }  <em>ID</em> [ <strong>mark</strong> <em>MARK</em> [ <strong>mask</strong> <em>MASK</em> ] ]</p><p><strong>ip xfrm state</strong> { <strong>deleteall</strong> | <strong>list</strong> } [ <em>ID</em> ] [ <strong>mode</strong> <em>MODE</em> ] [ <strong>reqid</strong> <em>REQID</em> ] [ <strong>flag</strong> <em>FLAG-LIST</em> ]</p><p><strong>ip xfrm state flush</strong> [ <strong>proto</strong> <em>XFRM-PROTO</em> ]</p><p><strong>ip xfrm state count</strong></p><p><em>ID</em> := [ <strong>src</strong> <em>ADDR</em> ] [ <strong>dst</strong> <em>ADDR</em> ] [ <strong>proto</strong> <em>XFRM-PROTO</em> ] [ <strong>spi</strong> <em>SPI</em> ]</p><p><em>XFRM-PROTO</em> := <strong>esp</strong> | <strong>ah</strong> | <strong>comp</strong> | <strong>route2</strong> | <strong>hao</strong></p><p><em>ALGO-LIST</em> := [ <em>ALGO-LIST</em> ] <em>ALGO</em></p><p><em>ALGO</em> := { <strong>enc</strong> | <strong>auth</strong> }  <em>ALGO-NAME</em> <em>ALGO-KEYMAT</em> |</p><p><strong>auth-trunc</strong> <em>ALGO-NAME</em> <em>ALGO-KEYMAT</em> <em>ALGO-TRUNC-LEN</em> |</p><p><strong>aead</strong> <em>ALGO-NAME</em> <em>ALGO-KEYMAT</em> <em>ALGO-ICV-LEN</em> |</p><p><strong>comp</strong> <em>ALGO-NAME</em></p><p><em>MODE</em> :=  <strong>transport</strong> | <strong>tunnel</strong> | <strong>beet</strong> | <strong>ro</strong> | <strong>in_trigger</strong></p><p><em>FLAG-LIST</em> := [ <em>FLAG-LIST</em> ] <em>FLAG</em></p><p><em>FLAG</em> := <strong>noecn</strong> | <strong>decap-dscp</strong> | <strong>nopmtudisc</strong> | <strong>wildrecv</strong> | <strong>icmp</strong> |  <strong>af-unspec</strong> | <strong>align4</strong> | <strong>esn</strong></p><p><em>SELECTOR</em> := [ <strong>src</strong> <em>ADDR</em>[/<em>PLEN</em>] ] [ <strong>dst</strong> <em>ADDR</em>[/<em>PLEN</em>] ] [ <strong>dev</strong> <em>DEV</em> ]</p><p>[ <em>UPSPEC</em> ]</p><p><em>UPSPEC</em> :=  <strong>proto</strong> { <em>PROTO</em> |</p><p>{ <strong>tcp</strong> | <strong>udp</strong> | <strong>sctp</strong> | <strong>dccp</strong> } [ <strong>sport</strong> <em>PORT</em> ] [ <strong>dport</strong> <em>PORT</em> ] |</p><p>{ <strong>icmp</strong> | <strong>ipv6-icmp</strong> | <strong>mobility-header</strong> } [ <strong>type</strong> <em>NUMBER</em> ] [ <strong>code</strong> <em>NUMBER</em> ] |</p><p><strong>gre</strong> [ <strong>key</strong> { <em>DOTTED-QUAD</em> | <em>NUMBER</em> } ] }</p><p><em>LIMIT-LIST</em> := [ <em>LIMIT-LIST</em> ] <strong>limit</strong> <em>LIMIT</em></p><p><em>LIMIT</em> := { <strong>time-soft</strong> | <strong>time-hard</strong> | <strong>time-use-soft</strong> | <strong>time-use-hard</strong> } <em>SECONDS</em> |</p><p>{ <strong>byte-soft</strong> | <strong>byte-hard</strong> } <em>SIZE</em> |</p><p>{ <strong>packet-soft</strong> | <strong>packet-hard</strong> } <em>COUNT</em></p><p><em>ENCAP</em> := { <strong>espinudp</strong> | <strong>espinudp-nonike</strong> } <em>SPORT</em> <em>DPORT</em> <em>OADDR</em></p><p><em>EXTRA-FLAG-LIST</em> := [ <em>EXTRA-FLAG-LIST</em> ] <em>EXTRA-FLAG</em></p><p><em>EXTRA-FLAG</em> :=  <strong>dont-encap-dscp</strong></p><p><strong>ip xfrm policy</strong> { <strong>add</strong> | <strong>update</strong> } <em>SELECTOR</em> <strong>dir</strong> <em>DIR</em> [ <strong>ctx</strong> <em>CTX</em> ] [ <strong>mark</strong> <em>MARK</em> [ <strong>mask</strong> <em>MASK</em> ] ] [ <strong>index</strong> <em>INDEX</em> ] [ <strong>ptype</strong> <em>PTYPE</em> ] [ <strong>action</strong> <em>ACTION</em> ] [ <strong>priority</strong> <em>PRIORITY</em> ] [ <strong>flag</strong> <em>FLAG-LIST</em> ] [ <em>LIMIT-LIST</em> ] [ <em>TMPL-LIST</em> ]</p><p><strong>ip xfrm policy</strong> { <strong>delete</strong> | <strong>get</strong> } { <em>SELECTOR</em> |  <strong>index</strong> <em>INDEX</em> } <strong>dir</strong> <em>DIR</em> [ <strong>ctx</strong> <em>CTX</em> ] [ <strong>mark</strong> <em>MARK</em> [ <strong>mask</strong> <em>MASK</em> ] ] [ <strong>ptype</strong> <em>PTYPE</em> ]</p><p><strong>ip xfrm policy</strong> { <strong>deleteall</strong> | <strong>list</strong> } [ <em>SELECTOR</em> ] [ <strong>dir</strong> <em>DIR</em> ] [ <strong>index</strong> <em>INDEX</em> ] [ <strong>ptype</strong> <em>PTYPE</em> ] [ <strong>action</strong> <em>ACTION</em> ] [ <strong>priority</strong> <em>PRIORITY</em> ] [ <strong>flag</strong> <em>FLAG-LIST</em>]</p><p><strong>ip xfrm policy flush</strong> [ <strong>ptype</strong> <em>PTYPE</em> ]</p><p><strong>ip xfrm policy count</strong></p><p><strong>ip xfrm policy set</strong> [ <strong>hthresh4</strong> <em>LBITS</em> <em>RBITS</em> ] [ <strong>hthresh6</strong> <em>LBITS</em> <em>RBITS</em> ]</p><p><em>SELECTOR</em> := [ <strong>src</strong> <em>ADDR</em>[/<em>PLEN</em>] ] [ <strong>dst</strong> <em>ADDR</em>[/<em>PLEN</em>] ] [ <strong>dev</strong> <em>DEV</em> ] [ <em>UPSPEC</em> ]</p><p><em>UPSPEC</em> :=  <strong>proto</strong> { <em>PROTO</em> |</p><p>{ <strong>tcp</strong> | <strong>udp</strong> | <strong>sctp</strong> | <strong>dccp</strong> } [ <strong>sport</strong> <em>PORT</em> ] [ <strong>dport</strong> <em>PORT</em> ] |</p><p>{ <strong>icmp</strong> | <strong>ipv6-icmp</strong> | <strong>mobility-header</strong> } [ <strong>type</strong> <em>NUMBER</em> ] [ <strong>code</strong> <em>NUMBER</em> ] |</p><p><strong>gre</strong> [ <strong>key</strong> { <em>DOTTED-QUAD</em> | <em>NUMBER</em> } ] }</p><p><em>DIR</em> :=  <strong>in</strong> | <strong>out</strong> | <strong>fwd</strong></p><p><em>PTYPE</em> :=  <strong>main</strong> | <strong>sub</strong></p><p><em>ACTION</em> :=  <strong>allow</strong> | <strong>block</strong></p><p><em>FLAG-LIST</em> := [ <em>FLAG-LIST</em> ] <em>FLAG</em></p><p><em>FLAG</em> := <strong>localok</strong> | <strong>icmp</strong></p><p><em>LIMIT-LIST</em> := [ <em>LIMIT-LIST</em> ] <strong>limit</strong> <em>LIMIT</em></p><p><em>LIMIT</em> := { <strong>time-soft</strong> | <strong>time-hard</strong> | <strong>time-use-soft</strong> | <strong>time-use-hard</strong> } <em>SECONDS</em> |</p><p>{ <strong>byte-soft</strong> | <strong>byte-hard</strong> } <em>SIZE</em> |</p><p>{ <strong>packet-soft</strong> | <strong>packet-hard</strong> } <em>COUNT</em></p><p><em>TMPL-LIST</em> := [ <em>TMPL-LIST</em> ] <strong>tmpl</strong> <em>TMPL</em></p><p><em>TMPL</em> := <em>ID</em> [ <strong>mode</strong> <em>MODE</em> ] [ <strong>reqid</strong> <em>REQID</em> ] [ <strong>level</strong> <em>LEVEL</em> ]</p><p><em>ID</em> := [ <strong>src</strong> <em>ADDR</em> ] [ <strong>dst</strong> <em>ADDR</em> ] [ <strong>proto</strong> <em>XFRM-PROTO</em> ] [ <strong>spi</strong> <em>SPI</em> ]</p><p><em>XFRM-PROTO</em> := <strong>esp</strong> | <strong>ah</strong> | <strong>comp</strong> | <strong>route2</strong> | <strong>hao</strong></p><p><em>MODE</em> :=  <strong>transport</strong> | <strong>tunnel</strong> | <strong>beet</strong> | <strong>ro</strong> | <strong>in_trigger</strong></p><p><em>LEVEL</em> := <strong>required</strong> | <strong>use</strong></p><p><strong>ip xfrm monitor</strong> [ <strong>all-nsid</strong> ] [ <strong>all</strong>  | <em>LISTofXFRM-OBJECTS</em> ]</p><p><em>LISTofXFRM-OBJECTS</em> := [ <em>LISTofXFRM-OBJECTS</em> ] <em>XFRM-OBJECT</em></p><p><em>XFRM-OBJECT</em> :=  <strong>acquire</strong> | <strong>expire</strong> | <strong>SA</strong> | <strong>policy</strong> | <strong>aevent</strong> | <strong>report</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>xfrm is an IP framework for transforming packets (such as encrypting their payloads). This framework is used to implement the IPsec protocol suite (with the <strong>state</strong> object operating on the Security Association Database, and the <strong>policy</strong> object operating on the Security Policy Database). It is also used for the IP Payload Compression Protocol and features of Mobile IPv6.</p><table class="table table-striped">
<tr>
<th>ip xfrm state add</th>
<th>add new state into xfrm</th></tr>

<tr>
<td>ip xfrm state update</td>
<td>update existing state in xfrm</td></tr>

<tr>
<td>ip xfrm state allocspi</td>
<td>allocate an SPI value</td></tr>

<tr>
<td>ip xfrm state delete</td>
<td>delete existing state in xfrm</td></tr>

<tr>
<td>ip xfrm state get</td>
<td>get existing state in xfrm</td></tr>

<tr>
<td>ip xfrm state deleteall</td>
<td>delete all existing state in xfrm</td></tr>

<tr>
<td>ip xfrm state list</td>
<td>print out the list of existing state in xfrm</td></tr>

<tr>
<td>ip xfrm state flush</td>
<td>flush all state in xfrm</td></tr>

<tr>
<td>ip xfrm state count</td>
<td>count all existing state in xfrm</td></tr>
</table>
<dl class='dl-vertical'>
  <dt>
    <p><em>ID</em></p>
  </dt>
  <dd>
    <p>is specified by a source address, destination address, transform protocol <em>XFRM-PROTO</em>, and/or Security Parameter Index <em>SPI</em>. (For IP Payload Compression, the Compression Parameter Index or CPI is used for <em>SPI</em>.)</p>
  </dd>
  <dt>
    <p><em>XFRM-PROTO</em></p>
  </dt>
  <dd>
    <p>specifies a transform protocol: IPsec Encapsulating Security Payload (<strong>esp</strong>), IPsec Authentication Header (<strong>ah</strong>), IP Payload Compression (<strong>comp</strong>), Mobile IPv6 Type 2 Routing Header (<strong>route2</strong>), or Mobile IPv6 Home Address Option (<strong>hao</strong>).</p>
  </dd>
  <dt>
    <p><em>ALGO-LIST</em></p>
  </dt>
  <dd>
    <p>contains one or more algorithms to use. Each algorithm <em>ALGO</em> is specified by:</p>
<dl class='dl-vertical'>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>the algorithm type: encryption (<strong>enc</strong>), authentication (<strong>auth</strong> or <strong>auth-trunc</strong>), authenticated encryption with associated data (<strong>aead</strong>), or compression (<strong>comp</strong>)</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>the algorithm name <em>ALGO-NAME</em> (see below)</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>(for all except <strong>comp</strong>) the keying material <em>ALGO-KEYMAT</em>, which may include both a key and a salt or nonce value; refer to the corresponding RFC</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>(for <strong>auth-trunc</strong> only) the truncation length <em>ALGO-TRUNC-LEN</em> in bits</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>(for <strong>aead</strong> only) the Integrity Check Value length <em>ALGO-ICV-LEN</em> in bits</p>
  </dd>

</dl>
<p>Encryption algorithms include <strong>ecb(cipher_null)</strong>, <strong>cbc(des)</strong>, <strong>cbc(des3_ede)</strong>, <strong>cbc(cast5)</strong>, <strong>cbc(blowfish)</strong>, <strong>cbc(aes)</strong>, <strong>cbc(serpent)</strong>, <strong>cbc(camellia)</strong>, <strong>cbc(twofish)</strong>, and <strong>rfc3686(ctr(aes))</strong>.</p><p>Authentication algorithms include <strong>digest_null</strong>, <strong>hmac(md5)</strong>, <strong>hmac(sha1)</strong>, <strong>hmac(sha256)</strong>, <strong>hmac(sha384)</strong>, <strong>hmac(sha512)</strong>, <strong>hmac(rmd610)</strong>, and <strong>xcbc(aes)</strong>.</p><p>Authenticated encryption with associated data (AEAD) algorithms include <strong>rfc4106(gcm(aes))</strong>, <strong>rfc4309(ccm(aes))</strong>, and <strong>rfc4543(gcm(aes))</strong>.</p><p>Compression algorithms include <strong>deflate</strong>, <strong>lzs</strong>, and <strong>lzjh</strong>.</p>
  </dd>
  <dt>
    <p><em>MODE</em></p>
  </dt>
  <dd>
    <p>specifies a mode of operation for the transform protocol. IPsec and IP Payload Compression modes are <strong>transport</strong>, <strong>tunnel</strong>, and (for IPsec ESP only) Bound End-to-End Tunnel (<strong>beet</strong>). Mobile IPv6 modes are route optimization (<strong>ro</strong>) and inbound trigger (<strong>in_trigger</strong>).</p>
  </dd>
  <dt>
    <p><em>FLAG-LIST</em></p>
  </dt>
  <dd>
    <p>contains one or more of the following optional flags: <strong>noecn</strong>, <strong>decap-dscp</strong>, <strong>nopmtudisc</strong>, <strong>wildrecv</strong>, <strong>icmp</strong>,  <strong>af-unspec</strong>, <strong>align4</strong>, or <strong>esn</strong>.</p>
  </dd>
  <dt>
    <p><em>SELECTOR</em></p>
  </dt>
  <dd>
    <p>selects the traffic that will be controlled by the policy, based on the source address, the destination address, the network device, and/or <em>UPSPEC</em>.</p>
  </dd>
  <dt>
    <p><em>UPSPEC</em></p>
  </dt>
  <dd>
    <p>selects traffic by protocol. For the <strong>tcp</strong>, <strong>udp</strong>, <strong>sctp</strong>, or <strong>dccp</strong> protocols, the source and destination port can optionally be specified. For the <strong>icmp</strong>, <strong>ipv6-icmp</strong>, or <strong>mobility-header</strong> protocols, the type and code numbers can optionally be specified. For the <strong>gre</strong> protocol, the key can optionally be specified as a dotted-quad or number. Other protocols can be selected by name or number <em>PROTO</em>.</p>
  </dd>
  <dt>
    <p><em>LIMIT-LIST</em></p>
  </dt>
  <dd>
    <p>sets limits in seconds, bytes, or numbers of packets.</p>
  </dd>
  <dt>
    <p><em>ENCAP</em></p>
  </dt>
  <dd>
    <p>encapsulates packets with protocol <strong>espinudp</strong> or <strong>espinudp-nonike</strong>, using source port <em>SPORT</em>, destination port <em>DPORT</em> , and original address <em>OADDR</em>.</p>
  </dd>

</dl>
<table class="table table-striped">
<tr>
<th>ip xfrm policy add</th>
<th>add a new policy</th></tr>

<tr>
<td>ip xfrm policy update</td>
<td>update an existing policy</td></tr>

<tr>
<td>ip xfrm policy delete</td>
<td>delete an existing policy</td></tr>

<tr>
<td>ip xfrm policy get</td>
<td>get an existing policy</td></tr>

<tr>
<td>ip xfrm policy deleteall</td>
<td>delete all existing xfrm policies</td></tr>

<tr>
<td>ip xfrm policy list</td>
<td>print out the list of xfrm policies</td></tr>

<tr>
<td>ip xfrm policy flush</td>
<td>flush policies</td></tr>
</table>
<dl class='dl-vertical'>
  <dt>
    <p><em>SELECTOR</em></p>
  </dt>
  <dd>
    <p>selects the traffic that will be controlled by the policy, based on the source address, the destination address, the network device, and/or <em>UPSPEC</em>.</p>
  </dd>
  <dt>
    <p><em>UPSPEC</em></p>
  </dt>
  <dd>
    <p>selects traffic by protocol. For the <strong>tcp</strong>, <strong>udp</strong>, <strong>sctp</strong>, or <strong>dccp</strong> protocols, the source and destination port can optionally be specified. For the <strong>icmp</strong>, <strong>ipv6-icmp</strong>, or <strong>mobility-header</strong> protocols, the type and code numbers can optionally be specified. For the <strong>gre</strong> protocol, the key can optionally be specified as a dotted-quad or number. Other protocols can be selected by name or number <em>PROTO</em>.</p>
  </dd>
  <dt>
    <p><em>DIR</em></p>
  </dt>
  <dd>
    <p>selects the policy direction as <strong>in</strong>, <strong>out</strong>, or <strong>fwd</strong>.</p>
  </dd>
  <dt>
    <p><em>CTX</em></p>
  </dt>
  <dd>
    <p>sets the security context.</p>
  </dd>
  <dt>
    <p><em>PTYPE</em></p>
  </dt>
  <dd>
    <p>can be <strong>main</strong> (default) or <strong>sub</strong>.</p>
  </dd>
  <dt>
    <p><em>ACTION</em></p>
  </dt>
  <dd>
    <p>can be <strong>allow</strong> (default) or <strong>block</strong>.</p>
  </dd>
  <dt>
    <p><em>PRIORITY</em></p>
  </dt>
  <dd>
    <p>is a number that defaults to zero.</p>
  </dd>
  <dt>
    <p><em>FLAG-LIST</em></p>
  </dt>
  <dd>
    <p>contains one or both of the following optional flags: <strong>local</strong> or <strong>icmp</strong>.</p>
  </dd>
  <dt>
    <p><em>LIMIT-LIST</em></p>
  </dt>
  <dd>
    <p>sets limits in seconds, bytes, or numbers of packets.</p>
  </dd>
  <dt>
    <p><em>TMPL-LIST</em></p>
  </dt>
  <dd>
    <p>is a template list specified using <em>ID</em>, <em>MODE</em>, <em>REQID</em>, and/or <em>LEVEL</em>. </p>
  </dd>
  <dt>
    <p><em>ID</em></p>
  </dt>
  <dd>
    <p>is specified by a source address, destination address, transform protocol <em>XFRM-PROTO</em>, and/or Security Parameter Index <em>SPI</em>. (For IP Payload Compression, the Compression Parameter Index or CPI is used for <em>SPI</em>.)</p>
  </dd>
  <dt>
    <p><em>XFRM-PROTO</em></p>
  </dt>
  <dd>
    <p>specifies a transform protocol: IPsec Encapsulating Security Payload (<strong>esp</strong>), IPsec Authentication Header (<strong>ah</strong>), IP Payload Compression (<strong>comp</strong>), Mobile IPv6 Type 2 Routing Header (<strong>route2</strong>), or Mobile IPv6 Home Address Option (<strong>hao</strong>).</p>
  </dd>
  <dt>
    <p><em>MODE</em></p>
  </dt>
  <dd>
    <p>specifies a mode of operation for the transform protocol. IPsec and IP Payload Compression modes are <strong>transport</strong>, <strong>tunnel</strong>, and (for IPsec ESP only) Bound End-to-End Tunnel (<strong>beet</strong>). Mobile IPv6 modes are route optimization (<strong>ro</strong>) and inbound trigger (<strong>in_trigger</strong>).</p>
  </dd>
  <dt>
    <p><em>LEVEL</em></p>
  </dt>
  <dd>
    <p>can be <strong>required</strong> (default) or <strong>use</strong>.</p>
  </dd>

</dl>
<table class="table table-striped">
<tr>
<th>ip xfrm policy count</th>
<th>count existing policies</th></tr>
</table><p>Use one or more -s options to display more details, including policy hash table information.</p><table class="table table-striped">
<tr>
<th>ip xfrm policy set</th>
<th>configure the policy hash table</th></tr>
</table><p>Security policies whose address prefix lengths are greater than or equal policy hash table thresholds are hashed. Others are stored in the policy_inexact chained list.</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>LBITS</em></p>
  </dt>
  <dd>
    <p>specifies the minimum local address prefix length of policies that are stored in the Security Policy Database hash table.</p>
  </dd>
  <dt>
    <p><em>RBITS</em></p>
  </dt>
  <dd>
    <p>specifies the minimum remote address prefix length of policies that are stored in the Security Policy Database hash table.</p>
  </dd>

</dl>
<table class="table table-striped">
<tr>
<th>ip xfrm monitor </th>
<th>state monitoring for xfrm objects</th></tr>
</table><p>The xfrm objects to monitor can be optionally specified.</p><p>If the <strong>all-nsid</strong> option is set, the program listens to all network namespaces that have a nsid assigned into the network namespace were the program is running. A prefix is displayed to show the network namespace where the message originates. Example:</p><p>[nsid 1]Flushed state proto 0</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Manpage revised by David Ward &lt;david.ward@ll.mit.edu&gt;</p><p>Manpage revised by Christophe Gouault &lt;christophe.gouault@6wind.com&gt;</p><p>Manpage revised by Nicolas Dichtel &lt;nicolas.dichtel@6wind.com&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="ip-tunnel.8.html"><span aria-hidden="true">&larr;</span> ip-tunnel.8: Tunnel configuration</a></li>
   <li class="next"><a href="iptraf-ng.8.html">iptraf-ng.8: Interactive colorful ip lan monitor <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
