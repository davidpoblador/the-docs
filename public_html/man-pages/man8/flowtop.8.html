<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>flowtop: Top-like netfilter tcp/udp/sctp/dccp/icmp(v6) flow tracking</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Top-like netfilter tcp/udp/sctp/dccp/icmp(v6) flow tracking">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="flowtop (8) manual">
  <meta name="twitter:description" content="Top-like netfilter tcp/udp/sctp/dccp/icmp(v6) flow tracking">
  <meta name="twitter:image" content="https://www.carta.tech/images/netsniff-ng-flowtop-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/flowtop.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="flowtop (8) manual" />
  <meta property="og:description" content="Top-like netfilter tcp/udp/sctp/dccp/icmp(v6) flow tracking" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/netsniff-ng-flowtop-8.png" />

</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">flowtop<small> (8)</small></h1>
        <p class="lead">Top-like netfilter tcp/udp/sctp/dccp/icmp(v6) flow tracking</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/flowtop.8.html">
      <span itemprop="name">flowtop: Top-like netfilter tcp/udp/sctp/dccp/icmp(v6) flow tracking</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/netsniff-ng/">
      <span itemprop="name">netsniff-ng</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/flowtop.8.html">
      <span itemprop="name">flowtop: Top-like netfilter tcp/udp/sctp/dccp/icmp(v6) flow tracking</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>flowtop</strong> { [<em>options</em>] }</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>flowtop is a top-like connection tracking tool that can run on an end host or small home router. It is able to present TCP, UDP/UDP-lite, SCTP, DCCP, and ICMP(v6) flows that have been collected by the kernel's netfilter connection tracking framework, thus no packet capturing in user space needs to be done.</p><p>flowtop is able to give you a quick overview of current connections on your local system, e.g. for debugging purposes or to answer questions like:</p>
<pre>
    * If you access website X, what other connections are being opened in
      the background that I'm not aware of?
    * What connections are active that pass one's router?
    * I have this proprietary binary Y, to where does it connect?
    * To which countries am I sending data?
    * Are there any suspicious background connections on my machine?
    * How many active connections does binary Y have?
    * How long are connections active already?
    * At which rate am I sending/receiving data?
</pre>
<p>The following information will be presented in flowtop's output:</p>
<pre>
    * Application name and PID when run on local machine
    * Reverse DNS for source and destination
    * Geo-location information (country, city)
    * Used protocols (IPv4, IPv6, TCP, UDP, SCTP, ICMP, ...)
    * Flow port's service name heuristic
    * Transport protocol state machine information
    * Byte/packet counters (if they are enabled)
    * Connection duration (if timestamping is enabled)
    * Flow send/receive rate (if byte/packet counters are enabled)
</pre>
<p>In order for flowtop to work, netfilter must be active and running on your machine, thus kernel-side connection tracking is active. If netfilter is not running, you can activate it with <strong>iptables</strong>(8):</p><p>iptables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT</p><p>iptables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT</p><p>or by loading the following kernel modules:</p><p>modprobe nf_conntrack_ipv4</p><p>modprobe nf_conntrack_ipv6</p><p>To dump byte/packet counters flowtop enables the <a href="../man8/sysctl.8.html"><strong>sysctl</strong>(8)</a> parameter \[lq]net.netfilter.nf_conntrack_acct\[rq] via:</p><p>echo 1 &gt; /proc/sys/net/netfilter/nf_conntrack_acct</p><p>and resets it to the previously set value on exit. These counters will only be active on connections which were created after accounting was enabled. Thus, to have these counters be active all the time the parameter should be enabled after the system is up. To automatically enable it, <strong>sysctl.conf</strong>(8) or <strong>sysctl.d</strong>(8) might be used.</p><p>To calculate the connection duration flowtop enables the <a href="../man8/sysctl.8.html"><strong>sysctl</strong>(8)</a> parameter \[lq]net.netfilter.nf_conntrack_timestamp\[rq] via:</p><p>echo 1 &gt; /proc/sys/net/netfilter/nf_conntrack_timestamp</p><p>and resets it to the previously set value on exit.</p><p>flowtop's intention is just to get a quick look over your active connections. If you want logging support, have a look at netfilter's <strong>conntrack</strong>(8) tools instead.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<h3>-4, --ipv4</h3>
<p>Display IPv4 flows. That is the default when flowtop is started without any arguments.</p>
<h3>-6, --ipv6</h3>
<p>Display IPv6 flows. That is the default when flowtop is started without any arguments.</p>
<h3>-T, --tcp</h3>
<p>Display TCP flows. That is the default when flowtop is started without any arguments.</p>
<h3>-U, --udp</h3>
<p>Display UDP and UDP-lite flows.</p>
<h3>-D, --dccp</h3>
<p>Display DCCP flows.</p>
<h3>-I, --icmp</h3>
<p>Display ICMP version 4 and version 6 flows.</p>
<h3>-S, --sctp</h3>
<p>Display SCTP flows.</p>
<h3>-n, --no-dns</h3>
<p>Don't perform hostname lookup. Only numeric addresses will be shown for flow endpoints.</p>
<h3>-G, --no-geoip</h3>
<p>Don't perform GeoIP lookup. No geographical information will be shown for flow endpoints.</p>
<h3>-s, --show-src</h3>
<p>Also show source information of the flow, not only destination information.</p>
<h3>-b, --bits</h3>
<p>Show flow rates in bits per second instead of bytes per second.</p>
<h3>-u, --update</h3>
<p>The built-in database update mechanism will be invoked to get Maxmind's latest database. To configure search locations for databases, the file /etc/netsniff-ng/geoip.conf contains possible addresses. Thus, to save bandwidth or for mirroring Maxmind's databases (to bypass their traffic limit policy), different hosts or IP addresses can be placed into geoip.conf, separated by a newline.</p>
<h3>-t &lt;time&gt;, --interval &lt;time&gt;</h3>
<p>Flow info refresh interval in seconds, default is 1s.</p>
<h3>-v, --version</h3>
<p>Show version information and exit.</p>
<h3>-h, --help</h3>
<p>Show user help and exit.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE EXAMPLE</h2>
        <div class="sectioncontent">
<h3>flowtop</h3>
<p>Default ncurses output for flowtop that tracks IPv4, IPv6 flows for TCP.</p>
<h3>flowtop -46UTDISs</h3>
<p>This example enables the maximum display options for flowtop.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIG FILES</h2>
        <div class="sectioncontent">
<p>Files under /etc/netsniff-ng/ can be modified to extend flowtop's service resolution and lookup information.</p>
<pre>
    * tcp.conf - TCP port/services map
    * udp.conf - UDP port/services map
    * geoip.conf - GeoIP database mirrors
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>With a fairly high rate of connection tracking updates, flowtop can become unresponsive for short periods of time while scrolling. The right fix would be to replace flowtop's connection management backend with a better design with respect to the locking approach. This is still on the "todo" list.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LEGAL</h2>
        <div class="sectioncontent">
<p>flowtop is licensed under the GNU GPL version 2.0.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">
<p><strong>flowtop</strong> was originally written for the netsniff-ng toolkit by Daniel Borkmann. It is currently maintained by Tobias Klauser &lt;tklauser@distanz.ch&gt; and Daniel Borkmann &lt;dborkma@tik.ee.ethz.ch&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO flowtop&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/netsniff-ng.8.html"><strong>netsniff-ng</strong>(8)</a>, <a href="../man8/trafgen.8.html"><strong>trafgen</strong>(8)</a>, <a href="../man8/mausezahn.8.html"><strong>mausezahn</strong>(8)</a>, <a href="../man8/ifpps.8.html"><strong>ifpps</strong>(8)</a>, <a href="../man8/bpfc.8.html"><strong>bpfc</strong>(8)</a>, <a href="../man8/astraceroute.8.html"><strong>astraceroute</strong>(8)</a>, <a href="../man8/curvetun.8.html"><strong>curvetun</strong>(8)</a>, <strong>iptables</strong>(8), <a href="../man8/sysctl.8.html"><strong>sysctl</strong>(8)</a>, <strong>sysctl.conf</strong>(8), <strong>sysctl.d</strong>(8)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Manpage was written by Daniel Borkmann.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COLOPHON</h2>
        <div class="sectioncontent">
<p>This page is part of the Linux netsniff-ng toolkit project. A description of the project, and information about reporting bugs, can be found at http://netsniff-ng.org/.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="fixfiles.8.html"><span aria-hidden="true">&larr;</span> fixfiles.8: Fix file selinux security contexts.</a></li>
   <li class="next"><a href="fsck.8.html">fsck.8: Check and repair a linux filesystem <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
