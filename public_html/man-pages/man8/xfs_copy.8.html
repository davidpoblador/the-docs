<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>xfs_copy: Copy the contents of an xfs filesystem</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Copy the contents of an xfs filesystem">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">xfs_copy<small> (8)</small></h1>
        <p class="lead">Copy the contents of an xfs filesystem</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/xfs_copy.8.html">
      <span itemprop="name">xfs_copy: Copy the contents of an xfs filesystem</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/xfsprogs/">
      <span itemprop="name">xfsprogs</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/xfs_copy.8.html">
      <span itemprop="name">xfs_copy: Copy the contents of an xfs filesystem</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p><strong>xfs_copy</strong> [ <strong>-bd</strong> ] [ <strong>-L</strong> <em>log</em> ] <em>source target1</em> [ <em>target2</em> ... ]</p>
<p class='spacer'>

<p><strong>xfs_copy -V</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p><strong>xfs_copy</strong> copies an XFS filesystem to one or more targets in parallel (see <a href="../man5/xfs.5.html"><strong>xfs</strong>(5)</a>). The first (<em>source</em>) argument must be the pathname of the device or file containing the XFS filesystem. The remaining arguments specify one or more <em>target</em> devices or file names. If the pathnames specify devices, a copy of the source XFS filesystem is created on each device. The <em>target</em> can also be the name of a regular file, in which case an image of the source XFS filesystem is created in that file. If the file does not exist, <strong>xfs_copy</strong> creates the file. The length of the resulting file is equal to the size of the source filesystem. However, if the file is created on an XFS filesystem, the file consumes roughly the amount of space actually used in the source filesystem by the filesystem and the XFS log. The space saving is because <strong>xfs_copy</strong> seeks over free blocks instead of copying them and the XFS filesystem supports sparse files efficiently.</p>
<p class='spacer'>

<p><strong>xfs_copy</strong> should only be used to copy unmounted filesystems, read-only mounted filesystems, or frozen filesystems (see <a href="../man8/xfs_freeze.8.html"><strong>xfs_freeze</strong>(8)</a>). Otherwise, the generated filesystem(s) would be inconsistent or corrupt.</p>
<p class='spacer'>

<p><strong>xfs_copy</strong> does not alter the source filesystem in any way. Each new (target) filesystem is identical to the original filesystem except that new filesystems each have a new unique filesystem identifier (UUID). Therefore, if both the old and new filesystems will be used as separate distinct filesystems, <strong>xfs_copy</strong> or <strong>xfsdump</strong>(8)/<strong>xfsrestore</strong>(8) should be used to generate the new filesystem(s) instead of <strong>dd</strong>(1) or other programs that do block-by-block disk copying.</p>
<p class='spacer'>

<p><strong>xfs_copy</strong> uses synchronous writes to ensure that write errors are detected.</p>
<p class='spacer'>

<p><strong>xfs_copy</strong> uses <a href="../man7/pthreads.7.html"><strong>pthreads</strong>(7)</a> to perform simultaneous parallel writes. <strong>xfs_copy</strong> creates one additional thread for each target to be written. All threads die if <strong>xfs_copy</strong> terminates or aborts.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

  <dl class='dl-vertical'>
    <dt><strong>-d</strong></dt>
    <dd>
  <p>Create a duplicate (true clone) filesystem. This should be done only if the new filesystem will be used as a replacement for the original filesystem (such as in the case of disk replacement).</p>
    </dd>
    <dt><strong>-b</strong></dt>
    <dd>
  <p>The buffered option can be used to ensure direct IO is not attempted to any of the target files. This is useful when the filesystem holding the target file does not support direct IO.</p>
    </dd>
    <dt><strong>-L</strong><em> log</em></dt>
    <dd>
  <p>Specifies the location of the <em>log</em> if the default location of <em>/var/tmp/xfs_copy.log.XXXXXX</em> is not desired.</p>
    </dd>
    <dt><strong>-V</strong></dt>
    <dd>
  <p>Prints the version number and exits.</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">

<p><strong>xfs_copy</strong> reports errors to both <strong>stderr</strong> and in more detailed form to a generated log file whose name is of the form <em>/var/tmp/xfs_copy.log.XXXXXX</em> or a log file specified by the <strong>-L</strong> option. If <strong>xfs_copy</strong> detects a write error on a target, the copy of that one target is aborted and an error message is issued to both stderr and the log file, but the rest of the copies continue. When <strong>xfs_copy</strong> terminates, all aborted targets are reported to both <strong>stderr</strong> and the log file.</p>
<p class='spacer'>

<p>If all targets abort or if there is an error reading the source filesystem, <strong>xfs_copy</strong> immediately aborts.</p>
<p class='spacer'>

<p><strong>xfs_copy</strong> returns an exit code of 0 if all targets are successfully copied and an exit code of 1 if any target fails.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<p>When moving filesystems from one disk to another, if the original filesystem is significantly smaller than the new filesystem, and will be made larger, we recommend that <a href="../man8/mkfs.xfs.8.html"><strong>mkfs.xfs</strong>(8)</a> and <strong>xfsdump</strong>(8)/<strong>xfsrestore</strong>(8) be used instead of using <strong>xfs_copy</strong> and <a href="../man8/xfs_growfs.8.html"><strong>xfs_growfs</strong>(8)</a>. The filesystem layout resulting from using <strong>xfs_copy</strong>/<strong>xfs_growfs</strong> is almost always worse than the result of using <strong>mkfs.xfs</strong>/<strong>xfsdump</strong>/<strong>xfsrestore</strong> but in the case of small filesystems, the differences can have a significant performance impact. This is due to the way <a href="../man8/xfs_growfs.8.html"><strong>xfs_growfs</strong>(8)</a> works, and not due to any shortcoming in <strong>xfs_copy</strong> itself.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CAVEATS</h2>
        <div class="sectioncontent">

<p><strong>xfs_copy</strong> does not copy XFS filesystems that have a real-time section or XFS filesystems with external logs. In both cases, <strong>xfs_copy</strong> aborts with an error message.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<p><a href="../man8/mkfs.xfs.8.html"><strong>mkfs.xfs</strong>(8)</a>, <strong>xfsdump</strong>(8), <strong>xfsrestore</strong>(8), <a href="../man8/xfs_freeze.8.html"><strong>xfs_freeze</strong>(8)</a>, <a href="../man8/xfs_growfs.8.html"><strong>xfs_growfs</strong>(8)</a>, <a href="../man5/xfs.5.html"><strong>xfs</strong>(5)</a>.</p>
        </div>
      </section>

<nav>
  <ul class="pager">
   <li class="previous"><a href="xfs_bmap.8.html"><span aria-hidden="true">&larr;</span> xfs_bmap.8: print block mapping for an XFS file</a></li>
   <li class="next"><a href="xfs_db.8.html">xfs_db.8: debug an XFS filesystem <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
