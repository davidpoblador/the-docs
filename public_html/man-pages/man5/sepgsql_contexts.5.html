<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>selabel_db: Userspace selinux labeling interface and configuration file format for the rdbms objects context backend</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Userspace selinux labeling interface and configuration file format for the rdbms objects context backend">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">selabel_db<small> (5)</small></h1>
        <p class="lead">Userspace selinux labeling interface and configuration file format for the rdbms objects context backend</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/selabel_db.5.html">
      <span itemprop="name">selabel_db: Userspace selinux labeling interface and configuration file format for the rdbms objects context backend</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/selinux/">
      <span itemprop="name">selinux</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/selabel_db.5.html">
      <span itemprop="name">selabel_db: Userspace selinux labeling interface and configuration file format for the rdbms objects context backend</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>#include &lt;selinux/label.h&gt;</strong></p><p><strong>int selabel_lookup(struct selabel_handle *</strong><em>hnd</em><strong>,</strong> <strong>char **</strong><em>context</em><strong>,</strong></p><p><strong>const char *</strong><em>object_name</em><strong>, int </strong><em>object_type</em><strong>);</strong></p><p><strong>int selabel_lookup_raw(struct selabel_handle *</strong><em>hnd</em><strong>,</strong> <strong>char **</strong><em>context</em><strong>,</strong></p><p><strong>const char *</strong><em>object_name</em><strong>, int </strong><em>object_type</em><strong>);</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The DB contexts backend maps from a pair of object name and class into security contexts. It is used to find the appropriate context for database objects when relabeling a certain database. The returned <em>context</em> must be freed using <a href="../man3/freecon.3.html"><strong>freecon</strong>(3)</a>.</p><p><a href="../man3/selabel_lookup.3.html"><strong>selabel_lookup</strong>(3)</a> describes the function with its return and error codes.</p><p>The <em>object_name</em> should be a fully qualified name using the hierarchy of database objects. For example, the <strong>pg_class</strong> table in the <strong>postgres</strong> database and <strong>pg_catalog</strong> schema should be qualified as:</p><p><strong>Bpostgres.pg_catalog.pg_class</strong></p><p>The <strong>NOTES</strong> section has further information on database support for namespace hierarchies.</p><p>The <em>object_type</em> argument should be set to one of the following values:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>SELABEL_DB_DATABASE</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of a database itself, such as "postgres".</p>
  </dd>
  <dt>
    <p><strong>SELABEL_DB_SCHEMA</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of a schema object, such as "postgres.public".</p>
  </dd>
  <dt>
    <p><strong>SELABEL_DB_TABLE</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of a table object, such as "postgres.public.my_table"</p>
  </dd>
  <dt>
    <p><strong>SELABEL_DB_COLUMN</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of a column object, such as "postgres.public.my_table.user_id"</p>
  </dd>
  <dt>
    <p><strong>SELABEL_DB_TUPLE</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of a table object which contains the tuples to be relabeled, such as "postgresql.public.my_table". Note that we have no way to identify individual tuple objects, except for WHERE clause on DML statements, because it has no name.</p>
  </dd>
  <dt>
    <p><strong>SELABEL_DB_PROCEDURE</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of a procedure object, such as "postgres.public.my_func". Note that we don't support lookup of individual security contexts for procedures which have the same name but different arguments.</p>
  </dd>
  <dt>
    <p><strong>SELABEL_DB_SEQUENCE</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of a sequence object, such as "postgres.public.my_seq".</p>
  </dd>
  <dt>
    <p><strong>SELABEL_DB_BLOB</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of a large object, such as "postgres.16308". Note that a large object does not have a name, so it is identified by its identifier value.</p>
  </dd>
  <dt>
    <p><strong>SELABEL_DB_VIEW</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of a view object, such as "postgres.public.my_view".</p>
  </dd>
  <dt>
    <p><strong>SELABEL_DB_LANGUAGE</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of a language object, such as "postgres.public.tcl".</p>
  </dd>
  <dt>
    <p><strong>SELABEL_DB_EXCEPTION</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of a exception object.</p>
  </dd>
  <dt>
    <p><strong>SELABEL_DB_DATATYPE</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of a type or domain object, such as postgres.public.my_type.</p>
  </dd>

</dl>
<p>Any messages generated by <a href="../man3/selabel_lookup.3.html"><strong>selabel_lookup</strong>(3)</a> are sent to <em>stderr</em> by default, although this can be changed by <a href="../man3/selinux_set_callback.3.html"><strong>selinux_set_callback</strong>(3)</a>.</p><p><a href="../man3/selabel_lookup_raw.3.html"><strong>selabel_lookup_raw</strong>(3)</a> behaves identically to <a href="../man3/selabel_lookup.3.html"><strong>selabel_lookup</strong>(3)</a> but does not perform context translation.</p><p>The <strong>FILES</strong> section details the configuration files used to determine the database object context.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>In addition to the global options described in <a href="../man3/selabel_open.3.html"><strong>selabel_open</strong>(3)</a>, this backend recognizes the following options:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>SELABEL_OPT_PATH</strong></p>
  </dt>
  <dd>
    <p>A non-null value for this option specifies a path to a file that will be opened in lieu of the standard DB contexts file. It tries to open the specfile designed for SE-PostgreSQL as default, so if another RDBMS uses this interface, it needs to give an explicit specfile designed for that RDBMS (see the <strong>FILES</strong> section for details).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>The database context file used to retrieve a context depends on the <strong>SELABEL_OPT_PATH</strong> parameter passed to <a href="../man3/selabel_open.3.html"><strong>selabel_open</strong>(3)</a>. If <em>NULL</em>, then the <strong>SELABEL_OPT_PATH</strong> value will default to the active policy database contexts location (as returned by <strong>selinux_sepgsql_context_path</strong>(3)), otherwise the actual <strong>SELABEL_OPT_PATH</strong> value specified is used (this option must be used to support databases other than SE-PostgreSQL).</p><p>The default database object contexts file is:</p><p><em>/etc/selinux/{SELINUXTYPE}/contexts/sepgsql_context</em></p><p>Where <em>{SELINUXTYPE}</em> is the entry from the selinux configuration file <em>config</em> (see <a href="../man5/selinux_config.5.html"><strong>selinux_config</strong>(5)</a>).</p><p>The entries within the database contexts file are shown in the <strong>Object Name String Values</strong> and <strong>FILE FORMAT</strong> sections.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Object Name String Values</h2>
        <div class="sectioncontent">
<p>The string name assigned to each <em>object_type</em> argument that can be present in the database contexts file are:</p><table class="table table-striped">
<tr>
<th>object_type</th>
<th>Text Name</th>
<th></th></tr>

<tr>
<td>SELABEL_DB_DATABASE</td>
<td>db_database</td>
<td></td></tr>

<tr>
<td>SELABEL_DB_SCHEMA</td>
<td>db_schema</td>
<td></td></tr>

<tr>
<td>SELABEL_DB_VIEW</td>
<td>db_view</td>
<td></td></tr>

<tr>
<td>SELABEL_DB_LANGUAGE</td>
<td>db_language</td>
<td></td></tr>

<tr>
<td>SELABEL_DB_TABLE</td>
<td>db_table</td>
<td></td></tr>

<tr>
<td>SELABEL_DB_COLUMN</td>
<td>db_column</td>
<td></td></tr>

<tr>
<td>SELABEL_DB_TUPLE</td>
<td>db_tuple</td>
<td></td></tr>

<tr>
<td>SELABEL_DB_PROCEDURE</td>
<td>db_procedure</td>
<td></td></tr>

<tr>
<td>SELABEL_DB_SEQUENCE</td>
<td>db_sequence</td>
<td></td></tr>

<tr>
<td>SELABEL_DB_BLOB</td>
<td>db_blob</td>
<td></td></tr>

<tr>
<td>SELABEL_DB_EXCEPTION</td>
<td>db_exception</td>
<td></td></tr>

<tr>
<td>SELABEL_DB_DATATYPE</td>
<td>db_datatype</td>
<td></td></tr>
</table>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILE FORMAT</h2>
        <div class="sectioncontent">
<p>Each line within the database contexts file is as follows:</p><p><em>object_type object_name context</em></p><p>Where:</p><p><em>object_type</em></p><p>This is the string representation of the object type shown in the <strong>Object Name String Values</strong> section.</p><p><em>object_name</em></p><p>The key used to obtain the context based on the <em>object_type</em>.</p><p>The entry can contain '*' for wildcard matching or '?' for substitution.</p><p>Note that if the '*' is used, then be aware that the order of entries in the file is important. The '*' on its own is used to ensure a default fallback context is assigned and should be the last entry in the <em>object_type</em> block.</p><p><em>context</em></p><p>The security context that will be applied to the object.</p><p>The following example is for SE-PostgreSQL:</p><p># ./contexts/sepgsql_contexts file</p><p># object_type  object_name   context</p><p>db_database    my_database   system_u:object_r:sepgsql_db_t:s0</p><p>db_database    *             system_u:object_r:sepgsql_db_t:s0</p><p>db_schema      *.*           system_u:object_r:sepgsql_schema_t:s0</p><p>db_tuple       row_low       system_u:object_r:sepgsql_table_t:s0</p><p>db_tuple       row_high      system_u:object_r:sepgsql_table_t:s0:c1023</p><p>db_tuple       *.*.*         system_u:object_r:sepgsql_table_t:s0</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    1.
  </dt>
  <dd>
    <p>A suitable database contexts file needs to be written for the target RDBMS and the <strong>SELABEL_OPT_PATH</strong> option must be used in <a href="../man3/selabel_open.3.html"><strong>selabel_open</strong>(3)</a> to load it.</p>
  </dd>
  <dt>
    2.
  </dt>
  <dd>
    <p>The hierarchy of the namespace for database objects depends on the RDBMS, however the <em>selabel*</em> interfaces do not have any specific support for a namespace hierarchy.</p><p>SE-PostgreSQL has a namespace hierarchy where a database is the top level object with the schema being the next level. Under the schema object there can be other types of objects such as tables and procedures. This hierarchy is supported as follows:</p><p>If a security context is required for "my_table" table in the "public" schema within the "postgres" database, then the <a href="../man3/selabel_lookup.3.html"><strong>selabel_lookup</strong>(3)</a> parameters for <em>object_type</em> would be <strong>SELABEL_DB_TABLE</strong> and the <em>object_name</em> would be "postgres.public.my_table", the security context (if available), would be returned in <em>context</em>.</p>
  </dd>
  <dt>
    3.
  </dt>
  <dd>
    <p>If contexts are to be validated, then the global option <strong>SELABEL_OPT_VALIDATE</strong> must be set before calling <a href="../man3/selabel_open.3.html"><strong>selabel_open</strong>(3)</a>. If this is not set, then it is possible for an invalid context to be returned.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO selabel_db&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/selinux.8.html"><strong>selinux</strong>(8)</a>, <a href="../man3/selabel_open.3.html"><strong>selabel_open</strong>(3)</a>, <a href="../man3/selabel_lookup.3.html"><strong>selabel_lookup</strong>(3)</a>, <a href="../man3/selabel_stats.3.html"><strong>selabel_stats</strong>(3)</a>, <a href="../man3/selabel_close.3.html"><strong>selabel_close</strong>(3)</a>, <a href="../man3/selinux_set_callback.3.html"><strong>selinux_set_callback</strong>(3)</a>, <strong>selinux_sepgsql_context_path</strong>(3), <a href="../man3/freecon.3.html"><strong>freecon</strong>(3)</a>, <a href="../man5/selinux_config.5.html"><strong>selinux_config</strong>(5)</a> </p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="semanage.conf.5.html"><span aria-hidden="true">&larr;</span> semanage.conf.5: Global configuration file for the selinux management library</a></li>
   <li class="next"><a href="service_seusers.5.html">service_seusers.5: The selinux gnu/linux user and service to selinux user mapping configuration files <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
