<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pcre_table - format of Postfix PCRE tables</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Format of postfix pcre tables">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pcre_table<small> (5)</small></h1>
        <p class="lead">Format of postfix pcre tables</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/pcre_table.5.html">
      <span itemprop="name">pcre_table</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/postfix/">
      <span itemprop="name">postfix</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/pcre_table.5.html">
      <span itemprop="name">pcre_table</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>postmap -q "<em>string" pcre:/etc/postfix/filename</em>

postmap -q - pcre:/etc/postfix/<em>filename &lt;inputfile</em></pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p>The Postfix mail system uses optional tables for address rewriting, mail routing, or access control. These tables are usually in <strong>dbm</strong> or <strong>db</strong> format.</p>
<p class='spacer'>

<p>Alternatively, lookup tables can be specified in Perl Compatible Regular Expression form. In this case, each input is compared against a list of patterns. When a match is found, the corresponding result is returned and the search is terminated.</p>
<p class='spacer'>

<p>To find out what types of lookup tables your Postfix system supports use the "<strong>postconf -m</strong>" command.</p>
<p class='spacer'>

<p>To test lookup tables, use the "<strong>postmap -q</strong>" command as described in the SYNOPSIS above.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMPATIBILITY</h2>
        <div class="sectioncontent">

<p>With Postfix version 2.2 and earlier specify "<strong>postmap -fq</strong>" to query a table that contains case sensitive patterns. Patterns are case insensitive by default.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TABLE FORMAT</h2>
        <div class="sectioncontent">

  <p>The general form of a PCRE table is:</p>
  <dl class='dl-horizontal'>
    <dt>/<em>pattern/flags result</em></dt>
    <dd>
  <p>When <em>pattern</em> matches the input string, use the corresponding <em>result</em> value.</p>
    </dd>
    <dt>!/<em>pattern/flags result</em></dt>
    <dd>
  <p>When <em>pattern</em> does <strong>not</strong> match the input string, use the corresponding <em>result</em> value.</p>
    </dd>
    <dt>if /<em>pattern/flags</em></dt>
    <dd>
    </dd>
    <dt><strong>endif</strong></dt>
    <dd>
  <p>Match the input string against the patterns between <strong>if</strong> and <strong>endif</strong>, if and only if that same input string also matches <em>pattern</em>. The <strong>if</strong>..<strong>endif</strong> can nest.</p>
<p class='spacer'>

  <p>Note: do not prepend whitespace to patterns inside <strong>if</strong>..<strong>endif</strong>.</p>
<p class='spacer'>

  <p>This feature is available in Postfix 2.1 and later.</p>
    </dd>
    <dt>if !/<em>pattern/flags</em></dt>
    <dd>
    </dd>
    <dt><strong>endif</strong></dt>
    <dd>
  <p>Match the input string against the patterns between <strong>if</strong> and <strong>endif</strong>, if and only if that same input string does <strong>not</strong> match <em>pattern</em>. The <strong>if</strong>..<strong>endif</strong> can nest.</p>
<p class='spacer'>

  <p>Note: do not prepend whitespace to patterns inside <strong>if</strong>..<strong>endif</strong>.</p>
<p class='spacer'>

  <p>This feature is available in Postfix 2.1 and later.</p>
    </dd>
    <dt>blank lines and comments</dt>
    <dd>
  <p>Empty lines and whitespace-only lines are ignored, as are lines whose first non-whitespace character is a `#'.</p>
    </dd>
    <dt>multi-line text</dt>
    <dd>
  <p>A logical line starts with non-whitespace text. A line that starts with whitespace continues a logical line.</p>
    </dd>
  </dl>
<p class='spacer'>

<p>Each pattern is a perl-like regular expression. The expression delimiter can be any non-alphanumerical character, except whitespace or characters that have special meaning (traditionally the forward slash is used). The regular expression can contain whitespace.</p>
<p class='spacer'>

  <p>By default, matching is case-insensitive, and newlines are not treated as special characters. The behavior is controlled by flags, which are toggled by appending one or more of the following characters after the pattern:</p>
  <dl class='dl-horizontal'>
    <dt><strong>i</strong> (default: on)</dt>
    <dd>
  <p>Toggles the case sensitivity flag. By default, matching is case insensitive.</p>
    </dd>
    <dt><strong>m</strong> (default: off)</dt>
    <dd>
  <p>Toggles the PCRE_MULTILINE flag. When this flag is on, the <strong>^</strong> and <strong>$</strong> metacharacters match immediately after and immediately before a newline character, respectively, in addition to matching at the start and end of the subject string.</p>
    </dd>
    <dt><strong>s</strong> (default: on)</dt>
    <dd>
  <p>Toggles the PCRE_DOTALL flag. When this flag is on, the <strong>.</strong> metacharacter matches the newline character. With Postfix versions prior to 2.0, the flag is off by default, which is inconvenient for multi-line message header matching.</p>
    </dd>
    <dt><strong>x</strong> (default: off)</dt>
    <dd>
  <p>Toggles the pcre extended flag. When this flag is on, whitespace characters in the pattern (other than in a character class) are ignored.  To include a whitespace character as part of the pattern, escape it with backslash.</p>
<p class='spacer'>

  <p>Note: do not use #<em>comment</em> after patterns.</p>
    </dd>
    <dt><strong>A</strong> (default: off)</dt>
    <dd>
  <p>Toggles the PCRE_ANCHORED flag.  When this flag is on, the pattern is forced to be "anchored", that is, it is constrained to match only at the start of the string which is being searched (the "subject string"). This effect can also be achieved by appropriate constructs in the pattern itself.</p>
    </dd>
    <dt><strong>E</strong> (default: off)</dt>
    <dd>
  <p>Toggles the PCRE_DOLLAR_ENDONLY flag. When this flag is on, a <strong>$</strong> metacharacter in the pattern matches only at the end of the subject string. Without this flag, a dollar also matches immediately before the final character if it is a newline character (but not before any other newline characters). This flag is ignored if PCRE_MULTILINE flag is set.</p>
    </dd>
    <dt><strong>U</strong> (default: off)</dt>
    <dd>
  <p>Toggles the ungreedy matching flag.  When this flag is on, the pattern matching engine inverts the "greediness" of the quantifiers so that they are not greedy by default, but become greedy if followed by "?".  This flag can also set by a (?U) modifier within the pattern.</p>
    </dd>
    <dt><strong>X</strong> (default: off)</dt>
    <dd>
  <p>Toggles the PCRE_EXTRA flag. When this flag is on, any backslash in a pattern that is followed by a letter that has no special meaning causes an error, thus reserving these combinations for future expansion.</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEARCH ORDER</h2>
        <div class="sectioncontent">

<p>Patterns are applied in the order as specified in the table, until a pattern is found that matches the input string.</p>
<p class='spacer'>

<p>Each pattern is applied to the entire input string. Depending on the application, that string is an entire client hostname, an entire client IP address, or an entire mail address. Thus, no parent domain or parent network search is done, and <em>user@domain</em> mail addresses are not broken up into their <em>user</em> and <em>domain</em> constituent parts, nor is <em>user+foo</em> broken up into <em>user</em> and <em>foo</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TEXT SUBSTITUTION</h2>
        <div class="sectioncontent">

<p>Substitution of substrings (text that matches patterns inside "()") from the matched expression into the result string is requested with $1, $2, etc.; specify $$ to produce a $ character as output. The macros in the result string may need to be written as ${n} or $(n) if they aren't followed by whitespace.</p>
<p class='spacer'>

<p>Note: since negated patterns (those preceded by <strong>!</strong>) return a result when the expression does not match, substitutions are not available for negated patterns.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE SMTPD ACCESS MAP</h2>
        <div class="sectioncontent">

<pre># Protect your outgoing majordomo exploders
/^(?!owner-)(.*)-outgoing@(.*)/ 550 Use ${1}@${2} instead

# Bounce friend@whatever, except when whatever is our domain (you would
# be better just bouncing all friend@ mail - this is just an example).
/^(friend@(?!my&#92;.domain$).*)$/  550 Stick this in your pipe $1

# A multi-line entry. The text is sent as one line.
#
/^noddy@my&#92;.domain$/
&nbsp;550 This user is a funny one. You really don't want to send mail to
&nbsp;them as it only makes their head spin.</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE HEADER FILTER MAP</h2>
        <div class="sectioncontent">

<pre>/^Subject: make money fast/     REJECT
/^To: friend@public&#92;.com/       REJECT</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE BODY FILTER MAP</h2>
        <div class="sectioncontent">

<pre># First skip over base 64 encoded text to save CPU cycles.
# Requires PCRE version 3.
~^[[:alnum:]+/]{60,}$~          OK

# Put your own body patterns here.</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<a href="../man1/postmap.1.html"><strong>postmap</strong>(1)</a>, Postfix lookup table manager
<a href="../man5/postconf.5.html"><strong>postconf</strong>(5)</a>, configuration parameters
<a href="../man5/regexp_table.5.html"><strong>regexp_table</strong>(5)</a>, format of POSIX regular expression tables</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">README FILES</h2>
        <div class="sectioncontent">

  <p>Use "<strong>postconf readme_directory</strong>" or "<strong>postconf html_directory</strong>" to locate this information.</p>
<pre>DATABASE_README, Postfix lookup table overview</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR(S)</h2>
        <div class="sectioncontent">

<pre>The PCRE table lookup code was originally written by:
Andrew McNamara
andrewm@connect.com.au
connect.com.au Pty. Ltd.
Level 3, 213 Miller St
North Sydney, NSW, Australia

Adopted and adapted by:
Wietse Venema
IBM T.J. Watson Research
P.O. Box 704
Yorktown Heights, NY 10598, USA</pre>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pcp.env.5.html"><span aria-hidden="true">&larr;</span> pcp.env.5: script to set Performance Co-Pilot run-time environment variables</a></li>
   <li class="next"><a href="perfevent.conf.5.html">perfevent.conf.5: the Performance Co-Pilot perfevent PMDA configuration file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
