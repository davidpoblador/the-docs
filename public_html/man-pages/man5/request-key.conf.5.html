<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>request-key.conf: Instantiation handler configuration file</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Instantiation handler configuration file">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="request-key.conf (5) manual">
  <meta name="twitter:description" content="Instantiation handler configuration file">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/request-key.conf.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="request-key.conf (5) manual" />
  <meta property="og:description" content="Instantiation handler configuration file" />
  <meta property="fb:app_id" content="1241677679199500" />

</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">request-key.conf<small> (5)</small></h1>
        <p class="lead">Instantiation handler configuration file</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/request-key.conf.5.html">
      <span itemprop="name">request-key.conf: Instantiation handler configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/keyutils/">
      <span itemprop="name">keyutils</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/request-key.conf.5.html">
      <span itemprop="name">request-key.conf: Instantiation handler configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This file and its associated key-type specific variants are used by the /sbin/request-key program to determine which program it should run to instantiate a key.</p><p>request-key looks first in /etc/request-key.d/ for a file of the key type name plus ".conf" that it can use.  If that is not found, it will fall back to /etc/request-key.conf.</p><p>request-key scans through the chosen file one line at a time until it finds a match, which it will then use. If it doesn't find a match, it'll return an error and the kernel will automatically negate the key.</p><p>Any blank line or line beginning with a hash mark '#' is considered to be a comment and ignored.</p><p>All other lines are assumed to be command lines with a number of white space separated fields:</p><p>&lt;op&gt; &lt;type&gt; &lt;description&gt; &lt;callout-info&gt; &lt;prog&gt; &lt;arg1&gt; &lt;arg2&gt; ...</p><p>The first four fields are used to match the parameters passed to request-key by the kernel. <em>op</em> is the operation type; currently the only supported operation is "create".</p><p><em>type</em>, <em>description</em> and <em>callout-info</em> match the three parameters passed to <strong>keyctl request2</strong> or the <strong>request_key()</strong> system call. Each of these may contain one or more asterisk '*' characters as wildcards anywhere within the string.</p><p>Should a match be made, the program specified by &lt;prog&gt; will be exec'd. This must have a fully qualified path name. argv[0] will be set from the part of the program name that follows the last slash '/' character.</p><p>If the program name is prefixed with a pipe bar character '|', then the program will be forked and exec'd attached to three pipes. The callout information will be piped to it on it's stdin and the intended payload data will be retrieved from its stdout. Anything sent to stderr will be posted in syslog. If the program exits 0, then /sbin/request-key will attempt to instantiate the key with the data read from stdout. If it fails in any other way, then request-key will attempt to execute the appropriate 'negate' operation command.</p><p>The program arguments can be substituted with various macros. Only complete argument substitution is supported - macro substitutions can't be embedded. All macros begin with a percent character '%'. An argument beginning with two percent characters will have one of them discarded.</p><p>The following macros are supported:</p><p>%o    Operation type</p><p>%k    Key ID</p><p>%t    Key type</p><p>%d    Key description</p><p>%c    Callout information</p><p>%u    Key UID</p><p>%g    Key GID</p><p>%T    Requestor's thread keyring</p><p>%P    Requestor's process keyring</p><p>%S    Requestor's session keyring</p><p>There's another macro substitution too that permits the interpolation of the contents of a key:</p><p>%{&lt;type&gt;:&lt;description&gt;}</p><p>This performs a lookup for a key of the given type and description on the requestor's keyrings, and if found, substitutes the contents for the macro. If not found an error will be logged and the key under construction will be negated.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>A basic file will be installed in the /etc. This will contain two debugging lines that can be used to test the installation:</p><p>create user debug:* negate /bin/keyctl negate %k 30 %S</p><p>create user debug:loop:* * |/bin/cat</p><p>create user debug:* * /usr/share/keyutils/request-key-debug.sh %k %d %c %S</p><p>negate * * * /bin/keyctl negate %k 30 %S</p><p>This is set up so that something like:</p><p>keyctl request2 user debug:xxxx negate</p><p>will create a negative user-defined key, something like:</p><p>keyctl request2 user debug:yyyy spoon</p><p>will create an instantiated user-defined key with "Debug spoon" as the payload, and something like:</p><p>keyctl request2 user debug:loop:zzzz abcdefghijkl</p><p>will create an instantiated user-defined key with the callout information as the payload.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/etc/request-key.conf</p><p>/etc/request-key.d/&lt;keytype&gt;.conf</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO request-key.conf&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/keyctl.1.html"><strong>keyctl</strong>(1)</a>, <a href="../man5/request-key.conf.5.html"><strong>request-key.conf</strong>(5)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="repertoiremap.5.html"><span aria-hidden="true">&larr;</span> repertoiremap.5: Map symbolic character names to unicode code points</a></li>
   <li class="next"><a href="resolv.conf.5.html">resolv.conf.5: Resolver configuration file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
