<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>slapd-sock: Socket backend/overlay to slapd</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Socket backend/overlay to slapd">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">slapd-sock<small> (5)</small></h1>
        <p class="lead">Socket backend/overlay to slapd</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/slapd-sock.5.html">
      <span itemprop="name">slapd-sock: Socket backend/overlay to slapd</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/openldap/">
      <span itemprop="name">openldap</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/slapd-sock.5.html">
      <span itemprop="name">slapd-sock: Socket backend/overlay to slapd</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>ETCDIR/slapd.conf</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The Socket backend to <strong>slapd</strong>(8) uses an external program to handle queries, similarly to <a href="../man5/slapd-shell.5.html"><strong>slapd-shell</strong>(5)</a>. However, in this case the external program listens on a Unix domain socket. This makes it possible to have a pool of processes, which persist between requests. This allows multithreaded operation and a higher level of efficiency. The external program must have been started independently; <strong>slapd</strong>(8) itself will not start it.</p><p>This module may also be used as an overlay on top of some other database. Use as an overlay allows external actions to be triggered in response to operations on the main database.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION</h2>
        <div class="sectioncontent">
<p>These <strong>slapd.conf</strong> options apply to the SOCK backend database. That is, they must follow a "database sock" line and come before any subsequent "backend" or "database" lines. Other database options are described in the <strong>slapd.conf</strong>(5) manual page.</p><p>Alternatively, to use this module as an overlay, these directives must follow an "overlay sock" line within an existing database definition.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>extensions [ binddn | peername | ssf | connid ]*</strong></p>
  </dt>
  <dd>
    <p>Enables the sending of additional meta-attributes with each request.</p>
<pre>
binddn: &lt;bound DN&gt;
peername: IP=&lt;address&gt;:&lt;port&gt;
ssf: &lt;SSF value&gt;
connid: &lt;connection ID&gt;
</pre>

  </dd>
  <dt>
    <p><strong>socketpath <pathname></strong></p>
  </dt>
  <dd>
    <p>Gives the path to a Unix domain socket to which the commands will be sent and from which replies are received.</p><p>When used as an overlay, these additional directives are defined:</p>
  </dd>
  <dt>
    <p><strong>sockops [ bind | unbind | search | compare | modify | modrdn | add | delete ]*</strong></p>
  </dt>
  <dd>
    <p>Specify which request types to send to the external program. The default is empty (no requests are sent).</p>
  </dd>
  <dt>
    <p><strong>sockresps [ result | search ]*</strong></p>
  </dt>
  <dd>
    <p>Specify which response types to send to the external program. "result" sends just the results of an operation. "search" sends all entries that the database returned for a search request. The default is empty (no responses are sent).</p>
  </dd>
  <dt>
    <p><strong>sockdnpat	<regexp></strong></p>
  </dt>
  <dd>
    <p>Specify DN patterns for which the overlay will act. Only operations on DNs matching the specified regular expression will be processed. The default is empty (all DNs are processed).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PROTOCOL</h2>
        <div class="sectioncontent">
<p>The protocol is essentially the same as <a href="../man5/slapd-shell.5.html"><strong>slapd-shell</strong>(5)</a> with the addition of a newline to terminate the command parameters. The following commands are sent:</p>
<pre>
ADD
msgid: &lt;message id&gt;
&lt;repeat { "suffix:" &lt;database suffix DN&gt; }&gt;
&lt;entry in LDIF format&gt;
&lt;blank line&gt;
</pre>

<pre>
BIND
msgid: &lt;message id&gt;
&lt;repeat { "suffix:" &lt;database suffix DN&gt; }&gt;
dn: &lt;DN&gt;
method: &lt;method number&gt;
credlen: &lt;length of &lt;credentials&gt;&gt;
cred: &lt;credentials&gt;
&lt;blank line&gt;
</pre>

<pre>
COMPARE
msgid: &lt;message id&gt;
&lt;repeat { "suffix:" &lt;database suffix DN&gt; }&gt;
dn: &lt;DN&gt;
&lt;attribute&gt;: &lt;value&gt;
&lt;blank line&gt;
</pre>

<pre>
DELETE
msgid: &lt;message id&gt;
&lt;repeat { "suffix:" &lt;database suffix DN&gt; }&gt;
dn: &lt;DN&gt;
&lt;blank line&gt;
</pre>

<pre>
MODIFY
msgid: &lt;message id&gt;
&lt;repeat { "suffix:" &lt;database suffix DN&gt; }&gt;
dn: &lt;DN&gt;
&lt;repeat {
    &lt;"add"/"delete"/"replace"&gt;: &lt;attribute&gt;
    &lt;repeat { &lt;attribute&gt;: &lt;value&gt; }&gt;
    -
}&gt;
&lt;blank line&gt;
</pre>

<pre>
MODRDN
msgid: &lt;message id&gt;
&lt;repeat { "suffix:" &lt;database suffix DN&gt; }&gt;
dn: &lt;DN&gt;
newrdn: &lt;new RDN&gt;
deleteoldrdn: &lt;0 or 1&gt;
&lt;if new superior is specified: "newSuperior: &lt;DN&gt;"&gt;
&lt;blank line&gt;
</pre>

<pre>
SEARCH
msgid: &lt;message id&gt;
&lt;repeat { "suffix:" &lt;database suffix DN&gt; }&gt;
base: &lt;base DN&gt;
scope: &lt;0-2, see ldap.h&gt;
deref: &lt;0-3, see ldap.h&gt;
sizelimit: &lt;size limit&gt;
timelimit: &lt;time limit&gt;
filter: &lt;filter&gt;
attrsonly: &lt;0 or 1&gt;
attrs: &lt;"all" or space-separated attribute list&gt;
&lt;blank line&gt;
</pre>

<pre>
UNBIND
msgid: &lt;message id&gt;
&lt;repeat { "suffix:" &lt;database suffix DN&gt; }&gt;
&lt;blank line&gt;
</pre>
<p>The commands - except <strong>unbind</strong> - should output:</p>
<pre>
RESULT
code: &lt;integer&gt;
matched: &lt;matched DN&gt;
info: &lt;text&gt;
</pre>
<p>where only RESULT is mandatory, and then close the socket. The <strong>search</strong> RESULT should be preceded by the entries in LDIF format, each entry followed by a blank line. Lines starting with `#' or `DEBUG:' are ignored.</p><p>When used as an overlay, the external program should return a CONTINUE response if request processing should continue normally, or a regular RESULT response if the external program wishes to bypass the underlying database.</p><p>If the overlay is configured to send response messages to the external program, they will appear as an extended RESULT message or as an ENTRY message, defined below. The RESULT message is similar to the one above, but also includes the msgid and any configured extensions:</p>
<pre>
RESULT
msgid: &lt;message id&gt;
code: &lt;integer&gt;
matched: &lt;matched DN&gt;
info: &lt;text&gt;
&lt;blank line&gt;
</pre>
<p>Typically both the msgid and the connid will be needed to match a result message to a request. The ENTRY message has the form</p>
<pre>
ENTRY
msgid: &lt;message id&gt;
&lt;entry in LDIF format&gt;
&lt;blank line&gt;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ACCESS CONTROL</h2>
        <div class="sectioncontent">
<p>The <strong>sock</strong> backend does not honor all ACL semantics as described in <strong>slapd.access</strong>(5). In general, access to objects is checked by using a dummy object that contains only the DN, so access rules that rely on the contents of the object are not honored. In detail:</p><p>The <strong>add</strong> operation does not require <strong>write (=w)</strong> access to the <strong>children</strong> pseudo-attribute of the parent entry.</p><p>The <strong>bind</strong> operation requires <strong>auth (=x)</strong> access to the <strong>entry</strong> pseudo-attribute of the entry whose identity is being assessed; <strong>auth (=x)</strong> access to the credentials is not checked, but rather delegated to the underlying program.</p><p>The <strong>compare</strong> operation requires <strong>compare (=c)</strong> access to the <strong>entry</strong> pseudo-attribute of the object whose value is being asserted; <strong>compare (=c)</strong> access to the attribute whose value is being asserted is not checked.</p><p>The <strong>delete</strong> operation does not require <strong>write (=w)</strong> access to the <strong>children</strong> pseudo-attribute of the parent entry.</p><p>The <strong>modify</strong> operation requires <strong>write (=w)</strong> access to the <strong>entry</strong> pseudo-attribute; <strong>write (=w)</strong> access to the specific attributes that are modified is not checked.</p><p>The <strong>modrdn</strong> operation does not require <strong>write (=w)</strong> access to the <strong>children</strong> pseudo-attribute of the parent entry, nor to that of the new parent, if different; <strong>write (=w)</strong> access to the distinguished values of the naming attributes is not checked.</p><p>The <strong>search</strong> operation does not require <strong>search (=s)</strong> access to the <strong>entry</strong> pseudo_attribute of the searchBase; <strong>search (=s)</strong> access to the attributes and values used in the filter is not checked.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>There is an example script in the slapd/back-sock/ directory in the OpenLDAP source tree.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>ETCDIR/slapd.conf</p>
  </dt>
  <dd>
    <p>default slapd configuration file</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO slapd-sock&hellip;</h2>
        <div class="sectioncontent">
<p><strong>slapd.conf</strong>(5), <strong>slapd-config</strong>(5), <strong>slapd</strong>(8).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Brian Candler, with enhancements by Howard Chu</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="slapd-shell.5.html"><span aria-hidden="true">&larr;</span> slapd-shell.5: Shell backend to slapd</a></li>
   <li class="next"><a href="slapd-sql.5.html">slapd-sql.5: Sql backend to slapd <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
