<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>keyctl_get_security: Retrieve a key's security context</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Retrieve a key's security context">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="keyctl_get_security (3) manual">
  <meta name="twitter:description" content="Retrieve a key's security context">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/keyctl_get_security.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="keyctl_get_security (3) manual" />
  <meta property="og:description" content="Retrieve a key's security context" />
  <meta property="fb:app_id" content="1241677679199500" />

</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">keyctl_get_security<small> (3)</small></h1>
        <p class="lead">Retrieve a key's security context</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/keyctl_get_security.3.html">
      <span itemprop="name">keyctl_get_security: Retrieve a key's security context</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/keyutils/">
      <span itemprop="name">keyutils</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/keyctl_get_security.3.html">
      <span itemprop="name">keyctl_get_security: Retrieve a key's security context</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>#include &lt;keyutils.h&gt;</strong>

<strong>long keyctl_get_security(key_serial_t </strong><em>key</em><strong>, char *</strong><em>buffer</em><strong>,</strong>
<strong>size_t </strong><em>buflen</em><strong>);</strong>

<strong>long keyctl_get_security_alloc(key_serial_t </strong><em>key</em><strong>, char **</strong><em>_buffer</em><strong>);</strong>
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>keyctl_get_security</strong>() retrieves the security context of a key as a NUL-terminated string.  This will be rendered in a form appropriate to the LSM in force - for instance, with SELinux, it may look like</p><ul>
<li><p><strong>unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</strong></p></li>
</ul><p>The caller must have <strong>view</strong> permission on a key to be able to get its security context.</p><p><em>buffer</em> and <em>buflen</em> specify the buffer into which the string will be placed.  If the buffer is too small, the full size of the string will be returned, and no copy will take place.</p><p><strong>keyctl_get_security_alloc</strong>() is similar to <strong>keyctl_get_security</strong>() except that it allocates a buffer big enough to hold the string and copies the string into it.  If successful, A pointer to the buffer is placed in <em>*_buffer</em>. The caller must free the buffer.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>On success <strong>keyctl_get_security</strong>() returns the amount of data placed into the buffer.  If the buffer was too small, then the size of buffer required will be returned, but no data will be transferred.  On error, the value <strong>-1</strong> will be returned and errno will have been set to an appropriate error.</p><p>On success <strong>keyctl_get_security_alloc</strong>() returns the amount of data in the buffer, less the NUL terminator.  On error, the value <strong>-1</strong> will be returned and errno will have been set to an appropriate error.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>ENOKEY</strong></p>
  </dt>
  <dd>
    <p>The key specified is invalid.</p>
  </dd>
  <dt>
    <p><strong>EKEYEXPIRED</strong></p>
  </dt>
  <dd>
    <p>The key specified has expired.</p>
  </dd>
  <dt>
    <p><strong>EKEYREVOKED</strong></p>
  </dt>
  <dd>
    <p>The key specified had been revoked.</p>
  </dd>
  <dt>
    <p><strong>EACCES</strong></p>
  </dt>
  <dd>
    <p>The key exists, but is not <strong>viewable</strong> by the calling process.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LINKING</h2>
        <div class="sectioncontent">
<p>This is a library function that can be found in <em>libkeyutils</em>. When linking, <strong>-lkeyutils</strong> should be specified to the linker.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO keyctl_get_security&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/keyctl.1.html"><strong>keyctl</strong>(1)</a>,</p><p><a href="../man2/add_key.2.html"><strong>add_key</strong>(2)</a>,</p><p><a href="../man2/keyctl.2.html"><strong>keyctl</strong>(2)</a>,</p><p><a href="../man2/request_key.2.html"><strong>request_key</strong>(2)</a>,</p><p><a href="../man3/keyctl.3.html"><strong>keyctl</strong>(3)</a>,</p><p><a href="../man7/keyutils.7.html"><strong>keyutils</strong>(7)</a>,</p><p><a href="../man7/keyrings.7.html"><strong>keyrings</strong>(7)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="keyctl_get_persistent.3.html"><span aria-hidden="true">&larr;</span> keyctl_get_persistent.3: Get the persistent keyring for a user</a></li>
   <li class="next"><a href="keyctl_instantiate.3.html">keyctl_instantiate.3: Assume the authority to instantiate a key  keyctl_instantiate - instantiate a key from flat data  keyctl_instantiate_iov - instantiate a key from segmented data  keyctl_reject - negatively instantiate a key specifying search error  keyctl_negate - negatively instantiate a key <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
