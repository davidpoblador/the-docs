<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>getexeccon: Get or set the selinux security context used for executing a new process  rpm_execcon - run a helper for rpm in an appropriate security context</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Get or set the selinux security context used for executing a new process  rpm_execcon - run a helper for rpm in an appropriate security context">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="getexeccon (3) manual">
  <meta name="twitter:description" content="Get or set the selinux security context used for executing a new process  rpm_execcon - run a helper for rpm in an appropriate security context">
  <meta property="og:type" content="website" />
  <meta property="og:title" content="getexeccon (3) manual" />
  <meta property="og:description" content="Get or set the selinux security context used for executing a new process  rpm_execcon - run a helper for rpm in an appropriate security context" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">getexeccon<small> (3)</small></h1>
        <p class="lead">Get or set the selinux security context used for executing a new process  rpm_execcon - run a helper for rpm in an appropriate security context</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/getexeccon.3.html">
      <span itemprop="name">getexeccon: Get or set the selinux security context used for executing a new process  rpm_execcon - run a helper for rpm in an appropriate security context</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/selinux/">
      <span itemprop="name">selinux</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/getexeccon.3.html">
      <span itemprop="name">getexeccon: Get or set the selinux security context used for executing a new process  rpm_execcon - run a helper for rpm in an appropriate security context</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>#include &lt;selinux/selinux.h&gt;</strong></p><p><strong>int getexeccon(char **</strong><em>context</em><strong>);</strong></p><p><strong>int getexeccon_raw(char **</strong><em>context</em><strong>);</strong></p><p><strong>int setexeccon(char * </strong><em>context</em><strong>);</strong></p><p><strong>int setexeccon_raw(char * </strong><em>context</em><strong>);</strong></p><p><strong>int setexecfilecon(const char *</strong><em>filename</em><strong>, const char *</strong><em>fallback_type</em><strong>);</strong></p><p><strong>int rpm_execcon(unsigned int </strong><em>verified</em><strong>, const char *</strong><em>filename</em><strong>, char *const </strong><em>argv</em><strong>[] , char *const </strong><em>envp</em><strong>[]);</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>getexeccon</strong>() retrieves the context used for executing a new process. This returned context should be freed with <a href="../man3/freecon.3.html"><strong>freecon</strong>(3)</a> if non-NULL. <strong>getexeccon</strong>() sets <strong>*</strong><em>context</em> to NULL if no exec context has been explicitly set by the program (i.e. using the default policy behavior).</p><p><strong>setexeccon</strong>() sets the context used for the next <a href="../man2/execve.2.html"><strong>execve</strong>(2)</a> call. NULL can be passed to <strong>setexeccon</strong>() to reset to the default policy behavior. The exec context is automatically reset after the next <a href="../man2/execve.2.html"><strong>execve</strong>(2)</a>, so a program doesn't need to explicitly sanitize it upon startup.</p><p><strong>setexeccon</strong>() can be applied prior to library functions that internally perform an <a href="../man2/execve.2.html"><strong>execve</strong>(2)</a>, e.g. <strong>execl</strong>*(3), <strong>execv</strong>*(3), <a href="../man3/popen.3.html"><strong>popen</strong>(3)</a>, in order to set an exec context for that operation.</p><p><strong>getexeccon_raw</strong>() and <strong>setexeccon_raw</strong>() behave identically to their non-raw counterparts but do not perform context translation.</p><p><strong>Note:</strong> Signal handlers that perform an <a href="../man2/execve.2.html"><strong>execve</strong>(2)</a> must take care to save, reset, and restore the exec context to avoid unexpected behavior.</p><p><strong>setexecfilecon</strong>() sets the context used for the next <a href="../man2/execve.2.html"><strong>execve</strong>(2)</a> call, based on the policy for the <em>filename</em>, and falling back to a new context with a <em>fallback_type</em> in case there is no transition.</p><p><strong>rpm_execcon</strong>() is deprecated; please use <strong>setexecfilecon</strong>() in conjunction with <a href="../man2/execve.2.html"><strong>execve</strong>(2)</a> in all new code. This function runs a helper for rpm in an appropriate security context.  The verified parameter should contain the return code from the signature verification (0 == ok, 1 == notfound, 2 == verifyfail, 3 == nottrusted, 4 == nokey), although this information is not yet used by the function.  The function determines the proper security context for the helper based on policy, sets the exec context accordingly, and then executes the specified filename with the provided argument and environment arrays.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>On error -1 is returned.</p><p>On success <strong>getexeccon</strong>(), <strong>setexeccon</strong>() and <strong>setexecfilecon</strong>() return 0. <strong>rpm_execcon</strong>() only returns upon errors, as it calls <a href="../man2/execve.2.html"><strong>execve</strong>(2)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO getexeccon&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/selinux.8.html"><strong>selinux</strong>(8)</a>, <a href="../man3/freecon.3.html"><strong>freecon</strong>(3)</a>, <a href="../man3/getcon.3.html"><strong>getcon</strong>(3)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="getexeccon.3.html"><span aria-hidden="true">&larr;</span> getexeccon.3: Get or set the selinux security context used for executing a new process  rpm_execcon - run a helper for rpm in an appropriate security context</a></li>
   <li class="next"><a href="getfilecon.3.html">getfilecon.3: Get selinux security context of a file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
