<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>getpwent_r: Get passwd file entry reentrantly</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Get passwd file entry reentrantly">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">getpwent_r<small> (3)</small></h1>
        <p class="lead">Get passwd file entry reentrantly</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/getpwent_r.3.html">
      <span itemprop="name">getpwent_r: Get passwd file entry reentrantly</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/man-pages/">
      <span itemprop="name">man-pages</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/getpwent_r.3.html">
      <span itemprop="name">getpwent_r: Get passwd file entry reentrantly</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>#include <pwd.h></strong>

<strong>int getpwent_r(struct passwd *</strong><em>pwbuf</em><strong>, char *</strong><em>buf</em><strong>,</strong>

<strong>               size_t </strong><em>buflen</em><strong>, struct passwd **</strong><em>pwbufp</em><strong>);</strong>

<strong>int fgetpwent_r(FILE *</strong><em>stream</em><strong>, struct passwd *</strong><em>pwbuf</em><strong>, char *</strong><em>buf</em><strong>,</strong>

<strong>                size_t </strong><em>buflen</em><strong>, struct passwd **</strong><em>pwbufp</em><strong>);</strong>
</pre>
<p>Feature Test Macro Requirements for glibc (see <a href="../man7/feature_test_macros.7.html"><strong>feature_test_macros</strong>(7)</a>):</p><p><strong>getpwent_r</strong>(),</p>
<pre>
    Since glibc 2.19:
        _DEFAULT_SOURCE
    Glibc 2.19 and earlier:
        _BSD_SOURCE || _SVID_SOURCE
</pre>
<p><strong>fgetpwent_r</strong>():</p>
<pre>
    Since glibc 2.19:
        _DEFAULT_SOURCE
    Glibc 2.19 and earlier:
        _SVID_SOURCE
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The functions <strong>getpwent_r</strong>() and <strong>fgetpwent_r</strong>() are the reentrant versions of <a href="../man3/getpwent.3.html"><strong>getpwent</strong>(3)</a> and <a href="../man3/fgetpwent.3.html"><strong>fgetpwent</strong>(3)</a>. The former reads the next passwd entry from the stream initialized by <a href="../man3/setpwent.3.html"><strong>setpwent</strong>(3)</a>. The latter reads the next passwd entry from <em>stream</em>.</p><p>The <em>passwd</em> structure is defined in <em><pwd.h></em> as follows:</p>
<pre>
struct passwd {
    char    *pw_name;      /* username */
    char    *pw_passwd;    /* user password */
    uid_t    pw_uid;       /* user ID */
    gid_t    pw_gid;       /* group ID */
    char    *pw_gecos;     /* user information */
    char    *pw_dir;       /* home directory */
    char    *pw_shell;     /* shell program */
};
</pre>
<p>For more information about the fields of this structure, see <a href="../man5/passwd.5.html"><strong>passwd</strong>(5)</a>.</p><p>The nonreentrant functions return a pointer to static storage, where this static storage contains further pointers to user name, password, gecos field, home directory and shell. The reentrant functions described here return all of that in caller-provided buffers. First of all there is the buffer <em>pwbuf</em> that can hold a <em>struct passwd</em>. And next the buffer <em>buf</em> of size <em>buflen</em> that can hold additional strings. The result of these functions, the <em>struct passwd</em> read from the stream, is stored in the provided buffer <em>*pwbuf</em>, and a pointer to this <em>struct passwd</em> is returned in <em>*pwbufp</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>On success, these functions return 0 and <em>*pwbufp</em> is a pointer to the <em>struct passwd</em>. On error, these functions return an error value and <em>*pwbufp</em> is NULL.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>ENOENT</strong></p>
  </dt>
  <dd>
    <p>No more entries.</p>
  </dd>
  <dt>
    <p><strong>ERANGE</strong></p>
  </dt>
  <dd>
    <p>Insufficient buffer space supplied. Try again with larger buffer.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ATTRIBUTES</h2>
        <div class="sectioncontent">
<p>For an explanation of the terms used in this section, see <a href="../man7/attributes.7.html"><strong>attributes</strong>(7)</a>.</p><table class="table table-striped">
<tr>
<th>Interface</th>
<th>Attribute</th>
<th>Value</th></tr>

<tr>
<td><strong>getpwent_r</strong>()  </td>
<td>Thread safety</td>
<td>MT-Unsafe race:pwent locale</td></tr>

<tr>
<td><strong>fgetpwent_r</strong>()  </td>
<td>Thread safety</td>
<td>MT-Safe</td></tr>
</table><p>In the above table, <em>pwent</em> in <em>race:pwent</em> signifies that if any of the functions <strong>setpwent</strong>(), <strong>getpwent</strong>(), <strong>endpwent</strong>(), or <strong>getpwent_r</strong>() are used in parallel in different threads of a program, then data races could occur.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFORMING TO</h2>
        <div class="sectioncontent">
<p>These functions are GNU extensions, done in a style resembling the POSIX version of functions like <a href="../man3/getpwnam_r.3.html"><strong>getpwnam_r</strong>(3)</a>. Other systems use the prototype</p>
<pre>
struct passwd *
getpwent_r(struct passwd *pwd, char *buf, int buflen);
</pre>
<p>or, better,</p>
<pre>
int
getpwent_r(struct passwd *pwd, char *buf, int buflen,
           FILE **pw_fp);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>The function <strong>getpwent_r</strong>() is not really reentrant since it shares the reading position in the stream with all other threads.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<pre>
#define _GNU_SOURCE
#include &lt;pwd.h&gt;
#include &lt;stdio.h&gt;
#define BUFLEN 4096

int
main(void)
{
    struct passwd pw, *pwp;
    char buf[BUFLEN];
    int i;

    setpwent();
    while (1) {
        i = getpwent_r(&pw, buf, BUFLEN, &pwp);
        if (i)
            break;
        printf("%s (%d)&#92;tHOME %s&#92;tSHELL %s&#92;n", pwp-&gt;pw_name,
               pwp-&gt;pw_uid, pwp-&gt;pw_dir, pwp-&gt;pw_shell);
    }
    endpwent();
    exit(EXIT_SUCCESS);
}
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO getpwent_r&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man3/fgetpwent.3.html"><strong>fgetpwent</strong>(3)</a>, <a href="../man3/getpw.3.html"><strong>getpw</strong>(3)</a>, <a href="../man3/getpwent.3.html"><strong>getpwent</strong>(3)</a>, <a href="../man3/getpwnam.3.html"><strong>getpwnam</strong>(3)</a>, <a href="../man3/getpwuid.3.html"><strong>getpwuid</strong>(3)</a>, <a href="../man3/putpwent.3.html"><strong>putpwent</strong>(3)</a>, <a href="../man5/passwd.5.html"><strong>passwd</strong>(5)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="fgetpwent.3.html"><span aria-hidden="true">&larr;</span> fgetpwent.3: Get password file entry</a></li>
   <li class="next"><a href="fgets.3.html">fgets.3: Input of characters and strings <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
