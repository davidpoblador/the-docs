<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>avc_netlink_loop: Selinux netlink processing</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Selinux netlink processing">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="avc_netlink_loop (3) manual">
  <meta name="twitter:description" content="Selinux netlink processing">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">avc_netlink_loop<small> (3)</small></h1>
        <p class="lead">Selinux netlink processing</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/avc_netlink_loop.3.html">
      <span itemprop="name">avc_netlink_loop: Selinux netlink processing</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/selinux/">
      <span itemprop="name">selinux</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/avc_netlink_loop.3.html">
      <span itemprop="name">avc_netlink_loop: Selinux netlink processing</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>#include &lt;selinux/selinux.h&gt;</strong></p><p><strong>#include &lt;selinux/avc.h&gt;</strong></p><p><strong>int avc_netlink_open(int </strong><em>blocking</em><strong>);</strong></p><p><strong>void avc_netlink_close(void);</strong></p><p><strong>int avc_netlink_acquire_fd(void);</strong></p><p><strong>void avc_netlink_release_fd(void);</strong></p><p><strong>void avc_netlink_loop(void);</strong></p><p><strong>int avc_netlink_check_nb(void);</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>These functions enable applications to handle notification of SELinux events via netlink.  The userspace AVC normally checks for netlink messages on each call to <a href="../man3/avc_has_perm.3.html"><strong>avc_has_perm</strong>(3)</a>. Applications may wish to override this behavior and check for notification separately, for example in a <a href="../man2/select.2.html"><strong>select</strong>(2)</a> loop.  These functions also permit netlink monitoring without requiring a call to <a href="../man3/avc_open.3.html"><strong>avc_open</strong>(3)</a>.</p><p><strong>avc_netlink_open</strong>() opens a netlink socket to receive SELinux notifications.  The socket descriptor is stored internally; use <a href="../man3/avc_netlink_acquire_fd.3.html"><strong>avc_netlink_acquire_fd</strong>(3)</a> to take ownership of it in application code.  The <em>blocking</em> argument controls whether the O_NONBLOCK flag is set on the socket descriptor. <a href="../man3/avc_open.3.html"><strong>avc_open</strong>(3)</a> calls this function internally, specifying non-blocking behavior.</p><p><strong>avc_netlink_close</strong>() closes the netlink socket.  This function is called automatically by <a href="../man3/avc_destroy.3.html"><strong>avc_destroy</strong>(3)</a>.</p><p><strong>avc_netlink_acquire_fd</strong>() returns the netlink socket descriptor number and informs the userspace AVC not to check the socket descriptor automatically on calls to <a href="../man3/avc_has_perm.3.html"><strong>avc_has_perm</strong>(3)</a>.</p><p><strong>avc_netlink_release_fd</strong>() returns control of the netlink socket to the userspace AVC, re-enabling automatic processing of notifications.</p><p><strong>avc_netlink_check_nb</strong>() checks the netlink socket for pending messages and processes them. Callbacks for policyload and enforcing changes will be called; see <a href="../man3/selinux_set_callback.3.html"><strong>selinux_set_callback</strong>(3)</a>. This function does not block.</p><p><strong>avc_netlink_loop</strong>() enters a loop blocking on the netlink socket and processing messages as they are received.  This function will not return unless an error occurs on the socket, in which case the socket is closed.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p><strong>avc_netlink_acquire_fd</strong>() returns a non-negative file descriptor number on success.  Other functions with a return value return zero on success.  On error, -1 is returned and <em>errno</em> is set appropriately.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO avc_netlink_loop&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man3/avc_open.3.html"><strong>avc_open</strong>(3)</a>, <a href="../man3/selinux_set_callback.3.html"><strong>selinux_set_callback</strong>(3)</a>, <a href="../man8/selinux.8.html"><strong>selinux</strong>(8)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="avc_netlink_check_nb.3.html"><span aria-hidden="true">&larr;</span> avc_netlink_check_nb.3: Selinux netlink processing</a></li>
   <li class="next"><a href="avc_netlink_loop.3.html">avc_netlink_loop.3: Selinux netlink processing <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
