<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pthread_setschedparam: Set/get scheduling policy and parameters of a thread</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Set/get scheduling policy and parameters of a thread">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pthread_setschedparam<small> (3)</small></h1>
        <p class="lead">Set/get scheduling policy and parameters of a thread</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/pthread_setschedparam.3.html">
      <span itemprop="name">pthread_setschedparam: Set/get scheduling policy and parameters of a thread</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/man-pages/">
      <span itemprop="name">man-pages</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/pthread_setschedparam.3.html">
      <span itemprop="name">pthread_setschedparam: Set/get scheduling policy and parameters of a thread</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>#include <pthread.h></strong>

<strong>int pthread_setschedparam(pthread_t </strong><em>thread</em><strong>, int </strong><em>policy</em><strong>,</strong>
<strong>                          const struct sched_param *</strong><em>param</em><strong>);</strong>
<strong>int pthread_getschedparam(pthread_t </strong><em>thread</em><strong>, int *</strong><em>policy</em><strong>,</strong>
<strong>                          struct sched_param *</strong><em>param</em><strong>);</strong>

Compile and link with <em>-pthread</em>.
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <strong>pthread_setschedparam</strong>() function sets the scheduling policy and parameters of the thread <em>thread</em>.</p><p><em>policy</em> specifies the new scheduling policy for <em>thread</em>. The supported values for <em>policy</em>, and their semantics, are described in <a href="../man7/sched.7.html"><strong>sched</strong>(7)</a>.</p><p>The structure pointed to by <em>param</em> specifies the new scheduling parameters for <em>thread</em>. Scheduling parameters are maintained in the following structure:</p>
<pre>
struct sched_param {
    int sched_priority;     /* Scheduling priority */
};
</pre>
<p>As can be seen, only one scheduling parameter is supported. For details of the permitted ranges for scheduling priorities in each scheduling policy, see <a href="../man7/sched.7.html"><strong>sched</strong>(7)</a>.</p><p>The <strong>pthread_getschedparam</strong>() function returns the scheduling policy and parameters of the thread <em>thread</em>, in the buffers pointed to by <em>policy</em> and <em>param</em>, respectively. The returned priority value is that set by the most recent <strong>pthread_setschedparam</strong>(), <a href="../man3/pthread_setschedprio.3.html"><strong>pthread_setschedprio</strong>(3)</a>, or <a href="../man3/pthread_create.3.html"><strong>pthread_create</strong>(3)</a> call that affected <em>thread</em>. The returned priority does not reflect any temporary priority adjustments as a result of calls to any priority inheritance or priority ceiling functions (see, for example, <strong>pthread_mutexattr_setprioceiling</strong>(3) and <strong>pthread_mutexattr_setprotocol</strong>(3)).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>On success, these functions return 0; on error, they return a nonzero error number. If <strong>pthread_setschedparam</strong>() fails, the scheduling policy and parameters of <em>thread</em> are not changed.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">
<p>Both of these functions can fail with the following error:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>ESRCH</strong></p>
  </dt>
  <dd>
    <p>No thread with the ID <em>thread</em> could be found.</p>
  </dd>

</dl>
<p><strong>pthread_setschedparam</strong>() may additionally fail with the following errors:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>EINVAL</strong></p>
  </dt>
  <dd>
    <p><em>policy</em> is not a recognized policy, or <em>param</em> does not make sense for the <em>policy</em>.</p>
  </dd>
  <dt>
    <p><strong>EPERM</strong></p>
  </dt>
  <dd>
    <p>The caller does not have appropriate privileges to set the specified scheduling policy and parameters.</p>
  </dd>

</dl>
<p>POSIX.1 also documents an <strong>ENOTSUP</strong> ("attempt was made to set the policy or scheduling parameters to an unsupported value") error for <strong>pthread_setschedparam</strong>().</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ATTRIBUTES</h2>
        <div class="sectioncontent">
<p>For an explanation of the terms used in this section, see <a href="../man7/attributes.7.html"><strong>attributes</strong>(7)</a>.</p><table class="table table-striped">
<tr>
<th>Interface</th>
<th>Attribute</th>
<th>Value</th></tr>

<tr>
<td><strong>pthread_setschedparam</strong>(),   <strong>pthread_getschedparam</strong>()  </td>
<td>Thread safety</td>
<td>MT-Safe</td></tr>
</table>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFORMING TO</h2>
        <div class="sectioncontent">
<p>POSIX.1-2001, POSIX.1-2008.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>For a description of the permissions required to, and the effect of, changing a thread's scheduling policy and priority, and details of the permitted ranges for priorities in each scheduling policy, see <a href="../man7/sched.7.html"><strong>sched</strong>(7)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>The program below demonstrates the use of <strong>pthread_setschedparam</strong>() and <strong>pthread_getschedparam</strong>(), as well as the use of a number of other scheduling-related pthreads functions.</p><p>In the following run, the main thread sets its scheduling policy to <strong>SCHED_FIFO</strong> with a priority of 10, and initializes a thread attributes object with a scheduling policy attribute of <strong>SCHED_RR</strong> and a scheduling priority attribute of 20. The program then sets (using <a href="../man3/pthread_attr_setinheritsched.3.html"><strong>pthread_attr_setinheritsched</strong>(3)</a>) the inherit scheduler attribute of the thread attributes object to <strong>PTHREAD_EXPLICIT_SCHED</strong>, meaning that threads created using this attributes object should take their scheduling attributes from the thread attributes object. The program then creates a thread using the thread attributes object, and that thread displays its scheduling policy and priority.</p>
<pre>

$ <strong>su</strong>      # Need privilege to set real-time scheduling policies
Password:
# <strong>./a.out -mf10 -ar20 -i e</strong>
Scheduler settings of main thread
    policy=SCHED_FIFO, priority=10

Scheduler settings in &apos;attr&apos;
    policy=SCHED_RR, priority=20
    inheritsched is EXPLICIT

Scheduler attributes of new thread
    policy=SCHED_RR, priority=20
</pre>
<p>In the above output, one can see that the scheduling policy and priority were taken from the values specified in the thread attributes object.</p><p>The next run is the same as the previous, except that the inherit scheduler attribute is set to <strong>PTHREAD_INHERIT_SCHED</strong>, meaning that threads created using the thread attributes object should ignore the scheduling attributes specified in the attributes object and instead take their scheduling attributes from the creating thread.</p>
<pre>
# <strong>./a.out -mf10 -ar20 -i i</strong>
Scheduler settings of main thread
    policy=SCHED_FIFO, priority=10

Scheduler settings in &apos;attr&apos;
    policy=SCHED_RR, priority=20
    inheritsched is INHERIT

Scheduler attributes of new thread
    policy=SCHED_FIFO, priority=10
</pre>
<p>In the above output, one can see that the scheduling policy and priority were taken from the creating thread, rather than the thread attributes object.</p><p>Note that if we had omitted the <em>-i&nbsp;i</em> option, the output would have been the same, since <strong>PTHREAD_INHERIT_SCHED</strong> is the default for the inherit scheduler attribute.</p><h3>Program source</h3>

<pre>
/* pthreads_sched_test.c */

#include &lt;pthread.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;errno.h&gt;

#define handle_error_en(en, msg) &#92;
        do { errno = en; perror(msg); exit(EXIT_FAILURE); } while (0)

static void
usage(char *prog_name, char *msg)
{
    if (msg != NULL)
        fputs(msg, stderr);

    fprintf(stderr, "Usage: %s [options]&#92;n", prog_name);
    fprintf(stderr, "Options are:&#92;n");
#define fpe(msg) fprintf(stderr, "&#92;t%s", msg);          /* Shorter */
    fpe("-a&lt;policy&gt;&lt;prio&gt; Set scheduling policy and priority in&#92;n");
    fpe("                 thread attributes object&#92;n");
    fpe("                 &lt;policy&gt; can be&#92;n");
    fpe("                     f  SCHED_FIFO&#92;n");
    fpe("                     r  SCHED_RR&#92;n");
    fpe("                     o  SCHED_OTHER&#92;n");
    fpe("-A               Use default thread attributes object&#92;n");
    fpe("-i {e|i}         Set inherit scheduler attribute to&#92;n");
    fpe("                 &apos;explicit&apos; or &apos;inherit&apos;&#92;n");
    fpe("-m&lt;policy&gt;&lt;prio&gt; Set scheduling policy and priority on&#92;n");
    fpe("                 main thread before pthread_create() call&#92;n");
    exit(EXIT_FAILURE);
}

static int
get_policy(char p, int *policy)
{
    switch (p) {
    case &apos;f&apos;: *policy = SCHED_FIFO;     return 1;
    case &apos;r&apos;: *policy = SCHED_RR;       return 1;
    case &apos;o&apos;: *policy = SCHED_OTHER;    return 1;
    default:  return 0;
    }
}

static void
display_sched_attr(int policy, struct sched_param *param)
{
    printf("    policy=%s, priority=%d&#92;n",
            (policy == SCHED_FIFO)  ? "SCHED_FIFO" :
            (policy == SCHED_RR)    ? "SCHED_RR" :
            (policy == SCHED_OTHER) ? "SCHED_OTHER" :
            "???",
            param-&gt;sched_priority);
}

static void
display_thread_sched_attr(char *msg)
{
    int policy, s;
    struct sched_param param;

    s = pthread_getschedparam(pthread_self(), &policy, &param);
    if (s != 0)
        handle_error_en(s, "pthread_getschedparam");

    printf("%s&#92;n", msg);
    display_sched_attr(policy, &param);
}

static void *
thread_start(void *arg)
{
    display_thread_sched_attr("Scheduler attributes of new thread");

    return NULL;
}

int
main(int argc, char *argv[])
{
    int s, opt, inheritsched, use_null_attrib, policy;
    pthread_t thread;
    pthread_attr_t attr;
    pthread_attr_t *attrp;
    char *attr_sched_str, *main_sched_str, *inheritsched_str;
    struct sched_param param;

    /* Process command-line options */

    use_null_attrib = 0;
    attr_sched_str = NULL;
    main_sched_str = NULL;
    inheritsched_str = NULL;

    while ((opt = getopt(argc, argv, "a:Ai:m:")) != -1) {
        switch (opt) {
        case &apos;a&apos;: attr_sched_str = optarg;      break;
        case &apos;A&apos;: use_null_attrib = 1;          break;
        case &apos;i&apos;: inheritsched_str = optarg;    break;
        case &apos;m&apos;: main_sched_str = optarg;      break;
        default:  usage(argv[0], "Unrecognized option&#92;n");
        }
    }

    if (use_null_attrib &&
            (inheritsched_str != NULL || attr_sched_str != NULL))
        usage(argv[0], "Can&apos;t specify -A with -i or -a&#92;n");

    /* Optionally set scheduling attributes of main thread,
       and display the attributes */

    if (main_sched_str != NULL) {
        if (!get_policy(main_sched_str[0], &policy))
            usage(argv[0], "Bad policy for main thread (-m)&#92;n");
        param.sched_priority = strtol(&main_sched_str[1], NULL, 0);

        s = pthread_setschedparam(pthread_self(), policy, &param);
        if (s != 0)
            handle_error_en(s, "pthread_setschedparam");
    }

    display_thread_sched_attr("Scheduler settings of main thread");
    printf("&#92;n");

    /* Initialize thread attributes object according to options */

    attrp = NULL;

    if (!use_null_attrib) {
        s = pthread_attr_init(&attr);
        if (s != 0)
            handle_error_en(s, "pthread_attr_init");
        attrp = &attr;
    }

    if (inheritsched_str != NULL) {
        if (inheritsched_str[0] == &apos;e&apos;)
            inheritsched = PTHREAD_EXPLICIT_SCHED;
        else if (inheritsched_str[0] == &apos;i&apos;)
            inheritsched = PTHREAD_INHERIT_SCHED;
        else
            usage(argv[0], "Value for -i must be &apos;e&apos; or &apos;i&apos;&#92;n");

        s = pthread_attr_setinheritsched(&attr, inheritsched);
        if (s != 0)
            handle_error_en(s, "pthread_attr_setinheritsched");
    }

    if (attr_sched_str != NULL) {
        if (!get_policy(attr_sched_str[0], &policy))
            usage(argv[0],
                    "Bad policy for &apos;attr&apos; (-a)&#92;n");
        param.sched_priority = strtol(&attr_sched_str[1], NULL, 0);

        s = pthread_attr_setschedpolicy(&attr, policy);
        if (s != 0)
            handle_error_en(s, "pthread_attr_setschedpolicy");
        s = pthread_attr_setschedparam(&attr, &param);
        if (s != 0)
            handle_error_en(s, "pthread_attr_setschedparam");
    }

    /* If we initialized a thread attributes object, display
       the scheduling attributes that were set in the object */

    if (attrp != NULL) {
        s = pthread_attr_getschedparam(&attr, &param);
        if (s != 0)
            handle_error_en(s, "pthread_attr_getschedparam");
        s = pthread_attr_getschedpolicy(&attr, &policy);
        if (s != 0)
            handle_error_en(s, "pthread_attr_getschedpolicy");

        printf("Scheduler settings in &apos;attr&apos;&#92;n");
        display_sched_attr(policy, &param);

        s = pthread_attr_getinheritsched(&attr, &inheritsched);
        printf("    inheritsched is %s&#92;n",
                (inheritsched == PTHREAD_INHERIT_SCHED)  ? "INHERIT" :
                (inheritsched == PTHREAD_EXPLICIT_SCHED) ? "EXPLICIT" :
                "???");
        printf("&#92;n");
    }

    /* Create a thread that will display its scheduling attributes */

    s = pthread_create(&thread, attrp, &thread_start, NULL);
    if (s != 0)
        handle_error_en(s, "pthread_create");

    /* Destroy unneeded thread attributes object */

    if (!use_null_attrib) {
      s = pthread_attr_destroy(&attr);
      if (s != 0)
          handle_error_en(s, "pthread_attr_destroy");
    }

    s = pthread_join(thread, NULL);
    if (s != 0)
        handle_error_en(s, "pthread_join");

    exit(EXIT_SUCCESS);
}
</pre>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO pthread_setschedparam&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man2/getrlimit.2.html"><strong>getrlimit</strong>(2)</a>, <a href="../man2/sched_get_priority_min.2.html"><strong>sched_get_priority_min</strong>(2)</a>, <a href="../man3/pthread_attr_init.3.html"><strong>pthread_attr_init</strong>(3)</a>, <a href="../man3/pthread_attr_setinheritsched.3.html"><strong>pthread_attr_setinheritsched</strong>(3)</a>, <a href="../man3/pthread_attr_setschedparam.3.html"><strong>pthread_attr_setschedparam</strong>(3)</a>, <a href="../man3/pthread_attr_setschedpolicy.3.html"><strong>pthread_attr_setschedpolicy</strong>(3)</a>, <a href="../man3/pthread_create.3.html"><strong>pthread_create</strong>(3)</a>, <a href="../man3/pthread_self.3.html"><strong>pthread_self</strong>(3)</a>, <a href="../man3/pthread_setschedprio.3.html"><strong>pthread_setschedprio</strong>(3)</a>, <a href="../man7/pthreads.7.html"><strong>pthreads</strong>(7)</a>, <a href="../man7/sched.7.html"><strong>sched</strong>(7)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pthread_getname_np.3.html"><span aria-hidden="true">&larr;</span> pthread_getname_np.3: Set/get the name of a thread</a></li>
   <li class="next"><a href="pthread_join.3.html">pthread_join.3: Join with a terminated thread <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
