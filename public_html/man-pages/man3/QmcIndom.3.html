<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>QmcIndom: Container for a instance domain description</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Container for a instance domain description">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="QmcIndom (3) manual">
  <meta name="twitter:description" content="Container for a instance domain description">
  <meta name="twitter:image" content="https://www.carta.tech/images/pcp-QmcIndom-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/QmcIndom.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="QmcIndom (3) manual" />
  <meta property="og:description" content="Container for a instance domain description" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/pcp-QmcIndom-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">QmcIndom<small> (3)</small></h1>
        <p class="lead">Container for a instance domain description</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/QmcIndom.3.html">
      <span itemprop="name">QmcIndom: Container for a instance domain description</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/pcp/">
      <span itemprop="name">pcp</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/QmcIndom.3.html">
      <span itemprop="name">QmcIndom: Container for a instance domain description</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">C++ SYNOPSIS</h2>
        <div class="sectioncontent">
<p>#include &lt;QmcIndom.h&gt;</p><p>CC ... -lqmc -lpcp</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>A <strong>QmcIndom</strong> object represents a <a href="../man3/pmapi.3.html"><strong>PMAPI</strong>(3)</a> instance domain.  This includes a description of all the instances in the instance domain.</p><p>A <strong>QmcInstance</strong> is a structure used to describe each instance in the instance domain.  This includes:</p><p>- internal identifier. If this is less than zero, the instance is treated as a NULL entry in the instance table.</p><p>- external name</p><p>- reference count, ie. the number of <strong>QmcMetric</strong> objects referring to this instance.</p><p>- the likely position of the instance in the <strong>pmResult</strong> from a <a href="../man3/pmfetch.3.html"><strong>pmFetch</strong>(3)</a>. This is also used to indicate the position of the next NULL instance in the instance table, if this entry is also NULL.</p><p>- a flag indicating if the instance was in the last <a href="../man3/pmgetindom.3.html"><strong>pmGetInDom</strong>(3)</a>.</p><p>The <strong>QmcIndom</strong> object has a list of <strong>QmcInstance</strong> structures, and various flags and counters to support dynamic instance domains where instances may come and go with each fetch and efficient profile generation.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONSTRUCTORS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>QmcIndom::QmcIndom(int type, QmcDesc &desc);</strong></p>
  </dt>
  <dd>
    <p>Calls <a href="../man3/pmgetindom.3.html"><strong>pmGetInDom</strong>(3)</a> and <a href="../man3/pmgetindomarchive.3.html"><strong>pmGetInDomArchive</strong>(3)</a> for host and archive contexts to obtain the entire instance list for the instance domain of <em>type</em> and identified in <em>desc</em>.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DYNAMIC INDOMS</h2>
        <div class="sectioncontent">
<p>The support of dynamic instance domains for live contexts is complex since many metrics may be referencing any of the instances in the domain.  Therefore the instance list may be sparse as the position of instances in the list must be maintained.</p><p>When the instance domain is updated, instances may be removed from the list if they are not in the new instance list (as returned by <a href="../man3/pmgetindom.3.html"><strong>pmGetInDom</strong>(3)</a>) and is not referenced by any metrics. Each instance in the new list is then compared with the old list to determine which instances are still active, and any new instances need to be added.  An instance is considered the same if both the internal and external identifiers are the same.  New instances are first inserted into positions of deleted instances before being appended to the list.</p><p>This algorithm is expensive (potentially O(N^2)).</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>bool changed() const;</strong></p>
  </dt>
  <dd>
    <p>Returns <strong>true</strong> if the instance domain may have changed in the last fetch.</p>
  </dd>
  <dt>
    <p><strong>void newFetch();</strong></p>
  </dt>
  <dd>
    <p>Reset the flags that may have indicated that the instance domain had changed. This is called by <strong>QmcContext::fetch</strong>.</p>
  </dd>
  <dt>
    <p><strong>void hasChanged();</strong></p>
  </dt>
  <dd>
    <p>Set the flags to indicate that the instance domain may have changed.  This is called by <strong>QmcMetric::extractValues</strong>.</p>
  </dd>
  <dt>
    <p><strong>int update();</strong></p>
  </dt>
  <dd>
    <p>Update the instance domain as described above. On subsequent calls, before the next fetch, this method will remove any instances that are no longer referenced without updating the instance list with a <a href="../man3/pmgetindom.3.html"><strong>pmGetInDom</strong>(3)</a> call.</p>
  </dd>
  <dt>
    <p><strong>uint_t numInsts() const;</strong></p>
  </dt>
  <dd>
    <p>Returns the number of instances that are not NULL.</p>
  </dd>
  <dt>
    <p><strong>uint_t numActiveInsts() const;</strong></p>
  </dt>
  <dd>
    <p>Returns the number of instances that are active according to the last <strong>QmcIndom::update</strong> call.</p>
  </dd>
  <dt>
    <p><strong>uint_t listLen() const;</strong></p>
  </dt>
  <dd>
    <p>Returns the length of the instance list, including NULL instances.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PROFILES</h2>
        <div class="sectioncontent">
<p>The algorithm for determining the most compact profile uses the number of instances (<strong>_instances.length()</strong>), the number of referenced instances (<strong>_count</strong>), the number of active instances (<strong>_numActive</strong>) and the number of referenced active instances (<strong>_numActiveRef</strong>).</p>
<pre>
if (all active instances are referenced
    or there are no active instances)

        request all instances implicitly

else if (the number of referenced instances
         is less than the number of active
         instances that are not referenced)

        delete all instances from profile
        add all referenced instances

else

        add all instances to profile
        delete all instances that are not referenced
</pre>

<dl class='dl-vertical'>
  <dt>
    <p><strong>bool diffProfile() const;</strong></p>
  </dt>
  <dd>
    <p>Returns <strong>true</strong> if the profile has potentially changed since the last call to <strong>QmcIndom::genProfile</strong>.</p>
  </dd>
  <dt>
    <p><strong>int genProfile();</strong></p>
  </dt>
  <dd>
    <p>Generates a new profile for the instance domain. a <a href="../man3/pmapi.3.html"><strong>PMAPI</strong>(3)</a> error code is returned if the profile failed.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO QmcIndom&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man3/pmapi.3.html"><strong>PMAPI</strong>(3)</a>, <a href="../man3/QMC.3.html"><strong>QMC</strong>(3)</a>, <a href="../man3/QmcContext.3.html"><strong>QmcContext</strong>(3)</a>, <a href="../man3/QmcDesc.3.html"><strong>QmcDesc</strong>(3)</a>, <a href="../man3/QmcMetric.3.html"><strong>QmcMetric</strong>(3)</a>, <a href="../man3/pmfetch.3.html"><strong>pmFetch</strong>(3)</a>, <strong>pmflush</strong>(3), <a href="../man3/pmgetindom.3.html"><strong>pmGetInDom</strong>(3)</a>, <a href="../man3/pmgetindomarchive.3.html"><strong>pmGetInDomArchive</strong>(3)</a> and <a href="../man3/pmprintf.3.html"><strong>pmprintf</strong>(3)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">
<p>Error messages are generated using <a href="../man3/pmprintf.3.html"><strong>pmprintf</strong>(3)</a> but are not flushed. It is the responsibility of the user to call <strong>pmflush</strong>(3) to output any messages.</p><p>Additional diagnostics may be activated by adding <strong>DBG_TRACE_PMC</strong> and <strong>DBG_TRACE_INDOM</strong> to the global <em>pmDebug</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>User's have no control over the algorithm used to generate the profile. In the case of <em>proc</em> metrics, an implicit profile could be generated if all process instances are required, even though this will result in no values being returned in the fetch.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="QmcGroup.3.html"><span aria-hidden="true">&larr;</span> QmcGroup.3: Container representing a single fetch group of metrics from multiple sources</a></li>
   <li class="next"><a href="QmcMetric.3.html">QmcMetric.3: Container for a metric and all its values <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
