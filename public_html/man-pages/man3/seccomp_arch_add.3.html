<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>seccomp_arch_add - Manage seccomp filter architectures</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Manage seccomp filter architectures">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">seccomp_arch_add<small> (3)</small></h1>
        <p class="lead">Manage seccomp filter architectures</p>
      </div>

    <ol class="breadcrumb">
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="/"><span itemprop="title">Carta.tech</span></a>
	</li>
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="https://www.carta.tech/man-pages/"><span itemprop="title">Man Pages</span></a>
	</li>
	<li id="breadcrumb_section" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_page" itemprop="child">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man3/"><span itemprop="title">Library calls</span></a>
	</li>
	<li id="breadcrumb_page" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="active">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man3/seccomp_arch_add.3.html"><span itemprop="title">seccomp_arch_add</span></a>
	</li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre><strong>#include &lt;seccomp.h&gt;</strong>

<strong>typedef void * scmp_filter_ctx;</strong>

<strong>#define SCMP_ARCH_NATIVE</strong>
<strong>#define SCMP_ARCH_X86</strong>
<strong>#define SCMP_ARCH_X86_64</strong>

<strong>uint32_t seccomp_arch_resolve_name(const char *</strong><em>arch_name</em><strong>);</strong>
<strong>uint32_t seccomp_arch_native();</strong>
<strong>int seccomp_arch_exist(const scmp_filter_ctx </strong><em>ctx</em><strong>, uint32_t </strong><em>arch_token</em><strong>);</strong>
<strong>int seccomp_arch_add(scmp_filter_ctx </strong><em>ctx</em><strong>, uint32_t </strong><em>arch_token</em><strong>);</strong>
<strong>int seccomp_arch_remove(scmp_filter_ctx </strong><em>ctx</em><strong>, uint32_t </strong><em>arch_token</em><strong>);</strong>

Link with <em>-lseccomp</em>.</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>The <strong>seccomp_arch_exist</strong>() function tests to see if a given architecture has been added to the seccomp filter in <em>ctx</em> , where the <strong>seccomp_arch_add</strong>() and <strong>seccomp_arch_remove</strong>() add and remove, respectively, architectures from the seccomp filter.  In all three functions, the architecture values given in <em>arch_token</em> should be the <strong>SCMP_ARCH_*</strong> defined constants; with the <strong>SCMP_ARCH_NATIVE</strong> constant always referring to the native compiled architecture.  The <strong>seccomp_arch_native</strong>() function returns the system's architecture such that it will match one of the <strong>SCMP_ARCH_*</strong> constants.  While the <strong>seccomp_arch_resolve_name</strong>() function also returns a <strong>SCMP_ARCH_*</strong> constant, the returned token matches the name of the architecture passed as an argument to the function.</p>
<p class='spacer'>

<p>When a seccomp filter is initialized with the call to <a href="../man3/seccomp_init.3.html"><strong>seccomp_init</strong>(3)</a> the native architecture is automatically added to the filter.</p>
<p class='spacer'>

<p>While it is possible to remove all architectures from a filter, most of the libseccomp APIs will fail if the filter does not contain at least one architecture.</p>
<p class='spacer'>

<p>When adding a new architecture to an existing filter, the existing rules will not be added to the new architecture.  However, rules added after adding the new architecture will be added to all of the architectures in the filter.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">

<p>The <strong>seccomp_arch_add</strong>() and <strong>seccomp_arch_remove</strong>() functions return zero on success, negative errno values on failure.  The <strong>seccomp_arch_exist</strong>() function returns zero if the architecture exists, -EEXIST if it does not, and other negative errno values on failure.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">

<pre>#include &lt;seccomp.h&gt;

int main(int argc, char *argv[])
{
	int rc = -1;
	scmp_filter_ctx ctx;

	ctx = seccomp_init(SCMP_ACT_KILL);
	if (ctx == NULL)
		goto out;

	if (seccomp_arch_exist(ctx, SCMP_ARCH_X86) == -EEXIST) {
		rc = seccomp_arch_add(ctx, SCMP_ARCH_X86);
		if (rc != 0)
			goto out_all;
		rc = seccomp_arch_remove(ctx, SCMP_ARCH_NATIVE);
		if (rc != 0)
			goto out_all;
	}

	/* ... */

out:
	seccomp_release(ctx);
	return -rc;
}</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>While the seccomp filter can be generated independent of the kernel, kernel support is required to load and enforce the seccomp filter generated by libseccomp.</p>
<p class='spacer'>

<p>The libseccomp project site, with more information and the source code repository, can be found at https://github.com/seccomp/libseccomp.  This tool, as well as the libseccomp library, is currently under development, please report any bugs at the project site or directly to the author.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">

<p>Paul Moore &lt;paul@paul-moore.com&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<p><a href="../man3/seccomp_init.3.html"><strong>seccomp_init</strong>(3)</a>, <a href="../man3/seccomp_reset.3.html"><strong>seccomp_reset</strong>(3)</a>, <strong>seccom_merge</strong>(3)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="sctp_sendmsg.3.html"><span aria-hidden="true">&larr;</span> sctp_sendmsg.3: Send a message from a SCTP socket.</a></li>
   <li class="next"><a href="seccomp_arch_exist.3.html">seccomp_arch_exist.3: Manage seccomp filter architectures <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
