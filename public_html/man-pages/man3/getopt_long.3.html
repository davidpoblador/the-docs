<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>getopt_long - Parse command-line options</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Parse command-line options">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">getopt_long<small> (3)</small></h1>
        <p class="lead">Parse command-line options</p>
      </div>

    <ol class="breadcrumb">
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="https://www.carta.tech/man-pages/"><span itemprop="title">Linux Man Pages</span></a>
	</li>
	<li id="breadcrumb_section" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_page" itemprop="child">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man3/"><span itemprop="title">Library calls</span></a>
	</li>
	<li id="breadcrumb_page" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="active">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man3/getopt_long.3.html"><span itemprop="title">getopt_long</span></a>
	</li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre><strong>#include &lt;unistd.h&gt;</strong>

<strong>int getopt(int </strong><em>argc</em><strong>, char * const </strong><em>argv[]</em><strong>,</strong>
<strong>           const char *</strong><em>optstring</em><strong>);</strong>

<strong>extern char *</strong><em>optarg</em><strong>;</strong>
<strong>extern int </strong><em>optind</em><strong>, </strong><em>opterr</em><strong>, </strong><em>optopt</em><strong>;</strong>

<strong>#include &lt;getopt.h&gt;</strong>

<strong>int getopt_long(int </strong><em>argc</em><strong>, char * const </strong><em>argv[]</em><strong>,</strong>
<strong>           const char *</strong><em>optstring</em><strong>,</strong>
<strong>           const struct option *</strong><em>longopts</em><strong>, int *</strong><em>longindex</em><strong>);</strong>

<strong>int getopt_long_only(int </strong><em>argc</em><strong>, char * const </strong><em>argv[]</em><strong>,</strong>
<strong>           const char *</strong><em>optstring</em><strong>,</strong>
<strong>           const struct option *</strong><em>longopts</em><strong>, int *</strong><em>longindex</em><strong>);</strong></pre>

<p class='spacer'>

<p>Feature Test Macro Requirements for glibc (see <a href="../man7/feature_test_macros.7.html"><strong>feature_test_macros</strong>(7)</a>):</p>
<p class='spacer'>

<p><strong>getopt</strong>(): _POSIX_C_SOURCE&nbsp;&gt;=&nbsp;2 || _XOPEN_SOURCE</p>
<p class='spacer'>

<p><strong>getopt_long</strong>(), <strong>getopt_long_only</strong>(): _GNU_SOURCE</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p>The <strong>getopt</strong>() function parses the command-line arguments. Its arguments <em>argc</em> and <em>argv</em> are the argument count and array as passed to the <em>main</em>() function on program invocation. An element of <em>argv</em> that starts with &apos;-&apos; (and is not exactly "-" or "--") is an option element. The characters of this element (aside from the initial &apos;-&apos;) are option characters. If <strong>getopt</strong>() is called repeatedly, it returns successively each of the option characters from each of the option elements.</p>
<p class='spacer'>

<p>The variable <em>optind</em> is the index of the next element to be processed in <em>argv</em>. The system initializes this value to 1. The caller can reset it to 1 to restart scanning of the same <em>argv</em>, or when scanning a new argument vector.</p>
<p class='spacer'>

<p>If <strong>getopt</strong>() finds another option character, it returns that character, updating the external variable <em>optind</em> and a static variable <em>nextchar</em> so that the next call to <strong>getopt</strong>() can resume the scan with the following option character or <em>argv</em>-element.</p>
<p class='spacer'>

<p>If there are no more option characters, <strong>getopt</strong>() returns -1. Then <em>optind</em> is the index in <em>argv</em> of the first <em>argv</em>-element that is not an option.</p>
<p class='spacer'>

<p><em>optstring</em> is a string containing the legitimate option characters. If such a character is followed by a colon, the option requires an argument, so <strong>getopt</strong>() places a pointer to the following text in the same <em>argv</em>-element, or the text of the following <em>argv</em>-element, in <em>optarg</em>. Two colons mean an option takes an optional arg; if there is text in the current <em>argv</em>-element (i.e., in the same word as the option name itself, for example, "-oarg"), then it is returned in <em>optarg</em>, otherwise <em>optarg</em> is set to zero. This is a GNU extension. If <em>optstring</em> contains <strong>W</strong> followed by a semicolon, then <strong>-W foo</strong> is treated as the long option <strong>--foo</strong>. (The <strong>-W</strong> option is reserved by POSIX.2 for implementation extensions.) This behavior is a GNU extension, not available with libraries before glibc 2.</p>
<p class='spacer'>

<p>By default, <strong>getopt</strong>() permutes the contents of <em>argv</em> as it scans, so that eventually all the nonoptions are at the end. Two other modes are also implemented. If the first character of <em>optstring</em> is &apos;+&apos; or the environment variable <strong>POSIXLY_CORRECT</strong> is set, then option processing stops as soon as a nonoption argument is encountered. If the first character of <em>optstring</em> is &apos;-&apos;, then each nonoption <em>argv</em>-element is handled as if it were the argument of an option with character code 1.  (This is used by programs that were written to expect options and other <em>argv</em>-elements in any order and that care about the ordering of the two.) The special argument "--" forces an end of option-scanning regardless of the scanning mode.</p>
<p class='spacer'>

<p>If <strong>getopt</strong>() does not recognize an option character, it prints an error message to <em>stderr</em>, stores the character in <em>optopt</em>, and returns &apos;?&apos;. The calling program may prevent the error message by setting <em>opterr</em> to 0.</p>
<p class='spacer'>

<p>If <strong>getopt</strong>() finds an option character in <em>argv</em> that was not included in <em>optstring</em>, or if it detects a missing option argument, it returns &apos;?&apos; and sets the external variable <em>optopt</em> to the actual option character. If the first character (following any optional &apos;+&apos; or &apos;-&apos; described above) of <em>optstring</em> is a colon (&apos;:&apos;), then <strong>getopt</strong>() returns &apos;:&apos; instead of &apos;?&apos; to indicate a missing option argument. If an error was detected, and the first character of <em>optstring</em> is not a colon, and the external variable <em>opterr</em> is nonzero (which is the default), <strong>getopt</strong>() prints an error message.</p>
  <h3>getopt_long() and getopt_long_only()</h3>
<p>The <strong>getopt_long</strong>() function works like <strong>getopt</strong>() except that it also accepts long options, started with two dashes. (If the program accepts only long options, then <em>optstring</em> should be specified as an empty string (""), not NULL.) Long option names may be abbreviated if the abbreviation is unique or is an exact match for some defined option. A long option may take a parameter, of the form <strong>--arg=param</strong> or <strong>--arg param</strong>.</p>
<p class='spacer'>

  <p><em>longopts</em> is a pointer to the first element of an array of <em>struct option</em> declared in <em>&lt;getopt.h&gt;</em> as</p>
<pre>
struct option {
    const char *name;
    int         has_arg;
    int        *flag;
    int         val;
};</pre>

<p class='spacer'>

  <p>The meanings of the different fields are:</p>
  <dl class='dl-vertical'>
    <dt><em>name</em></dt>
    <dd>
  <p>is the name of the long option.</p>
    </dd>
    <dt><em>has_arg</em></dt>
    <dd>
  <p>is: <strong>no_argument</strong> (or 0) if the option does not take an argument; <strong>required_argument</strong> (or 1) if the option requires an argument; or <strong>optional_argument</strong> (or 2) if the option takes an optional argument.</p>
    </dd>
    <dt><em>flag</em></dt>
    <dd>
  <p>specifies how results are returned for a long option. If <em>flag</em> is NULL, then <strong>getopt_long</strong>() returns <em>val</em>. (For example, the calling program may set <em>val</em> to the equivalent short option character.) Otherwise, <strong>getopt_long</strong>() returns 0, and <em>flag</em> points to a variable which is set to <em>val</em> if the option is found, but left unchanged if the option is not found.</p>
    </dd>
    <dt><em>val</em></dt>
    <dd>
  <p>is the value to return, or to load into the variable pointed to by <em>flag</em>.</p>
    </dd>
  </dl>
<p class='spacer'>

<p>The last element of the array has to be filled with zeros.</p>
<p class='spacer'>

<p>If <em>longindex</em> is not NULL, it points to a variable which is set to the index of the long option relative to <em>longopts</em>.</p>
<p class='spacer'>

<p><strong>getopt_long_only</strong>() is like <strong>getopt_long</strong>(), but &apos;-&apos; as well as "--" can indicate a long option. If an option that starts with &apos;-&apos; (not "--") doesn't match a long option, but does match a short option, it is parsed as a short option instead.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">

<p>If an option was successfully found, then <strong>getopt</strong>() returns the option character. If all command-line options have been parsed, then <strong>getopt</strong>() returns -1. If <strong>getopt</strong>() encounters an option character that was not in <em>optstring</em>, then &apos;?&apos; is returned. If <strong>getopt</strong>() encounters an option with a missing argument, then the return value depends on the first character in <em>optstring</em>: if it is &apos;:&apos;, then &apos;:&apos; is returned; otherwise &apos;?&apos; is returned.</p>
<p class='spacer'>

<p><strong>getopt_long</strong>() and <strong>getopt_long_only</strong>() also return the option character when a short option is recognized. For a long option, they return <em>val</em> if <em>flag</em> is NULL, and 0 otherwise. Error and -1 returns are the same as for <strong>getopt</strong>(), plus &apos;?&apos; for an ambiguous match or an extraneous parameter.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">

  <dl class='dl-vertical'>
    <dt><strong>POSIXLY_CORRECT</strong></dt>
    <dd>
  <p>If this is set, then option processing stops as soon as a nonoption argument is encountered.</p>
    </dd>
    <dt><strong>_&lt;PID&gt;_GNU_nonoption_argv_flags_</strong></dt>
    <dd>
  <p>This variable was used by <strong>bash</strong>(1) 2.0 to communicate to glibc which arguments are the results of wildcard expansion and so should not be considered as options. This behavior was removed in <strong>bash</strong>(1) version 2.01, but the support remains in glibc.</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ATTRIBUTES</h2>
        <div class="sectioncontent">

<p>For an explanation of the terms used in this section, see <a href="../man7/attributes.7.html"><strong>attributes</strong>(7)</a>.</p>
<table class="table table-striped">
<tr>
<th>Interface</th>
<th>Attribute</th>
<th>Value</th></tr>

<tr>
<td><strong>getopt</strong>(),   <strong>getopt_long</strong>(),   <strong>getopt_long_only</strong>()  </td>
<td>Thread safety</td>
<td>MT-Unsafe race:getopt env</td></tr>
</table>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFORMING TO</h2>
        <div class="sectioncontent">

  <dl class='dl-vertical'>
    <dt><strong>getopt</strong>():</dt>
    <dd>
  <p>POSIX.1-2001, POSIX.1-2008, and POSIX.2, provided the environment variable <strong>POSIXLY_CORRECT</strong> is set. Otherwise, the elements of <em>argv</em> aren't really <em>const</em>, because we permute them. We pretend they're <em>const</em> in the prototype to be compatible with other systems.</p>
<p class='spacer'>

  <p>The use of &apos;+&apos; and &apos;-&apos; in <em>optstring</em> is a GNU extension.</p>
<p class='spacer'>

  <p>On some older implementations, <strong>getopt</strong>() was declared in <em>&lt;stdio.h&gt;</em>. SUSv1 permitted the declaration to appear in either <em>&lt;unistd.h&gt;</em> or <em>&lt;stdio.h&gt;</em>. POSIX.1-2001 marked the use of <em>&lt;stdio.h&gt;</em> for this purpose as LEGACY. POSIX.1-2001 does not allow the declaration to appear in <em>&lt;stdio.h&gt;</em>.</p>
    </dd>
    <dt><strong>getopt_long</strong>() and <strong>getopt_long_only</strong>():</dt>
    <dd>
  <p>These functions are GNU extensions.</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<p>A program that scans multiple argument vectors, or rescans the same vector more than once, and wants to make use of GNU extensions such as &apos;+&apos; and &apos;-&apos; at the start of <em>optstring</em>, or changes the value of <strong>POSIXLY_CORRECT</strong> between scans, must reinitialize <strong>getopt</strong>() by resetting <em>optind</em> to 0, rather than the traditional value of 1. (Resetting to 0 forces the invocation of an internal initialization routine that rechecks <strong>POSIXLY_CORRECT</strong> and checks for GNU extensions in <em>optstring</em>.)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

  <h3>getopt()</h3>
  <p>The following trivial example program uses <strong>getopt</strong>() to handle two program options: <em>-n</em>, with no associated value; and <em>-t val</em>, which expects an associated value.</p>
<pre>
#include &lt;unistd.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;

int
main(int argc, char *argv[])
{
    int flags, opt;
    int nsecs, tfnd;

    nsecs = 0;
    tfnd = 0;
    flags = 0;
    while ((opt = getopt(argc, argv, "nt:")) != -1) {
        switch (opt) {
        case &apos;n&apos;:
            flags = 1;
            break;
        case &apos;t&apos;:
            nsecs = atoi(optarg);
            tfnd = 1;
            break;
        default: /* &apos;?&apos; */
            fprintf(stderr, "Usage: %s [-t nsecs] [-n] name&#92;n",
                    argv[0]);
            exit(EXIT_FAILURE);
        }
    }

    printf("flags=%d; tfnd=%d; nsecs=%d; optind=%d&#92;n",
            flags, tfnd, nsecs, optind);

    if (optind &gt;= argc) {
        fprintf(stderr, "Expected argument after options&#92;n");
        exit(EXIT_FAILURE);
    }

    printf("name argument = %s&#92;n", argv[optind]);

    /* Other code omitted */

    exit(EXIT_SUCCESS);
}</pre>

  <h3>getopt_long()</h3>
  <p>The following example program illustrates the use of <strong>getopt_long</strong>() with most of its features.</p>
<pre>
#include &lt;stdio.h&gt;     /* for printf */
#include &lt;stdlib.h&gt;    /* for exit */
#include &lt;getopt.h&gt;

int
main(int argc, char **argv)
{
    int c;
    int digit_optind = 0;

    while (1) {
        int this_option_optind = optind ? optind : 1;
        int option_index = 0;
        static struct option long_options[] = {
            {"add",     required_argument, 0,  0 },
            {"append",  no_argument,       0,  0 },
            {"delete",  required_argument, 0,  0 },
            {"verbose", no_argument,       0,  0 },
            {"create",  required_argument, 0, &apos;c&apos;},
            {"file",    required_argument, 0,  0 },
            {0,         0,                 0,  0 }
        };

        c = getopt_long(argc, argv, "abc:d:012",
                 long_options, &option_index);
        if (c == -1)
            break;

        switch (c) {
        case 0:
            printf("option %s", long_options[option_index].name);
            if (optarg)
                printf(" with arg %s", optarg);
            printf("&#92;n");
            break;

        case &apos;0&apos;:
        case &apos;1&apos;:
        case &apos;2&apos;:
            if (digit_optind != 0 && digit_optind != this_option_optind)
              printf("digits occur in two different argv-elements.&#92;n");
            digit_optind = this_option_optind;
            printf("option %c&#92;n", c);
            break;

        case &apos;a&apos;:
            printf("option a&#92;n");
            break;

        case &apos;b&apos;:
            printf("option b&#92;n");
            break;

        case &apos;c&apos;:
            printf("option c with value &apos;%s&apos;&#92;n", optarg);
            break;

        case &apos;d&apos;:
            printf("option d with value &apos;%s&apos;&#92;n", optarg);
            break;

        case &apos;?&apos;:
            break;

        default:
            printf("?? getopt returned character code 0%o ??&#92;n", c);
        }
    }

    if (optind &lt; argc) {
        printf("non-option ARGV-elements: ");
        while (optind &lt; argc)
            printf("%s ", argv[optind++]);
        printf("&#92;n");
    }

    exit(EXIT_SUCCESS);
}</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<p><a href="../man1/getopt.1.html"><strong>getopt</strong>(1)</a>, <a href="../man3/getsubopt.3.html"><strong>getsubopt</strong>(3)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="getopt.3.html"><span aria-hidden="true">&larr;</span> getopt.3: Parse command-line options</a></li>
   <li class="next"><a href="getopt_long_only.3.html">getopt_long_only.3: Parse command-line options <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
