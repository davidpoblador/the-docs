<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pmdarootconnect: Privileged pcp collector services</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Privileged pcp collector services">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="pmdarootconnect (3) manual">
  <meta name="twitter:description" content="Privileged pcp collector services">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pmdarootconnect<small> (3)</small></h1>
        <p class="lead">Privileged pcp collector services</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/pmdarootconnect.3.html">
      <span itemprop="name">pmdarootconnect: Privileged pcp collector services</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/pcp/">
      <span itemprop="name">pcp</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/pmdarootconnect.3.html">
      <span itemprop="name">pmdarootconnect: Privileged pcp collector services</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">C SYNOPSIS</h2>
        <div class="sectioncontent">
<p>#include &lt;pcp/pmapi.h&gt;</p><p>#include &lt;pcp/pmda.h&gt;</p><p>int pmdaRootConnect(void);</p><p>void pmdaRootShutdown(int <em>fd</em>);</p><p>int pmdaRootContainerHostName(int <em>fd</em>, char *<em>name</em>, int <em>namelen</em>, char *<em>buffer</em>, int <em>buflen</em>);</p><p>int pmdaRootContainerProcessID(int <em>fd</em>, char *<em>name</em>, int <em>namelen</em>);</p><p>int pmdaRootContainerCGroupName(int <em>fd</em>, char *<em>name</em>, int <em>namelen</em>, char *<em>buffer</em>, int <em>buflen</em>);</p><p>int pmdaRootProcessStart(int <em>fd</em>, int <em>ipctype</em>, char *<em>label</em>, int <em>labellen</em>, const char *<em>args</em>, int <em>argslen</em>, int *<em>pid</em>, int *<em>infd</em>, int *<em>outfd</em>);</p><p>int pmdaRootProcessWait(int <em>fd</em>, int <em>pid</em>, int *<em>status</em>);</p><p>int pmdaRootProcessTerminate(int <em>fd</em>, int <em>pid</em>);</p><p>cc ... -lpcp_pmda -lpcp</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>pmdaRootConnect</strong> initializes an IPC channel between a PCP collector process - either a <a href="../man3/pmda.3.html"><strong>PMDA</strong>(3)</a> or <a href="../man1/pmcd.1.html"><strong>pmcd</strong>(1)</a> itself - and the <a href="../man1/pmdaroot.1.html"><strong>pmdaroot</strong>(1)</a> server.</p><p>On success, the return value from <strong>pmdaRootConnect</strong> is a <a href="../man7/unix.7.html"><strong>unix</strong>(7)</a> domain socket file descriptor, which can be subsequently passed to each of the other APIs described here. This channel can be used to perform limited privilege escalation for specific scenarios needed by PCP collector services. The channel can be deactivated using the <strong>pmdaRootShutdown</strong> interface.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONTAINERS</h2>
        <div class="sectioncontent">
<p>Several interfaces are provided for access to the container facilities of modern Linux distributions, as needed by various agents accessing kernel features related to containers.</p><p><strong>pmdaRootContainerHostName</strong> allows lookup of the current hostname for a named container on behalf of an unprivileged process, via the <strong>setns</strong>(3) system call on Linux. On success, the hostname is returned in the supplied <strong>buffer</strong>, of size <strong>buflen</strong> and the return value indicates the length of the hostname.</p><p><strong>pmdaRootContainerProcessID</strong> performs a <em>name</em> to process identifier translation - on success, the return value is the identifier of the first process started (process 1) in the named container.</p><p><strong>pmdaRootContainerCGroupName</strong> fills the supplied <em>buffer</em> with the engine-specific names of kernel control groups that have been used to build the container identified by <em>name</em>. When successful, the return value indicates the length of the cgroup name resolved for the container.</p><p>The <em>name</em> of the container is interpreted by <a href="../man1/pmdaroot.1.html"><strong>pmdaroot</strong>(1)</a>, which attempts to match up the specified name with one of the implementations of containers that it is aware of. Hence, the <em>name</em> argument is potentially interpreted differently, depending on the installed container engine, as determined internally by <strong>pmdaroot</strong>).</p><p>In the case of the Docker container engine, for example, a valid container name can be the unique hash identifier, the human-readable name, or any unique identifier substring. This is the algorithm used by the Docker client tools themselves.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PROCESSES</h2>
        <div class="sectioncontent">
<p>A second set of interfaces are provided allowing the collector system to start privileged child processes. In particular, these are used by <a href="../man1/pmcd.1.html"><strong>pmcd</strong>(1)</a> so that it can start privileged PMDAs even when it is running under an unprivileged account itself.</p><p>These interfaces allow processes to be started ( .BR pmdaRootProcessStart ), reaped upon completion ( .BR pmdaRootProcessWait ), and forcibly terminated through use of signals ( .BR pmdaRootProcessTerminate ). At this stage, they are intended only for use by <strong>pmcd</strong> itself and as such are described here only for completeness.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">
<p>All <strong>pmdaRoot</strong> interfaces will return negative status codes suitable for passing to <strong>pmErrStr_r</strong>(3).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO pmdarootconnect&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/pmcd.1.html"><strong>pmcd</strong>(1)</a>, <a href="../man1/pmdaroot.1.html"><strong>pmdaroot</strong>(1)</a>, <strong>pmErrStr_r</strong>(3), <a href="../man3/pmda.3.html"><strong>PMDA</strong>(3)</a>, <strong>setns</strong>(3) and <a href="../man7/unix.7.html"><strong>unix</strong>(7)</a>.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pmdaprofile.3.html"><span aria-hidden="true">&larr;</span> pmdaprofile.3: Update instance profile for pmda in preparation for the next fetch from pmcd</a></li>
   <li class="next"><a href="pmdastore.3.html">pmdastore.3: Store a value into a metric for a pmda <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
