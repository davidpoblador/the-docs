<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>selinux_set_mapping - establish dynamic object class and permission mapping .</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Establish dynamic object class and permission mapping .">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">selinux_set_mapping<small> (3)</small></h1>
        <p class="lead">Establish dynamic object class and permission mapping .</p>
      </div>

    <ol class="breadcrumb">
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="/"><span itemprop="title">Carta.tech</span></a>
	</li>
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="https://www.carta.tech/man-pages/"><span itemprop="title">Man Pages</span></a>
	</li>
	<li id="breadcrumb_section" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_page" itemprop="child">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man3/"><span itemprop="title">Library calls</span></a>
	</li>
	<li id="breadcrumb_page" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="active">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man3/selinux_set_mapping.3.html"><span itemprop="title">selinux_set_mapping</span></a>
	</li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p><strong>#include &lt;selinux/selinux.h&gt;</strong></p>
<p class='spacer'>

<pre>struct security_class_mapping {
	const char *name;
	const char *perms[];
};</pre>

<p class='spacer'>

<p><strong>int selinux_set_mapping(struct security_class_mapping *</strong><em>map</em><strong>);</strong> .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p><strong>selinux_set_mapping</strong>() establishes a mapping from a user-provided ordering of object classes and permissions to the numbers actually used by the loaded system policy.  Use of this function is highly preferred over the generated constants in the libselinux header files, as this method allows the policy's class and permission values to change over time.</p>
<p class='spacer'>

<p>After the mapping is established, all libselinux functions that operate on class and permission values take the user-provided numbers, which are determined as follows:</p>
<p class='spacer'>

<p>The <em>map</em> argument consists of an array of <strong>security_class_mapping</strong> structures, which must be terminated by a structure having a NULL name field.  Except for this last structure, the <em>name</em> field should refer to the string name of an object class, and the corresponding <em>perms</em> field should refer to an array of permission bit names terminated by a NULL string.</p>
<p class='spacer'>

<p>The object classes named in the mapping and the bit indexes of each set of permission bits named in the mapping are numbered in order starting from 1.  These numbers are the values that should be passed to subsequent libselinux calls. .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">

<p>Zero is returned on success.  On error, -1 is returned and <em>errno</em> is set appropriately. .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">

  <dl class='dl-vertical'>
    <dt><strong>EINVAL</strong></dt>
    <dd>
  <p>One of the class or permission names requested in the mapping is not present in the loaded policy.</p>
    </dd>
    <dt><strong>ENOMEM</strong></dt>
    <dd>
  <p>An attempt to allocate memory failed. .</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<pre>struct security_class_mapping map[] = {
	{ "file", { "create", "unlink", "read", "write", NULL } },
	{ "socket", { "bind", NULL } },
	{ "process", { "signal", NULL } },
	{ NULL }
};

if (selinux_set_mapping(map) &lt; 0)
	<strong>exit</strong>(1);</pre>

<p class='spacer'>

<p>In this example, after the call has succeeded, classes <strong>file</strong>, <strong>socket</strong>, and <strong>process</strong> will be identified by 1, 2 and 3, respectively.  Permissions <em>create</em>, <em>unlink</em>, <em>read</em>, and <em>write</em> (for the <strong>file</strong> class) will be identified by 1, 2, 4, and 8 respectively.  Classes and permissions not listed in the mapping cannot be used. .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">

<p>Eamon Walsh &lt;ewalsh@tycho.nsa.gov&gt; .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<p><strong>avc_open</strong>(8), <a href="../man8/selinux.8.html"><strong>selinux</strong>(8)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="selinux_set_callback.3.html"><span aria-hidden="true">&larr;</span> selinux_set_callback.3: userspace SELinux callback facilities .</a></li>
   <li class="next"><a href="selinux_set_policy_root.3.html">selinux_set_policy_root.3: return the path of the SELinux policy files for this machine selinux_set_policy_root - Set an alternate SELinux root path for the SELinux policy files for this machine. . <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
