<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>attr_multi: Manipulate multiple user attributes on a filesystem object at once</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Manipulate multiple user attributes on a filesystem object at once">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">attr_multi<small> (3)</small></h1>
        <p class="lead">Manipulate multiple user attributes on a filesystem object at once</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/attr_multi.3.html">
      <span itemprop="name">attr_multi: Manipulate multiple user attributes on a filesystem object at once</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/attr/">
      <span itemprop="name">attr</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/attr_multi.3.html">
      <span itemprop="name">attr_multi: Manipulate multiple user attributes on a filesystem object at once</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">C SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>#include <attr/attributes.h></strong>

<strong>int attr_multi (const char *\f2path\f3, attr_multiop_t *\f2oplist\f3, </strong>
<strong>                int \f2count\f3, int \f2flags\f3);</strong>

<strong>int attr_multif (int \f2fd\f3, attr_multiop_t *\f2oplist\f3, </strong>
<strong>                 int \f2count\f3, int \f2flags\f3);</strong>
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <strong>attr_multi</strong> and <strong>attr_multif</strong> functions provide a way to operate on multiple attributes of a filesystem object at once.</p><p><em>Path</em> points to a path name for a filesystem object, and <em>fd</em> refers to the file descriptor associated with a file. The <em>oplist</em> is an array of \f4attr_multiop_t structures. Each element in that array describes a single attribute operation and provides all the information required to carry out that operation and to check for success or failure of that operation. <em>Count</em> tells how many elements are in the <em>oplist</em> array.</p><p>The contents of an \f4attr_multiop_t structure include the following members:</p>
<pre>
int am_opcode; /* which operation to perform (see below) */
int am_error; /* [out arg] result of this sub-op (an errno) */
char *am_attrname; /* attribute name to work with */
char *am_attrvalue; /* [in/out arg] attribute value (raw bytes) */
int am_length; /* [in/out arg] length of value */
int am_flags; /* flags (bit-wise OR of #defines below) */
</pre>
<p>The <em>am_opcode</em> field defines how the remaining fields are to be interpreted and can take on one of the following values:</p>
<pre>
ATTR_OP_GET /* return the indicated attr's value */
ATTR_OP_SET /* set/create the indicated attr/value pair */
ATTR_OP_REMOVE /* remove the indicated attr */
</pre>
<p>The <em>am_error</em> field will contain the appropriate error result code if that sub-operation fails. The result codes for a given sub-operation are a subset of the result codes that are possible from the corresponding single-attribute function call. For example, the result code possible from an \f4ATTR_OP_GET sub-operation are a subset of those that can be returned from an <strong>attr_get</strong> function call.</p><p>The <em>am_attrname</em> field is a pointer to a NULL terminated string giving the attribute name that the sub-operation should operate on.</p><p>The <em>am_attrvalue,</em> <em>am_length</em> and <em>am_flags</em> fields are used to store the value of the named attribute, and some control flags for that sub-operation, respectively. Their use varies depending on the value of the <em>am_opcode</em> field.</p>
<dl class='dl-vertical'>
  <dt>
    <p><small></small></p>
  </dt>
  <dd>
    <p><strong>ATTR_OP_GET</strong> The <em>am_attrvalue</em> field is a pointer to a empty buffer that will be overwritten with the value of the named attribute. The <em>am_length</em> field is initially the total size of the memory buffer that the <em>am_attrvalue</em> field points to. After the operation, the <em>am_length</em> field contains the actual size of the attribute\'s value. The <em>am_flags</em> field may be set to the \f4ATTR_ROOT flag. If the process has appropriate priviledges, the ROOT namespace will be searched for the named attribute, otherwise the USER namespace will be searched.</p>
  </dd>
  <dt>
    <p><small></small></p>
  </dt>
  <dd>
    <p><strong>ATTR_OP_SET</strong> The <em>am_attrvalue</em> and <em>am_length</em> fields contain the new value for the given attribute name and its length. The \f4ATTR_ROOT flag may be set in the <em>am_flags</em> field. If the process has appropriate priviledges, the ROOT namespace will be searched for the named attribute, otherwise the USER namespace will be searched. The \f4ATTR_CREATE and the \f4ATTR_REPLACE flags may also be set in the <em>am_flags</em> field (but not simultaneously). If the \f4ATTR_CREATE flag is set, the sub-operation will set the <em>am_error</em> field to EEXIST if the named attribute already exists. If the \f4ATTR_REPLACE flag is set, the sub-operation will set the <em>am_error</em> field to ENOATTR if the named attribute does not already exist. If neither of those two flags are set and the attribute does not exist, then the attribute will be created with the given value. If neither of those two flags are set and the attribute already exists, then the value will be replaced with the given value.</p>
  </dd>
  <dt>
    <p><small></small></p>
  </dt>
  <dd>
    <p><strong>ATTR_OP_REMOVE</strong> The <em>am_attrvalue</em> and <em>am_length</em> fields are not used and are ignored. The <em>am_flags</em> field may be set to the \f4ATTR_ROOT flag. If the process has appropriate priviledges, the ROOT namespace will be searched for the named attribute, otherwise the USER namespace will be searched.</p>
  </dd>

</dl>
<p>The <em>flags</em> argument to the <strong>attr_multi</strong> call is used to control following of symbolic links in the <em>path</em> argument. The default is to follow symbolic links, <em>flags</em> should be set to ATTR_DONTFOLLOW to not follow symbolic links.</p><p><strong>attr_multi</strong> will fail if one or more of the following are true:</p>
<dl class='dl-vertical'>
  <dt>
    <p><small></small></p>
  </dt>
  <dd>
    <p>[ENOENT] The named file does not exist.</p>
  </dd>
  <dt>
    <p><small></small></p>
  </dt>
  <dd>
    <p>[EPERM] The effective user <small>ID</small> does not match the owner of the file and the effective user <small>ID</small> is not super-user.</p>
  </dd>
  <dt>
    <p><small></small></p>
  </dt>
  <dd>
    <p>[ENOTDIR] A component of the path prefix is not a directory.</p>
  </dd>
  <dt>
    <p><small></small></p>
  </dt>
  <dd>
    <p>[EACCES] Search permission is denied on a component of the path prefix.</p>
  </dd>
  <dt>
    <p><small></small></p>
  </dt>
  <dd>
    <p>[EINVAL] A bit other than ATTR_DONTFOLLOW was set in the <em>flag</em> argument.</p>
  </dd>
  <dt>
    <p><small></small></p>
  </dt>
  <dd>
    <p>[EFAULT] <em>Path,</em> or <em>oplist</em> points outside the allocated address space of the process.</p>
  </dd>
  <dt>
    <p><small></small></p>
  </dt>
  <dd>
    <p>[ELOOP] A path name lookup involved too many symbolic links.</p>
  </dd>
  <dt>
    <p><small></small></p>
  </dt>
  <dd>
    <p>[ENAMETOOLONG] The length of <em>path</em> exceeds <small></small> {<em>MAXPATHLEN</em>}, or a pathname component is longer than <small></small> {<em>MAXNAMELEN</em>}.</p>
  </dd>

</dl>
<p><strong>attr_multif</strong> will fail if:</p>
<dl class='dl-vertical'>
  <dt>
    <p><small></small></p>
  </dt>
  <dd>
    <p>[EINVAL] A bit was set in the <em>flag</em> argument, or <em>fd\^</em> refers to a socket, not a file.</p>
  </dd>
  <dt>
    <p><small></small></p>
  </dt>
  <dd>
    <p>[EFAULT] <em>Oplist</em> points outside the allocated address space of the process.</p>
  </dd>
  <dt>
    <p><small></small></p>
  </dt>
  <dd>
    <p>[EBADF] <em>Fd\^</em> does not refer to a valid descriptor.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">
<p>On success, zero is returned.  On error, -1 is returned, and <em>errno</em> is set appropriately. Note that the individual operations listed in the <em>oplist</em> array each have their own error return fields. The <em>errno</em> variable only records the result of the <em>attr_multi</em> call itself, not the result of any of the sub-operations.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO attr_multi&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/attr.1.html"><strong>attr</strong>(1)</a>, <a href="../man3/attr_get.3.html"><strong>attr_get</strong>(3)</a>, <a href="../man3/attr_list.3.html"><strong>attr_list</strong>(3)</a>, <a href="../man3/attr_remove.3.html"><strong>attr_remove</strong>(3)</a>, and <a href="../man3/attr_set.3.html"><strong>attr_set</strong>(3)</a>.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="attr_list.3.html"><span aria-hidden="true">&larr;</span> attr_list.3: List the names of the user attributes of a filesystem object</a></li>
   <li class="next"><a href="attr_remove.3.html">attr_remove.3: Remove a user attribute of a filesystem object <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
