<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pmproxy: Proxy for performance metrics collector daemon</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Proxy for performance metrics collector daemon">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pmproxy<small> (1)</small></h1>
        <p class="lead">Proxy for performance metrics collector daemon</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/pmproxy.1.html">
      <span itemprop="name">pmproxy: Proxy for performance metrics collector daemon</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/pcp/">
      <span itemprop="name">pcp</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/pmproxy.1.html">
      <span itemprop="name">pmproxy: Proxy for performance metrics collector daemon</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>\f3pmproxy\f1 [\f3-Af\f1] [\f3-C\f1 \f2dirname\f1] [\f3-i\f1 \f2ipaddress\f1] [\f3-l\f1 \f2logfile\f1] [\f3-L\f1 \f2bytes\f1] [\f3-M\f1 \f2certname\f1] [\f3-p\f1 \f2port\f1[,\f2port\f1 ...] [\f3-P\f1 \f2passfile\f1] [\f3-U\f1 \f2username\f1] [\f3-x\f1 \f2file\f1]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>pmproxy</strong> acts as a protocol proxy for <a href="../man1/pmcd.1.html"><strong>pmcd</strong>(1)</a>, allowing Performance Co-Pilot (PCP) monitoring clients to connect to one or more <a href="../man1/pmcd.1.html"><strong>pmcd</strong>(1)</a> instances via <strong>pmproxy</strong>.</p><p>Normally <strong>pmproxy</strong> is deployed in a firewall domain, or on a ``head'' node of a cluster where the IP (Internet Protocol) address of the hosts where <a href="../man1/pmcd.1.html"><strong>pmcd</strong>(1)</a> is running may be unknown to the PCP monitoring clients, although the IP address of the host where <strong>pmproxy</strong> is running is known to these clients. Similarly, the clients may have network connectivity only to the host where <strong>pmproxy</strong> is running, while there is network connectivity from that host to the hosts of interest where <a href="../man1/pmcd.1.html"><strong>pmcd</strong>(1)</a> is running.</p><p>The behaviour of the PCP monitoring clients is controlled by either the <strong>PMPROXY_HOST</strong> environment variable or through the extended hostname specification (see <strong>PCPIntro</strong>(1) for details). If neither of these mechanisms is used, clients will make their connections directly to <a href="../man1/pmcd.1.html"><strong>pmcd</strong>(1)</a>. If the proxy hostname syntax is used or <strong>PMPROXY_HOST</strong> is set, then this should be the hostname or IP address of the system where <strong>pmproxy</strong> is running, and the clients will connect to <a href="../man1/pmcd.1.html"><strong>pmcd</strong>(1)</a> indirectly through the protocol proxy services of <strong>pmproxy.</strong></p><p>The options to <strong>pmproxy</strong> are as follows.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-A</strong></p>
  </dt>
  <dd>
    <p>Disable service advertisement. By default, <strong>pmproxy</strong> will advertise its presence on the network using any available mechanisms (such as Avahi/DNS-SD), assisting remote monitoring tools with finding it. These mechanisms are disabled with this option.</p>
  </dd>
  <dt>
    <p>\f3-C\f1 \f2dirname\f1</p>
  </dt>
  <dd>
    <p>Specify the path to the Network Security Services certificate database, for (optional) secure connections. The default is <strong>/etc/pki/nssdb</strong>. Refer also to the \f3-P\f1 option. If it does not already exist, this database can be created using the <strong>certutil</strong> utility. This process and other certificate database maintenance information is provided in the <strong>PCPIntro</strong>(1) manual page and the online PCP tutorials.</p>
  </dd>
  <dt>
    <p><strong>-f</strong></p>
  </dt>
  <dd>
    <p>By default <strong>pmproxy</strong> is started as a daemon. The <strong>-f</strong> option indicates that it should run in the foreground. This is most useful when trying to diagnose problems with establishing connections.</p>
  </dd>
  <dt>
    <p>\f3-i\f1 \f2ipaddress\f1</p>
  </dt>
  <dd>
    <p>This option is usually only used on hosts with more than one network interface (very common for firewall and ``head'' node hosts where <strong>pmproxy</strong> is most likely to be deployed).  If no <strong>-i</strong> options are specified <strong>pmproxy</strong> accepts PCP client connections on  any of its host's IP addresses. The <strong>-i</strong> option is used to specify explicitly an IP address that PCP client connections should be accepted on. <em>ipaddress</em> should be in the standard dotted form (e.g. 100.23.45.6).  The <strong>-i</strong> option may be used multiple times to define a list of IP addresses. When one or more <strong>-i</strong> options is specified, attempted connections made on any other IP addresses will be refused.</p>
  </dd>
  <dt>
    <p>\f3-l\f1 \f2logfile\f1</p>
  </dt>
  <dd>
    <p>By default a log file named <em>pmproxy.log</em> is written in the current directory. The <strong>-l</strong> option causes the log file to be written to <em>logfile</em> instead of the default. If the log file cannot be created or is not writable, output is written to the standard error instead.</p>
  </dd>
  <dt>
    <p>\f3-L\f1 \f2bytes\f1</p>
  </dt>
  <dd>
    <p><em>PDU</em>s received by <strong>pmproxy</strong> from PCP monitoring clients are restricted to a maximum size of 65536 bytes by default to defend against Denial of Service attacks.  The <strong>-L</strong> option may be used to change the maximum incoming <em>PDU</em> size.</p>
  </dd>
  <dt>
    <p>\f3-M\f1 \f2certname\f1</p>
  </dt>
  <dd>
    <p>By default, pmproxy will try to use a certificate called <strong>PCP Collector certificate</strong> in its server role. The <strong>-M</strong> option allows this to be changed.</p>
  </dd>
  <dt>
    <p>\f3-P\f1 \f2passfile\f1</p>
  </dt>
  <dd>
    <p>Specify the path to a file containing the Network Security Services certificate database password for (optional) secure connections, and for databases that are password protected. Refer also to the \f3-C\f1 option. When using this option, great care should be exercised to ensure appropriate ownership ("pcp" user, typically) and permissions on this file (0400, so as to be unreadable by any user other than the user running the <strong>pmproxy</strong> process).</p>
  </dd>
  <dt>
    <p>\f3-U\f1 \f2username\f1</p>
  </dt>
  <dd>
    <p>Assume the identity of <em>username</em> before starting to accept incoming packets from PCP monitoring clients.</p>
  </dd>
  <dt>
    <p>\f3-x\f1 \f2file\f1</p>
  </dt>
  <dd>
    <p>Before the <strong>pmproxy</strong> <em>logfile</em> can be opened, <strong>pmproxy</strong> may encounter a fatal error which prevents it from starting.  By default, the output describing this error is sent to <strong>/dev/tty</strong> but it may redirected to <em>file</em>.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">STARTING AND STOPPING PMPROXY</h2>
        <div class="sectioncontent">
<p>Normally, <strong>pmproxy</strong> is started automatically at boot time and stopped when the system is being brought down. Under certain circumstances it is necessary to start or stop <strong>pmproxy</strong> manually. To do this one must become superuser and type</p><p># $PCP_RC_DIR/pmproxy start</p><p>to start <strong>pmproxy</strong>, or</p><p># $PCP_RC_DIR/pmproxy stop</p><p>to stop <strong>pmproxy</strong>. Starting <strong>pmproxy</strong> when it is already running is the same as stopping it and then starting it again.</p><p>Normally <strong>pmproxy</strong> listens for PCP client connections on TCP/IP port number 44322 (registered at <em>http://www.iana.org/</em>). Either the environment variable <strong>PMPROXY_PORT</strong> <strong>-p</strong> command line option may be used to specify alternative port number(s) when <strong>PMPROXY_PORT</strong> or the <strong>-p</strong> command line option may be used to specify alternative port number(s) when <strong>pmproxy</strong> is started; in each case, the specification is a comma-separated list of one or more numerical port numbers.  Should both methods be used or multiple <strong>-p</strong> options appear on the command line, <strong>pmproxy</strong> will listen on the union of the set of ports specified via all <strong>-p</strong> options and the <strong>PMPROXY_PORT</strong> environment variable. If non-default ports are used with <strong>pmproxy</strong> care should be taken to ensure that <strong>PMPROXY_PORT</strong> is also set in the environment of any client application that will connect to <strong>pmproxy</strong>, or that the extended host specification syntax is used (see <strong>PCPIntro</strong>(1) for details).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>PCP_PMPROXYOPTIONS_PATH</strong></p>
  </dt>
  <dd>
    <p>command line options for <strong>pmproxy</strong> when launched from <strong>$PCP_RC_DIR/pmproxy</strong> All the command line option lines should start with a hyphen as the first character.</p>
  </dd>
  <dt>
    <p><strong>$PCP_SYSCONFIG_DIR/pmproxy</strong></p>
  </dt>
  <dd>
    <p>additional environment variables that will be set when <strong>pmproxy</strong> executes. Only settings of the form "PMPROXY_VARIABLE=value" will be honoured.</p>
  </dd>
  <dt>
    <p><strong>./pmproxy.log</strong></p>
  </dt>
  <dd>
    <p>(or <strong>$PCP_LOG_DIR/pmproxy/pmproxy.log</strong> when started automatically)</p><p>All messages and diagnostics are directed here</p>
  </dd>
  <dt>
    <p><strong>/etc/pki/nssdb</strong></p>
  </dt>
  <dd>
    <p>default Network Security Services (NSS) certificate database directory, used for optional Secure Socket Layer connections. This database can be created and queried using the NSS <strong>certutil</strong> tool, amongst others.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">
<p>In addition to the PCP environment variables described in the <strong>PCP ENVIRONMENT</strong> section below, there are several environment variables that influence the interactions between a PCP monitoring client, <strong>pmcd</strong> and <a href="../man1/pmcd.1.html"><strong>pmcd</strong>(1)</a>.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>PMCD_PORT</strong></p>
  </dt>
  <dd>
    <p>For the PCP monitoring client this (or the default port number) is passed to <strong>pmproxy</strong> and used to connect to <a href="../man1/pmcd.1.html"><strong>pmcd</strong>(1)</a>. In the environment of <strong>pmproxy</strong> <strong>PMCD_PORT is not used.</strong></p>
  </dd>
  <dt>
    <p><strong>PMPROXY_HOST</strong></p>
  </dt>
  <dd>
    <p>For the PCP monitoring client this is the hostname or IP address of the host where <strong>pmproxy</strong> is running. In recent versions of PCP (since version 3) this has been superseded by the extended hostname syntax (see <strong>PCPIntro</strong>(1) for details).</p>
  </dd>
  <dt>
    <p><strong>PMPROXY_PORT</strong></p>
  </dt>
  <dd>
    <p>For the PCP monitoring client this is the port on which <strong>pmproxy</strong> will accept connections.  The default is 44322.</p>
  </dd>
  <dt>
    <p><strong>PMCD_CONNECT_TIMEOUT</strong>, <strong>PMCD_RECONNECT_TIMEOUT</strong> and <strong>PMCD_REQUEST_TIMEOUT</strong></p>
  </dt>
  <dd>
    <p>(see <strong>PCPIntro</strong>(1)) For the PCP monitoring client, setting these environment variables will modify the timeouts used for interactions between the client and <strong>pmproxy</strong> (independent of which <a href="../man1/pmcd.1.html"><strong>pmcd</strong>(1)</a> is being used). For <strong>pmproxy</strong> these same environment variables control the timeouts between <strong>pmproxy</strong> and all <a href="../man1/pmcd.1.html"><strong>pmcd</strong>(1)</a> instances (independent of which monitoring client is involved).</p>
  </dd>

</dl>
<p>If set to the value 1, the <strong>PMPROXY_LOCAL</strong> environment variable will cause <strong>pmproxy</strong> to run in a localhost-only mode of operation, where it binds only to the loopback interface.</p><p>The <strong>PMPROXY_MAXPENDING</strong> variable can be set to indicate the maximum length to which the queue of pending client connections may grow.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PCP ENVIRONMENT</h2>
        <div class="sectioncontent">
<p>Environment variables with the prefix <strong>PCP_</strong> are used to parameterize the file and directory names used by PCP. On each installation, the file <strong>/etc/pcp.conf</strong> contains the local values for these variables. The <strong>PCP_CONF</strong> variable may be used to specify an alternative configuration file, as described in <a href="../man5/pcp.conf.5.html"><strong>pcp.conf</strong>(5)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO pmproxy&hellip;</h2>
        <div class="sectioncontent">
<p><strong>PCPIntro</strong>(1), <a href="../man1/pmcd.1.html"><strong>pmcd</strong>(1)</a>, <a href="../man1/pmdbg.1.html"><strong>pmdbg</strong>(1)</a>, <a href="../man5/pcp.conf.5.html"><strong>pcp.conf</strong>(5)</a> and <a href="../man5/pcp.env.5.html"><strong>pcp.env</strong>(5)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">
<p>If <strong>pmproxy</strong> is already running the message "Error: OpenRequestSocket bind: Address already in use" will appear. This may also appear if <strong>pmproxy</strong> was shutdown with an outstanding request from a client. In this case, a request socket has been left in the TIME_WAIT state and until the system closes it down (after some timeout period) it will not be possible to run <strong>pmproxy</strong>.</p><p>In addition to the standard <strong>PCP</strong> debugging flags, see <a href="../man1/pmdbg.1.html"><strong>pmdbg</strong>(1)</a>, <strong>pmproxy</strong> currently uses <strong>DBG_TRACE_CONTEXT</strong> for tracing client connections and disconnections</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pmprobe.1.html"><span aria-hidden="true">&larr;</span> pmprobe.1: Lightweight probe for performance metrics</a></li>
   <li class="next"><a href="pmpython.1.html">pmpython.1: Run a python script using a preferred python variant <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
