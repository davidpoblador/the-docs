<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>qshape: Print postfix queue domain and age distribution</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Print postfix queue domain and age distribution">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">qshape<small> (1)</small></h1>
        <p class="lead">Print postfix queue domain and age distribution</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/qshape.1.html">
      <span itemprop="name">qshape: Print postfix queue domain and age distribution</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/postfix/">
      <span itemprop="name">postfix</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/qshape.1.html">
      <span itemprop="name">qshape: Print postfix queue domain and age distribution</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p><strong>qshape</strong> [<strong>-s</strong>] [<strong>-p</strong>] [-m <em>min_subdomains</em>]</p>
<pre>        [-b <em>bucket_count</em>] [-t <em>bucket_time</em>]
        [<strong>-l</strong>] [-w <em>terminal_width</em>]
        [-N <em>batch_msg_count</em>] [-n <em>batch_top_domains</em>]
        [-c <em>config_directory</em>] [<em>queue_name</em> ...]</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p>The <strong>qshape</strong> program helps the administrator understand the Postfix queue message distribution in time and by sender domain or recipient domain. The program needs read access to the queue directories and queue files, so it must run as the superuser or the <strong>mail_owner</strong> specified in <strong>main.cf</strong> (typically <strong>postfix</strong>).</p>
<p class='spacer'>

  <p>Options:</p>
  <dl class='dl-horizontal'>
    <dt><strong>-s</strong></dt>
    <dd>
  <p>Display the sender domain distribution instead of the recipient domain distribution.  By default the recipient distribution is displayed. There can be more recipients than messages, but as each message has only one sender, the sender distribution is a message distribution.</p>
    </dd>
    <dt><strong>-p</strong></dt>
    <dd>
  <p>Generate aggregate statistics for parent domains. Top level domains are not shown, nor are domains with fewer than <em>min_subdomains</em> subdomains. The names of parent domains are shown with a leading dot, (e.g. <em>.example.com</em>).</p>
    </dd>
    <dt>-m <em>min_subdomains</em></dt>
    <dd>
  <p>When used with the <strong>-p</strong> option, sets the minimum subdomain count needed to show a separate line for a parent domain. The default is 5.</p>
    </dd>
    <dt>-b <em>bucket_count</em></dt>
    <dd>
  <p>The age distribution is broken up into a sequence of geometrically increasing intervals. This option sets the number of intervals or "buckets". Each bucket has a maximum queue age that is twice as large as that of the previous bucket. The last bucket has no age limit.</p>
    </dd>
    <dt>-t <em>bucket_time</em></dt>
    <dd>
  <p>The age limit in minutes for the first time bucket. The default value is 5, meaning that the first bucket counts messages between 0 and 5 minutes old.</p>
    </dd>
    <dt><strong>-l</strong></dt>
    <dd>
  <p>Instead of using a geometric age sequence, use a linear age sequence, in other words simple multiples of <strong>bucket_time</strong>.</p>
<p class='spacer'>

  <p>This feature is available in Postfix 2.2 and later.</p>
    </dd>
    <dt>-w <em>terminal_width</em></dt>
    <dd>
  <p>The output is right justified, with the counts for the last bucket shown on the 80th column, the <em>terminal_width</em> can be adjusted for wider screens allowing more buckets to be displayed without truncating the domain names on the left. When a row for a full domain name and its counters does not fit in the specified number of columns, only the last 17 bytes of the domain name are shown with the prefix replaced by a '+' character. Truncated parent domain rows are shown as '.+' followed by the last 16 bytes of the domain name. If this is still too narrow to show the domain name and all the counters, the terminal_width limit is violated.</p>
    </dd>
    <dt>-N <em>batch_msg_count</em></dt>
    <dd>
  <p>When the output device is a terminal, intermediate results are shown each "batch_msg_count" messages. This produces usable results in a reasonable time even when the deferred queue is large. The default is to show intermediate results every 1000 messages.</p>
    </dd>
    <dt>-n <em>batch_top_domains</em></dt>
    <dd>
  <p>When reporting intermediate or final results to a termainal, report only the top "batch_top_domains" domains. The default limit is 20 domains.</p>
    </dd>
    <dt>-c <em>config_directory</em></dt>
    <dd>
  <p>The <strong>main.cf</strong> configuration file is in the named directory instead of the default configuration directory.</p>
    </dd>
  </dl>
<p class='spacer'>

  <p>Arguments:</p>
  <dl class='dl-horizontal'>
    <dt><em>queue_name</em></dt>
    <dd>
  <p>By default <strong>qshape</strong> displays the combined distribution of the incoming and active queues. To display a different set of queues, just list their directory names on the command line. Absolute paths are used as is, other paths are taken relative to the <strong>main.cf</strong> <strong>queue_directory</strong> parameter setting. While <strong>main.cf</strong> supports the use of <em>$variable</em> expansion in the definition of the <strong>queue_directory</strong> parameter, the <strong>qshape</strong> program does not. If you must use variable expansions in the <strong>queue_directory</strong> setting, you must specify an explicit absolute path for each queue subdirectory even if you want the default incoming and active queue distribution.</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<pre>$config_directory/main.cf, Postfix installation parameters.
$queue_directory/maildrop/, local submission directory.
$queue_directory/incoming/, new message queue.
$queue_directory/hold/, messages waiting for tech support.
$queue_directory/active/, messages scheduled for delivery.
$queue_directory/deferred/, messages postponed for later delivery.</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE</h2>
        <div class="sectioncontent">

<p>The Secure Mailer license must be distributed with this software.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR(S)</h2>
        <div class="sectioncontent">

<pre>Victor Duchovni
Morgan Stanley</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO qshape&hellip;</h2>
        <div class="sectioncontent">

<a href="../man1/mailq.1.html"><strong>mailq</strong>(1)</a>, List all messages in the queue.
QSHAPE_README Examples and background material.</pre>

        </div>
      </section>

<nav>
  <ul class="pager">
   <li class="previous"><a href="qmqp-source.1.html"><span aria-hidden="true">&larr;</span> qmqp-source.1: Multi-threaded qmqp test generator</a></li>
   <li class="next"><a href="quota.1.html">quota.1: Display disk usage and limits <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
