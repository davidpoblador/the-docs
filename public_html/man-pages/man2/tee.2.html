<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>tee: Duplicating pipe content</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Duplicating pipe content">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">tee<small> (2)</small></h1>
        <p class="lead">Duplicating pipe content</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man2/">
      <span itemprop="name">System calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man2/tee.2.html">
      <span itemprop="name">tee: Duplicating pipe content</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/man-pages/">
      <span itemprop="name">man-pages</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man2/tee.2.html">
      <span itemprop="name">tee: Duplicating pipe content</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>#define</strong> <strong>_GNU_SOURCE</strong>         /* See <a href="../man7/feature_test_macros.7.html"><strong>feature_test_macros</strong>(7)</a> */
<strong>#include <fcntl.h></strong>

<strong>ssize_t</strong> <strong>tee(int</strong> <strong></strong><em>fd_in</em><strong>,</strong> <strong>int</strong> <strong></strong><em>fd_out</em><strong>,</strong> <strong>size_t</strong> <strong></strong><em>len</em><strong>,</strong> <strong>unsigned</strong> <strong>int</strong> <strong></strong><em>flags</em><strong>);</strong>
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>tee</strong>() duplicates up to <em>len</em> bytes of data from the pipe referred to by the file descriptor <em>fd_in</em> to the pipe referred to by the file descriptor <em>fd_out</em>. It does not consume the data that is duplicated from <em>fd_in</em>; therefore, that data can be copied by a subsequent <a href="../man2/splice.2.html"><strong>splice</strong>(2)</a>.</p><p><em>flags</em> is a bit mask that is composed by ORing together zero or more of the following values:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>SPLICE_F_MOVE</strong></p>
  </dt>
  <dd>
    <p>Currently has no effect for <strong>tee</strong>(); see <a href="../man2/splice.2.html"><strong>splice</strong>(2)</a>.</p>
  </dd>
  <dt>
    <p><strong>SPLICE_F_NONBLOCK</strong></p>
  </dt>
  <dd>
    <p>Do not block on I/O; see <a href="../man2/splice.2.html"><strong>splice</strong>(2)</a> for further details.</p>
  </dd>
  <dt>
    <p><strong>SPLICE_F_MORE</strong></p>
  </dt>
  <dd>
    <p>Currently has no effect for <strong>tee</strong>(), but may be implemented in the future; see <a href="../man2/splice.2.html"><strong>splice</strong>(2)</a>.</p>
  </dd>
  <dt>
    <p><strong>SPLICE_F_GIFT</strong></p>
  </dt>
  <dd>
    <p>Unused for <strong>tee</strong>(); see <a href="../man2/vmsplice.2.html"><strong>vmsplice</strong>(2)</a>.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>Upon successful completion, <strong>tee</strong>() returns the number of bytes that were duplicated between the input and output. A return value of 0 means that there was no data to transfer, and it would not make sense to block, because there are no writers connected to the write end of the pipe referred to by <em>fd_in</em>.</p><p>On error, <strong>tee</strong>() returns -1 and <em>errno</em> is set to indicate the error.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>EAGAIN</strong></p>
  </dt>
  <dd>
    <p><strong>SPLICE_F_NONBLOCK</strong> was specified in <em>flags</em>, and the operation would block.</p>
  </dd>
  <dt>
    <p><strong>EINVAL</strong></p>
  </dt>
  <dd>
    <p><em>fd_in</em> or <em>fd_out</em> does not refer to a pipe; or <em>fd_in</em> and <em>fd_out</em> refer to the same pipe.</p>
  </dd>
  <dt>
    <p><strong>ENOMEM</strong></p>
  </dt>
  <dd>
    <p>Out of memory.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VERSIONS</h2>
        <div class="sectioncontent">
<p>The <strong>tee</strong>() system call first appeared in Linux 2.6.17; library support was added to glibc in version 2.5.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFORMING TO</h2>
        <div class="sectioncontent">
<p>This system call is Linux-specific.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>Conceptually, <strong>tee</strong>() copies the data between the two pipes. In reality no real data copying takes place though: under the covers, <strong>tee</strong>() assigns data to the output by merely grabbing a reference to the input.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>The example below implements a basic <strong>tee</strong>(1) program using the <strong>tee</strong>() system call. Here is an example of its use:</p>
<pre>
$ <strong>date |./a.out out.log | cat</strong>
Tue Oct 28 10:06:00 CET 2014
$ <strong>cat out.log</strong>
Tue Oct 28 10:06:00 CET 2014
</pre>
<h3>Program source</h3>

<pre>

#define _GNU_SOURCE
#include &lt;fcntl.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;errno.h&gt;
#include &lt;limits.h&gt;

int
main(int argc, char *argv[])
{
    int fd;
    int len, slen;

    if (argc != 2) {
        fprintf(stderr, "Usage: %s &lt;file&gt;&#92;n", argv[0]);
        exit(EXIT_FAILURE);
    }

    fd = open(argv[1], O_WRONLY | O_CREAT | O_TRUNC, 0644);
    if (fd == -1) {
        perror("open");
        exit(EXIT_FAILURE);
    }

    do {
        /*
         * tee stdin to stdout.
         */
        len = tee(STDIN_FILENO, STDOUT_FILENO,
                  INT_MAX, SPLICE_F_NONBLOCK);

        if (len &lt; 0) {
            if (errno == EAGAIN)
                continue;
            perror("tee");
            exit(EXIT_FAILURE);
        } else
            if (len == 0)
                break;

        /*
         * Consume stdin by splicing it to a file.
         */
        while (len &gt; 0) {
            slen = splice(STDIN_FILENO, NULL, fd, NULL,
                          len, SPLICE_F_MOVE);
            if (slen &lt; 0) {
                perror("splice");
                break;
            }
            len -= slen;
        }
    } while (1);

    close(fd);
    exit(EXIT_SUCCESS);
}
</pre>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO tee&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man2/splice.2.html"><strong>splice</strong>(2)</a>, <a href="../man2/vmsplice.2.html"><strong>vmsplice</strong>(2)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="syslog.2.html"><span aria-hidden="true">&larr;</span> syslog.2: Read and/or clear kernel message ring buffer; set console_loglevel</a></li>
   <li class="next"><a href="tgkill.2.html">tgkill.2: Send a signal to a thread <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
