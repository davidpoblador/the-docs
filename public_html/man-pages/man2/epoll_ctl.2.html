<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>epoll_ctl: Control interface for an epoll file descriptor</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Control interface for an epoll file descriptor">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">epoll_ctl<small> (2)</small></h1>
        <p class="lead">Control interface for an epoll file descriptor</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man2/">
      <span itemprop="name">System calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man2/epoll_ctl.2.html">
      <span itemprop="name">epoll_ctl: Control interface for an epoll file descriptor</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/man-pages/">
      <span itemprop="name">man-pages</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man2/epoll_ctl.2.html">
      <span itemprop="name">epoll_ctl: Control interface for an epoll file descriptor</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p><strong>#include &lt;sys/epoll.h&gt;</strong></p>
<p class='spacer'>

<p><strong>int epoll_ctl(int </strong><em>epfd</em><strong>, int </strong><em>op</em><strong>, int </strong><em>fd</em><strong>, struct epoll_event *</strong><em>event</em><strong>);</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p>This system call performs control operations on the <a href="../man7/epoll.7.html"><strong>epoll</strong>(7)</a> instance referred to by the file descriptor <em>epfd</em>. It requests that the operation <em>op</em> be performed for the target file descriptor, <em>fd</em>.</p>
<p class='spacer'>

  <p>Valid values for the <em>op</em> argument are:</p>
  <dl class='dl-vertical'>
    <dt><strong>EPOLL_CTL_ADD</strong></dt>
    <dd>
  <p>Register the target file descriptor <em>fd</em> on the <strong>epoll</strong> instance referred to by the file descriptor <em>epfd</em> and associate the event <em>event</em> with the internal file linked to <em>fd</em>.</p>
    </dd>
    <dt><strong>EPOLL_CTL_MOD</strong></dt>
    <dd>
  <p>Change the event <em>event</em> associated with the target file descriptor <em>fd</em>.</p>
    </dd>
    <dt><strong>EPOLL_CTL_DEL</strong></dt>
    <dd>
  <p>Remove (deregister) the target file descriptor <em>fd</em> from the <strong>epoll</strong> instance referred to by <em>epfd</em>. The <em>event</em> is ignored and can be NULL (but see BUGS below).</p>
    </dd>
  </dl>
<p class='spacer'>

<p>The <em>event</em> argument describes the object linked to the file descriptor <em>fd</em>. The <em>struct epoll_event</em> is defined as:</p>
<p class='spacer'>

<pre>typedef union epoll_data {
    void        *ptr;
    int          fd;
    uint32_t     u32;
    uint64_t     u64;
} epoll_data_t;

struct epoll_event {
    uint32_t     events;      /* Epoll events */
    epoll_data_t data;        /* User data variable */
};</pre>

<p class='spacer'>

  <p>The <em>events</em> member is a bit mask composed using the following available event types:</p>
  <dl class='dl-vertical'>
    <dt><strong>EPOLLIN</strong></dt>
    <dd>
  <p>The associated file is available for <a href="../man2/read.2.html"><strong>read</strong>(2)</a> operations.</p>
    </dd>
    <dt><strong>EPOLLOUT</strong></dt>
    <dd>
  <p>The associated file is available for <a href="../man2/write.2.html"><strong>write</strong>(2)</a> operations.</p>
    </dd>
    <dt><strong>EPOLLRDHUP</strong> (since Linux 2.6.17)</dt>
    <dd>
  <p>Stream socket peer closed connection, or shut down writing half of connection. (This flag is especially useful for writing simple code to detect peer shutdown when using Edge Triggered monitoring.)</p>
    </dd>
    <dt><strong>EPOLLPRI</strong></dt>
    <dd>
  <p>There is urgent data available for <a href="../man2/read.2.html"><strong>read</strong>(2)</a> operations.</p>
    </dd>
    <dt><strong>EPOLLERR</strong></dt>
    <dd>
  <p>Error condition happened on the associated file descriptor. <a href="../man2/epoll_wait.2.html"><strong>epoll_wait</strong>(2)</a> will always wait for this event; it is not necessary to set it in <em>events</em>.</p>
    </dd>
    <dt><strong>EPOLLHUP</strong></dt>
    <dd>
  <p>Hang up happened on the associated file descriptor. <a href="../man2/epoll_wait.2.html"><strong>epoll_wait</strong>(2)</a> will always wait for this event; it is not necessary to set it in <em>events</em>. Note that when reading from a channel such as a pipe or a stream socket, this event merely indicates that the peer closed its end of the channel. Subsequent reads from the channel will return 0 (end of file) only after all outstanding data in the channel has been consumed.</p>
    </dd>
    <dt><strong>EPOLLET</strong></dt>
    <dd>
  <p>Sets the Edge Triggered behavior for the associated file descriptor. The default behavior for <strong>epoll</strong> is Level Triggered. See <a href="../man7/epoll.7.html"><strong>epoll</strong>(7)</a> for more detailed information about Edge and Level Triggered event distribution architectures.</p>
    </dd>
    <dt><strong>EPOLLONESHOT</strong> (since Linux 2.6.2)</dt>
    <dd>
  <p>Sets the one-shot behavior for the associated file descriptor. This means that after an event is pulled out with <a href="../man2/epoll_wait.2.html"><strong>epoll_wait</strong>(2)</a> the associated file descriptor is internally disabled and no other events will be reported by the <strong>epoll</strong> interface. The user must call <strong>epoll_ctl</strong>() with <strong>EPOLL_CTL_MOD</strong> to rearm the file descriptor with a new event mask.</p>
    </dd>
    <dt><strong>EPOLLWAKEUP</strong> (since Linux 3.5)</dt>
    <dd>
  <p>If <strong>EPOLLONESHOT</strong> and <strong>EPOLLET</strong> are clear and the process has the <strong>CAP_BLOCK_SUSPEND</strong> capability, ensure that the system does not enter "suspend" or "hibernate" while this event is pending or being processed. The event is considered as being "processed" from the time when it is returned by a call to <a href="../man2/epoll_wait.2.html"><strong>epoll_wait</strong>(2)</a> until the next call to <a href="../man2/epoll_wait.2.html"><strong>epoll_wait</strong>(2)</a> on the same <a href="../man7/epoll.7.html"><strong>epoll</strong>(7)</a> file descriptor, the closure of that file descriptor, the removal of the event file descriptor with <strong>EPOLL_CTL_DEL</strong>, or the clearing of <strong>EPOLLWAKEUP</strong> for the event file descriptor with <strong>EPOLL_CTL_MOD</strong>. See also BUGS.</p>
    </dd>
    <dt><strong>EPOLLEXCLUSIVE</strong> (since Linux 4.5)</dt>
    <dd>
  <p>Sets an exclusive wakeup mode for the epoll file descriptor that is being attached to the target file descriptor, <em>fd</em>. When a wakeup event occurs and multiple epoll file descriptors are attached to the same target file using <strong>EPOLLEXCLUSIVE</strong>, one or more of the epoll file descriptors will receive an event with <a href="../man2/epoll_wait.2.html"><strong>epoll_wait</strong>(2)</a>. The default in this scenario (when <strong>EPOLLEXCLUSIVE</strong> is not set) is for all epoll file descriptors to receive an event. <strong>EPOLLEXCLUSIVE</strong> is thus useful for avoiding thundering herd problems in certain scenarios.</p>
<p class='spacer'>

  <p>If the same file descriptor is in multiple epoll instances, some with the <strong>EPOLLEXCLUSIVE</strong> flag, and others without, then events will provided to all epoll instances that did not specify <strong>EPOLLEXCLUSIVE</strong>, and at least one of the epoll instances that did specify <strong>EPOLLEXCLUSIVE</strong>.</p>
<p class='spacer'>

  <p>The following values may be specified in conjunction with <strong>EPOLLEXCLUSIVE</strong>: <strong>EPOLLIN</strong>, <strong>EPOLLOUT</strong>, <strong>EPOLLWAKEUP,</strong> and <strong>EPOLLET</strong>. <strong>EPOLLHUP</strong> and <strong>EPOLLERR</strong> can also be specified, but this is not required: as usual, these events are always reported if they occur, regardless of whether they are specified in <em>events</em>. Attempts to specify other values in <em>events</em> yield an error. <strong>EPOLLEXCLUSIVE</strong> may be used only in an <strong>EPOLL_CTL_ADD</strong> operation; attempts to employ it with <strong>EPOLL_CTL_MOD</strong> yield an error. If <strong>EPOLLEXCLUSIVE</strong> has set using <a href="../man2/epoll_ctl.2.html"><strong>epoll_ctl</strong>(2)</a>, then a subsequent <strong>EPOLL_CTL_MOD</strong> on the same <em>epfd</em>,&nbsp;<em>fd</em> pair yields an error. A call to <a href="../man2/epoll_ctl.2.html"><strong>epoll_ctl</strong>(2)</a> that specifies <strong>EPOLLEXCLUSIVE</strong> in <em>events</em> and specifies the target file descriptor <em>fd</em> as an epoll instance will likewise fail. The error in all of these cases is <strong>EINVAL</strong>.</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">

<p>When successful, <strong>epoll_ctl</strong>() returns zero. When an error occurs, <strong>epoll_ctl</strong>() returns -1 and <em>errno</em> is set appropriately.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">

  <dl class='dl-vertical'>
    <dt><strong>EBADF</strong></dt>
    <dd>
  <p><em>epfd</em> or <em>fd</em> is not a valid file descriptor.</p>
    </dd>
    <dt><strong>EEXIST</strong></dt>
    <dd>
  <p><em>op</em> was <strong>EPOLL_CTL_ADD</strong>, and the supplied file descriptor <em>fd</em> is already registered with this epoll instance.</p>
    </dd>
    <dt><strong>EINVAL</strong></dt>
    <dd>
  <p><em>epfd</em> is not an <strong>epoll</strong> file descriptor, or <em>fd</em> is the same as <em>epfd</em>, or the requested operation <em>op</em> is not supported by this interface.</p>
    </dd>
    <dt><strong>ELOOP</strong></dt>
    <dd>
  <p><em>fd</em> refers to an epoll instance and this <strong>EPOLL_CTL_ADD</strong> operation would result in a circular loop of epoll instances monitoring one another.</p>
    </dd>
    <dt><strong>EINVAL</strong></dt>
    <dd>
  <p>An invalid event type was specified along with <strong>EPOLLEXCLUSIVE</strong> in <em>events</em>.</p>
    </dd>
    <dt><strong>EINVAL</strong></dt>
    <dd>
  <p><em>op</em> was <strong>EPOLL_CTL_MOD</strong> and <em>events</em> included <strong>EPOLLEXCLUSIVE</strong>.</p>
    </dd>
    <dt><strong>EINVAL</strong></dt>
    <dd>
  <p><em>op</em> was <strong>EPOLL_CTL_MOD</strong> and the <strong>EPOLLEXCLUSIVE</strong> flag has previously been applied to this <em>epfd</em>,&nbsp;<em>fd</em> pair.</p>
    </dd>
    <dt><strong>EINVAL</strong></dt>
    <dd>
  <p><strong>EPOLLEXCLUSIVE</strong> was specified in <em>event</em> and <em>fd</em> refers to an epoll instance.</p>
    </dd>
    <dt><strong>ENOENT</strong></dt>
    <dd>
  <p><em>op</em> was <strong>EPOLL_CTL_MOD</strong> or <strong>EPOLL_CTL_DEL</strong>, and <em>fd</em> is not registered with this epoll instance.</p>
    </dd>
    <dt><strong>ENOMEM</strong></dt>
    <dd>
  <p>There was insufficient memory to handle the requested <em>op</em> control operation.</p>
    </dd>
    <dt><strong>ENOSPC</strong></dt>
    <dd>
  <p>The limit imposed by <em>/proc/sys/fs/epoll/max_user_watches</em> was encountered while trying to register (<strong>EPOLL_CTL_ADD</strong>) a new file descriptor on an epoll instance. See <a href="../man7/epoll.7.html"><strong>epoll</strong>(7)</a> for further details.</p>
    </dd>
    <dt><strong>EPERM</strong></dt>
    <dd>
  <p>The target file <em>fd</em> does not support <strong>epoll</strong>. This error can occur if <em>fd</em> refers to, for example, a regular file or a directory.</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VERSIONS</h2>
        <div class="sectioncontent">

<p><strong>epoll_ctl</strong>() was added to the kernel in version 2.6.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFORMING TO</h2>
        <div class="sectioncontent">

<p><strong>epoll_ctl</strong>() is Linux-specific. Library support is provided in glibc starting with version 2.3.2.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<p>The <strong>epoll</strong> interface supports all file descriptors that support <a href="../man2/poll.2.html"><strong>poll</strong>(2)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">

<p>In kernel versions before 2.6.9, the <strong>EPOLL_CTL_DEL</strong> operation required a non-null pointer in <em>event</em>, even though this argument is ignored. Since Linux 2.6.9, <em>event</em> can be specified as NULL when using <strong>EPOLL_CTL_DEL</strong>. Applications that need to be portable to kernels before 2.6.9 should specify a non-null pointer in <em>event</em>.</p>
<p class='spacer'>

<p>If <strong>EPOLLWAKEUP</strong> is specified in <em>flags</em>, but the caller does not have the <strong>CAP_BLOCK_SUSPEND</strong> capability, then the <strong>EPOLLWAKEUP</strong> flag is <em>silently ignored</em>. This unfortunate behavior is necessary because no validity checks were performed on the <em>flags</em> argument in the original implementation, and the addition of the <strong>EPOLLWAKEUP</strong> with a check that caused the call to fail if the caller did not have the <strong>CAP_BLOCK_SUSPEND</strong> capability caused a breakage in at least one existing user-space application that happened to randomly (and uselessly) specify this bit. A robust application should therefore double check that it has the <strong>CAP_BLOCK_SUSPEND</strong> capability if attempting to use the <strong>EPOLLWAKEUP</strong> flag.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<p><a href="../man2/epoll_create.2.html"><strong>epoll_create</strong>(2)</a>, <a href="../man2/epoll_wait.2.html"><strong>epoll_wait</strong>(2)</a>, <a href="../man2/poll.2.html"><strong>poll</strong>(2)</a>, <a href="../man7/epoll.7.html"><strong>epoll</strong>(7)</a></p>
        </div>
      </section>

<nav>
  <ul class="pager">
   <li class="previous"><a href="epoll_create1.2.html"><span aria-hidden="true">&larr;</span> epoll_create1.2: open an epoll file descriptor</a></li>
   <li class="next"><a href="epoll_pwait.2.html">epoll_pwait.2: wait for an I/O event on an epoll file descriptor <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
