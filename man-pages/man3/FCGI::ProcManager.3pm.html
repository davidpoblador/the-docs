<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FCGI::ProcManager: </title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="FCGI::ProcManager (3pm) manual">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="https://www.carta.tech/images/libfcgi-procmanager-perl-FCGI::ProcManager-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/FCGI::ProcManager.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="FCGI::ProcManager (3pm) manual" />
  <meta property="og:description" content="" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libfcgi-procmanager-perl-FCGI::ProcManager-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">FCGI::ProcManager<small> (3pm)</small></h1>
        <p class="lead"></p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/FCGI::ProcManager.3pm.html">
      <span itemprop="name">FCGI::ProcManager: </span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libfcgi-procmanager-perl/">
      <span itemprop="name">libfcgi-procmanager-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/FCGI::ProcManager.3pm.html">
      <span itemprop="name">FCGI::ProcManager: </span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p> # In Object-oriented style.  use CGI::Fast;  use FCGI::ProcManager;  my $proc_manager = FCGI::ProcManager-&gt;new({     n_processes =&gt; 10  });  $proc_manager-&gt;pm_manage();  while (my $cgi = CGI::Fast-&gt;new()) {    $proc_manager-&gt;pm_pre_dispatch();    # ... handle the request here ...    $proc_manager-&gt;pm_post_dispatch();  }</p><p> # This style is also supported:  use CGI::Fast;  use FCGI::ProcManager qw(pm_manage pm_pre_dispatch               pm_post_dispatch);  pm_manage( n_processes =&gt; 10 );  while (my $cgi = CGI::Fast-&gt;new()) {    pm_pre_dispatch();    #...    pm_post_dispatch();  }</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>FCGI::ProcManager is used to serve as a FastCGI process manager.  By re-implementing it in perl, developers can more finely tune performance in their web applications, and can take advantage of copy-on-write semantics prevalent in \s-1UNIX\s0 kernel process management.  The process manager should be invoked before the caller''s request loop</p><p>The primary routine, \*(C`pm_manage\*(C', enters a loop in which it maintains a number of FastCGI servers (via <em>fork</em>\|(2)), and which reaps those servers when they die (via <em>wait</em>\|(2)).</p><p>\*(C`pm_manage\*(C' provides too hooks:</p><p> C&lt;managing_init&gt; - called just before the manager enters the manager loop.  C&lt;handling_init&gt; - called just before a server is returns from C&lt;pm_manage&gt;</p><p>It is necessary for the caller, when implementing its request loop, to insert a call to \*(C`pm_pre_dispatch\*(C' at the top of the loop, and then 7\*(C`pm_post_dispatch\*(C' at the end of the loop.</p><h3>Signal Handling</h3>
<p>FCGI::ProcManager attempts to do the right thing for proper shutdowns now.</p><p>When it receives a \s-1SIGHUP\s0, it sends a \s-1SIGTERM\s0 to each of its children, and then resumes its normal operations.</p><p>When it receives a \s-1SIGTERM\s0, it sends a \s-1SIGTERM\s0 to each of its children, sets an <em>alarm</em>\|(3) \*(L"die timeout\*(R" handler, and waits for each of its children to die.  If all children die before this timeout, process manager exits with return status 0.  If all children do not die by the time the \*(L"die timeout\*(R" occurs, the process manager sends a \s-1SIGKILL\s0 to each of the remaining children, and exists with return status 1.</p><p>In order to get FastCGI servers to exit upon receiving a signal, it is necessary to use its \s-1FAIL_ACCEPT_ON_INTR\s0.  See \s-1FCGI\s0's description of \s-1FAIL_ACCEPT_ON_INTR\s0.  Unfortunately, if you want/need to use CGI::Fast, it is currently necessary to run the latest (at the time of writing) development version of \s-1FCGI\s0.pm. (&gt;= 0.71_02)</p><p>Otherwise, if you don't, there is a loop around <em>accept</em>\|(2) which prevents os_unix.c <em>OS_Accept()</em> from returning the necessary error when FastCGI servers blocking on <em>accept</em>\|(2) receive the \s-1SIGTERM\s0 or \s-1SIGHUP\s0.</p><p>FCGI::ProcManager uses <em>POSIX::sigaction()</em> to override the default \s-1SA_RESTART\s0 policy used for perl's %SIG behavior.  Specifically, the process manager never uses \s-1SA_RESTART\s0, while the child FastCGI servers turn off \s-1SA_RESTART\s0 around the <em>accept</em>\|(2) loop, but re-enstate it otherwise.</p><p>The desired (and implemented) effect is to give a request as big a chance as possible to succeed and to delay their exits until after their request, while allowing the FastCGI servers waiting for new requests to die right away.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<h3>new</h3>
<p> class or instance  (ProcManager) new([hash parameters])</p><p>Constructs a new process manager.  Takes an option has of initial parameter values, and assigns these to the constructed object \s-1HASH\s0, overriding any default values.  The default parameter values currently are:</p><p> role         =&gt; manager  start_delay  =&gt; 0  die_timeout  =&gt; 60  pm_title =&gt; &apos;perl-fcgi-pm&apos;</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Manager methods</h2>
        <div class="sectioncontent">
<h3>pm_manage</h3>
<p> instance or export  (int) pm_manage([hash parameters])</p><p>\s-1DESCRIPTION:\s0</p><p>When this is called by a FastCGI script to manage application servers.  It defines a sequence of instructions for a process to enter this method and begin forking off and managing those handlers, and it defines a sequence of instructions to intialize those handlers.</p><p>If n_processes &lt; 1, the managing section is subverted, and only the handling sequence is executed.</p><p>Either returns the return value of <em>pm_die()</em> and/or <em>pm_abort()</em> (which will not ever return in general), or returns 1 to the calling script to begin handling requests.</p>
<h3>managing_init</h3>
<p> instance  () managing_init()</p><p>\s-1DESCRIPTION:\s0</p><p>Overrideable method which initializes a process manager.  In order to handle signals, manage the \s-1PID\s0 file, and change the process name properly, any method which overrides this should call <em>SUPER::managing_init()</em>.</p>
<h3>pm_die</h3>
<p> instance or export  () pm_die(string msg[, int exit_status])</p><p>\s-1DESCRIPTION:\s0</p><p>This method is called when a process manager receives a notification to shut itself down.  <em>pm_die()</em> attempts to shutdown the process manager gently, sending a \s-1SIGTERM\s0 to each managed process, waiting <em>die_timeout()</em> seconds to reap each process, and then exit gracefully once all children are reaped, or to abort if all children are not reaped.</p>
<h3>pm_wait</h3>
<p> instance or export  (int pid) pm_wait()</p><p>\s-1DESCRIPTION:\s0</p><p>This calls <em>wait()</em> which suspends execution until a child has exited. If the process \s-1ID\s0 returned by wait corresponds to a managed process, <em>pm_notify()</em> is called with the exit status of that process. <em>pm_wait()</em> returns with the return value of <em>wait()</em>.</p>
<h3>pm_write_pid_file</h3>
<p> instance or export  () pm_write_pid_file([string filename])</p><p>\s-1DESCRIPTION:\s0</p><p>Writes current process \s-1ID\s0 to optionally specified file.  If no filename is specified, it uses the value of the \*(C`pid_fname\*(C' parameter.</p>
<h3>pm_remove_pid_file</h3>
<p> instance or export  () pm_remove_pid_file()</p><p>\s-1DESCRIPTION:\s0</p><p>Removes optionally specified file.  If no filename is specified, it uses the value of the \*(C`pid_fname\*(C' parameter.</p>
<h3>sig_sub</h3>
<p> instance  () sig_sub(string name)</p><p>\s-1DESCRIPTION:\s0</p><p>The name of this method is passed to <em>POSIX::sigaction()</em>, and handles signals for the process manager.  If $SIG_CODEREF is set, then the input arguments to this are passed to a call to that.</p>
<h3>sig_manager</h3>
<p> instance  () sig_manager(string name)</p><p>\s-1DESCRIPTION:\s0</p><p>Handles signals of the process manager.  Takes as input the name of signal being handled.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Handler methods</h2>
        <div class="sectioncontent">
<h3>handling_init</h3>
<p> instance or export  () handling_init()</p><p>\s-1DESCRIPTION:\s0</p>
<h3>pm_pre_dispatch</h3>
<p> instance or export  () pm_pre_dispatch()</p><p>\s-1DESCRIPTION:\s0</p>
<h3>pm_post_dispatch</h3>
<p> instance or export  () pm_post_dispatch()</p><p>\s-1DESCRIPTION:\s0</p>
<h3>sig_handler</h3>
<p> instance or export  () sig_handler()</p><p>\s-1DESCRIPTION:\s0</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Common methods and routines</h2>
        <div class="sectioncontent">
<h3>self_or_default</h3>
<p> private global  (ProcManager, @args) self_or_default([ ProcManager, ] @args);</p><p>\s-1DESCRIPTION:\s0</p><p>This is a helper subroutine to acquire or otherwise create a singleton default object if one is not passed in, e.g., a method call.</p>
<h3>pm_change_process_name</h3>
<p> instance or export  () pm_change_process_name()</p><p>\s-1DESCRIPTION:\s0</p>
<h3>pm_received_signal</h3>
<p> instance or export  () pm_received signal()</p><p>\s-1DESCRIPTION:\s0</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">parameters</h2>
        <div class="sectioncontent">
<h3>pm_parameter</h3>
<p> instance or export  () pm_parameter()</p><p>\s-1DESCRIPTION:\s0</p>
<h3>n_processes</h3>

<h3>no_signals</h3>

<h3>pid_fname</h3>

<h3>die_timeout</h3>

<h3>role</h3>

<h3>start_delay</h3>
<p>\s-1DESCRIPTION:\s0</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">notification and death</h2>
        <div class="sectioncontent">
<h3>pm_warn</h3>
<p> instance or export  () pm_warn()</p><p>\s-1DESCRIPTION:\s0</p>
<h3>pm_notify</h3>
<p> instance or export  () pm_notify()</p><p>\s-1DESCRIPTION:\s0</p>
<h3>pm_exit</h3>
<p> instance or export  () pm_exit(string msg[, int exit_status])</p><p>\s-1DESCRIPTION:\s0</p>
<h3>pm_abort</h3>
<p> instance or export  () pm_abort(string msg[, int exit_status])</p><p>\s-1DESCRIPTION:\s0</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>No known bugs, but this does not mean no bugs exist.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO FCGI::ProcManager&hellip;</h2>
        <div class="sectioncontent">
<p>\s-1FCGI\s0.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MAINTAINER</h2>
        <div class="sectioncontent">
<p>Gareth Kirwan &lt;gbjk@thermeon.com&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>James E Jurach Jr.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p> FCGI-ProcManager - A Perl FCGI Process Manager  Copyright (c) 2000, FundsXpress Financial Network, Inc.</p><p> This library is free software; you can redistribute it and/or  modify it under the terms of the GNU Lesser General Public  License as published by the Free Software Foundation; either  version 2 of the License, or (at your option) any later version.</p><p> BECAUSE THIS LIBRARY IS LICENSED FREE OF CHARGE, THIS LIBRARY IS  BEING PROVIDED "AS IS WITH ALL FAULTS," WITHOUT ANY WARRANTIES  OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING, WITHOUT  LIMITATION, ANY IMPLIED WARRANTIES OF TITLE, NONINFRINGEMENT,  MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE, AND THE  ENTIRE RISK AS TO SATISFACTORY QUALITY, PERFORMANCE, ACCURACY,  AND EFFORT IS WITH THE YOU.  See the GNU Lesser General Public  License for more details.</p><p> You should have received a copy of the GNU Lesser General Public  License along with this library; if not, write to the Free Software  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307  USA</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="ExtUtils::XSBuilder::WrapXS.3pm.html"><span aria-hidden="true">&larr;</span> ExtUtils::XSBuilder::WrapXS.3pm: Create perl xs wrappers for c functions</a></li>
   <li class="next"><a href="FCGI::ProcManager::Constrained.3pm.html">FCGI::ProcManager::Constrained.3pm: Process manager with constraints <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
