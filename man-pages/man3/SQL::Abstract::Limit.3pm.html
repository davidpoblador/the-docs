<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SQL::Abstract::Limit: Portable limit emulation</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Portable limit emulation">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="SQL::Abstract::Limit (3pm) manual">
  <meta name="twitter:description" content="Portable limit emulation">
  <meta name="twitter:image" content="https://www.carta.tech/images/libsql-abstract-limit-perl-SQL::Abstract::Limit-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/SQL::Abstract::Limit.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="SQL::Abstract::Limit (3pm) manual" />
  <meta property="og:description" content="Portable limit emulation" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libsql-abstract-limit-perl-SQL::Abstract::Limit-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">SQL::Abstract::Limit<small> (3pm)</small></h1>
        <p class="lead">Portable limit emulation</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/SQL::Abstract::Limit.3pm.html">
      <span itemprop="name">SQL::Abstract::Limit: Portable limit emulation</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libsql-abstract-limit-perl/">
      <span itemprop="name">libsql-abstract-limit-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/SQL::Abstract::Limit.3pm.html">
      <span itemprop="name">SQL::Abstract::Limit: Portable limit emulation</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    use SQL::Abstract::Limit;

    my $sql = SQL::Abstract::Limit-&gt;new( limit_dialect =&gt; &apos;LimitOffset&apos; );;

    # or autodetect from a DBI $dbh:
    my $sql = SQL::Abstract::Limit-&gt;new( limit_dialect =&gt; $dbh );

    # or from a Class::DBI class:
    my $sql = SQL::Abstract::Limit-&gt;new( limit_dialect =&gt; &apos;My::CDBI::App&apos; );

    # or object:
    my $obj = My::CDBI::App-&gt;retrieve( $id );
    my $sql = SQL::Abstract::Limit-&gt;new( limit_dialect =&gt; $obj );

    # generate SQL:
    my ( $stmt, @bind ) = $sql-&gt;select( $table, &#92;@fields, &#92;%where, &#92;@order, $limit, $offset );

    # Then, use these in your DBI statements
    my $sth = $dbh-&gt;prepare( $stmt );
    $sth-&gt;execute( @bind );

    # Just generate the WHERE clause (only available for some syntaxes)
    my ( $stmt, @bind )  = $sql-&gt;where( &#92;%where, &#92;@order, $limit, $offset );
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Portability layer for \s-1LIMIT\s0 emulation.</p>
<dl class='dl-vertical'>
  <dt>
    new( case =&gt; 'lower', cmp =&gt; 'like', logic =&gt; 'and', convert =&gt; 'upper', limit_dialect =&gt; 'Top' )
  </dt>
  <dd>
    <p>All settings are optional.</p>
<dl class='dl-vertical'>
  <dt>
    limit_dialect
  </dt>
  <dd>
    <p>Sets the default syntax model to use for emulating a \*(C`LIMIT $rows OFFSET $offset\*(C' clause. Default setting is \*(C`GenericSubQ\*(C'. You can still pass other syntax settings in method calls, this just sets the default. Possible values are:     LimitOffset     PostgreSQL, SQLite     LimitXY         MySQL, MaxDB, anything that uses SQL::Statement     LimitYX         SQLite (optional)     RowsTo          InterBase/FireBird</p><p>    Top             SQL/Server, MS Access     RowNum          Oracle     FetchFirst      DB2     Skip            Informix     GenericSubQ     Sybase, plus any databases not recognised by this module</p><p>    $dbh            a DBI database handle</p><p>    CDBI subclass     CDBI object</p><p>    other DBI-based thing The first group are implemented by appending a short clause to the end of the statement. The second group require more intricate wrapping of the original statement in subselects. You can pass a \s-1DBI\s0 database handle, and the module will figure out which dialect to use. You can pass a Class::DBI subclass or object, and the module will find the $dbh and use it to find the dialect. Anything else based on \s-1DBI\s0 can be easily added by locating the $dbh. Patches or suggestions welcome.</p>
  </dd>

</dl>
<p>Other options are described in SQL::Abstract.</p><p>Same as \*(C`SQL::Abstract::select\*(C', but accepts additional $rows, $offset and $dialect parameters. The $order parameter is required if $rows is specified. The $fields parameter is required, but can be set to \*(C`undef\*(C', &apos;&apos; or &apos;*&apos; (all these get set to &apos;*&apos;). The $where parameter is also required. It can be a hashref or an arrayref, or \*(C`undef\*(C'. Same as \*(C`SQL::Abstract::where\*(C', but accepts additional $rows, $offset and $dialect parameters. Some \s-1SQL\s0 dialects support syntaxes that can be applied as simple phrases tacked on to the end of the \s-1WHERE\s0 clause. These are:     LimitOffset     LimitXY     LimitYX     RowsTo This method returns a modified \s-1WHERE\s0 clause, if the limit syntax is set to one of these options (either in the call to \*(C`where\*(C' or in the constructor), and if $rows is passed in. Dies via \*(C`croak\*(C' if you try to use it for other syntaxes. $order is required if $rows is set. $where is required if any other parameters are specified. It can be a hashref or an arrayref, or \*(C`undef\*(C'. Returns a regular \*(C`WHERE\*(C' clause if no limits are set.</p>
  </dd>
  <dt>
    insert
  </dt>
  <dd>
    
  </dd>
  <dt>
    update
  </dt>
  <dd>
    
  </dd>
  <dt>
    delete
  </dt>
  <dd>
    
  </dd>
  <dt>
    values
  </dt>
  <dd>
    
  </dd>
  <dt>
    generate
  </dt>
  <dd>
    <p>See SQL::Abstract for these methods. \*(C`update\*(C' and \*(C`delete\*(C' are not provided with any \*(C`LIMIT\*(C' emulation in this release, and no support is planned at the moment. But patches would be welcome.</p>
  </dd>

</dl>
<h3>Limit emulation</h3>
<p>The following dialects are available for emulating the \s-1LIMIT\s0 clause. In each case, $sql represents the \s-1SQL\s0 statement generated by \*(C`SQL::Abstract::select\*(C', minus the \s-1ORDER\s0 \s-1BY\s0 clause, e.g.</p><p>    SELECT foo, bar FROM my_table WHERE some_conditions</p><p>$sql_after_select represents $sql with the leading \*(C`SELECT\*(C' keyword removed.</p><p>\*(C`order_cols_up\*(C' represents the sort column(s) and direction(s) specified in the \*(C`order\*(C' parameter.</p><p>\*(C`order_cols_down\*(C' represents the opposite sort.</p><p>\*(C`$last = $rows + $offset\*(C'</p>
<dl class='dl-vertical'>
  <dt>
    LimitOffset
  </dt>
  <dd>
    
<dl class='dl-vertical'>
  <dt>
    Syntax
  </dt>
  <dd>
    <p>    $sql ORDER BY order_cols_up LIMIT $rows OFFSET $offset or     $sql ORDER BY order_cols_up LIMIT $rows if \*(C`$offset == 0\*(C'.</p>
  </dd>
  <dt>
    Databases
  </dt>
  <dd>
    <p>    PostgreSQL     SQLite</p>
  </dd>

</dl>

  </dd>
  <dt>
    LimitXY
  </dt>
  <dd>
    
<dl class='dl-vertical'>
  <dt>
    Syntax
  </dt>
  <dd>
    <p>    $sql ORDER BY order_cols_up LIMIT $offset, $rows or      $sql ORDER BY order_cols_up LIMIT $rows if \*(C`$offset == 0\*(C'.</p>
  </dd>
  <dt>
    Databases
  </dt>
  <dd>
    <p>    MySQL</p>
  </dd>

</dl>

  </dd>
  <dt>
    LimitYX
  </dt>
  <dd>
    
<dl class='dl-vertical'>
  <dt>
    Syntax
  </dt>
  <dd>
    <p>    $sql ORDER BY order_cols_up LIMIT $rows, $offset or     $sql ORDER BY order_cols_up LIMIT $rows if \*(C`$offset == 0\*(C'.</p>
  </dd>
  <dt>
    Databases
  </dt>
  <dd>
    <p>    SQLite understands this syntax, or LimitOffset. If autodetecting the            dialect, it will be set to LimitOffset.</p>
  </dd>

</dl>

  </dd>
  <dt>
    RowsTo
  </dt>
  <dd>
    
<dl class='dl-vertical'>
  <dt>
    Syntax
  </dt>
  <dd>
    <p>    $sql ORDER BY order_cols_up ROWS $offset TO $last</p>
  </dd>
  <dt>
    Databases
  </dt>
  <dd>
    <p>    InterBase     FireBird</p>
  </dd>

</dl>

  </dd>
  <dt>
    Top
  </dt>
  <dd>
    
<dl class='dl-vertical'>
  <dt>
    Syntax
  </dt>
  <dd>
    <p>    SELECT * FROM     (         SELECT TOP $rows * FROM         (             SELECT TOP $last $sql_after_select             ORDER BY order_cols_up         ) AS foo         ORDER BY order_cols_down     ) AS bar     ORDER BY order_cols_up</p>
  </dd>
  <dt>
    Databases
  </dt>
  <dd>
    <p>    SQL/Server     MS Access</p>
  </dd>

</dl>

  </dd>
  <dt>
    RowNum
  </dt>
  <dd>
    
<dl class='dl-vertical'>
  <dt>
    Syntax
  </dt>
  <dd>
    <p>Oracle numbers rows from 1, not zero, so here $offset has been incremented by 1.     SELECT * FROM     (         SELECT A.*, ROWNUM r FROM         (             $sql ORDER BY order_cols_up         ) A         WHERE ROWNUM &lt;= $last     ) B     WHERE r &gt;= $offset</p>
  </dd>
  <dt>
    Databases
  </dt>
  <dd>
    <p>    Oracle</p>
  </dd>

</dl>

  </dd>
  <dt>
    FetchFirst
  </dt>
  <dd>
    
<dl class='dl-vertical'>
  <dt>
    Syntax
  </dt>
  <dd>
    <p>    SELECT * FROM (         SELECT * FROM (             $sql             ORDER BY order_cols_up             FETCH FIRST $last ROWS ONLY         ) foo         ORDER BY order_cols_down         FETCH FIRST $rows ROWS ONLY     ) bar     ORDER BY order_cols_up</p>
  </dd>
  <dt>
    Databases
  </dt>
  <dd>
    <p>\s-1IBM\s0 \s-1DB2\s0</p>
  </dd>

</dl>

  </dd>
  <dt>
    GenericSubQ
  </dt>
  <dd>
    <p>When all else fails, this should work for many databases, but it is probably fairly slow. This method relies on having a column with unique values as the first column in the \*(C`SELECT\*(C' clause (i.e. the first column in the \*(C`&#92;@fields\*(C' parameter). The results will be sorted by that unique column, so any $order parameter is ignored, unless it matches the unique column, in which case the direction of the sort is honoured.</p>
<dl class='dl-vertical'>
  <dt>
    Syntax
  </dt>
  <dd>
    <p>    SELECT field_list FROM $table X WHERE where_clause AND     (         SELECT COUNT(*) FROM $table WHERE $pk &gt; X.$pk     )     BETWEEN $offset AND $last     ORDER BY $pk $asc_desc $pk is the first column in \*(C`field_list\*(C'. $asc_desc is the opposite direction to that specified in the method call. So if you want the final results sorted \*(C`ASC\*(C', say so, and it gets flipped internally, but the results come out as you'd expect. I think. The \*(C`BETWEEN $offset AND $last\*(C' clause is replaced with \*(C`&lt; $rows\*(C' if &lt;$offset == 0&gt;.</p>
  </dd>
  <dt>
    Databases
  </dt>
  <dd>
    <p>Sybase Anything not otherwise known to this module.</p>
  </dd>

</dl>

  </dd>
  <dt>
    Skip
  </dt>
  <dd>
    
<dl class='dl-vertical'>
  <dt>
    Syntax
  </dt>
  <dd>
    <p>  select skip 5 limit 5 * from customer which will take rows 6 through 10 in the select.</p>
  </dd>
  <dt>
    Databases
  </dt>
  <dd>
    <p>Informix</p>
  </dd>

</dl>

  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SUBCLASSING</h2>
        <div class="sectioncontent">
<p>You can create your own syntax by making a subclass that provides an \*(C`emulate_limit\*(C' method. This might be useful if you are using stored procedures to provide more efficient paging.</p><p>This is the \s-1SQL\s0 statement built by SQL::Abstract, but without the \s-1ORDER\s0 \s-1BY\s0 clause, e.g.     SELECT foo, bar FROM my_table WHERE conditions or just     WHERE conditions if calling \*(C`where\*(C' instead of \*(C`select\*(C'. The \*(C`order\*(C' parameter passed to the \*(C`select\*(C' or \*(C`where\*(C' call. You can get an \*(C`ORDER BY\*(C' clause from this by calling     my $order_by = $self-&gt;_order_by( $order ); You can get a pair of \*(C`ORDER BY\*(C' clauses that sort in opposite directions by saying     my ( $up, $down ) = $self-&gt;_order_directions( $order );</p><p>The method should return a suitably modified \s-1SQL\s0 statement.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTO-DETECTING THE DIALECT</h2>
        <div class="sectioncontent">
<p>The $dialect parameter that can be passed to the constructor or to the \*(C`select\*(C' and \*(C`where\*(C' methods can be a number of things. The module will attempt to determine the appropriate syntax to use.</p><p>Supported $dialect things are:</p><p>    dialect name (e.g. LimitOffset, RowsTo, Top etc.)     database moniker (e.g. Oracle, SQLite etc.)     DBI database handle     Class::DBI subclass or object</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CAVEATS</h2>
        <div class="sectioncontent">
<p>Paging results sets is a complicated undertaking, with several competing factors to take into account. This module does <strong>not</strong> magically give you the optimum paging solution for your situation. It gives you a solution that may be good enough in many situations. But if your tables are large, the \s-1SQL\s0 generated here will often not be efficient. Or if your queries involve joins or other complications, you will probably need to look elsewhere.</p><p>But if your tables aren't too huge, and your queries straightforward, you can just plug this module in and move on to your next task.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ACKNOWLEDGEMENTS</h2>
        <div class="sectioncontent">
<p>Thanks to Aaron Johnson for the Top syntax model (SQL/Server and \s-1MS\s0 Access).</p><p>Thanks to Emanuele Zeppieri for the \s-1IBM\s0 \s-1DB2\s0 syntax model.</p><p>Thanks to Paul Falbe for the Informix implementation.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TODO</h2>
        <div class="sectioncontent">
<p>Find more syntaxes to implement.</p><p>Test the syntaxes against real databases. I only have access to MySQL. Reports of success or failure would be great.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DEPENDENCIES</h2>
        <div class="sectioncontent">
<p>SQL::Abstract, DBI::Const::GetInfoType, Carp.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO SQL::Abstract::Limit&hellip;</h2>
        <div class="sectioncontent">
<p>DBIx::SQLEngine, DBIx::SearchBuilder, DBIx::RecordSet.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Please report all bugs via the \s-1CPAN\s0 Request Tracker at http://rt.cpan.org/NoAuth/Bugs.html?Dist=SQL-Abstract-Limit &lt;http://rt.cpan.org/NoAuth/Bugs.html?Dist=SQL-Abstract-Limit&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT AND LICENSE</h2>
        <div class="sectioncontent">
<p>Copyright 2004 by David Baird.</p><p>This library is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>David Baird, \*(C`cpan@riverside-cms.co.uk\*(C'</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HOW IS IT DONE ELSEWHERE</h2>
        <div class="sectioncontent">
<p>A few \s-1CPAN\s0 modules do this for a few databases, but the most comprehensive seem to be DBIx::SQLEngine, DBIx::SearchBuilder and DBIx::RecordSet.</p><p>Have a look in the source code for my notes on how these modules tackle similar problems.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="SNMP::Multi.3pm.html"><span aria-hidden="true">&larr;</span> SNMP::Multi.3pm: Perform snmp operations on multiple hosts simultaneously</a></li>
   <li class="next"><a href="SQL::Dialects::Role.3pm.html">SQL::Dialects::Role.3pm: The role of being a sql::dialect <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
