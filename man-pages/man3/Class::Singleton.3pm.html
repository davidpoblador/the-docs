<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Class::Singleton: Implementation of a "singleton" class</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Implementation of a "singleton" class">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Class::Singleton (3pm) manual">
  <meta name="twitter:description" content="Implementation of a "singleton" class">
  <meta name="twitter:image" content="https://www.carta.tech/images/libclass-singleton-perl-Class::Singleton-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Class::Singleton.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Class::Singleton (3pm) manual" />
  <meta property="og:description" content="Implementation of a "singleton" class" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libclass-singleton-perl-Class::Singleton-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Class::Singleton<small> (3pm)</small></h1>
        <p class="lead">Implementation of a "singleton" class</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Class::Singleton.3pm.html">
      <span itemprop="name">Class::Singleton: Implementation of a "singleton" class</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libclass-singleton-perl/">
      <span itemprop="name">libclass-singleton-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Class::Singleton.3pm.html">
      <span itemprop="name">Class::Singleton: Implementation of a "singleton" class</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    use Class::Singleton;

    my $one = Class::Singleton-&gt;instance();   # returns a new instance
    my $two = Class::Singleton-&gt;instance();   # returns same instance
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This is the \*(C`Class::Singleton\*(C' module.  A Singleton describes an object class that can have only one instance in any system.  An example of a Singleton might be a print spooler or system registry.  This module implements a Singleton class from which other classes can be derived.  By itself, the \*(C`Class::Singleton\*(C' module does very little other than manage the instantiation of a single object.  In deriving a class from \*(C`Class::Singleton\*(C', your module will inherit the Singleton instantiation method and can implement whatever specific functionality is required.</p><p>For a description and discussion of the Singleton class, see \*(L"Design Patterns\*(R", Gamma et al, Addison-Wesley, 1995, \s-1ISBN\s0 0-201-63361-2.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PREREQUISITES</h2>
        <div class="sectioncontent">
<p>\*(C`Class::Singleton\*(C' requires Perl version 5.004 or later. If you have an older version of Perl, please upgrade to latest version, available from your nearest \s-1CPAN\s0 site (see \s-1INSTALLATION\s0 below).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INSTALLATION</h2>
        <div class="sectioncontent">
<p>The \*(C`Class::Singleton\*(C' module is available from \s-1CPAN\s0. As the 'perlmod' man page explains:</p><p>    CPAN stands for the Comprehensive Perl Archive Network.     This is a globally replicated collection of all known Perl     materials, including hundreds of unbunded modules.</p><p>    [...]</p><p>    For an up-to-date listing of CPAN sites, see     http://www.perl.com/perl/ or ftp://ftp.perl.com/perl/ .</p><p>The module is available in the following directories:</p><p>    /modules/by-module/Class/Class-Singleton-&lt;version&gt;.tar.gz     /authors/id/ABW/Class-Singleton-&lt;version&gt;.tar.gz</p><p>\*(C`Class::Singleton\*(C' is distributed as a single gzipped tar archive file:</p><p>    Class-Singleton-&lt;version&gt;.tar.gz</p><p>Note that \*(L"&lt;version&gt;\*(R" represents the current version number, of the form "1.23".  See \s-1VERSION\s0 below to determine the current version number for \*(C`Class::Singleton\*(C'.</p><p>Unpack the archive to create an installation directory:</p><p>    gunzip Class-Singleton-&lt;version&gt;.tar.gz     tar xvf Class-Singleton-&lt;version&gt;.tar</p><p>'cd' into that directory, make, test and install the module:</p><p>    cd Class-Singleton-&lt;version&gt;     perl Makefile.PL     make     make test     make install</p><p>The '\*(C`make install\*(C'' will install the module on your system.  You may need root access to perform this task.  If you install the module in a local directory (for example, by executing "\*(C`perl Makefile.PL LIB=~/lib\*(C'" in the above - see \*(C`perldoc MakeMaker\*(C' for full details), you will need to ensure that the \*(C`PERL5LIB\*(C' environment variable is set to include the location, or add a line to your scripts explicitly naming the library location:</p><p>    use lib &apos;/local/path/to/lib&apos;;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USING THE CLASS::SINGLETON MODULE</h2>
        <div class="sectioncontent">
<p>To import and use the \*(C`Class::Singleton\*(C' module the following line should appear in your Perl program:</p><p>    use Class::Singleton;</p><p>The <em>instance()</em> method is used to create a new \*(C`Class::Singleton\*(C' instance, or return a reference to an existing instance. Using this method, it is only possible to have a single instance of the class in any system.</p><p>    my $highlander = Class::Singleton-&gt;instance();</p><p>Assuming that no \*(C`Class::Singleton\*(C' object currently exists, this first call to <em>instance()</em> will create a new \*(C`Class::Singleton\*(C' and return a reference to it. Future invocations of <em>instance()</em> will return the same reference.</p><p>    my $macleod    = Class::Singleton-&gt;instance();</p><p>In the above example, both $highlander and $macleod contain the same reference to a \*(C`Class::Singleton\*(C' instance.  There can be only one.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DERIVING SINGLETON CLASSES</h2>
        <div class="sectioncontent">
<p>A module class may be derived from \*(C`Class::Singleton\*(C' and will inherit the <em>instance()</em> method that correctly instantiates only one object.</p><p>    package PrintSpooler;     use base &apos;Class::Singleton&apos;;</p><p>    # derived class specific code     sub submit_job {         ...     }</p><p>    sub cancel_job {         ...     }</p><p>The \*(C`PrintSpooler\*(C' class defined above could be used as follows:</p><p>    use PrintSpooler;</p><p>    my $spooler = PrintSpooler-&gt;instance();</p><p>    $spooler-&gt;submit_job(...);</p><p>The <em>instance()</em> method calls the <em>_new_instance()</em> constructor method the first and only time a new instance is created. All parameters passed to the <em>instance()</em> method are forwarded to <em>_new_instance()</em>. In the base class the <em>_new_instance()</em> method returns a blessed reference to a hash array containing any arguments passed as either a hash reference or list of named parameters.</p><p>    package MyConfig;     use base &apos;Class::Singleton&apos;;</p><p>    sub foo {         shift-&gt;{ foo };     }</p><p>    sub bar {         shift-&gt;{ bar };     }</p><p>    package main;</p><p>    # either: hash reference of named parameters     my $config = MyConfig-&gt;instance({ foo =&gt; 10, bar =&gt; 20 });</p><p>    # or: list of named parameters     my $config = MyConfig-&gt;instance( foo =&gt; 10, bar =&gt; 20 );</p><p>    print $config-&gt;foo();   # 10     print $config-&gt;bar();   # 20</p><p>Derived classes may redefine the <em>_new_instance()</em> method to provide more specific object initialisation or change the underlying object type (to a list reference, for example).</p><p>    package MyApp::Database;     use base &apos;Class::Singleton&apos;;     use DBI;</p><p>    # this only gets called the first time instance() is called     sub _new_instance {         my $class = shift;         my $self  = bless { }, $class;         my $db    = shift || "myappdb";         my $host  = shift || "localhost";</p><p>        $self-&gt;{ DB } = DBI-&gt;connect("DBI:mSQL:$db:$host")             || die "Cannot connect to database: $DBI::errstr";</p><p>        # any other initialisation...</p><p>        return $self;     }</p><p>The above example might be used as follows:</p><p>    use MyApp::Database;</p><p>    # first use - database gets initialised     my $database = MyApp::Database-&gt;instance();</p><p>Some time later on in a module far, far away...</p><p>    package MyApp::FooBar     use MyApp::Database;</p><p>    # this FooBar object needs access to the database; the Singleton     # approach gives a nice wrapper around global variables.</p><p>    sub new {         my $class = shift;         bless {             database =&gt; MyApp::Database-&gt;instance(),         }, $class;     }</p><p>The \*(C`Class::Singleton\*(C' <em>instance()</em> method uses a package variable to store a reference to any existing instance of the object. This variable, "\*(C`_instance\*(C'", is coerced into the derived class package rather than the base class package.</p><p>Thus, in the \*(C`MyApp::Database\*(C' example above, the instance variable would be:</p><p>    $MyApp::Database::_instance;</p><p>This allows different classes to be derived from \*(C`Class::Singleton\*(C' that can co-exist in the same system, while still allowing only one instance of any one class to exists. For example, it would be possible to derive both '\*(C`PrintSpooler\*(C'' and '\*(C`MyApp::Database\*(C'' from \*(C`Class::Singleton\*(C' and have a single instance of <em>each</em> in a system, rather than a single instance of <em>either</em>.</p><p>You can use the <em>has_instance()</em> method to find out if a particular class already has an instance defined.  A reference to the instance is returned or \*(C`undef\*(C' if none is currently defined.</p><p>    my $instance = MyApp::Database-&gt;has_instance()         || warn "No instance is defined yet";</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<h3>\fIinstance()\fP</h3>
<p>This method is called to return a current object instance or create a new one by calling <em>_new_instance()</em>.</p>
<h3>\fIhas_instance()\fP</h3>
<p>This method returns a reference to any existing instance or \*(C`undef\*(C' if none is defined.</p><p>    my $testing = MySingleton1-&gt;has_instance()         || warn "No instance defined for MySingleton1";</p>
<h3>\fI_new_instance()\fP</h3>
<p>This \*(L"private\*(R" method is called by <em>instance()</em> to create a new object instance if one doesn't already exist. It is not intended to be called directly (although there's nothing to stop you from calling it if you're really determined to do so).</p><p>It creates a blessed hash reference containing any arguments passed to the method as either a hash reference or list of named parameters.</p><p>    # either: hash reference of named parameters     my $example1 = MySingleton1-&gt;new({ pi =&gt; 3.14, e =&gt; 2.718 });</p><p>    # or: list of named parameters     my $example2 = MySingleton2-&gt;new( pi =&gt; 3.14, e =&gt; 2.718 );</p><p>It is important to remember that the <em>instance()</em> method will <em>only</em> call the <em></em><em>_new_instance()</em><em></em> method once, so any arguments you pass may be silently ignored if an instance already exists. You can use the <em>has_instance()</em> method to determine if an instance is already defined.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Andy Wardley &lt;abw@wardley.org&gt; &lt;http://wardley.org/&gt;</p><p>Thanks to Andreas Koenig for providing some significant speedup patches and other ideas.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>This is version 1.4, released September 2007</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright Andy Wardley 1998-2007.  All Rights Reserved.</p><p>This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Class::Pluggable.3pm.html"><span aria-hidden="true">&larr;</span> Class::Pluggable.3pm: Simple pluggable class.</a></li>
   <li class="next"><a href="Class::Spiffy.3pm.html">Class::Spiffy.3pm: Spiffy framework with no source filtering <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
