<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Authen::Passphrase::PHPass: Passphrases using the phpass algorithm</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Passphrases using the phpass algorithm">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Authen::Passphrase::PHPass (3pm) manual">
  <meta name="twitter:description" content="Passphrases using the phpass algorithm">
  <meta name="twitter:image" content="https://www.carta.tech/images/libauthen-passphrase-perl-Authen::Passphrase::PHPass-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Authen::Passphrase::PHPass.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Authen::Passphrase::PHPass (3pm) manual" />
  <meta property="og:description" content="Passphrases using the phpass algorithm" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libauthen-passphrase-perl-Authen::Passphrase::PHPass-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Authen::Passphrase::PHPass<small> (3pm)</small></h1>
        <p class="lead">Passphrases using the phpass algorithm</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Authen::Passphrase::PHPass.3pm.html">
      <span itemprop="name">Authen::Passphrase::PHPass: Passphrases using the phpass algorithm</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libauthen-passphrase-perl/">
      <span itemprop="name">libauthen-passphrase-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Authen::Passphrase::PHPass.3pm.html">
      <span itemprop="name">Authen::Passphrase::PHPass: Passphrases using the phpass algorithm</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
        use Authen::Passphrase::PHPass;

        $ppr = Authen::Passphrase::PHPass-&gt;new(
                cost =&gt; 10, salt =&gt; "NaClNaCl",
                hash_base64 =&gt; "ObRxTm/.EiiYN02xUeAQs/");

        $ppr = Authen::Passphrase::PHPass-&gt;new(
                cost =&gt; 10, salt_random =&gt; 1,
                passphrase =&gt; "passphrase");

        $ppr = Authen::Passphrase::PHPass-&gt;from_crypt(
                &apos;$P$8NaClNaClObRxTm/.EiiYN02xUeAQs/&apos;);

        $ppr = Authen::Passphrase::PHPass-&gt;from_rfc2307(
                &apos;{CRYPT}$P$8NaClNaClObRxTm/.EiiYN02xUeAQs/&apos;);

        $cost = $ppr-&gt;cost;
        $cost_base64 = $ppr-&gt;cost_base64;
        $cost = $ppr-&gt;nrounds_log2;
        $cost_base64 = $ppr-&gt;nrounds_log2_base64;
        $salt = $ppr-&gt;salt;
        $hash = $ppr-&gt;hash;
        $hash_base64 = $ppr-&gt;hash_base64;

        if($ppr-&gt;match($passphrase)) { ...

        $passwd = $ppr-&gt;as_crypt;
        $userPassword = $ppr-&gt;as_rfc2307;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>An object of this class encapsulates a passphrase hashed using the phpass algorithm invented by Solar Designer and described at &lt;http://www.openwall.com/phpass/&gt;.  This is a subclass of Authen::Passphrase, and this document assumes that the reader is familiar with the documentation for that class.</p><p>The phpass algorithm is based on the \s-1MD5\s0 message digest algorithm. There is an eight-byte salt, which is conventionally restricted to consist of base 64 digits.  There is also a cost parameter that controls the expense of hashing.  First the salt and passphrase are concatenated and hashed by \s-1MD5\s0.  Then, 2^cost times, the hash from the previous stage is concatenated with the passphrase and hashed by \s-1MD5\s0.  The passphrase hash is the output from the final iteration.</p><p>The passphrase hash is represented in \s-1ASCII\s0 using the crypt format with prefix "<strong></strong><strong>$P</strong><strong>$</strong>\*(L".  The first character after the format prefix is a base 64 digit giving the cost parameter.  The next eight characters are the salt. The salt is followed by 22 base 64 digits giving the hash.  The base 64 digits are \*(R"<strong>.</strong>\*(L", \*(R"<strong>/</strong>\*(L", \*(R"<strong>0</strong>\*(L" to \*(R"<strong>9</strong>\*(L", \*(R"<strong>A</strong>\*(L" to \*(R"<strong>Z</strong>\*(L", \*(R"<strong>a</strong>\*(L" to \*(R"<strong>z</strong>" (in \s-1ASCII\s0 order).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONSTRUCTORS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    Authen::Passphrase::PHPass-&gt;new(\s-1ATTR\s0 =&gt; \s-1VALUE\s0, ...)
  </dt>
  <dd>
    <p>Generates a new passphrase recogniser object using the phpass algorithm. The following attributes may be given:</p>
<dl class='dl-vertical'>
  <dt>
    <strong>cost</strong>
  </dt>
  <dd>
    <p>Base-two logarithm of the number of hashing rounds to perform.</p>
  </dd>
  <dt>
    <strong>cost_base64</strong>
  </dt>
  <dd>
    <p>Base-two logarithm of the number of hashing rounds to perform, expressed as a single base 64 digit.</p>
  </dd>
  <dt>
    <strong>nrounds_log2</strong>
  </dt>
  <dd>
    <p>Synonym for <strong>cost</strong>.</p>
  </dd>
  <dt>
    <strong>nrounds_log2_base64</strong>
  </dt>
  <dd>
    <p>Synonym for <strong>cost_base64</strong>.</p>
  </dd>
  <dt>
    <strong>salt</strong>
  </dt>
  <dd>
    <p>The salt, as an eight-byte string.</p>
  </dd>
  <dt>
    <strong>salt_random</strong>
  </dt>
  <dd>
    <p>Causes salt to be generated randomly.  The value given for this attribute is ignored.  The salt will be a string of eight base 64 digits. The source of randomness may be controlled by the facility described in Data::Entropy.</p>
  </dd>
  <dt>
    <strong>hash</strong>
  </dt>
  <dd>
    <p>The hash, as a 16-byte string.</p>
  </dd>
  <dt>
    <strong>hash_base64</strong>
  </dt>
  <dd>
    <p>The hash, as a string of 22 base 64 digits.</p>
  </dd>
  <dt>
    <strong>passphrase</strong>
  </dt>
  <dd>
    <p>A passphrase that will be accepted.</p>
  </dd>

</dl>
<p>The cost and salt must be given, and either the hash or the passphrase.</p>
  </dd>
  <dt>
    Authen::Passphrase::PHPass-&gt;from_crypt(\s-1PASSWD\s0)
  </dt>
  <dd>
    <p>Generates a new phpass passphrase recogniser object from a crypt string. The crypt string must consist of "<strong></strong><strong>$P</strong><strong>$</strong>", one base 64 character encoding the cost, the salt, then 22 base 64 digits giving the hash.  The salt must be exactly 8 characters long, and cannot contain any character that cannot appear in a crypt string.</p>
  </dd>
  <dt>
    Authen::Passphrase::PHPass-&gt;from_rfc2307(\s-1USERPASSWORD\s0)
  </dt>
  <dd>
    <p>Generates a new phpass passphrase recogniser object from an \s-1RFC\s0 2307 string.  The string must consist of "<strong>{\s-1CRYPT\s0}</strong>" (case insensitive) followed by an acceptable crypt string.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>Returns the base-two logarithm of the number of hashing rounds that will be performed. Returns the base-two logarithm of the number of hashing rounds that will be performed, expressed as a single base 64 digit. Synonym for \*(L"cost\*(R". Synonym for \*(L"cost_base64\*(R". Returns the salt, as a string of eight bytes. Returns the hash value, as a string of 16 bytes. Returns the hash value, as a string of 22 base 64 digits. These methods are part of the standard Authen::Passphrase interface.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Authen::Passphrase::PHPass&hellip;</h2>
        <div class="sectioncontent">
<p>Authen::Passphrase, Digest::MD5</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Andrew Main (Zefram) &lt;zefram@fysh.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (C) 2006, 2007, 2009, 2010, 2012 Andrew Main (Zefram) &lt;zefram@fysh.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE</h2>
        <div class="sectioncontent">
<p>This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Authen::Passphrase::NetscapeMail.3pm.html"><span aria-hidden="true">&larr;</span> Authen::Passphrase::NetscapeMail.3pm: Passphrases using netscape mail server's method</a></li>
   <li class="next"><a href="Authen::Passphrase::RejectAll.3pm.html">Authen::Passphrase::RejectAll.3pm: Reject all passphrases <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
