<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Wiki::Toolkit::Formatter::UseMod: Usemodwiki-style formatting for wiki::toolkit</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Usemodwiki-style formatting for wiki::toolkit">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Wiki::Toolkit::Formatter::UseMod (3pm) manual">
  <meta name="twitter:description" content="Usemodwiki-style formatting for wiki::toolkit">
  <meta name="twitter:image" content="https://www.carta.tech/images/libwiki-toolkit-formatter-usemod-perl-Wiki::Toolkit::Formatter::UseMod-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Wiki::Toolkit::Formatter::UseMod.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Wiki::Toolkit::Formatter::UseMod (3pm) manual" />
  <meta property="og:description" content="Usemodwiki-style formatting for wiki::toolkit" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libwiki-toolkit-formatter-usemod-perl-Wiki::Toolkit::Formatter::UseMod-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Wiki::Toolkit::Formatter::UseMod<small> (3pm)</small></h1>
        <p class="lead">Usemodwiki-style formatting for wiki::toolkit</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Wiki::Toolkit::Formatter::UseMod.3pm.html">
      <span itemprop="name">Wiki::Toolkit::Formatter::UseMod: Usemodwiki-style formatting for wiki::toolkit</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libwiki-toolkit-formatter-usemod-perl/">
      <span itemprop="name">libwiki-toolkit-formatter-usemod-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Wiki::Toolkit::Formatter::UseMod.3pm.html">
      <span itemprop="name">Wiki::Toolkit::Formatter::UseMod: Usemodwiki-style formatting for wiki::toolkit</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>A formatter backend for Wiki::Toolkit that supports UseMod-style formatting.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use Wiki::Toolkit::Formatter::UseMod;

  # Instantiate - see below for parameter details.
  my $formatter = Wiki::Toolkit::Formatter::UseMod-&gt;new( %config );

  # Format some text.
  my $cooked = $formatter-&gt;format($raw);

  # Find out which other nodes that text would link to.
  my @links_to = $formatter-&gt;find_internal_links($raw);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <strong>new</strong>
  </dt>
  <dd>
    <p>  my $formatter = Wiki::Toolkit::Formatter::UseMod-&gt;new(                  extended_links      =&gt; 0, # $FreeLinks                  implicit_links      =&gt; 1, # $WikiLinks                  force_ucfirst_nodes =&gt; 1, # $FreeUpper                  use_headings        =&gt; 1, # $UseHeadings                  allowed_tags        =&gt; [qw(b i)], # defaults to none                  macros              =&gt; {},                  pass_wiki_to_macros =&gt; 0,                  node_prefix         =&gt; &apos;wiki.pl?&apos;,                  node_suffix         =&gt; &apos;&apos;,                  edit_prefix         =&gt; &apos;wiki.pl?action=edit;id=&apos;,                  edit_suffix         =&gt; &apos;&apos;,                  munge_urls          =&gt; 0,                  external_link_class =&gt; &apos;external&apos;,   ); Parameters will default to the values shown above (apart from \*(C`allowed_tags\*(C', which defaults to allowing no tags, and \*(C`external_link_class\*(C', which defaults to false).</p>
<dl class='dl-vertical'>
  <dt>
    <strong>Internal links</strong>
  </dt>
  <dd>
    <p>\*(C`node_prefix\*(C', \*(C`node_suffix\*(C', \*(C`edit_prefix\*(C' and \*(C`edit_suffix\*(C' allow you to control the URLs generated for links to other wiki pages. So for example with the defaults given above, a link to the Home node will have the \s-1URL\s0 \*(C`wiki.pl?Home\*(C' and a link to the edit form for the Home node will have the \s-1URL\s0 \*(C`wiki.pl?action=edit;id=Home\*(C' (Note that of course the URLs that you wish to have generated will depend on how your wiki application processes its \s-1CGI\s0 parameters - you can't just put random stuff in there and hope it works!)</p>
  </dd>
  <dt>
    <strong>Internal links - advanced options</strong>
  </dt>
  <dd>
    <p>If you wish to have greater control over the links, you may use the \*(C`munge_node_name\*(C' parameter.  The value of this should be a subroutine reference.  This sub will be called on each internal link after all other formatting and munging <em>except</em> \s-1URL\s0 escaping has been applied.  It will be passed the node name as its first parameter and should return a node name.  Note that this will affect the URLs of internal links, but not the link text. Example:   # The formatter munges links so node names are ucfirst.   # Ensure &apos;state51&apos; always appears in lower case in node names.   munge_node_name =&gt; sub {                          my $node_name = shift;                          $node_name =~ s/State51/state51/g;                          return $node_name;                      } <strong>Note:</strong> This is <em>advanced</em> usage and you should only do it if you <em>really</em> know what you're doing.  Consider in particular whether and how your munged nodes are going to be treated by \*(C`retrieve_node\*(C'.</p>
  </dd>
  <dt>
    <strong>External links</strong>
  </dt>
  <dd>
    <p>By default, we emulate the UseModWiki behaviour of formatting external links with hardcoded square brackets around them.  If you would instead prefer to control this with \s-1CSS\s0, supply the \*(C`external_link_class\*(C' parameter to \*(C`-&gt;new\*(C' - the value of this parameter will be used as the class applied to the link (so it should be a valid \s-1CSS\s0 class name).  Controlling the appearance with \s-1CSS\s0 is our recommended method, but the default is as described for reasons of backward compatibility.</p>
  </dd>
  <dt>
    <strong>\s-1URL\s0 munging</strong>
  </dt>
  <dd>
    <p>If you set \*(C`munge_urls\*(C' to true, then your URLs will be more user-friendly, for example   http://example.com/wiki.cgi?Mailing_List_Managers rather than   http://example.com/wiki.cgi?Mailing%20List%20Managers The former behaviour is the actual UseMod behaviour, but requires a little fiddling about in your code (see \*(C`node_name_to_node_param\*(C'), so the default is to <strong>not</strong> munge URLs.</p>
  </dd>
  <dt>
    <strong>Macros</strong>
  </dt>
  <dd>
    <p>Be aware that macros are processed <em>after</em> filtering out disallowed \s-1HTML\s0 tags and <em>before</em> transforming from wiki markup into \s-1HTML\s0.  They are also not called in any particular order. The keys of macros should be either regexes or strings. The values can be strings, or, if the corresponding key is a regex, can be coderefs. The coderef will be called with the first nine substrings captured by the regex as arguments. I would like to call it with all captured substrings but apparently this is complicated. You may wish to have access to the overall wiki object in the subs defined in your macro.  To do this:</p><ul>
<li><p>Pass the wiki object to the \*(C`-&gt;formatter\*(C' call as described below.</p></li><li><p>Pass a true value in the \*(C`pass_wiki_to_macros\*(C' parameter when calling \*(C`-&gt;new\*(C'.</p></li>
</ul><p>If you do this, then <em>all</em> coderefs will be called with the wiki object as the first parameter, followed by the first nine captured substrings as described above.  Note therefore that setting \*(C`pass_wiki_to_macros\*(C' may cause backwards compatibility issues.</p>
  </dd>

</dl>
<p>Macro examples:   # Simple example - substitute a little search box for &apos;@SEARCHBOX&apos;</p><p>  macros =&gt; {</p><p>      &apos;@SEARCHBOX&apos; =&gt;                 qq(&lt;form action="wiki.pl" method="get"&gt;                    &lt;input type="hidden" name="action" value="search"&gt;                    &lt;input type="text" size="20" name="terms"&gt;                    &lt;input type="submit"&gt;&lt;/form&gt;),   }</p><p>  # More complex example - substitute a list of all nodes in a   # category for &apos;@INDEX_LINK [[Category Foo]]&apos;</p><p>  pass_wiki_to_macros =&gt; 1,   macros              =&gt; {       qr/&#92;@INDEX_LINK&#92;s+&#92;[&#92;[Category&#92;s+([^&#92;]]+)]]/ =&gt;           sub {                 my ($wiki, $category) = @_;                 my @nodes = $wiki-&gt;list_nodes_by_metadata(                         metadata_type  =&gt; "category",                         metadata_value =&gt; $category,                         ignore_case    =&gt; 1,                 );                 my $return = "&#92;n";                 foreach my $node ( @nodes ) {                     $return .= "* "                             . $wiki-&gt;formatter-&gt;format_link(                                                        wiki =&gt; $wiki,                                                        link =&gt; $node,                                                            )                             . "&#92;n";                  }                  return $return;                },   }</p>
  </dd>
  <dt>
    <strong>format</strong>
  </dt>
  <dd>
    <p>  my $html = $formatter-&gt;format($submitted_content, $wiki); Escapes any tags which weren't specified as allowed on creation, then interpolates any macros, then translates the raw Wiki language supplied into \s-1HTML\s0. A Wiki::Toolkit object can be supplied as an optional second parameter. This object will be used to determine whether a linked-to node exists or not, and alter the presentation of the link accordingly. This is only really in here for use when this method is being called from within Wiki::Toolkit.</p>
  </dd>
  <dt>
    <strong>format_link</strong>
  </dt>
  <dd>
    <p>  my $string = $formatter-&gt;format_link(                                         link =&gt; "Home Node",                                         wiki =&gt; $wiki,                                       ); An internal method exposed to make it easy to go from eg   * Foo   * Bar to   * &lt;a href="index.cgi?Foo"&gt;Foo&lt;/a&gt;   * &lt;a href="index.cgi?Bar"&gt;Bar&lt;/a&gt; See Macro Examples above for why you might find this useful. \*(C`link\*(C' should be something that would go inside your extended link delimiters.  \*(C`wiki\*(C' is optional but should be a Wiki::Toolkit object. If you do supply \*(C`wiki\*(C' then the method will be able to check whether the node exists yet or not and so will call \*(C`-&gt;make_edit_link\*(C' instead of \*(C`-&gt;make_internal_link\*(C' where appropriate.  If you don't supply \*(C`wiki\*(C' then \*(C`-&gt;make_internal_link\*(C' will be called always. This method used to be private so may do unexpected things if you use it in a way that I haven't tested yet.</p>
  </dd>
  <dt>
    <strong>find_internal_links</strong>
  </dt>
  <dd>
    <p>  my @links_to = $formatter-&gt;find_internal_links( $content ); Returns a list of all nodes that the supplied content links to.</p>
  </dd>
  <dt>
    <strong>node_name_to_node_param</strong>
  </dt>
  <dd>
    <p>  use URI::Escape;   $param = $formatter-&gt;node_name_to_node_param( "Recent Changes" );   my $url = "wiki.pl?" . uri_escape($param); In usemod, the node name is encoded prior to being used as part of the \s-1URL\s0. This method does this encoding (essentially, whitespace is munged into underscores). In addition, if \*(C`force_ucfirst_nodes\*(C' is in action then the node names will be forced ucfirst if they weren't already. Note that unless \*(C`munge_urls\*(C' was set to true when \*(C`new\*(C' was called, this method will do nothing.</p>
  </dd>
  <dt>
    <strong>node_param_to_node_name</strong>
  </dt>
  <dd>
    <p>  my $node = $q-&gt;param(&apos;node&apos;) || "";   $node = $formatter-&gt;node_param_to_node_name( $node ); In usemod, the node name is encoded prior to being used as part of the \s-1URL\s0, so we must decode it before we can get back the original node name. Note that unless \*(C`munge_urls\*(C' was set to true when \*(C`new\*(C' was called, this method will do nothing.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SUBCLASSING</h2>
        <div class="sectioncontent">
<p>The following methods can be overridden to provide custom behaviour.</p>
<dl class='dl-vertical'>
  <dt>
    <strong>make_edit_link</strong>
  </dt>
  <dd>
    <p>    my $link = $self-&gt;make_edit_link(         title =&gt; "Home Page",         url   =&gt; "http://example.com/?id=Home",                                    ); This method will be passed a title and a url and should return an \s-1HTML\s0 snippet.  For example, you can add a \*(C`title\*(C' attribute to the link like so:   sub make_edit_link {       my ($self, %args) = @_;       my $title = $args{title};       my $url = $args{url};       return qq|[$title]&lt;a href="$url" title="create"&gt;?&lt;/a&gt;|;   }</p>
  </dd>
  <dt>
    <strong>make_internal_link</strong>
  </dt>
  <dd>
    <p>    my $link = $self-&gt;make_internal_link(         title =&gt; "Home Page",         url   =&gt; "http://example.com/?id=Home",                                         ); This method will be passed a title and a url and should return an \s-1HTML\s0 snippet.  For example, you can add a \*(C`class\*(C' attribute to the link like so:   sub make_internal_link {       my ($self, %args) = @_;       my $title = $args{title};       my $url = $args{url};       return qq|&lt;a href="$url" class="internal"&gt;$title&lt;/a&gt;|;   }</p>
  </dd>
  <dt>
    <strong>make_external_link</strong>
  </dt>
  <dd>
    <p>    my $link = $self-&gt;make_external_link(         title =&gt; "London Perlmongers",         url   =&gt; "http://london.pm.org",                                         ); This method will be passed a title and a url and should return an \s-1HTML\s0 snippet.  For example, you can add a little icon after each external link like so:   sub make_external_link {       my ($self, %args) = @_;       my $title = $args{title};       my $url = $args{url};       return qq|&lt;a href="$url"&gt;$title&lt;/a&gt; &lt;img src="external.gif"&gt;|;   }</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Kake Pugh (kake@earth.li) and the Wiki::Toolkit team.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>     Copyright (C) 2003-2004 Kake Pugh.  All Rights Reserved.      Copyright (C) 2006-2012 the Wiki::Toolkit team. All Rights Reserved.</p><p>This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CREDITS</h2>
        <div class="sectioncontent">
<p>The OpenGuides London team (&lt;http://openguides.org/london/&gt;) sent some very helpful bug reports. A lot of the work of this module is done within chromatic's module, Text::WikiFormat.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CAVEATS</h2>
        <div class="sectioncontent">
<p>This doesn't yet support all of UseMod's formatting features and options, by any means.  This really truly <em>is</em> a 0.* release. Please send bug reports, omissions, patches, and stuff, to me at \*(C`kake@earth.li\*(C'.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTE ON USEMOD COMPATIBILITY</h2>
        <div class="sectioncontent">
<p>UseModWiki \*(L"encodes\*(R" node names before making them part of a \s-1URL\s0, so for example a node about Wombat Defenestration will have a \s-1URL\s0 like</p><p>  http://example.com/wiki.cgi?Wombat_Defenestration</p><p>So if we want to emulate a UseModWiki exactly, we need to munge back and forth between node names as titles, and node names as \s-1CGI\s0 params.</p><p>  my $formatter = Wiki::Toolkit::Formatter::UseMod-&gt;new( munge_urls =&gt; 1 );   my $node_param = $q-&gt;param(&apos;id&apos;) || $q-&gt;param(&apos;keywords&apos;) || "";   my $node_name = $formatter-&gt;node_param_to_node_name( $node_param );</p><p>  use URI::Escape;   my $url = "http://example.com/wiki.cgi?"     . uri_escape(        $formatter-&gt;node_name_to_node_param( "Wombat Defenestration" )                  );</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Wiki::Toolkit::Formatter::UseMod&hellip;</h2>
        <div class="sectioncontent">
<ul>
<li><p>Wiki::Toolkit</p></li><li><p>Text::WikiFormat</p></li><li><p>UseModWiki (http://www.usemod.com/cgi-bin/wiki.pl &lt;http://www.usemod.com/cgi-bin/wiki.pl&gt;)</p></li>
</ul>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="WebService::YouTube::Videos.3pm.html"><span aria-hidden="true">&larr;</span> WebService::YouTube::Videos.3pm: Perl interface to youtube.videos.*</a></li>
   <li class="next"><a href="Wiki::Toolkit::Plugin::Categoriser.3pm.html">Wiki::Toolkit::Plugin::Categoriser.3pm: Category management for wiki::toolkit. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
