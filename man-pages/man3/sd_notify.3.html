<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>sd_notify: Notify service manager about start-up completion and other daemon status changes</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Notify service manager about start-up completion and other daemon status changes">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="sd_notify (3) manual">
  <meta name="twitter:description" content="Notify service manager about start-up completion and other daemon status changes">
  <meta name="twitter:image" content="https://www.carta.tech/images/libsystemd-dev-sd_notify-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/sd_notify.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="sd_notify (3) manual" />
  <meta property="og:description" content="Notify service manager about start-up completion and other daemon status changes" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libsystemd-dev-sd_notify-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">sd_notify<small> (3)</small></h1>
        <p class="lead">Notify service manager about start-up completion and other daemon status changes</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/sd_notify.3.html">
      <span itemprop="name">sd_notify: Notify service manager about start-up completion and other daemon status changes</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libsystemd-dev/">
      <span itemprop="name">libsystemd-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/sd_notify.3.html">
      <span itemprop="name">sd_notify: Notify service manager about start-up completion and other daemon status changes</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
#include &lt;systemd/sd-daemon.h&gt;
</pre>
<p><strong>int sd_notify(int&nbsp;</strong><em>unset_environment</em><strong>, const&nbsp;char&nbsp;*</strong><em>state</em><strong>);</strong> <strong>int sd_notifyf(int&nbsp;</strong><em>unset_environment</em><strong>, const&nbsp;char&nbsp;*</strong><em>format</em><strong>, ...);</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>sd_notify()</strong> shall be called by a daemon to notify the init system about status changes. It can be used to send arbitrary information, encoded in an environment-block-like string. Most importantly it can be used for start-up completion notification.</p><p>If the <em>unset_environment</em> parameter is non-zero, <strong>sd_notify()</strong> will unset the <em>$NOTIFY_SOCKET</em> environment variable before returning (regardless of whether the function call itself succeeded or not). Further calls to <strong>sd_notify()</strong> will then fail, but the variable is no longer inherited by child processes.</p><p>The <em>state</em> parameter should contain a newline-separated list of variable assignments, similar in style to an environment block. A trailing newline is implied if none is specified. The string may contain any kind of variable assignments, but the following shall be considered well-known:</p><p>READY=1</p><p>Tells the init system that daemon startup is finished. This is only used by systemd if the service definition file has Type=notify set. The passed argument is a boolean "1" or "0". Since there is little value in signaling non-readiness, the only value daemons should send is "READY=1".</p><p>STATUS=...</p><p>Passes a single-line status string back to the init system that describes the daemon state. This is free-form and can be used for various purposes: general state feedback, fsck-like programs could pass completion percentages and failing programs could pass a human readable error message. Example: "STATUS=Completed 66% of file system check..."</p><p>ERRNO=...</p><p>If a daemon fails, the errno-style error code, formatted as string. Example: "ERRNO=2" for ENOENT.</p><p>BUSERROR=...</p><p>If a daemon fails, the D-Bus error-style error code. Example: "BUSERROR=org.freedesktop.DBus.Error.TimedOut"</p><p>MAINPID=...</p><p>The main pid of the daemon, in case the init system did not fork off the process itself. Example: "MAINPID=4711"</p><p>WATCHDOG=1</p><p>Tells systemd to update the watchdog timestamp. This is the keep-alive ping that services need to issue in regular intervals if <em>WatchdogSec=</em> is enabled for it. See <strong>systemd.service</strong>(5) for details. It is recommended to send this message if the <em>$WATCHDOG_PID</em> environment variable has been set to the PID of the service process, in every half the time interval that is specified in the <em>$WATCHDOG_USEC</em> environment variable. See <a href="../man3/sd_watchdog_enabled.3.html"><strong>sd_watchdog_enabled</strong>(3)</a> for details.</p><p>It is recommended to prefix variable names that are not shown in the list above with <em>X_</em> to avoid namespace clashes.</p><p>Note that systemd will accept status data sent from a daemon only if the <em>NotifyAccess=</em> option is correctly set in the service definition file. See <strong>systemd.service</strong>(5) for details.</p><p><strong>sd_notifyf()</strong> is similar to <strong>sd_notify()</strong> but takes a <strong>printf()</strong>-like format string plus arguments.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>On failure, these calls return a negative errno-style error code. If <em>$NOTIFY_SOCKET</em> was not set and hence no status data could be sent, 0 is returned. If the status was sent, these functions return with a positive return value. In order to support both, init systems that implement this scheme and those which do not, it is generally recommended to ignore the return value of this call.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>These APIs are implemented as a shared library, which can be compiled and linked to with the <strong>libsystemd</strong>&nbsp;<a href="../man1/pkg-config.1.html"><strong>pkg-config</strong>(1)</a> file.</p><p>Internally, these functions send a single datagram with the state string as payload to the <strong>AF_UNIX</strong> socket referenced in the <em>$NOTIFY_SOCKET</em> environment variable. If the first character of <em>$NOTIFY_SOCKET</em> is "@", the string is understood as Linux abstract namespace socket. The datagram is accompanied by the process credentials of the sending daemon, using SCM_CREDENTIALS.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">
<p><em>$NOTIFY_SOCKET</em></p><p>Set by the init system for supervised processes for status and start-up completion notification. This environment variable specifies the socket <strong>sd_notify()</strong> talks to. See above for details.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p><strong>Example&nbsp;1.&nbsp;Start-up Notification</strong></p><p>When a daemon finished starting up, it might issue the following call to notify the init system:</p>
<pre>
sd_notify(0, "READY=1");
</pre>
<p><strong>Example&nbsp;2.&nbsp;Extended Start-up Notification</strong></p><p>A daemon could send the following after completing initialization:</p>
<pre>
sd_notifyf(0, "READY=1&#92;n"
              "STATUS=Processing requests...&#92;n"
              "MAINPID=%lu",
              (unsigned long) getpid());
</pre>
<p><strong>Example&nbsp;3.&nbsp;Error Cause Notification</strong></p><p>A daemon could send the following shortly before exiting, on failure</p>
<pre>
sd_notifyf(0, "STATUS=Failed to start up: %s&#92;n"
              "ERRNO=%i",
              strerror(errno),
              errno);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO sd_notify&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/systemd.1.html"><strong>systemd</strong>(1)</a>, <a href="../man3/sd-daemon.3.html"><strong>sd-daemon</strong>(3)</a>, <a href="../man7/daemon.7.html"><strong>daemon</strong>(7)</a>, <strong>systemd.service</strong>(5), <a href="../man3/sd_watchdog_enabled.3.html"><strong>sd_watchdog_enabled</strong>(3)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="sd_login_monitor_unref.3.html"><span aria-hidden="true">&larr;</span> sd_login_monitor_unref.3: Monitor login sessions, seats, users and virtual machines/containers</a></li>
   <li class="next"><a href="sd_notifyf.3.html">sd_notifyf.3: Notify service manager about start-up completion and other daemon status changes <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
