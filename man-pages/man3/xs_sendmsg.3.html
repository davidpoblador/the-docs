<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>xs_sendmsg: Send a message part on a socket (zero-copy)</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Send a message part on a socket (zero-copy)">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="xs_sendmsg (3) manual">
  <meta name="twitter:description" content="Send a message part on a socket (zero-copy)">
  <meta name="twitter:image" content="https://www.carta.tech/images/libxs-dev-xs_sendmsg-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/xs_sendmsg.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="xs_sendmsg (3) manual" />
  <meta property="og:description" content="Send a message part on a socket (zero-copy)" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libxs-dev-xs_sendmsg-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">xs_sendmsg<small> (3)</small></h1>
        <p class="lead">Send a message part on a socket (zero-copy)</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/xs_sendmsg.3.html">
      <span itemprop="name">xs_sendmsg: Send a message part on a socket (zero-copy)</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libxs-dev/">
      <span itemprop="name">libxs-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/xs_sendmsg.3.html">
      <span itemprop="name">xs_sendmsg: Send a message part on a socket (zero-copy)</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>int xs_sendmsg (void </strong><strong></strong><em>*socket</em><strong>, xs_msg_t </strong><strong></strong><em>*msg</em><strong>, int </strong><strong></strong><em>flags</em><strong>);</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <em>xs_sendmsg()</em> function shall queue the message referenced by the <em>msg</em> argument to be sent to the socket referenced by the <em>socket</em> argument. The <em>flags</em> argument is a combination of the flags defined below:</p><p><strong>XS_DONTWAIT</strong></p><p>Specifies that the operation should be performed in non-blocking mode. If the message cannot be queued on the <em>socket</em>, the <em>xs_sendmsg()</em> function shall fail with <em>errno</em> set to EAGAIN.</p><p><strong>XS_SNDMORE</strong></p><p>Specifies that the message being sent is a multi-part message, and that further message parts are to follow. Refer to the section regarding multi-part messages below for a detailed description.</p><p>The <em>xs_msg_t</em> structure passed to <em>xs_sendmsg()</em> is nullified during the call. If you want to send the same message to multiple sockets you have to copy it using (e.g. using <em>xs_msg_copy()</em>).</p><p><strong>Note</strong></p><p>A successful invocation of <em>xs_sendmsg()</em> does not indicate that the message has been transmitted to the network, only that it has been queued on the <em>socket</em> and Crossroads have assumed responsibility for the message.</p><h3>Multi-part messages</h3>
<p>A Crossroads message is composed of 1 or more message parts. Each message part is an independent <em>xs_msg_t</em> in its own right. Crossroads ensure atomic delivery of messages; peers shall receive either all <em>message parts</em> of a message or none at all. The total number of message parts is unlimited except by available memory.</p><p>An application that sends multipart messages must use the <em>XS_SNDMORE</em> flag when sending each data part except the final one.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>The <em>xs_sendmsg()</em> function shall return number of bytes in the message if successful. Otherwise it shall return -1 and set <em>errno</em> to one of the values defined below.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">
<p><strong>EAGAIN</strong></p><p>Non-blocking mode was requested and the message cannot be sent at the moment.</p><p><strong>ENOTSUP</strong></p><p>The <em>xs_sendmsg()</em> operation is not supported by this socket type.</p><p><strong>EFSM</strong></p><p>The <em>xs_sendmsg()</em> operation cannot be performed on this socket at the moment due to the socket not being in the appropriate state. This error may occur with socket types that switch between several states, such as XS_REP. See the <em>messaging patterns</em> section of <a href="../man3/xs_socket.3.html"><strong>xs_socket</strong>(3)</a> for more information.</p><p><strong>ETERM</strong></p><p>The <em>context</em> associated with the specified <em>socket</em> was terminated.</p><p><strong>ENOTSOCK</strong></p><p>The provided <em>socket</em> was invalid.</p><p><strong>EINTR</strong></p><p>The operation was interrupted by delivery of a signal before the message was sent.</p><p><strong>EFAULT</strong></p><p>Invalid message.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p><strong>Filling in a message and sending it to a socket</strong>.</p>
<pre>
/* Create a new message, allocating 6 bytes for message content */
xs_msg_t msg;
int rc = xs_msg_init_size (&msg, 6);
assert (rc == 0);
/* Fill in message content with &apos;AAAAAA&apos; */
memset (xs_msg_data (&msg), &apos;A&apos;, 6);
/* Send the message to the socket */
rc = xs_sendmsg (socket, &msg, 0);
assert (rc == 6);
</pre>
<p><strong>Sending a multi-part message</strong>.</p>
<pre>
/* Send a multi-part message consisting of three parts to socket */
rc = xs_sendmsg (socket, &part1, XS_SNDMORE);
rc = xs_sendmsg (socket, &part2, XS_SNDMORE);
/* Final part; no more parts to follow */
rc = xs_sendmsg (socket, &part3, 0);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO xs_sendmsg&hellip;</h2>
        <div class="sectioncontent">
<p>Applications that do not require zero-copy messaging can use the simpler <a href="../man3/xs_send.3.html"><strong>xs_send</strong>(3)</a> instead of <em>xs_sendmsg()</em>.</p><p><a href="../man3/xs_recvmsg.3.html"><strong>xs_recvmsg</strong>(3)</a> <strong>xs_socket</strong>(7) <strong>xs</strong>(7)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>This man page was written by Martin Sustrik &lt;\m[blue]<strong>sustrik@250bpm.com</strong>\m[]\s-2\u[1]\d\s+2&gt;, Martin Lucina &lt;\m[blue]<strong>martin@lucina.net</strong>\m[]\s-2\u[2]\d\s+2&gt; and Pieter Hintjens &lt;\m[blue]<strong>ph@imatix.com</strong>\m[]\s-2\u[3]\d\s+2&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
     1.
  </dt>
  <dd>
    <p>sustrik@250bpm.com</p><p>mailto:sustrik@250bpm.com</p>
  </dd>
  <dt>
     2.
  </dt>
  <dd>
    <p>martin@lucina.net</p><p>mailto:martin@lucina.net</p>
  </dd>
  <dt>
     3.
  </dt>
  <dd>
    <p>ph@imatix.com</p><p>mailto:ph@imatix.com</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="xs_send.3.html"><span aria-hidden="true">&larr;</span> xs_send.3: Send a message part on a socket</a></li>
   <li class="next"><a href="xs_setctxopt.3.html">xs_setctxopt.3: Set crossroads context options <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
