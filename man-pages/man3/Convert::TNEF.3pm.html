<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Convert::TNEF: </title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Convert::TNEF (3pm) manual">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="https://www.carta.tech/images/libconvert-tnef-perl-Convert::TNEF-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Convert::TNEF.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Convert::TNEF (3pm) manual" />
  <meta property="og:description" content="" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libconvert-tnef-perl-Convert::TNEF-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Convert::TNEF<small> (3pm)</small></h1>
        <p class="lead"></p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Convert::TNEF.3pm.html">
      <span itemprop="name">Convert::TNEF: </span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libconvert-tnef-perl/">
      <span itemprop="name">libconvert-tnef-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Convert::TNEF.3pm.html">
      <span itemprop="name">Convert::TNEF: </span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p> use Convert::TNEF;</p><p> $tnef = Convert::TNEF-&gt;read($iohandle, &#92;%parms)   or die Convert::TNEF::errstr;</p><p> $tnef = Convert::TNEF-&gt;read_in($filename, &#92;%parms)   or die Convert::TNEF::errstr;</p><p> $tnef = Convert::TNEF-&gt;read_ent($mime_entity, &#92;%parms)   or die Convert::TNEF::errstr;</p><p> $tnef-&gt;purge;</p><p> $message = $tnef-&gt;message;</p><p> @attachments = $tnef-&gt;attachments;</p><p> $attribute_value      = $attachments[$i]-&gt;data($att_attribute_name);  $attribute_value_size = $attachments[$i]-&gt;size($att_attribute_name);  $attachment_name = $attachments[$i]-&gt;name;  $long_attachment_name = $attachments[$i]-&gt;longname;</p><p> $datahandle = $attachments[$i]-&gt;datahandle($att_attribute_name);</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p> TNEF stands for Transport Neutral Encapsulation Format, and if you&apos;ve  ever been unfortunate enough to receive one of these files as an email  attachment, you may want to use this module.</p><p> read() takes as its first argument any file handle open  for reading. The optional second argument is a hash reference  which contains one or more of the following keys:</p><h3></h3>
<p> output_dir - Path for storing TNEF attribute data kept in files  (default: current directory).</p><p> output_prefix - File prefix for TNEF attribute data kept in files  (default: &apos;tnef&apos;).</p><p> output_to_core - TNEF attribute data will be saved in core memory unless  it is greater than this many bytes (default: 4096). May also be set to  &apos;NONE&apos; to keep all data in files, or &apos;ALL&apos; to keep all data in core.</p><p> buffer_size - Buffer size for reading in the TNEF file (default: 1024).</p><p> debug - If true, outputs all sorts of info about what the read() function  is reading, including the raw ascii data along with the data converted  to hex (default: false).</p><p> display_after_err - If debug is true and an error is encountered,  reads and displays this many bytes of data following the error  (default: 32).</p><p> debug_max_display - If debug is true then read and display at most  this many bytes of data for each TNEF attribute (default: 1024).</p><p> debug_max_line_size - If debug is true then at most this many bytes of  data will be displayed on each line for each TNEF attribute  (default: 64).</p><p> ignore_checksum - If true, will ignore checksum errors while parsing  data (default: false).</p><p> read() returns an object containing the TNEF &apos;attributes&apos; read from the  file and the data for those attributes. If all you want are the  attachments, then this is mostly garbage, but if you&apos;re interested then  you can see all the garbage by turning on debugging. If the garbage  proves useful to you, then let me know how I can maybe make it more  useful.</p><p> If an error is encountered, an undefined value is returned and the  package variable $errstr is set to some helpful message.</p><p> read_in() is a convienient front end for read() which takes a filename  instead of a handle.</p><p> read_ent() is another convient front end for read() which can take a  MIME::Entity object (or any object with like methods, specifically  open("r"), read($buff,$num_bytes), and close ).</p><p> purge() deletes any on-disk data that may be in the attachments of  the TNEF object.</p><p> message() returns the message portion of the tnef object, if any.  The thing it returns is like an attachment, but its not an attachment.  For instance, it more than likely does not have a name or any  attachment data.</p><p> attachments() returns a list of the attachments that the given TNEF  object contains. Returns a list ref if not called in array context.</p><p> data() takes a TNEF attribute name, and returns a string value for that  attribute for that attachment. Its your own problem if the string is too  big for memory. If no argument is given, then the &apos;AttachData&apos; attribute  is assumed, which is probably the attachment data you&apos;re looking for.</p><p> name() is the same as data(), except the attribute &apos;AttachTitle&apos; is  the default, which returns the 8 character + 3 character extension name  of the attachment.</p><p> longname() returns the long filename and extension of an attachment. This  is embedded within a MAPI property of the &apos;Attachment&apos; attribute data, so  we attempt to extract the name out of that.</p><p> size() takes an TNEF attribute name, and returns the size in bytes for  the data for that attachment attribute.</p><p> datahandle() is a method for attachments which takes a TNEF attribute  name, and returns the data for that attribute as a handle which is  the same as a MIME::Body handle.  See MIME::Body for all the applicable  methods. If no argument is given, then &apos;AttachData&apos; is assumed.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p> # Here&apos;s a rather long example where mail is retrieved  # from a POP3 server based on header information, then  # it is MIME parsed, and then the TNEF contents  # are extracted and converted.</p><p> use strict;  use Net::POP3;  use MIME::Parser;  use Convert::TNEF;</p><p> my $mail_dir = "mailout";  my $mail_prefix = "mail";</p><p> my $pop = new Net::POP3 ( "pop3server_name" );  my $num_msgs = $pop-&gt;login("user_name","password");  die "Can&apos;t login: $!" unless defined $num_msgs;</p><p> # Get mail by sender and subject  my $mail_out_idx = 0;  MESSAGE: for ( my $i=1; $i&lt;= $num_msgs;  $i++ ) {   my $header = join "", @{$pop-&gt;top($i)};</p><p>  for ($header) {    next MESSAGE unless     /^from:.*someone&#92;@somewhere.net/im &&     /^subject:&#92;s*important stuff/im   }</p><p>  my $fname = $mail_prefix."-".$$.++$mail_out_idx.".doc";   open (MAILOUT, "&gt;$mail_dir/$fname")    or die "Can&apos;t open $mail_dir/$fname: $!";   # If the get() complains, you need the new libnet bundle   $pop-&gt;get($i, &#92;*MAILOUT) or die "Can&apos;t read mail";   close MAILOUT or die "Error closing $mail_dir/$fname";   # If you want to delete the mail on the server   # $pop-&gt;delete($i);  }</p><p> close MAILOUT;  $pop-&gt;quit();</p><p> # Parse the mail message into separate mime entities  my $parser=new MIME::Parser;  $parser-&gt;output_dir("mimemail");</p><p> opendir(DIR, $mail_dir) or die "Can&apos;t open directory $mail_dir: $!";  my @files = map { $mail_dir."/".$_ } sort   grep { -f "$mail_dir/$_" and /$mail_prefix-$$-/o } readdir DIR;  closedir DIR;</p><p> for my $file ( @files ) {   my $entity=$parser-&gt;parse_in($file) or die "Couldn&apos;t parse mail";   print_tnef_parts($entity);   # If you want to delete the working files   # $entity-&gt;purge;  }</p><p> sub print_tnef_parts {   my $ent = shift;</p><p>  if ( $ent-&gt;parts ) {    for my $sub_ent ( $ent-&gt;parts ) {     print_tnef_parts($sub_ent);    }   } elsif ( $ent-&gt;mime_type =~ /ms-tnef/i ) {</p><p>   # Create a tnef object    my $tnef = Convert::TNEF-&gt;read_ent($ent,{output_dir=&gt;"tnefmail"})     or die $Convert::TNEF::errstr;    for ($tnef-&gt;attachments) {     print "Title:",$_-&gt;name,"&#92;n";     print "Data:&#92;n",$_-&gt;data,"&#92;n";    }</p><p>   # If you want to delete the working files    # $tnef-&gt;purge;   }  }</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Convert::TNEF&hellip;</h2>
        <div class="sectioncontent">
<p><em>perl</em>\|(1), <em>IO::Wrap</em>\|(3), <em>MIME::Parser</em>\|(3), <em>MIME::Entity</em>\|(3), <em>MIME::Body</em>\|(3)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CAVEATS</h2>
        <div class="sectioncontent">
<p> The parsing may depend on the endianness (see perlport) and width of  integers on the system where the TNEF file was created. If this proves  to be the case (check the debug output), I&apos;ll see what I can do  about it.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p> Douglas Wilson, dougw@cpan.org</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Convert::PEM::CBC.3pm.html"><span aria-hidden="true">&larr;</span> Convert::PEM::CBC.3pm: Cipher block chaining mode implementation</a></li>
   <li class="next"><a href="Convert::YText.3pm.html">Convert::YText.3pm: Quotes strings suitably for rfc2822 local part <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
