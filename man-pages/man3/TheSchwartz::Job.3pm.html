<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TheSchwartz::Job: Jobs for the reliable job queue</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Jobs for the reliable job queue">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="TheSchwartz::Job (3pm) manual">
  <meta name="twitter:description" content="Jobs for the reliable job queue">
  <meta name="twitter:image" content="https://www.carta.tech/images/libtheschwartz-perl-TheSchwartz::Job-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/TheSchwartz::Job.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="TheSchwartz::Job (3pm) manual" />
  <meta property="og:description" content="Jobs for the reliable job queue" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libtheschwartz-perl-TheSchwartz::Job-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">TheSchwartz::Job<small> (3pm)</small></h1>
        <p class="lead">Jobs for the reliable job queue</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/TheSchwartz::Job.3pm.html">
      <span itemprop="name">TheSchwartz::Job: Jobs for the reliable job queue</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libtheschwartz-perl/">
      <span itemprop="name">libtheschwartz-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/TheSchwartz::Job.3pm.html">
      <span itemprop="name">TheSchwartz::Job: Jobs for the reliable job queue</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    my $client = TheSchwartz-&gt;new( databases =&gt; $DATABASE_INFO );

    my $job = TheSchwartz::Job-&gt;new_from_array(&apos;MyWorker&apos;, foo =&gt; &apos;bar&apos;);
    $client-&gt;dispatch_async($job);

    $job = TheSchwartz::Job-&gt;new(
        funcname =&gt; &apos;MyWorker&apos;,
        uniqkey  =&gt; 7,
        arg      =&gt; [ foo =&gt; &apos;bar&apos; ],
    );
    $client-&gt;dispatch_async($job);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>\*(C`TheSchwartz::Job\*(C' models the jobs that are posted to the job queue by your application, then grabbed and performed by your worker processes.</p><p>\*(C`TheSchwartz::Job\*(C' is a \*(C`Data::ObjectDriver\*(C' model class. See Data::ObjectDriver::BaseObject.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FIELDS</h2>
        <div class="sectioncontent">
<p>\*(C`TheSchwartz::Job\*(C' objects have these possible fields: The unique numeric identifier for this job. Set automatically when saved. The numeric identifier for the type of job to perform. \*(C`TheSchwartz\*(C' clients map function names (also known as abilities and worker class names) to these numbers using \*(C`TheSchwartz::FuncMap\*(C' records. Arbitrary state data to supply to the worker process for this job. If specified as a reference, the data is frozen to a blob with the \*(C`Storable\*(C' module. An arbitrary string identifier used to prevent applications from posting duplicate jobs. At most one with the same \*(C`uniqkey\*(C' value can be posted to a single \*(C`TheSchwartz\*(C' database. The \*(C`insert_time\*(C' field is not used. The \s-1UNIX\s0 system time after which the job can next be attempted by a worker process. This timestamp is set when a job is first created or is released after a failure. The \s-1UNIX\s0 system time after which the job can next be available by a worker process. This timestamp is set when a job is grabbed by a worker process, and reset to 0 when is released due to failure to complete the job. The \*(C`priority\*(C' field is not used. A string used to discover jobs that can be efficiently pipelined with a given job due to some shared resource. For example, for email delivery jobs, the domain of an email address could be used as the \*(C`coalesce\*(C' value. A worker process could then deliver all the mail queued for a given mail host after connecting to it once.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE</h2>
        <div class="sectioncontent">
<p>Returns a new job object with the given data. Members of %args can be keyed on any of the fields described above, or \*(C`funcname\*(C'. Returns a new job with the given function name (also called <em>ability</em> or <em>worker class</em>), and the scalar or reference $arg for an argument. Returns the function name for the given job, after setting it to $funcname, if specified. Returns the \*(C`TheSchwartz::JobHandle\*(C' object describing this job, after setting it to $handle, if specified. A <em>job handle</em> is a convenience class for accessing other records related to jobs; as its convenience methods are also available directly from \*(C`TheSchwartz::Job\*(C' instances, you will usually not need to work directly with job handles. Returns the \*(C`Data::ObjectDriver\*(C' object driver for accessing the database in which $job is stored. See Data::ObjectDriver. Records and returns a new \*(C`TheSchwartz::Error\*(C' object representing a failure to perform $job, for reason $msg. Returns the <em>exit status</em> specified by the worker that either completed the job or declared it failed permanently. The exit status for a job will be available for a period of time after the job has exited the queue. That time is defined in the job's worker class's \*(C`keep_exit_status_for()\*(C' method. Returns a list of the error messages specified to \*(C`add_failure()\*(C' when a worker failed to perform the given job. Returns the number of times a worker has grabbed this job, only to fail to complete it. Records the exit status of the given job as $status. Returns whether the given job has been completed or failed since it was created or loaded, setting whether it has to $value first, if specified. Sends the given message to the job's \*(C`TheSchwartz\*(C' client as debug output. Set $job as the current job being performed by its associated \*(C`TheSchwartz\*(C' client.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">WORKING</h2>
        <div class="sectioncontent">
<p>\*(C`TheSchwartz::Worker\*(C' classes should use these methods to update the status of their jobs: Records that the given job has been fully performed and removes it from the job queue. Completing a job records its exit status as 0. Records that the worker performing this job failed to complete it, for reason $msg.</p><p>If workers have not failed to complete the job more times than the maximum number of retries for that type of job, the job will be reattempted after its retry delay has elapsed. The maximum number of retries and the delay before a retry are defined in the job's worker class definition as \*(C`max_retries()\*(C' and \*(C`retry_delay()\*(C' respectively.</p><p>If workers <em>have</em> exceeded the maximum number of reattempts for this job, the job's exit status is recorded as $exit_status, and the job is removed from the queue. If $exit_status is not defined or 0, the job will be recorded with an exit status of 1, to indicate a failure. Records that the worker performing this job failed to complete it, as in \*(C`failed()\*(C', but that the job should <em>not</em> be reattempted, no matter how many times the job has been attempted before. The job's exit status is thus recorded as $exit_status (or 1), and the job is removed from the queue. Atomically replaces the single job $job with the given set of jobs.</p><p>This can be used to decompose one \*(L"metajob\*(R" posted by your application into a set of jobs workers can perform, or to post a job or jobs required to complete the process already partly performed.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO TheSchwartz::Job&hellip;</h2>
        <div class="sectioncontent">
<p>Data::ObjectDriver, Data::ObjectDriver::BaseObject, Storable</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="TheSchwartz.3pm.html"><span aria-hidden="true">&larr;</span> TheSchwartz.3pm: Reliable job queue</a></li>
   <li class="next"><a href="TheSchwartz::Worker.3pm.html">TheSchwartz::Worker.3pm: Superclass for defining task behavior <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
