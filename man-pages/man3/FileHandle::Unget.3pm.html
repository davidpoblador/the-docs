<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FileHandle::Unget: Filehandle which supports multi-byte unget</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Filehandle which supports multi-byte unget">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="FileHandle::Unget (3pm) manual">
  <meta name="twitter:description" content="Filehandle which supports multi-byte unget">
  <meta name="twitter:image" content="https://www.carta.tech/images/libfilehandle-unget-perl-FileHandle::Unget-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/FileHandle::Unget.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="FileHandle::Unget (3pm) manual" />
  <meta property="og:description" content="Filehandle which supports multi-byte unget" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libfilehandle-unget-perl-FileHandle::Unget-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">FileHandle::Unget<small> (3pm)</small></h1>
        <p class="lead">Filehandle which supports multi-byte unget</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/FileHandle::Unget.3pm.html">
      <span itemprop="name">FileHandle::Unget: Filehandle which supports multi-byte unget</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libfilehandle-unget-perl/">
      <span itemprop="name">libfilehandle-unget-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/FileHandle::Unget.3pm.html">
      <span itemprop="name">FileHandle::Unget: Filehandle which supports multi-byte unget</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use FileHandle::Unget;

  # open file handle
  my $fh = FileHandle::Unget-&gt;new("file")
    or die "cannot open filehandle: $!";

  my $buffer;
  read($fh,$buffer,100);
  print $buffer;

  print &lt;$fh&gt;;

  $fh-&gt;close;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>FileHandle::Unget operates exactly the same as FileHandle, except that it provides a version of ungetc that allows you to unget more than one character. It also provides ungets to unget a string.</p><p>This module is useful if the filehandle refers to a stream for which you can't just \*(C`seek()\*(C' backwards. Some operating systems support multi-byte \*(C`ungetc()\*(C', but this is not guaranteed. Use this module if you want a portable solution. In addition, on some operating systems, <em>eof()</em> will not be reset if you ungetc after having read to the end of the file.</p><p>\s-1NOTE:\s0 Using \*(C`sysread()\*(C' with \*(C`ungetc()\*(C' and other buffering functions is still a bad idea.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>The methods for this package are the same as those of the FileHandle package, with the following exceptions.</p>
<dl class='dl-vertical'>
  <dt>
    new ( \s-1ARGS\s0 )
  </dt>
  <dd>
    <p>The constructor is exactly the same as that of FileHandle, except that you can also call it with an existing IO::Handle object to \*(L"attach\*(R" unget semantics to a pre-existing handle. Pushes a character with the given ordinal value back onto the given handle's input stream. This method can be called more than once in a row to put multiple values back on the stream. Memory usage is equal to the total number of bytes pushed back. Pushes a buffer back onto the given handle's input stream. This method can be called more than once in a row to put multiple buffers of characters back on the stream.  Memory usage is equal to the total number of bytes pushed back. The buffer is not processed in any way\*(--managing end-of-line characters and whatnot is your responsibility. Get or set the pushback buffer directly. Get or set the per-filehandle input record separator. After it is called, the input record separator for the filehandle is independent of the global $/. Until this method is called (and after clear_input_record_separator is called) the global $/ is used. Clear the per-filehandle input record separator. This removes the per-filehandle input record separator semantics, reverting the filehandle to the normal global $/ semantics. \*(C`tell\*(C' returns the actual file position minus the length of the unget buffer. If you read three bytes, then unget three bytes, \*(C`tell\*(C' will report a file position of 0. Everything works as expected if you are careful to unget the exact same bytes which you read.  However, things get tricky if you unget different bytes. First, the next bytes you read won't be the actual bytes on the filehandle at the position indicated by \*(C`tell\*(C'.  Second, \*(C`tell\*(C' will return a negative number if you unget more bytes than you read. (This can be problematic since this function returns -1 on error.) \*(C`seek\*(C' defaults to the standard seek if possible, clearing the unget buffer if it succeeds. If the standard seek fails, then \*(C`seek\*(C' will attempt to seek within the unget buffer. Note that in this case, you will not be able to seek backward\*(--FileHandle::Unget will only save a buffer for the next bytes to be read. For example, let's say you read 10 bytes from a pipe, then unget the 10 bytes. If you seek 5 bytes forward, you won't be able to read the first five bytes. (Otherwise this module would have to keep around a lot of probably useless data!)</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMPATIBILITY</h2>
        <div class="sectioncontent">
<p>To test that this module is indeed a drop-in replacement for FileHandle, the following modules were modified to use FileHandle::Unget, and tested using \*(L"make test\*(R". They have all passed.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>There is a bug in Perl on Windows that is exposed if you open a stream, then check for eof, then call binmode. For example:</p><p>  # First line   # Second line</p><p>  open FH, "$^X -e &#92;"open F, &apos;$0&apos;;binmode STDOUT;print &lt;F&gt;&#92;" |";</p><p>  eof(FH);   binmode(FH);</p><p>  print "First line:", scalar &lt;FH&gt;, "&#92;n";   print "Second line:", scalar &lt;FH&gt;, "&#92;n";</p><p>  close FH;</p><p>One solution is to make sure that you only call binmode immediately after opening the filehandle. I'm not aware of any workaround for this bug that FileHandle::Unget could implement. However, the module does detect this situation and prints a warning.</p><p>Contact david@coppit.org for bug reports and suggestions.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>David Coppit &lt;david@coppit.org&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE</h2>
        <div class="sectioncontent">
<p>This software is distributed under the terms of the \s-1GPL\s0. See the file \*(L"\s-1LICENSE\s0\*(R" for more information.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO FileHandle::Unget&hellip;</h2>
        <div class="sectioncontent">
<p>Mail::Mbox::MessageParser for an example of how to use this package.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="File::chdir.3pm.html"><span aria-hidden="true">&larr;</span> File::chdir.3pm: A more sensible way to change directories</a></li>
   <li class="next"><a href="Filesys::DiskSpace.3pm.html">Filesys::DiskSpace.3pm: Perl df <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
