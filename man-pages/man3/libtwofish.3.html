<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>libtwofish: Cryptographic library using the twofish algorithm.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Cryptographic library using the twofish algorithm.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="libtwofish (3) manual">
  <meta name="twitter:description" content="Cryptographic library using the twofish algorithm.">
  <meta name="twitter:image" content="https://www.carta.tech/images/libtwofish-dev-libtwofish-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/libtwofish.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="libtwofish (3) manual" />
  <meta property="og:description" content="Cryptographic library using the twofish algorithm." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libtwofish-dev-libtwofish-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">libtwofish<small> (3)</small></h1>
        <p class="lead">Cryptographic library using the twofish algorithm.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/libtwofish.3.html">
      <span itemprop="name">libtwofish: Cryptographic library using the twofish algorithm.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libtwofish-dev/">
      <span itemprop="name">libtwofish-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/libtwofish.3.html">
      <span itemprop="name">libtwofish: Cryptographic library using the twofish algorithm.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>libtwofish</strong> is a small library to encrypt and decrypt data using the Twofish cryptographic algorithm.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FUNCTIONS</h2>
        <div class="sectioncontent">
<p><strong>void Twofish_initialise(void);</strong></p><p>Initialise the Twofish crypto engine.</p><p>This function <em>must</em> be called before any other function in the Twofish implementation is called upon. The call needs only be made once in each application program.</p><p>Apart from initialising the engine, the call also performs a self test. <strong>void Twofish_prepare_key(Twofish_Byte&nbsp;</strong><em>key[]</em><strong>, int&nbsp;</strong><em>key_len</em><strong>, Twofish_key&nbsp;*</strong><em>xkey</em><strong>);</strong></p><p>Convert a cipher key to the internal form used for encryption and decryption.</p><p>The cipher <em>key</em> is an array of bytes. The type Twofish_Byte is internally defined to a type suitable for your platform.</p><p>Any key must be converted to the internal representation <em>xkey</em> as a Twofish_key structure before it can be used. The encryption and decryption functions only work with the internal form. The conversion to internal form need only be done once for each key value.</p><p>Be sure to wipe all key storage, including the Twofish_key structure, once you are done with the key data. A simple call</p>
<pre>
memset(xkey, 0, sizeof(Twofish_key));
</pre>
<p>will do just fine.</p><p>Unlike most implementations, the present one allows any key size from zero bytes to 32 bytes. According to the Twofish specifications, irregular key sizes are handled by padding the key with zeroes at the end until the key size is 16, 24, or 32 bytes, whichever comes first. Note that each key of irregular size is equivalent to exactly one key of 16, 24, or 32 bytes.</p><p>The key length argument <em>key_len</em> must be in the proper range. If <em>key_len</em> is not in the range 0,...,32, this routine attempts to generate a fatal error (depending on the code environment), and at best (or worst) returns without having done anything. <strong>void Twofish_encrypt(Twofish_key&nbsp;*</strong><em>xkey</em><strong>, Twofish_Byte&nbsp;</strong><em>plain[16]</em><strong>, Twofish_Byte&nbsp;</strong><em>crypto[16]</em><strong>);</strong></p><p>Encrypt a single block of data.</p><p>This function encrypts a single block of 16 bytes of data. If you want to encrypt a larger or variable-length message, you will have to use a cipher mode, such as CBC or CTR. These are outside the scope of this implementation.</p><p>The xkey structure is not modified by this routine, and can be used for further encryption and decryption operations. <strong>void Twofish_decrypt(Twofish_key&nbsp;*</strong><em>xkey</em><strong>, Twofish_Byte&nbsp;</strong><em>crypto[16]</em><strong>, Twofish_Byte&nbsp;</strong><em>plain[16]</em><strong>);</strong></p><p>Decrypt a single block of data.</p><p>This function decrypts a single block of 16 bytes of data. If you want to decrypt a larger or variable-length message, you will have to use a cipher mode, such as CBC or CTR. These are outside the scope of this implementation.</p><p>The xkey structure is not modified by this routine, and can be used for further encryption and decryption operations.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<pre>
/*
* catwo.c
*
* A simple-minded encryptor and decryptor application.
*
* Usage:  catwo {[-e] | -d} key-string  &lt; infile  &gt; outfile
*
* The switch "-d" calls for decryption, whereas the optional
* switch "-e" entails encryption.
*
* The argument "key-string" is required to contain at least
* two characters, and will be truncated at 32 characters.
* The program reads from STDIN and writes to STDOUT.
*
* Of technical reasons, the encrypted output will be increased
* to a size of the nearest multiple of 16. Likewise, any decrypted
* output will be padded with NUL until the same size condition holds.
*/

#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;

#include &lt;twofish.h&gt;

#define MIN_KEYLEN 2

int main(int argc, char * argv[]) {
	size_t keylen;
	int shift = 1, encrypt = 1;
	Twofish_Byte key[32];
	Twofish_key xkey;
	Twofish_Byte inblock[16], outblock[16];

	memset(key, 0, sizeof(key));

	if (argc &lt; 2)
		return 1; /* No key is possible.  */

	if (strcmp(argv[1], "-d") == 0)
		encrypt = 0;
	else if (strcmp(argv[1], "-e") != 0)
		shift = 0;

	if (argc - shift &lt; 2)
		return 1; /* No key is possible.  */

	keylen = strlen(argv[1 + shift]);

	if (keylen &lt; MIN_KEYLEN) {
		fprintf(stderr, "Key material too short.&#92;n");
		return 1;
	}

	if (keylen &gt; sizeof(key))
		keylen = sizeof(key);

	Twofish_initialise();

	strncpy((char *) key, argv[1 + shift], sizeof(key));

	memset(inblock, 0, sizeof(inblock));

	Twofish_prepare_key(key, keylen, &xkey);

	while (read(STDIN_FILENO, inblock, sizeof(inblock)) &gt; 0) {
		if (encrypt)
			Twofish_encrypt(&xkey, inblock, outblock);
		else
			Twofish_decrypt(&xkey, inblock, outblock);

		write(STDOUT_FILENO, outblock, sizeof(outblock));

		memset(inblock, 0, sizeof(inblock));
	}

	return 0;
}

</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>This text was written by Mats Erik Andersson for the Debian GNU/Linux system, but may be used by others. It is mainly collected from the source header file twofish.h. Permission is granted to copy, distribute and/or modify this document under the same terms as libtwofish itself.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2010 Mats Erik Andersson</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="libtomcrypt.3.html"><span aria-hidden="true">&larr;</span> libtomcrypt.3: Public domain open source crypthographic toolkit</a></li>
   <li class="next"><a href="libunbound.3.html">libunbound.3: Unbound dns validating resolver 1.4.22 functions. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
