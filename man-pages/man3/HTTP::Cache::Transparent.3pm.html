<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>HTTP::Cache::Transparent: Cache the result of http get-requests persistently.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Cache the result of http get-requests persistently.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="HTTP::Cache::Transparent (3pm) manual">
  <meta name="twitter:description" content="Cache the result of http get-requests persistently.">
  <meta name="twitter:image" content="https://www.carta.tech/images/libhttp-cache-transparent-perl-HTTP::Cache::Transparent-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/HTTP::Cache::Transparent.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="HTTP::Cache::Transparent (3pm) manual" />
  <meta property="og:description" content="Cache the result of http get-requests persistently." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libhttp-cache-transparent-perl-HTTP::Cache::Transparent-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">HTTP::Cache::Transparent<small> (3pm)</small></h1>
        <p class="lead">Cache the result of http get-requests persistently.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/HTTP::Cache::Transparent.3pm.html">
      <span itemprop="name">HTTP::Cache::Transparent: Cache the result of http get-requests persistently.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libhttp-cache-transparent-perl/">
      <span itemprop="name">libhttp-cache-transparent-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/HTTP::Cache::Transparent.3pm.html">
      <span itemprop="name">HTTP::Cache::Transparent: Cache the result of http get-requests persistently.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use LWP::Simple;
  use HTTP::Cache::Transparent;

  HTTP::Cache::Transparent::init( {
    BasePath =&gt; &apos;/tmp/cache&apos;,
  } );

  my $data = get( &apos;http://www.sn.no&apos; );
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>An implementation of http get that keeps a local cache of fetched pages to avoid fetching the same data from the server if it hasn't been updated. The cache is stored on disk and is thus persistent between invocations.</p><p>Uses the http-headers If-Modified-Since and ETag to let the server decide if the version in the cache is up-to-date or not.</p><p>The cache is implemented by modifying the LWP::UserAgent class to seamlessly cache the result of all requests that can be cached.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INITIALIZING THE CACHE</h2>
        <div class="sectioncontent">
<p>HTTP::Cache::Transparent provides an init-method that sets the parameters for the cache and overloads a method in LWP::UserAgent to activate the cache.After init has been called, the normal LWP-methods (LWP::Simple as well as the more full-fledged LWP::Request methods) should be used as usual.</p>
<dl class='dl-vertical'>
  <dt>
    init
  </dt>
  <dd>
    <p>Initialize the \s-1HTTP\s0 cache. Takes a single parameter which is a hashref containing named arguments to the object.   HTTP::Cache::Transparent::init( {</p><p>    # Directory to store the cache in.     BasePath  =&gt; "/tmp/cache",</p><p>    # How many hours should items be kept in the cache     # after they were last requested?     # Default is 8*24.     MaxAge    =&gt; 8*24,</p><p>    # Print progress-messages to STDERR.     # Default is 0.     Verbose   =&gt; 1,</p><p>    # If a request is made for a url that has been requested     # from the server less than NoUpdate seconds ago, the     # response will be generated from the cache without     # contacting the server.     # Default is 0.     NoUpdate  =&gt; 15*60,</p><p>    # When a url has been downloaded and the response indicates that     # has been modified compared to the content in the cache,     # the ApproveContent callback is called with the HTTP::Response.     # The callback shall return true if the response shall be used and     # stored in the cache or false if the response shall be discarded     # and the response in the cache used instead.     # This mechanism can be used to work around servers that return errors     # intermittently. The default is to accept all responses.     ApproveContent =&gt; sub { return $_[0]-&gt;is_success },  } ); The directory where the cache is stored must be writable. It must also only contain files created by HTTP::Cache::Transparent.</p>
  </dd>
  <dt>
    Initializing from use-line
  </dt>
  <dd>
    <p>An alternative way of initializing HTTP::Cache::Transparent is to supply parameters in the use-line. This allows you to write   use HTTP::Cache::Transparent ( BasePath =&gt; &apos;/tmp/cache&apos; ); which is exactly equivalent to   use HTTP::Cache::Transparent;   HTTP::Cache::Transparent::init( BasePath =&gt; &apos;/tmp/cache&apos; ); The advantage to using this method is that you can do   perl -MHTTP::Cache::Transparent=BasePath,/tmp/cache myscript.pl or even set the environment variable \s-1PERL5OPT\s0   PERL5OPT=-MHTTP::Cache::Transparent=BasePath,/tmp/cache   myscript.pl and have all the http-requests performed by myscript.pl go through the cache without changing myscript.pl</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INSPECTING CACHE BEHAVIOR</h2>
        <div class="sectioncontent">
<p>The HTTP::Cache::Transparent inserts two special headers in the HTTP::Response object. These can be accessed via the <em>HTTP::Response::header()</em>-method.</p>
<dl class='dl-vertical'>
  <dt>
    X-Cached
  </dt>
  <dd>
    <p>This header is inserted and set to 1 if the response is delivered from the cache instead of from the server.</p>
  </dd>
  <dt>
    X-Content-Unchanged
  </dt>
  <dd>
    <p>This header is inserted and set to 1 if the content returned is the same as the content returned the last time this url was fetched. This header is always inserted and set to 1 when the response is delivered from the cache.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LIMITATIONS</h2>
        <div class="sectioncontent">
<p>This module has a number of limitations that you should be aware of before using it.</p><ul>
<li><p>There is no upper limit to how much diskspace the cache requires. The only limiting mechanism is that data for urls that haven't been requested in the last MaxAge hours will be removed from the cache the next time the program exits.</p></li><li><p>Currently, only get-requests that store the result in memory (i.e. do not use the option to have the result stored directly in a file or delivered via a callback) is cached. I intend to remove this limitation in a future version.</p></li><li><p>The support for Ranges is a bit primitive. It creates a new object in the cache for each unique combination of url and range. This will work ok as long as you always request the same range(s) for a url.</p></li><li><p>The cache doesn't properly check and store all headers in the \s-1HTTP\s0 request and response. Therefore, if you request the same url repeatedly with different sets of headers (cookies, accept-encoding etc), and these headers affect the response from the server, the cache may return the wrong response.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CACHE FORMAT</h2>
        <div class="sectioncontent">
<p>The cache is stored on disk as one file per cached object. The filename is equal to the md5sum of the url and the Range-header if it exists. The file contains a set of key/value-pairs with metadata (one entry per line) followed by a blank line and then the actual data returned by the server.</p><p>The last modified date of the cache file is set to the time when the cache object was last requested by a user.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Mattias Holmlund, &lt;$firstname -at- $lastname -dot- se&gt; &lt;http://www.holmlund.se/mattias/&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">GIT REPOSITORY</h2>
        <div class="sectioncontent">
<p>A git repository containing the source for this module can be found via http://git.holmlund.se/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT AND LICENSE</h2>
        <div class="sectioncontent">
<p>Copyright (C) 2004-2007 by Mattias Holmlund</p><p>This library is free software; you can redistribute it and/or modify it under the same terms as Perl itself, either Perl version 5.8.4 or, at your option, any later version of Perl 5 you may have available.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="HTML::WikiConverter::WikkaWiki.3pm.html"><span aria-hidden="true">&larr;</span> HTML::WikiConverter::WikkaWiki.3pm: Convert html to wikkawiki markup</a></li>
   <li class="next"><a href="HTTP::Config.3pm.html">HTTP::Config.3pm: Configuration for request and response objects <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
