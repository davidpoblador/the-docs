<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AtomBus: An atompub server for messaging.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="An atompub server for messaging.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="AtomBus (3pm) manual">
  <meta name="twitter:description" content="An atompub server for messaging.">
  <meta name="twitter:image" content="https://www.carta.tech/images/libatombus-perl-AtomBus-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/AtomBus.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="AtomBus (3pm) manual" />
  <meta property="og:description" content="An atompub server for messaging." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libatombus-perl-AtomBus-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">AtomBus<small> (3pm)</small></h1>
        <p class="lead">An atompub server for messaging.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/AtomBus.3pm.html">
      <span itemprop="name">AtomBus: An atompub server for messaging.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libatombus-perl/">
      <span itemprop="name">libatombus-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/AtomBus.3pm.html">
      <span itemprop="name">AtomBus: An atompub server for messaging.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>version 1.0405</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    use Dancer;
    use AtomBus;
    dance;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>AtomBus is an AtomPub server that can be used for messaging. The idea is that atom feeds can correspond to conceptual queues or buses. AtomBus is built on top of the Dancer framework. It is also pubsubhubbub friendly.</p><p>These examples assume that you have configured your web server to point \s-1HTTP\s0 requests starting with /atombus to your AtomBus server (see \*(L"\s-1DEPLOYMENT\s0\*(R"). To publish an entry, make a \s-1HTTP\s0 \s-1POST\s0 request:</p><p>    $ curl -d &apos;&lt;entry&gt; &lt;title&gt;allo&lt;/title&gt; &lt;content type="xhtml"&gt;       &lt;div xmlns="http://www.w3.org/1999/xhtml" &gt;an important message&lt;/div&gt;       &lt;/content&gt; &lt;/entry&gt;&apos; http://localhost/atombus/feeds/widgets</p><p>That adds a new entry to a feed titled widgets. If that feed didn't exist before, it will be created for you. To retrieve the widgets feed, make a \s-1HTTP\s0 \s-1GET\s0 request:</p><p>    $ curl http://localhost/atombus/feeds/widgets</p><p>Clients can request only entries that came after the last entry they processed. They can do this by providing the id of the last message as the start_after parameter:</p><p>    $ curl http://localhost/atombus/feeds/widgets?start_after=42</p><p>Alternatively, you can provide a start_at param.  This will retrieve entries starting with the given id:</p><p>    $ curl http://localhost/atombus/feeds/widgets?start_at=42</p><p>\s-1HTTP\s0 ETags are also supported. The server responds with an ETag header for each request. The client can provide that ETag as the If-None-Match header. The following example will work the same as if the client provided a start_after parameter. Except that it will return an empty body and a 304 status if there are no new entries. This is the behavior that pubsubhubbub recommends &lt;http://code.google.com/p/pubsubhubbub/wiki/PublisherEfficiency&gt;.</p><p>    $ curl -H &apos;If-None-Match: "42"&apos; http://localhost/atombus/feeds/widgets</p><p>Note that the most messages you will get per request is determined by the page_size setting.  If you do not specify a page_size setting, it defaults to 1000.  This default may change in the future, so don't count on it.</p><p>AtomBus is mostly a proper implementation of the AtomPub protocol and will validate 100% against &lt;http://validator.w3.org/feed&gt;. One point where it diverges from the AtomPub spec is that feed entries are returned in fifo order. This is because a message consumer will most likely want to consume messages in the order that they were published. In the future, a config setting may be available to reverse the order.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION</h2>
        <div class="sectioncontent">
<p>Configuration can be achieved via a config.yml file or via the set keyword. To use the config.yml approach, you will need to install \s-1YAML\s0. See the Dancer documentation for more information. The only required config setting is the dsn.</p><p>Example config.yml:</p><p>    # Dancer specific config settings     logger: file     log: errors</p><p>    atombus:         page_size: 100         db:             dsn:  dbi:mysql:database=atombus             user: joe             pass: momma</p><p>You can alternatively configure the server via the 'set' keyword in the source code. This approach does not require a config file.</p><p>    use Dancer;     use AtomBus;</p><p>    # Dancer specific config settings     set logger      =&gt; &apos;file&apos;;     set log         =&gt; &apos;debug&apos;;     set show_errors =&gt; 1;</p><p>    set atombus =&gt; {         page_size =&gt; 100,         db =&gt; {             dsn =&gt; &apos;dbi:SQLite:dbname=/var/local/atombus/atombus.db&apos;,         }     };</p><p>    dance;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DATABASE</h2>
        <div class="sectioncontent">
<p>AtomBus is backed by a database. The dsn in the config must point to a database which you have write privileges to. The tables will be created automagically for you if they don't already exist. Of course that requires create table privileges. All databases supported by DBIx::Class are supported, which are most major databases including postgresql, sqlite, mysql and oracle.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DEPLOYMENT</h2>
        <div class="sectioncontent">
<p>Deployment is very flexible. It can be run on a web server via \s-1CGI\s0 or FastCGI. It can also be run on any Plack web server. See Dancer::Deployment for more details.</p><h3>FastCGI</h3>
<p>AtomBus can be run via FastCGI. This requires that you have the \s-1FCGI\s0 and Plack modules installed. Here is an example FastCGI script. It assumes your AtomBus server is in the file atombus.pl.</p><p>    #!/usr/bin/env perl     use Dancer &apos;:syntax&apos;;     use Plack::Handler::FCGI;</p><p>    my $app = do "/path/to/atombus.pl";     my $server = Plack::Handler::FCGI-&gt;new(nproc =&gt; 5, detach =&gt; 1);     $server-&gt;run($app);</p><p>Here is an example lighttpd config. It assumes you named the above file atombus.fcgi.</p><p>    fastcgi.server += (         "/atombus" =&gt; ((             "socket" =&gt; "/tmp/fcgi.sock",             "check-local" =&gt; "disable",             "bin-path" =&gt; "/path/to/atombus.fcgi",         )),     )</p><p>Now AtomBus will be running via FastCGI under /atombus.</p>
<h3>Plack</h3>
<p>AtomBus can be run with any Plack web server.  Just run:</p><p>    plackup atombus.pl</p><p>You can change the Plack web server via the -s option to plackup.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MOTIVATION</h2>
        <div class="sectioncontent">
<p>I like messaging systems because they make it so easy to create scalable applications. Existing message brokers are great for creating message queues. But once a consumer reads a message off of a queue, it is not available for other consumers. I needed a system to publish events such that multiple heterogeneous services could subscribe to them. So I really needed a message bus, not a message queue. I could for example have used something called topics in ActiveMQ, but I have found ActiveMQ to be broken in general. An instance I manage has to be restarted daily. AtomBus on the other hand will be extremely stable, because it is so simple. It is in essence just a simple interface to a database. As long as your database and web server are up, AtomBus will be there for you. And there are many ways to add redundancy to databases and web heads. Another advantage of using AtomBus is that Atom is a well known standard. Everyone already has a client for it, their browser. Aren't standards great! By the way, if you just need message queues, try POE::Component::MessageQueue. It rocks. If you need a message bus, give AtomBus a shot.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Naveed Massjouni &lt;naveedm9@gmail.com&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT AND LICENSE</h2>
        <div class="sectioncontent">
<p>This software is copyright (c) 2010 by Naveed Massjouni.</p><p>This is free software; you can redistribute it and/or modify it under the same terms as the Perl 5 programming language system itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Async::MergePoint.3pm.html"><span aria-hidden="true">&larr;</span> Async::MergePoint.3pm: Resynchronise diverged control flow</a></li>
   <li class="next"><a href="AtomBus::Schema.3pm.html">AtomBus::Schema.3pm: Atombus::schema <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
