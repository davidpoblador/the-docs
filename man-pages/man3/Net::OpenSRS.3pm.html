<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Net::OpenSRS: Domain registration via the tucows opensrs https xml api</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Domain registration via the tucows opensrs https xml api">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Net::OpenSRS (3pm) manual">
  <meta name="twitter:description" content="Domain registration via the tucows opensrs https xml api">
  <meta name="twitter:image" content="https://www.carta.tech/images/libnet-opensrs-perl-Net::OpenSRS-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Net::OpenSRS.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Net::OpenSRS (3pm) manual" />
  <meta property="og:description" content="Domain registration via the tucows opensrs https xml api" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libnet-opensrs-perl-Net::OpenSRS-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Net::OpenSRS<small> (3pm)</small></h1>
        <p class="lead">Domain registration via the tucows opensrs https xml api</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Net::OpenSRS.3pm.html">
      <span itemprop="name">Net::OpenSRS: Domain registration via the tucows opensrs https xml api</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libnet-opensrs-perl/">
      <span itemprop="name">libnet-opensrs-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Net::OpenSRS.3pm.html">
      <span itemprop="name">Net::OpenSRS: Domain registration via the tucows opensrs https xml api</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">Description</h2>
        <div class="sectioncontent">
<p>This is a wrapper interface to the \s-1DNS\s0 portions of the Tucows OpenSRS \s-1HTTPS\s0 \s-1XML\s0 \s-1API\s0.</p><p>The client library distributed by OpenSRS can be difficult to integrate into a custom environment, and their web interface becomes quickly tedious with heavy usage. This is a clean and relatively quick library to perform the most common \s-1API\s0 methods described in the OpenSRS \s-1API\s0 documentation.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Examples</h2>
        <div class="sectioncontent">

<pre>
 use Net::OpenSRS;

 my $key = &apos;Your_API_Key_From_The_Reseller_Interface&apos;;
 my $srs = Net::OpenSRS-&gt;new();

 $srs-&gt;environment(&apos;live&apos;);
 $srs-&gt;set_key( $key );

 $srs-&gt;set_manage_auth( &apos;manage_username&apos;, &apos;manage_password&apos; );

 my $cookie = $srs-&gt;get_cookie( &apos;spime.net&apos; );
 if ($cookie) {
     print "Cookie:  $cookie&#92;n";
 } else {
     print $srs-&gt;last_response() . "&#92;n";
 }

 # do a batch of domain locks
 $srs-&gt;bulk_lock([ &apos;example.com&apos;, &apos;example.net&apos;, ... ]);

 # renew a domain
 my $result = $srs-&gt;renew_domain( &apos;example.com&apos; );
 ...
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Notes</h2>
        <div class="sectioncontent">
<h3>Prerequisites</h3>
<p>This module requires some setup in the OpenSRS reseller environment before it will work correctly.</p>
<dl class='dl-vertical'>
  <dt>
    Reseller account
  </dt>
  <dd>
    <p>You need to have an OpenSRS account, of course.  If you aren't an OpenSRS reseller, this module will be of limited use to you. :)</p>
  </dd>
  <dt>
    Script \s-1API\s0 network access
  </dt>
  <dd>
    <p>The machine(s) using this module need to have their public \s-1IP\s0 addresses added to your 'Script \s-1API\s0 allow' list in the OpenSRS web interface. (You'll only need to do this once, assuming your \s-1IP\s0 doesn't change.)</p>
  </dd>
  <dt>
    \s-1API\s0 key generation
  </dt>
  <dd>
    <p>You'll need to pregenerate your \s-1API\s0 keys - also in the the OpenSRS web interface.  These keys are used for all reseller \s-1API\s0 authentication.</p>
  </dd>

</dl>

<h3>Assumptions</h3>
<p>OpenSRS allows for a variety of ways to organize your domains.  Because of this, writing a 'one size fits all' module is rather difficult. Instead, we make a few assumptions regarding the way people use their OpenSRS reseller accounts.</p><p>**** These assumptions will ultimately determine if this module is right for you!  Please read them carefully! ****</p>
<dl class='dl-vertical'>
  <dt>
    Management 'master' account.
  </dt>
  <dd>
    <p>We assume that all domains are under one global management owner account.  If customers want access to the management interface, we're operating under the idea that you create subaccounts for them - retainting the master account information for your own use.  (If you aren't doing this, it really makes things easier for you in the long run.) For example, 'spime.net' is my master management account.  Before doing any <em>register_domain()</em> calls, I call master_domain('spime.net') - then any transfers or registrations from that point forward are linked to 'spime.net'.  If a customer wants access to the \s-1SRS\s0 web management interface, I can then just create a subaccount for just their domain, so I retain absolute control \*(-- in the event a customer forgets their password, I'm covered.</p>
  </dd>
  <dt>
    Usernames
  </dt>
  <dd>
    <p>We assume that your management username 'master' account is identical to your reseller username, and just the passwords differ.</p>
  </dd>
  <dt>
    Default registration info
  </dt>
  <dd>
    <p>We assume you've properly set up default technical contact information, including your default nameservers, in the OpenSRS reseller web interface.</p>
  </dd>
  <dt>
    Return codes
  </dt>
  <dd>
    <p>Unless otherwise noted, all methods return true on success, false on failure, and undefined on caller error.</p>
  </dd>

</dl>

<h3>Default environment</h3>
<p>This library defaults to the \s-1TEST\s0 environment. (horizon.)  Many \s-1API\s0 methods don't work in the test environment (\s-1SET\s0 \s-1COOKIE\s0 being the most notable example, as any \s-1API\s0 method relying on a cookie doesn't work either.)  Neither does batch processing.  Most everything else should be ok.  ( See <em>environment()</em> )</p>
<h3>The '$c' variable</h3>
<p>Many methods require customer information.  I leave the method of fetching this information entirely to you.  All examples below that show a $c variable expect a hashref (or object) that contain these keys:</p><p>    my $c = {         firstname =&gt; &apos;John&apos;,         lastname  =&gt; &apos;Doe&apos;,         city      =&gt; &apos;Portland&apos;,         state     =&gt; &apos;Oregon&apos;,         country   =&gt; &apos;US&apos;,         address   =&gt; &apos;555 Someplace Street&apos;,         email     =&gt; &apos;john@example.com&apos;,         phone     =&gt; &apos;503-555-1212&apos;,         company   =&gt; &apos;n/a&apos;     };</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Utility methods</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <em>new()</em>
  </dt>
  <dd>
    <p> my $srs = Net::OpenSRS-&gt;new(); Create a new Net::OpenSRS object.  There are no options for this method.</p>
  </dd>
  <dt>
    <em>debug_level()</em>
  </dt>
  <dd>
    <p>Setting the debug level will print various pieces of information to \s-1STDERR\s0 when connecting to OpenSRS.  Use this if something isn't working the way you think it should be.</p>
  </dd>
  <dt>
    0
  </dt>
  <dd>
    <p>Disable debugging.</p>
  </dd>
  <dt>
    1
  </dt>
  <dd>
    <p>Print current environment, host, and \s-1HTTP\s0 response.</p>
  </dd>
  <dt>
    2
  </dt>
  <dd>
    <p>Add \s-1XML\s0 request and response to output.</p>
  </dd>
  <dt>
    3
  </dt>
  <dd>
    <p>Add \s-1SSL\s0 debugging to output. Debugging is off by default.  When called without an argument, returns the current debug level.</p>
  </dd>
  <dt>
    <em>last_response()</em>
  </dt>
  <dd>
    <p>All Net::OpenSRS methods set the last OpenSRS \s-1API\s0 reply in a temporary variable.  You can view the contents of this variable using the <em>last_response()</em> method. Note that it is reset on each method call. Returns the last OpenSRS return code and result string, or if passed any true value, instead returns the full \s-1XML\s0 (parsed into a hashref) of the last OpenSRS return. (perfect for Data::Dumper) Examples:</p>
<pre>
   200: Command Successful
   400: Domain example.com does not exist with OpenSRS
</pre>

  </dd>
  <dt>
    <em>set_manage_auth()</em>
  </dt>
  <dd>
    <p> $srs-&gt;set_manage_auth( $username, $password ); Set the owner management username and password.  This is used to fetch cookies, and perform any \s-1API\s0 methods that require the management cookie. For specifics on this, see the OpenSRS \s-1API\s0 documentation.</p>
  </dd>
  <dt>
    <em>set_key()</em>
  </dt>
  <dd>
    <p>Tell the OpenSRS object what secret key to use for authentication. You can generate a new secret key by using the OpenSRS reseller web interface.  This key is required to perform any \s-1API\s0 functions. <em>set_key()</em> is affected by the current <em>environment()</em>.  Calling the <em>set_key()</em> method while in the test environment only sets the key for the test environment - likewise for the live environment.  To set a key for the live environment, you need to call environment('live') <strong>first</strong>.</p>
  </dd>
  <dt>
    <em>environment()</em>
  </dt>
  <dd>
    <p> my $env = $srs-&gt;environment;  $srs-&gt;environment(&apos;live&apos;); Without an argument, returns a string - either 'test', or 'live', depending on the environment the object is currently using. The test environment is the default. If passed an argument (either 'test' or 'live') - switches into the desired environment.  You will need to <em>set_key()</em> if you were previously using a different environment, or if you hadn't <em>set_key()</em> yet.</p>
  </dd>
  <dt>
    <em>master_domain()</em>
  </dt>
  <dd>
    <p> my $master = $srs-&gt;master_domain;  $srs-&gt;master_domain(&apos;spime.net&apos;); Without an argument, returns the currently set 'master domain' account. Otherwise, it sets the master domain. New transfers and registrations are linked under this domain, for centralized management.  See the 'Assumptions' section, above.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OpenSRS API methods</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <em>bulk_lock()</em> / <em>bulk_unlock()</em>
  </dt>
  <dd>
    <p>Locks or unlocks up to 1000 domains at a time.  my $result = $srs-&gt;bulk_lock([ &apos;example.com&apos;, &apos;example.net&apos; ]); Returns remote bulk queue id on successful batch submission.</p>
  </dd>
  <dt>
    <em>check_queued_request()</em>
  </dt>
  <dd>
    <p> my $result = $srs-&gt;check_queued_request( $queue_id ); Requires queue id - returned from batch methods such as <em>bulk_lock()</em>. Always returns hashref of queue command on success. Check $srs-&gt;<em>last_response()</em> for status progress.</p>
  </dd>
  <dt>
    <em>check_transfer()</em>
  </dt>
  <dd>
    <p> my $result = $srs-&gt;check_transfer( &apos;example.com&apos; ); Checks the status of a transfer in progress.  Returns hashref of 'contact_email', 'status', and 'last_update_time' for a given domain transfer.  The 'status' key is always one of the following:         pending_owner  (waiting on owner confirmation)         pending_admin  (waiting on opensrs staff confirmation)         pending_registry  (waiting on register to complete)         completed  (transfer done)         cancelled  (reseller cancelled transfer in progress)         undefined  (no transfer in progress) If the domain in question has no transfer in progress - instead checks to see if the domain is capable of transfer.  Returns hashref of 'transferrable' (boolean) and 'reason' (string).</p>
  </dd>
  <dt>
    <em>get_cookie()</em>
  </dt>
  <dd>
    <p>OpenSRS management APIs require a cookie to be generated, and sent along with the \s-1API\s0 request.  $cookie = $srs-&gt;get_cookie( &apos;example.com &apos;);  ($cookie, $expiration_date) = $srs-&gt;get_cookie( &apos;example.com &apos;); Make sure you've <em>set_manage_auth()</em> before attempting any cookie required APIs. Returns cookie on success, undefined on error.  (Check error with <em>last_response()</em>) In array context, returns cookie and expiration date of the domain.</p>
  </dd>
  <dt>
    <em>get_expiring_domains()</em>
  </dt>
  <dd>
    <p> my $results = $srs-&gt;get_expiring_domains( 60 );</p><p> Fetch and return OpenSRS hashref of expiring domains, within  the specified timeperiod.  (In days.)</p><p> Time period defaults to 30 days.</p>
  </dd>
  <dt>
    <em>is_available()</em>
  </dt>
  <dd>
    <p>Hey OpenSRS! Is this domain registered, or is it available?  my $result = $srs-&gt;is_available( &apos;example.com &apos;); Returns true if the domain is available, false if it is already registered.</p>
  </dd>
  <dt>
    <em>register_domain()</em>
  </dt>
  <dd>
    <p> my $result = $srs-&gt;register_domain( &apos;example.com&apos;, $c ); Register a new domain.  Default nameserver and tech info used from OpenSRS settings.</p>
  </dd>
  <dt>
    <em>renew_domain()</em>
  </dt>
  <dd>
    <p> my $result = $srs-&gt;renew_domain( &apos;example.com&apos;, 1 ); Renew a domain for a period of time in years. 1 year is the default.</p>
  </dd>
  <dt>
    <em>revoke_domain()</em>
  </dt>
  <dd>
    <p>Revoke a previously registered domain.  This only works if the domain is still within the grace period as defined by the registrar. Requires you to have called <em>set_manage_auth()</em> <strong>first</strong>.  my $result = $srs-&gt;revoke_domain( &apos;example.com&apos; ); Returns true if the revoke is successful, false otherwise. Returns undefined on error.</p>
  </dd>
  <dt>
    <em>transfer_domain()</em>
  </dt>
  <dd>
    <p> my $result = $srs-&gt;transfer_domain( &apos;example.com&apos;, $c ); Transfer a domain under your control. Returns true on success, false on failure, and undefined on caller error.</p>
  </dd>
  <dt>
    <em>make_request()</em>
  </dt>
  <dd>
    <p>This method is the real workhorse of this module.  If any OpenSRS \s-1API\s0 isn't explicity implemented in this module as a method call (such as <em>get_cookie()</em>, <em>bulk_lock()</em>, etc), you can use <em>make_request()</em> to build and send the \s-1API\s0 yourself. Examples:  my $result = $srs-&gt;make_request(      {          batch   =&gt; 1,          action  =&gt; &apos;submit&apos;,          object  =&gt; &apos;bulk_change&apos;,          attributes =&gt; {              change_type =&gt; &apos;domain_lock&apos;,              change_items =&gt; [ &apos;example.com&apos;, &apos;example.net&apos; ],              op_type =&gt; &apos;lock&apos;,          }      }  );</p><p> my $result = $srs-&gt;make_request(      {          action     =&gt; &apos;lookup&apos;,          object     =&gt; &apos;domain&apos;,          attributes =&gt; {              domain =&gt; &apos;example.com&apos;          }      }  ); Returns a hashref containing parsed \s-1XML\s0 results from OpenSRS. Example return:  {      &apos;protocol&apos; =&gt; &apos;XCP&apos;,      &apos;object&apos; =&gt; &apos;DOMAIN&apos;,      &apos;response_text&apos; =&gt; &apos;Domain taken&apos;,      &apos;action&apos; =&gt; &apos;REPLY&apos;,      &apos;response_code&apos; =&gt; &apos;211&apos;,      &apos;attributes&apos; =&gt; {          &apos;status&apos; =&gt; &apos;taken&apos;,          &apos;match&apos; =&gt; {}      },      &apos;is_success&apos; =&gt; &apos;1&apos;  }</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Author</h2>
        <div class="sectioncontent">
<p>Mahlon E. Smith <em>mahlon@martini.nu</em> for Spime Solutions Group <em>(www.spime.net)</em></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Net::OpenID::Server.3pm.html"><span aria-hidden="true">&larr;</span> Net::OpenID::Server.3pm: Library for building your own openid server/provider</a></li>
   <li class="next"><a href="Net::OpenSSH::Compat.3pm.html">Net::OpenSSH::Compat.3pm: Compatibility modules for net::openssh <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
