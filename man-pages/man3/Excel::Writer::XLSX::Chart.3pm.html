<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Excel::Writer::XLSX::Chart: A class for writing excel charts.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A class for writing excel charts.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Excel::Writer::XLSX::Chart (3pm) manual">
  <meta name="twitter:description" content="A class for writing excel charts.">
  <meta name="twitter:image" content="https://www.carta.tech/images/libexcel-writer-xlsx-perl-Excel::Writer::XLSX::Chart-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Excel::Writer::XLSX::Chart.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Excel::Writer::XLSX::Chart (3pm) manual" />
  <meta property="og:description" content="A class for writing excel charts." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libexcel-writer-xlsx-perl-Excel::Writer::XLSX::Chart-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Excel::Writer::XLSX::Chart<small> (3pm)</small></h1>
        <p class="lead">A class for writing excel charts.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Excel::Writer::XLSX::Chart.3pm.html">
      <span itemprop="name">Excel::Writer::XLSX::Chart: A class for writing excel charts.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libexcel-writer-xlsx-perl/">
      <span itemprop="name">libexcel-writer-xlsx-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Excel::Writer::XLSX::Chart.3pm.html">
      <span itemprop="name">Excel::Writer::XLSX::Chart: A class for writing excel charts.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>To create a simple Excel file with a chart using Excel::Writer::XLSX:</p>
<pre>
    #!/usr/bin/perl

    use strict;
    use warnings;
    use Excel::Writer::XLSX;

    my $workbook  = Excel::Writer::XLSX-&gt;new( &apos;chart.xlsx&apos; );
    my $worksheet = $workbook-&gt;add_worksheet();

    # Add the worksheet data the chart refers to.
    my $data = [
        [ &apos;Category&apos;, 2, 3, 4, 5, 6, 7 ],
        [ &apos;Value&apos;,    1, 4, 5, 2, 1, 5 ],

    ];

    $worksheet-&gt;write( &apos;A1&apos;, $data );

    # Add a worksheet chart.
    my $chart = $workbook-&gt;add_chart( type =&gt; &apos;column&apos; );

    # Configure the chart.
    $chart-&gt;add_series(
        categories =&gt; &apos;=Sheet1!$A$2:$A$7&apos;,
        values     =&gt; &apos;=Sheet1!$B$2:$B$7&apos;,
    );

    _\|_END_\|_
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The \*(C`Chart\*(C' module is an abstract base class for modules that implement charts in Excel::Writer::XLSX. The information below is applicable to all of the available subclasses.</p><p>The \*(C`Chart\*(C' module isn't used directly. A chart object is created via the Workbook \*(C`add_chart()\*(C' method where the chart type is specified:</p><p>    my $chart = $workbook-&gt;add_chart( type =&gt; &apos;column&apos; );</p><p>Currently the supported chart types are:</p><ul>
<li><p>\*(C`area\*(C' Creates an Area (filled line) style chart. See Excel::Writer::XLSX::Chart::Area.</p></li><li><p>\*(C`bar\*(C' Creates a Bar style (transposed histogram) chart. See Excel::Writer::XLSX::Chart::Bar.</p></li><li><p>\*(C`column\*(C' Creates a column style (histogram) chart. See Excel::Writer::XLSX::Chart::Column.</p></li><li><p>\*(C`line\*(C' Creates a Line style chart. See Excel::Writer::XLSX::Chart::Line.</p></li><li><p>\*(C`pie\*(C' Creates a Pie style chart. See Excel::Writer::XLSX::Chart::Pie.</p></li><li><p>\*(C`doughnut\*(C' Creates a Doughnut style chart. See Excel::Writer::XLSX::Chart::Doughnut.</p></li><li><p>\*(C`scatter\*(C' Creates a Scatter style chart. See Excel::Writer::XLSX::Chart::Scatter.</p></li><li><p>\*(C`stock\*(C' Creates a Stock style chart. See Excel::Writer::XLSX::Chart::Stock.</p></li><li><p>\*(C`radar\*(C' Creates a Radar style chart. See Excel::Writer::XLSX::Chart::Radar.</p></li>
</ul><p>Chart subtypes are also supported in some cases:</p><p>    $workbook-&gt;add_chart( type =&gt; &apos;bar&apos;, subtype =&gt; &apos;stacked&apos; );</p><p>The currently available subtypes are:</p><p>    area         stacked         percent_stacked</p><p>    bar         stacked         percent_stacked</p><p>    column         stacked         percent_stacked</p><p>    scatter         straight_with_markers         straight         smooth_with_markers         smooth</p><p>    radar         with_markers         filled</p><p>More charts and sub-types will be supported in time. See the \*(L"\s-1TODO\s0\*(R" section.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CHART METHODS</h2>
        <div class="sectioncontent">
<p>Methods that are common to all chart types are documented below. See the documentation for each of the above chart modules for chart specific information.</p><h3>\fIadd_series()\fP</h3>
<p>In an Excel chart a \*(L"series\*(R" is a collection of information such as values, X axis labels and the formatting that define which data is plotted.</p><p>With an Excel::Writer::XLSX chart object the \*(C`add_series()\*(C' method is used to set the properties for a series:</p><p>    $chart-&gt;add_series(         categories =&gt; &apos;=Sheet1!$A$2:$A$10&apos;, # Optional.         values     =&gt; &apos;=Sheet1!$B$2:$B$10&apos;, # Required.         line       =&gt; { color =&gt; &apos;blue&apos; },     );</p><p>The properties that can be set are:</p><ul>
<li><p>\*(C`values\*(C' This is the most important property of a series and must be set for every chart object. It links the chart with the worksheet data that it displays. A formula or array ref can be used for the data range, see below.</p></li><li><p>\*(C`categories\*(C' This sets the chart category labels. The category is more or less the same as the X axis. In most chart types the \*(C`categories\*(C' property is optional and the chart will just assume a sequential series from \*(C`1 .. n\*(C'.</p></li><li><p>\*(C`name\*(C' Set the name for the series. The name is displayed in the chart legend and in the formula bar. The name property is optional and if it isn't supplied it will default to \*(C`Series 1 .. n\*(C'.</p></li><li><p>\*(C`line\*(C' Set the properties of the series line type such as colour and width. See the \*(L"\s-1CHART\s0 \s-1FORMATTING\s0\*(R" section below.</p></li><li><p>\*(C`border\*(C' Set the border properties of the series such as colour and style. See the \*(L"\s-1CHART\s0 \s-1FORMATTING\s0\*(R" section below.</p></li><li><p>\*(C`fill\*(C' Set the fill properties of the series such as colour. See the \*(L"\s-1CHART\s0 \s-1FORMATTING\s0\*(R" section below.</p></li><li><p>\*(C`marker\*(C' Set the properties of the series marker such as style and colour. See the \*(L"\s-1SERIES\s0 \s-1OPTIONS\s0\*(R" section below.</p></li><li><p>\*(C`trendline\*(C' Set the properties of the series trendline such as linear, polynomial and moving average types. See the \*(L"\s-1SERIES\s0 \s-1OPTIONS\s0\*(R" section below.</p></li><li><p>\*(C`smooth\*(C' The \*(C`smooth\*(C' option is used to set the smooth property of a line series. See the \*(L"\s-1SERIES\s0 \s-1OPTIONS\s0\*(R" section below.</p></li><li><p>\*(C`y_error_bars\*(C' Set vertical error bounds for a chart series. See the \*(L"\s-1SERIES\s0 \s-1OPTIONS\s0\*(R" section below.</p></li><li><p>\*(C`x_error_bars\*(C' Set horizontal error bounds for a chart series. See the \*(L"\s-1SERIES\s0 \s-1OPTIONS\s0\*(R" section below.</p></li><li><p>\*(C`data_labels\*(C' Set data labels for the series. See the \*(L"\s-1SERIES\s0 \s-1OPTIONS\s0\*(R" section below.</p></li><li><p>\*(C`points\*(C' Set properties for individual points in a series. See the \*(L"\s-1SERIES\s0 \s-1OPTIONS\s0\*(R" section below.</p></li><li><p>\*(C`invert_if_negative\*(C' Invert the fill colour for negative values. Usually only applicable to column and bar charts.</p></li><li><p>\*(C`overlap\*(C' Set the overlap between series in a Bar/Column chart. The range is +/- 100. Default is 0.     overlap =&gt; 20, Note, it is only necessary to apply this property to one series of the chart.</p></li><li><p>\*(C`gap\*(C' Set the gap between series in a Bar/Column chart. The range is 0 to 500. Default is 150.     gap =&gt; 200, Note, it is only necessary to apply this property to one series of the chart.</p></li>
</ul><p>The \*(C`categories\*(C' and \*(C`values\*(C' can take either a range formula such as \*(C`=Sheet1!$A$2:$A$7\*(C' or, more usefully when generating the range programmatically, an array ref with zero indexed row/column values:</p><p>     [ $sheetname, $row_start, $row_end, $col_start, $col_end ]</p><p>The following are equivalent:</p><p>    $chart-&gt;add_series( categories =&gt; &apos;=Sheet1!$A$2:$A$7&apos;      ); # Same as ...     $chart-&gt;add_series( categories =&gt; [ &apos;Sheet1&apos;, 1, 6, 0, 0 ] ); # Zero-indexed.</p><p>You can add more than one series to a chart. In fact, some chart types such as \*(C`stock\*(C' require it. The series numbering and order in the Excel chart will be the same as the order in which they are added in Excel::Writer::XLSX.</p><p>    # Add the first series.     $chart-&gt;add_series(         categories =&gt; &apos;=Sheet1!$A$2:$A$7&apos;,         values     =&gt; &apos;=Sheet1!$B$2:$B$7&apos;,         name       =&gt; &apos;Test data series 1&apos;,     );</p><p>    # Add another series. Same categories. Different range values.     $chart-&gt;add_series(         categories =&gt; &apos;=Sheet1!$A$2:$A$7&apos;,         values     =&gt; &apos;=Sheet1!$C$2:$C$7&apos;,         name       =&gt; &apos;Test data series 2&apos;,     );</p><p>It is also possible to specify non-contiguous ranges:</p><p>    $chart-&gt;add_series(         categories      =&gt; &apos;=(Sheet1!$A$1:$A$9,Sheet1!$A$14:$A$25)&apos;,         values          =&gt; &apos;=(Sheet1!$B$1:$B$9,Sheet1!$B$14:$B$25)&apos;,     );</p>
<h3>\fIset_x_axis()\fP</h3>
<p>The \*(C`set_x_axis()\*(C' method is used to set properties of the X axis.</p><p>    $chart-&gt;set_x_axis( name =&gt; &apos;Quarterly results&apos; );</p><p>The properties that can be set are:</p><p>    name     name_font     name_layout     num_font     num_format     min     max     minor_unit     major_unit     interval_unit     crossing     reverse     position_axis     log_base     label_position     major_gridlines     minor_gridlines     visible     date_axis     minor_unit_type     major_unit_type</p><p>These are explained below. Some properties are only applicable to value or category axes, as indicated. See \*(L"Value and Category Axes\*(R" for an explanation of Excel's distinction between the axis types.</p><ul>
<li><p>\*(C`name\*(C' Set the name (title or caption) for the axis. The name is displayed below the X axis. The \*(C`name\*(C' property is optional. The default is to have no axis name. (Applicable to category and value axes).     $chart-&gt;set_x_axis( name =&gt; &apos;Quarterly results&apos; ); The name can also be a formula such as \*(C`=Sheet1!$A$1\*(C'.</p></li><li><p>\*(C`name_font\*(C' Set the font properties for the axis title. (Applicable to category and value axes).     $chart-&gt;set_x_axis( name_font =&gt; { name =&gt; &apos;Arial&apos;, size =&gt; 10 } );</p></li><li><p>\*(C`name_layout\*(C' Set the \*(C`(x, y)\*(C' position of the axis caption in chart relative units. (Applicable to category and value axes).     $chart-&gt;set_x_axis(         name        =&gt; &apos;X axis&apos;,         name_layout =&gt; {             x =&gt; 0.34,             y =&gt; 0.85,         }     ); See the \*(L"\s-1CHART\s0 \s-1LAYOUT\s0\*(R" section below.</p></li><li><p>\*(C`num_font\*(C' Set the font properties for the axis numbers. (Applicable to category and value axes).     $chart-&gt;set_x_axis( num_font =&gt; { bold =&gt; 1, italic =&gt; 1 } ); See the \*(L"\s-1CHART\s0 \s-1FONTS\s0\*(R" section below.</p></li><li><p>\*(C`num_format\*(C' Set the number format for the axis. (Applicable to category and value axes).     $chart-&gt;set_x_axis( num_format =&gt; &apos;#,##0.00&apos; );     $chart-&gt;set_y_axis( num_format =&gt; &apos;0.00%&apos;    ); The number format is similar to the Worksheet Cell Format \*(C`num_format\*(C' apart from the fact that a format index cannot be used. The explicit format string must be used as show above. See \*(L"<em>set_num_format()</em>\*(R" in Excel::Writer::XLSX for more information.</p></li><li><p>\*(C`min\*(C' Set the minimum value for the axis range. (Applicable to value axes only.)     $chart-&gt;set_x_axis( min =&gt; 20 );</p></li><li><p>\*(C`max\*(C' Set the maximum value for the axis range. (Applicable to value axes only.)     $chart-&gt;set_x_axis( max =&gt; 80 );</p></li><li><p>\*(C`minor_unit\*(C' Set the increment of the minor units in the axis range. (Applicable to value axes only.)     $chart-&gt;set_x_axis( minor_unit =&gt; 0.4 );</p></li><li><p>\*(C`major_unit\*(C' Set the increment of the major units in the axis range. (Applicable to value axes only.)     $chart-&gt;set_x_axis( major_unit =&gt; 2 );</p></li><li><p>\*(C`interval_unit\*(C' Set the interval unit for a category axis. (Applicable to category axes only.)     $chart-&gt;set_x_axis( interval_unit =&gt; 2 );</p></li><li><p>\*(C`crossing\*(C' Set the position where the y axis will cross the x axis. (Applicable to category and value axes.) The \*(C`crossing\*(C' value can either be the string &apos;max&apos; to set the crossing at the maximum axis value or a numeric value.     $chart-&gt;set_x_axis( crossing =&gt; 3 );     # or     $chart-&gt;set_x_axis( crossing =&gt; &apos;max&apos; ); <strong>For category axes the numeric value must be an integer</strong> to represent the category number that the axis crosses at. For value axes it can have any value associated with the axis. If crossing is omitted (the default) the crossing will be set automatically by Excel based on the chart data.</p></li><li><p>\*(C`position_axis\*(C' Position the axis on or between the axis tick marks. (Applicable to category axes only.) There are two allowable values \*(C`on_tick\*(C' and \*(C`between\*(C':     $chart-&gt;set_x_axis( position_axis =&gt; &apos;on_tick&apos; );     $chart-&gt;set_x_axis( position_axis =&gt; &apos;between&apos; );</p></li><li><p>\*(C`reverse\*(C' Reverse the order of the axis categories or values. (Applicable to category and value axes.)     $chart-&gt;set_x_axis( reverse =&gt; 1 );</p></li><li><p>\*(C`log_base\*(C' Set the log base of the axis range. (Applicable to value axes only.)     $chart-&gt;set_x_axis( log_base =&gt; 10 );</p></li><li><p>\*(C`label_position\*(C' Set the \*(L"Axis labels\*(R" position for the axis. The following positions are available:     next_to (the default)     high     low     none</p></li><li><p>\*(C`major_gridlines\*(C' Configure the major gridlines for the axis. The available properties are:     visible     line For example:     $chart-&gt;set_x_axis(         major_gridlines =&gt; {             visible =&gt; 1,             line    =&gt; { color =&gt; &apos;red&apos;, width =&gt; 1.25, dash_type =&gt; &apos;dash&apos; }         }     ); The \*(C`visible\*(C' property is usually on for the X-axis but it depends on the type of chart. The \*(C`line\*(C' property sets the gridline properties such as colour and width. See the \*(L"\s-1CHART\s0 \s-1FORMATTING\s0\*(R" section below.</p></li><li><p>\*(C`minor_gridlines\*(C' This takes the same options as \*(C`major_gridlines\*(C' above. The minor gridline \*(C`visible\*(C' property is off by default for all chart types.</p></li><li><p>\*(C`visible\*(C' Configure the visibility of the axis.     $chart-&gt;set_x_axis( visible =&gt; 0 );</p></li><li><p>\*(C`date_axis\*(C' This option is used to treat a category axis with date or time data as a Date Axis. (Applicable to category axes only.)     $chart-&gt;set_x_axis( date_axis =&gt; 1 ); This option also allows you to set \*(C`max\*(C' and \*(C`min\*(C' values for a category axis which isn't allowed by Excel for non-date category axes. See \*(L"Date Category Axes\*(R" for more details.</p></li><li><p>\*(C`minor_unit_type\*(C' For \*(C`date_axis\*(C' axes, see above, this option is used to set the type of the minor units. (Applicable to date category axes only.)     $chart-&gt;set_x_axis(         date_axis         =&gt; 1,         minor_unit        =&gt; 4,         minor_unit_type   =&gt; &apos;months&apos;,     ); The allowable values for this option are \*(C`days\*(C', \*(C`months\*(C' and \*(C`years\*(C'.</p></li><li><p>\*(C`major_unit_type\*(C' Same as \*(C`minor_unit_type\*(C', see above, but for major axes unit types.</p></li>
</ul><p>More than one property can be set in a call to \*(C`set_x_axis()\*(C':</p><p>    $chart-&gt;set_x_axis(         name =&gt; &apos;Quarterly results&apos;,         min  =&gt; 10,         max  =&gt; 80,     );</p>
<h3>\fIset_y_axis()\fP</h3>
<p>The \*(C`set_y_axis()\*(C' method is used to set properties of the Y axis. The properties that can be set are the same as for \*(C`set_x_axis\*(C', see above.</p>
<h3>\fIset_x2_axis()\fP</h3>
<p>The \*(C`set_x2_axis()\*(C' method is used to set properties of the secondary X axis. The properties that can be set are the same as for \*(C`set_x_axis\*(C', see above. The default properties for this axis are:</p><p>    label_position =&gt; &apos;none&apos;,     crossing       =&gt; &apos;max&apos;,     visible        =&gt; 0,</p>
<h3>\fIset_y2_axis()\fP</h3>
<p>The \*(C`set_y2_axis()\*(C' method is used to set properties of the secondary Y axis. The properties that can be set are the same as for \*(C`set_x_axis\*(C', see above. The default properties for this axis are:</p><p>    major_gridlines =&gt; { visible =&gt; 0 }</p>
<h3>\fIset_size()\fP</h3>
<p>The \*(C`set_size()\*(C' method is used to set the dimensions of the chart. The size properties that can be set are:</p><p>     width      height      x_scale      y_scale      x_offset      y_offset</p><p>The \*(C`width\*(C' and \*(C`height\*(C' are in pixels. The default chart width is 480 pixels and the default height is 288 pixels. The size of the chart can be modified by setting the \*(C`width\*(C' and \*(C`height\*(C' or by setting the \*(C`x_scale\*(C' and \*(C`y_scale\*(C':</p><p>    $chart-&gt;set_size( width =&gt; 720, height =&gt; 576 );</p><p>    # Same as:</p><p>    $chart-&gt;set_size( x_scale =&gt; 1.5, y_scale =&gt; 2 );</p><p>The \*(C`x_offset\*(C' and \*(C`y_offset\*(C' position the top left corner of the chart in the cell that it is inserted into.</p><p>Note: the \*(C`x_scale\*(C', \*(C`y_scale\*(C', \*(C`x_offset\*(C' and \*(C`y_offset\*(C' parameters can also be set via the \*(C`insert_chart()\*(C' method:</p><p>    $worksheet-&gt;insert_chart( &apos;E2&apos;, $chart, 2, 4, 1.5, 2 );</p>
<h3>\fIset_title()\fP</h3>
<p>The \*(C`set_title()\*(C' method is used to set properties of the chart title.</p><p>    $chart-&gt;set_title( name =&gt; &apos;Year End Results&apos; );</p><p>The properties that can be set are:</p><ul>
<li><p>\*(C`name\*(C' Set the name (title) for the chart. The name is displayed above the chart. The name can also be a formula such as \*(C`=Sheet1!$A$1\*(C'. The name property is optional. The default is to have no chart title.</p></li><li><p>\*(C`name_font\*(C' Set the font properties for the chart title. See the \*(L"\s-1CHART\s0 \s-1FONTS\s0\*(R" section below.</p></li><li><p>\*(C`overlay\*(C' Allow the title to be overlaid on the chart. Generally used with the layout property below.</p></li><li><p>\*(C`layout\*(C' Set the \*(C`(x, y)\*(C' position of the title in chart relative units:     $chart-&gt;set_title(         name    =&gt; &apos;Title&apos;,         overlay =&gt; 1,         layout  =&gt; {             x =&gt; 0.42,             y =&gt; 0.14,         }     ); See the \*(L"\s-1CHART\s0 \s-1LAYOUT\s0\*(R" section below.</p></li><li><p>\*(C`none\*(C' By default Excel adds an automatic chart title to charts with a single series and a user defined series name. The \*(C`none\*(C' option turns this default title off. It also turns off all other \*(C`set_title()\*(C' options.     $chart-&gt;set_title( none =&gt; 1 );</p></li>
</ul>
<h3>\fIset_legend()\fP</h3>
<p>The \*(C`set_legend()\*(C' method is used to set properties of the chart legend.</p><p>The properties that can be set are:</p><ul>
<li><p>\*(C`none\*(C' The \*(C`none\*(C' option turns off the chart legend. In Excel chart legends are on by default:     $chart-&gt;set_legend( none =&gt; 1 ); Note, for backward compatibility, it is also possible to turn off the legend via the \*(C`position\*(C' property:     $chart-&gt;set_legend( position =&gt; &apos;none&apos; );</p></li><li><p>\*(C`position\*(C' Set the position of the chart legend.     $chart-&gt;set_legend( position =&gt; &apos;bottom&apos; ); The default legend position is \*(C`right\*(C'. The available positions are:     top     bottom     left     right     overlay_left     overlay_right     none</p></li><li><p>\*(C`layout\*(C' Set the \*(C`(x, y)\*(C' position of the legend in chart relative units:     $chart-&gt;set_legend(         layout =&gt; {             x      =&gt; 0.80,             y      =&gt; 0.37,             width  =&gt; 0.12,             height =&gt; 0.25,         }     ); See the \*(L"\s-1CHART\s0 \s-1LAYOUT\s0\*(R" section below.</p></li><li><p>\*(C`delete_series\*(C' This allows you to remove 1 or more series from the legend (the series will still display on the chart). This property takes an array ref as an argument and the series are zero indexed:     # Delete/hide series index 0 and 2 from the legend.     $chart-&gt;set_legend( delete_series =&gt; [0, 2] );</p></li><li><p>\*(C`font\*(C' Set the font properties of the chart legend:     $chart-&gt;set_legend( font =&gt; { bold =&gt; 1, italic =&gt; 1 } ); See the \*(L"\s-1CHART\s0 \s-1FONTS\s0\*(R" section below.</p></li>
</ul>
<h3>\fIset_chartarea()\fP</h3>
<p>The \*(C`set_chartarea()\*(C' method is used to set the properties of the chart area.</p><p>    $chart-&gt;set_chartarea(         border =&gt; { none  =&gt; 1 },         fill   =&gt; { color =&gt; &apos;red&apos; }     );</p><p>The properties that can be set are:</p><ul>
<li><p>\*(C`border\*(C' Set the border properties of the chartarea such as colour and style. See the \*(L"\s-1CHART\s0 \s-1FORMATTING\s0\*(R" section below.</p></li><li><p>\*(C`fill\*(C' Set the fill properties of the chartarea such as colour. See the \*(L"\s-1CHART\s0 \s-1FORMATTING\s0\*(R" section below.</p></li>
</ul>
<h3>\fIset_plotarea()\fP</h3>
<p>The \*(C`set_plotarea()\*(C' method is used to set properties of the plot area of a chart.</p><p>    $chart-&gt;set_plotarea(         border =&gt; { color =&gt; &apos;yellow&apos;, width =&gt; 1, dash_type =&gt; &apos;dash&apos; },         fill   =&gt; { color =&gt; &apos;#92D050&apos; }     );</p><p>The properties that can be set are:</p><ul>
<li><p>\*(C`border\*(C' Set the border properties of the plotarea such as colour and style. See the \*(L"\s-1CHART\s0 \s-1FORMATTING\s0\*(R" section below.</p></li><li><p>\*(C`fill\*(C' Set the fill properties of the plotarea such as colour. See the \*(L"\s-1CHART\s0 \s-1FORMATTING\s0\*(R" section below.</p></li><li><p>\*(C`layout\*(C' Set the \*(C`(x, y)\*(C' position of the plotarea in chart relative units:     $chart-&gt;set_plotarea(         layout =&gt; {             x      =&gt; 0.35,             y      =&gt; 0.26,             width  =&gt; 0.62,             height =&gt; 0.50,         }     ); See the \*(L"\s-1CHART\s0 \s-1LAYOUT\s0\*(R" section below.</p></li>
</ul>
<h3>\fIset_style()\fP</h3>
<p>The \*(C`set_style()\*(C' method is used to set the style of the chart to one of the 42 built-in styles available on the 'Design' tab in Excel:</p><p>    $chart-&gt;set_style( 4 );</p><p>The default style is 2.</p>
<h3>\fIset_table()\fP</h3>
<p>The \*(C`set_table()\*(C' method adds a data table below the horizontal axis with the data used to plot the chart.</p><p>    $chart-&gt;set_table();</p><p>The available options, with default values are:</p><p>    vertical   =&gt; 1,    # Display vertical lines in the table.     horizontal =&gt; 1,    # Display horizontal lines in the table.     outline    =&gt; 1,    # Display an outline in the table.     show_keys  =&gt; 0     # Show the legend keys with the table data.</p><p>The data table can only be shown with Bar, Column, Line, Area and stock charts.</p>
<h3>set_up_down_bars</h3>
<p>The \*(C`set_up_down_bars()\*(C' method adds Up-Down bars to Line charts to indicate the difference between the first and last data series.</p><p>    $chart-&gt;set_up_down_bars();</p><p>It is possible to format the up and down bars to add \*(C`fill\*(C' and \*(C`border\*(C' properties if required. See the \*(L"\s-1CHART\s0 \s-1FORMATTING\s0\*(R" section below.</p><p>    $chart-&gt;set_up_down_bars(         up   =&gt; { fill =&gt; { color =&gt; &apos;green&apos; } },         down =&gt; { fill =&gt; { color =&gt; &apos;red&apos; } },     );</p><p>Up-down bars can only be applied to Line charts and to Stock charts (by default).</p>
<h3>set_drop_lines</h3>
<p>The \*(C`set_drop_lines()\*(C' method adds Drop Lines to charts to show the Category value of points in the data.</p><p>    $chart-&gt;set_drop_lines();</p><p>It is possible to format the Drop Line \*(C`line\*(C' properties if required. See the \*(L"\s-1CHART\s0 \s-1FORMATTING\s0\*(R" section below.</p><p>    $chart-&gt;set_drop_lines( line =&gt; { color =&gt; &apos;red&apos;, dash_type =&gt; &apos;square_dot&apos; } );</p><p>Drop Lines are only available in Line, Area and Stock charts.</p>
<h3>set_high_low_lines</h3>
<p>The \*(C`set_high_low_lines()\*(C' method adds High-Low lines to charts to show the maximum and minimum values of points in a Category.</p><p>    $chart-&gt;set_high_low_lines();</p><p>It is possible to format the High-Low Line \*(C`line\*(C' properties if required. See the \*(L"\s-1CHART\s0 \s-1FORMATTING\s0\*(R" section below.</p><p>    $chart-&gt;set_high_low_lines( line =&gt; { color =&gt; &apos;red&apos; } );</p><p>High-Low Lines are only available in Line and Stock charts.</p>
<h3>\fIshow_blanks_as()\fP</h3>
<p>The \*(C`show_blanks_as()\*(C' method controls how blank data is displayed in a chart.</p><p>    $chart-&gt;show_blanks_as( &apos;span&apos; );</p><p>The available options are:</p><p>        gap    # Blank data is shown as a gap. The default.         zero   # Blank data is displayed as zero.         span   # Blank data is connected with a line.</p>
<h3>\fIshow_hidden_data()\fP</h3>
<p>Display data in hidden rows or columns on the chart.</p><p>    $chart-&gt;show_hidden_data();</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SERIES OPTIONS</h2>
        <div class="sectioncontent">
<p>This section details the following properties of \*(C`add_series()\*(C' in more detail:</p><p>    marker     trendline     y_error_bars     x_error_bars     data_labels     points     smooth</p><h3>Marker</h3>
<p>The marker format specifies the properties of the markers used to distinguish series on a chart. In general only Line and Scatter chart types and trendlines use markers.</p><p>The following properties can be set for \*(C`marker\*(C' formats in a chart.</p><p>    type     size     border     fill</p><p>The \*(C`type\*(C' property sets the type of marker that is used with a series.</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         marker     =&gt; { type =&gt; &apos;diamond&apos; },     );</p><p>The following \*(C`type\*(C' properties can be set for \*(C`marker\*(C' formats in a chart. These are shown in the same order as in the Excel format dialog.</p><p>    automatic     none     square     diamond     triangle     x     star     short_dash     long_dash     circle     plus</p><p>The \*(C`automatic\*(C' type is a special case which turns on a marker using the default marker style for the particular series number.</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         marker     =&gt; { type =&gt; &apos;automatic&apos; },     );</p><p>If \*(C`automatic\*(C' is on then other marker properties such as size, border or fill cannot be set.</p><p>The \*(C`size\*(C' property sets the size of the marker and is generally used in conjunction with \*(C`type\*(C'.</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         marker     =&gt; { type =&gt; &apos;diamond&apos;, size =&gt; 7 },     );</p><p>Nested \*(C`border\*(C' and \*(C`fill\*(C' properties can also be set for a marker. See the \*(L"\s-1CHART\s0 \s-1FORMATTING\s0\*(R" section below.</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         marker     =&gt; {             type    =&gt; &apos;square&apos;,             size    =&gt; 5,             border  =&gt; { color =&gt; &apos;red&apos; },             fill    =&gt; { color =&gt; &apos;yellow&apos; },         },     );</p>
<h3>Trendline</h3>
<p>A trendline can be added to a chart series to indicate trends in the data such as a moving average or a polynomial fit.</p><p>The following properties can be set for trendlines in a chart series.</p><p>    type     order       (for polynomial trends)     period      (for moving average)     forward     (for all except moving average)     backward    (for all except moving average)     name     line</p><p>The \*(C`type\*(C' property sets the type of trendline in the series.</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         trendline  =&gt; { type =&gt; &apos;linear&apos; },     );</p><p>The available \*(C`trendline\*(C' types are:</p><p>    exponential     linear     log     moving_average     polynomial     power</p><p>A \*(C`polynomial\*(C' trendline can also specify the \*(C`order\*(C' of the polynomial. The default value is 2.</p><p>    $chart-&gt;add_series(         values    =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         trendline =&gt; {             type  =&gt; &apos;polynomial&apos;,             order =&gt; 3,         },     );</p><p>A \*(C`moving_average\*(C' trendline can also specify the \*(C`period\*(C' of the moving average. The default value is 2.</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         trendline  =&gt; {             type   =&gt; &apos;moving_average&apos;,             period =&gt; 3,         },     );</p><p>The \*(C`forward\*(C' and \*(C`backward\*(C' properties set the forecast period of the trendline.</p><p>    $chart-&gt;add_series(         values    =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         trendline =&gt; {             type     =&gt; &apos;linear&apos;,             forward  =&gt; 0.5,             backward =&gt; 0.5,         },     );</p><p>The \*(C`name\*(C' property sets an optional name for the trendline that will appear in the chart legend. If it isn't specified the Excel default name will be displayed. This is usually a combination of the trendline type and the series name.</p><p>    $chart-&gt;add_series(         values    =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         trendline =&gt; {             type =&gt; &apos;linear&apos;,             name =&gt; &apos;Interpolated trend&apos;,         },     );</p><p>Several of these properties can be set in one go:</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         trendline  =&gt; {             type     =&gt; &apos;linear&apos;,             name     =&gt; &apos;My trend name&apos;,             forward  =&gt; 0.5,             backward =&gt; 0.5,             line     =&gt; {                 color     =&gt; &apos;red&apos;,                 width     =&gt; 1,                 dash_type =&gt; &apos;long_dash&apos;,             },         },     );</p><p>Trendlines cannot be added to series in a stacked chart or pie chart, radar chart, doughtnut or (when implemented) to 3D, or surface charts.</p>
<h3>Error Bars</h3>
<p>Error bars can be added to a chart series to indicate error bounds in the data. The error bars can be vertical \*(C`y_error_bars\*(C' (the most common type) or horizontal \*(C`x_error_bars\*(C' (for Bar and Scatter charts only).</p><p>The following properties can be set for error bars in a chart series.</p><p>    type     value        (for all types except standard error and custom)     plus_values  (for custom only)     minus_values (for custom only)     direction     end_style     line</p><p>The \*(C`type\*(C' property sets the type of error bars in the series.</p><p>    $chart-&gt;add_series(         values       =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         y_error_bars =&gt; { type =&gt; &apos;standard_error&apos; },     );</p><p>The available error bars types are available:</p><p>    fixed     percentage     standard_deviation     standard_error     custom</p><p>All error bar types, except for \*(C`standard_error\*(C' and \*(C`custom\*(C' must also have a value associated with it for the error bounds:</p><p>    $chart-&gt;add_series(         values       =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         y_error_bars =&gt; {             type  =&gt; &apos;percentage&apos;,             value =&gt; 5,         },     );</p><p>The \*(C`custom\*(C' error bar type must specify \*(C`plus_values\*(C' and \*(C`minus_values\*(C' which should either by a \*(C`Sheet1!$A$1:$A$5\*(C' type range formula or an arrayref of values:</p><p>    $chart-&gt;add_series(         categories   =&gt; &apos;=Sheet1!$A$1:$A$5&apos;,         values       =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         y_error_bars =&gt; {             type         =&gt; &apos;custom&apos;,             plus_values  =&gt; &apos;=Sheet1!$C$1:$C$5&apos;,             minus_values =&gt; &apos;=Sheet1!$D$1:$D$5&apos;,         },     );</p><p>    # or</p><p>    $chart-&gt;add_series(         categories   =&gt; &apos;=Sheet1!$A$1:$A$5&apos;,         values       =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         y_error_bars =&gt; {             type         =&gt; &apos;custom&apos;,             plus_values  =&gt; [1, 1, 1, 1, 1],             minus_values =&gt; [2, 2, 2, 2, 2],         },     );</p><p>Note, as in Excel the items in the \*(C`minus_values\*(C' do not need to be negative.</p><p>The \*(C`direction\*(C' property sets the direction of the error bars. It should be one of the following:</p><p>    plus    # Positive direction only.     minus   # Negative direction only.     both    # Plus and minus directions, The default.</p><p>The \*(C`end_style\*(C' property sets the style of the error bar end cap. The options are 1 (the default) or 0 (for no end cap):</p><p>    $chart-&gt;add_series(         values       =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         y_error_bars =&gt; {             type      =&gt; &apos;fixed&apos;,             value     =&gt; 2,             end_style =&gt; 0,             direction =&gt; &apos;minus&apos;         },     );</p>
<h3>Data Labels</h3>
<p>Data labels can be added to a chart series to indicate the values of the plotted data points.</p><p>The following properties can be set for \*(C`data_labels\*(C' formats in a chart.</p><p>    value     category     series_name     position     leader_lines     percentage</p><p>The \*(C`value\*(C' property turns on the <em>Value</em> data label for a series.</p><p>    $chart-&gt;add_series(         values      =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         data_labels =&gt; { value =&gt; 1 },     );</p><p>The \*(C`category\*(C' property turns on the <em>Category Name</em> data label for a series.</p><p>    $chart-&gt;add_series(         values      =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         data_labels =&gt; { category =&gt; 1 },     );</p><p>The \*(C`series_name\*(C' property turns on the <em>Series Name</em> data label for a series.</p><p>    $chart-&gt;add_series(         values      =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         data_labels =&gt; { series_name =&gt; 1 },     );</p><p>The \*(C`position\*(C' property is used to position the data label for a series.</p><p>    $chart-&gt;add_series(         values      =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         data_labels =&gt; { value =&gt; 1, position =&gt; &apos;center&apos; },     );</p><p>Valid positions are:</p><p>    center     right     left     top     bottom     above           # Same as top     below           # Same as bottom     inside_base     # Mainly for Column/Bar charts.     inside_end      # Pie chart mainly.     outside_end     # Pie chart mainly.     best_fit        # Pie chart mainly.</p><p>The \*(C`percentage\*(C' property is used to turn on the display of data labels as a <em>Percentage</em> for a series. It is mainly used for pie and doughnut charts.</p><p>    $chart-&gt;add_series(         values      =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         data_labels =&gt; { percentage =&gt; 1 },     );</p><p>The \*(C`leader_lines\*(C' property is used to turn on  <em>Leader Lines</em> for the data label for a series. It is mainly used for pie charts.</p><p>    $chart-&gt;add_series(         values      =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         data_labels =&gt; { value =&gt; 1, leader_lines =&gt; 1 },     );</p><p>Note: Even when leader lines are turned on they aren't automatically visible in Excel or Excel::Writer::XLSX. Due to an Excel limitation (or design) leader lines only appear if the data label is moved manually or if the data labels are very close and need to be adjusted automatically.</p>
<h3>Points</h3>
<p>In general formatting is applied to an entire series in a chart. However, it is occasionally required to format individual points in a series. In particular this is required for Pie and Doughnut charts where each segment is represented by a point.</p><p>In these cases it is possible to use the \*(C`points\*(C' property of \*(C`add_series()\*(C':</p><p>    $chart-&gt;add_series(         values =&gt; &apos;=Sheet1!$A$1:$A$3&apos;,         points =&gt; [             { fill =&gt; { color =&gt; &apos;#FF0000&apos; } },             { fill =&gt; { color =&gt; &apos;#CC0000&apos; } },             { fill =&gt; { color =&gt; &apos;#990000&apos; } },         ],     );</p><p>The \*(C`points\*(C' property takes an array ref of format options (see the \*(L"\s-1CHART\s0 \s-1FORMATTING\s0\*(R" section below). To assign default properties to points in a series pass \*(C`undef\*(C' values in the array ref:</p><p>    # Format point 3 of 3 only.     $chart-&gt;add_series(         values =&gt; &apos;=Sheet1!$A$1:$A$3&apos;,         points =&gt; [             undef,             undef,             { fill =&gt; { color =&gt; &apos;#990000&apos; } },         ],     );</p><p>    # Format the first point only.     $chart-&gt;add_series(         values =&gt; &apos;=Sheet1!$A$1:$A$3&apos;,         points =&gt; [ { fill =&gt; { color =&gt; &apos;#FF0000&apos; } } ],     );</p>
<h3>Smooth</h3>
<p>The \*(C`smooth\*(C' option is used to set the smooth property of a line series. It is only applicable to the \*(C`Line\*(C' and \*(C`Scatter\*(C' chart types.</p><p>    $chart-&gt;add_series( values =&gt; &apos;=Sheet1!$C$1:$C$5&apos;,                         smooth =&gt; 1 );</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CHART FORMATTING</h2>
        <div class="sectioncontent">
<p>The following chart formatting properties can be set for any chart object that they apply to (and that are supported by Excel::Writer::XLSX) such as chart lines, column fill areas, plot area borders, markers, gridlines and other chart elements documented above.</p><p>    line     border     fill</p><p>Chart formatting properties are generally set using hash refs.</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         line       =&gt; { color =&gt; &apos;blue&apos; },     );</p><p>In some cases the format properties can be nested. For example a \*(C`marker\*(C' may contain \*(C`border\*(C' and \*(C`fill\*(C' sub-properties.</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         line       =&gt; { color =&gt; &apos;blue&apos; },         marker     =&gt; {             type    =&gt; &apos;square&apos;,             size    =&gt; 5,             border  =&gt; { color =&gt; &apos;red&apos; },             fill    =&gt; { color =&gt; &apos;yellow&apos; },         },     );</p><h3>Line</h3>
<p>The line format is used to specify properties of line objects that appear in a chart such as a plotted line on a chart or a border.</p><p>The following properties can be set for \*(C`line\*(C' formats in a chart.</p><p>    none     color     width     dash_type</p><p>The \*(C`none\*(C' property is uses to turn the \*(C`line\*(C' off (it is always on by default except in Scatter charts). This is useful if you wish to plot a series with markers but without a line.</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         line       =&gt; { none =&gt; 1 },     );</p><p>The \*(C`color\*(C' property sets the color of the \*(C`line\*(C'.</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         line       =&gt; { color =&gt; &apos;red&apos; },     );</p><p>The available colours are shown in the main Excel::Writer::XLSX documentation. It is also possible to set the colour of a line with a \s-1HTML\s0 style \s-1RGB\s0 colour:</p><p>    $chart-&gt;add_series(         line       =&gt; { color =&gt; &apos;#FF0000&apos; },     );</p><p>The \*(C`width\*(C' property sets the width of the \*(C`line\*(C'. It should be specified in increments of 0.25 of a point as in Excel.</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         line       =&gt; { width =&gt; 3.25 },     );</p><p>The \*(C`dash_type\*(C' property sets the dash style of the line.</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         line       =&gt; { dash_type =&gt; &apos;dash_dot&apos; },     );</p><p>The following \*(C`dash_type\*(C' values are available. They are shown in the order that they appear in the Excel dialog.</p><p>    solid     round_dot     square_dot     dash     dash_dot     long_dash     long_dash_dot     long_dash_dot_dot</p><p>The default line style is \*(C`solid\*(C'.</p><p>More than one \*(C`line\*(C' property can be specified at a time:</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         line       =&gt; {             color     =&gt; &apos;red&apos;,             width     =&gt; 1.25,             dash_type =&gt; &apos;square_dot&apos;,         },     );</p>
<h3>Border</h3>
<p>The \*(C`border\*(C' property is a synonym for \*(C`line\*(C'.</p><p>It can be used as a descriptive substitute for \*(C`line\*(C' in chart types such as Bar and Column that have a border and fill style rather than a line style. In general chart objects with a \*(C`border\*(C' property will also have a fill property.</p>
<h3>Fill</h3>
<p>The fill format is used to specify filled areas of chart objects such as the interior of a column or the background of the chart itself.</p><p>The following properties can be set for \*(C`fill\*(C' formats in a chart.</p><p>    none     color</p><p>The \*(C`none\*(C' property is used to turn the \*(C`fill\*(C' property off (it is generally on by default).</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         fill       =&gt; { none =&gt; 1 },     );</p><p>The \*(C`color\*(C' property sets the colour of the \*(C`fill\*(C' area.</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         fill       =&gt; { color =&gt; &apos;red&apos; },     );</p><p>The available colours are shown in the main Excel::Writer::XLSX documentation. It is also possible to set the colour of a fill with a \s-1HTML\s0 style \s-1RGB\s0 colour:</p><p>    $chart-&gt;add_series(         fill       =&gt; { color =&gt; &apos;#FF0000&apos; },     );</p><p>The \*(C`fill\*(C' format is generally used in conjunction with a \*(C`border\*(C' format which has the same properties as a \*(C`line\*(C' format.</p><p>    $chart-&gt;add_series(         values     =&gt; &apos;=Sheet1!$B$1:$B$5&apos;,         border     =&gt; { color =&gt; &apos;red&apos; },         fill       =&gt; { color =&gt; &apos;yellow&apos; },     );</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CHART FONTS</h2>
        <div class="sectioncontent">
<p>The following font properties can be set for any chart object that they apply to (and that are supported by Excel::Writer::XLSX) such as chart titles, axis labels and axis numbering. They correspond to the equivalent Worksheet cell Format object properties. See \*(L"\s-1FORMAT_METHODS\s0\*(R" in Excel::Writer::XLSX for more information.</p><p>    name     size     bold     italic     underline     rotation     color</p><p>The following explains the available font properties:</p><ul>
<li><p>\*(C`name\*(C' Set the font name:     $chart-&gt;set_x_axis( num_font =&gt; { name =&gt; &apos;Arial&apos; } );</p></li><li><p>\*(C`size\*(C' Set the font size:     $chart-&gt;set_x_axis( num_font =&gt; { name =&gt; &apos;Arial&apos;, size =&gt; 10 } );</p></li><li><p>\*(C`bold\*(C' Set the font bold property, should be 0 or 1:     $chart-&gt;set_x_axis( num_font =&gt; { bold =&gt; 1 } );</p></li><li><p>\*(C`italic\*(C' Set the font italic property, should be 0 or 1:     $chart-&gt;set_x_axis( num_font =&gt; { italic =&gt; 1 } );</p></li><li><p>\*(C`underline\*(C' Set the font underline property, should be 0 or 1:     $chart-&gt;set_x_axis( num_font =&gt; { underline =&gt; 1 } );</p></li><li><p>\*(C`rotation\*(C' Set the font rotation in the range -90 to 90:     $chart-&gt;set_x_axis( num_font =&gt; { rotation =&gt; 45 } ); This is useful for displaying large axis data such as dates in a more compact format.</p></li><li><p>\*(C`color\*(C' Set the font color property. Can be a color index, a color name or \s-1HTML\s0 style \s-1RGB\s0 colour:     $chart-&gt;set_x_axis( num_font =&gt; { color =&gt; &apos;red&apos; } );     $chart-&gt;set_y_axis( num_font =&gt; { color =&gt; &apos;#92D050&apos; } );</p></li>
</ul><p>Here is an example of Font formatting in a Chart program:</p><p>    # Format the chart title.     $chart-&gt;set_title(         name      =&gt; &apos;Sales Results Chart&apos;,         name_font =&gt; {             name  =&gt; &apos;Calibri&apos;,             color =&gt; &apos;yellow&apos;,         },     );</p><p>    # Format the X-axis.     $chart-&gt;set_x_axis(         name      =&gt; &apos;Month&apos;,         name_font =&gt; {             name  =&gt; &apos;Arial&apos;,             color =&gt; &apos;#92D050&apos;         },         num_font =&gt; {             name  =&gt; &apos;Courier New&apos;,             color =&gt; &apos;#00B0F0&apos;,         },     );</p><p>    # Format the Y-axis.     $chart-&gt;set_y_axis(         name      =&gt; &apos;Sales (1000 units)&apos;,         name_font =&gt; {             name      =&gt; &apos;Century&apos;,             underline =&gt; 1,             color     =&gt; &apos;red&apos;         },         num_font =&gt; {             bold   =&gt; 1,             italic =&gt; 1,             color  =&gt; &apos;#7030A0&apos;,         },     );</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CHART LAYOUT</h2>
        <div class="sectioncontent">
<p>The position of the chart in the worksheet is controlled by the \*(C`set_size()\*(C' method shown above.</p><p>It is also possible to change the layout of the following chart sub-objects:</p><p>    plotarea     legend     title     x_axis caption     y_axis caption</p><p>Here are some examples:</p><p>    $chart-&gt;set_plotarea(         layout =&gt; {             x      =&gt; 0.35,             y      =&gt; 0.26,             width  =&gt; 0.62,             height =&gt; 0.50,         }     );</p><p>    $chart-&gt;set_legend(         layout =&gt; {             x      =&gt; 0.80,             y      =&gt; 0.37,             width  =&gt; 0.12,             height =&gt; 0.25,         }     );</p><p>    $chart-&gt;set_title(         name   =&gt; &apos;Title&apos;,         layout =&gt; {             x =&gt; 0.42,             y =&gt; 0.14,         }     );</p><p>    $chart-&gt;set_x_axis(         name        =&gt; &apos;X axis&apos;,         name_layout =&gt; {             x =&gt; 0.34,             y =&gt; 0.85,         }     );</p><p>Note that it is only possible to change the width and height for the \*(C`plotarea\*(C' and \*(C`legend\*(C' objects. For the other text based objects the width and height are changed by the font dimensions.</p><p>The layout units must be a float in the range \*(C`0 &lt; x &lt;= 1\*(C' and are expressed as a percentage of the chart dimensions as shown below:</p><p>From this the layout units are calculated as follows:</p><p>    layout:         width  = w / W         height = h / H         x      = a / W         y      = b / H</p><p>These units are slightly cumbersome but are required by Excel so that the chart object positions remain relative to each other if the chart is resized by the user.</p><p>Note that for \*(C`plotarea\*(C' the origin is the top left corner in the plotarea itself and does not take into account the axes.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">WORKSHEET METHODS</h2>
        <div class="sectioncontent">
<p>In Excel a chartsheet (i.e, a chart that isn't embedded) shares properties with data worksheets such as tab selection, headers, footers, margins, and print properties.</p><p>In Excel::Writer::XLSX you can set chartsheet properties using the same methods that are used for Worksheet objects.</p><p>The following Worksheet methods are also available through a non-embedded Chart object:</p><p>    get_name()     activate()     select()     hide()     set_first_sheet()     protect()     set_zoom()     set_tab_color()</p><p>    set_landscape()     set_portrait()     set_paper()     set_margins()     set_header()     set_footer()</p><p>See Excel::Writer::XLSX for a detailed explanation of these methods.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>Here is a complete example that demonstrates some of the available features when creating a chart.</p><p>    #!/usr/bin/perl</p><p>    use strict;     use warnings;     use Excel::Writer::XLSX;</p><p>    my $workbook  = Excel::Writer::XLSX-&gt;new( &apos;chart.xlsx&apos; );     my $worksheet = $workbook-&gt;add_worksheet();     my $bold      = $workbook-&gt;add_format( bold =&gt; 1 );</p><p>    # Add the worksheet data that the charts will refer to.     my $headings = [ &apos;Number&apos;, &apos;Batch 1&apos;, &apos;Batch 2&apos; ];     my $data = [         [ 2,  3,  4,  5,  6,  7 ],         [ 10, 40, 50, 20, 10, 50 ],         [ 30, 60, 70, 50, 40, 30 ],</p><p>    ];</p><p>    $worksheet-&gt;write( &apos;A1&apos;, $headings, $bold );     $worksheet-&gt;write( &apos;A2&apos;, $data );</p><p>    # Create a new chart object. In this case an embedded chart.     my $chart = $workbook-&gt;add_chart( type =&gt; &apos;column&apos;, embedded =&gt; 1 );</p><p>    # Configure the first series.     $chart-&gt;add_series(         name       =&gt; &apos;=Sheet1!$B$1&apos;,         categories =&gt; &apos;=Sheet1!$A$2:$A$7&apos;,         values     =&gt; &apos;=Sheet1!$B$2:$B$7&apos;,     );</p><p>    # Configure second series. Note alternative use of array ref to define     # ranges: [ $sheetname, $row_start, $row_end, $col_start, $col_end ].     $chart-&gt;add_series(         name       =&gt; &apos;=Sheet1!$C$1&apos;,         categories =&gt; [ &apos;Sheet1&apos;, 1, 6, 0, 0 ],         values     =&gt; [ &apos;Sheet1&apos;, 1, 6, 2, 2 ],     );</p><p>    # Add a chart title and some axis labels.     $chart-&gt;set_title ( name =&gt; &apos;Results of sample analysis&apos; );     $chart-&gt;set_x_axis( name =&gt; &apos;Test number&apos; );     $chart-&gt;set_y_axis( name =&gt; &apos;Sample length (mm)&apos; );</p><p>    # Set an Excel chart style. Blue colors with white outline and shadow.     $chart-&gt;set_style( 11 );</p><p>    # Insert the chart into the worksheet (with an offset).     $worksheet-&gt;insert_chart( &apos;D2&apos;, $chart, 25, 10 );</p><p>    _\|_END_\|_</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Value and Category Axes</h2>
        <div class="sectioncontent">
<p>Excel differentiates between a chart axis that is used for series <strong>categories</strong> and an axis that is used for series <strong>values</strong>.</p><p>In the example above the X axis is the category axis and each of the values is evenly spaced. The Y axis (in this case) is the value axis and points are displayed according to their value.</p><p>Since Excel treats the axes differently it also handles their formatting differently and exposes different properties for each.</p><p>As such some of \*(C`Excel::Writer::XLSX\*(C' axis properties can be set for a value axis, some can be set for a category axis and some properties can be set for both.</p><p>For example the \*(C`min\*(C' and \*(C`max\*(C' properties can only be set for value axes and \*(C`reverse\*(C' can be set for both. The type of axis that a property applies to is shown in the \*(C`set_x_axis()\*(C' section of the documentation above.</p><p>Some charts such as \*(C`Scatter\*(C' and \*(C`Stock\*(C' have two value axes.</p><p>Date Axes are a special type of category axis which are explained below.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Date Category Axes</h2>
        <div class="sectioncontent">
<p>Date Category Axes are category axes that display time or date information. In Excel::Writer::XLSX Date Category Axes are set using the \*(C`date_axis\*(C' option:</p><p>    $chart-&gt;set_x_axis( date_axis =&gt; 1 );</p><p>In general you should also specify a number format for a date axis although Excel will usually default to the same format as the data being plotted:</p><p>    $chart-&gt;set_x_axis(         date_axis         =&gt; 1,         num_format        =&gt; &apos;dd/mm/yyyy&apos;,     );</p><p>Excel doesn't normally allow minimum and maximum values to be set for category axes. However, date axes are an exception. The \*(C`min\*(C' and \*(C`max\*(C' values should be set as Excel times or dates:</p><p>    $chart-&gt;set_x_axis(         date_axis         =&gt; 1,         min               =&gt; $worksheet-&gt;convert_date_time(&apos;2013-01-02T&apos;),         max               =&gt; $worksheet-&gt;convert_date_time(&apos;2013-01-09T&apos;),         num_format        =&gt; &apos;dd/mm/yyyy&apos;,     );</p><p>For date axes it is also possible to set the type of the major and minor units:</p><p>    $chart-&gt;set_x_axis(         date_axis         =&gt; 1,         minor_unit        =&gt; 4,         minor_unit_type   =&gt; &apos;months&apos;,         major_unit        =&gt; 1,         major_unit_type   =&gt; &apos;years&apos;,         num_format        =&gt; &apos;dd/mm/yyyy&apos;,     );</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Secondary Axes</h2>
        <div class="sectioncontent">
<p>It is possible to add a secondary axis of the same type to a chart by setting the \*(C`y2_axis\*(C' or \*(C`x2_axis\*(C' property of the series:</p><p>    #!/usr/bin/perl</p><p>    use strict;     use warnings;     use Excel::Writer::XLSX;</p><p>    my $workbook  = Excel::Writer::XLSX-&gt;new( &apos;chart_secondary_axis.xlsx&apos; );     my $worksheet = $workbook-&gt;add_worksheet();</p><p>    # Add the worksheet data that the charts will refer to.     my $data = [         [ 2,  3,  4,  5,  6,  7 ],         [ 10, 40, 50, 20, 10, 50 ],</p><p>    ];</p><p>    $worksheet-&gt;write( &apos;A1&apos;, $data );</p><p>    # Create a new chart object. In this case an embedded chart.     my $chart = $workbook-&gt;add_chart( type =&gt; &apos;line&apos;, embedded =&gt; 1 );</p><p>    # Configure a series with a secondary axis     $chart-&gt;add_series(         values  =&gt; &apos;=Sheet1!$A$1:$A$6&apos;,         y2_axis =&gt; 1,     );</p><p>    $chart-&gt;add_series(         values =&gt; &apos;=Sheet1!$B$1:$B$6&apos;,     );</p><p>    # Insert the chart into the worksheet.     $worksheet-&gt;insert_chart( &apos;D2&apos;, $chart );</p><p>    _\|_END_\|_</p><p>Note, it isn't currently possible to add a secondary axis of a different chart type (for example line and column).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TODO</h2>
        <div class="sectioncontent">
<p>The chart feature in Excel::Writer::XLSX is under active development. More chart types and features will be added in time.</p><p>Features that are on the \s-1TODO\s0 list and will be added are:</p><ul>
<li><p>Add more chart sub-types.</p></li><li><p>Additional formatting options.</p></li><li><p>More axis controls.</p></li><li><p>3D charts.</p></li><li><p>Additional chart types.</p></li>
</ul><p>If you are interested in sponsoring a feature to have it implemented or expedited let me know.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>John McNamara jmcnamara@cpan.org</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright MM-MMXIIII, John McNamara.</p><p>All Rights Reserved. This module is free software. It may be used, redistributed and/or modified under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Excel::Writer::XLSX.3pm.html"><span aria-hidden="true">&larr;</span> Excel::Writer::XLSX.3pm: Create a new file in the excel 2007+ xlsx format.</a></li>
   <li class="next"><a href="Excel::Writer::XLSX::Chart::Area.3pm.html">Excel::Writer::XLSX::Chart::Area.3pm: A class for writing excel area charts. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
