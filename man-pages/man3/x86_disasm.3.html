<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>x86_disasm: Disassemble a bytestream to x86 assembly language instructions</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Disassemble a bytestream to x86 assembly language instructions">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="x86_disasm (3) manual">
  <meta name="twitter:description" content="Disassemble a bytestream to x86 assembly language instructions">
  <meta name="twitter:image" content="https://www.carta.tech/images/libdisasm-dev-x86_disasm-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/x86_disasm.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="x86_disasm (3) manual" />
  <meta property="og:description" content="Disassemble a bytestream to x86 assembly language instructions" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libdisasm-dev-x86_disasm-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">x86_disasm<small> (3)</small></h1>
        <p class="lead">Disassemble a bytestream to x86 assembly language instructions</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/x86_disasm.3.html">
      <span itemprop="name">x86_disasm: Disassemble a bytestream to x86 assembly language instructions</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libdisasm-dev/">
      <span itemprop="name">libdisasm-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/x86_disasm.3.html">
      <span itemprop="name">x86_disasm: Disassemble a bytestream to x86 assembly language instructions</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>#include &lt;libdis.h&gt;</strong></p><p><strong>typedef void (*</strong>DISASM_CALLBACK<strong>)( x86_insn_t *, void * );</strong></p><p><strong>typedef long (*</strong>DISASM_RESOLVER<strong>)( x86_op_t *, x86_insn_t *, void * );</strong></p><p><strong>int x86_disasm( unsigned char *</strong>buf<strong>, unsigned int </strong>buf_len<strong>,</strong></p><p>		unsigned long buf_rva<strong>, unsigned int </strong>offset<strong>,</strong></p><p>		x86_insn_t * insn<strong> );</strong></p><p><strong>int x86_disasm_range( unsigned char *</strong>buf<strong>, unsigned long </strong>buf_rva<strong>,</strong></p><p>		      unsigned int offset<strong>, unsigned int </strong>len<strong>,</strong></p><p>		      DISASM_CALLBACK func<strong>, void *</strong>arg<strong> );</strong></p><p><strong>int x86_disasm_forward( unsigned char *</strong>buf<strong>, unsigned int </strong>buf_len<strong>,</strong></p><p>			unsigned long buf_rva<strong>, unsigned int </strong>offset<strong>,</strong></p><p>			DISASM_CALLBACK func<strong>, void *</strong>arg<strong>,</strong></p><p>			DISASM_RESOLVER resolver<strong>, void *</strong>r_arg<strong> );</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>#define MAX_REGNAME 8</p><p>#define MAX_PREFIX_STR 32</p><p>#define MAX_MNEM_STR 16</p><p>#define MAX_INSN_SIZE 20	/* same as in i386.h */</p><p>#define MAX_OP_STRING 32	/* max possible operand size in string form */</p><p>#define MAX_OP_RAW_STRING 64    /* max possible operand size in raw form */</p><p>#define MAX_OP_XML_STRING 256   /* max possible operand size in xml form */</p><p>#define MAX_NUM_OPERANDS 8	/* max # implicit and explicit operands */</p><p>#define MAX_INSN_STRING 512        /* 2 * 8 * MAX_OP_STRING */</p><p>#define MAX_INSN_RAW_STRING 1024   /* 2 * 8 * MAX_OP_RAW_STRING */</p><p>#define MAX_INSN_XML_STRING 4096   /* 2 * 8 * MAX_OP_XML_STRING */</p><p>enum x86_reg_type { 	/* NOTE: these may be ORed together */</p><p>	reg_gen     = 0x00001,	/* general purpose */</p><p>	reg_in      = 0x00002,	/* incoming args, ala RISC */</p><p>	reg_out     = 0x00004,	/* args to calls, ala RISC */</p><p>	reg_local   = 0x00008,	/* local vars, ala RISC */</p><p>	reg_fpu     = 0x00010,	/* FPU data register */</p><p>	reg_seg     = 0x00020,	/* segment register */</p><p>	reg_simd    = 0x00040,	/* SIMD/MMX reg */</p><p>	reg_sys     = 0x00080,	/* restricted/system register */</p><p>	reg_sp      = 0x00100,	/* stack pointer */</p><p>	reg_fp      = 0x00200,	/* frame pointer */</p><p>	reg_pc      = 0x00400,	/* program counter */</p><p>	reg_retaddr = 0x00800,	/* return addr for func */</p><p>	reg_cond    = 0x01000,	/* condition code / flags */</p><p>	reg_zero    = 0x02000,	/* zero register, ala RISC */</p><p>	reg_ret     = 0x04000,	/* return value */</p><p>	reg_src     = 0x10000,	/* array/rep source */</p><p>	reg_dest    = 0x20000,	/* array/rep destination */</p><p>	reg_count   = 0x40000	/* array/rep/loop counter */</p><p>};</p><p>typedef struct {</p><p>	char name[MAX_REGNAME];</p><p>	enum x86_reg_type type;			/* what register is used for */</p><p>	unsigned int size;			/* size of register in bytes */</p><p>	unsigned int id;				/* register ID #, for quick compares */</p><p>	unsigned int alias;			/* ID of reg this is an alias of */</p><p>	unsigned int shift;			/* amount to shift aliased reg by */</p><p>} x86_reg_t;</p><p>typedef struct {</p><p>	unsigned int     scale;		/* scale factor */</p><p>	x86_reg_t        index, base;	/* index, base registers */</p><p>	long             disp;		/* displacement */</p><p>	char             disp_sign;	/* is negative? 1/0 */</p><p>	char             disp_size;	/* 0, 1, 2, 4 */</p><p>} x86_ea_t;</p><p>enum x86_op_type {	/* mutually exclusive */</p><p>	op_unused = 0,		/* empty/unused operand */</p><p>	op_register = 1,	/* CPU register */</p><p>	op_immediate = 2,	/* Immediate Value */</p><p>	op_relative_near = 3,	/* Relative offset from IP */</p><p>	op_relative_far = 4,</p><p>	op_absolute = 5,	/* Absolute address (ptr16:32) */</p><p>	op_expression = 6,	/* Address expression (scale/index/base/disp) */</p><p>	op_offset = 7,		/* Offset from start of segment (m32) */</p><p>	op_unknown</p><p>};</p><p>enum x86_op_datatype {		/* these use Intel's lame terminology */</p><p>	op_byte = 1,		/* 1 byte integer */</p><p>	op_word = 2,		/* 2 byte integer */</p><p>	op_dword = 3,		/* 4 byte integer */</p><p>	op_qword = 4,		/* 8 byte integer */</p><p>	op_dqword = 5,		/* 16 byte integer */</p><p>	op_sreal = 6,		/* 4 byte real (single real) */</p><p>	op_dreal = 7,		/* 8 byte real (double real) */</p><p>	op_extreal = 8,		/* 10 byte real (extended real) */</p><p>	op_bcd = 9,		/* 10 byte binary-coded decimal */</p><p>	op_simd = 10,		/* 16 byte packed (SIMD, MMX) */</p>
<pre>
        op_ssimd = 10,          /* 16 byte : 4 packed single FP (SIMD, MMX) */
</pre>

<pre>
        op_dsimd = 11,          /* 16 byte : 2 packed double FP (SIMD, MMX) */
</pre>

<pre>
        op_sssimd = 12,         /* 4 byte : scalar single FP (SIMD, MMX) */
</pre>

<pre>
        op_sdsimd = 13,         /* 8 byte : scalar double FP (SIMD, MMX) */
</pre>
<p>	op_descr32 = 14,	/* 6 byte Intel descriptor 2:4 */</p><p>	op_descr16 = 15,	/* 4 byte Intel descriptor 2:2 */</p><p>	op_pdescr32 = 16,	/* 6 byte Intel pseudo-descriptor 32:16 */</p><p>	op_pdescr16 = 17,	/* 6 byte Intel pseudo-descriptor 8:24:16 */</p><p>	op_fpuenv = 11		/* 28 byte FPU control/environment data */</p><p>};</p><p>enum x86_op_access {	/* ORed together */</p><p>	op_read = 1,</p><p>	op_write = 2,</p><p>	op_execute = 4</p><p>};</p><p>enum x86_op_flags {	/* ORed together, but segs are mutually exclusive */</p><p>	op_signed = 1,		/* signed integer */</p><p>	op_string = 2,		/* possible string or array */</p><p>	op_constant = 4,	/* symbolic constant */</p><p>	op_pointer = 8,		/* operand points to a memory address */</p><p>	op_sysref = 0x010,	/* operand is a syscall number */</p><p>	op_implied = 0x020,	/* operand is implicit in insn */</p><p>	op_hardcode = 0x040, /* operans is hardcoded in insn */</p><p>	op_es_seg = 0x100,	/* ES segment override */</p><p>	op_cs_seg = 0x200,	/* CS segment override */</p><p>	op_ss_seg = 0x300,	/* SS segment override */</p><p>	op_ds_seg = 0x400,	/* DS segment override */</p><p>	op_fs_seg = 0x500,	/* FS segment override */</p><p>	op_gs_seg = 0x600	/* GS segment override */</p><p>};</p><p>typedef struct {</p><p>	enum x86_op_type 	type;		/* operand type */</p><p>	enum x86_op_datatype 	datatype;	/* operand size */</p><p>	enum x86_op_access 	access;		/* operand access [RWX] */</p><p>	enum x86_op_flags	flags;		/* misc flags */</p><p>	union {</p><p>		/* immediate values */</p><p>		char 		sbyte;</p><p>		short 		sword;</p><p>		long 		sdword;</p><p>		qword 		sqword;</p><p>		unsigned char 	byte;</p><p>		unsigned short 	word;</p><p>		unsigned long 	dword;</p><p>		qword 			qword;</p><p>		float	        sreal;</p><p>		double	        dreal;</p><p>		/* misc large/non-native types */</p><p>		unsigned char 	extreal[10];</p><p>		unsigned char 	bcd[10];</p><p>		qword		dqword[2];</p><p>		unsigned char	simd[16];</p><p>		unsigned char	fpuenv[28];</p><p>		/* absolute address */</p><p>		void 		* address;</p><p>		/* offset from segment */</p><p>		unsigned long	offset;</p><p>		/* ID of CPU register */</p><p>		x86_reg_t	reg;</p><p>		/* offsets from current insn */</p><p>		char 		relative_near;</p><p>		long 		relative_far;</p><p>		/* effective address [expression] */</p><p>		x86_ea_t 	expression;</p><p>	} data;</p><p>	void * insn;</p><p>} x86_op_t;</p><p>typedef struct x86_operand_list {</p><p>	x86_op_t op;</p><p>	struct x86_operand_list *next;</p><p>} x86_oplist_t;</p><p>enum x86_insn_group {</p><p>	insn_none = 0,</p><p>	insn_controlflow = 1,</p><p>	insn_arithmetic = 2,</p><p>	insn_logic = 3,</p><p>	insn_stack = 4,</p><p>	insn_comparison = 5,</p><p>	insn_move = 6,</p><p>	insn_string = 7,</p><p>	insn_bit_manip = 8,</p><p>	insn_flag_manip = 9,</p><p>	insn_fpu = 10,</p><p>	insn_interrupt = 13,</p><p>	insn_system = 14,</p><p>	insn_other = 15</p><p>};</p><p>enum x86_insn_type {</p><p>	insn_invalid = 0,</p><p>	/* insn_controlflow */</p><p>	insn_jmp = 0x1001,</p><p>	insn_jcc = 0x1002,</p><p>	insn_call = 0x1003,</p><p>	insn_callcc = 0x1004,</p><p>	insn_return = 0x1005,</p><p>	insn_loop = 0x1006,</p><p>	/* insn_arithmetic */</p><p>	insn_add = 0x2001,</p><p>	insn_sub = 0x2002,</p><p>	insn_mul = 0x2003,</p><p>	insn_div = 0x2004,</p><p>	insn_inc = 0x2005,</p><p>	insn_dec = 0x2006,</p><p>	insn_shl = 0x2007,</p><p>	insn_shr = 0x2008,</p><p>	insn_rol = 0x2009,</p><p>	insn_ror = 0x200A,</p><p>	/* insn_logic */</p><p>	insn_and = 0x3001,</p><p>	insn_or = 0x3002,</p><p>	insn_xor = 0x3003,</p><p>	insn_not = 0x3004,</p><p>	insn_neg = 0x3005,</p><p>	/* insn_stack */</p><p>	insn_push = 0x4001,</p><p>	insn_pop = 0x4002,</p><p>	insn_pushregs = 0x4003,</p><p>	insn_popregs = 0x4004,</p><p>	insn_pushflags = 0x4005,</p><p>	insn_popflags = 0x4006,</p><p>	insn_enter = 0x4007,</p><p>	insn_leave = 0x4008,</p><p>	/* insn_comparison */</p><p>	insn_test = 0x5001,</p><p>	insn_cmp = 0x5002,</p><p>	/* insn_move */</p><p>	insn_mov = 0x6001,	/* move */</p><p>	insn_movcc = 0x6002,	/* conditional move */</p><p>	insn_xchg = 0x6003,	/* exchange */</p><p>	insn_xchgcc = 0x6004,	/* conditional exchange */</p><p>	/* insn_string */</p><p>	insn_strcmp = 0x7001,</p><p>	insn_strload = 0x7002,</p><p>	insn_strmov = 0x7003,</p><p>	insn_strstore = 0x7004,</p><p>	insn_translate = 0x7005,	/* xlat */</p><p>	/* insn_bit_manip */</p><p>	insn_bittest = 0x8001,</p><p>	insn_bitset = 0x8002,</p><p>	insn_bitclear = 0x8003,</p><p>	/* insn_flag_manip */</p><p>	insn_clear_carry = 0x9001,</p><p>	insn_clear_zero = 0x9002,</p><p>	insn_clear_oflow = 0x9003,</p><p>	insn_clear_dir = 0x9004,</p><p>	insn_clear_sign = 0x9005,</p><p>	insn_clear_parity = 0x9006,</p><p>	insn_set_carry = 0x9007,</p><p>	insn_set_zero = 0x9008,</p><p>	insn_set_oflow = 0x9009,</p><p>	insn_set_dir = 0x900A,</p><p>	insn_set_sign = 0x900B,</p><p>	insn_set_parity = 0x900C,</p><p>	insn_tog_carry = 0x9010,</p><p>	insn_tog_zero = 0x9020,</p><p>	insn_tog_oflow = 0x9030,</p><p>	insn_tog_dir = 0x9040,</p><p>	insn_tog_sign = 0x9050,</p><p>	insn_tog_parity = 0x9060,</p><p>	/* insn_fpu */</p><p>	insn_fmov = 0xA001,</p><p>	insn_fmovcc = 0xA002,</p><p>	insn_fneg = 0xA003,</p><p>	insn_fabs = 0xA004,</p><p>	insn_fadd = 0xA005,</p><p>	insn_fsub = 0xA006,</p><p>	insn_fmul = 0xA007,</p><p>	insn_fdiv = 0xA008,</p><p>	insn_fsqrt = 0xA009,</p><p>	insn_fcmp = 0xA00A,</p><p>	insn_fcos = 0xA00C,</p><p>	insn_fldpi = 0xA00D,</p><p>	insn_fldz = 0xA00E,</p><p>	insn_ftan = 0xA00F,</p><p>	insn_fsine = 0xA010,</p><p>	insn_fsys = 0xA020,</p><p>	/* insn_interrupt */</p><p>	insn_int = 0xD001,</p><p>	insn_intcc = 0xD002, 	/* not present in x86 ISA */</p><p>	insn_iret = 0xD003,</p><p>	insn_bound = 0xD004,</p><p>	insn_debug = 0xD005,</p><p>	insn_trace = 0xD006,</p><p>	insn_invalid_op = 0xD007,</p><p>	insn_oflow = 0xD008,</p><p>	/* insn_system */</p><p>	insn_halt = 0xE001,</p><p>	insn_in = 0xE002,	/* input from port/bus */</p><p>	insn_out = 0xE003, 	/* output to port/bus */</p><p>	insn_cpuid = 0xE004,</p><p>	/* insn_other */</p><p>	insn_nop = 0xF001,</p><p>	insn_bcdconv = 0xF002, 	/* convert to or from BCD */</p><p>	insn_szconv = 0xF003	/* change size of operand */</p><p>};</p><p>enum x86_insn_note {</p><p>	insn_note_ring0		= 1,	/* Only available in ring 0 */</p><p>	insn_note_smm		= 2,	/* "" in System Management Mode */</p><p>	insn_note_serial	= 4	/* Serializing instruction */</p><p>};</p><p>enum x86_flag_status {</p><p>	insn_carry_set = 0x1,</p><p>	insn_zero_set = 0x2,</p><p>	insn_oflow_set = 0x4,</p><p>	insn_dir_set = 0x8,</p><p>	insn_sign_set = 0x10,</p><p>	insn_parity_set = 0x20,</p><p>	insn_carry_or_zero_set = 0x40,</p><p>	insn_zero_set_or_sign_ne_oflow = 0x80,</p><p>	insn_carry_clear = 0x100,</p><p>	insn_zero_clear = 0x200,</p><p>	insn_oflow_clear = 0x400,</p><p>	insn_dir_clear = 0x800,</p><p>	insn_sign_clear = 0x1000,</p><p>	insn_parity_clear = 0x2000,</p><p>	insn_sign_eq_oflow = 0x4000,</p><p>	insn_sign_ne_oflow = 0x8000</p><p>};</p><p>enum x86_insn_cpu {</p><p>	cpu_8086 	= 1,	/* Intel */</p><p>	cpu_80286	= 2,</p><p>	cpu_80386	= 3,</p><p>	cpu_80387	= 4,</p><p>	cpu_80486	= 5,</p><p>	cpu_pentium	= 6,</p><p>	cpu_pentiumpro	= 7,</p><p>	cpu_pentium2	= 8,</p><p>	cpu_pentium3	= 9, &gt;br&gt; 	cpu_pentium4	= 10,</p><p>	cpu_k6		= 16,	/* AMD */</p><p>	cpu_k7		= 32,</p><p>	cpu_athlon	= 48</p><p>};</p><p>enum x86_insn_isa {</p><p>	isa_gp		= 1,	/* general purpose */</p><p>	isa_fp		= 2,	/* floating point */</p><p>	isa_fpumgt	= 3,	/* FPU/SIMD management */</p><p>	isa_mmx		= 4,	/* Intel MMX */</p><p>	isa_sse1	= 5,	/* Intel SSE SIMD */</p><p>	isa_sse2	= 6,	/* Intel SSE2 SIMD */</p><p>	isa_sse3	= 7,	/* Intel SSE3 SIMD */</p><p>	isa_3dnow	= 8,	/* AMD 3DNow! SIMD */</p><p>	isa_sys		= 9	/* system instructions */</p><p>};</p><p>enum x86_insn_prefix {</p><p>	insn_no_prefix = 0,</p><p>	insn_rep_zero = 1,</p><p>	insn_rep_notzero = 2,</p><p>	insn_lock = 4,</p><p>	insn_delay = 8</p><p>};</p><p>typedef struct {</p><p>	/* information about the instruction */</p><p>	unsigned long addr;		/* load address */</p><p>	unsigned long offset;		/* offset into file/buffer */</p><p>	enum x86_insn_group group;	/* meta-type, e.g. INSN_EXEC */</p><p>	enum x86_insn_type type;	/* type, e.g. INSN_BRANCH */</p><p>	unsigned char bytes[MAX_INSN_SIZE];</p><p>	unsigned char size;		/* size of insn in bytes */</p><p>	enum x86_insn_prefix prefix;</p><p>	enum x86_flag_status flags_set; /* flags set or tested by insn */</p><p>	enum x86_flag_status flags_tested;</p><p>	/* the instruction proper */</p><p>	char prefix_string[32];		/* prefixes [might be truncated] */</p><p>	char mnemonic[8];</p><p>	x86_op_t operands[3];</p><p>	/* convenience fields for user */</p><p>	void *block;			/* code block containing this insn */</p><p>	void *function;			/* function containing this insn */</p><p>	void *tag;			/* tag the insn as seen/processed */</p><p>} x86_insn_t;</p><p>#define X86_WILDCARD_BYTE 0xF4</p><p>typedef struct {</p>
<pre>
        enum x86_op_type        type;           /* operand type */
</pre>

<pre>
        enum x86_op_datatype    datatype;       /* operand size */
</pre>

<pre>
        enum x86_op_access      access;         /* operand access [RWX] */
</pre>

<pre>
        enum x86_op_flags       flags;          /* misc flags */
</pre>
<p>} x86_invariant_op_t;</p><p>typedef struct {</p><p>	unsigned char bytes[64];	/* invariant representation */</p><p>	unsigned int  size;		/* number of bytes in insn */</p>
<pre>
        enum x86_insn_group group;      /* meta-type, e.g. INSN_EXEC */
</pre>

<pre>
        enum x86_insn_type type;        /* type, e.g. INSN_BRANCH */
</pre>
<p>	x86_invariant_op_t operands[3];	/* use same ordering as x86_insn_t */</p><p>} x86_invariant_t;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>The following sample callback outputs instructions in raw syntax:</p><p>void raw_print( x86_insn_t *insn, void *arg ) {</p>
<pre>
        char line[1024];
</pre>

<pre>
        x86_format_insn(insn, line, 1024, raw_syntax);
</pre>

<pre>
        printf( "%s\n", line);
</pre>
<p>}</p><p>The following sample resolver performs very limited checking on the operand of a jump or call to determine what program address the operand refers to:</p><p>long resolver( x86_op_t *op, x86_insn_t *insn ) {</p>
<pre>
        long retval = -1;
</pre>

<pre>
        /* this is a flat ripoff of internal_resolver in libdis.c --
</pre>

<pre>
           we don't do any register or stack resolving, or check
</pre>

<pre>
           to see if we have already encountered this RVA */
</pre>

<pre>
        if ( op-&gt;type == op_absolute || op-&gt;type == op_offset ) {
</pre>

<pre>
                retval = op-&gt;data.sdword;
</pre>

<pre>
        } else if (op-&gt;type == op_relative ){
</pre>

<pre>
                if ( op-&gt;datatype == op_byte ) {
</pre>

<pre>
                        retval = insn-&gt;addr + insn-&gt;size + op-&gt;data.sbyte;
</pre>

<pre>
                } else if ( op-&gt;datatype == op_word ) {
</pre>

<pre>
                        retval = insn-&gt;addr + insn-&gt;size + op-&gt;data.sword;
</pre>

<pre>
                } else if ( op-&gt;datatype == op_dword ) {
</pre>

<pre>
                        retval = insn-&gt;addr + insn-&gt;size + op-&gt;data.sdword;
</pre>

<pre>
                }
</pre>

<pre>
        }
</pre>

<pre>
        return( retval );
</pre>
<p>}</p><p>The following code snippets demonstrate how to use the various disassembly routines:</p>
<pre>
        unsigned char *buf;  /* buffer of bytes to disassemble */
</pre>

<pre>
        unsigned int buf_len;/* length of buffer */
</pre>

<pre>
        unsigned long rva;   /* load address of start of buffer */
</pre>

<pre>
        unsigned int pos;    /* position in buffer */
</pre>

<pre>
        x86_insn_t insn;     /* disassembled instruction */
</pre>

<pre>
        /* disassemble entire buffer, printing automatically */
</pre>

<pre>
        x86_disasm_range( buf, buf_rva, pos, buf_len,
</pre>

<pre>
                          raw_print, NULL );
</pre>

<pre>
        /* disassemble a single instruction, then print it */
</pre>

<pre>
        if (x86_disasm( buf, buf_len, buf_rva, pos, &insn ) ) {
</pre>

<pre>
                raw_print( &insn, NULL );
</pre>

<pre>
        }
</pre>

<pre>
        /* disassemble forward in 'buf' starting at 'pos' */
</pre>

<pre>
        x86_disasm_forward( buf, buf_len, buf_rva, pos,
</pre>

<pre>
                            raw_print, NULL, resolver );
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO x86_disasm&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man7/libdisasm.7.html"><strong>libdisasm</strong>(7)</a>, <a href="../man3/x86_format_insn.3.html"><strong>x86_format_insn</strong>(3)</a>, <a href="../man3/x86_init.3.html"><strong>x86_init</strong>(3)</a>, <a href="../man1/x86dis.1.html"><strong>x86dis</strong>(1)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="write_scf_header.3.html"><span aria-hidden="true">&larr;</span> write_scf_header.3: Write scf files</a></li>
   <li class="next"><a href="x86_format_insn.3.html">x86_format_insn.3: Generate a string representation of a disassembled instruction. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
