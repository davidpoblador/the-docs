<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>request_set: Access control library</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Access control library">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="request_set (3) manual">
  <meta name="twitter:description" content="Access control library">
  <meta name="twitter:image" content="https://www.carta.tech/images/libwrap0-dev-request_set-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/request_set.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="request_set (3) manual" />
  <meta property="og:description" content="Access control library" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libwrap0-dev-request_set-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">request_set<small> (3)</small></h1>
        <p class="lead">Access control library</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/request_set.3.html">
      <span itemprop="name">request_set: Access control library</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libwrap0-dev/">
      <span itemprop="name">libwrap0-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/request_set.3.html">
      <span itemprop="name">request_set: Access control library</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
#include &lt;tcpd.h&gt;

extern int allow_severity;
extern int deny_severity;

struct request_info *request_init(request, key, value, ..., 0)
struct request_info *request;

struct request_info *request_set(request, key, value, ..., 0)
struct request_info *request;

void fromhost(request)
struct request_info *request;

int hosts_access(request)
struct request_info *request;

int hosts_ctl(daemon, client_name, client_addr, client_user)
char *daemon;
char *client_name;
char *client_addr;
char *client_user;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The routines described in this document are part of the <em>libwrap.a</em> library. They implement a rule-based access control language with optional shell commands that are executed when a rule fires.</p><p>request_init() initializes a structure with information about a client request. request_set() updates an already initialized request structure. Both functions take a variable-length list of key-value pairs and return their first argument.  The argument lists are terminated with a zero key value. All string-valued arguments are copied. The expected keys (and corresponding value types) are:</p>
<dl class='dl-vertical'>
  <dt>
    RQ_FILE (int)
  </dt>
  <dd>
    <p>The file descriptor associated with the request.</p>
  </dd>
  <dt>
    RQ_CLIENT_NAME (char *)
  </dt>
  <dd>
    <p>The client host name.</p>
  </dd>
  <dt>
    RQ_CLIENT_ADDR (char *)
  </dt>
  <dd>
    <p>A printable representation of the client network address.</p>
  </dd>
  <dt>
    RQ_CLIENT_SIN (struct sockaddr_in *)
  </dt>
  <dd>
    <p>An internal representation of the client network address and port.  The contents of the structure are not copied.</p>
  </dd>
  <dt>
    RQ_SERVER_NAME (char *)
  </dt>
  <dd>
    <p>The hostname associated with the server endpoint address.</p>
  </dd>
  <dt>
    RQ_SERVER_ADDR (char *)
  </dt>
  <dd>
    <p>A printable representation of the server endpoint address.</p>
  </dd>
  <dt>
    RQ_SERVER_SIN (struct sockaddr_in *)
  </dt>
  <dd>
    <p>An internal representation of the server endpoint address and port. The contents of the structure are not copied.</p>
  </dd>
  <dt>
    RQ_DAEMON (char *)
  </dt>
  <dd>
    <p>The name of the daemon process running on the server host.</p>
  </dd>
  <dt>
    RQ_USER (char *)
  </dt>
  <dd>
    <p>The name of the user on whose behalf the client host makes the request.</p>
  </dd>

</dl>
<p>hosts_access() consults the access control tables described in the <a href="../man5/hosts_access.5.html"><strong>hosts_access</strong>(5)</a></em> manual page.  When internal endpoint information is available, host names and client user names are looked up on demand, using the request structure as a cache.  hosts_access() returns zero if access should be denied. fromhost() must be called before hosts_access().</p><p>hosts_ctl() is a wrapper around the request_init() and hosts_access() routines with a perhaps more convenient interface (though it does not pass on enough information to support automated client username lookups).  The client host address, client host name and username arguments should contain valid data or STRING_UNKNOWN.  hosts_ctl() returns zero if access should be denied.</p><p>The <em>allow_severity</em> and <em>deny_severity</em> variables determine how accepted and rejected requests may be logged. They must be provided by the caller and may be modified by rules in the access control tables.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">
<p>Problems are reported via the syslog daemon.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO request_set&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/hosts_access.5.html"><strong>hosts_access</strong>(5)</a>, format of the access control tables. <a href="../man5/hosts_options.5.html"><strong>hosts_options</strong>(5)</a>, optional extensions to the base language.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/etc/hosts.allow, /etc/hosts.deny, access control tables.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>hosts_access() uses the strtok() library function. This may interfere with other code that relies on strtok().</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">

<pre>
Wietse Venema (wietse@wzv.win.tue.nl)
Department of Mathematics and Computing Science
Eindhoven University of Technology
Den Dolech 2, P.O. Box 513,
5600 MB Eindhoven, The Netherlands

</pre>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="request_init.3.html"><span aria-hidden="true">&larr;</span> request_init.3: Access control library</a></li>
   <li class="next"><a href="res_init.3.html">res_init.3: Resolver routines <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
