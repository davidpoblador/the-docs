<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Inline::Files::Virtual: Multiple virtual files in a single file</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Multiple virtual files in a single file">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Inline::Files::Virtual (3pm) manual">
  <meta name="twitter:description" content="Multiple virtual files in a single file">
  <meta name="twitter:image" content="https://www.carta.tech/images/libinline-files-perl-Inline::Files::Virtual-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Inline::Files::Virtual.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Inline::Files::Virtual (3pm) manual" />
  <meta property="og:description" content="Multiple virtual files in a single file" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libinline-files-perl-Inline::Files::Virtual-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Inline::Files::Virtual<small> (3pm)</small></h1>
        <p class="lead">Multiple virtual files in a single file</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Inline::Files::Virtual.3pm.html">
      <span itemprop="name">Inline::Files::Virtual: Multiple virtual files in a single file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libinline-files-perl/">
      <span itemprop="name">libinline-files-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Inline::Files::Virtual.3pm.html">
      <span itemprop="name">Inline::Files::Virtual: Multiple virtual files in a single file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>This document describes version 0.53 of Inline::Files::Virtual, released May 25, 2001.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    use Inline::Files::Virtual;

    # Load actual file, extracting virtual files that start with "^&lt;VF&gt;&#92;n"
    @virtual_filenames = vf_load($actual_file, "^&lt;VF&gt;&#92;n");

    # Open one of the virtual files for reading
    open(FILE, $virtual_filenames[0]) or die;

    print while &lt;FILE&gt;;

    close(FILE);

    # Open one of the virtual files for appending
    open(FILE, "&gt;&gt; $virtual_filenames[1]") or die;

    print FILE "extra text";
    printf FILE "%6.2", $number;

    close(FILE);

    # Actual file will be updated at this point
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">WARNING</h2>
        <div class="sectioncontent">
<p>This module is still experimental. Careless use of it will almost certainly cause the source code in files that use it to be overwritten. You are <em>strongly</em> advised to use the Inline::Files module instead.</p><p>If you chose to use this module anyway, you thereby agree that the authors will b&lt;under no circumstances&gt; be responsible for any loss of data, code, time, money, or limbs, or for any other disadvantage incurred as a result of using Inline::Files.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This module allows you to treat a single disk file as a collection of virtual files, which may then be individually opened for reading or writing. Virtual files which have been modified are written back to their actual disk at the end of the program's execution (or earlier if the \*(C`vf_save\*(C' subroutine is explicitly called).</p><p>Each such virtual file is introduced by a start-of-virtual-file marker (\s-1SOVFM\s0). This may be any sequence (or pattern) of characters that marks the beginning of the content of a virtual file. For example, the string "--" might be used:</p><p>        --         Contents of virtual         file number 1         --         Contents of virtual         file number 2         --         Contents of virtual         file number 3</p><p>or the pattern \*(C`/##### &#92;w+ #####/\*(C':</p><p>        ##### VF1 #####         Contents of virtual         file number 1         ##### VF2 #####         Contents of virtual         file number 2         ##### VF3 #####         Contents of virtual         file number 3</p><p>Note that the \s-1SOVFM\s0 is not considered to be part of the file contents.</p><h3>Interface</h3>
<p>The module exports the following methods: This subroutine is called to load an actual disk file containing one or more virtual files. The first argument specifies the name of the file to be loaded as a string. The second argument specifies a pattern (as either a string or \*(C`qr\*(C' regex) that matches each start-of-virtual-file marker within the file. For example, if the file \*(C`/usr/local/details.dat\*(C' contains:         =info names</p><p>        Damian         Nathan         Mephistopheles</p><p>        =info numbers</p><p>        555-1212         555-6874         555-3452</p><p>        =info comment</p><p>        Mad         Bad         Dangerous to know then you could load it as three virtual files with:         @virtual_filenames =                 vf_load("/usr/local/details.dat", qr/^=info&#92;s+&#92;S+&#92;s*?&#92;n/); Note that, because the actual file is decomposed into virtual files using a \*(C`split\*(C', it is vital that the pattern does not contain any capturing parentheses. On success, \*(C`vf_load\*(C' returns a list of <em>virtual filenames</em> for the virtual files. Each virtual filename consists of the actual name of the file containing the virtual file, concatenated with the offset of the virtual file's \s-1SOVFM\s0 within the actual file. For example, the above call to \*(C`vf_load\*(C' would return three virtual filenames:         /usr/local/details.dat(00000000000000000000)         /usr/local/details.dat(00000000000000000048)         /usr/local/details.dat(00000000000000000097) When any of these virtual filenames is subsequently used in an \*(C`open\*(C', the corresponding virtual file is opened. This subroutine causes the virtual files belonging to the nominated actual file (or files) to be written back to disk. If \*(C`vf_save\*(C' is called without arguments, then <em>all</em> currently loaded virtual files are saved to their respective actual files at that point. \*(C`vf_save\*(C' is automatically called in an \*(C`END\*(C' block at the termination of any program using the module. This subroutine returns the \s-1SOVFM\s0 that preceded the nominated virtual file.</p><p>The module also modifies the \*(C`open\*(C', \*(C`close\*(C', \*(C`print\*(C', \*(C`printf\*(C', \*(C`read\*(C', \*(C`getline\*(C', \*(C`getc\*(C', \*(C`seek\*(C', \*(C`tell\*(C', and \*(C`truncate\*(C' built-in functions so that they operate correctly on virtual files.</p><p>As a special case, it is also possible to use the raw \s-1SOVFM\s0 as a virtual file name:</p><p>    use Inline::Files::Virtual;</p><p>    vf_load $filename, qr/_\|_[A-Z]+_\|_/;</p><p>    open FILE, "_\|_MARKER_\|_";</p><p>    # and in the file that was vf_load-ed</p><p>    _\|_MARKER_\|_     file contents here</p><p>However, this always opens the very first virtual file with that \s-1SOVFM\s0, no matter how often it is called, or how many such markers appear in the file. Sometimes an \s-1SOVFM\s0 is \*(L"implicit\*(R". That is, rather thanb being a separate marker for the start of a virtual file, it is the first part of the actual data of the virtual file. For example, consider the following \s-1XML\s0 file:</p><p>        &lt;DATA&gt;                 &lt;DESC&gt;This is data set 1&lt;/DESC&gt;                 &lt;DATUM/&gt;datum 1                 &lt;DATUM/&gt;datum 2                 &lt;DATUM/&gt;datum 3         &lt;/DATA&gt;         &lt;DATA&gt;                 &lt;DESC&gt;This is data set 2&lt;/DESC&gt;                 &lt;DATUM/&gt;datum 4                 &lt;DATUM/&gt;datum 5                 &lt;DATUM/&gt;datum 6         &lt;/DATA&gt;</p><p>Each of the \*(C`&lt;DATA&gt;...&lt;/DATA&gt;\*(C' blocks could be treated as a separate virtual file by specifying:</p><p>        @datasets = vf_load("data.xml", &apos;&lt;DATA&gt;&apos;);</p><p>But this would cause the individual virtual files to contain invalid \s-1XML\s0, such as:</p><p>                &lt;DESC&gt;This is data set 1&lt;/DESC&gt;                 &lt;DATUM/&gt;datum 1                 &lt;DATUM/&gt;datum 2                 &lt;DATUM/&gt;datum 3         &lt;/DATA&gt;</p><p>One can indicate that the nominated  SOVFMs are also part of the virtual files' contents, by specifying the markers as a look-ahead pattern:</p><p>        @datasets = vf_load("data.xml", &apos;(?=&lt;DATA&gt;)&apos;);</p><p>This causes \*(C`vf_load\*(C' to identify the sequence \*(C`&lt;DATA&gt;\*(C' as a start-of-virtual-file marker but not consume it, thereby leaving it as the initial sequence of the virtual file's content.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">
<p>The module could not open the specified disk file and read it in as a set of virtual files. The module could not open the specified disk file and write it out as a set of virtual files. A preceding warning may indicate which virtual file caused the problem. An attempt was made to \*(C`getline\*(C', \*(C`getc\*(C', or \*(C`read\*(C' a virtual file that was opened for output only. (Warning only) An attempt was made to \*(C`print\*(C' or \*(C`printf\*(C' a virtual file that was opened for input only. (Warning only)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Damian Conway  (damian@conway.org)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EVIL GENIUS WHO MADE HIM DO IT</h2>
        <div class="sectioncontent">
<p>Brian Ingerson (INGY@cpan.org)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (c) 2001. Damian Conway. All rights reserved.</p><p>This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p><p>See http://www.perl.com/perl/misc/Artistic.html</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Inline::Files.3pm.html"><span aria-hidden="true">&larr;</span> Inline::Files.3pm: Multiple virtual files at the end of your code</a></li>
   <li class="next"><a href="JSON::Types.3pm.html">JSON::Types.3pm: Variable type utility for json encoding <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
