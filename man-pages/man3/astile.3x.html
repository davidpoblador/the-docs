<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>astile: Astile- demonstrates image tiling/cropping and tinting libafterimage/tutorials/astile</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Astile- demonstrates image tiling/cropping and tinting libafterimage/tutorials/astile">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="astile (3x) manual">
  <meta name="twitter:description" content="Astile- demonstrates image tiling/cropping and tinting libafterimage/tutorials/astile">
  <meta name="twitter:image" content="https://www.carta.tech/images/libafterimage-dev-astile-3x.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3x/astile.3x.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="astile (3x) manual" />
  <meta property="og:description" content="Astile- demonstrates image tiling/cropping and tinting libafterimage/tutorials/astile" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libafterimage-dev-astile-3x.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">astile<small> (3x)</small></h1>
        <p class="lead">Astile- demonstrates image tiling/cropping and tinting libafterimage/tutorials/astile</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3x/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3x/astile.3x.html">
      <span itemprop="name">astile: Astile- demonstrates image tiling/cropping and tinting libafterimage/tutorials/astile</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libafterimage-dev/">
      <span itemprop="name">libafterimage-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3x/astile.3x.html">
      <span itemprop="name">astile: Astile- demonstrates image tiling/cropping and tinting libafterimage/tutorials/astile</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">NAMEASTile</h2>
        <div class="sectioncontent">

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>Simple program based on libAfterImage to tile and tint image.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>All we want to do here is to get image filename, tint color and desired geometry from the command line. We then load this image, and proceed on to tiling it based on parameters. Tiling geometry specifies rectangular shape on limitless plane on which original image is tiled. While we are at tiling the image we also tint it to specified color, or to some random value derived from the current time in seconds elapsed since 1971. We then display the result in simple window. After that we would want to wait, until user closes our window.</p><p>In this tutorial we will only explain new steps, not described in previous tutorial. New steps described in this tutorial are : ASTile.1. Parsing ARGB32 tinting color. ASTile.2. Parsing geometry spec. ASTile.3. Tiling and tinting ASImage.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO astile&hellip;</h2>
        <div class="sectioncontent">
<p>ASView - explanation of basic steps needed to use libAfterImage and</p>
<pre>
         some other simple things.
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SOURCE</h2>
        <div class="sectioncontent">
<p>#include "../afterbase.h" #include "../afterimage.h" #include "common.h"</p><p>void usage() {</p>
<pre>
    printf( "Usage: astile [-h]|[[-g geometry][-t tint_color] image]&#92;n");
    printf( "Where: image    - source image filename.&#92;n");
    printf( "       geometry - width and height of the resulting image,&#92;n");
    printf( "                  and x, y of the origin of the tiling on "
            "source image.&#92;n");
    printf( "       tint_color - color to tint image with.( defaults to "
            "current time :)&#92;n");
</pre>
<p>}</p><p>int main(int argc, char* argv[]) {</p>
<pre>
    Window w ;
    Display *dpy = NULL;
    ASVisual *asv ;
    int screen = 0, depth = 0;
    char *image_file = "rose512.jpg" ;
    ARGB32 tint_color = time(NULL);
    int tile_x, tile_y, geom_flags = 0;
    unsigned int tile_width, tile_height ;
    ASImage *im ;
</pre>

<pre>
    /* see ASView.1 : */
    set_application_name( argv[0] );
</pre>
<p>#ifndef X_DISPLAY_MISSING</p>
<pre>
    /* parse_argb_color can only be used after display is open,
       otherwise we are limited to colors defined as ARGB values : */
    dpy = XOpenDisplay(NULL);
    _XA_WM_DELETE_WINDOW = XInternAtom( dpy, "WM_DELETE_WINDOW", False);
    screen = DefaultScreen(dpy);
    depth = DefaultDepth( dpy, screen );
</pre>
<p>#endif</p>
<pre>
    if( argc &gt; 1 )
    {
        int i ;
</pre>

<pre>
        if( strncmp( argv[1], "-h", 2 ) == 0 )
        {
            usage();
            return 0;
        }
</pre>

<pre>
        for( i = 1 ; i &lt; argc ; i++ )
        {
            if( argv[i][0] == '-' && i &lt; argc-1 )
            {
                switch(argv[i][1])
                {
                    case 't' :          /* see ASTile.1 : */
                        if( parse_argb_color( argv[i+1], &tint_color ) ==
                            argv[i+1] )
                            show_warning( "unable to parse tint color - "
                                          "default used: #%8.8lX",
                                          (unsigned long)tint_color );
                        break ;
                    case 'g' :          /* see ASTile.2 : */
                        geom_flags = XParseGeometry( argv[i+1],
                                                     &tile_x, &tile_y,
                                                     &tile_width,
                                                     &tile_height );
                        break ;
                }
                ++i ;
            }else
                image_file = argv[i] ;
        }
    }else
    {
        show_warning( "no image file or tint color specified - "
                      "defaults used:                        image_file, (unsigned long)tint_color );
        usage();
    }
</pre>

<pre>
    /* see ASView.2 : */
    im = file2ASImage( image_file, 0xFFFFFFFF, SCREEN_GAMMA, 0, getenv("IMAGE_PATH"), NULL );
</pre>

<pre>
    /* Making sure tiling geometry is sane : */
    if( !get_flags(geom_flags, XValue ) )
        tile_x = im-&gt;width/2 ;
    if( !get_flags(geom_flags, YValue ) )
        tile_y = im-&gt;height/2 ;
    if( !get_flags(geom_flags, WidthValue ) )
        tile_width = im-&gt;width*2 ;
    if( !get_flags(geom_flags, HeightValue ) )
        tile_height = im-&gt;height*2;
    printf( "%s: tiling image              "%dx%d%+d%+d tinting with #%8.8lX&#92;n",
            get_application_name(), image_file, tile_width, tile_height,
            tile_x, tile_y, (unsigned long)tint_color );
</pre>

<pre>
    if( im != NULL )
    {
        /* see ASView.3 : */
        asv = create_asvisual( dpy, screen, depth, NULL );
        w = None ;
</pre>
<p>#ifndef X_DISPLAY_MISSING</p>
<pre>
        /* see ASView.4 : */
        w = create_top_level_window( asv, DefaultRootWindow(dpy), 32, 32,
                                     tile_width, tile_height, 1, 0, NULL,
                                     "ASTile", image_file );
        if( w != None )
        {
            Pixmap p ;
            ASImage *tinted_im ;
</pre>

<pre>
            XMapRaised   (dpy, w);
            /* see ASTile.3 : */
            tinted_im = tile_asimage( asv, im, tile_x, tile_y,
                                      tile_width, tile_height,
                                      tint_color, ASA_XImage, 0,
                                      ASIMAGE_QUALITY_TOP );
            destroy_asimage( &im );
            /* see ASView.5 : */
            p = asimage2pixmap( asv, DefaultRootWindow(dpy), tinted_im,
                                NULL, True );
            destroy_asimage( &tinted_im );
            /* see common.c: set_window_background_and_free() : */
            p = set_window_background_and_free( w, p );
        }
        /* see common.c: wait_closedown() : */
        wait_closedown(w);
        dpy = NULL;
</pre>
<p>#else</p>
<pre>
        {
            ASImage *tinted_im ;
            /* see ASTile.3 : */
            tinted_im = tile_asimage( asv, im, tile_x, tile_y,
                                      tile_width, tile_height,
                                      tint_color, ASA_ASImage, 0,
                                      ASIMAGE_QUALITY_TOP );
            destroy_asimage( &im );
            /* writing result into the file */
            ASImage2file( tinted_im, NULL, "astile.jpg", ASIT_Jpeg, NULL );
            destroy_asimage( &tinted_im );
        }
</pre>
<p>#endif</p>
<pre>
    }
    return 0 ;
</pre>
<p>}</p><p>libAfterImage/tutorials/ASTile.1 [3.1]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>Step 1. Color parsing.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>libAfterImage utilizes function provided by libAfterBase for color parsing. In case libAfterBase is unavailable - libAfterImage includes its own copy of that function. This function differs from standard XParseColor in a way that it allows for parsing of alpha channel in addition to red, green and blue. It autodetects if value include alpha channel or not, using the following logic: If number of hex digits in color spec is divisible by 4 and is not equal to 12 then first digits are treated as alpha channel. In case named color is specified or now apha channel is specified alpha value of 0xFF will be used, marking this color as solid.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<pre>
    if( parse_argb_color( argv[i+1], &tint_color ) == argv[i+1] )
           show_warning( "unable to parse tint color - default used: #%8.8X",
                       tint_color );
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>On success parse_argb_color returns pointer to the character immidiately following color specification in original string. Therefore test for returned value to be equal to original string will can be used to detect error.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO astile&hellip;</h2>
        <div class="sectioncontent">
<p>libAfterBase, parse_argb_color(), ARGB32 libAfterImage/tutorials/ASTile.2 [3.2]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>Step 2. Parsing the geometry.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Geometry can be specified in WIDTHxHEIGHT+X+Y format. Accordingly we use standard X function to parse it: XParseGeometry. Returned flags tell us what values has been specified. We only have to fill the rest with some sensible defaults. Default x is width/2, y is height/2, and default size is same as image's width.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<pre>
    geom_flags = XParseGeometry ( argv[i+1], &tile_x, &tile_y,
                                  &tile_width, &tile_height );
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO astile&hellip;</h2>
        <div class="sectioncontent">
<p>ASScale.1 libAfterImage/tutorials/ASTile.3 [3.3]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>Step 3. Actuall tiling of the image.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Actuall tiling is quite simple - just call tile_asimage and it will generate new ASImage containing tiled and tinted image. For the sake of example we set quality to TOP, but normally GOOD quality is quite sufficient, and is a default. Again, compression is set to 0 since we do not intend to store image for long time. Even better we don't need to store it at all - all we need is XImage, so we can transfer it to the server easily. That is why to_xim argument is set to ASA_XImage. As the result obtained ASImage will not have any data in its buffers, but it will have ximage member set to point to valid XImage. Subsequently we enjoy that convinience, by setting use_cached to True in call to asimage2pixmap(). That ought to save us a lot of processing.</p><p>Tinting works in both directions - it can increase intensity of the color or decrease it. If any particular channel of the tint_color is greater then 127 then intensity is increased, otherwise its decreased.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>tinted_im = tile_asimage( asv, im, tile_x, tile_y,</p>
<pre>
                        tile_width, tile_height,
                        tint_color,
                        ASA_XImage, 0, ASIMAGE_QUALITY_TOP );
</pre>
<p>destroy_asimage( &im );</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO astile&hellip;</h2>
        <div class="sectioncontent">
<p>tile_asimage().</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="astext.3x.html"><span aria-hidden="true">&larr;</span> astext.3x: Astext- demonstrates antialiased texturized text rendering libafterimage/tutorials/astext</a></li>
   <li class="next"><a href="asview.3x.html">asview.3x: Asview- demonstrates loading and displaying of images libafterimage/tutorials/asview <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
