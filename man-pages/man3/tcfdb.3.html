<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>tcfdb: The fixed-length database api</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="The fixed-length database api">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="tcfdb (3) manual">
  <meta name="twitter:description" content="The fixed-length database api">
  <meta name="twitter:image" content="https://www.carta.tech/images/libtokyocabinet-dev-tcfdb-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/tcfdb.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="tcfdb (3) manual" />
  <meta property="og:description" content="The fixed-length database api" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libtokyocabinet-dev-tcfdb-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">tcfdb<small> (3)</small></h1>
        <p class="lead">The fixed-length database api</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/tcfdb.3.html">
      <span itemprop="name">tcfdb: The fixed-length database api</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libtokyocabinet-dev/">
      <span itemprop="name">libtokyocabinet-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/tcfdb.3.html">
      <span itemprop="name">tcfdb: The fixed-length database api</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Fixed-length database is a file containing an array of fixed-length elements and is handled with the fixed-length database API.</p><p>To use the fixed-length database API, include `<strong>tcutil.h</strong>', `<strong>tcfdb.h</strong>', and related standard header files.  Usually, write the following description near the front of a source file.</p><p><strong>#include &lt;tcutil.h&gt;</strong></p><p><strong>#include &lt;tcfdb.h&gt;</strong></p><p><strong>#include &lt;stdlib.h&gt;</strong></p><p><strong>#include &lt;stdbool.h&gt;</strong></p><p><strong>#include &lt;stdint.h&gt;</strong></p><p>Objects whose type is pointer to `<strong>TCFDB</strong>' are used to handle fixed-length databases.  A fixed-length database object is created with the function `<strong>tcfdbnew</strong>' and is deleted with the function `<strong>tcfdbdel</strong>'.  To avoid memory leak, it is important to delete every object when it is no longer in use.</p><p>Before operations to store or retrieve records, it is necessary to open a database file and connect the fixed-length database object to it.  The function `<strong>tcfdbopen</strong>' is used to open a database file and the function `<strong>tcfdbclose</strong>' is used to close the database file.  To avoid data missing or corruption, it is important to close every database file when it is no longer in use.  It is forbidden for multible database objects in a process to open the same database at the same time.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">API</h2>
        <div class="sectioncontent">
<p>The function `tcfdberrmsg' is used in order to get the message string corresponding to an error code.</p><p><strong>const char *tcfdberrmsg(int </strong><em>ecode</em><strong>);</strong></p><p>`<em>ecode</em>' specifies the error code.</p><p>The return value is the message string of the error code.</p><p>The function `tcfdbnew' is used in order to create a fixed-length database object.</p><p><strong>TCFDB *tcfdbnew(void);</strong></p><p>The return value is the new fixed-length database object.</p><p>The function `tcfdbdel' is used in order to delete a fixed-length database object.</p><p><strong>void tcfdbdel(TCFDB *</strong><em>fdb</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>If the database is not closed, it is closed implicitly.  Note that the deleted object and its derivatives can not be used anymore.</p><p>The function `tcfdbecode' is used in order to get the last happened error code of a fixed-length database object.</p><p><strong>int tcfdbecode(TCFDB *</strong><em>fdb</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>The return value is the last happened error code.</p><p>The following error codes are defined: `TCESUCCESS' for success, `TCETHREAD' for threading error, `TCEINVALID' for invalid operation, `TCENOFILE' for file not found, `TCENOPERM' for no permission, `TCEMETA' for invalid meta data, `TCERHEAD' for invalid record header, `TCEOPEN' for open error, `TCECLOSE' for close error, `TCETRUNC' for trunc error, `TCESYNC' for sync error, `TCESTAT' for stat error, `TCESEEK' for seek error, `TCEREAD' for read error, `TCEWRITE' for write error, `TCEMMAP' for mmap error, `TCELOCK' for lock error, `TCEUNLINK' for unlink error, `TCERENAME' for rename error, `TCEMKDIR' for mkdir error, `TCERMDIR' for rmdir error, `TCEKEEP' for existing record, `TCENOREC' for no record found, and `TCEMISC' for miscellaneous error.</p><p>The function `tcfdbsetmutex' is used in order to set mutual exclusion control of a fixed-length database object for threading.</p><p><strong>bool tcfdbsetmutex(TCFDB *</strong><em>fdb</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object which is not opened.</p><p>If successful, the return value is true, else, it is false.</p><p>Note that the mutual exclusion control is needed if the object is shared by plural threads and this function should be called before the database is opened.</p><p>The function `tcfdbtune' is used in order to set the tuning parameters of a fixed-length database object.</p><p><strong>bool tcfdbtune(TCFDB *</strong><em>fdb</em><strong>, int32_t </strong><em>width</em><strong>, int64_t </strong><em>limsiz</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object which is not opened.</p><p>`<em>width</em>' specifies the width of the value of each record.  If it is not more than 0, the default value is specified.  The default value is 255.</p><p>`<em>limsiz</em>' specifies the limit size of the database file.  If it is not more than 0, the default value is specified.  The default value is 268435456.</p><p>If successful, the return value is true, else, it is false.</p><p>Note that the tuning parameters should be set before the database is opened.</p><p>The function `tcfdbopen' is used in order to open a database file and connect a fixed-length database object.</p><p><strong>bool tcfdbopen(TCFDB *</strong><em>fdb</em><strong>, const char *</strong><em>path</em><strong>, int </strong><em>omode</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object which is not opened.</p><p>`<em>path</em>' specifies the path of the database file.</p><p>`<em>omode</em>' specifies the connection mode: `FDBOWRITER' as a writer, `FDBOREADER' as a reader.  If the mode is `FDBOWRITER', the following may be added by bitwise-or: `FDBOCREAT', which means it creates a new database if not exist, `FDBOTRUNC', which means it creates a new database regardless if one exists, `FDBOTSYNC', which means every transaction synchronizes updated contents with the device.  Both of `FDBOREADER' and `FDBOWRITER' can be added to by bitwise-or: `FDBONOLCK', which means it opens the database file without file locking, or `FDBOLCKNB', which means locking is performed without blocking.</p><p>If successful, the return value is true, else, it is false.</p><p>The function `tcfdbclose' is used in order to close a fixed-length database object.</p><p><strong>bool tcfdbclose(TCFDB *</strong><em>fdb</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>If successful, the return value is true, else, it is false.</p><p>Update of a database is assured to be written when the database is closed.  If a writer opens a database but does not close it appropriately, the database will be broken.</p><p>The function `tcfdbput' is used in order to store a record into a fixed-length database object.</p><p><strong>bool tcfdbput(TCFDB *</strong><em>fdb</em><strong>, int64_t </strong><em>id</em><strong>, const void *</strong><em>vbuf</em><strong>, int </strong><em>vsiz</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>`<em>id</em>' specifies the ID number.  It should be more than 0.  If it is `FDBIDMIN', the minimum ID number of existing records is specified.  If it is `FDBIDPREV', the number less by one than the minimum ID number of existing records is specified.  If it is `FDBIDMAX', the maximum ID number of existing records is specified.  If it is `FDBIDNEXT', the number greater by one than the maximum ID number of existing records is specified.</p><p>`<em>vbuf</em>' specifies the pointer to the region of the value.</p><p>`<em>vsiz</em>' specifies the size of the region of the value.  If the size of the value is greater than the width tuning parameter of the database, the size is cut down to the width.</p><p>If successful, the return value is true, else, it is false.</p><p>If a record with the same key exists in the database, it is overwritten.</p><p>The function `tcfdbput2' is used in order to store a record with a decimal key into a fixed-length database object.</p><p><strong>bool tcfdbput2(TCFDB *</strong><em>fdb</em><strong>, const void *</strong><em>kbuf</em><strong>, int </strong><em>ksiz</em><strong>, const void *</strong><em>vbuf</em><strong>, int </strong><em>vsiz</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>`<em>kbuf</em>' specifies the pointer to the region of the decimal key.  It should be more than 0.  If it is "min", the minimum ID number of existing records is specified.  If it is "prev", the number less by one than the minimum ID number of existing records is specified.  If it is "max", the maximum ID number of existing records is specified.  If it is "next", the number greater by one than the maximum ID number of existing records is specified.</p><p>`<em>ksiz</em>' specifies the size of the region of the key.</p><p>`<em>vbuf</em>' specifies the pointer to the region of the value.</p><p>`<em>vsiz</em>' specifies the size of the region of the value.  If the size of the value is greater than the width tuning parameter of the database, the size is cut down to the width.</p><p>If successful, the return value is true, else, it is false.</p><p>If a record with the same key exists in the database, it is overwritten.</p><p>The function `tcfdbput3' is used in order to store a string record with a decimal key into a fixed-length database object.</p><p><strong>bool tcfdbput3(TCFDB *</strong><em>fdb</em><strong>, const char *</strong><em>kstr</em><strong>, const void *</strong><em>vstr</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>`<em>kstr</em>' specifies the string of the decimal key.  It should be more than 0.  If it is "min", the minimum ID number of existing records is specified.  If it is "prev", the number less by one than the minimum ID number of existing records is specified.  If it is "max", the maximum ID number of existing records is specified.  If it is "next", the number greater by one than the maximum ID number of existing records is specified.</p><p>`<em>vstr</em>' specifies the string of the value.</p><p>If successful, the return value is true, else, it is false.</p><p>If a record with the same key exists in the database, it is overwritten.</p><p>The function `tcfdbputkeep' is used in order to store a new record into a fixed-length database object.</p><p><strong>bool tcfdbputkeep(TCFDB *</strong><em>fdb</em><strong>, int64_t </strong><em>id</em><strong>, const void *</strong><em>vbuf</em><strong>, int </strong><em>vsiz</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>`<em>id</em>' specifies the ID number.  It should be more than 0.  If it is `FDBIDMIN', the minimum ID number of existing records is specified.  If it is `FDBIDPREV', the number less by one than the minimum ID number of existing records is specified.  If it is `FDBIDMAX', the maximum ID number of existing records is specified.  If it is `FDBIDNEXT', the number greater by one than the maximum ID number of existing records is specified.</p><p>`<em>vbuf</em>' specifies the pointer to the region of the value.</p><p>`<em>vsiz</em>' specifies the size of the region of the value.  If the size of the value is greater than the width tuning parameter of the database, the size is cut down to the width.</p><p>If successful, the return value is true, else, it is false.</p><p>If a record with the same key exists in the database, this function has no effect.</p><p>The function `tcfdbputkeep2' is used in order to store a new record with a decimal key into a fixed-length database object.</p><p><strong>bool tcfdbputkeep2(TCFDB *</strong><em>fdb</em><strong>, const void *</strong><em>kbuf</em><strong>, int </strong><em>ksiz</em><strong>, const void *</strong><em>vbuf</em><strong>, int </strong><em>vsiz</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>`<em>kbuf</em>' specifies the pointer to the region of the decimal key.  It should be more than 0.  If it is "min", the minimum ID number of existing records is specified.  If it is "prev", the number less by one than the minimum ID number of existing records is specified.  If it is "max", the maximum ID number of existing records is specified.  If it is "next", the number greater by one than the maximum ID number of existing records is specified.</p><p>`<em>ksiz</em>' specifies the size of the region of the key.</p><p>`<em>vbuf</em>' specifies the pointer to the region of the value.</p><p>`<em>vsiz</em>' specifies the size of the region of the value.  If the size of the value is greater than the width tuning parameter of the database, the size is cut down to the width.</p><p>If successful, the return value is true, else, it is false.</p><p>If a record with the same key exists in the database, this function has no effect.</p><p>The function `tcfdbputkeep3' is used in order to store a new string record with a decimal key into a fixed-length database object.</p><p><strong>bool tcfdbputkeep3(TCFDB *</strong><em>fdb</em><strong>, const char *</strong><em>kstr</em><strong>, const void *</strong><em>vstr</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>`<em>kstr</em>' specifies the string of the decimal key.  It should be more than 0.  If it is "min", the minimum ID number of existing records is specified.  If it is "prev", the number less by one than the minimum ID number of existing records is specified.  If it is "max", the maximum ID number of existing records is specified.  If it is "next", the number greater by one than the maximum ID number of existing records is specified.</p><p>`<em>vstr</em>' specifies the string of the value.</p><p>If successful, the return value is true, else, it is false.</p><p>If a record with the same key exists in the database, this function has no effect.</p><p>The function `tcfdbputcat' is used in order to concatenate a value at the end of the existing record in a fixed-length database object.</p><p><strong>bool tcfdbputcat(TCFDB *</strong><em>fdb</em><strong>, int64_t </strong><em>id</em><strong>, const void *</strong><em>vbuf</em><strong>, int </strong><em>vsiz</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>`<em>id</em>' specifies the ID number.  It should be more than 0.  If it is `FDBIDMIN', the minimum ID number of existing records is specified.  If it is `FDBIDPREV', the number less by one than the minimum ID number of existing records is specified.  If it is `FDBIDMAX', the maximum ID number of existing records is specified.  If it is `FDBIDNEXT', the number greater by one than the maximum ID number of existing records is specified.</p><p>`<em>vbuf</em>' specifies the pointer to the region of the value.</p><p>`<em>vsiz</em>' specifies the size of the region of the value.  If the size of the value is greater than the width tuning parameter of the database, the size is cut down to the width.</p><p>If successful, the return value is true, else, it is false.</p><p>If there is no corresponding record, a new record is created.</p><p>The function `tcfdbputcat2' is used in order to concatenate a value with a decimal key in a fixed-length database object.</p><p><strong>bool tcfdbputcat2(TCFDB *</strong><em>fdb</em><strong>, const void *</strong><em>kbuf</em><strong>, int </strong><em>ksiz</em><strong>, const void *</strong><em>vbuf</em><strong>, int </strong><em>vsiz</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>`<em>kbuf</em>' specifies the pointer to the region of the decimal key.  It should be more than 0.  If it is "min", the minimum ID number of existing records is specified.  If it is "prev", the number less by one than the minimum ID number of existing records is specified.  If it is "max", the maximum ID number of existing records is specified.  If it is "next", the number greater by one than the maximum ID number of existing records is specified.</p><p>`<em>ksiz</em>' specifies the size of the region of the key.</p><p>`<em>vbuf</em>' specifies the pointer to the region of the value.</p><p>`<em>vsiz</em>' specifies the size of the region of the value.  If the size of the value is greater than the width tuning parameter of the database, the size is cut down to the width.</p><p>If successful, the return value is true, else, it is false.</p><p>If there is no corresponding record, a new record is created.</p><p>The function `tcfdbputcat3' is used in order to concatenate a string value with a decimal key in a fixed-length database object.</p><p><strong>bool tcfdbputcat3(TCFDB *</strong><em>fdb</em><strong>, const char *</strong><em>kstr</em><strong>, const void *</strong><em>vstr</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>`<em>kstr</em>' specifies the string of the decimal key.  It should be more than 0.  If it is "min", the minimum ID number of existing records is specified.  If it is "prev", the number less by one than the minimum ID number of existing records is specified.  If it is "max", the maximum ID number of existing records is specified.  If it is "next", the number greater by one than the maximum ID number of existing records is specified.</p><p>`<em>vstr</em>' specifies the string of the value.</p><p>If successful, the return value is true, else, it is false.</p><p>If there is no corresponding record, a new record is created.</p><p>The function `tcfdbout' is used in order to remove a record of a fixed-length database object.</p><p><strong>bool tcfdbout(TCFDB *</strong><em>fdb</em><strong>, int64_t </strong><em>id</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>`<em>id</em>' specifies the ID number.  It should be more than 0.  If it is `FDBIDMIN', the minimum ID number of existing records is specified.  If it is `FDBIDMAX', the maximum ID number of existing records is specified.</p><p>If successful, the return value is true, else, it is false.</p><p>The function `tcfdbout2' is used in order to remove a record with a decimal key of a fixed-length database object.</p><p><strong>bool tcfdbout2(TCFDB *</strong><em>fdb</em><strong>, const void *</strong><em>kbuf</em><strong>, int </strong><em>ksiz</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>`<em>kbuf</em>' specifies the pointer to the region of the decimal key.  It should be more than 0.  If it is "min", the minimum ID number of existing records is specified.  If it is "max", the maximum ID number of existing records is specified.</p><p>`<em>ksiz</em>' specifies the size of the region of the key.</p><p>If successful, the return value is true, else, it is false.</p><p>The function `tcfdbout3' is used in order to remove a string record with a decimal key of a fixed-length database object.</p><p><strong>bool tcfdbout3(TCFDB *</strong><em>fdb</em><strong>, const char *</strong><em>kstr</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>`<em>kstr</em>' specifies the string of the decimal key.  It should be more than 0.  If it is "min", the minimum ID number of existing records is specified.  If it is "max", the maximum ID number of existing records is specified.</p><p>If successful, the return value is true, else, it is false.</p><p>The function `tcfdbget' is used in order to retrieve a record in a fixed-length database object.</p><p><strong>void *tcfdbget(TCFDB *</strong><em>fdb</em><strong>, int64_t </strong><em>id</em><strong>, int *</strong><em>sp</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>`<em>id</em>' specifies the ID number.  It should be more than 0.  If it is `FDBIDMIN', the minimum ID number of existing records is specified.  If it is `FDBIDMAX', the maximum ID number of existing records is specified.</p><p>`<em>sp</em>' specifies the pointer to the variable into which the size of the region of the return value is assigned.</p><p>If successful, the return value is the pointer to the region of the value of the corresponding record.  `NULL' is returned if no record corresponds.</p><p>Because an additional zero code is appended at the end of the region of the return value, the return value can be treated as a character string.  Because the region of the return value is allocated with the `malloc' call, it should be released with the `free' call when it is no longer in use.</p><p>The function `tcfdbget2' is used in order to retrieve a record with a decimal key in a fixed-length database object.</p><p><strong>void *tcfdbget2(TCFDB *</strong><em>fdb</em><strong>, const void *</strong><em>kbuf</em><strong>, int </strong><em>ksiz</em><strong>, int *</strong><em>sp</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>`<em>kbuf</em>' specifies the pointer to the region of the decimal key.  It should be more than 0.  If it is "min", the minimum ID number of existing records is specified.  If it is "max", the maximum ID number of existing records is specified.</p><p>`<em>ksiz</em>' specifies the size of the region of the key.</p><p>`<em>sp</em>' specifies the pointer to the variable into which the size of the region of the return value is assigned.</p><p>If successful, the return value is the pointer to the region of the value of the corresponding record.  `NULL' is returned if no record corresponds.</p><p>Because an additional zero code is appended at the end of the region of the return value, the return value can be treated as a character string.  Because the region of the return value is allocated with the `malloc' call, it should be released with the `free' call when it is no longer in use.</p><p>The function `tcfdbget3' is used in order to retrieve a string record with a decimal key in a fixed-length database object.</p><p><strong>char *tcfdbget3(TCFDB *</strong><em>fdb</em><strong>, const char *</strong><em>kstr</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>`<em>kstr</em>' specifies the string of the decimal key.  It should be more than 0.  If it is "min", the minimum ID number of existing records is specified.  If it is "max", the maximum ID number of existing records is specified.</p><p>If successful, the return value is the string of the value of the corresponding record.  `NULL' is returned if no record corresponds.</p><p>Because an additional zero code is appended at the end of the region of the return value, the return value can be treated as a character string.  Because the region of the return value is allocated with the `malloc' call, it should be released with the `free' call when it is no longer in use.</p><p>The function `tcfdbget4' is used in order to retrieve a record in a fixed-length database object and write the value into a buffer.</p><p><strong>int tcfdbget4(TCFDB *</strong><em>fdb</em><strong>, int64_t </strong><em>id</em><strong>, void *</strong><em>vbuf</em><strong>, int </strong><em>max</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>`<em>id</em>' specifies the ID number.  It should be more than 0.  If it is `FDBIDMIN', the minimum ID number of existing records is specified.  If it is `FDBIDMAX', the maximum ID number of existing records is specified.</p><p>`<em>vbuf</em>' specifies the pointer to the buffer into which the value of the corresponding record is written.</p><p>`<em>max</em>' specifies the size of the buffer.</p><p>If successful, the return value is the size of the written data, else, it is -1.  -1 is returned if no record corresponds to the specified key.</p><p>Note that an additional zero code is not appended at the end of the region of the writing buffer.</p><p>The function `tcfdbvsiz' is used in order to get the size of the value of a record in a fixed-length database object.</p><p><strong>int tcfdbvsiz(TCFDB *</strong><em>fdb</em><strong>, int64_t </strong><em>id</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>`<em>id</em>' specifies the ID number.  It should be more than 0.  If it is `FDBIDMIN', the minimum ID number of existing records is specified.  If it is `FDBIDMAX', the maximum ID number of existing records is specified.</p><p>If successful, the return value is the size of the value of the corresponding record, else, it is -1.</p><p>The function `tcfdbvsiz2' is used in order to get the size of the value with a decimal key in a fixed-length database object.</p><p><strong>int tcfdbvsiz2(TCFDB *</strong><em>fdb</em><strong>, const void *</strong><em>kbuf</em><strong>, int </strong><em>ksiz</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>`<em>kbuf</em>' specifies the pointer to the region of the decimal key.  It should be more than 0.  If it is "min", the minimum ID number of existing records is specified.  If it is "max", the maximum ID number of existing records is specified.</p><p>`<em>ksiz</em>' specifies the size of the region of the key.</p><p>If successful, the return value is the size of the value of the corresponding record, else, it is -1.</p><p>The function `tcfdbvsiz3' is used in order to get the size of the string value with a decimal key in a fixed-length database object.</p><p><strong>int tcfdbvsiz3(TCFDB *</strong><em>fdb</em><strong>, const char *</strong><em>kstr</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>`<em>kstr</em>' specifies the string of the decimal key.  It should be more than 0.  If it is "min", the minimum ID number of existing records is specified.  If it is "max", the maximum ID number of existing records is specified.</p><p>If successful, the return value is the size of the value of the corresponding record, else, it is -1.</p><p>The function `tcfdbiterinit' is used in order to initialize the iterator of a fixed-length database object.</p><p><strong>bool tcfdbiterinit(TCFDB *</strong><em>fdb</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>If successful, the return value is true, else, it is false.</p><p>The iterator is used in order to access the key of every record stored in a database.</p><p>The function `tcfdbiternext' is used in order to get the next ID number of the iterator of a fixed-length database object.</p><p><strong>uint64_t tcfdbiternext(TCFDB *</strong><em>fdb</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>If successful, the return value is the next ID number of the iterator, else, it is 0.  0 is returned when no record is to be get out of the iterator.</p><p>It is possible to access every record by iteration of calling this function.  It is allowed to update or remove records whose keys are fetched while the iteration.  The order of this traversal access method is ascending of the ID number.</p><p>The function `tcfdbiternext2' is used in order to get the next decimay key of the iterator of a fixed-length database object.</p><p><strong>void *tcfdbiternext2(TCFDB *</strong><em>fdb</em><strong>, int *</strong><em>sp</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>`<em>sp</em>' specifies the pointer to the variable into which the size of the region of the return value is assigned.</p><p>If successful, the return value is the pointer to the region of the next decimal key, else, it is `NULL'.  `NULL' is returned when no record is to be get out of the iterator.</p><p>Because an additional zero code is appended at the end of the region of the return value, the return value can be treated as a character string.  Because the region of the return value is allocated with the `malloc' call, it should be released with the `free' call when it is no longer in use.  It is possible to access every record by iteration of calling this function.  It is allowed to update or remove records whose keys are fetched while the iteration.  The order of this traversal access method is ascending of the ID number.</p><p>The function `tcfdbiternext3' is used in order to get the next decimay key string of the iterator of a fixed-length database object.</p><p><strong>char *tcfdbiternext3(TCFDB *</strong><em>fdb</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>If successful, the return value is the string of the next decimal key, else, it is `NULL'.  `NULL' is returned when no record is to be get out of the iterator.</p><p>Because the region of the return value is allocated with the `malloc' call, it should be released with the `free' call when it is no longer in use.  It is possible to access every record by iteration of calling this function.  It is allowed to update or remove records whose keys are fetched while the iteration.  The order of this traversal access method is ascending of the ID number.</p><p>The function `tcfdbrange' is used in order to get range matching ID numbers in a fixed-length database object.</p><p><strong>uint64_t *tcfdbrange(TCFDB *</strong><em>fdb</em><strong>, int64_t </strong><em>lower</em><strong>, int64_t </strong><em>upper</em><strong>, int </strong><em>max</em><strong>, int *</strong><em>np</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>`<em>lower</em>' specifies the lower limit of the range.  If it is `FDBIDMIN', the minimum ID is specified.</p><p>`<em>upper</em>' specifies the upper limit of the range.  If it is `FDBIDMAX', the maximum ID is specified.</p><p>`<em>max</em>' specifies the maximum number of keys to be fetched.  If it is negative, no limit is specified.</p><p>`<em>np</em>' specifies the pointer to the variable into which the number of elements of the return value is assigned.</p><p>If successful, the return value is the pointer to an array of ID numbers of the corresponding records.  `NULL' is returned on failure.  This function does never fail.  It returns an empty array even if no key corresponds.</p><p>Because the region of the return value is allocated with the `malloc' call, it should be released with the `free' call when it is no longer in use.</p><p>The function `tcfdbrange2' is used in order to get range matching decimal keys in a fixed-length database object.</p><p><strong>TCLIST *tcfdbrange2(TCFDB *</strong><em>fdb</em><strong>, const void *</strong><em>lbuf</em><strong>, int </strong><em>lsiz</em><strong>, const void *</strong><em>ubuf</em><strong>, int </strong><em>usiz</em><strong>, int </strong><em>max</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>`<em>lbuf</em>' specifies the pointer to the region of the lower key.  If it is "min", the minimum ID number of existing records is specified.</p><p>`<em>lsiz</em>' specifies the size of the region of the lower key.</p><p>`<em>ubuf</em>' specifies the pointer to the region of the upper key.  If it is "max", the maximum ID number of existing records is specified.</p><p>`<em>usiz</em>' specifies the size of the region of the upper key.</p><p>`<em>max</em>' specifies the maximum number of keys to be fetched.  If it is negative, no limit is specified.</p><p>The return value is a list object of the corresponding decimal keys.  This function does never fail.  It returns an empty list even if no key corresponds.</p><p>Because the object of the return value is created with the function `tclistnew', it should be deleted with the function `tclistdel' when it is no longer in use.  Note that this function may be very slow because every key in the database is scanned.</p><p>The function `tcfdbrange3' is used in order to get range matching decimal keys with strings in a fixed-length database object.</p><p><strong>TCLIST *tcfdbrange3(TCFDB *</strong><em>fdb</em><strong>, const char *</strong><em>lstr</em><strong>, const char *</strong><em>ustr</em><strong>, int </strong><em>max</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>`<em>lstr</em>' specifies the string of the lower key.  If it is "min", the minimum ID number of existing records is specified.</p><p>`<em>ustr</em>' specifies the string of the upper key.  If it is "max", the maximum ID number of existing records is specified.</p><p>`<em>max</em>' specifies the maximum number of keys to be fetched.  If it is negative, no limit is specified.</p><p>The return value is a list object of the corresponding decimal keys.  This function does never fail.  It returns an empty list even if no key corresponds.</p><p>Because the object of the return value is created with the function `tclistnew', it should be deleted with the function `tclistdel' when it is no longer in use.  Note that this function may be very slow because every key in the database is scanned.</p><p>The function `tcfdbrange4' is used in order to get keys with an interval notation in a fixed-length database object.</p><p><strong>TCLIST *tcfdbrange4(TCFDB *</strong><em>fdb</em><strong>, const void *</strong><em>ibuf</em><strong>, int </strong><em>isiz</em><strong>, int </strong><em>max</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>`<em>ibuf</em>' specifies the pointer to the region of the interval notation.</p><p>`<em>isiz</em>' specifies the size of the region of the interval notation.</p><p>`<em>max</em>' specifies the maximum number of keys to be fetched.  If it is negative, no limit is specified.</p><p>The return value is a list object of the corresponding decimal keys.  This function does never fail.  It returns an empty list even if no key corresponds.</p><p>Because the object of the return value is created with the function `tclistnew', it should be deleted with the function `tclistdel' when it is no longer in use.  Note that this function may be very slow because every key in the database is scanned.</p><p>The function `tcfdbrange5' is used in order to get keys with an interval notation string in a fixed-length database object.</p><p><strong>TCLIST *tcfdbrange5(TCFDB *</strong><em>fdb</em><strong>, const void *</strong><em>istr</em><strong>, int </strong><em>max</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>`<em>istr</em>' specifies the pointer to the region of the interval notation string.</p><p>`<em>max</em>' specifies the maximum number of keys to be fetched.  If it is negative, no limit is specified.</p><p>The return value is a list object of the corresponding decimal keys.  This function does never fail.  It returns an empty list even if no key corresponds.</p><p>Because the object of the return value is created with the function `tclistnew', it should be deleted with the function `tclistdel' when it is no longer in use.  Note that this function may be very slow because every key in the database is scanned.</p><p>The function `tcfdbaddint' is used in order to add an integer to a record in a fixed-length database object.</p><p><strong>int tcfdbaddint(TCFDB *</strong><em>fdb</em><strong>, int64_t </strong><em>id</em><strong>, int </strong><em>num</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>`<em>id</em>' specifies the ID number.  It should be more than 0.  If it is `FDBIDMIN', the minimum ID number of existing records is specified.  If it is `FDBIDPREV', the number less by one than the minimum ID number of existing records is specified.  If it is `FDBIDMAX', the maximum ID number of existing records is specified.  If it is `FDBIDNEXT', the number greater by one than the maximum ID number of existing records is specified.</p><p>`<em>num</em>' specifies the additional value.</p><p>If successful, the return value is the summation value, else, it is `INT_MIN'.</p><p>If the corresponding record exists, the value is treated as an integer and is added to.  If no record corresponds, a new record of the additional value is stored.</p><p>The function `tcfdbadddouble' is used in order to add a real number to a record in a fixed-length database object.</p><p><strong>double tcfdbadddouble(TCFDB *</strong><em>fdb</em><strong>, int64_t </strong><em>id</em><strong>, double </strong><em>num</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>`<em>id</em>' specifies the ID number.  It should be more than 0.  If it is `FDBIDMIN', the minimum ID number of existing records is specified.  If it is `FDBIDPREV', the number less by one than the minimum ID number of existing records is specified.  If it is `FDBIDMAX', the maximum ID number of existing records is specified.  If it is `FDBIDNEXT', the number greater by one than the maximum ID number of existing records is specified.</p><p>`<em>num</em>' specifies the additional value.</p><p>If successful, the return value is the summation value, else, it is Not-a-Number.</p><p>If the corresponding record exists, the value is treated as a real number and is added to.  If no record corresponds, a new record of the additional value is stored.</p><p>The function `tcfdbsync' is used in order to synchronize updated contents of a fixed-length database object with the file and the device.</p><p><strong>bool tcfdbsync(TCFDB *</strong><em>fdb</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>If successful, the return value is true, else, it is false.</p><p>This function is useful when another process connects to the same database file.</p><p>The function `tcfdboptimize' is used in order to optimize the file of a fixed-length database object.</p><p><strong>bool tcfdboptimize(TCFDB *</strong><em>fdb</em><strong>, int32_t </strong><em>width</em><strong>, int64_t </strong><em>limsiz</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>`<em>width</em>' specifies the width of the value of each record.  If it is not more than 0, the current setting is not changed.</p><p>`<em>limsiz</em>' specifies the limit size of the database file.  If it is not more than 0, the current setting is not changed.</p><p>If successful, the return value is true, else, it is false.</p><p>The function `tcfdbvanish' is used in order to remove all records of a fixed-length database object.</p><p><strong>bool tcfdbvanish(TCFDB *</strong><em>fdb</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>If successful, the return value is true, else, it is false.</p><p>The function `tcfdbcopy' is used in order to copy the database file of a fixed-length database object.</p><p><strong>bool tcfdbcopy(TCFDB *</strong><em>fdb</em><strong>, const char *</strong><em>path</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>`<em>path</em>' specifies the path of the destination file.  If it begins with `@', the trailing substring is executed as a command line.</p><p>If successful, the return value is true, else, it is false.  False is returned if the executed command returns non-zero code.</p><p>The database file is assured to be kept synchronized and not modified while the copying or executing operation is in progress.  So, this function is useful to create a backup file of the database file.</p><p>The function `tcfdbtranbegin' is used in order to begin the transaction of a fixed-length database object.</p><p><strong>bool tcfdbtranbegin(TCFDB *</strong><em>fdb</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>If successful, the return value is true, else, it is false.</p><p>The database is locked by the thread while the transaction so that only one transaction can be activated with a database object at the same time.  Thus, the serializable isolation level is assumed if every database operation is performed in the transaction.  All updated regions are kept track of by write ahead logging while the transaction.  If the database is closed during transaction, the transaction is aborted implicitly.</p><p>The function `tcfdbtrancommit' is used in order to commit the transaction of a fixed-length database object.</p><p><strong>bool tcfdbtrancommit(TCFDB *</strong><em>fdb</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>If successful, the return value is true, else, it is false.</p><p>Update in the transaction is fixed when it is committed successfully.</p><p>The function `tcfdbtranabort' is used in order to abort the transaction of a fixed-length database object.</p><p><strong>bool tcfdbtranabort(TCFDB *</strong><em>fdb</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object connected as a writer.</p><p>If successful, the return value is true, else, it is false.</p><p>Update in the transaction is discarded when it is aborted.  The state of the database is rollbacked to before transaction.</p><p>The function `tcfdbpath' is used in order to get the file path of a fixed-length database object.</p><p><strong>const char *tcfdbpath(TCFDB *</strong><em>fdb</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>The return value is the path of the database file or `NULL' if the object does not connect to any database file.</p><p>The function `tcfdbrnum' is used in order to get the number of records of a fixed-length database object.</p><p><strong>uint64_t tcfdbrnum(TCFDB *</strong><em>fdb</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>The return value is the number of records or 0 if the object does not connect to any database file.</p><p>The function `tcfdbfsiz' is used in order to get the size of the database file of a fixed-length database object.</p><p><strong>uint64_t tcfdbfsiz(TCFDB *</strong><em>fdb</em><strong>);</strong></p><p>`<em>fdb</em>' specifies the fixed-length database object.</p><p>The return value is the size of the database file or 0 if the object does not connect to any database file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO tcfdb&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/tcftest.1.html"><strong>tcftest</strong>(1)</a>, <a href="../man1/tcfmttest.1.html"><strong>tcfmttest</strong>(1)</a>, <a href="../man1/tcfmgr.1.html"><strong>tcfmgr</strong>(1)</a>, <a href="../man3/tokyocabinet.3.html"><strong>tokyocabinet</strong>(3)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="tcdrain.3.html"><span aria-hidden="true">&larr;</span> tcdrain.3: Get and set terminal attributes, line control, get and set baud rate</a></li>
   <li class="next"><a href="tcflow.3.html">tcflow.3: Get and set terminal attributes, line control, get and set baud rate <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
