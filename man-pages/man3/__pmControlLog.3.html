<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>__pmControlLog: Enable, disable or enquire about logging of performance metrics</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Enable, disable or enquire about logging of performance metrics">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="__pmControlLog (3) manual">
  <meta name="twitter:description" content="Enable, disable or enquire about logging of performance metrics">
  <meta name="twitter:image" content="https://www.carta.tech/images/libpcp3-dev-__pmControlLog-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/__pmControlLog.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="__pmControlLog (3) manual" />
  <meta property="og:description" content="Enable, disable or enquire about logging of performance metrics" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libpcp3-dev-__pmControlLog-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">__pmControlLog<small> (3)</small></h1>
        <p class="lead">Enable, disable or enquire about logging of performance metrics</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/__pmControlLog.3.html">
      <span itemprop="name">__pmControlLog: Enable, disable or enquire about logging of performance metrics</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libpcp3-dev/">
      <span itemprop="name">libpcp3-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/__pmControlLog.3.html">
      <span itemprop="name">__pmControlLog: Enable, disable or enquire about logging of performance metrics</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">C SYNOPSIS</h2>
        <div class="sectioncontent">
<p>#include &lt;pcp/pmapi.h&gt;</p><p>#include &lt;pcp/impl.h&gt;</p><p>int __pmControlLog(int <em>fd</em>, const pmResult *<em>request</em>, int&nbsp;<em>control</em>, int&nbsp;<em>state</em>, int&nbsp;<em>delta</em>, pmResult&nbsp;**<em>status</em>);</p><p>cc ... -lpcp</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>__pmControlLog</strong> may be used to enable or disable the archive logging for particular performance metrics, as identified by the <em>request</em> parameter; see <a href="../man3/pmFetch.3.html"><strong>pmFetch</strong>(3)</a> for an explanation of the structure.</p><p>The application must have previously issued a call to <a href="../man3/__pmConnectLogger.3.html"><strong>__pmConnectLogger</strong>(3)</a> to establish a control-port connection to the <a href="../man1/pmlogger.1.html"><strong>pmlogger</strong>(1)</a> instance to whom the control request is to be directed, and <em>fd</em> (the result from <a href="../man3/__pmConnectLogger.3.html"><strong>__pmConnectLogger</strong>(3)</a>) identifies this connection.</p><p>Within <em>request</em>, only the details of the performance metrics and their associated instances will be used, i.e. the values of the metrics, if any, will be ignored. <em>request</em> would typically be constructed as the result of an earlier call to <a href="../man3/pmFetch.3.html"><strong>pmFetch</strong>(3)</a>. For metrics with a singular value (having an instance domain of <strong>PM_INDOM_NULL</strong>) the corresponding should have the value one in the field and <strong>PM_IN_NULL</strong> as the field of the single supplied. If multiple explicit instances are to be logged, the field of the should contain the number of instances supplied and the fields of the structures should contain specific instance identifiers (which may not have the reserved value <strong>PM_IN_NULL</strong>).</p><p>If the field within any of the structures in <em>request</em> has a value of zero, it indicates that all available instances of the metric should be used.  Enumeration of the instance domain is deferred until the logger fetches the metric prior to writing it to the log, rather than being performed when the <strong>__pmControlLog</strong> request is received.  This is useful for metrics with instance domains that change over time.  It is an error to specify equal to zero if the corresponding metric has a singular value (no instance domain).</p><p>There are several sorts of logging control available, namely mandatory or advisory, as defined by the <em>control</em> argument, and on, off or maybe as defined by the <em>state</em> argument. These different types of control may be used to ensure that some performance metrics can be guaranteed to always be in the log, while others may be dynamically enabled or disabled as determined by the level and type of system activity.</p><p>The actual action to be performed is defined by the combination of <em>control</em> and <em>state</em> as follows. If <em>control</em> is <strong>PM_LOG_MANDATORY</strong> and <em>state</em> is <strong>PM_LOG_ON</strong>, then logging is enabled. If <em>control</em> is <strong>PM_LOG_MANDATORY</strong> and <em>state</em> is <strong>PM_LOG_OFF</strong>, then logging is disabled. If <em>control</em> is <strong>PM_LOG_MANDATORY</strong> and <em>state</em> is <strong>PM_LOG_MAYBE</strong>, then subsequent advisory controls will be honored.  If the logging state prior to the request was mandatory (on or off), the state is changed to advisory off. If the logging state was already advisory (either on or off), it remains unchanged.  If <em>control</em> is <strong>PM_LOG_ADVISORY</strong> and the last mandatory control for the metric was <strong>PM_LOG_MAYBE</strong>, then logging is enabled or disabled as specified by the <em>state</em> argument, i.e. <strong>PM_LOG_ON</strong> or <strong>PM_LOG_OFF</strong>. When the arguments <em>state</em> and <em>control</em> specify a request to change the logging behavior, the argument <em>delta</em> defines the logging interval in milliseconds to be applied to all metrics and instances identified in <em>request</em>.</p><p>The result argument <em>status</em> returns the current logging state for each of the nominated performance metrics.  There is a 1:1 correspondence between the elements of <em>request</em> and <em>status.</em> For metrics in <em>request</em> that have with equal to zero, the corresponding in <em>result</em> will contain a value for each available instance at the time of the call.  Each metric value in <em>status</em> will have the current logging state encoded in it.  The detailed outcome of the operation for each metric can be determined by comparing these values to that requested via <em>control</em>, <em>state</em> and <em>delta</em>.</p><p>Macros defined in <strong>&lt;pcp/impl.h&gt;</strong> may be used to extract the state and logging interval from the returned metric values. <strong>PMLC_GET_ON</strong> returns true if logging is on, or false if it is off; <strong>PMLC_GET_MAND</strong> returns true if logging is mandatory, or false if it is advisory; <strong>PMLC_GET_INLOG</strong> returns true if the metric has been logged at least once, or false otherwise; <strong>PMLC_GET_AVAIL</strong> returns true if the metric was available from its source the last time it was supposed to be logged, or false if it was unavailable; and <strong>PMLC_GET_DELTA</strong> returns the current logging interval for the metric (in milliseconds). <strong>PMLC_MAX_DELTA</strong> defines the greatest <em>delta</em> that can be returned in an encoded metric value.</p><p>As a special case, when <em>control</em> is <strong>PM_LOG_ENQUIRE</strong>, <em>state</em> and <em>delta</em> are ignored, and <em>status</em> returns the current logging state of the nominated performance metrics (this variant makes no changes to the logging state).</p><p>If the value of the logging interval is 0, either for <em>delta</em> in a request to change state to <strong>PM_LOG_ON</strong>, or encoded in the value returned from <strong>PM_LOG_ENQUIRE</strong>, then this corresponds to the special ``once only'' logging of metrics that appear once in the archive log, and are never logged again.</p><p><strong>__pmControlLog</strong> returns zero on success.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTE</h2>
        <div class="sectioncontent">
<p>This routine is not thread-safe as there is no serialization on the use of the communication channel between the sending of the request and receiving the reply. It is assumed that the caller is single-threaded, which is true for the only current user of this routine, namely <a href="../man1/pmlc.1.html"><strong>pmlc</strong>(1)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO __pmControlLog&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/pmlc.1.html"><strong>pmlc</strong>(1)</a>, <a href="../man1/pmlogger.1.html"><strong>pmlogger</strong>(1)</a>, <a href="../man3/PMAPI.3.html"><strong>PMAPI</strong>(3)</a>, <a href="../man3/pmFetch.3.html"><strong>pmFetch</strong>(3)</a> and <a href="../man3/__pmConnectLogger.3.html"><strong>__pmConnectLogger</strong>(3)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <strong>PM_ERR_TOOSMALL</strong>
  </dt>
  <dd>
    <p>The number of metrics in <em>request</em> is less than one.</p>
  </dd>
  <dt>
    <strong>PM_ERR_VALUE</strong>
  </dt>
  <dd>
    <p>One or more of the in <em>request</em> had (the number of instances) less than one.</p>
  </dd>
  <dt>
    <strong>EINVAL</strong>
  </dt>
  <dd>
    <p>An invalid combination of <em>control</em> and <em>state</em> was specified, or <em>delta</em> was negative.</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="__pmConnectLogger.3.html"><span aria-hidden="true">&larr;</span> __pmConnectLogger.3: Connect to a performance metrics logger control port</a></li>
   <li class="next"><a href="__pmConvertTime.3.html">__pmConvertTime.3: Convert tm structure to timeval structure <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
