<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>File::Tee: Replicate data sent to a perl stream</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Replicate data sent to a perl stream">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="File::Tee (3pm) manual">
  <meta name="twitter:description" content="Replicate data sent to a perl stream">
  <meta name="twitter:image" content="https://www.carta.tech/images/libfile-tee-perl-File::Tee-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/File::Tee.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="File::Tee (3pm) manual" />
  <meta property="og:description" content="Replicate data sent to a perl stream" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libfile-tee-perl-File::Tee-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">File::Tee<small> (3pm)</small></h1>
        <p class="lead">Replicate data sent to a perl stream</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/File::Tee.3pm.html">
      <span itemprop="name">File::Tee: Replicate data sent to a perl stream</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libfile-tee-perl/">
      <span itemprop="name">libfile-tee-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/File::Tee.3pm.html">
      <span itemprop="name">File::Tee: Replicate data sent to a perl stream</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use File::Tee qw(tee);

  # simple usage:
  tee(STDOUT, &apos;&gt;&apos;, &apos;stdout.txt&apos;);

  print "hello world&#92;n";
  system "ls";

  # advanced usage:
  my $pid = tee STDERR, { prefix =&gt; "err[$$]: ", reopen =&gt; &apos;my.log&apos;};

  print STDERR "foo&#92;n";
  system("cat /bad/path");
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This module is able to replicate data written to a Perl stream into another streams. It is the Perl equivalent of the shell utility <em>tee</em>\|(1).</p><p>It is implemented around \*(C`fork\*(C', creating a new process for every tee'ed stream. That way, there are no problems handling the output generated by external programs run with system or by \s-1XS\s0 modules that don't go through perlio.</p><h3>\s-1API\s0</h3>
<p>The following function can be imported from this module: redirects a copy of the data written to $fh to one or several files or streams. \*(C`$target, ...\*(C' is a list of target streams specifications that can be:</p><ul>
<li><p>file names with optional mode specifications:   tee STDOUT, &apos;&gt;&gt; /tmp/out&apos;, &apos;&gt;&gt; /tmp/out2&apos;;   tee STDOUT, &apos;&gt;&gt;&apos;, &apos;/tmp/out&apos;, &apos;/tmp/out2&apos;; If the mode specification is a separate argument, it will affect all the file names following and not just the nearest one. If mode \*(C`|-\*(C' is used as a separate argument, the rest of the arguments are slurped as arguments for the pipe command:    tee STDERR, &apos;|-&apos;, &apos;grep&apos;, &apos;-i&apos;, &apos;error&apos;;    tee STDERR, &apos;| grep -i error&apos;; # equivalent Valid modes are \*(C`&gt;\*(C', \*(C`&gt;&gt;\*(C', \*(C`&gt;&\*(C', \*(C`&gt;&gt;&\*(C' and \*(C`|-\*(C'. The default mode is \*(C`&gt;&gt;\*(C'. File handles can also be used as targets:    open my $target1, &apos;&gt;&gt;&apos;, &apos;/foo/bar&apos;;    ...    tee STDOUT, $target1, $target2, ...; Finally, code references can also be used as targets. The callback will be invoked for every line written to the tee'ed stream with the data in $_. It has to return a true value on success or false if some error happens. Also, note that the callback will be called from a different process.</p></li><li><p>hash references describing the targets For instance:   tee STDOUT, { mode =&gt; &apos;&gt;&gt;&apos;, open =&gt; &apos;/tmp/foo&apos;, lock =&gt; 1}; will copy the data sent to \s-1STDOUT\s0 to \*(C`/tmp/foo\*(C'. The attributes that can be included inside the hash are:</p><p>sets the target file or stream. It can contain a mode specification and also be an array. For instance:   tee STDOUT, { open =&gt; &apos;&gt;&gt; /tmp/out&apos; };   tee STDOUT, { reopen =&gt; [&apos;&gt;&gt;&apos;, &apos;/tmp/out2&apos;] };   tee STDOUT, { open =&gt; &apos;| grep foo &gt; /tmp/out&apos; }; If \*(C`reopen\*(C' is used, the file or stream is reopen for every write operation. The mode will be forced to append after the first write. Alternative way to specify the mode to open the target file or stream When true, an exclusive lock is obtained on the target file before writing to it. Some text to be prepended to every line sent to the target file. For instance:   tee STDOUT, { prefix =&gt; &apos;OUT: &apos;, lock =&gt; 1, mode =&gt; &apos;&gt;&gt;&apos;, open =&gt; &apos;/tmp/out.txt&apos; };   tee STDERR, { prefix =&gt; &apos;ERR: &apos;, lock =&gt; 1, mode =&gt; &apos;&gt;&gt;&apos;, open =&gt; &apos;/tmp/out.txt&apos; };</p>
<dl class='dl-vertical'>
  <dt>
    preprocess =&gt; sub { ... }
  </dt>
  <dd>
    <p>A callback function that can modify the data before it gets sent to the target file. For instance:   sub hexdump {     my $data = shift;     my @out;     while ($data =~ /(.{1,32})/smg) {         my $line=$1;         my @c= (( map { sprintf "%02x",$_ } unpack(&apos;C*&apos;, $line)),                 (("  ") x 32))[0..31];         $line=~s/(.)/ my $c=$1; unpack("c",$c)&gt;=32 ? $c : &apos;.&apos; /egms;         push @out, join(" ", @c, &apos;|&apos;, $line), "&#92;n";     }     join(&apos;&apos;, @out);   }</p><p>  tee BINFH, { preprocess =&gt; &#92;&hexdump, open =&gt; &apos;/tmp/hexout&apos;}; Sets autoflush mode for the target streams. Default is on. By default, when writing to the targets, any error will close the tee'ed handle. This option allows one to change that behaviour.</p>
  </dd>
  <dt>
    process =&gt; sub { ... }
  </dt>
  <dd>
    <p>the callback will be called for every line read (see using code references as targets discussion above). This option can not be used at the same time as most other options (open, reopen, lock, autoflush, etc.).</p>
  </dd>
  <dt>
    begin =&gt; sub { ... }
  </dt>
  <dd>
    
  </dd>
  <dt>
    end =&gt; sub { ... }
  </dt>
  <dd>
    <p>Those functions are called on the forked process before the first write and when closing the handle respectively. For instance:   my @capture;   tee STDERR, { process =&gt; sub { push @capture, $_ },                 end =&gt; sub { send_mail &apos;foo@bar.com&apos;, &apos;stderr capture&apos;, "@capture" } };</p>
  </dd>

</dl>
</li>
</ul><p>The function returns the \s-1PID\s0 for the newly created process. Inside the \*(C`tee\*(C' pipe process created, data is read honouring the input record separator $/. You could also want to set the tee'ed stream in autoflush mode:   open $fh, ...;</p><p>  my $oldsel = select $fh;   $| = 1;   select $fh;</p><p>  tee $fh, "&gt; /tmp/log";</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Does not work on Windows (patches welcome).</p><p>Send bug reports by email or via the \s-1CPAN\s0 \s-1RT\s0 web &lt;https://rt.cpan.org&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO File::Tee&hellip;</h2>
        <div class="sectioncontent">
<p>IO::Capture</p><p>IO::Tee is a similar module implemented around tied file handles. Tee allows one to launch external processes capturing their output to some files. IO::CaptureOutput allows one to capture the output generated from a child process or a subroutine.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT AND LICENSE</h2>
        <div class="sectioncontent">
<p>Copyright (C) 2007, 2008, 2010, 2011 by Salvador Fandin\*~o (sfandino@yahoo.com)</p><p>This library is free software; you can redistribute it and/or modify it under the same terms as Perl itself, either Perl version 5.8.8 or, at your option, any later version of Perl 5 you may have available.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="File::Tail.3pm.html"><span aria-hidden="true">&larr;</span> File::Tail.3pm: Perl extension for reading from continuously updated files</a></li>
   <li class="next"><a href="File::Type::WebImages.3pm.html">File::Type::WebImages.3pm: Determine web image file types using magic <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
