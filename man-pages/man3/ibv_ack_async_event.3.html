<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ibv_ack_async_event: Get or acknowledge asynchronous events</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Get or acknowledge asynchronous events">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="ibv_ack_async_event (3) manual">
  <meta name="twitter:description" content="Get or acknowledge asynchronous events">
  <meta name="twitter:image" content="https://www.carta.tech/images/libibverbs-dev-ibv_ack_async_event-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/ibv_ack_async_event.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ibv_ack_async_event (3) manual" />
  <meta property="og:description" content="Get or acknowledge asynchronous events" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libibverbs-dev-ibv_ack_async_event-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">ibv_ack_async_event<small> (3)</small></h1>
        <p class="lead">Get or acknowledge asynchronous events</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/ibv_ack_async_event.3.html">
      <span itemprop="name">ibv_ack_async_event: Get or acknowledge asynchronous events</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libibverbs-dev/">
      <span itemprop="name">libibverbs-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/ibv_ack_async_event.3.html">
      <span itemprop="name">ibv_ack_async_event: Get or acknowledge asynchronous events</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>#include &lt;infiniband/verbs.h&gt;</strong>

<strong>int ibv_get_async_event(struct ibv_context </strong><em>*context</em><strong>,</strong>
<strong>                        struct ibv_async_event </strong><em>*event</em><strong>);</strong>

<strong>void ibv_ack_async_event(struct ibv_async_event </strong><em>*event</em><strong>);</strong>
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>ibv_get_async_event()</strong> waits for the next async event of the RDMA device context <em>context</em> and returns it through the pointer <em>event</em>, which is an ibv_async_event struct, as defined in &lt;infiniband/verbs.h&gt;.</p>
<pre>
struct ibv_async_event {
union {
struct ibv_cq  *cq;             /* CQ that got the event */
struct ibv_qp  *qp;             /* QP that got the event */
struct ibv_srq *srq;            /* SRQ that got the event */
int             port_num;       /* port number that got the event */
} element;
enum ibv_event_type     event_type;     /* type of the event */
};
</pre>
<p>One member of the element union will be valid, depending on the event_type member of the structure.  event_type will be one of the following events:</p><p><em>QP events:</em></p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>IBV_EVENT_QP_FATAL </strong> Error occurred on a QP and it transitioned to error state</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>IBV_EVENT_QP_REQ_ERR </strong> Invalid Request Local Work Queue Error</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>IBV_EVENT_QP_ACCESS_ERR </strong> Local access violation error</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>IBV_EVENT_COMM_EST </strong> Communication was established on a QP</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>IBV_EVENT_SQ_DRAINED </strong> Send Queue was drained of outstanding messages in progress</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>IBV_EVENT_PATH_MIG </strong> A connection has migrated to the alternate path</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>IBV_EVENT_PATH_MIG_ERR </strong> A connection failed to migrate to the alternate path</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>IBV_EVENT_QP_LAST_WQE_REACHED </strong> Last WQE Reached on a QP associated with an SRQ</p>
  </dt>
  <dd>
    
  </dd>

</dl>
<p><em>CQ events:</em></p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>IBV_EVENT_CQ_ERR </strong> CQ is in error (CQ overrun)</p>
  </dt>
  <dd>
    
  </dd>

</dl>
<p><em>SRQ events:</em></p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>IBV_EVENT_SRQ_ERR </strong> Error occurred on an SRQ</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>IBV_EVENT_SRQ_LIMIT_REACHED </strong> SRQ limit was reached</p>
  </dt>
  <dd>
    
  </dd>

</dl>
<p><em>Port events:</em></p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>IBV_EVENT_PORT_ACTIVE </strong> Link became active on a port</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>IBV_EVENT_PORT_ERR </strong> Link became unavailable on a port</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>IBV_EVENT_LID_CHANGE </strong> LID was changed on a port</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>IBV_EVENT_PKEY_CHANGE </strong> P_Key table was changed on a port</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>IBV_EVENT_SM_CHANGE </strong> SM was changed on a port</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>IBV_EVENT_CLIENT_REREGISTER </strong> SM sent a CLIENT_REREGISTER request to a port</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>IBV_EVENT_GID_CHANGE </strong> GID table was changed on a port</p>
  </dt>
  <dd>
    
  </dd>

</dl>
<p><em>CA events:</em></p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>IBV_EVENT_DEVICE_FATAL </strong> CA is in FATAL state</p>
  </dt>
  <dd>
    
  </dd>

</dl>
<p><strong>ibv_ack_async_event()</strong> acknowledge the async event <em>event</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p><strong>ibv_get_async_event()</strong> returns 0 on success, and -1 on error.</p><p><strong>ibv_ack_async_event()</strong> returns no value.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>All async events that <strong>ibv_get_async_event()</strong> returns must be acknowledged using <strong>ibv_ack_async_event()</strong>. To avoid races, destroying an object (CQ, SRQ or QP) will wait for all affiliated events for the object to be acknowledged; this avoids an application retrieving an affiliated event after the corresponding object has already been destroyed.</p><p><strong>ibv_get_async_event()</strong> is a blocking function.  If multiple threads call this function simultaneously, then when an async event occurs, only one thread will receive it, and it is not possible to predict which thread will receive it.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>The following code example demonstrates one possible way to work with async events in non-blocking mode. It performs the following steps:</p><p>1. Set the async events queue work mode to be non-blocked</p><p>2. Poll the queue until it has an async event</p><p>3. Get the async event and ack it</p>
<pre>
/* change the blocking mode of the async event queue */
flags = fcntl(ctx-&gt;async_fd, F_GETFL);
rc = fcntl(ctx-&gt;async_fd, F_SETFL, flags | O_NONBLOCK);
if (rc &lt; 0) {
        fprintf(stderr, "Failed to change file descriptor of async event queue&#92;n");
        return 1;
}

/*
 * poll the queue until it has an event and sleep ms_timeout
 * milliseconds between any iteration
 */
my_pollfd.fd      = ctx-&gt;async_fd;
my_pollfd.events  = POLLIN;
my_pollfd.revents = 0;

do {
        rc = poll(&my_pollfd, 1, ms_timeout);
} while (rc == 0);
if (rc &lt; 0) {
        fprintf(stderr, "poll failed&#92;n");
        return 1;
}

/* Get the async event */
if (ibv_get_async_event(ctx, &async_event)) {
        fprintf(stderr, "Failed to get async_event&#92;n");
        return 1;
}

/* Ack the event */
ibv_ack_async_event(&async_event);

</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO ibv_ack_async_event&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man3/ibv_open_device.3.html"><strong>ibv_open_device</strong>(3)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>Dotan Barak &lt;dotanba@gmail.com&gt;</p>
  </dt>
  <dd>
    
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="ibnd_iter_nodes.3.html"><span aria-hidden="true">&larr;</span> ibnd_iter_nodes.3: Given a fabric object and a function itterate over the nodes in the fabric.</a></li>
   <li class="next"><a href="ibv_ack_cq_events.3.html">ibv_ack_cq_events.3: Get and acknowledge completion queue (cq) events <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
