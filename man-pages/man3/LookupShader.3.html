<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>LookupShader: Specify shading lookup tables</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Specify shading lookup tables">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="LookupShader (3) manual">
  <meta name="twitter:description" content="Specify shading lookup tables">
  <meta name="twitter:image" content="https://www.carta.tech/images/libvolpack1-dev-LookupShader-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/LookupShader.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="LookupShader (3) manual" />
  <meta property="og:description" content="Specify shading lookup tables" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libvolpack1-dev-LookupShader-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">LookupShader<small> (3)</small></h1>
        <p class="lead">Specify shading lookup tables</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/LookupShader.3.html">
      <span itemprop="name">LookupShader: Specify shading lookup tables</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libvolpack1-dev/">
      <span itemprop="name">libvolpack1-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/LookupShader.3.html">
      <span itemprop="name">LookupShader: Specify shading lookup tables</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>#include &lt;volpack.h&gt;</p><p>&#92;$1 <strong>vpSetLookupShader(</strong><em>vpc, color_channels, num_materials,</em> color_field, color_table, color_table_size, weight_field, weight_table, weight_table_size<strong>)</strong></p><ul>
<li><p>vpContext *<em>vpc;</em> int <em>color_channels, num_materials;</em> int <em>color_field;</em> float *<em>color_table;</em> int <em>color_table_size;</em> int <em>weight_field;</em> float *<em>weight_table;</em> int <em>weight_table_size;</em></p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ARGUMENTS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <em>vpc</em>
  </dt>
  <dd>
    <p>VolPack context from <strong>vpCreateContext.</strong></p>
  </dd>
  <dt>
    <em>color_channels</em>
  </dt>
  <dd>
    <p>The number of color channels per pixel (1 or 3).</p>
  </dd>
  <dt>
    <em>num_materials</em>
  </dt>
  <dd>
    <p>The number of material types.</p>
  </dd>
  <dt>
    <em>color_field</em>
  </dt>
  <dd>
    <p>Field number for voxel field containing color lookup table index.</p>
  </dd>
  <dt>
    <em>color_table</em>
  </dt>
  <dd>
    <p>Color lookup table.</p>
  </dd>
  <dt>
    <em>color_table_size</em>
  </dt>
  <dd>
    <p>Size of color lookup table in bytes.</p>
  </dd>
  <dt>
    <em>weight_field</em>
  </dt>
  <dd>
    <p>Field number for voxel field containing material weight lookup table index.</p>
  </dd>
  <dt>
    <em>weight_table</em>
  </dt>
  <dd>
    <p>Material weight lookup table.</p>
  </dd>
  <dt>
    <em>weight_table_size</em>
  </dt>
  <dd>
    <p>Size of material weight lookup table in bytes.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>vpSetLookupShader</strong> is used to specify lookup tables that define a shading function.  The lookup-table shading algorithm provided by VolPack is designed to support the following shading model.  Each voxel is assumed to contain a mixture of some set of basic material types.  Each material type has its own shading parameters for the Phong shading equation (for example, the diffuse color components and the shinyness).  The color of a voxel is found by computing a color for each material type and then combining the colors in proportion to the fraction of each material in the voxel.  The shading model also supports directional (infinite-distance) light sources.</p><p>This shading model is implemented using lookup tables.  The tables can be precomputed so that the shading equation does not have to be evaluated for every voxel.  VolPack provides routines to compute the lookup tables (see <strong>vpShadeTable</strong>(3)).  The lookup tables can also be used to implement other shading models by using a user-supplied routine to compute the contents of the tables.  See <strong>vpSetDepthCueing</strong>(3) for information about depth cueing.</p><p>It is also possible to define a callback function that will be called to shade each voxel during rendering, instead of using a lookup table. This method allows more general shading models but slows down rendering.  To define a callback shader, call <strong>vpSetCallback</strong> with the VP_GRAY_SHADE_FUNC or VP_RGB_SHADE_FUNC option code (see <strong>vpSetCallback</strong>(3)).  The lookup tables are used if the last successful call to <strong>vpSetLookupShader</strong> occurred after the last successful call to <strong>vpSetCallback</strong> with one of the VP_*_SHADE_FUNC options.</p><p>The <em>color_channels</em> argument determines whether the shading table will contain grayscale (1 channel) or RGB (3 channel) pixels.  The <em>num_materials</em> argument specifies the number of basic material types out of which each voxel can be composed (at least 1).  The <em>color_table</em> and <em>weight_table</em> arguments specify two lookup tables, and the <em>color_field</em> and <em>weight_field</em> arguments specify two voxel fields that are used to index the tables.  The size of the <em>color_table</em> array must be:</p><ul>
<li><p>float <em>color_table[n][num_materials][color_channels];</em></p></li>
</ul><p>where <em>n</em> is the number of possible values in the <em>color_field</em> field of the voxel (the maximum value plus one). The size of the <em>weight_table</em> argument must be: float <em>weight_table[m][num_materials];</em> where <em>m</em> is the number of possible values in the <em>weight_field</em> field of the voxel (the maximum value plus one). If there is only one material then <em>weight_table</em> is not used and may be a NULL pointer.</p><p>During rendering the shading lookup tables are accessed as follows. Suppose a particular voxel to be shaded has the value <em>color_index</em> in the field specified by <em>color_field</em> and the value <em>weight_index</em> in the field specified by <em>weight_field</em>. For each material number <em>material_index,</em> a weighted color is computed from the formula: color =\kx color_table[color_index][material_index] *</p><p>\h'\nxu' weight_table[weight_index][material_index] Then the weighted colors for each material type are added up to give the voxel color.  If <em>color_table</em> contains RGB values then each component is treated separately using the above formula.  If there is only one material type then the constant 1.0 is substituted for the <em>weight_table</em> value.</p><p>The suggested way to use the tables is as follows.  The voxel field specified by <em>color_field</em> should contain an encoded surface normal vector; this should be the same field as the <em>norm_field</em> argument to <strong>vpVolumeNormals</strong> or <strong>vpClassifyScalars</strong>.  In the <em>color_table</em> array, for each possible encoded surface normal (the <em>color</em> index) and material type (the <em>material</em> index) the array should contain the color of the material given the current viewing direction and lighting arrangement.  The color is independent of the voxel location because the light sources are assumed to be infinitely distant.  The function <strong>vpShadeTable</strong> initializes the contents of <em>color_table</em> in this way.</p><p>The voxel field specified by <em>weight_field</em> should contain some quantity that determines the material composition of the voxel.  For example, a field containing the scalar value could be used.  In the <em>weight_table</em> array, for each possible value of <em>weight_field</em> there should be one row of material occupancy fractions.  Each entry should be a number in the range 0.0-1.0 that specifies the fraction of the voxel occupied by the corresponding material.  For example, if there are two material types and a voxel's <em>weight_field</em> contains the value 62, then <em>weight_table</em>[62][0] gives the fraction of the voxel occupied by material 0, and <em>weight_table</em>[62][1] gives the fraction of the voxel occupied by material 1.  Normally, the numbers in a given row of <em>weight_table</em> should add up to 1.0 (although special effects can be achieved by bending the rules).  The function <strong>vpRamp</strong> is useful for initializing the weight table with piece-wise linear ramps.</p><p>The values in the shading lookup tables may be initialized before or after calling <strong>vpSetLookupShader.</strong>  Typically <strong>vpSetLookupShader</strong> is called once at the beginning of a rendering session, and then the values in the shading tables are modified as the user changes the lighting and shading parameters or the viewing direction.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">STATE VARIABLES</h2>
        <div class="sectioncontent">
<p>Information about the current shading table parameters can be retrieved with the following state variable codes (see <strong>vpGeti</strong>(3)): VP_COLOR_CHANNELS, VP_SHADE_COLOR_TABLE, VP_SHADE_COLOR_SIZE, VP_SHADE_WEIGHT_TABLE, VP_SHADE_WEIGHT_SIZE, VP_SHADE_COLOR_FIELD, VP_SHADE_WEIGHT_FIELD, VP_MATERIAL_COUNT</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">
<p>The normal return value is VP_OK.  The following error return values are possible:</p>
<dl class='dl-vertical'>
  <dt>
    VPERROR_BAD_VALUE
  </dt>
  <dd>
    <p>One or more of the arguments has an invalid value or is out of range.</p>
  </dd>
  <dt>
    VPERROR_LIMIT_EXCEEDED
  </dt>
  <dd>
    <p>The <em>num_materials</em> argument has exceeded an internal limit. Change the value of VP_MAX_MATERIAL in volpack.h and recompile the VolPack library.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO LookupShader&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man3/VolPack.3.html"><strong>VolPack</strong>(3)</a>, <strong>vpCreateContext</strong>(3), <strong>vpShadeTable</strong>(3), <strong>vpSetCallback</strong>(3), <strong>vpRamp</strong>(3), <strong>vpVolumeNormals</strong>(3), <strong>vpClassifyScalars</strong>(3), <strong>vpSetDepthCueing</strong>(3)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Load.3.html"><span aria-hidden="true">&larr;</span> Load.3: Load volume data structures from a file</a></li>
   <li class="next"><a href="MAPISTORE_ERROR.3.html">MAPISTORE_ERROR.3: This header provides a set of result codes for mapistore function calls. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
