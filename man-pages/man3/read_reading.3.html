<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>read_reading: Read a trace file into a read structure.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Read a trace file into a read structure.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="read_reading (3) manual">
  <meta name="twitter:description" content="Read a trace file into a read structure.">
  <meta name="twitter:image" content="https://www.carta.tech/images/libstaden-read-dev-read_reading-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/read_reading.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="read_reading (3) manual" />
  <meta property="og:description" content="Read a trace file into a read structure." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libstaden-read-dev-read_reading-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">read_reading<small> (3)</small></h1>
        <p class="lead">Read a trace file into a read structure.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/read_reading.3.html">
      <span itemprop="name">read_reading: Read a trace file into a read structure.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libstaden-read-dev/">
      <span itemprop="name">libstaden-read-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/read_reading.3.html">
      <span itemprop="name">read_reading: Read a trace file into a read structure.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
#include &lt;Read.h&gt;

Read *read_reading(
	char *filename,
	int format);
</pre>

<pre>
Read *fread_reading(
	FILE *fp,
	char *filename,
	int format);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>These functions read trace files into a <strong>Read</strong> structure. A variety of formats are supported including ABI, ALF and SCF. (Note that the first two are only supported when the library is used as part of the Staden Package.) Additionally, support for reading the plain (old) staden format files and Experiment files is included. Compressed trace files may also be read. Decompression is performed using either <strong>gzip -d</strong> or <strong>uncompress</strong> and is written to a temporary file for further processing. The temporary file is then read and removed.</p><p>When reading an experiment file the trace file referenced by the LN and LT line types is read. The QL, QR (left and right quality clips), SL and SR (left and right vector clips) are taken from the Experiment file to produce the cutoff information held within the <strong>Read</strong> structure. The <strong>orig_trace</strong> field of the <strong>Read</strong> structure will then contain the pointer to the experiment file structure and the <strong>orig_trace_format</strong> field will be set to <strong>TT_EXP</strong>.</p><p>The functions allocate a <strong>Read</strong> structure which is returned. To deallocate this structure use the <strong>read_deallocate()</strong> function.</p><p><strong>read_reading()</strong> reads a trace from the specified filename and format. Formats available are <strong>TT_SCF</strong>, <strong>TT_ABI</strong>, <strong>TT_ALF</strong>, <strong>TT_PLN</strong>, <strong>TT_EXP</strong>and <strong>TT_ANY</strong>. Specifying format <strong>TT_ANY</strong> will attempt to automatically detect the corret format type by analysing the trace file for magic numbers and composition. The <strong>format</strong> field of the structure can then be used to determine the real trace type.</p><p><strong>fread_reading()</strong> reads a trace from the specified file pointer. The filename argument is used for setting the <strong>trace_name</strong> field of the resulting structure, and for error messages. Otherwise the function is identical to the <strong>read_reading()</strong> function.</p><p>The <strong>Read</strong> structure itself is as follows.</p>
<pre>
typedef uint_2 TRACE;        /* for trace heights */

typedef struct
{
    int         format;      /* Trace file format */
    char       *trace_name;  /* Trace file name   */

    int         NPoints;     /* No. of points of data */
    int         NBases;      /* No. of bases          */

    /* Traces */
    TRACE      *traceA;      /* Array of length `NPoints' */
    TRACE      *traceC;      /* Array of length `NPoints' */
    TRACE      *traceG;      /* Array of length `NPoints' */
    TRACE      *traceT;      /* Array of length `NPoints' */
    TRACE       maxTraceVal; /* The maximal value in any trace */

    /* Bases */
    char       *base;        /* Array of length `NBases' */
    uint_2     *basePos;     /* Array of length `NBases' */

    /* Cutoffs */
    int         leftCutoff;  /* Number of unwanted bases */
    int         rightCutoff; /* Number of unwanted bases */

    /* Miscellaneous Sequence Information */
    char       *info;        /* misc seq info, eg comments */

    /* Probability information */
    char       *prob_A;      /* Array of length 'NBases' */
    char       *prob_C;      /* Array of length 'NBases' */
    char       *prob_G;      /* Array of length 'NBases' */
    char       *prob_T;      /* Array of length 'NBases' */

    /* The original input format data, or NULL if inapplicable */
    int orig_trace_format;
    void *orig_trace;

} Read;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUES</h2>
        <div class="sectioncontent">
<p>On successful completion, the <strong>read_reading()</strong> and <strong>fread_reading()</strong> functions return a pointer to a <strong>Read</strong> structure. Otherwise these functions return NULLRead (which is a null pointer).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO read_reading&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man3/write_reading.3.html"><strong>write_reading</strong>(3)</a>, <a href="../man3/fwrite_reading.3.html"><strong>fwrite_reading</strong>(3)</a>, <strong>deallocate_reading</strong>(3), <strong>scf</strong>(4),</p><p><strong>ExperimentFile</strong>(4)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="read_premib_configs.3.html"><span aria-hidden="true">&larr;</span> read_premib_configs.3: Netsnmp_config_api functions</a></li>
   <li class="next"><a href="read_scf.3.html">read_scf.3: Read scf files <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
