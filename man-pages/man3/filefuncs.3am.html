<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>filefuncs: Provide some file related functionality to gawk</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Provide some file related functionality to gawk">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="filefuncs (3am) manual">
  <meta name="twitter:description" content="Provide some file related functionality to gawk">
  <meta name="twitter:image" content="https://www.carta.tech/images/gawk-filefuncs-3am.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3am/filefuncs.3am.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="filefuncs (3am) manual" />
  <meta property="og:description" content="Provide some file related functionality to gawk" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/gawk-filefuncs-3am.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">filefuncs<small> (3am)</small></h1>
        <p class="lead">Provide some file related functionality to gawk</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3am/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3am/filefuncs.3am.html">
      <span itemprop="name">filefuncs: Provide some file related functionality to gawk</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/gawk/">
      <span itemprop="name">gawk</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3am/filefuncs.3am.html">
      <span itemprop="name">filefuncs: Provide some file related functionality to gawk</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>@load "filefuncs"</p><p>result = chdir("/some/directory")</p><p>result = stat("/some/path", statdata [, follow])</p><p>flags = or(FTS_PHYSICAL, ...)</p><p>result = fts(pathlist, flags, filedata)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <em>filefuncs</em> extension adds several functions that provide access to file-related facilities.</p><h3>chdir()</h3>
<p>The <strong>chdir()</strong> function is a direct hook to the <a href="../man2/chdir.2.html"><strong>chdir</strong>(2)</a> system call to change the current directory. It returns zero upon success or less than zero upon error. In the latter case it updates <strong>ERRNO</strong>.</p>
<h3>stat()</h3>
<p>The <strong>stat()</strong> function provides a hook into the <a href="../man2/stat.2.html"><strong>stat</strong>(2)</a> system call. It returns zero upon success or less than zero upon error. In the latter case it updates <strong>ERRNO</strong>. By default, it uses <a href="../man2/lstat.2.html"><strong>lstat</strong>(2)</a>. However, if passed a third argument, it uses <a href="../man2/stat.2.html"><strong>stat</strong>(2)</a>, instead.</p><p>In all cases, it clears the <strong>statdata</strong> array. When the call is successful, <strong>stat()</strong> fills the <strong>statdata</strong> array with information retrieved from the filesystem, as follows:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>statdata["name"]</strong></p>
  </dt>
  <dd>
    <p>The name of the file.</p>
  </dd>
  <dt>
    <p><strong>statdata["dev"]</strong></p>
  </dt>
  <dd>
    <p>Corresponds to the <em>st_dev</em> field in the <em>struct stat</em>.</p>
  </dd>
  <dt>
    <p><strong>statdata["ino"]</strong></p>
  </dt>
  <dd>
    <p>Corresponds to the <em>st_ino</em> field in the <em>struct stat</em>.</p>
  </dd>
  <dt>
    <p><strong>statdata["mode"]</strong></p>
  </dt>
  <dd>
    <p>Corresponds to the <em>st_mode</em> field in the <em>struct stat</em>.</p>
  </dd>
  <dt>
    <p><strong>statdata["nlink"]</strong></p>
  </dt>
  <dd>
    <p>Corresponds to the <em>st_nlink</em> field in the <em>struct stat</em>.</p>
  </dd>
  <dt>
    <p><strong>statdata["uid"]</strong></p>
  </dt>
  <dd>
    <p>Corresponds to the <em>st_uid</em> field in the <em>struct stat</em>.</p>
  </dd>
  <dt>
    <p><strong>statdata["gid"]</strong></p>
  </dt>
  <dd>
    <p>Corresponds to the <em>st_gid</em> field in the <em>struct stat</em>.</p>
  </dd>
  <dt>
    <p><strong>statdata["size"]</strong></p>
  </dt>
  <dd>
    <p>Corresponds to the <em>st_size</em> field in the <em>struct stat</em>.</p>
  </dd>
  <dt>
    <p><strong>statdata["atime"]</strong></p>
  </dt>
  <dd>
    <p>Corresponds to the <em>st_atime</em> field in the <em>struct stat</em>.</p>
  </dd>
  <dt>
    <p><strong>statdata["mtime"]</strong></p>
  </dt>
  <dd>
    <p>Corresponds to the <em>st_mtime</em> field in the <em>struct stat</em>.</p>
  </dd>
  <dt>
    <p><strong>statdata["ctime"]</strong></p>
  </dt>
  <dd>
    <p>Corresponds to the <em>st_ctime</em> field in the <em>struct stat</em>.</p>
  </dd>
  <dt>
    <p><strong>statdata["rdev"]</strong></p>
  </dt>
  <dd>
    <p>Corresponds to the <em>st_rdev</em> field in the <em>struct stat</em>. This element is only present for device files.</p>
  </dd>
  <dt>
    <p><strong>statdata["major"]</strong></p>
  </dt>
  <dd>
    <p>Corresponds to the <em>st_major</em> field in the <em>struct stat</em>. This element is only present for device files.</p>
  </dd>
  <dt>
    <p><strong>statdata["minor"]</strong></p>
  </dt>
  <dd>
    <p>Corresponds to the <em>st_minor</em> field in the <em>struct stat</em>. This element is only present for device files.</p>
  </dd>
  <dt>
    <p><strong>statdata["blksize"]</strong></p>
  </dt>
  <dd>
    <p>Corresponds to the <em>st_blksize</em> field in the <em>struct stat</em>, if this field is present on your system. (It is present on all modern systems that we know of.)</p>
  </dd>
  <dt>
    <p><strong>statdata["pmode"]</strong></p>
  </dt>
  <dd>
    <p>A human-readable version of the mode value, such as printed by <em>ls</em>(1). For example, <strong>"-rwxr-xr-x"</strong>.</p>
  </dd>
  <dt>
    <p><strong>statdata["linkval"]</strong></p>
  </dt>
  <dd>
    <p>If the named file is a symbolic link, this element will exist and its value is the value of the symbolic link (where the symbolic link points to).</p>
  </dd>
  <dt>
    <p><strong>statdata["type"]</strong></p>
  </dt>
  <dd>
    <p>The type of the file as a string. One of <strong>"file"</strong>, <strong>"blockdev"</strong>, <strong>"chardev"</strong>, <strong>"directory"</strong>, <strong>"socket"</strong>, <strong>"fifo"</strong>, <strong>"symlink"</strong>, <strong>"door"</strong>, or <strong>"unknown"</strong>. Not all systems support all file types.</p>
  </dd>

</dl>

<h3>fts()</h3>
<p>The <strong>fts()</strong> function provides a hook to the <a href="../man3/fts.3.html"><strong>fts</strong>(3)</a> set of routines for traversing file heirarchies. Instead of returning data about one file at a time in a stream, it fills in a multi-dimensional array with data about each file and directory encountered in the requested heirarchies.</p><p>The arguments are as follows:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>pathlist</strong></p>
  </dt>
  <dd>
    <p>An array of filenames.  The element values are used; the index values are ignored.</p>
  </dd>
  <dt>
    <p><strong>flags</strong></p>
  </dt>
  <dd>
    <p>This should be the bitwise OR of one or more of the following predefined flag values.  At least one of <strong>FTS_LOGICAL</strong> or <strong>FTS_PHYSICAL</strong> must be provided; otherwise <strong>fts()</strong> returns an error value and sets <strong>ERRNO</strong>.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>FTS_LOGICAL</strong></p>
  </dt>
  <dd>
    <p>Do a ``logical'' file traversal, where the information returned for a symbolic link refers to the linked-to file, and not to the symbolic link itself. This flag is mutually exclusive with <strong>FTS_PHYSICAL</strong>.</p>
  </dd>
  <dt>
    <p><strong>FTS_PHYSICAL</strong></p>
  </dt>
  <dd>
    <p>Do a ``physical'' file traversal, where the information returned for a symbolic link refers to the symbolic link itself. This flag is mutually exclusive with <strong>FTS_LOGICAL</strong>.</p>
  </dd>
  <dt>
    <p><strong>FTS_NOCHDIR</strong></p>
  </dt>
  <dd>
    <p>As a performance optimization, the <a href="../man3/fts.3.html"><strong>fts</strong>(3)</a> routines change directory as they traverse a file heirarchy. This flag disables that optimization.</p>
  </dd>
  <dt>
    <p><strong>FTS_COMFOLLOW</strong></p>
  </dt>
  <dd>
    <p>Immediatly follow a symbolic link named in <strong>pathlist</strong>, whether or not <strong>FTS_LOGICAL</strong> is set.</p>
  </dd>
  <dt>
    <p><strong>FTS_SEEDOT</strong></p>
  </dt>
  <dd>
    <p>By default, the <a href="../man3/fts.3.html"><strong>fts</strong>(3)</a> routines do not return entries for ``.'' and ``..''. This option causes entries for ``..'' to also be included. (The AWK extension always includes an entry for ``.'', see below.)</p>
  </dd>
  <dt>
    <p><strong>FTS_XDEV</strong></p>
  </dt>
  <dd>
    <p>During a traversal, do not cross onto a different mounted filesystem.</p>
  </dd>

</dl>

  </dd>
  <dt>
    <p><strong>filedata</strong></p>
  </dt>
  <dd>
    <p>The <strong>filedata</strong> array is first cleared. Then, <strong>fts()</strong> creates an element in <strong>filedata</strong> for every element in <strong>pathlist</strong>. The index is the name of the directory or file given in <strong>pathlist</strong>. The element for this index is itself an array. There are two cases.</p>
<dl class='dl-vertical'>
  <dt>
    <p>The path is a file.</p>
  </dt>
  <dd>
    <p>In this case, the array contains two or three elements:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>"path"</strong></p>
  </dt>
  <dd>
    <p>The full path to this file, starting from the ``root'' that was given in the <strong>pathlist</strong> array.</p>
  </dd>
  <dt>
    <p><strong>"stat"</strong></p>
  </dt>
  <dd>
    <p>This element is itself an array, containing the same information as provided by the <strong>stat()</strong> function described earlier for its <strong>statdata</strong> argument. The element may not be present if <a href="../man2/stat.2.html"><strong>stat</strong>(2)</a> for the file failed.</p>
  </dd>
  <dt>
    <p><strong>"error"</strong></p>
  </dt>
  <dd>
    <p>If some kind of error was encountered, the array will also contain an element named <strong>"error"</strong>, which is a string describing the error.</p>
  </dd>

</dl>

  </dd>
  <dt>
    <p>The path is a directory.</p>
  </dt>
  <dd>
    <p>In this case, the array contains one element for each entry in the directory. If an entry is a file, that element is as for files, just described. If the entry is a directory, that element is (recursively), an array describing the subdirectory. If <strong>FTS_SEEDOT</strong> was provided in the flags, then there will also be an element named <strong>".."</strong>.  This element will be an array containing the data as provided by <strong>stat()</strong>.</p><p>In addition, there will be an element whose index is <strong>"."</strong>. This element is an array containing the same two or three elements as for a file: <strong>"path"</strong>, <strong>"stat"</strong>, and <strong>"error"</strong>.</p>
  </dd>

</dl>

  </dd>

</dl>
<p>The <strong>fts()</strong> function returns 0 if there were no errors. Otherwise it returns -1.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>The AWK <strong>fts()</strong> extension does not exactly mimic the interface of the <a href="../man3/fts.3.html"><strong>fts</strong>(3)</a> routines, choosing instead to provide an interface that is based on associative arrays, which should be more comfortable to use from an AWK program.  This includes the lack of a comparison function, since <em>gawk</em> already provides powerful array sorting facilities.  While an <em>fts_read()</em>-like interface could have been provided, this felt less natural than simply creating a multi-dimensional array to represent the file heirarchy and its information.</p><p>Nothing prevents AWK code from changing the predefined <strong>FTS_</strong><em>xx</em> values, but doing so is may cause strange results when the changed values are passed to <strong>fts()</strong>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>There are many more file-related functions for which AWK interfaces would be desirable.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>See <strong>test/fts.awk</strong> in the <em>gawk</em> distribution for an example.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO filefuncs&hellip;</h2>
        <div class="sectioncontent">
<p><em>GAWK: Effective AWK Programming</em>, <em>fnmatch</em>(3am), <em>fork</em>(3am), <em>inplace</em>(3am), <em>ordchr</em>(3am), <em>readdir</em>(3am), <em>readfile</em>(3am), <em>revoutput</em>(3am), <em>rwarray</em>(3am), <em>time</em>(3am).</p><p><a href="../man2/chdir.2.html"><strong>chdir</strong>(2)</a>, <a href="../man3/fts.3.html"><strong>fts</strong>(3)</a>, <a href="../man2/stat.2.html"><strong>stat</strong>(2)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Arnold Robbins, <strong>arnold@skeeve.com</strong>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYING PERMISSIONS</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2012, 2013, Free Software Foundation, Inc.</p><p>Permission is granted to make and distribute verbatim copies of this manual page provided the copyright notice and this permission notice are preserved on all copies.</p><p>Permission is granted to copy and distribute modified versions of this manual page under the conditions for verbatim copying, provided that the entire resulting derived work is distributed under the terms of a permission notice identical to this one.</p><p>Permission is granted to copy and distribute translations of this manual page into another language, under the above conditions for modified versions, except that this permission notice may be stated in a translation approved by the Foundation.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="next"><a href="fnmatch.3am.html">fnmatch.3am: Compare a string against a filename wildcard <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
