<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Schedule::RateLimiter: Prevent events from happening too quickly.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Prevent events from happening too quickly.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Schedule::RateLimiter (3pm) manual">
  <meta name="twitter:description" content="Prevent events from happening too quickly.">
  <meta name="twitter:image" content="https://www.carta.tech/images/libschedule-ratelimiter-perl-Schedule::RateLimiter-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Schedule::RateLimiter.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Schedule::RateLimiter (3pm) manual" />
  <meta property="og:description" content="Prevent events from happening too quickly." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libschedule-ratelimiter-perl-Schedule::RateLimiter-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Schedule::RateLimiter<small> (3pm)</small></h1>
        <p class="lead">Prevent events from happening too quickly.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Schedule::RateLimiter.3pm.html">
      <span itemprop="name">Schedule::RateLimiter: Prevent events from happening too quickly.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libschedule-ratelimiter-perl/">
      <span itemprop="name">libschedule-ratelimiter-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Schedule::RateLimiter.3pm.html">
      <span itemprop="name">Schedule::RateLimiter: Prevent events from happening too quickly.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use Schedule::RateLimiter;

  # Don&apos;t let this event happen more than 5 times in a 60 second period.
  my $throttle = Schedule::RateLimiter-&gt;new ( iterations =&gt; 5,
                                      seconds    =&gt; 60 );

  # Cycle forever, but not too fast.
  while ( 1 ) {
      $throttle-&gt;event();
      &do_something;
  }
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This module provides a way to voluntarily restrict how many times a given action may take place within a specified time frame.  Such a tool may be useful if you have written something which periodically polls some public resource and want to ensure that you do not overburden that resource with too many requests.</p><p>Initially, one might think that solving this problem would be as simple as sleeping for the number of seconds divided by the number of iterations in between each event.  However, that would only be correct if the event took no time at all.</p><p>If you know exactly how much time each event is going to take then you could build an even more complicated one-liner such as this:</p><p>  sleep( (seconds / iterations) - single_event_time )</p><p>This module is intended to address the other cases when the exact run-time of each event is unknown and variable.  This module will try very hard to allow an event to happen as many times as possible without exceeding the specified bounds.</p><p>For example, suppose you want to write something that checks an 'incoming' directory once a minute for files and then does something with those files if it finds any.  If it takes you two seconds to process those files, then you want to wait 58 seconds before polling the directory again.  If it takes 30 seconds to process those files, then you only want to wait 30 seconds.  And if it takes 3 minutes, then you want to poll the directory again immediately as soon as you are done.</p><p>  my $throttle = Schedule::RateLimiter-&gt;new ( seconds =&gt; 60 );   &poll_and_process while ( $throttle-&gt;event );</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>Creates and returns a new Schedule::RateLimiter object.</p><p>The constructor takes up to three parameters:</p><ul>
<li><p>block (default: true) This parameter accepts a true or false value to set the default \*(L"block\*(R" behavior on future calls to <em>event()</em>.  It makes it more convenient to turn blocking off for an entire object at a time.</p></li><li><p>iterations (default: 1) This specifies the number of times an event may take place within the given time period.  This must be a positive, non-zero integer.</p></li><li><p>seconds (required) This specifies the minimum number of seconds that must transpire before we will allow (iterations + 1) events to happen.  A value of 0 disables throttling. You may specify fractional time periods.</p></li>
</ul><p><strong>example</strong>:</p><p>  my $throttle = Schedule::RateLimiter-&gt;new ( iterations =&gt; 2,                                       seconds    =&gt; 10 );</p><p>  # Event 1   $throttle-&gt;event();   # Event 2   $throttle-&gt;event();   # Event 3   $throttle-&gt;event();   # 10 seconds will have transpired since event 1 at this point.   # Event 4   $throttle-&gt;event();   # 10 seconds will have transpired since event 2 at this point. Called to signal the beginning of an event.  This method will return true or false to indicate if it is ok to proceed with the event.  This method uses Time::HiRes to do its calculations and sleeping, so the precision of this method will be the same as the precision of Time::HiRes on your platform.</p><p>Takes one (optional) parameter:</p><ul>
<li><p>block (default: true) If set to a false value, this method will do a non-blocking check to see if it is ok for the event to occur.  If it is not ok, this method will return a false value and assume that the event did not take place.  Otherwise, this method will return a true value and assume that the event did take place.</p></li>
</ul><p><strong>example</strong>:</p><p>  # Stop when the code moves too fast.   while ( 1 ) {       if ($throttle-&gt;event( block =&gt; 0 )) {           &do_something;       } else {           die &apos;I went too fast!&apos;;       }   }</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>This module needs to keep a record of when every iteration took place, so if you are allowing a large number of iterations to happen in the given time period, this could potentially use a lot of memory.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">KNOWN ISSUES</h2>
        <div class="sectioncontent">
<p>If you have multiple iterations that typically happen very quickly, and you want to limit them in a long period of time, they will \*(L"clump\*(R" together.  That is, they all happen at just about the same time, and then the system waits for a long period before doing the same \*(L"clump\*(R" again.  That's just the nature of the best-fit algorithm.  Anything that is done to try to separate single events with longer waits than necessary will potentially create a sub-optimal situation if an event in the future takes longer than expected.  If you really want all of your events to start at even time periods apart from each other, then set the number of iterations to 1 and adjust the number of seconds accordingly.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Daniel J. Wright, &lt;wright@pair.com&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Schedule::RateLimiter&hellip;</h2>
        <div class="sectioncontent">
<p>The \s-1POE\s0 module provides a more heavyweight solution to this problem as well.</p><p>perl.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Schedule::At.3pm.html"><span aria-hidden="true">&larr;</span> Schedule::At.3pm: Os independent interface to the unix 'at' command</a></li>
   <li class="next"><a href="Scope::Guard.3pm.html">Scope::Guard.3pm: Lexically-scoped resource management <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
