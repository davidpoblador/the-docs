<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TM::MapSphere: Topic maps, trait for a hierarchical tm repository</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Topic maps, trait for a hierarchical tm repository">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="TM::MapSphere (3pm) manual">
  <meta name="twitter:description" content="Topic maps, trait for a hierarchical tm repository">
  <meta name="twitter:image" content="https://www.carta.tech/images/libtm-perl-TM::MapSphere-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/TM::MapSphere.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="TM::MapSphere (3pm) manual" />
  <meta property="og:description" content="Topic maps, trait for a hierarchical tm repository" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libtm-perl-TM::MapSphere-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">TM::MapSphere<small> (3pm)</small></h1>
        <p class="lead">Topic maps, trait for a hierarchical tm repository</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/TM::MapSphere.3pm.html">
      <span itemprop="name">TM::MapSphere: Topic maps, trait for a hierarchical tm repository</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libtm-perl/">
      <span itemprop="name">libtm-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/TM::MapSphere.3pm.html">
      <span itemprop="name">TM::MapSphere: Topic maps, trait for a hierarchical tm repository</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    # construct an adhoc-ish map sphere

    use TM;
    my $tm = new TM;                            # create a map

    use Class::Trait;
    Class::Trait-&gt;apply ($tm, &apos;TM::MapSphere&apos;); # make it a sphere

    $tm-&gt;mount (&apos;/abc/&apos; =&gt; new TM);             # mount a map into location /abc/
    # this creates a topic in the map with a reference to another (empty) map

    # any subclass of TM can used
    $tm-&gt;mount (&apos;/def/&apos; =&gt; new TM::Materialized::AsTMa (file =&gt; &apos;test.atm&apos;));

    # check a mount point
    warn "damn" unless $tm-&gt;is_mounted (&apos;/xxx/&apos;);

    # do some sync stuff on any resource-connected map
    $tm-&gt;is_mounted (&apos;/def/&apos;)-&gt;sync_in;

    # get rid of some mount point
    $tm-&gt;umount (&apos;/abc/&apos;);

    $tm-&gt;internalize (&apos;aaa&apos;);         # it is a map, so all map methods work
    print $tm-&gt;mids (&apos;def&apos;);          # this topic exists and should be a map
    # find all child maps
    @maps = $tm-&gt;instances  (&#92; TM::PSI-&gt;TOPICMAP);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This package provides a <em>mapspheric</em> trait, i.e. all functionality to convert any map into a (hierarchical) Topic Maps database. The basic idea is that one map (the <em>root</em>) contains not only arbitrary map data, but can also contain references to other maps. On the top level, addressed as \*(C`/\*(C' is then the root map. The child maps have addresses such as \*(C`/abc/\*(C' and \*(C`/internet/web/browsers/\*(C'. The idea is also that a map can contain other maps, simply by having topics which stand for these child maps. In that sense, a map is always a tree of maps (hence <em>MapSphere</em>).</p><p>These trees are not necessarily static. At any point, a new map can be hooked in, or removed. This process is quite similar to <em>mounting</em> devices into a \s-1UNIX\s0 file system.</p><p>Each of the referenced child maps is represented as a topic of a predefined type \*(C`TM::PSI::TOPICMAP\*(C', the subject indicator is interpreted as the \s-1URL\s0 to the resources for these maps.</p><p>The root map can be any subclass of \s-1TM\s0. You can therefore choose to have only a shortlived mapsphere which will be lost on process termination, or alternatively, to take one of the persistent storages. Also, the individual child maps can be of different provenances. Any subclass of \s-1TM\s0 will do, consequently also any which have the trait of TM::ResourceAble or TM::Synchronizable. This implies that this database can be heterogenuous, in that different maps can be stored differently, or can even be kept remotely.</p><p>Once you have your map sphere, you can write it out via synchronization with the external resources. You can do this for the whole sphere, or for a particular subtree of maps. Conversely, you can read in the whole map sphere by starting with the root and letting the system to recursively bootstrap the whole sphere.</p><h3>Tau Objects</h3>
<p>Map spheres can only store <em>Tau objects</em>. At the moment, these are only maps. See \s-1TM::PSI\s0 for predefined things.</p>
<h3>Namespace</h3>
<p>To address a particular object in a repository we follow a convention similar to file system paths: Every object has a path like</p><p>  /something/complete/else/</p><p>Note, that all paths for maps should start and end with a \*(C`/\*(C', so that maps can be seen as <em>directories</em>. All other objects (constraints, queries, ...) are represented as topics.</p><p>The namespace cannot have <em>holes</em>, so that the following will result in an error:</p><p>   $tm-&gt;mount (&apos;/something/&apos;, ...);    $tm-&gt;mount (&apos;/something/completely/else/&apos;, ....);  # we will die here</p>
<h3>Map Meta Data</h3>
<p>Since a map sphere behaves like a map, any meta data about child maps should be modelled according to the \s-1TM\s0 paradigm.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INTERFACE</h2>
        <div class="sectioncontent">
<p>This interface allows to <em>mount</em> and <em>unmount</em> other maps into another.</p><h3>Methods</h3>

<dl class='dl-vertical'>
  <dt>
    <strong>mount</strong>
  </dt>
  <dd>
    <p><em></em><strong>$tm</strong><em></em>-&gt;mount (<em></em><strong>$path</strong><em></em> =&gt; <em></em><strong>$tm2</strong><em></em>, [ $force ]) This mounts a map $tm2 into the map sphere at the given path. Only maps can be mounted, everything else results in an error. The root will be always mounted to the map sphere itself.  It is an error to try to change this. If the mount point is already taken, an exception will be raised. This can be suppressed when the \*(C`force\*(C' parameter is set:    $tm-&gt;mount (&apos;/xyz/&apos; =&gt; $child, 1); A topic of type \*(C`topicmap\*(C' (see \s-1TM::PSI\s0) is created in the map above the mount point. The base \s-1URI\s0 of the map is used as subject address. If the mounted map has a resource \s-1URL\s0 that is used as subject indicator (identifier in TMDM-speak). Additionally, the topic gets asserted characteristics:</p><p>A \s-1MIME\s0 type occurrence of type \*(C`http://tm.devc.at/mapsphere/mime\*(C' which is a string value.</p>
<dl class='dl-vertical'>
  <dt>
    created
  </dt>
  <dd>
    <p>An occurrence of type \*(C`http://tm.devc.at/mapsphere/created\*(C' carrying the \s-1UNIX\s0 time at mounting time.</p>
  </dd>

</dl>
<p>Maps can only be mounted into other maps if these already are also mounted. The following code will not work:    my $tm = new SomeMapSphere;    $tm-&gt;mount (&apos;/abc/def/&apos; =&gt; ....);   # die here because there is no map mounted to /abc/ yet</p>
  </dd>
  <dt>
    <strong>umount</strong>
  </dt>
  <dd>
    <p><em></em><strong>$tm</strong><em></em>-&gt;umount (<em></em><strong>$path</strong><em></em>) This unmounts a map from the object map. Obviously, the path must point to an existing topic of type \*(C`topicmap\*(C'. All maps beyond this mount point are removed, i.e. also all children will go down the drain. The root cannot be unmounted.</p>
  </dd>
  <dt>
    <strong>is_mounted</strong>
  </dt>
  <dd>
    <p><em></em><strong>$child</strong><em></em> = <em></em><strong>$tm</strong><em></em>-&gt;is_mounted (<em></em><strong>$path</strong><em></em>) Simply returns a map object mounted on that given mount point. \*(C`undef\*(C' if there is none.</p>
  </dd>
  <dt>
    <strong>mounttab</strong>
  </dt>
  <dd>
    <p>%mt = %{ <em></em><strong>$tm</strong><em></em>-&gt;mounttab } <em></em><strong>$tm</strong><em></em>-&gt;mounttab ( &#92; <em>$%mt</em> ) This accessor sets/gets the mount table. <strong>Note</strong>: You will hardly need access directly to it, normally, and changing it in an uncontrolled way may corrupt the whole data structure. The reason it exists, though, is that sometimes you <strong>have</strong> to indicate that there is a change, such as when using this together with \s-1MLDBM\s0. This, for example, does \s-1NOT\s0 work:   {    my $tm = new ...MapSphericalClassUsingMLDBM...;    ...    $tm-&gt;is_mounted (&apos;/whatever/&apos;)-&gt;sync_in;    # A: now the child is happily sync&apos;ed in    # but MLDBM did not realize it, so it is not written back into the    # underlying file    }   {    # regain the MLDBM based MapSphere later    my $tm = new ...MapSphericalClassUsingMLDBM...;    # child is not sync&apos;ed in as under A: above    } This does work:   {    my $tm = new ...MapSphericalClassUsingMLDBM...;    ...    my $mt = $tm-&gt;mounttab;    $tm-&gt;is_mounted (&apos;/whatever/&apos;)-&gt;sync_in;    $tm-&gt;mounttab ($mt);    # now the changes will be written onto the MLDBM file    } Of course, more thought can be spent on <em>how much</em> actually has to be written back. Above approach may be wasteful.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Robert Barta, &lt;drrho@cpan.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT AND LICENSE</h2>
        <div class="sectioncontent">
<p>Copyright (C) 200[4-7] by Robert Barta</p><p>This library is free software; you can redistribute it and/or modify it under the same terms as Perl itself, either Perl version 5.8.4 or, at your option, any later version of Perl 5 you may have available.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="TM::Literal.3pm.html"><span aria-hidden="true">&larr;</span> TM::Literal.3pm: Topic maps, simple values (literals)</a></li>
   <li class="next"><a href="TM::Materialized::AsTMa.3pm.html">TM::Materialized::AsTMa.3pm: Topic maps, parsing of astma instances. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
