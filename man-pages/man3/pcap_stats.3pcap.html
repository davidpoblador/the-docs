<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pcap_stats: Get capture statistics</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Get capture statistics">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="pcap_stats (3pcap) manual">
  <meta name="twitter:description" content="Get capture statistics">
  <meta name="twitter:image" content="https://www.carta.tech/images/libpcap0.8-dev-pcap_stats-3pcap.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pcap/pcap_stats.3pcap.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="pcap_stats (3pcap) manual" />
  <meta property="og:description" content="Get capture statistics" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libpcap0.8-dev-pcap_stats-3pcap.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pcap_stats<small> (3pcap)</small></h1>
        <p class="lead">Get capture statistics</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pcap/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pcap/pcap_stats.3pcap.html">
      <span itemprop="name">pcap_stats: Get capture statistics</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libpcap0.8-dev/">
      <span itemprop="name">libpcap0.8-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pcap/pcap_stats.3pcap.html">
      <span itemprop="name">pcap_stats: Get capture statistics</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
#include &lt;pcap/pcap.h&gt;

int pcap_stats(pcap_t *p, struct pcap_stat *ps);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>pcap_stats()</strong> fills in the <strong>struct pcap_stat</strong> pointed to by its second argument.  The values represent packet statistics from the start of the run to the time of the call.</p><p><strong>pcap_stats()</strong> is supported only on live captures, not on ``savefiles''; no statistics are stored in ``savefiles'', so no statistics are available when reading from a ``savefile''.</p><p>A <strong>struct pcap_stat</strong> has the following members:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>ps_recv</strong></p>
  </dt>
  <dd>
    <p>number of packets received;</p>
  </dd>
  <dt>
    <p><strong>ps_drop</strong></p>
  </dt>
  <dd>
    <p>number of packets dropped because there was no room in the operating system's buffer when they arrived, because packets weren't being read fast enough;</p>
  </dd>
  <dt>
    <p><strong>ps_ifdrop</strong></p>
  </dt>
  <dd>
    <p>number of packets dropped by the network interface or its driver.</p>
  </dd>

</dl>
<p>The statistics do not behave the same way on all platforms. <strong>ps_recv</strong> might count packets whether they passed any filter set with <strong>pcap_setfilter</strong>(3PCAP) or not, or it might count only packets that pass the filter. It also might, or might not, count packets dropped because there was no room in the operating system's buffer when they arrived. <strong>ps_drop</strong> is not available on all platforms; it is zero on platforms where it's not available.  If packet filtering is done in libpcap, rather than in the operating system, it would count packets that don't pass the filter. Both <strong>ps_recv</strong> and <strong>ps_drop</strong> might, or might not, count packets not yet read from the operating system and thus not yet seen by the application. <strong>ps_ifdrop</strong> might, or might not, be implemented; if it's zero, that might mean that no packets were dropped by the interface, or it might mean that the statistic is unavailable, so it should not be treated as an indication that the interface did not drop any packets.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p><strong>pcap_stats()</strong> returns 0 on success and returns -1 if there is an error or if <em>p</em> doesn't support packet statistics. If -1 is returned, <strong>pcap_geterr()</strong> or <strong>pcap_perror()</strong> may be called with <em>p</em> as an argument to fetch or display the error text.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO pcap_stats&hellip;</h2>
        <div class="sectioncontent">
<p>pcap(3PCAP), pcap_geterr(3PCAP)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pcap_snapshot.3pcap.html"><span aria-hidden="true">&larr;</span> pcap_snapshot.3pcap: Get the snapshot length</a></li>
   <li class="next"><a href="pcap_statustostr.3pcap.html">pcap_statustostr.3pcap: Convert a pcap_error_ or pcap_warning_ value to a string <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
