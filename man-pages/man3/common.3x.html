<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>common: Common- common functions used in other examples libafterimage/tutorials/common.h</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Common- common functions used in other examples libafterimage/tutorials/common.h">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="common (3x) manual">
  <meta name="twitter:description" content="Common- common functions used in other examples libafterimage/tutorials/common.h">
  <meta name="twitter:image" content="https://www.carta.tech/images/libafterimage-dev-common-3x.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3x/common.3x.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="common (3x) manual" />
  <meta property="og:description" content="Common- common functions used in other examples libafterimage/tutorials/common.h" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libafterimage-dev-common-3x.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">common<small> (3x)</small></h1>
        <p class="lead">Common- common functions used in other examples libafterimage/tutorials/common.h</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3x/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3x/common.3x.html">
      <span itemprop="name">common: Common- common functions used in other examples libafterimage/tutorials/common.h</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libafterimage-dev/">
      <span itemprop="name">libafterimage-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3x/common.3x.html">
      <span itemprop="name">common: Common- common functions used in other examples libafterimage/tutorials/common.h</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>Generic Xlib related functionality, common for all the tutorials.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO common&hellip;</h2>
        <div class="sectioncontent">
<p>libAfterImage, ASView, ASScale, ASTile, ASMerge, ASGrad, ASFlip, ASText libAfterImage/tutorials/_XA_WM_DELETE_WINDOW</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NAME_XA_WM_DELETE_WINDOW</h2>
        <div class="sectioncontent">

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>_XA_WM_DELETE_WINDOW - stores value of X Atom "WM_DELETE_WINDOW".</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>In X all client's top level windows are managed by window manager. That includes moving, resizing, decorating, focusing and closing of windows. Interactions between window manager and client window are governed by ICCCM specification. All the parts of this specification are completely optional, but it is recommended that the following minimum set of hints be supplied for any client window: Window's title(WM_NAME), iconified window title(WM_ICON_NAME), class hint (WM_CLASS) and supported protocols (WM_PROTOCOLS). It is recommended also that WM_DELETE_WINDOW protocol be supported, as otherwise there are no way to safely close client window, but to kill it. All of the above mentioned hints are identified by atoms that have standard preset values, except for WM_DELETE_WINDOW. As the result we need to obtain WM_DELETE_WINDOW atoms ID explicitly. We use _XA_WM_DELETE_WINDOW to store the ID of that atom, so it is accessible anywhere from our application.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SOURCE</h2>
        <div class="sectioncontent">
<p>Atom _XA_WM_DELETE_WINDOW = None;</p><p>libAfterImage/tutorials/create_top_level_window()</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NAMEcreate_top_level_window()</h2>
        <div class="sectioncontent">

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>Window create_top_level_window( ASVisual *asv, Window root,</p>
<pre>
                                int x, int y,
                                unsigned int width,
                                unsigned int height,
                                unsigned int border_width,
                                unsigned long attr_mask,
                                XSetWindowAttributes *attr,
                                char *app_class );
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INPUTS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    asv
  </dt>
  <dd>
    <p>- pointer to valid preinitialized ASVisual structure.</p>
  </dd>
  <dt>
    root
  </dt>
  <dd>
    <p>- root window of the screen on which to create window.</p>
  </dd>
  <dt>
    x,
  </dt>
  <dd>
    <p>y - desired position of the window</p>
  </dd>
  <dt>
    width,
  </dt>
  <dd>
    <p>height - desired window size.</p>
  </dd>
  <dt>
    border_width
  </dt>
  <dd>
    <p>- desired initial border width of the window (may not have any effect due to Window Manager intervention.</p>
  </dd>
  <dt>
    attr_mask
  </dt>
  <dd>
    <p>- mask of the attributes that has to be set on the window</p>
  </dd>
  <dt>
    attr
  </dt>
  <dd>
    <p>- values of the attributes to be set.</p>
  </dd>
  <dt>
    app_class
  </dt>
  <dd>
    <p>- title of the application to be used as its window Title and resources class.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>ID of the created window.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>create_top_level_window() is autyomating process of creating top level application window. It creates window for specified ASVisual, and then sets up basic ICCCM hints for that window, such as WM_NAME, WM_ICON_NAME, WM_CLASS and WM_PROTOCOLS.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SOURCE</h2>
        <div class="sectioncontent">
<p>Window create_top_level_window( ASVisual *asv, Window root, int x, int y,</p>
<pre>
                         unsigned int width, unsigned int height,
                         unsigned int border_width,
                         unsigned long attr_mask,
                         XSetWindowAttributes *attr,
                         const char *app_class, const char *app_name )
</pre>
<p>{</p>
<pre>
    Window w = None;
</pre>
<p>#ifndef X_DISPLAY_MISSING</p>
<pre>
    char *tmp ;
    XTextProperty name;
    XClassHint class1;
</pre>

<pre>
    w = create_visual_window(asv, root, x, y, width, height, border_width,
                             InputOutput, attr_mask, attr );
</pre>

<pre>
    tmp = (app_name==NULL)?(char*)get_application_name():(char*)app_name;
    XStringListToTextProperty (&tmp, 1, &name);
</pre>

<pre>
    class1.res_name = tmp;  /* for future use */
    class1.res_class = (char*)app_class;
    XSetWMProtocols (asv-&gt;dpy, w, &_XA_WM_DELETE_WINDOW, 1);
    XSetWMProperties (asv-&gt;dpy, w, &name, &name, NULL, 0, NULL, NULL, &class1);
    /* final cleanup */
    XFree ((char *) name.value);
</pre>
<p>#endif /* X_DISPLAY_MISSING */</p>
<pre>
    return w;
</pre>
<p>}</p><p>libAfterImage/tutorials/set_window_background_and_free()</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NAMEset_window_background_and_free()</h2>
        <div class="sectioncontent">

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>Pixmap set_window_background_and_free( Window w, Pixmap p );</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INPUTS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    w
  </dt>
  <dd>
    <p>- ID of the window background of which we need to set.</p>
  </dd>
  <dt>
    p
  </dt>
  <dd>
    <p>- Pixmap to set background to.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>None on success. Pixmap ID of original Pixmap on failure.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>set_window_background_and_free() will set window's background to specified Pixmap, Then refresh window contents so that background is drawn by the server, flush all the requests to force it to be sent to server to be processed as fast as possible.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>After Window's background has been set to Pixmap - X server makes hidden copy of this Pixmap for later window refreshing. As the result original Pixmap is no longer needed and can be freed to conserve resources.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SOURCE</h2>
        <div class="sectioncontent">
<p>Pixmap set_window_background_and_free( Window w, Pixmap p ) { #ifndef X_DISPLAY_MISSING</p>
<pre>
    if( p != None && w != None )
    {
        Display *dpy = get_default_asvisual()-&gt;dpy;
</pre>

<pre>
        if (dpy)
        {
            XSetWindowBackgroundPixmap( dpy, w, p );
            XClearWindow( dpy, w );
            XFlush( dpy );
            XFreePixmap( dpy, p );
            p = None ;
        }
    }
</pre>
<p>#endif /* X_DISPLAY_MISSING */</p>
<pre>
    return p ;
</pre>
<p>}</p><p>libAfterImage/tutorials/wait_closedown()</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NAMEwait_closedown()</h2>
        <div class="sectioncontent">

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>void wait_closedown( Window w );</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INPUTS</h2>
        <div class="sectioncontent">
<ul>
<li><p>- ID of the window from which to wait for events.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>User action requesting window to be closed is generally received first by Window Manager. Window Manager is then handles it down to the window by sending it ClientMessage event with first 32 bit word of data set to the value of WM_DELETE_WINDOW Atom. Accordingly, all client has to do is wait for such event from X server and, when received, it should destroy its window and generally exit.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>It is recommended that XFlush() is issued right after XDestroyWindow() as Window Manager itself may attempt to do something with the window until it receives DestroyNotify event.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO common&hellip;</h2>
        <div class="sectioncontent">
<p>ICCCM, Window</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SOURCE</h2>
        <div class="sectioncontent">
<p>void wait_closedown( Window w ) { #ifndef X_DISPLAY_MISSING</p>
<pre>
    Display *dpy = get_default_asvisual()-&gt;dpy;
</pre>

<pre>
    if(dpy)
    {
        if (w)
        {
            XSelectInput (dpy, w, ( StructureNotifyMask |
                                    ButtonPressMask|
                                    ButtonReleaseMask));
</pre>

<pre>
            while(w != None)
            {
                XEvent event ;
</pre>

<pre>
                XNextEvent (dpy, &event);
                switch(event.type)
                {
                    case ClientMessage:
                        if ((event.xclient.format != 32) ||
                            (event.xclient.data.l[0] != _XA_WM_DELETE_WINDOW))
                            break ;
                    case ButtonPress:
                        XDestroyWindow( dpy, w );
                        XFlush( dpy );
                        w = None ;
                        break ;
                }
            }
        }
        XCloseDisplay (dpy);
    }
</pre>
<p>#endif }</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="char2uni.3x.html"><span aria-hidden="true">&larr;</span> char2uni.3x: Char2uni- handling on unicode, utf-8 and localized 8 bit encodings libafterimage/char_size</a></li>
   <li class="next"><a href="export.3x.html">export.3x: Export- functionality for writing images into files libafterimage/export.h <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
