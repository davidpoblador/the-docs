<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>gss_init_sec_context: Api function</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Api function">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="gss_init_sec_context (3) manual">
  <meta name="twitter:description" content="Api function">
  <meta name="twitter:image" content="https://www.carta.tech/images/gss-man-gss_init_sec_context-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/gss_init_sec_context.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="gss_init_sec_context (3) manual" />
  <meta property="og:description" content="Api function" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/gss-man-gss_init_sec_context-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">gss_init_sec_context<small> (3)</small></h1>
        <p class="lead">Api function</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/gss_init_sec_context.3.html">
      <span itemprop="name">gss_init_sec_context: Api function</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/gss-man/">
      <span itemprop="name">gss-man</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/gss_init_sec_context.3.html">
      <span itemprop="name">gss_init_sec_context: Api function</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>#include &lt;gss.h&gt;</strong></p><p><strong>OM_uint32 gss_init_sec_context(OM_uint32 * </strong><em>minor_status</em><strong>, const gss_cred_id_t </strong><em>initiator_cred_handle</em><strong>, gss_ctx_id_t * </strong><em>context_handle</em><strong>, const gss_name_t </strong><em>target_name</em><strong>, const gss_OID </strong><em>mech_type</em><strong>, OM_uint32 </strong><em>req_flags</em><strong>, OM_uint32 </strong><em>time_req</em><strong>, const gss_channel_bindings_t </strong><em>input_chan_bindings</em><strong>, const gss_buffer_t </strong><em>input_token</em><strong>, gss_OID * </strong><em>actual_mech_type</em><strong>, gss_buffer_t </strong><em>output_token</em><strong>, OM_uint32 * </strong><em>ret_flags</em><strong>, OM_uint32 * </strong><em>time_rec</em><strong>);</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ARGUMENTS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    OM_uint32 * minor_status
  </dt>
  <dd>
    <p>(integer, modify) Mechanism specific status code.</p>
  </dd>
  <dt>
    const gss_cred_id_t initiator_cred_handle
  </dt>
  <dd>
    <p>(gss_cred_id_t, read, optional) Handle for</p>
<pre>
  credentials claimed.  Supply GSS_C_NO_CREDENTIAL to act as a
  default initiator principal.  If no default initiator is defined,
  the function will return GSS_S_NO_CRED.
</pre>

  </dd>
  <dt>
    gss_ctx_id_t * context_handle
  </dt>
  <dd>
    <p>(gss_ctx_id_t, read/modify) Context handle for new</p>
<pre>
  context.  Supply GSS_C_NO_CONTEXT for first call; use value
  returned by first call in continuation calls.  Resources
  associated with this context-handle must be released by the
  application after use with a call to <strong>gss_delete_sec_context()</strong>.
</pre>

  </dd>
  <dt>
    const gss_name_t target_name
  </dt>
  <dd>
    <p>(gss_name_t, read) Name of target.</p>
  </dd>
  <dt>
    const gss_OID mech_type
  </dt>
  <dd>
    <p>(OID, read, optional) Object ID of desired</p>
<pre>
  mechanism. Supply GSS_C_NO_OID to obtain an implementation
  specific default.
</pre>

  </dd>
  <dt>
    OM_uint32 req_flags
  </dt>
  <dd>
    <p>(bit-mask, read) Contains various independent flags,</p>
<pre>
  each of which requests that the context support a specific
  service option.  Symbolic names are provided for each flag, and
  the symbolic names corresponding to the required flags should be
  logically-ORed together to form the bit-mask value.  See below
  for the flags.
</pre>

  </dd>
  <dt>
    OM_uint32 time_req
  </dt>
  <dd>
    <p>(Integer, read, optional) Desired number of seconds for</p>
<pre>
  which context should remain valid.  Supply 0 to request a default
  validity period.
</pre>

  </dd>
  <dt>
    const gss_channel_bindings_t input_chan_bindings
  </dt>
  <dd>
    <p>(channel bindings, read, optional)</p>
<pre>
  Application-specified bindings.  Allows application to securely
  bind channel identification information to the security context.
  Specify GSS_C_NO_CHANNEL_BINDINGS if channel bindings are not
  used.
</pre>

  </dd>
  <dt>
    const gss_buffer_t input_token
  </dt>
  <dd>
    <p>(buffer, opaque, read, optional) Token received from</p>
<pre>
  peer application.  Supply GSS_C_NO_BUFFER, or a pointer to a
  buffer containing the value GSS_C_EMPTY_BUFFER on initial call.
</pre>

  </dd>
  <dt>
    gss_OID * actual_mech_type
  </dt>
  <dd>
    <p>(OID, modify, optional) Actual mechanism used.</p>
<pre>
  The OID returned via this parameter will be a pointer to static
  storage that should be treated as read-only; In particular the
  application should not attempt to free it.  Specify NULL if not
  required.
</pre>

  </dd>
  <dt>
    gss_buffer_t output_token
  </dt>
  <dd>
    <p>(buffer, opaque, modify) Token to be sent to peer</p>
<pre>
  application.  If the length field of the returned buffer is zero,
  no token need be sent to the peer application.  Storage
  associated with this buffer must be freed by the application
  after use with a call to <strong>gss_release_buffer()</strong>.
</pre>

  </dd>
  <dt>
    OM_uint32 * ret_flags
  </dt>
  <dd>
    <p>(bit-mask, modify, optional) Contains various</p>
<pre>
  independent flags, each of which indicates that the context
  supports a specific service option.  Specify NULL if not
  required.  Symbolic names are provided for each flag, and the
  symbolic names corresponding to the required flags should be
  logically-ANDed with the ret_flags value to test whether a given
  option is supported by the context.  See below for the flags.
</pre>

  </dd>
  <dt>
    OM_uint32 * time_rec
  </dt>
  <dd>
    <p>(Integer, modify, optional) Number of seconds for which</p>
<pre>
  the context will remain valid. If the implementation does not
  support context expiration, the value GSS_C_INDEFINITE will be
  returned.  Specify NULL if not required.
</pre>

  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Initiates the establishment of a security context between the application and a remote peer.  Initially, the input_token parameter should be specified either as GSS_C_NO_BUFFER, or as a pointer to a gss_buffer_desc object whose length field contains the value zero.  The routine may return a output_token which should be transferred to the peer application, where the peer application will present it to gss_accept_sec_context.  If no token need be sent, gss_init_sec_context will indicate this by setting the length field of the output_token argument to zero. To complete the context establishment, one or more reply tokens may be required from the peer application; if so, gss_init_sec_context will return a status containing the supplementary information bit GSS_S_CONTINUE_NEEDED. In this case, gss_init_sec_context should be called again when the reply token is received from the peer application, passing the reply token to gss_init_sec_context via the input_token parameters.</p><p>Portable applications should be constructed to use the token length and return status to determine whether a token needs to be sent or waited for.  Thus a typical portable caller should always invoke gss_init_sec_context within a loop:</p><p>--------------------------------------------------- int context_established = 0; gss_ctx_id_t context_hdl = GSS_C_NO_CONTEXT;</p>
<pre>
       ...
</pre>
<p>input_token-&gt;length = 0;</p><p>while (!context_established) {</p>
<pre>
  maj_stat = gss_init_sec_context(&min_stat,
                                  cred_hdl,
                                  &context_hdl,
                                  target_name,
                                  desired_mech,
                                  desired_services,
                                  desired_time,
                                  input_bindings,
                                  input_token,
                                  &actual_mech,
                                  output_token,
                                  &actual_services,
                                  &actual_time);
  if (GSS_ERROR(maj_stat)) {
    report_error(maj_stat, min_stat);
  };
</pre>

<pre>
  if (output_token-&gt;length != 0) {
    send_token_to_peer(output_token);
    gss_release_buffer(&min_stat, output_token)
  };
  if (GSS_ERROR(maj_stat)) {
</pre>

<pre>
    if (context_hdl != GSS_C_NO_CONTEXT)
      gss_delete_sec_context(&min_stat,
                             &context_hdl,
                             GSS_C_NO_BUFFER);
    break;
  };
</pre>

<pre>
  if (maj_stat & GSS_S_CONTINUE_NEEDED) {
    receive_token_from_peer(input_token);
  } else {
    context_established = 1;
  };
</pre>
<p>}; ---------------------------------------------------</p><p>Whenever the routine returns a major status that includes the value GSS_S_CONTINUE_NEEDED, the context is not fully established and the following restrictions apply to the output parameters:</p><p>- The value returned via the time_rec parameter is undefined unless the accompanying ret_flags parameter contains the bit GSS_C_PROT_READY_FLAG, indicating that per-message services may be applied in advance of a successful completion status, the value returned via the actual_mech_type parameter is undefined until the routine returns a major status value of GSS_S_COMPLETE.</p><p>- The values of the GSS_C_DELEG_FLAG, GSS_C_MUTUAL_FLAG, GSS_C_REPLAY_FLAG, GSS_C_SEQUENCE_FLAG, GSS_C_CONF_FLAG, GSS_C_INTEG_FLAG and GSS_C_ANON_FLAG bits returned via the ret_flags parameter should contain the values that the implementation expects would be valid if context establishment were to succeed.  In particular, if the application has requested a service such as delegation or anonymous authentication via the req_flags argument, and such a service is unavailable from the underlying mechanism, gss_init_sec_context should generate a token that will not provide the service, and indicate via the ret_flags argument that the service will not be supported.  The application may choose to abort the context establishment by calling gss_delete_sec_context (if it cannot continue in the absence of the service), or it may choose to transmit the token and continue context establishment (if the service was merely desired but not mandatory).</p><p>- The values of the GSS_C_PROT_READY_FLAG and GSS_C_TRANS_FLAG bits within ret_flags should indicate the actual state at the time gss_init_sec_context returns, whether or not the context is fully established.</p><p>- GSS-API implementations that support per-message protection are encouraged to set the GSS_C_PROT_READY_FLAG in the final ret_flags returned to a caller (i.e. when accompanied by a GSS_S_COMPLETE status code).  However, applications should not rely on this behavior as the flag was not defined in Version 1 of the GSS-API. Instead, applications should determine what per-message services are available after a successful context establishment according to the GSS_C_INTEG_FLAG and GSS_C_CONF_FLAG values.</p><p>- All other bits within the ret_flags argument should be set to zero.</p><p>If the initial call of <strong>gss_init_sec_context()</strong> fails, the implementation should not create a context object, and should leave the value of the context_handle parameter set to GSS_C_NO_CONTEXT to indicate this.  In the event of a failure on a subsequent call, the implementation is permitted to delete the "half-built" security context (in which case it should set the context_handle parameter to GSS_C_NO_CONTEXT), but the preferred behavior is to leave the security context untouched for the application to delete (using gss_delete_sec_context).</p><p>During context establishment, the informational status bits GSS_S_OLD_TOKEN and GSS_S_DUPLICATE_TOKEN indicate fatal errors, and GSS-API mechanisms should always return them in association with a routine error of GSS_S_FAILURE.  This requirement for pairing did not exist in version 1 of the GSS-API specification, so applications that wish to run over version 1 implementations must special-case these codes.</p><p>The `req_flags` values:</p><p>`GSS_C_DELEG_FLAG`:: - True - Delegate credentials to remote peer. - False - Don't delegate.</p><p>`GSS_C_MUTUAL_FLAG`:: - True - Request that remote peer authenticate itself. - False - Authenticate self to remote peer only.</p><p>`GSS_C_REPLAY_FLAG`:: - True - Enable replay detection for messages protected with gss_wrap or gss_get_mic. - False - Don't attempt to detect replayed messages.</p><p>`GSS_C_SEQUENCE_FLAG`:: - True - Enable detection of out-of-sequence protected messages. - False - Don't attempt to detect out-of-sequence messages.</p><p>`GSS_C_CONF_FLAG`:: - True - Request that confidentiality service be made available (via gss_wrap). - False - No per-message confidentiality service is required.</p><p>`GSS_C_INTEG_FLAG`:: - True - Request that integrity service be made available (via gss_wrap or gss_get_mic). - False - No per-message integrity service is required.</p><p>`GSS_C_ANON_FLAG`:: - True - Do not reveal the initiator's identity to the acceptor. - False - Authenticate normally.</p><p>The `ret_flags` values:</p><p>`GSS_C_DELEG_FLAG`:: - True - Credentials were delegated to the remote peer. - False - No credentials were delegated.</p><p>`GSS_C_MUTUAL_FLAG`:: - True - The remote peer has authenticated itself. - False - Remote peer has not authenticated itself.</p><p>`GSS_C_REPLAY_FLAG`:: - True - replay of protected messages will be detected. - False - replayed messages will not be detected.</p><p>`GSS_C_SEQUENCE_FLAG`:: - True - out-of-sequence protected messages will be detected. - False - out-of-sequence messages will not be detected.</p><p>`GSS_C_CONF_FLAG`:: - True - Confidentiality service may be invoked by calling gss_wrap routine. - False - No confidentiality service (via gss_wrap) available. gss_wrap will provide message encapsulation, data-origin authentication and integrity services only.</p><p>`GSS_C_INTEG_FLAG`:: - True - Integrity service may be invoked by calling either gss_get_mic or gss_wrap routines. - False - Per-message integrity service unavailable.</p><p>`GSS_C_ANON_FLAG`:: - True - The initiator's identity has not been revealed, and will not be revealed if any emitted token is passed to the acceptor. - False - The initiator's identity has been or will be authenticated normally.</p><p>`GSS_C_PROT_READY_FLAG`:: - True - Protection services (as specified by the states of the GSS_C_CONF_FLAG and GSS_C_INTEG_FLAG) are available for use if the accompanying major status return value is either GSS_S_COMPLETE or GSS_S_CONTINUE_NEEDED. - False - Protection services (as specified by the states of the GSS_C_CONF_FLAG and GSS_C_INTEG_FLAG) are available only if the accompanying major status return value is GSS_S_COMPLETE.</p><p>`GSS_C_TRANS_FLAG`:: - True - The resultant security context may be transferred to other processes via a call to <strong>gss_export_sec_context()</strong>. - False - The security context is not transferable.</p><p>All other bits should be set to zero.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>`GSS_S_COMPLETE`: Successful completion.</p><p>`GSS_S_CONTINUE_NEEDED`: Indicates that a token from the peer application is required to complete the context, and that gss_init_sec_context must be called again with that token.</p><p>`GSS_S_DEFECTIVE_TOKEN`: Indicates that consistency checks performed on the input_token failed.</p><p>`GSS_S_DEFECTIVE_CREDENTIAL`: Indicates that consistency checks performed on the credential failed.</p><p>`GSS_S_NO_CRED`: The supplied credentials were not valid for context initiation, or the credential handle did not reference any credentials.</p><p>`GSS_S_CREDENTIALS_EXPIRED`: The referenced credentials have expired.</p><p>`GSS_S_BAD_BINDINGS`: The input_token contains different channel bindings to those specified via the input_chan_bindings parameter.</p><p>`GSS_S_BAD_SIG`: The input_token contains an invalid MIC, or a MIC that could not be verified.</p><p>`GSS_S_OLD_TOKEN`: The input_token was too old.  This is a fatal error during context establishment.</p><p>`GSS_S_DUPLICATE_TOKEN`: The input_token is valid, but is a duplicate of a token already processed.  This is a fatal error during context establishment.</p><p>`GSS_S_NO_CONTEXT`: Indicates that the supplied context handle did not refer to a valid context.</p><p>`GSS_S_BAD_NAMETYPE`: The provided target_name parameter contained an invalid or unsupported type of name.</p><p>`GSS_S_BAD_NAME`: The provided target_name parameter was ill-formed.</p><p>`GSS_S_BAD_MECH`: The specified mechanism is not supported by the provided credential, or is unrecognized by the implementation.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">
<p>Report bugs to &lt;bug-gss@gnu.org&gt;. GNU Generic Security Service home page: http://www.gnu.org/software/gss/ General help using GNU software: http://www.gnu.org/gethelp/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2003-2013 Simon Josefsson.</p><p>Copying and distribution of this file, with or without modification, are permitted in any medium without royalty provided the copyright notice and this notice are preserved.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO gss_init_sec_context&hellip;</h2>
        <div class="sectioncontent">
<p>The full documentation for <strong>gss</strong> is maintained as a Texinfo manual.  If the <strong>info</strong> and <strong>gss</strong> programs are properly installed at your site, the command</p><ul>
<li><p><strong>info gss</strong></p></li>
</ul><p>should give you access to the complete manual.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="gss_indicate_mechs.3.html"><span aria-hidden="true">&larr;</span> gss_indicate_mechs.3: Api function</a></li>
   <li class="next"><a href="gss_inquire_context.3.html">gss_inquire_context.3: Api function <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
