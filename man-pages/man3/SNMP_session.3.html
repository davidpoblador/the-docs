<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SNMP_session: C++ object for specifying an snmp agent which can then be the managed via snmp set, get, and get_next calls</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="C++ object for specifying an snmp agent which can then be the managed via snmp set, get, and get_next calls">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="SNMP_session (3) manual">
  <meta name="twitter:description" content="C++ object for specifying an snmp agent which can then be the managed via snmp set, get, and get_next calls">
  <meta name="twitter:image" content="https://www.carta.tech/images/libsnmpkit-dev-SNMP_session-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/SNMP_session.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="SNMP_session (3) manual" />
  <meta property="og:description" content="C++ object for specifying an snmp agent which can then be the managed via snmp set, get, and get_next calls" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libsnmpkit-dev-SNMP_session-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">SNMP_session<small> (3)</small></h1>
        <p class="lead">C++ object for specifying an snmp agent which can then be the managed via snmp set, get, and get_next calls</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/SNMP_session.3.html">
      <span itemprop="name">SNMP_session: C++ object for specifying an snmp agent which can then be the managed via snmp set, get, and get_next calls</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libsnmpkit-dev/">
      <span itemprop="name">libsnmpkit-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/SNMP_session.3.html">
      <span itemprop="name">SNMP_session: C++ object for specifying an snmp agent which can then be the managed via snmp set, get, and get_next calls</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>#include &lt;snmpkit&gt;</strong></p><p><strong>SNMP_session::SNMP_session (const string &host,void *(*start_routine) (SNMP_session*), const string &community="public")</strong></p><p><strong>list&lt;SNMP_session*&gt; &SNMP_sessions(list&lt;SNMP_session*&gt; &dest, string &hostspec,void *(*start_routine)(SNMP_session*), const string &community="public");</strong></p><p><strong>list&lt;SNMP_session*&gt; &SNMP_sessions(list&lt;SNMP_session*&gt; &dest, list&lt;string&gt; &hostspecs,void *(*start_routine)(SNMP_session*), const string &community="public");</strong></p><p><strong>SNMP_session::~SNMP_session();</strong></p><p><strong>static void SNMP_session::end();</strong></p><p><strong>OidSeq *SNMP_session::get(OidSeq *oids);</strong></p><p><strong>OidSeq *SNMP_session::get_next(OidSeq *oids);</strong></p><p><strong>OidSeq *SNMP_session::set(OidSeq *oids);</strong></p><p><strong>char *SNMP_session::ConnHost();</strong></p><p><strong>const string &SNMP_session::Hostname();</strong></p><p><strong>void SNMP_session::setDebug();</strong></p><p><strong>void SNMP_session::write_debug(const string &dirstr, BerSequence *packet);</strong></p><p><strong>void SNMP_session::write_debug_bin(const basic_string&lt;unsigned char&gt; &str);</strong></p><p><strong>void SNMP_session::printstr(unsigned long *argflags,char need_newline, char *str, char ck_name_flag);</strong></p><p><strong>int SNMP_sessions_done();</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>An <strong>SNMP_session</strong> instance is an object that handles the details of communicating an SNMP enabled device such as a printer or a router.</p><h3>SNMP_session::SNMP_session (const string &host,void *(*start_routine) (SNMP_session*), const string &community);</h3>
<p>In order to create a new SNMP_session, you should know the address of the host or hosts with which you wish to communicate.  This parameter can take the form of an IP address or a hostname.</p><p>You must also provide a pointer to the start_routine function.  The start_routine() is the function used to actually do the work of communicating with the network device. In other words, this function is called when the thread handling this particular device is activated. In other words, this function actually loads up the packets with the SNMP objects and then makes the requsts.</p><p>Finally, you should also provide a SNMP community string (although a default one will be used if you do not supply one).  This string acts as a password.  Normally there are two strings set for an SNMP enabled device.  One will allow the user write access to settings via SNMP commands and the second password will only allow for read access to device settings.</p><p><strong>Exceptions</strong></p><p>* SocketNoUDPException - unable to obtain a protoent (<strong>See <strong>getprotbyname</strong>(3)</strong>) structure for the "UDP" protocol.</p><p>* SocketCreateFailException - unable to create a socket for use by the SNMP_session. (<strong>See <a href="../man2/socket.2.html"><strong>socket</strong>(2)</a></strong>).</p><p>* ReceiverCreateException - unable to create the listening thread in order to receive responses to issued SNMP queries.(<strong>See <a href="../man3/pthread_create.3.html"><strong>pthread_create</strong>(3)</a></strong>).</p><p>* SessionHostNotFoundException - unable to create the hostent struct; normally caused by a <a href="../man3/gethostbyname.3.html"><strong>gethostbyname</strong>(3)</a></strong> call on the host argument to the SNMP_session() constructor.</p><p>* JoinerCreateException - new thread creation failed. (<strong>See <a href="../man3/pthread_create.3.html"><strong>pthread_create</strong>(3)</a></strong>).</p><p>* SessionWorkerCreateException - worker thread creation failed. (<strong>See <a href="../man3/pthread_create.3.html"><strong>pthread_create</strong>(3)</a></strong>).</p>
<h3>list&lt;SNMP_session*&gt; &SNMP_sessions(list&lt;SNMP_session*&gt; &dest, string &hostspec,void *(*start_routine)(SNMP_session*), const string &community="public");</h3>
<p>This  function is not really a part of the class but its sole purpose is to repeatedly call the session constructor. This function is simply a quick way to create lots of sessions all at once. In addition to being able to pass a simple hostname or IP address, you can pass a host specification. This can have several forms:</p><p>* Simple address: 192.168.0.1</p><p>* Simple hostname: foobar</p><p>* IP address range: 192.168.0.1-52</p><p>* Network and subnet mask: 192.168.0.0/255.255.255.0</p><p>* Network and bits in subnet mask: 192.168.0.0/24</p><p>In addition the a community name can be appeneded to the hostpsec by surrounding it with parenthesis. e.g. 192.168.0.5-18(private)</p><p><strong>Exceptions</strong></p><p>Same as SNMP_session::SNMP_session() with the addition of</p><p>* SessionCommunityException - Can't find the closing parenthesis on the community name.</p><p>* SessionOctetOverflowException - One of the octets in subnet mask is greater than 255.</p><p>* SessionBadSubnetException - The subnet mask doesn't make sense.</p><p>* SessionNetbitsOverflowException - The number of bits in the netbits is greater than 31.</p><p>* SessionBadNetmaskException -  The overall netmask specification wasn't deciferable.</p>
<h3>list&lt;SNMP_session*&gt; &SNMP_sessions(list&lt;SNMP_session*&gt; &dest, list&lt;string&gt; &hostspecs,void *(*start_routine)(SNMP_session*), const string &community);</h3>
<p>See SNMP_sessions(list&lt;SNMP_session*&gt; &dest,string &hostspec, void *(*start_routine)(SNMP_session*),const string &community);</p><p>This function is not really part of the class but its sole purpose is to repeatedly call the constructor. This function is simply a quick way to create lots of sessions all at once. It is virtually identical to the other SNMP_sessions function with the exception that instead of taking one string as a hostspec it takes a list of hostspec strings.</p><p><strong>Exceptions</strong></p><p>Same as SNMP_sessions(list&lt;SNMP_session*&gt; &dest,string &hostspec, void *(*start_routine)(SNMP_session*),const string &community).</p>
<h3>SNMP_session::~SNMP_session();</h3>
<p>SNMP_session object destructor.</p>
<h3>OidSeq *SNMP_session::__get(OidSeq *oids)</h3>
<p>Method to read information from an SNMP device. This function is primarily called by the <strong>See <a href="../man3/SNMP_structFiller.3.html"><strong>SNMP_structFiller</strong>(3)</a></strong> class. It is designed to be called by the other functions in the library and is not generally considered an exported interface to the SNMPkit library.</p><p><strong>Exceptions</strong></p><p>* SNMPPacketNotSequenceException - The response received was not a valid SNMP response.</p><p>* SNMPRespNotSequenceException - The packet received was a valid SNMP response but the structure of the SNMP response was incorrect.</p><p>* SNMPNotResponseTagException - The type of the SNMP response received was incorrect (not 0xa2).</p><p>* SNMPSeqnoNotIntException - The sequence number of the response was not a classified as a number.</p><p>* SNMPStateNotIntException - The SNMP device sent back an improperly constructed response packet and the status was not classified as an integer.</p><p>* SNMPFaultOidNotIntException - A response was returned with an error but the index to the problem object identifier was not classified as an integer.</p><p>* OidSeqBadLayoutException -  Within a SNMP packet there is a substructure which is an OID sequence. If the packet was supposed to have an OID sequence in a particular locaion but for some reason one of the elements was not of the correct type, then this exception will be thrown.</p><p>* SNMPBadOidException - An OID in the SNMP response packet was invalid.</p><p>* SocketSendShortExecption - An error occurred while sending the SNMP request resulting in an incomplete transmission of the query.</p><p>* BerSequenceTagException, BerIntTagException, BerStringTagException, BerNullTagException, BerOidTagException, BerTimeTickTagException, BerCounterTagException - These exceptions are internal exceptions which are caused by trying to interpret a piece of as one type when in fact it is another type. These are almost always called as a result of a bug in the SNMPkit library.</p><p>* BerLengthException, BerIntLengthExecption, BerTimeTickLengthgExceptioin, BerCounterLengthExecption, BerNullLengthExecption, BerIPAddrLengthExecption - The size of the data to be encoded (BER) will not fit into an unsigned long data type.</p>
<h3>OidSeq *SNMP_session::__get_next(OidSeq *oids);</h3>
<p>Get the next item following the one pointed to by the OID sequence passed into the function.  This function is primarily called by the <strong>See <a href="../man3/SNMP_structFiller.3.html"><strong>SNMP_structFiller</strong>(3)</a></strong> class. It is designed to be called by the other functions in the library and is not generally considered an exported interface to the SNMPkit library.</p><p><strong>Exceptions</strong></p><p>Same as the <strong>SNMP_session::__get()</strong> method.</p>
<h3>OidSeq *SNMP_session::__set(OidSeq *oids)</h3>
<p>This method will write the values inserted into the OidSeq into the the SNMP agent. It is almost the opposite of __get which takes an OID and gets the value from the SNMP agent. This function is primarily called by the <strong>See <a href="../man3/SNMP_structFiller.3.html"><strong>SNMP_structFiller</strong>(3)</a></strong> class. It is designed to be called by the other functions in the library and is not generally considered an exported interface to the SNMPkit library.</p><p><strong>Exceptions</strong></p><p>Same as the <strong>SNMP_session::__get()</strong> method.</p>
<h3>void SNMP_session::setDebug()</h3>
<p>Enable the logging of debug information from the SNMP_session instance. This method must be called before attempting to write any debug data using the write_debug() method.</p><p><strong>Exceptions</strong></p><p>* DebugFileStatException - An unexpected error occurred when attempting to locate the appropriate debug log ("snmplog*"); this will occur when a stat of the debug log file returns an error other than ENOENT.</p><p>* DebugFileOpenException - An error occurred when attempting to open the process debug log.</p>
<h3>void SNMP_session::__write_debug(const string &dirstr,</h3>
<p>BerSequence *packet);" Write the SNMP packet information to a log file in order to aid in debugging errors.</p>
<h3>void SNMP_session::__write_debug_bin(const basic_string&lt;unsigned char&gt;</h3>
<p>&str);" Write binary debugging information to the log files dumping it in hex format.</p>
<h3>void SNMP_session::printstr(unsigned long *argflags,char need_newline,</h3>
<p>char *str, char ck_name_flag);" Enables the SNMP_session object to synchronize the logging of information among its various threads.</p>
<h3>char *SNMP_Session::ConnHost();</h3>
<p>Method to obtain the network address of the current SNMP session.  Note that the returned string is in network byte order.</p>
<h3>constr string &SNMP_session::Hostname();</h3>
<p>Method to obtain the hostname string used when creating the SNMP_session instance</p>
<h3>void SNMP_session::end();</h3>
<p>Method for appending a final newline (if necessary) to standard output.</p>
<h3>int SNMP_sessions_done();</h3>
<p>There is a thread that demultiplexes the packets coming in on the socket as well as a thread which recycles threads to keep the utilization of the system resources reasonable. Call this function after all the sessions are created to wait for all the threads to complete and clean up all the misc. resources which are being used by the library.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>OidSeq *SNMP_session::__get();</strong></p>
  </dt>
  <dd>
    <p>Pointer to an OidSeq object containing the response to the SNMP get request.</p>
  </dd>
  <dt>
    <p><strong>OidSeq *SNMP_session::__get_next();</strong></p>
  </dt>
  <dd>
    <p>Pointer to an OidSeq object containing the response to the SNMP get_next request.</p>
  </dd>
  <dt>
    <p><strong>OidSeq *SNMP_session::__set();</strong></p>
  </dt>
  <dd>
    <p>Pointer to an OidSeq object containing the response to the SNMP set request</p>
  </dd>
  <dt>
    <p><strong>int SNMP_sessions_done();</strong></p>
  </dt>
  <dd>
    <p>The maximum error returned by any of the threads when they complete.</p>
  </dd>
  <dt>
    <p><strong>list&lt;SNMP_session*&gt; &SNMP_sessions();</strong></p>
  </dt>
  <dd>
    <p>Returns the list passed into it with any sessions that were created appended to the end of the list.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<pre>
<strong>#include &lt;snmpkit&gt;</strong>
<strong>#include &lt;string.h&gt;</strong>
<strong>#include &lt;iostream.h&gt;</strong>

static const char SYSDESC[]="1.3.6.1.2.1.1.1.0";

struct PrinterInfo{
  char *sysDesc;
};

void printer_info_insert_sysDesc(void *dest_ptr,const char *str){
  PrinterInfo *dest=reinterpret_cast&lt;PrinterInfo*&gt;(dest_ptr);
  dest-&gt;sysDesc=strdup(str);
}

void *do_req(SNMP_session *printer){
  PrinterInfo prinfo;
  cerr &lt;&lt; printer-&gt;Hostname() &lt;&lt; endl &lt;&lt; flush;
  printer-&gt;setDebug();
  SNMP_structFiller table(*printer);
  table.append_string(SYSDESC,printer_info_insert_sysDesc);
  table.get(&prinfo);
  cout &lt;&lt; printer-&gt;Hostname() &lt;&lt; ' ' &lt;&lt; prinfo.sysDesc &lt;&lt; endl;
  return NULL;
}

int main(int argc,char **argv){
  set_snmpsock_props(1,3);
  list&lt;SNMP_session*&gt; sessions;
  string hostspec(argv[1]);
  SNMP_sessions(sessions,hostspec,do_req);
  SNMP_sessions_done();
  <strong>exit</strong>(1);
}
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO SNMP_session&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man3/SNMP_structFiller.3.html"><strong>SNMP_structFiller</strong>(3)</a>, <a href="../man3/SNMP_table.3.html"><strong>SNMP_table</strong>(3)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>The SNMPkit C/C++ library was originally developed by Ben Woodard &lt;ben@users.sourceforge.net&gt;. This man page was written by Gerald Carter &lt;gcarter@valinux.com&gt;.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="SMPTETime.3.html"><span aria-hidden="true">&larr;</span> SMPTETime.3: Human readable time representation.</a></li>
   <li class="next"><a href="SNMP_structFiller.3.html">SNMP_structFiller.3: C++ object to contain data for snmp queries <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
