<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CHI::Stats: Record and report per-namespace cache statistics</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Record and report per-namespace cache statistics">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="CHI::Stats (3pm) manual">
  <meta name="twitter:description" content="Record and report per-namespace cache statistics">
  <meta name="twitter:image" content="https://www.carta.tech/images/libchi-perl-CHI::Stats-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/CHI::Stats.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="CHI::Stats (3pm) manual" />
  <meta property="og:description" content="Record and report per-namespace cache statistics" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libchi-perl-CHI::Stats-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">CHI::Stats<small> (3pm)</small></h1>
        <p class="lead">Record and report per-namespace cache statistics</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/CHI::Stats.3pm.html">
      <span itemprop="name">CHI::Stats: Record and report per-namespace cache statistics</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libchi-perl/">
      <span itemprop="name">libchi-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/CHI::Stats.3pm.html">
      <span itemprop="name">CHI::Stats: Record and report per-namespace cache statistics</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>version 0.58</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    # Turn on statistics collection
    CHI-&gt;stats-&gt;enable();

    # Perform cache operations

    # Flush statistics to logs
    CHI-&gt;stats-&gt;flush();

    ...

    # Parse logged statistics
    my $results = CHI-&gt;stats-&gt;parse_stats_logs($file1, ...);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>\s-1CHI\s0 can record statistics, such as number of hits, misses and sets, on a per-namespace basis and log the results to your Log::Any logger. You can then parse the logs to get a combined summary.</p><p>A single CHI::Stats object is maintained for each \s-1CHI\s0 root class, and tallies statistics over any number of CHI::Driver objects.</p><p>Statistics are reported when you call the \*(L"flush\*(R" method. You can choose to do this once at process end, or on a periodic basis.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    enable, disable, enabled
  </dt>
  <dd>
    <p>Enable, disable, and query the current enabled status. When stats are enabled, each new cache object will collect statistics. Enabling and disabling does not affect existing cache objects. e.g.     my $cache1 = CHI-&gt;new(...);     CHI-&gt;stats-&gt;enable();     # $cache1 will not collect statistics     my $cache2 = CHI-&gt;new(...);     CHI-&gt;stats-&gt;disable();     # $cache2 will continue to collect statistics</p>
  </dd>
  <dt>
    flush
  </dt>
  <dd>
    <p>Log all statistics to Log::Any (at Info level in the CHI::Stats category), then clear statistics from memory. There is one log message for each distinct triplet of root class, cache label, and namespace. Each log message contains the string \*(L"\s-1CHI\s0 stats:\*(R" followed by a \s-1JSON\s0 encoded hash of statistics. e.g.     CHI stats: {"absent_misses":1,"label":"File","end_time":1338410398,        "get_time_ms":5,"namespace":"Foo","root_class":"CHI",        "set_key_size":6,"set_time_ms":23,"set_value_size":20,"sets":1,        "start_time":1338409391}</p>
  </dd>
  <dt>
    parse_stats_logs
  </dt>
  <dd>
    <p>Accepts one or more stats log files as parameters. Parses the logs and returns a listref of stats hashes by root class, cache label, and namespace. e.g.     [         {             root_class     =&gt; &apos;CHI&apos;,             label          =&gt; &apos;File&apos;,             namespace      =&gt; &apos;Foo&apos;,             absent_misses  =&gt; 100,             avg_compute_time_ms =&gt; 23,             ...         },         {             root_class     =&gt; &apos;CHI&apos;,             label          =&gt; &apos;File&apos;,             namespace      =&gt; &apos;Bar&apos;,             ...         },     ] Lines with the same root class, cache label, and namespace are summed together. Non-stats lines are ignored. The parser will ignore anything on the line before the \*(L"\s-1CHI\s0 stats:\*(R" string, e.g. a timestamp. Each parameter to this method may be a filename or a reference to an open filehandle.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">STATISTICS</h2>
        <div class="sectioncontent">
<p>The following statistics are tracked in the logs:</p><ul>
<li><p>\*(C`absent_misses\*(C' - Number of gets that failed due to item not being in the cache</p></li><li><p>\*(C`compute_time_ms\*(C' - Total time spent computing missed results in compute, in ms (divide by number of computes to get average). i.e. the amount of time spent in the code reference passed as the third argument to <em>compute()</em>.</p></li><li><p>\*(C`computes\*(C' - Number of compute calls</p></li><li><p>\*(C`expired_misses\*(C' - Number of gets that failed due to item expiring</p></li><li><p>\*(C`get_errors\*(C' - Number of caught runtime errors during gets</p></li><li><p>\*(C`get_time_ms\*(C' - Total time spent in get operation, in ms (divide by number of gets to get average)</p></li><li><p>\*(C`hits\*(C' - Number of gets that succeeded</p></li><li><p>\*(C`set_key_size\*(C' - Number of bytes in set keys (divide by number of sets to get average)</p></li><li><p>\*(C`set_value_size\*(C' - Number of bytes in set values (divide by number of sets to get average)</p></li><li><p>\*(C`set_time_ms\*(C' - Total time spent in set operation, in ms (divide by number of sets to get average)</p></li><li><p>\*(C`sets\*(C' - Number of sets</p></li><li><p>\*(C`set_errors\*(C' - Number of caught runtime errors during sets</p></li>
</ul><p>The following additional derived/aggregate statistics are computed by parse_stats_logs:</p><ul>
<li><p>\*(C`misses\*(C' - \*(C`absent_misses\*(C' + \*(C`expired_misses\*(C'</p></li><li><p>\*(C`gets\*(C' - \*(C`hits\*(C' + \*(C`misses\*(C'</p></li><li><p>\*(C`avg_compute_time_ms\*(C' - \*(C`compute_time_ms\*(C' / \*(C`computes\*(C'</p></li><li><p>\*(C`avg_get_time_ms\*(C' - \*(C`get_time_ms\*(C' / \*(C`gets\*(C'</p></li><li><p>\*(C`avg_set_time_ms\*(C' - \*(C`set_time_ms\*(C' / \*(C`sets\*(C'</p></li><li><p>\*(C`avg_set_key_size\*(C' - \*(C`set_key_size\*(C' / \*(C`sets\*(C'</p></li><li><p>\*(C`avg_set_value_size\*(C' - \*(C`set_value_size\*(C' / \*(C`sets\*(C'</p></li><li><p>\*(C`hit_rate\*(C' - \*(C`hits\*(C' / \*(C`gets\*(C'</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO CHI::Stats&hellip;</h2>
        <div class="sectioncontent">
<p>\s-1CHI\s0</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Jonathan Swartz &lt;swartz@pobox.com&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT AND LICENSE</h2>
        <div class="sectioncontent">
<p>This software is copyright (c) 2012 by Jonathan Swartz.</p><p>This is free software; you can redistribute it and/or modify it under the same terms as the Perl 5 programming language system itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="CHI::Driver::RawMemory.3pm.html"><span aria-hidden="true">&larr;</span> CHI::Driver::RawMemory.3pm: In-process memory cache that stores direct references</a></li>
   <li class="next"><a href="CLASS.3pm.html">CLASS.3pm: Alias for _\|_package_\|_ <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
