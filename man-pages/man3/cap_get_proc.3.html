<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>cap_get_proc: Capability manipulation on processes</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Capability manipulation on processes">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">cap_get_proc<small> (3)</small></h1>
        <p class="lead">Capability manipulation on processes</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/cap_get_proc.3.html">
      <span itemprop="name">cap_get_proc: Capability manipulation on processes</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libcap/">
      <span itemprop="name">libcap</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/cap_get_proc.3.html">
      <span itemprop="name">cap_get_proc: Capability manipulation on processes</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>#include &lt;sys/capability.h&gt;</strong></p><p><strong>cap_t cap_get_proc(void);</strong></p><p><strong>int cap_set_proc(cap_t </strong><em>cap_p</em><strong>);</strong></p><p><strong>int cap_get_bound(cap_value_t </strong><em>cap</em><strong>);</strong></p><p><strong>CAP_IS_SUPPORTED(cap_value_t </strong><em>cap</em><strong>);</strong></p><p><strong>int cap_drop_bound(cap_value_t </strong><em>cap</em><strong>);</strong></p><p><strong>#include &lt;sys/types.h&gt;</strong></p><p><strong>cap_t cap_get_pid(pid_t </strong><em>pid</em><strong>);</strong></p><p>Link with <em>-lcap</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>cap_get_proc</strong>() allocates a capability state in working storage, sets its state to that of the calling process, and returns a pointer to this newly created capability state.  The caller should free any releasable memory, when the capability state in working storage is no longer required, by calling <strong>cap_free</strong>() with the <em>cap_t</em> as an argument.</p><p><strong>cap_set_proc</strong>() sets the values for all capability flags for all capabilities to the capability state identified by <em>cap_p</em>. The new capability state of the process will be completely determined by the contents of <em>cap_p</em> upon successful return from this function.  If any flag in <em>cap_p</em> is set for any capability not currently permitted for the calling process, the function will fail, and the capability state of the process will remain unchanged.</p><p><strong>cap_get_pid</strong>() returns <em>cap_t</em>, see <a href="../man3/cap_init.3.html"><strong>cap_init</strong>(3)</a>, with the process capabilities of the process indicated by <em>pid</em>. This information can also be obtained from the <em>/proc/&lt;pid&gt;/status</em> file.</p><p><strong>cap_get_bound</strong>() with a <em>cap</em> as an argument returns the current value of this bounding set capability flag in effect for the current process. This operation is unpriveged. Note, a macro function <strong>CAP_IS_SUPPORTED(cap_value_t </strong><em>cap</em><strong>)</strong> is provided that evaluates to true (1) if the system supports the specified capability, <em>cap</em>. If the system does not support the capability, this function returns 0. This macro works by testing for an error condition with <strong>cap_get_bound</strong>().</p><p><strong>cap_drop_bound</strong>() can be used to lower the specified bounding set capability, <strong>cap</strong>, To complete successfully, the prevailing <em>effective</em> capability set must have a raised <strong>CAP_SETPCAP</strong>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>The functions <strong>cap_get_proc</strong>() and <strong>cap_get_pid</strong>() return a non-NULL value on success, and NULL on failure.</p><p>The function <strong>cap_get_bound</strong>() returns -1 if the requested capability is unknown, otherwise the return value reflects the current state of that capability in the prevailing bounding set. Note, a macro function,</p><p>The functions <strong>cap_set_proc</strong>() and <strong>cap_drop_bound</strong>() return zero for success, and -1 on failure.</p><p>On failure, <em>errno</em> is set to <strong>EINVAL</strong>, <strong>EPERM,</strong> or <strong>ENOMEM</strong>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFORMING TO</h2>
        <div class="sectioncontent">
<p><strong>cap_set_proc</strong>() and <strong>cap_get_proc</strong>() are specified in the withdrawn POSIX.1e draft specification. <strong>cap_get_pid</strong>() is a Linux extension.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>The library also supports the deprecated functions:</p><p><strong>int capgetp(pid_t </strong><em>pid</em><strong>, cap_t </strong><em>cap_d</em><strong>);</strong></p><p><strong>int capsetp(pid_t </strong><em>pid</em><strong>, cap_t </strong><em>cap_d</em><strong>);</strong></p><p><strong>capgetp</strong>() attempts to obtain the capabilities of some other process; storing the capabilities in a pre-allocated <em>cap_d</em>.<em>See</em> <strong>cap_init</strong>() for information on allocating an empty capability set. This function, <strong>capgetp</strong>(), is deprecated, you should use <strong>cap_get_pid</strong>().</p><p><strong>capsetp</strong>() attempts to set the capabilities of some other process(es), <em>pid</em>. If <em>pid</em> is positive it refers to a specific process;  if it is zero, it refers to the current process; -1 refers to all processes other than the current process and process '1' (typically <strong>init</strong>(8)); other negative values refer to the <em>-pid</em> process group.  In order to use this function, the kernel must support it and the current process must have <strong>CAP_SETPCAP</strong> raised in its Effective capability set. The capabilities set in the target process(es) are those contained in <em>cap_d</em>. Kernels that support filesystem capabilities redefine the semantics of <strong>CAP_SETPCAP</strong> and on such systems this function will always fail for any target not equal to the current process. <strong>capsetp</strong>() returns zero for success, and -1 on failure.</p><p>Where supported by the kernel, the function <strong>capsetp</strong>() should be used with care.  It existed, primarily, to overcome an early lack of support for capabilities in the filesystems supported by Linux.  Note that, by default, the only processes that have <strong>CAP_SETPCAP</strong> available to them are processes started as a kernel thread. (Typically this includes <strong>init</strong>(8), kflushd and kswapd). You will need to recompile the kernel to modify this default.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>The code segment below raises the <strong>CAP_FOWNER</strong> and <strong>CAP_SETFCAP</strong> effective capabilities for the caller:</p>
<pre>
    cap_t caps;
    cap_value_t cap_list[2];

    if (!CAP_IS_SUPPORTED(CAP_SETFCAP))
        /* handle error */

    caps = cap_get_proc();
    if (caps == NULL)
        /* handle error */;

    cap_list[0] = CAP_FOWNER;
    cap_list[1] = CAP_SETFCAP;
    if (cap_set_flag(caps, CAP_EFFECTIVE, 2, cap_list, CAP_SET) == -1)
        /* handle error */;

    if (cap_set_proc(caps) == -1)
        /* handle error */;

    if (cap_free(caps) == -1)
        /* handle error */;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO cap_get_proc&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man3/libcap.3.html"><strong>libcap</strong>(3)</a>, <a href="../man3/cap_clear.3.html"><strong>cap_clear</strong>(3)</a>, <a href="../man3/cap_copy_ext.3.html"><strong>cap_copy_ext</strong>(3)</a>, <a href="../man3/cap_from_text.3.html"><strong>cap_from_text</strong>(3)</a>, <a href="../man3/cap_get_file.3.html"><strong>cap_get_file</strong>(3)</a>, <a href="../man3/cap_init.3.html"><strong>cap_init</strong>(3)</a>, <a href="../man7/capabilities.7.html"><strong>capabilities</strong>(7)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="cap_get_pid.3.html"><span aria-hidden="true">&larr;</span> cap_get_pid.3: Capability manipulation on processes</a></li>
   <li class="next"><a href="cap_init.3.html">cap_init.3: Capability data object storage management <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
