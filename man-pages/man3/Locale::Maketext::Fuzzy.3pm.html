<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Locale::Maketext::Fuzzy: Maketext from already interpolated strings</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Maketext from already interpolated strings">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Locale::Maketext::Fuzzy (3pm) manual">
  <meta name="twitter:description" content="Maketext from already interpolated strings">
  <meta name="twitter:image" content="https://www.carta.tech/images/liblocale-maketext-fuzzy-perl-Locale::Maketext::Fuzzy-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Locale::Maketext::Fuzzy.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Locale::Maketext::Fuzzy (3pm) manual" />
  <meta property="og:description" content="Maketext from already interpolated strings" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/liblocale-maketext-fuzzy-perl-Locale::Maketext::Fuzzy-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Locale::Maketext::Fuzzy<small> (3pm)</small></h1>
        <p class="lead">Maketext from already interpolated strings</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Locale::Maketext::Fuzzy.3pm.html">
      <span itemprop="name">Locale::Maketext::Fuzzy: Maketext from already interpolated strings</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/liblocale-maketext-fuzzy-perl/">
      <span itemprop="name">liblocale-maketext-fuzzy-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Locale::Maketext::Fuzzy.3pm.html">
      <span itemprop="name">Locale::Maketext::Fuzzy: Maketext from already interpolated strings</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    package MyApp::L10N;
    use base &apos;Locale::Maketext::Fuzzy&apos;; # instead of Locale::Maketext

    package MyApp::L10N::de;
    use base &apos;MyApp::L10N&apos;;
    our %Lexicon = (
        # Exact match should always be preferred if possible
        "0 camels were released."
            =&gt; "Exact match",

        # Fuzzy match candidate
        "[quant,_1,camel was,camels were] released."
            =&gt; "[quant,_1,Kamel wurde,Kamele wurden] freigegeben.",

        # This could also match fuzzily, but is less preferred
        "[_2] released[_1]"
            =&gt; "[_1][_2] ist frei[_1]",
    );

    package main;
    my $lh = MyApp::L10N-&gt;get_handle(&apos;de&apos;);

    # All -&gt;maketext calls below will become -&gt;maketext_fuzzy instead
    $lh-&gt;<strong>override_maketext</strong>(1);

    # This prints "Exact match"
    print $lh-&gt;maketext(&apos;0 camels were released.&apos;);

    # "1 Kamel wurde freigegeben." -- quant() gets 1
    print $lh-&gt;maketext(&apos;1 camel was released.&apos;);

    # "2 Kamele wurden freigegeben." -- quant() gets 2
    print $lh-&gt;maketext(&apos;2 camels were released.&apos;);

    # "3 Kamele wurden freigegeben." -- parameters are ignored
    print $lh-&gt;maketext(&apos;3 released.&apos;);

    # "4 Kamele wurden freigegeben." -- normal usage
    print $lh-&gt;maketext(&apos;[*,_1,camel was,camels were] released.&apos;, 4);

    # "!Perl ist frei!" -- matches the broader one
    # Note that the sequence ([_2] before [_1]) is preserved
    print $lh-&gt;maketext(&apos;Perl released!&apos;);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This module is a subclass of \*(C`Locale::Maketext\*(C', with additional support for localizing messages that already contains interpolated variables.</p><p>This is most useful when the messages are returned by external sources \*(-- for example, to match \*(C`dir: command not found\*(C' against \*(C`[_1]: command not found\*(C'.</p><p>Of course, this module is also useful if you're simply too lazy to use the</p><p>    $lh-&gt;maketext("[quant,_1,file,files] deleted.", $count);</p><p>syntax, but wish to write</p><p>    $lh-&gt;maketext_fuzzy("$count files deleted");</p><p>instead, and have the correct plural form figured out automatically.</p><p>If \*(C`maketext_fuzzy\*(C' seems too long to type for you, this module also provides a \*(C`override_maketext\*(C' method to turn <em>all</em> \*(C`maketext\*(C' calls into \*(C`maketext_fuzzy\*(C' calls.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>That method takes exactly the same arguments as the \*(C`maketext\*(C' method of \*(C`Locale::Maketext\*(C'.</p><p>If <em>key</em> is found in lexicons, it is applied in the same way as \*(C`maketext\*(C'.  Otherwise, it looks at all lexicon entries that could possibly yield <em>key</em>, by turning \*(C`[...]\*(C' sequences into \*(C`(.*?)\*(C' and match the resulting regular expression against <em>key</em>.</p><p>Once it finds all candidate entries, the longest one replaces the <em>key</em> for the real \*(C`maketext\*(C' call.  Variables matched by its bracket sequences ($1, $2...) are placed before <em>parameters</em>; the order of variables in the matched entry are correctly preserved.</p><p>For example, if the matched entry in %Lexicon is \*(C`Test [_1]\*(C', this call:</p><p>    $fh-&gt;maketext_fuzzy("Test string", "param");</p><p>is equivalent to this:</p><p>    $fh-&gt;maketext("Test [_1]", "string", "param");</p><p>However, most of the time you won't need to supply <em>parameters</em> to a \*(C`maketext_fuzzy\*(C' call, since all parameters are already interpolated into the string. If <em>flag</em> is true, this accessor method turns \*(C`$lh-&gt;maketext\*(C' into an alias for \*(C`$lh-&gt;maketext_fuzzy\*(C', so all consecutive \*(C`maketext\*(C' calls in the $lh's packages are automatically fuzzy. A false <em>flag</em> restores the original behaviour.  If the flag is not specified, returns the current status of override; the default is 0 (no overriding).</p><p>Note that this call only modifies the symbol table of the <em>language</em> class that $lh belongs to, so other languages are not affected. If you want to override all language handles in a certain application, try this:</p><p>    MyApp::L10N-&gt;<strong>override_maketext</strong>(1);</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CAVEATS</h2>
        <div class="sectioncontent">
<ul>
<li><p>The \*(L"longer is better\*(R" heuristic to determine the best match is reasonably good, but could certainly be improved.</p></li><li><p>Currently, "[quant,_1,file] deleted" won't match "3 files deleted"; you'll have to write "[quant,_1,file,files] deleted" instead, or simply use "[_1] file deleted" as the lexicon key and put the correct plural form handling into the corresponding value.</p></li><li><p>When used in combination with \*(C`Locale::Maketext::Lexicon\*(C''s \*(C`Tie\*(C' backend, all keys would be iterated over each time a fuzzy match is performed, and may cause serious speed penalty.  Patches welcome.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Locale::Maketext::Fuzzy&hellip;</h2>
        <div class="sectioncontent">
<p>Locale::Maketext, Locale::Maketext::Lexicon</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">
<p>This particular module was written to facilitate an <em>auto-extraction</em> layer for Slashcode's <em>Template Toolkit</em> provider, based on \*(C`HTML::Parser\*(C' and \*(C`Template::Parser\*(C'.  It would work like this:</p><p>    Input | &lt;B&gt;from the [% story.dept %] dept.&lt;/B&gt;     Output| &lt;B&gt;[%|loc( story.dept )%]from the [_1] dept.[%END%]&lt;/B&gt;</p><p>Now, this layer suffers from the same linguistic problems as an ordinary \*(C`Msgcat\*(C' or \*(C`Gettext\*(C' framework does \*(-- what if we want to make ordinals from \*(C`[% story.dept %]\*(C' (i.e. \*(C`from the 3rd dept.\*(C'), or expand the \*(C`dept.\*(C' to \*(C`department\*(C' / \*(C`departments\*(C'?</p><p>The same problem occurred in \s-1RT\s0's web interface, where it had to localize messages returned by external modules, which may already contain interpolated variables, e.g. "Successfully deleted 7 ticket(s) in &apos;c:&#92;temp&apos;.".</p><p>Since I didn't have the time to refactor \*(C`DBI\*(C' and \*(C`DBI::SearchBuilder\*(C', I devised a \*(C`loc_match\*(C' method to pre-process their messages into one of the <em>candidate strings</em>, then applied the matched string to \*(C`maketext\*(C'.</p><p>Afterwards, I realized that instead of preparing a set of candidate strings, I could actually match against the original <em>lexicon file</em> (i.e. \s-1PO\s0 files via \*(C`Locale::Maketext::Lexicon\*(C').  This is how \*(C`Locale::Maketext::Fuzzy\*(C' was born.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Audrey Tang &lt;cpan@audreyt.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CC0 1.0 Universal</h2>
        <div class="sectioncontent">
<p>To the extent possible under law, a\*oXXe\*'\s-1XX\s0 has waived all copyright and related or neighboring rights to Locale-Maketext-Fuzzy.</p><p>This work is published from Taiwan.</p><p>&lt;http://creativecommons.org/publicdomain/zero/1.0&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Locale::Currency::Format.3pm.html"><span aria-hidden="true">&larr;</span> Locale::Currency::Format.3pm: Perl functions for formatting monetary values</a></li>
   <li class="next"><a href="Locale::Messages.3pm.html">Locale::Messages.3pm: Gettext like message retrieval <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
