<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Authen::Passphrase::VMSPurdy: Passphrases with the vms purdy polynomial system</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Passphrases with the vms purdy polynomial system">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Authen::Passphrase::VMSPurdy (3pm) manual">
  <meta name="twitter:description" content="Passphrases with the vms purdy polynomial system">
  <meta name="twitter:image" content="https://www.carta.tech/images/libauthen-passphrase-perl-Authen::Passphrase::VMSPurdy-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Authen::Passphrase::VMSPurdy.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Authen::Passphrase::VMSPurdy (3pm) manual" />
  <meta property="og:description" content="Passphrases with the vms purdy polynomial system" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libauthen-passphrase-perl-Authen::Passphrase::VMSPurdy-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Authen::Passphrase::VMSPurdy<small> (3pm)</small></h1>
        <p class="lead">Passphrases with the vms purdy polynomial system</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Authen::Passphrase::VMSPurdy.3pm.html">
      <span itemprop="name">Authen::Passphrase::VMSPurdy: Passphrases with the vms purdy polynomial system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libauthen-passphrase-perl/">
      <span itemprop="name">libauthen-passphrase-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Authen::Passphrase::VMSPurdy.3pm.html">
      <span itemprop="name">Authen::Passphrase::VMSPurdy: Passphrases with the vms purdy polynomial system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
        use Authen::Passphrase::VMSPurdy;

        $ppr = Authen::Passphrase::VMSPurdy-&gt;new(
                        username =&gt; "jrandom", salt =&gt; 25362,
                        hash_hex =&gt; "832a0c270179584a");

        $ppr = Authen::Passphrase::VMSPurdy-&gt;new(
                        username =&gt; "jrandom", salt_random =&gt; 1,
                        passphrase =&gt; "passphrase");

        $ppr = Authen::Passphrase::VMSPurdy-&gt;from_crypt(
                &apos;$VMS3$1263832A0C270179584AJRANDOM&apos;);

        $ppr = Authen::Passphrase::VMSPurdy-&gt;from_rfc2307(
                &apos;{CRYPT}$VMS3$1263832A0C270179584AJRANDOM&apos;);

        $algorithm = $ppr-&gt;algorithm;
        $username = $ppr-&gt;username;
        $salt = $ppr-&gt;salt;
        $hash = $ppr-&gt;hash;
        $hash_hex = $ppr-&gt;hash_hex;

        if($ppr-&gt;match($passphrase)) { ...

        $passwd = $ppr-&gt;as_crypt;
        $userPassword = $ppr-&gt;as_rfc2307;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>An object of this class encapsulates a passphrase hashed using one of the Purdy polynomial hash functions used in \s-1VMS\s0.  This is a subclass of Authen::Passphrase, and this document assumes that the reader is familiar with the documentation for that class.</p><p>The core of the Purdy polynomial hashing algorithm transforms one 64-bit number into another 64-bit number.  It was developed by George B. Purdy, and described in the paper \*(L"A High Security Log-in Procedure\*(R" which can be found at &lt;http://portal.acm.org/citation.cfm?id=361089&dl=GUIDE&coll=ACM&CFID=15151515&CFTOKEN=6184618&gt;.</p><p>For practical use in passphrase hashing, the Purdy polynomial must be augmented by a procedure to turn a variable-length passphrase into the initial 64-bit number to be hashed.  In \s-1VMS\s0 this pre-hashing phase also incorporates the username of the account to which access is being controlled, in order to prevent identical passphrases yielding identical hashes.  This is a form of salting.  Another salt parameter, a 16-bit integer, is also included, this one going under the name \*(L"salt\*(R".</p><p>There are three variants of the pre-hashing algorithm.  The original version, known as "<strong>\s-1PURDY\s0</strong>\*(L" and used during field testing of \s-1VMS\s0 2.0, truncates or space-pads the username to a fixed length.  The second version, known as \*(R"<strong>\s-1PURDY_V\s0</strong>\*(L" and used from \s-1VMS\s0 2.0 up to (but not including) \s-1VMS\s0 5.4, properly handles the variable-length nature of the username.  The third version, known as \*(R"<strong>\s-1PURDY_S\s0</strong>" and used from \s-1VMS\s0 5.4 onwards, performs some extra bit rotations to avoid aliasing problems when pre-hashing long strings.  All three versions are supported by this module.</p><p>\s-1VMS\s0 heavily restricts the composition of both usernames and passphrases. They may only contain alphanumerics, "<strong>$</strong>\*(L", and \*(R"<strong>_</strong>".  Case is insignificant.  Usernames must be between 1 and 31 characters long, and passphrases must be between 1 and 32 characters long.  This module enforces these rules.  An invalid passphrase is never accepted as matching.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONSTRUCTORS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    Authen::Passphrase::VMSPurdy-&gt;new(\s-1ATTR\s0 =&gt; \s-1VALUE\s0, ...)
  </dt>
  <dd>
    <p>Generates a new passphrase recogniser object using the \s-1VMS\s0 Purdy polynomial algorithm family.  The following attributes may be given:</p>
<dl class='dl-vertical'>
  <dt>
    <strong>algorithm</strong>
  </dt>
  <dd>
    <p>A string indicating which variant of the algorithm is to be used. Valid values are "<strong>\s-1PURDY\s0</strong>\*(L" (the original), \*(R"<strong>\s-1PURDY_V\s0</strong>\*(L" (modified to use full length of the username), and \*(R"<strong>\s-1PURDY_S\s0</strong>\*(L" (extra rotations to avoid aliasing when processing long strings).  Default \*(R"<strong>\s-1PURDY_S\s0</strong>".</p>
  </dd>
  <dt>
    <strong>username</strong>
  </dt>
  <dd>
    <p>A string to be used as the `username' salt parameter.  It is limited to \s-1VMS\s0 username syntax.</p>
  </dd>
  <dt>
    <strong>salt</strong>
  </dt>
  <dd>
    <p>The salt, as an integer in the range [0, 65536).</p>
  </dd>
  <dt>
    <strong>salt_hex</strong>
  </dt>
  <dd>
    <p>The salt, as a string of four hexadecimal digits.  The first two digits must give the least-significant byte and the last two give the most-significant byte, with most-significant nybble first within each byte.</p>
  </dd>
  <dt>
    <strong>salt_random</strong>
  </dt>
  <dd>
    <p>Causes salt to be generated randomly.  The value given for this attribute is ignored.  The source of randomness may be controlled by the facility described in Data::Entropy.</p>
  </dd>
  <dt>
    <strong>hash</strong>
  </dt>
  <dd>
    <p>The hash, as a string of eight bytes.</p>
  </dd>
  <dt>
    <strong>hash_hex</strong>
  </dt>
  <dd>
    <p>The hash, as a string of 16 hexadecimal digits.</p>
  </dd>
  <dt>
    <strong>passphrase</strong>
  </dt>
  <dd>
    <p>A passphrase that will be accepted.  It is limited to \s-1VMS\s0 passphrase syntax.</p>
  </dd>

</dl>
<p>The username and salt must be given, and either the hash or the passphrase.</p>
  </dd>
  <dt>
    Authen::Passphrase::VMSPurdy-&gt;from_crypt(\s-1PASSWD\s0)
  </dt>
  <dd>
    <p>Generates a new passphrase recogniser object using the \s-1VMS\s0 Purdy polynomial algorithm family, from a crypt string.  The string must consist of an algorithm identifier, the salt in hexadecimal, the hash in hexadecimal, then the username.  The salt must be given as four hexadecimal digits, the first two giving the least-significant byte and the last two giving the most-significant byte, with most-significant nybble first within each byte.  The algorithm identifier must be "<strong></strong><strong>$VMS1</strong><strong>$</strong>\*(L" for \*(R"<strong>\s-1PURDY\s0</strong>\*(L", \*(R"<strong></strong><strong>$VMS2</strong><strong>$</strong>\*(L" for \*(R"<strong>\s-1PURDY_V\s0</strong>\*(L", or \*(R"<strong></strong><strong>$VMS3</strong><strong>$</strong>\*(L" for \*(R"<strong>\s-1PURDY_S\s0</strong>".  The whole crypt string must be uppercase.</p>
  </dd>
  <dt>
    Authen::Passphrase::VMSPurdy-&gt;from_rfc2307(\s-1USERPASSWORD\s0)
  </dt>
  <dd>
    <p>Generates a new passphrase recogniser object using the \s-1VMS\s0 Purdy polynomial algorithm family, from an \s-1RFC\s0 2307 string.  The string must consist of "<strong>{\s-1CRYPT\s0}</strong>" (case insensitive) followed by an acceptable crypt string.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>Returns the algorithm variant identifier string.  It may be "<strong>\s-1PURDY\s0</strong>\*(L" (the original), \*(R"<strong>\s-1PURDY_V\s0</strong>\*(L" (modified to use full length of the username), and \*(R"<strong>\s-1PURDY_S\s0</strong>" (extra rotations to avoid aliasing when processing long strings). Returns the username string.  All alphabetic characters in it are uppercase, which is the canonical form. Returns the salt, as an integer. Returns the salt, as a string of four hexadecimal digits.  The first two digits give the least-significant byte and the last two give the most-significant byte, with most-significant nybble first within each byte. Returns the hash value, as a string of eight bytes. Returns the hash value, as a string of 16 uppercase hexadecimal digits. These methods are part of the standard Authen::Passphrase interface.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Authen::Passphrase::VMSPurdy&hellip;</h2>
        <div class="sectioncontent">
<p>Authen::DecHpwd, Authen::Passphrase</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Andrew Main (Zefram) &lt;zefram@fysh.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (C) 2006, 2007, 2009, 2010, 2012 Andrew Main (Zefram) &lt;zefram@fysh.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE</h2>
        <div class="sectioncontent">
<p>This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Authen::Passphrase::SaltedDigest.3pm.html"><span aria-hidden="true">&larr;</span> Authen::Passphrase::SaltedDigest.3pm: Passphrases using the generic salted digest algorithm</a></li>
   <li class="next"><a href="Authen::Simple.3pm.html">Authen::Simple.3pm: Simple authentication <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
