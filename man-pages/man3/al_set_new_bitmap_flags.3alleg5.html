<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>al_set_new_bitmap_flags: Allegro 5 api</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Allegro 5 api">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="al_set_new_bitmap_flags (3alleg5) manual">
  <meta name="twitter:description" content="Allegro 5 api">
  <meta name="twitter:image" content="https://www.carta.tech/images/allegro5-doc-al_set_new_bitmap_flags-3alleg5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3alleg5/al_set_new_bitmap_flags.3alleg5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="al_set_new_bitmap_flags (3alleg5) manual" />
  <meta property="og:description" content="Allegro 5 api" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/allegro5-doc-al_set_new_bitmap_flags-3alleg5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">al_set_new_bitmap_flags<small> (3alleg5)</small></h1>
        <p class="lead">Allegro 5 api</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3alleg5/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3alleg5/al_set_new_bitmap_flags.3alleg5.html">
      <span itemprop="name">al_set_new_bitmap_flags: Allegro 5 api</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/allegro5-doc/">
      <span itemprop="name">allegro5-doc</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3alleg5/al_set_new_bitmap_flags.3alleg5.html">
      <span itemprop="name">al_set_new_bitmap_flags: Allegro 5 api</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<ul>
<li>
<pre>
#include&nbsp;&lt;allegro5/allegro.h&gt;

void&nbsp;al_set_new_bitmap_flags(int&nbsp;flags)

</pre>
</li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Sets the flags to use for newly created bitmaps. Valid flags are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>ALLEGRO_VIDEO_BITMAP</strong></p>
  </dt>
  <dd>
    <p>Creates a bitmap that resides in the video card memory. These types of bitmaps receive the greatest benefit from hardware acceleration. al_set_new_bitmap_flags(3alleg5) will implicitly set this flag unless ALLEGRO_MEMORY_BITMAP is present.</p>
  </dd>
  <dt>
    <p><strong>ALLEGRO_MEMORY_BITMAP</strong></p>
  </dt>
  <dd>
    <p>Create a bitmap residing in system memory. Operations on, and with, memory bitmaps will not be hardware accelerated. However, direct pixel access can be relatively quick compared to video bitmaps, which depend on the display driver in use.</p><p><em>Note: Allegro\[aq]s software rendering routines are currently very</em> unoptimised.</p>
  </dd>
  <dt>
    <p><strong>ALLEGRO_KEEP_BITMAP_FORMAT</strong></p>
  </dt>
  <dd>
    <p>Only used when loading bitmaps from disk files, forces the resulting ALLEGRO_BITMAP(3alleg5) to use the same format as the file.</p><p><em>This is not yet honoured.</em></p>
  </dd>
  <dt>
    <p><strong>ALLEGRO_FORCE_LOCKING</strong></p>
  </dt>
  <dd>
    <p>When drawing to a bitmap with this flag set, always use pixel locking and draw to it using Allegro\[aq]s software drawing primitives. This should never be used if you plan to draw to the bitmap using Allegro\[aq]s graphics primitives as it would cause severe performance penalties. However if you know that the bitmap will only ever be accessed by locking it, no unneeded FBOs will be created for it in the OpenGL drivers.</p>
  </dd>
  <dt>
    <p><strong>ALLEGRO_NO_PRESERVE_TEXTURE</strong></p>
  </dt>
  <dd>
    <p>Normally, every effort is taken to preserve the contents of bitmaps, since Direct3D may forget them. This can take extra processing time. If you know it doesn\[aq]t matter if a bitmap keeps its pixel data, for example its a temporary buffer, use this flag to tell Allegro not to attempt to preserve its contents. This can increase performance of your game or application, but there is a catch. See ALLEGRO_EVENT_DISPLAY_LOST for further information.</p>
  </dd>
  <dt>
    <p><strong>ALLEGRO_ALPHA_TEST</strong></p>
  </dt>
  <dd>
    <p>This is a driver hint only. It tells the graphics driver to do alpha testing instead of alpha blending on bitmaps created with this flag. Alpha testing is usually faster and preferred if your bitmaps have only one level of alpha (0). This flag is currently not widely implemented (i.e., only for memory bitmaps).</p>
  </dd>
  <dt>
    <p><strong>ALLEGRO_MIN_LINEAR</strong></p>
  </dt>
  <dd>
    <p>When drawing a scaled down version of the bitmap, use linear filtering. This usually looks better. You can also combine it with the MIPMAP flag for even better quality.</p>
  </dd>
  <dt>
    <p><strong>ALLEGRO_MAG_LINEAR</strong></p>
  </dt>
  <dd>
    <p>When drawing a magnified version of a bitmap, use linear filtering. This will cause the picture to get blurry instead of creating a big rectangle for each pixel. It depends on how you want things to look like whether you want to use this or not.</p>
  </dd>
  <dt>
    <p><strong>ALLEGRO_MIPMAP</strong></p>
  </dt>
  <dd>
    <p>This can only be used for bitmaps whose width and height is a power of two. In that case, it will generate mipmaps and use them when drawing scaled down versions. For example if the bitmap is 64x64, then extra bitmaps of sizes 32x32, 16x16, 8x8, 4x4, 2x2 and 1x1 will be created always containing a scaled down version of the original.</p>
  </dd>
  <dt>
    <p><strong>ALLEGRO_NO_PREMULTIPLIED_ALPHA</strong></p>
  </dt>
  <dd>
    <p>By default, Allegro pre-multiplies the alpha channel of an image with the images color data when it loads it. Typically that would look something like this:</p><ul>
<li>
<pre>
r&nbsp;=&nbsp;get_float_byte();
g&nbsp;=&nbsp;get_float_byte();
b&nbsp;=&nbsp;get_float_byte();
a&nbsp;=&nbsp;get_float_byte();

r&nbsp;=&nbsp;r&nbsp;*&nbsp;a;
g&nbsp;=&nbsp;g&nbsp;*&nbsp;a;
b&nbsp;=&nbsp;b&nbsp;*&nbsp;a;

set_image_pixel(x,&nbsp;y,&nbsp;r,&nbsp;g,&nbsp;b,&nbsp;a);

</pre>
</li>
</ul><p>The reason for this can be seen in the Allegro example ex_premulalpha, ie, using pre-multiplied alpha gives more accurate color results in some cases. To use alpha blending with images loaded with pre-multiplied alpha, you would use the default blending mode, which is set with al_set_blender(ALLEGRO_ADD, ALLEGRO_ONE, ALLEGRO_INVERSE_ALPHA).</p><p>The ALLEGRO_NO_PREMULTIPLIED_ALPHA flag being set will ensure that images are not loaded with alpha pre-multiplied, but are loaded with color values direct from the image. That looks like this:</p><ul>
<li>
<pre>
r&nbsp;=&nbsp;get_float_byte();
g&nbsp;=&nbsp;get_float_byte();
b&nbsp;=&nbsp;get_float_byte();
a&nbsp;=&nbsp;get_float_byte();

set_image_pixel(x,&nbsp;y,&nbsp;r,&nbsp;g,&nbsp;b,&nbsp;a);

</pre>
</li>
</ul><p>To draw such an image using regular alpha blending, you would use al_set_blender(ALLEGRO_ADD, ALLEGRO_ALPHA, ALLEGRO_INVERSE_ALPHA) to set the correct blender. This has some caveats. First, as mentioned above, drawing such an image can result in less accurate color blending (when drawing an image with linear filtering on, the edges will be darker than they should be). Second, the behaviour is somewhat confusing, which is explained in the example below.</p><ul>
<li>
<pre>
//&nbsp;Load&nbsp;and&nbsp;create&nbsp;bitmaps&nbsp;with&nbsp;an&nbsp;alpha&nbsp;channel
al_set_new_bitmap_format(ALLEGRO_PIXEL_FORMAT_ANY_32_WITH_ALPHA);
//&nbsp;Load&nbsp;some&nbsp;bitmap&nbsp;with&nbsp;alpha&nbsp;in&nbsp;it
bmp&nbsp;=&nbsp;al_load_bitmap("some_alpha_bitmap.png");
//&nbsp;We&nbsp;will&nbsp;draw&nbsp;to&nbsp;this&nbsp;buffer&nbsp;and&nbsp;then&nbsp;draw&nbsp;this&nbsp;buffer&nbsp;to&nbsp;the&nbsp;screen
tmp_buffer&nbsp;=&nbsp;al_create_bitmap(SCREEN_W,&nbsp;SCREEN_H);
//&nbsp;Set&nbsp;the&nbsp;buffer&nbsp;as&nbsp;the&nbsp;target&nbsp;and&nbsp;clear&nbsp;it
al_set_target_bitmap(tmp_buffer);
al_clear_to_color(al_map_rgba_f(0,&nbsp;0,&nbsp;0,&nbsp;1));
//&nbsp;Draw&nbsp;the&nbsp;bitmap&nbsp;to&nbsp;the&nbsp;temporary&nbsp;buffer
al_draw_bitmap(bmp,&nbsp;0,&nbsp;0,&nbsp;0);
//&nbsp;Finally,&nbsp;draw&nbsp;the&nbsp;buffer&nbsp;to&nbsp;the&nbsp;screen
//&nbsp;The&nbsp;output&nbsp;will&nbsp;look&nbsp;incorrect&nbsp;(may&nbsp;take&nbsp;close&nbsp;inspection
//&nbsp;depending&nbsp;on&nbsp;the&nbsp;bitmap&nbsp;--&nbsp;it&nbsp;may&nbsp;also&nbsp;be&nbsp;very&nbsp;obvious)
al_set_target_bitmap(al_get_backbuffer(display));
al_draw_bitmap(tmp_buffer,&nbsp;0,&nbsp;0,&nbsp;0);

</pre>
</li>
</ul>
  </dd>

</dl>
<p>To explain further, if you have a pixel with 0.5 alpha, and you\[aq]re using (ALLEGRO_ADD, ALLEGRO_ALPHA, ALLEGRO_INVERSE_ALPHA) for blending, the formula is:</p><ul>
<li>
<pre>
&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;=&nbsp;da&nbsp;*&nbsp;dst&nbsp;+&nbsp;sa&nbsp;*&nbsp;src

</pre>
</li>
</ul><p>Expands to:</p><ul>
<li>
<pre>
&nbsp;&nbsp;&nbsp;&nbsp;result_a&nbsp;=&nbsp;dst_a&nbsp;*&nbsp;(1-0.5)&nbsp;+&nbsp;0.5&nbsp;*&nbsp;0.5;

</pre>
</li>
</ul><p>So if you draw the image to the temporary buffer, it is blended once resulting in 0.75 alpha, then drawn again to the screen, blended in the same way, resulting in a pixel has 0.1875 as an alpha value.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO al_set_new_bitmap_flags&hellip;</h2>
        <div class="sectioncontent">
<p>al_get_new_bitmap_flags(3alleg5), al_get_bitmap_flags(3alleg5)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="al_set_mouse_z.3alleg5.html"><span aria-hidden="true">&larr;</span> al_set_mouse_z.3alleg5: Allegro 5 api</a></li>
   <li class="next"><a href="al_set_new_bitmap_format.3alleg5.html">al_set_new_bitmap_format.3alleg5: Allegro 5 api <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
