<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AnyEvent::HTTPD::Request: A web application request handle for anyevent::httpd</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A web application request handle for anyevent::httpd">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="AnyEvent::HTTPD::Request (3pm) manual">
  <meta name="twitter:description" content="A web application request handle for anyevent::httpd">
  <meta name="twitter:image" content="https://www.carta.tech/images/libanyevent-httpd-perl-AnyEvent::HTTPD::Request-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/AnyEvent::HTTPD::Request.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="AnyEvent::HTTPD::Request (3pm) manual" />
  <meta property="og:description" content="A web application request handle for anyevent::httpd" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libanyevent-httpd-perl-AnyEvent::HTTPD::Request-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">AnyEvent::HTTPD::Request<small> (3pm)</small></h1>
        <p class="lead">A web application request handle for anyevent::httpd</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/AnyEvent::HTTPD::Request.3pm.html">
      <span itemprop="name">AnyEvent::HTTPD::Request: A web application request handle for anyevent::httpd</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libanyevent-httpd-perl/">
      <span itemprop="name">libanyevent-httpd-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/AnyEvent::HTTPD::Request.3pm.html">
      <span itemprop="name">AnyEvent::HTTPD::Request: A web application request handle for anyevent::httpd</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This is the request object as generated by AnyEvent::HTTPD and given in the request callbacks.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <strong>url</strong>
  </dt>
  <dd>
    <p>This method returns the \s-1URL\s0 of the current request as \s-1URI\s0 object.</p>
  </dd>
  <dt>
    <strong>respond ([$res])</strong>
  </dt>
  <dd>
    <p>$res can be:</p><ul>
<li><p>an array reference Then the array reference has these elements:</p>
<pre>
   my ($code, $message, $header_hash, $content) =
         [200, &apos;ok&apos;, { &apos;Content-Type&apos; =&gt; &apos;text/html&apos; }, &apos;&lt;h1&gt;Test&lt;/h1&gt;&apos; }]
</pre>
<p>You can remove most headers added by default (like \*(C`Cache-Control\*(C', \*(C`Expires\*(C', and \*(C`Content-Length\*(C') by setting them to undef, like so:    $req-&gt;respond([       200, &apos;OK&apos;, {         &apos;Content-Type&apos;  =&gt; &apos;text/html&apos;,         &apos;Cache-Control&apos; =&gt; &apos;max-age=3600&apos;,         &apos;Expires&apos;       =&gt; undef,       },       &apos;This data will be cached for one hour.&apos;    ]);</p></li><li><p>a hash reference If it was a hash reference the hash is first searched for the \*(C`redirect\*(C' key and if that key does not exist for the \*(C`content\*(C' key. The value for the \*(C`redirect\*(C' key should contain the \s-1URL\s0 that you want to redirect the request to. The value for the \*(C`content\*(C' key should contain an array reference with the first value being the content type and the second the content.</p></li>
</ul><p>Here is an example:    $httpd-&gt;reg_cb (       &apos;/image/elmex&apos; =&gt; sub {          my ($httpd, $req) = @_;</p><p>         open IMG, "$ENV{HOME}/media/images/elmex.png"             or $req-&gt;respond (                   [404, &apos;not found&apos;, { &apos;Content-Type&apos; =&gt; &apos;text/plain&apos; }, &apos;not found&apos;]                );</p><p>         $req-&gt;respond ({ content =&gt; [&apos;image/png&apos;, do { local $/; &lt;IMG&gt; }] });       }    ); <strong>How to send large files:</strong> For longer responses you can give a callback instead of a string to the response function for the value of the $content.    $req-&gt;respond ({ content =&gt; [&apos;video/x-ms-asf&apos;, sub {       my ($data_cb) = @_;</p><p>      # start some async retrieve operation, for example use       # IO::AIO (with AnyEvent::AIO). Or retrieve chunks of data       # to send somehow else.</p><p>   } }); The given callback will receive as first argument either another callback ($data_cb in the above example) or an undefined value, which means that there is no more data required and the transfer has been completed (either by you sending no more data, or by a disconnect of the client). The callback given to \*(C`respond\*(C' will be called whenever the send queue of the \s-1HTTP\s0 connection becomes empty (meaning that the data is written out to the kernel). If it is called you have to start delivering the next chunk of data. That doesn't have to be immediately, before the callback returns.  This means that you can initiate for instance an \s-1IO::AIO\s0 request (see also AnyEvent::AIO) and send the data later.  That is what the $data_cb callback is for. You have to call it once you got the next chunk of data. Once you sent a chunk of data via $data_cb you can just wait until your callback is called again to deliver the next chunk. If you are done transferring all data call the $data_cb with an empty string or with no argument at all. Please consult the example script \*(C`large_response_example\*(C' from the \*(C`samples/\*(C' directory of the AnyEvent::HTTPD distribution for an example of how to use this mechanism. <strong>\s-1NOTE:\s0</strong> You should supply a 'Content-Length' header if you are going to send a larger file. If you don't do that the client will have no chance to know if the transfer was complete. To supply additional header fields the hash argument format will not work. You should use the array argument format for this case.</p>
  </dd>
  <dt>
    <strong>responded</strong>
  </dt>
  <dd>
    <p>Returns true if this request already has been responded to.</p>
  </dd>
  <dt>
    <strong>parm ($key)</strong>
  </dt>
  <dd>
    <p>Returns the first value of the form parameter $key or undef.</p>
  </dd>
  <dt>
    <strong>params</strong>
  </dt>
  <dd>
    <p>Returns list of parameter names.</p>
  </dd>
  <dt>
    <strong>vars</strong>
  </dt>
  <dd>
    <p>Returns a hash of form parameters. The value is either the value of the parameter, and in case there are multiple values present it will contain an array reference of values.</p>
  </dd>
  <dt>
    <strong>method</strong>
  </dt>
  <dd>
    <p>This method returns the method of the current request.</p>
  </dd>
  <dt>
    <strong>content</strong>
  </dt>
  <dd>
    <p>Returns the request content or undef if only parameters for a form were transmitted.</p>
  </dd>
  <dt>
    <strong>headers</strong>
  </dt>
  <dd>
    <p>This method will return a hash reference containing the \s-1HTTP\s0 headers for this \s-1HTTP\s0 request.</p>
  </dd>
  <dt>
    <strong>client_host</strong>
  </dt>
  <dd>
    <p>This method returns the host/IP of the \s-1HTTP\s0 client this request was received from.</p>
  </dd>
  <dt>
    <strong>client_port</strong>
  </dt>
  <dd>
    <p>This method returns the \s-1TCP\s0 port number of the \s-1HTTP\s0 client this request was received from.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT & LICENSE</h2>
        <div class="sectioncontent">
<p>Copyright 2008-2011 Robin Redeker, all rights reserved.</p><p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="AnyEvent::HTTPD::HTTPServer.3pm.html"><span aria-hidden="true">&larr;</span> AnyEvent::HTTPD::HTTPServer.3pm: A simple and plain http server</a></li>
   <li class="next"><a href="AnyEvent::HTTPD::Util.3pm.html">AnyEvent::HTTPD::Util.3pm: Utility functions for anyevent::httpd <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
