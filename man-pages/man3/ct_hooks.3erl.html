<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ct_hooks: A callback interface on top of common test</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A callback interface on top of common test">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="ct_hooks (3erl) manual">
  <meta name="twitter:description" content="A callback interface on top of common test">
  <meta name="twitter:image" content="https://www.carta.tech/images/erlang-manpages-ct_hooks-3erl.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3erl/ct_hooks.3erl.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ct_hooks (3erl) manual" />
  <meta property="og:description" content="A callback interface on top of common test" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/erlang-manpages-ct_hooks-3erl.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">ct_hooks<small> (3erl)</small></h1>
        <p class="lead">A callback interface on top of common test</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3erl/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3erl/ct_hooks.3erl.html">
      <span itemprop="name">ct_hooks: A callback interface on top of common test</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/erlang-manpages/">
      <span itemprop="name">erlang-manpages</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3erl/ct_hooks.3erl.html">
      <span itemprop="name">ct_hooks: A callback interface on top of common test</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <em>Common Test Hook</em> (henceforth called CTH) framework allows extensions of the default behaviour of Common Test by means of callbacks before and after all test suite calls. It is meant for advanced users of Common Test which want to abstract out behaviour which is common to multiple test suites.</p><p>In brief, Common Test Hooks allows you to:</p>
<dl class='dl-vertical'>
  <dt>
    <p>*</p>
  </dt>
  <dd>
    <p>Manipulate the runtime config before each suite configuration call</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    <p>*</p>
  </dt>
  <dd>
    <p>Manipulate the return of all suite configuration calls and in extension the result of the test themselves.</p>
  </dd>

</dl>
<p>The following sections describe the mandatory and optional CTH functions Common Test will call during test execution. For more details see <strong>Common Test Hooks</strong> in the User's Guide.</p><p>For information about how to add a CTH to your suite see <strong>Installing a CTH </strong> in the User's Guide.</p><p><strong></strong> Note:</p><p>See the <strong>Example CTH</strong> in the User's Guide for a minimal example of a CTH.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CALLBACK FUNCTIONS</h2>
        <div class="sectioncontent">
<p>The following functions define the callback interface for a Common Test Hook.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXPORTS</h2>
        <div class="sectioncontent">
<p><strong></strong> Module:init(Id, Opts) -&gt; {ok, State} | {ok, State, Priority}</p><p>Types:</p><p>Id = reference() | term()</p><p>Opts = term()</p><p>State = term()</p><p>Priority = integer()</p><p>MANDATORY</p><p>Always called before any other callback function. Use this to initiate any common state. It should return a state for this CTH.</p><p><em>Id</em> is the return value of <strong>id/1</strong>, or a <em>reference</em> (created using <strong>make_ref/0</strong>) if <strong>id/1</strong> is not implemented.</p><p><em>Priority</em> is the relative priority of this hook. Hooks with a lower priority will be executed first. If no priority is given, it will be set to 0.</p><p>For details about when init is called see <strong>scope</strong> in the User's Guide.</p><p><strong></strong> Module:pre_init_per_suite(SuiteName, InitData, CTHState) -&gt; Result</p><p>Types:</p><p>SuiteName = atom()</p><p>InitData = Config | SkipOrFail</p><p>Config = NewConfig = [{Key,Value}]</p><p>CTHState = NewCTHState = term()</p><p>Result = {Return, NewCTHState}</p><p>Return = NewConfig | SkipOrFail</p><p>SkipOrFail = {fail, Reason} | {skip, Reason}</p><p>Key = atom()</p><p>Value = term()</p><p>Reason = term()</p><p>OPTIONAL</p><p>This function is called before <strong> init_per_suite</strong> if it exists. It typically contains initialization/logging which needs to be done before init_per_suite is called. If <em>{skip,Reason}</em> or <em>{fail,Reason}</em> is returned, init_per_suite and all test cases of the suite will be skipped and Reason printed in the overview log of the suite.</p><p><em>SuiteName</em> is the name of the suite to be run.</p><p><em>InitData</em> is the original config list of the test suite, or a <em>SkipOrFail</em> tuple if a previous CTH has returned this.</p><p><em>CTHState</em> is the current internal state of the CTH.</p><p><em>Return</em> is the result of the init_per_suite function. If it is <em>{skip,Reason}</em> or <em>{fail,Reason}</em> <strong>init_per_suite </strong> will never be called, instead the initiation is considered to be skipped/failed respectively. If a <em>NewConfig</em> list is returned, <strong> init_per_suite</strong> will be called with that <em>NewConfig</em> list. See <strong> Pre Hooks</strong> in the User's Guide for more details.</p><p>Note that this function is only called if the CTH has been added before init_per_suite is run, see <strong>CTH Scoping</strong> in the User's Guide for details.</p><p><strong></strong> Module:post_init_per_suite(SuiteName, Config, Return, CTHState) -&gt; Result</p><p>Types:</p><p>SuiteName = atom()</p><p>Config = [{Key,Value}]</p><p>Return = NewReturn = Config | SkipOrFail | term()</p><p>SkipOrFail = {fail, Reason} | {skip, Reason} | term()</p><p>CTHState = NewCTHState = term()</p><p>Result = {NewReturn, NewCTHState}</p><p>Key = atom()</p><p>Value = term()</p><p>Reason = term()</p><p>OPTIONAL</p><p>This function is called after <strong> init_per_suite</strong> if it exists. It typically contains extra checks to make sure that all the correct dependencies have been started correctly.</p><p><em>Return</em> is what <strong>init_per_suite </strong> returned, i.e. {fail,Reason}, {skip,Reason}, a <em>Config</em> list or a term describing how <strong>init_per_suite </strong> failed.</p><p><em>NewReturn</em> is the possibly modified return value of <strong>init_per_suite </strong>. It is here possible to recover from a failure in <strong>init_per_suite </strong> by returning the <em>ConfigList</em> with the <em>tc_status</em> element removed. See <strong> Post Hooks</strong> in the User's Guide for more details.</p><p><em>CTHState</em> is the current internal state of the CTH.</p><p>Note that this function is only called if the CTH has been added before or in init_per_suite, see <strong>CTH Scoping</strong> in the User's Guide for details.</p><p><strong></strong> Module:pre_init_per_group(GroupName, InitData, CTHState) -&gt; Result</p><p>Types:</p><p>GroupName = atom()</p><p>InitData = Config | SkipOrFail</p><p>Config = NewConfig = [{Key,Value}]</p><p>CTHState = NewCTHState = term()</p><p>Result = {NewConfig | SkipOrFail, NewCTHState}</p><p>SkipOrFail = {fail,Reason} | {skip, Reason}</p><p>Key = atom()</p><p>Value = term()</p><p>Reason = term()</p><p>OPTIONAL</p><p>This function is called before <strong> init_per_group</strong> if it exists. It behaves the same way as <strong> pre_init_per_suite</strong>, but for the <strong> init_per_group</strong> instead.</p><p><strong></strong> Module:post_init_per_group(GroupName, Config, Return, CTHState) -&gt; Result</p><p>Types:</p><p>GroupName = atom()</p><p>Config = [{Key,Value}]</p><p>Return = NewReturn = Config | SkipOrFail | term()</p><p>SkipOrFail = {fail,Reason} | {skip, Reason}</p><p>CTHState = NewCTHState = term()</p><p>Result = {NewReturn, NewCTHState}</p><p>Key = atom()</p><p>Value = term()</p><p>Reason = term()</p><p>OPTIONAL</p><p>This function is called after <strong> init_per_group</strong> if it exists. It behaves the same way as <strong> post_init_per_suite</strong>, but for the <strong> init_per_group</strong> instead.</p><p><strong></strong> Module:pre_init_per_testcase(TestcaseName, InitData, CTHState) -&gt; Result</p><p>Types:</p><p>TestcaseName = atom()</p><p>InitData = Config | SkipOrFail</p><p>Config = NewConfig = [{Key,Value}]</p><p>CTHState = NewCTHState = term()</p><p>Result = {NewConfig | SkipOrFail, NewCTHState}</p><p>SkipOrFail = {fail,Reason} | {skip, Reason}</p><p>Key = atom()</p><p>Value = term()</p><p>Reason = term()</p><p>OPTIONAL</p><p>This function is called before <strong> init_per_testcase</strong> if it exists. It behaves the same way as <strong> pre_init_per_suite</strong>, but for the <strong> init_per_testcase</strong> function instead.</p><p>Note that it is not possible to add CTH's here right now, that feature might be added later, but it would right now break backwards compatibility.</p><p><strong></strong> Module:post_end_per_testcase(TestcaseName, Config, Return, CTHState) -&gt; Result</p><p>Types:</p><p>TestcaseName = atom()</p><p>Config = [{Key,Value}]</p><p>Return = NewReturn = Config | SkipOrFail | term()</p><p>SkipOrFail = {fail,Reason} | {skip, Reason}</p><p>CTHState = NewCTHState = term()</p><p>Result = {NewReturn, NewCTHState}</p><p>Key = atom()</p><p>Value = term()</p><p>Reason = term()</p><p>OPTIONAL</p><p>This function is called after <strong> end_per_testcase</strong> if it exists. It behaves the same way as <strong> post_init_per_suite</strong>, but for the <strong> end_per_testcase</strong> function instead.</p><p><strong></strong> Module:pre_end_per_group(GroupName, EndData, CTHState) -&gt; Result</p><p>Types:</p><p>GroupName = atom()</p><p>EndData = Config | SkipOrFail</p><p>Config = NewConfig = [{Key,Value}]</p><p>CTHState = NewCTHState = term()</p><p>Result = {NewConfig | SkipOrFail, NewCTHState}</p><p>SkipOrFail = {fail,Reason} | {skip, Reason}</p><p>Key = atom()</p><p>Value = term()</p><p>Reason = term()</p><p>OPTIONAL</p><p>This function is called before <strong> end_per_group</strong> if it exists. It behaves the same way as <strong> pre_init_per_suite</strong>, but for the <strong> end_per_group</strong> function instead.</p><p><strong></strong> Module:post_end_per_group(GroupName, Config, Return, CTHState) -&gt; Result</p><p>Types:</p><p>GroupName = atom()</p><p>Config = [{Key,Value}]</p><p>Return = NewReturn = Config | SkipOrFail | term()</p><p>SkipOrFail = {fail,Reason} | {skip, Reason}</p><p>CTHState = NewCTHState = term()</p><p>Result = {NewReturn, NewCTHState}</p><p>Key = atom()</p><p>Value = term()</p><p>Reason = term()</p><p>OPTIONAL</p><p>This function is called after <strong> end_per_group</strong> if it exists. It behaves the same way as <strong> post_init_per_suite</strong>, but for the <strong> end_per_group</strong> function instead.</p><p><strong></strong> Module:pre_end_per_suite(SuiteName, EndData, CTHState) -&gt; Result</p><p>Types:</p><p>SuiteName = atom()</p><p>EndData = Config | SkipOrFail</p><p>Config = NewConfig = [{Key,Value}]</p><p>CTHState = NewCTHState = term()</p><p>Result = {NewConfig | SkipOrFail, NewCTHState}</p><p>SkipOrFail = {fail,Reason} | {skip, Reason}</p><p>Key = atom()</p><p>Value = term()</p><p>Reason = term()</p><p>OPTIONAL</p><p>This function is called before <strong> end_per_suite</strong> if it exists. It behaves the same way as <strong> pre_init_per_suite</strong>, but for the <strong> end_per_suite</strong> function instead.</p><p><strong></strong> Module:post_end_per_suite(SuiteName, Config, Return, CTHState) -&gt; Result</p><p>Types:</p><p>SuiteName = atom()</p><p>Config = [{Key,Value}]</p><p>Return = NewReturn = Config | SkipOrFail | term()</p><p>SkipOrFail = {fail,Reason} | {skip, Reason}</p><p>CTHState = NewCTHState = term()</p><p>Result = {NewReturn, NewCTHState}</p><p>Key = atom()</p><p>Value = term()</p><p>Reason = term()</p><p>OPTIONAL</p><p>This function is called after <strong> end_per_suite</strong> if it exists. It behaves the same way as <strong> post_init_per_suite</strong>, but for the <strong> end_per_suite</strong> function instead.</p><p><strong></strong> Module:on_tc_fail(TestName, Reason, CTHState) -&gt; NewCTHState</p><p>Types:</p><p>TestName = init_per_suite | end_per_suite | {init_per_group,GroupName} | {end_per_group,GroupName} | {FuncName,GroupName} | FuncName</p><p>FuncName = atom()</p><p>GroupName = atom()</p><p>Reason = term()</p><p>CTHState = NewCTHState = term()</p><p>OPTIONAL</p><p>This function is called whenever a test case (or config function) fails. It is called after the post function has been called for the failed test case. I.e. if init_per_suite fails, this function is called after <strong> post_init_per_suite</strong>, and if a test case fails, it is called after <strong> post_end_per_testcase</strong>. If the failed test case belongs to a test case group, the first argument is a tuple <em>{FuncName,GroupName}</em>, otherwise simply the function name.</p><p>The data which comes with the Reason follows the same format as the <strong>FailReason </strong> in the <strong>tc_done</strong> event. See <strong>Event Handling </strong> in the User's Guide for details.</p><p><strong></strong> Module:on_tc_skip(TestName, Reason, CTHState) -&gt; NewCTHState</p><p>Types:</p><p>TestName = init_per_suite | end_per_suite | {init_per_group,GroupName} | {end_per_group,GroupName} | {FuncName,GroupName} | FuncName</p><p>FuncName = atom()</p><p>GroupName = atom()</p><p>Reason = {tc_auto_skip | tc_user_skip, term()}</p><p>CTHState = NewCTHState = term()</p><p>OPTIONAL</p><p>This function is called whenever a test case (or config function) is skipped. It is called after the post function has been called for the skipped test case. I.e. if init_per_group is skipped, this function is called after <strong> post_init_per_group</strong>, and if a test case is skipped, it is called after <strong> post_end_per_testcase</strong>. If the skipped test case belongs to a test case group, the first argument is a tuple <em>{FuncName,GroupName}</em>, otherwise simply the function name.</p><p>The data which comes with the Reason follows the same format as <strong>tc_auto_skip </strong> and <strong> tc_user_skip</strong> events. See <strong>Event Handling </strong> in the User's Guide for details.</p><p><strong></strong> Module:terminate(CTHState)</p><p>Types:</p><p>CTHState = term()</p><p>OPTIONAL</p><p>This function is called at the end of a CTH's <strong>scope</strong>.</p><p><strong></strong> Module:id(Opts) -&gt; Id</p><p>Types:</p><p>Opts = term()</p><p>Id = term()</p><p>OPTIONAL</p><p>The <em>Id</em> is used to uniquely identify a CTH instance, if two CTH's return the same <em>Id</em> the second CTH is ignored and subsequent calls to the CTH will only be made to the first instance. For more information see <strong>Installing a CTH </strong> in the User's Guide.</p><p>This function should NOT have any side effects as it might be called multiple times by Common Test.</p><p>If not implemented the CTH will act as if this function returned a call to <em>make_ref/0</em>.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="ct_ftp.3erl.html"><span aria-hidden="true">&larr;</span> ct_ftp.3erl: Ftp client module (based on the ftp support of the inets application).</a></li>
   <li class="next"><a href="ct_master.3erl.html">ct_master.3erl: Distributed test execution control for common test. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
