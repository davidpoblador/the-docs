<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Mon::Config: Methods for interaction with mon client</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Methods for interaction with mon client">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Mon::Config (3pm) manual">
  <meta name="twitter:description" content="Methods for interaction with mon client">
  <meta name="twitter:image" content="https://www.carta.tech/images/mon-client-Mon::Config-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Mon::Config.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Mon::Config (3pm) manual" />
  <meta property="og:description" content="Methods for interaction with mon client" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/mon-client-Mon::Config-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Mon::Config<small> (3pm)</small></h1>
        <p class="lead">Methods for interaction with mon client</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Mon::Config.3pm.html">
      <span itemprop="name">Mon::Config: Methods for interaction with mon client</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/mon-client/">
      <span itemprop="name">mon-client</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Mon::Config.3pm.html">
      <span itemprop="name">Mon::Config: Methods for interaction with mon client</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    use Mon::Client;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>    Mon::Client is used to interact with "mon" clients. It supports     a protocol-independent API for retrieving the status of the mon     server, and performing certain operations, such as disableing hosts     and service checks.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    new
  </dt>
  <dd>
    <p>Creates a new object. A hash can be supplied which sets the default values. An example which contains all of the variables that you can initialize:     $c = new Mon::Client (         host =&gt; "monhost",         port =&gt; 2583,         username =&gt; "foo",         password =&gt; "bar",     );</p>
  </dd>
  <dt>
    password (pw)
  </dt>
  <dd>
    <p>If <em>pw</em> is provided, sets the password. Otherwise, returns the currently set password.</p>
  </dd>
  <dt>
    host (host)
  </dt>
  <dd>
    <p>If <em>host</em> is provided, sets the mon host. Otherwise, returns the currently set mon host.</p>
  </dd>
  <dt>
    port (portnum)
  </dt>
  <dd>
    <p>If <em>portnum</em> is provided, sets the mon port number. Otherwise, returns the currently set port number.</p>
  </dd>
  <dt>
    username (user)
  </dt>
  <dd>
    <p>If <em>user</em> is provided, sets the user login. Otherwise, returns the currently set user login.</p>
  </dd>
  <dt>
    prot
  </dt>
  <dd>
    <p>If <em>protocol</em> is provided, sets the protocol, specified by a string which is of the form \*(L"1.2.3\*(R", where \*(L"1\*(R" is the major revision, \*(L"2\*(R" is the minor revision, and \*(L"3\*(R" is the sub-minor revision. If <em>protocol</em> is not provided, the currently set protocol is returned.</p>
  </dd>
  <dt>
    protid ([protocol])
  </dt>
  <dd>
    <p>Returns true if client and server protocol match, false otherwise. Implicitly called by <strong>connect</strong>. If protocol is specified as an integer, supplies that protocol version to the server for verification.</p>
  </dd>
  <dt>
    version
  </dt>
  <dd>
    <p>Returns the protocol version of the remote server.</p>
  </dd>
  <dt>
    error
  </dt>
  <dd>
    <p>Returns the error string from set by the last method, or undef if there was no error.</p>
  </dd>
  <dt>
    connected
  </dt>
  <dd>
    <p>Returns 0 (not connected) or 1 (connected).</p>
  </dd>
  <dt>
    connect (%args)
  </dt>
  <dd>
    <p>Connects to the server. If <strong>host</strong> and <strong>port</strong> have not been set, uses the defaults. Returns <em>undef</em> on error.  If $args{\*(L"skip_protid\*(R"} is true, skip protocol identification upon connect.</p>
  </dd>
  <dt>
    disconnect
  </dt>
  <dd>
    <p>Disconnects from the server. Return <em>undef</em> on error. <strong></strong><strong>%hash</strong><strong></strong> is optional, but if specified, should contain two keys, <strong>username</strong> and <strong>password</strong>. Performs the \*(L"login\*(R" command to authenticate the user to the server. Uses <strong>username</strong> and <strong>password</strong> if specified, otherwise uses the username and password previously set by those methods, respectively.</p>
  </dd>
  <dt>
    checkauth ( command )
  </dt>
  <dd>
    <p>Checks to see if the specified command, as executed by the current user, is authorized by the server, without actually executing the command. Returns 1 (command is authorized) or 0 (command is not authorized).</p>
  </dd>
  <dt>
    disable_watch ( watch )
  </dt>
  <dd>
    <p>Disables <strong>watch</strong>.</p>
  </dd>
  <dt>
    disable_service ( watch, service )
  </dt>
  <dd>
    <p>Disables a service, as specified by <strong>watch</strong> and <strong>service</strong>.</p>
  </dd>
  <dt>
    disable_host ( host )
  </dt>
  <dd>
    <p>Disables <strong>host</strong>.</p>
  </dd>
  <dt>
    enable_watch ( watch )
  </dt>
  <dd>
    <p>Enables <strong>watch</strong>.</p>
  </dd>
  <dt>
    enable_service ( watch, service )
  </dt>
  <dd>
    <p>Enables a service as specified by <strong>watch</strong> and <strong>service</strong>.</p>
  </dd>
  <dt>
    enable_host ( host )
  </dt>
  <dd>
    <p>Enables <strong>host</strong>.</p>
  </dd>
  <dt>
    set ( group, service, var, val )
  </dt>
  <dd>
    <p>Sets <strong>var</strong> in <strong>group,service</strong> to <strong>val</strong>. Returns undef on error.</p>
  </dd>
  <dt>
    get ( group, service, var )
  </dt>
  <dd>
    <p>Gets variable <strong>var</strong> in <strong>group,service</strong> and returns it, or undef on error.</p>
  </dd>
  <dt>
    quit
  </dt>
  <dd>
    <p>Logs out of the server. This method should be followed by a call to the <strong>disconnect</strong> method.</p>
  </dd>
  <dt>
    list_descriptions
  </dt>
  <dd>
    <p>Returns a hash of service descriptions, indexed by watch and service. For example:     %desc = $mon-&gt;list_descriptions;     print "$desc{&apos;watchname&apos;}-&gt;{&apos;servicename&apos;}&#92;n";</p>
  </dd>
  <dt>
    list_deps
  </dt>
  <dd>
    <p>Lists dependency expressions and their components for all services. If there is no dependency for a particular service, then the value will be \*(L"\s-1NONE\s0\*(R".     %deps = $mon-&gt;list_deps;     foreach $watch (keys %deps) {         foreach $service (keys %{$deps{$watch}}) {             my $sref = &#92;%{$deps{$watch}-&gt;{$service}};             print "expr ($watch,$service) = $sref-&gt;{expression}&#92;n";             print "components ($watch,$service) = @{$sref-&gt;{components}}&#92;n";         }     }</p>
  </dd>
  <dt>
    list_group ( hostgroup )
  </dt>
  <dd>
    <p>Lists members of <strong>hostgroup</strong>. Returns an array of each member.</p>
  </dd>
  <dt>
    list_watch
  </dt>
  <dd>
    <p>Returns an array of all the defined watch groups and services.     foreach $w ($mon-&gt;list_watch) {         print "group=$w-&gt;[0] service=$w-&gt;[1]&#92;n";     }</p>
  </dd>
  <dt>
    list_opstatus ( [group1, service1], ... )
  </dt>
  <dd>
    <p>Returns a hash of per-service operational statuses, as indexed by watch and service. The list of anonymous arrays is optional, and if is not provided then the status of all groups and services will be queried.     %s = $mon-&gt;list_opstatus;     foreach $watch (keys %s) {         foreach $service (keys %{$s{$watch}}) {             foreach $var (keys %{$s{$watch}{$service}}) {                 print "$watch $service $var=$s{$watch}{$service}{$var}&#92;n";             }         }     }</p>
  </dd>
  <dt>
    list_failures
  </dt>
  <dd>
    <p>Returns a hash in the same manner as <strong>list_opstatus</strong>, but only the services which are in a failure state.</p>
  </dd>
  <dt>
    list_successes
  </dt>
  <dd>
    <p>Returns a hash in the same manner as <strong>list_opstatus</strong>, but only the services which are in a success state.</p>
  </dd>
  <dt>
    list_disabled
  </dt>
  <dd>
    <p>Returns a hash of disabled watches, services, and hosts.     %d = $mon-&gt;list_disabled;</p><p>    foreach $group (keys %{$d{"hosts"}}) {         foreach $host (keys %{$d{"hosts"}{$group}}) {             print "host $group/$host disabled&#92;n";         }     }</p><p>    foreach $watch (keys %{$d{"services"}}) {         foreach $service (keys %{$d{"services"}{$watch}}) {             print "service $watch/$service disabled&#92;n";         }     }</p><p>    for (keys %{$d{"watches"}}) {         print "watch $_ disabled&#92;n";     }</p>
  </dd>
  <dt>
    list_alerthist
  </dt>
  <dd>
    <p>Returns an array of hash references containing the alert history.     @a = $mon-&gt;list_alerthist;</p><p>    for (@a) {         print join (" ",             $_-&gt;{"type"},             $_-&gt;{"watch"},             $_-&gt;{"service"},             $_-&gt;{"time"},             $_-&gt;{"alert"},             $_-&gt;{"args"},             $_-&gt;{"summary"},             "&#92;n",         );     }</p>
  </dd>
  <dt>
    list_dtlog
  </dt>
  <dd>
    <p>Returns an array of hash references containing the downtime log. @a = $mon-&gt;list_dtlog      for (@a) {        print join (" ",            $_-&gt;{"timeup"},            $_-&gt;{"group"},            $_-&gt;{"service"},            $_-&gt;{"failtime"},            $_-&gt;{"downtime"},            $_-&gt;{"interval"},            $_-&gt;{"summary"},            "&#92;n",        );      }</p>
  </dd>
  <dt>
    list_failurehist
  </dt>
  <dd>
    <p>Returns an array of hash references containing the failure history.     @f = $mon-&gt;list_failurehist;</p><p>    for (@f) {         print join (" ",             $_-&gt;{"watch"},             $_-&gt;{"service"},             $_-&gt;{"time"},             $_-&gt;{"summary"},             "&#92;n",         );     }</p>
  </dd>
  <dt>
    list_pids
  </dt>
  <dd>
    <p>Returns an array of hash references containing the list of process IDs of currently active monitors run by the server.     @p = $mon-&gt;list_pids;</p><p>    $server = shift @p;</p><p>    for (@p) {         print join (" ",             $_-&gt;{"watch"},             $_-&gt;{"service"},             $_-&gt;{"pid"},             "&#92;n",         );     }</p>
  </dd>
  <dt>
    list_state
  </dt>
  <dd>
    <p>Lists the state of the scheduler. Returns a two-element array. The first element of the array is 0 if the scheduler is stopped, and 1 if the scheduler is currently running. The second element of the array returned is the string \*(L"scheduler running\*(R" if the scheduler is currently running, and if the scheduler is stopped, the second element is the <em>time</em>\|(2) that the scheduler was stopped.     @s = $mon-&gt;list_state;</p><p>    if ($s[0] == 0) {         print "scheduler stopped since " . localtime ($s[1]) . "&#92;n";     }</p>
  </dd>
  <dt>
    start
  </dt>
  <dd>
    <p>Starts the scheduler.</p>
  </dd>
  <dt>
    stop
  </dt>
  <dd>
    <p>Stops the scheduler.</p>
  </dd>
  <dt>
    reset
  </dt>
  <dd>
    <p>Resets the server.</p>
  </dd>
  <dt>
    reload ( what )
  </dt>
  <dd>
    <p>Causes the server to reload its configuration. <strong>what</strong> is an optional argument, and currently the only supported option is <strong>auth</strong>, which reloads the authorization file.</p>
  </dd>
  <dt>
    term
  </dt>
  <dd>
    <p>Terminates the server.</p>
  </dd>
  <dt>
    set_maxkeep
  </dt>
  <dd>
    <p>Sets the maximum number of history entries to store in memory.</p>
  </dd>
  <dt>
    get_maxkeep
  </dt>
  <dd>
    <p>Returns the maximum number of history entries to store in memory.</p>
  </dd>
  <dt>
    test ( test, group, service [, exitval, period])
  </dt>
  <dd>
    <p>Schedules a service test to run immediately, or tests an alert for a given period. <strong>test</strong> must be <strong>monitor</strong>, <strong>alert</strong>, <strong>startupalert</strong>, or <strong>upalert</strong>. To test alerts, the <strong>exitval</strong> and <strong>period</strong> must be supplied. Periods are identified by their label in the mon config file. If there are no period tags, then the actual period string must be used, exactly as it is listed in the config file.</p>
  </dd>
  <dt>
    test_config
  </dt>
  <dd>
    <p>Tests the syntax of the configuration file. Returns a two-element array. The first element of the array is 0 if the syntax of the config file is invalid, and 1 if the syntax of the config file is \s-1OK\s0. The second element of the array returned is the failure message, if the config file has invalid syntax, and the result code if the config file syntax is \s-1OK\s0. This function returns undef if it cannot get a connection or a response from the mon server. Config file checking stops as soon as an error is found, so you will need to run this command more than once if you have multiple errors in your config file in order to find them all.     @s = $mon-&gt;test_config;</p><p>    if ($s[0] == 0) {         print "error in config file:&#92;n" . $s[1] . "&#92;n";     }</p>
  </dd>
  <dt>
    ack ( group, service, text )
  </dt>
  <dd>
    <p>When <strong>group/service</strong> is in a failure state, acknowledges this with <strong>text</strong>, and disables all further alerts during this failure period.</p>
  </dd>
  <dt>
    loadstate ( state )
  </dt>
  <dd>
    <p>Loads <strong>state</strong>.</p>
  </dd>
  <dt>
    savestate ( state )
  </dt>
  <dd>
    <p>Saves <strong>state</strong>.</p>
  </dd>
  <dt>
    servertime
  </dt>
  <dd>
    <p>Returns the time on the server using the same output as the <em>time</em>\|(2) system call. Sends a trap to a remote mon server. Here is an example:     $mon-&gt;send_trap (         group           =&gt; "remote-group",         service         =&gt; "remote-service",         retval          =&gt; 1,         opstatus        =&gt; "fail",         summary         =&gt; "hosta hostb hostc",         detail          =&gt; "hosta hostb and hostc are unresponsive",     ); <em>retval</em> must be a nonnegative integer. <em>opstatus</em> must be one of <em>fail</em>, <em>ok</em>, <em>coldstart</em>, <em>warmstart</em>, <em>linkdown</em>, <em>unknown</em>, <em>timeout</em>,  <em>untested</em>. Returns <em>undef</em> on error.</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Mon::Client.3pm.html"><span aria-hidden="true">&larr;</span> Mon::Client.3pm: Methods for interaction with mon client</a></li>
   <li class="next"><a href="Mon::Protocol.3pm.html">Mon::Protocol.3pm: Methods for parsing / dumping a protocol block <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
