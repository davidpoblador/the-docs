<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Logfile::Rotate: Perl module to rotate logfiles.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Perl module to rotate logfiles.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Logfile::Rotate (3pm) manual">
  <meta name="twitter:description" content="Perl module to rotate logfiles.">
  <meta name="twitter:image" content="https://www.carta.tech/images/liblogfile-rotate-perl-Logfile::Rotate-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Logfile::Rotate.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Logfile::Rotate (3pm) manual" />
  <meta property="og:description" content="Perl module to rotate logfiles." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/liblogfile-rotate-perl-Logfile::Rotate-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Logfile::Rotate<small> (3pm)</small></h1>
        <p class="lead">Perl module to rotate logfiles.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Logfile::Rotate.3pm.html">
      <span itemprop="name">Logfile::Rotate: Perl module to rotate logfiles.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/liblogfile-rotate-perl/">
      <span itemprop="name">liblogfile-rotate-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Logfile::Rotate.3pm.html">
      <span itemprop="name">Logfile::Rotate: Perl module to rotate logfiles.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
   use Logfile::Rotate;
   my $log = new Logfile::Rotate( File   =&gt; &apos;/var/adm/syslog/syslog.log&apos;,
                                  Count  =&gt; 7,
                                  Gzip  =&gt; &apos;lib&apos;,
                                  Post   =&gt; sub{
                                    open(IN, "/var/run/syslog.pid");
                                    kill("HUP", chomp(&lt;IN&gt;)); }
                                  Dir    =&gt; &apos;/var/log/old&apos;,
                                  Flock  =&gt; &apos;yes&apos;,
                                  Persist =&gt; &apos;yes&apos;,
                                );
</pre>
<p>   # process log file</p><p>   $log-&gt;rotate();</p><p>   or</p><p>   my $log = new Logfile::Rotate( File  =&gt; &apos;/var/adm/syslog&apos;,                                   Gzip   =&gt; &apos;/usr/local/bin/gzip&apos;);</p><p>   # process log file</p><p>   $log-&gt;rotate();    undef $log;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>I have used the name space of Logfile::Base package by <em>Ulrich Pfeifer</em>, as the use of this module closely relates to the processing logfiles.</p>
<dl class='dl-vertical'>
  <dt>
    new
  </dt>
  <dd>
    <p>\*(C`new\*(C' accepts the following arguments, \*(C`File\*(C', \*(C`Count\*(C', \*(C`Gzip\*(C', \*(C`Pre\*(C', \*(C`Post\*(C', \*(C`Flock\*(C' and \*(C`Dir\*(C' with only \*(C`File\*(C' being mandatory. \*(C`new\*(C' will open and lock the file, so you may co-ordinate the processing of the file with rotating it.  The file is closed and unlocked when the object is destroyed, so you can do this explicitly by \*(C`undef\*(C''ing the object. The \*(C`Pre\*(C'/\*(C`Post\*(C' arguments allow you to pass function references to this method, which you may use as a callback for any processing you want before or after the rotation. For example, you may notify the process writing to the file that it has been rotated. The \*(C`Pre\*(C' function is passed the current filename to be rotated as an argument and the \*(C`Post\*(C' function is passed the current filename that was rotated and that file's new filename including any extension added by compression previously. Both the \*(C`Pre\*(C' and \*(C`Post\*(C' function references you provide are executed within an \*(C`eval\*(C' statement inside the \*(C`rotate\*(C' method.  If the \*(C`eval\*(C' returns an error then the \*(C`rotate\*(C' method will croak at that point. The \*(C`Signal\*(C' argument is deprecated by the \*(C`Post\*(C' argument. The \*(C`Flock\*(C' argument allows you to specify whether the perl function \*(C`flock\*(C' is used to lock the file during the rotation operation. Apparently flock causes problems on some platforms and this option has been added to allow you to control the programs behaviour.  By default the file will be locked using \*(C`flock\*(C'. The \*(C`Persist\*(C' argument allows you to control whether the program will try and set the current log file ownership and permissions on any new files that may be created by the rotation.  In some circumstances the program doing the file rotation may not have sufficient permission to \*(C`chown\*(C' on the file.  By default the program will try and preserve ownership and permissions.</p>
  </dd>
  <dt>
    <em>rotate()</em>
  </dt>
  <dd>
    <p>This method will copy the file passed in \*(C`new\*(C' to a file of the same name, with a numeric extension and truncate the original file to zero length.  The numeric extension will range from 1 up to the value specified by Count, or 7 if none is defined, with 1 being the most recent file.  When Count is reached, the older file is discarded in a \s-1FIFO\s0 (first in, first out) fashion. If the argument \*(C`Dir\*(C' was given, all old files will be placed in the specified directory. The \*(C`Post\*(C' function is the last step executed by the rotate method so the return code of rotate will be the return code of the function you proved, or 1 by default. The copy function is implemented by using the File::Copy package, but I have had a few people suggest that they would prefer File::Move. I'm still not decided on this as you would loose data if the move should fail.</p>
  </dd>

</dl>
<p><strong>&#92;$1</strong></p><p>If available \*(C`rotate\*(C' will also compress the file with the gzip program or the program passed as the \*(C`Gzip\*(C' argument.</p><p>You may now also use \*(C`lib\*(C' as a value for the \*(C`Gzip\*(C' argument.  This directs the program to load the \*(C`Compress::Zlib\*(C' module, if available and use it do the compression within perl.  <strong>This avoids the security</strong> issues associated with spawning external programs and is the recommended value for this option.</p><p>If no argument is defined it will first check to see if the \*(C`Compress::Zlib\*(C' module can be loaded then check the perl Config to determine if gzip is available on your system. In this case the gzip must be in your current path to succeed, and accept the \*(C`-f\*(C' option.</p><p>See the \*(L"\s-1WARNING\s0\*(R" section below. If you specify an argument for \*(C`Dir\*(C' then the file being rotated will be relocated to the directory specified.  Along with any other files that may have been rotated previously.  If the directory name specified does not exist then it will be created with 0750 permissions.  If you wish to have other permissions on the directory then I would recommend you create the directory before using this module.</p><p>See the \*(L"\s-1WARNING\s0\*(R" section below.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">WARNING</h2>
        <div class="sectioncontent">
<p>If a system call is made to <em>gzip</em> this makes this module vulnerable to security problems if a rogue gzip is in your path or <em>gzip</em> has been sabotaged.  For this reason a \s-1STRONGLY\s0 \s-1RECOMMEND\s0 you \s-1DO\s0 \s-1NOT\s0 use this module while you are \s-1ROOT\s0.</p><p>For a more secure alternative install the \*(C`Compress::Zlib\*(C' module and use the <strong>lib</strong> value for the \*(C`Gzip\*(C' argument.</p><p>If you specify an argument for \*(C`Dir\*(C' and the directory name you pass does not exist, this module <strong>will create</strong> the directory with permissions 0750.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DEPENDANCIES</h2>
        <div class="sectioncontent">
<p>See File::Copy.</p><p>If \*(C`Gzip\*(C' is being used it must create files with an extension of \*(C`.gz\*(C' for the file to be picked by the rotate cycle.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (c) 1997-99 Paul Gampe. All rights reserved. This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p><p>\s-1IN\s0 \s-1NO\s0 \s-1EVENT\s0 \s-1SHALL\s0 \s-1THE\s0 \s-1AUTHORS\s0 \s-1OR\s0 \s-1DISTRIBUTORS\s0 \s-1BE\s0 \s-1LIABLE\s0 \s-1TO\s0 \s-1ANY\s0 \s-1PARTY\s0 \s-1FOR\s0 \s-1DIRECT\s0, \s-1INDIRECT\s0, \s-1SPECIAL\s0, \s-1INCIDENTAL\s0, \s-1OR\s0 \s-1CONSEQUENTIAL\s0 \s-1DAMAGES\s0 \s-1ARISING\s0 \s-1OUT\s0 \s-1OF\s0 \s-1THE\s0 \s-1USE\s0 \s-1OF\s0 \s-1THIS\s0 \s-1SOFTWARE\s0, \s-1ITS\s0 \s-1DOCUMENTATION\s0, \s-1OR\s0 \s-1ANY\s0 \s-1DERIVATIVES\s0 \s-1THEREOF\s0, \s-1EVEN\s0 \s-1IF\s0 \s-1THE\s0 \s-1AUTHORS\s0 \s-1HAVE\s0 \s-1BEEN\s0 \s-1ADVISED\s0 \s-1OF\s0 \s-1THE\s0 \s-1POSSIBILITY\s0 \s-1OF\s0 \s-1SUCH\s0 \s-1DAMAGE\s0.</p><p>\s-1THE\s0 \s-1AUTHORS\s0 \s-1AND\s0 \s-1DISTRIBUTORS\s0 \s-1SPECIFICALLY\s0 \s-1DISCLAIM\s0 \s-1ANY\s0 \s-1WARRANTIES\s0, \s-1INCLUDING\s0, \s-1BUT\s0 \s-1NOT\s0 \s-1LIMITED\s0 \s-1TO\s0, \s-1THE\s0 \s-1IMPLIED\s0 \s-1WARRANTIES\s0 \s-1OF\s0 \s-1MERCHANTABILITY\s0, \s-1FITNESS\s0 \s-1FOR\s0 A \s-1PARTICULAR\s0 \s-1PURPOSE\s0, \s-1AND\s0 \s-1NON-INFRINGEMENT\s0. \s-1THIS\s0 \s-1SOFTWARE\s0 \s-1IS\s0 \s-1PROVIDED\s0 \s-1ON\s0 \s-1AN\s0 ``\s-1AS\s0 \s-1IS\s0'' \s-1BASIS\s0, \s-1AND\s0 \s-1THE\s0 \s-1AUTHORS\s0 \s-1AND\s0 \s-1DISTRIBUTORS\s0 \s-1HAVE\s0 \s-1NO\s0 \s-1OBLIGATION\s0 \s-1TO\s0 \s-1PROVIDE\s0 \s-1MAINTENANCE\s0, \s-1SUPPORT\s0, \s-1UPDATES\s0, \s-1ENHANCEMENTS\s0, \s-1OR\s0 \s-1MODIFICATIONS\s0.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Logfile::Rotate&hellip;</h2>
        <div class="sectioncontent">
<p>File::Copy, Logfile::Base, flock <em>Changes</em> file for change history and credits for contributions.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN</h2>
        <div class="sectioncontent">
<p>All functions return 1 on success, 0 on failure.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Paul Gampe &lt;paulg@apnic.net&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Log::Trace::Manual.3pm.html"><span aria-hidden="true">&larr;</span> Log::Trace::Manual.3pm: A guide to using log::trace</a></li>
   <li class="next"><a href="Logger::Syslog.3pm.html">Logger::Syslog.3pm: An intuitive wrapper over syslog for perl <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
