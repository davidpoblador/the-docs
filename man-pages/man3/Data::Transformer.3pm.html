<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Data::Transformer: Traverse a data structure, altering it in place</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Traverse a data structure, altering it in place">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Data::Transformer (3pm) manual">
  <meta name="twitter:description" content="Traverse a data structure, altering it in place">
  <meta name="twitter:image" content="https://www.carta.tech/images/libdata-transformer-perl-Data::Transformer-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Data::Transformer.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Data::Transformer (3pm) manual" />
  <meta property="og:description" content="Traverse a data structure, altering it in place" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libdata-transformer-perl-Data::Transformer-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Data::Transformer<small> (3pm)</small></h1>
        <p class="lead">Traverse a data structure, altering it in place</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Data::Transformer.3pm.html">
      <span itemprop="name">Data::Transformer: Traverse a data structure, altering it in place</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libdata-transformer-perl/">
      <span itemprop="name">libdata-transformer-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Data::Transformer.3pm.html">
      <span itemprop="name">Data::Transformer: Traverse a data structure, altering it in place</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
 use Data::Transformer;

 # A: SIMPLE USAGE:
 # trim extra whitespace from normal strings inside %data.
 my $trim = sub { local($_)=shift; $$_ =~ s/^&#92;s*//; $$_ =~ s/&#92;s*$//; };
 my $t = Data::Transformer-&gt;new(normal=&gt;$trim);
 $t-&gt;traverse(&#92;%data);

 # B: MORE COMPLEX USAGE:
 # (a) uppercase all keys in all hashes contained in $data
 # and (b) convert any arrays to hashes:
 my $uc_hash = sub {
   my $h = shift;
   my @keys = keys %h;
   foreach (@keys) {
     my $uc = uc($_);
     if ($uc ne $_ && !exists($h-&gt;{$uc})) {
       $h-&gt;{$uc} = $h-&gt;{$_};
       delete $h-&gt;{$_};
     } elsif ($uc ne $_) {
       die "Bad key $_: &apos;$uc&apos; exists already";
     }
   }
 };
 my $ar_conv = sub {
   my %h = @{$_[0]};
   return sub { &#92;%h };
 };
 my $t = Data::Transformer-&gt;new(
    hash       =&gt; $uc_hash,
    array      =&gt; $ar_conv,
    node_limit =&gt; 500_000 );
 eval { $t-&gt;traverse($data) };
 warn "Could not complete transformation: $@" if $@;

 # C: NON-DESTRUCTIVE TRAVERSAL
 # You don&apos;t actually have to change anything...
 my $size = 0;
 my $t = Data::Transformer-&gt;new(
    normal =&gt; sub { $size+=length(${ $_[0] }) },
    hash   =&gt; sub { $size+=length($_) for keys %{ $_[0] } },
 );
 my $nodes = $t-&gt;tranverse(&#92;%data);
 print "Number of nodes: $nodes&#92;n";
 print "Size of keys + values: $size&#92;n";

 # D: OBJECTS INSIDE A DATA STRUCTURE
 # Affect objects by using the class name as a key:
 my $t = Data::Transformer-&gt;new(
    &apos;My::Class&apos; =&gt; sub { shift-&gt;set_foo(&apos;bar&apos;) }
 );
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<h3>Data type callbacks</h3>
<p>The basic idea is that you provide a callback subroutine for each type of data that you wish to affect or collect information from.</p><p>The constructor, \*(C`new()\*(C', expects a hash with at least one of the following keys:</p><p> * normal : used for normal, non-reference data  * array  : used for array references  * hash   : used for hash references  * code   : used for anonymous subroutines (coderefs)  * scalar : used for scalar references  * glob   : used for globs (such as filehandle holders)</p><p>The value in each case is a coderef representing the callback for the data type in question.</p><p>The array and hash types are special in that they are traversed into.</p><p>It is possible to affect objects inside the data structure by specifying a callback keyed to the name of the class they belong to. They are not automatically recursed into, however, even if they happen to be blessed hash or array references.</p><p>Similarly, a scalar reference is not automatically traversed into, even if it may contain a reference to an arrayref or a hashref. To make the module traverse into scalar references, you need to return a coderef encapsulating a different data type in the scalar handler, thus changing them (and prompting a reiteration over that data point). This applies to objects as well.</p>
<h3>Additional option for the constructor</h3>

<dl class='dl-vertical'>
  <dt>
    node_limit:
  </dt>
  <dd>
    <p>If an integer value for this is specified, it overrides the default node processing limit of 2**16. This cannot be set higher than 2**20-1.</p>
  </dd>

</dl>

<h3>\fItraverse()\fP</h3>
<p>The <em>traverse()</em> method returns the number of nodes processed. This may be different from both the number of nodes in the actual data structure and the number of nodes after the transformation, for the following reasons:</p><p> * Reiteration into a particular node may have occurred, which    increments the node count.</p><p> * Blessed references (objects) will not normally be iterated into,    but are merely treated as leaves in the data structure.</p><p> * The processing code passed to the constructor may well affect the    number of nodes.</p>
<h3>Note on data type changes</h3>
<p>If you want to change a data type (for instance replace an array by a hash as in example B, above) you have to return a coderef from the callback for the original data type. This coderef encapsulates the replacement data for the node in question.</p><p>After the node has thus been replaced, it is re-evaluated to apply any transformations you may have defined for the new data type.</p><p>Be careful of potential infinite loops when doing this with more than one data type at a time or when replacing coderefs with other coderefs. Also, because of reiteration, complex changes of large data structures may require setting the node processing limit higher than the default.</p>
<h3>Note on circular references</h3>
<p>Data structures containing circular references should not cause problems. Data::Transformer will skip any node containing a reference which has already been processed.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CAVEATS</h2>
        <div class="sectioncontent">
<p>It is not feasible to use this module for very large data structures. Accordingly, there is a hard node processing boundary of 2**20-1 (about 1 million); attempting to set the limit higher results in an immediate, fatal error. For the vast majority of cases, however, the default limit of 2**16 (about 65 thousand) should be more than enough.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Data::Transformer&hellip;</h2>
        <div class="sectioncontent">
<p>I am aware of two modules doing similar things. Check them out if this one does not fit your needs:</p><ul>
<li><p>Data::Rmap by Brad Bowman</p></li><li><p>Data::Walk by Guido Flohr</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Baldur Kristinsson &lt;bk@mbl.is&gt;, 2006</p><p> Copyright (c) 2006 Baldur Kristinsson. All rights reserved.  This program is free software; you can redistribute it and/or  modify it under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Data::Stream::Bulk::Util.3pm.html"><span aria-hidden="true">&larr;</span> Data::Stream::Bulk::Util.3pm: Utility functions for data::stream::bulk</a></li>
   <li class="next"><a href="Data::TreeDumper.3pm.html">Data::TreeDumper.3pm: Improved replacement for data::dumper. powerful filtering capability. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
