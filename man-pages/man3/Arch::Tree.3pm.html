<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Arch::Tree: Class representing arch tree</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Class representing arch tree">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Arch::Tree (3pm) manual">
  <meta name="twitter:description" content="Class representing arch tree">
  <meta name="twitter:image" content="https://www.carta.tech/images/libarch-perl-Arch::Tree-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Arch::Tree.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Arch::Tree (3pm) manual" />
  <meta property="og:description" content="Class representing arch tree" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libarch-perl-Arch::Tree-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Arch::Tree<small> (3pm)</small></h1>
        <p class="lead">Class representing arch tree</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Arch::Tree.3pm.html">
      <span itemprop="name">Arch::Tree: Class representing arch tree</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libarch-perl/">
      <span itemprop="name">libarch-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Arch::Tree.3pm.html">
      <span itemprop="name">Arch::Tree: Class representing arch tree</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    use Arch::Tree;
    my $tree = Arch::Tree-&gt;new;  # assume the current dir

    print map { "$_&#92;n" } $tree-&gt;get_log_versions;

    foreach my $log ($tree-&gt;get_logs) {
        print "-" x 80, "&#92;n";
        print $log-&gt;standard_date, "&#92;n";
        print $log-&gt;summary, "&#92;n&#92;n";
        print $log-&gt;body;
    }
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This class represents the working tree concept in Arch and provides some useful methods.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>The following methods are available:</p><p><strong>new</strong>, <strong>root</strong>, <strong>get_version</strong>, <strong>set_version</strong>, <strong>get_log_versions</strong>, <strong>add_log_version</strong>, <strong>get_log_revisions</strong>, <strong>get_log</strong>, <strong>get_logs</strong>, <strong>get_log_revision_descs</strong>, <strong>get_inventory</strong>, <strong>get_changes</strong>, <strong>get_changeset</strong>, <strong>get_merged_log_text</strong>, <strong>get_merged_revision_summaries</strong>, <strong>get_merged_revisions</strong>, <strong>get_missing_revisions</strong>, <strong>get_missing_revision_descs</strong>, <strong>get_previous_revision</strong>, <strong>get_ancestry_logs</strong>, <strong>get_history_revision_descs</strong>, <strong>get_annotate_revision_descs</strong>, <strong>clear_cache</strong>, <strong>add</strong>, <strong>delete</strong>, <strong>mode</strong>, <strong>get_file_diff</strong>, <strong>make_log</strong>, <strong>import</strong>, <strong>commit</strong>.</p>
<dl class='dl-vertical'>
  <dt>
    <strong>new</strong> [<em>dir-name</em>]
  </dt>
  <dd>
    <p>Construct the Arch::Tree object associated with the existing directory <em>dir-name</em>. The default is the current '.' directory.</p>
  </dd>
  <dt>
    <strong>root</strong>
  </dt>
  <dd>
    <p>Returns the project tree root.</p>
  </dd>
  <dt>
    <strong>get_version</strong>
  </dt>
  <dd>
    <p>Returns the fully qualified tree version.</p>
  </dd>
  <dt>
    <strong>get_revision</strong>
  </dt>
  <dd>
    <p>Returns the fully qualified tree revision.</p>
  </dd>
  <dt>
    <strong>set_version</strong> <em>version</em>
  </dt>
  <dd>
    <p>Changes the tree version to <em>version</em>.</p>
  </dd>
  <dt>
    <strong>get_log_versions</strong>
  </dt>
  <dd>
    <p>Returns all version names (including the main one and merged ones) for which logs are stored in the tree. In the scalar context returns arrayref.</p>
  </dd>
  <dt>
    <strong>add_log_version</strong> <em>version</em>
  </dt>
  <dd>
    <p>Add log version <em>version</em> to project tree.</p>
  </dd>
  <dt>
    <strong>get_log_revisions</strong> [<em>version</em>]
  </dt>
  <dd>
    <p>Returns all revision names of the given <em>version</em> (the default is the tree version) for which logs are stored in the tree. In the scalar context returns arrayref.</p>
  </dd>
  <dt>
    <strong>get_log</strong> <em>revision</em>
  </dt>
  <dd>
    <p>Return Arch::Log object corresponding to the tree log of the given <em>revision</em>.</p>
  </dd>
  <dt>
    <strong>get_logs</strong> [<em>version</em>]
  </dt>
  <dd>
    <p>Return Arch::Log objects corresponding to the tree logs of the given <em>version</em>. In the scalar context returns arrayref. The default <em>version</em> is the tree version (see \*(C`get_version\*(C'). A special version name '*' may be used, in this case all logs in \*(C`get_log_versions\*(C' are returned. <em>version</em> may be arrayref as well with the similar results.</p>
  </dd>
  <dt>
    <strong>get_log_revision_descs</strong> [<em>version</em>]
  </dt>
  <dd>
    <p>Returns arrayref of log revision description hashes corresponding to <em>version</em>. The optional <em>version</em> argument may get the same values that are supported by <strong>get_logs</strong>.</p>
  </dd>
  <dt>
    <strong>get_inventory</strong>
  </dt>
  <dd>
    <p>Returns Arch::Inventory object for the project tree.</p>
  </dd>
  <dt>
    <strong>get_changes</strong>
  </dt>
  <dd>
    <p>Returns a list of uncommited changes in the project tree.</p>
  </dd>
  <dt>
    <strong>get_changeset</strong> <em>dir</em>
  </dt>
  <dd>
    <p>Creates an <strong>Arch::Changeset</strong> of the uncommited changes in the tree. The directory <em>dir</em> is used to store the changeset and must not already exist. It will not be automatically removed.</p>
  </dd>
  <dt>
    <strong>get_merged_log_text</strong>
  </dt>
  <dd>
    <p>This is just the output of \*(L"tla log-for-merge\*(R".</p>
  </dd>
  <dt>
    <strong>get_merged_revision_summaries</strong>
  </dt>
  <dd>
    <p>Returns hash (actually sorted array of pairs) or hashref in the scalar context. The pair is for every merged revision: full-name =&gt; summary.</p>
  </dd>
  <dt>
    <strong>get_merged_revisions</strong>
  </dt>
  <dd>
    <p>The list of all merged in (present in the changes) full revisions. In the scalar context returns arrayref.</p>
  </dd>
  <dt>
    <strong>get_missing_revisions</strong> [<em>version</em>]
  </dt>
  <dd>
    <p>The list of all missing revisions corresponding to <em>version</em>. In the scalar context returns arrayref. The default <em>version</em> is the tree version (see \*(C`get_version\*(C').</p>
  </dd>
  <dt>
    <strong>get_missing_revision_descs</strong> [<em>version</em>]
  </dt>
  <dd>
    <p>The hashref of all missing revision descriptions corresponding to <em>version</em>. The hash keys are revisions and the values are hashrefs with keys <em>name</em>, <em>summary</em>, <em>creator</em>, <em>email</em>, <em>date</em>, <em>kind</em>. The default <em>version</em> is the tree version (see \*(C`get_version\*(C').</p>
  </dd>
  <dt>
    <strong>get_previous_revision</strong> [&lt;revision&gt;]
  </dt>
  <dd>
    <p>Given the fully qualified revision name (defaulting to <strong>get_revision</strong>) return the previous namespace revision in this tree version. Return undef for the <em>base-0</em> revision. Note, the <em>version-0</em> revision argument is handled specially. Return all ancestry revision logs (calculated from the tree). The first log in the returned arrayref corresponds to the current tree revision, the last log is normally the original import log. If the tree has certain logs pruned (such practice is not recommended), then such pruned log is not returned and this method tries its best to determine its ancestor, still without accessing the archive. <em></em><strong>%args</strong><em></em> accepts: flags <em>no_continuation</em> and <em>one_version</em>, and <em>callback</em> to filter a revision log before it is collected. If <em>no_continuation</em> is set, then do not follow tags backward. If <em>one_version</em> is set, then do not follow tags from the versions different than the initial version. This is similar to <em>no_continuation</em>, but not the same, since it is possible to tag into the same version. The default callback is effectivelly:     sub {         my ($log) = @_;         return $log;     } Note that if the callback does $_[0] = undef among other things, this is taken as a signal to stop processing of ancestry (the return value is still collected even in this case; return empty list to collect nothing). Return arrayref of all ancestry revision descriptions in the backward order (i.e. from a more recent to an older). If <em>filepath</em> is given, then only revisions that modified the given file (or dir) are returned. The revision description is hashref with keys <em>name</em>, <em>summary</em>, <em>creator</em>, <em>email</em>, <em>date</em>, <em>kind</em>. If <em>filepath</em> if given, then the revision description hash additionally contains keys <em>filepath</em>, <em>orig_filepath</em> (if renamed on that revision), <em>is_filepath_added</em>, <em>is_filepath_renamed</em> and <em>is_filepath_modified</em>. <em></em><strong>%args</strong><em></em> accepts: flags <em>no_continuation</em> and <em>one_version</em>, and <em>callback</em> to filter a revision description before it is collected. The default callback is effectivelly:     sub {         my ($revision_desc, $log) = @_;         return $revision_desc;     } The <em></em><strong>%args</strong><em></em> flags and assigning to $_[0] in callback have the same meaning as in <strong>get_ancestry_logs</strong>. Return file annotation data. In scalar context, returns arrayref of all ancestry revision descriptions in the backward order (i.e. from a more recent to an older) responsible for last modification of all file lines. In list context, returns list of 3 values:     ($lines, $line_revision_desc_indexes, $revision_descs) =         $tree-&gt;get_annotate_revision_descs($filename); $lines is arrayref that contains all <em>filepath</em> lines with no end-of-line; $line_revision_desc_indexes is arrayref of the same length that contains indexes to the $revision_descs arrayref. Note that $revision_descs is the same returned in the scalar context, it is similar to the one returned by <strong>get_history_revision_descs</strong>, but possibly contains less elements, since some revisions only modified metadata, or only modified lines that were modified by other revisions afterward, all such revisions are not included. If some lines can't be annotated (usually, because the history was cut), then the corresonding $line_revision_desc_indexes elements are undefined. <em></em><strong>%args</strong><em></em> accepts: flags <em>no_continuation</em> and <em>one_version</em>, and <em>callback</em> to filter a revision description before it is collected. The default callback is effectivelly:     sub {         my ($revision_desc, $log) = @_;         return $revision_desc;     } The <em></em><strong>%args</strong><em></em> flags and assigning to $_[0] in callback have the same meaning as in <strong>get_ancestry_logs</strong> and <strong>get_history_revision_descs</strong>. Additionally, <em>prefetch_callback</em> is supported. If given, it is called before fetching a changeset, with two arguments: revision, and filename to look at the patch of which. More <em></em><strong>%args</strong><em></em> keys are <em>linenums</em> (either string or arrayref or hashref), <em>match_re</em> (regular expression to filter lines). And flags <em>highlight</em> (syntax highlight lines using markup), <em>full_history</em> (include all file history revision even those that didn't add the current file lines).</p>
  </dd>
  <dt>
    <strong>clear_cache</strong> [key ..]
  </dt>
  <dd>
    <p>For performance reasons, some method results are cached (memoized in fact). Use this method to explicitly request this cache to be cleared. By default all cached keys are cleared; <em>key</em> may be one of the strings 'missing_revision_descs', 'missing_revisions'.</p>
  </dd>
  <dt>
    <strong>add</strong> [{ <em>options</em> }] <em>files ...</em>
  </dt>
  <dd>
    <p>Add exlicit inventory ids for <em>files</em>. A specific inventory id may be passed via the <em>options</em> hash with the key \*(C`id\*(C'.</p>
  </dd>
  <dt>
    <strong>delete</strong> <em>files ...</em>
  </dt>
  <dd>
    <p>Delete explicit inventory ids for <em>files</em>.</p>
  </dd>
  <dt>
    <strong>move</strong> <em>old_file</em> <em>new_file</em>
  </dt>
  <dd>
    <p>Move exlicit file id for <em>old_file</em> to <em>new_file</em>.</p>
  </dd>
  <dt>
    <strong>get_file_diff</strong> <em>file</em>
  </dt>
  <dd>
    <p>Get modifications for <em>file</em> as unified diff.</p>
  </dd>
  <dt>
    <strong>make_log</strong>
  </dt>
  <dd>
    <p>Create a new commit log, if it does not yet exist. Returns the filename.</p>
  </dd>
  <dt>
    <strong>import</strong> [{ <em>options</em> }] [<em>version</em>]
  </dt>
  <dd>
    <p>Similar to 'tla import'.</p>
  </dd>
  <dt>
    <strong>commit</strong> [{ <em>options</em> }] [<em>version</em>]
  </dt>
  <dd>
    <p>Commit changes in tree. Note, <em>version</em> argument is not supported in newer baz versions. Optional file limits may be passed using <em>files</em> arrayref in <em>options</em>.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Awaiting for your reports.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Mikhael Goikhman (migo@homemail.com\*(--Perl-GPL/arch-perl\*(--devel).</p><p>Enno Cramer (uebergeek@web.de--2003/arch-perl\*(--devel).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Arch::Tree&hellip;</h2>
        <div class="sectioncontent">
<p>For more information, see tla, Arch::Log, Arch::Inventory, Arch::Changes, Arch::Util, Arch::Name.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Arch::Test::Tree.3pm.html"><span aria-hidden="true">&larr;</span> Arch::Test::Tree.3pm: A test framework for arch-perl</a></li>
   <li class="next"><a href="Arch::Util.3pm.html">Arch::Util.3pm: Arch utility functions <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
