<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Nagios::Plugin::Getopt: Oo perl module providing standardised argument processing for nagios plugins</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Oo perl module providing standardised argument processing for nagios plugins">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Nagios::Plugin::Getopt (3pm) manual">
  <meta name="twitter:description" content="Oo perl module providing standardised argument processing for nagios plugins">
  <meta name="twitter:image" content="https://www.carta.tech/images/libnagios-plugin-perl-Nagios::Plugin::Getopt-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Nagios::Plugin::Getopt.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Nagios::Plugin::Getopt (3pm) manual" />
  <meta property="og:description" content="Oo perl module providing standardised argument processing for nagios plugins" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libnagios-plugin-perl-Nagios::Plugin::Getopt-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Nagios::Plugin::Getopt<small> (3pm)</small></h1>
        <p class="lead">Oo perl module providing standardised argument processing for nagios plugins</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Nagios::Plugin::Getopt.3pm.html">
      <span itemprop="name">Nagios::Plugin::Getopt: Oo perl module providing standardised argument processing for nagios plugins</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libnagios-plugin-perl/">
      <span itemprop="name">libnagios-plugin-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Nagios::Plugin::Getopt.3pm.html">
      <span itemprop="name">Nagios::Plugin::Getopt: Oo perl module providing standardised argument processing for nagios plugins</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use Nagios::Plugin::Getopt;

  # Instantiate object (usage is mandatory)
  $ng = Nagios::Plugin::Getopt-&gt;new(
    usage =&gt; "Usage: %s -H &lt;host&gt; -w &lt;warning&gt; -c &lt;critical&gt;",
    version =&gt; &apos;0.1&apos;,
    url =&gt; &apos;http://www.openfusion.com.au/labs/nagios/&apos;,
    blurb =&gt; &apos;This plugin tests various stuff.&apos;,
  );

  # Add argument - named parameters (spec and help are mandatory)
  $ng-&gt;arg(
    spec =&gt; &apos;critical|c=i&apos;,
    help =&gt; q(Exit with CRITICAL status if fewer than INTEGER foobars are free),
    required =&gt; 1,
    default =&gt; 10,
  );

  # Add argument - positional parameters - arg spec, help text,
  #   default value, required? (first two mandatory)
  $ng-&gt;arg(
    &apos;warning|w=i&apos;,
    q(Exit with WARNING status if fewer than INTEGER foobars are free),
    5,
    1);

  # Parse arguments and process standard ones (e.g. usage, help, version)
  $ng-&gt;getopts;

  # Access arguments using named accessors or or via the generic get()
  print $ng-&gt;warning;
  print $ng-&gt;get(&apos;critical&apos;);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Nagios::Plugin::Getopt is an \s-1OO\s0 perl module providing standardised and simplified argument processing for Nagios plugins. It implements a number of standard arguments itself (--help, --version, --usage, --timeout, --verbose, and their short form counterparts), produces standardised nagios plugin help output, and allows additional arguments to be easily defined.</p><h3>\s-1CONSTRUCTOR\s0</h3>
<p>  # Instantiate object (usage is mandatory)   $ng = Nagios::Plugin::Getopt-&gt;new(     usage =&gt; &apos;Usage: %s --hello&apos;,     version =&gt; &apos;0.01&apos;,   );</p><p>The Nagios::Plugin::Getopt constructor accepts the following named arguments:</p>
<dl class='dl-vertical'>
  <dt>
    usage (required)
  </dt>
  <dd>
    <p>Short usage message used with --usage/-? and with missing required arguments, and included in the longer --help output. Can include a '%s' sprintf placeholder which will be replaced with the plugin name e.g.   usage =&gt; qq(Usage: %s -H &lt;hostname&gt; -p &lt;ports&gt; [-v]), might be displayed as:   $ ./check_tcp_range --usage   Usage: check_tcp_range -H &lt;hostname&gt; -p &lt;ports&gt; [-v]</p>
  </dd>
  <dt>
    version (required)
  </dt>
  <dd>
    <p>Plugin version number, included in the --version/-V output, and in the longer --help output. e.g.   $ ./check_tcp_range --version   check_tcp_range 0.2 [http://www.openfusion.com.au/labs/nagios/]</p>
  </dd>
  <dt>
    url
  </dt>
  <dd>
    <p>\s-1URL\s0 for info about this plugin, included in the --version/-V output, and in the longer --help output (see preceding 'version' example).</p>
  </dd>
  <dt>
    blurb
  </dt>
  <dd>
    <p>Short plugin description, included in the longer --help output (see below for an example).</p>
  </dd>
  <dt>
    license
  </dt>
  <dd>
    <p>License text, included in the longer --help output (see below for an example). By default, this is set to the standard nagios plugins \s-1GPL\s0 license text:   This nagios plugin is free software, and comes with ABSOLUTELY   NO WARRANTY. It may be used, redistributed and/or modified under   the terms of the GNU General Public Licence (see   http://www.fsf.org/licensing/licenses/gpl.txt). Provide your own to replace this text in the help output.</p>
  </dd>
  <dt>
    extra
  </dt>
  <dd>
    <p>Extra text to be appended at the end of the longer --help output.</p>
  </dd>
  <dt>
    plugin
  </dt>
  <dd>
    <p>Plugin name. This defaults to the basename of your plugin, which is usually correct, but you can set it explicitly if not.</p>
  </dd>
  <dt>
    timeout
  </dt>
  <dd>
    <p>Timeout period in seconds, overriding the standard timeout default (15 seconds).</p>
  </dd>

</dl>
<p>The full --help output has the following form:</p><p>  version string</p><p>  license string</p><p>  blurb</p><p>  usage string</p><p>  options list</p><p>  extra text</p><p>The 'blurb' and 'extra text' sections are omitted if not supplied. For example:</p><p>  $ ./check_tcp_range -h   check_tcp_range 0.2 [http://www.openfusion.com.au/labs/nagios/]</p><p>  This nagios plugin is free software, and comes with ABSOLUTELY NO WARRANTY.   It may be used, redistributed and/or modified under the terms of the GNU   General Public Licence (see http://www.fsf.org/licensing/licenses/gpl.txt).</p><p>  This plugin tests arbitrary ranges/sets of tcp ports for a host.</p><p>  Usage: check_tcp_range -H &lt;hostname&gt; -p &lt;ports&gt; [-v]</p><p>  Options:    -h, --help      Print detailed help screen    -V, --version      Print version information    -H, --hostname=ADDRESS      Host name or IP address    -p, --ports=STRING      Port numbers to check. Format: comma-separated, colons for ranges,      no spaces e.g. 8700:8705,8710:8715,8760    -t, --timeout=INTEGER      Seconds before plugin times out (default: 15)    -v, --verbose      Show details for command-line debugging (can repeat up to 3 times)</p>
<h3>\s-1ARGUMENTS\s0</h3>
<p>You can define arguments for your plugin using the <em>arg()</em> method, which supports both named and positional arguments. In both cases the \*(C`spec\*(C' and \*(C`help\*(C' arguments are required, while the \*(C`label\*(C', \*(C`default\*(C', and \*(C`required\*(C' arguments are optional:</p><p>  # Define --hello argument (named parameters)   $ng-&gt;arg(     spec =&gt; &apos;hello|h=s&apos;,     help =&gt; "Hello string",     required =&gt; 1,   );</p><p>  # Define --hello argument (positional parameters)   #   Parameter order is &apos;spec&apos;, &apos;help&apos;, &apos;default&apos;, &apos;required?&apos;, &apos;label&apos;   $ng-&gt;arg(&apos;hello|h=s&apos;, "Hello parameter (default %s)", 5, 1);</p>
<dl class='dl-vertical'>
  <dt>
    spec
  </dt>
  <dd>
    <p>The \*(C`spec\*(C' argument (the first argument in the positional variant) is a Getopt::Long argument specification. See Getopt::Long for the details, but basically it is a series of one or more argument names for this argument (separated by '|'), suffixed with an '=&lt;type&gt;' indicator if the argument takes a value. '=s' indicates a string argument; '=i' indicates an integer argument; appending an '@' indicates multiple such arguments are accepted; and so on. The following are some examples:</p>
<dl class='dl-vertical'>
  <dt>
    hello=s
  </dt>
  <dd>
    
  </dd>
  <dt>
    hello|h=s
  </dt>
  <dd>
    
  </dd>
  <dt>
    ports|port|p=i
  </dt>
  <dd>
    
  </dd>
  <dt>
    exclude|X=s@
  </dt>
  <dd>
    
  </dd>
  <dt>
    verbose|v+
  </dt>
  <dd>
    
  </dd>

</dl>

  </dd>
  <dt>
    help
  </dt>
  <dd>
    <p>The \*(C`help\*(C' argument is a string displayed in the --help option list output, or it can be a list (an arrayref) of such strings, for multi-line help (see below). The help string is munged in two ways:</p><ul>
<li><p>First, if the help string does \s-1NOT\s0 begins with a '-' sign, it is prefixed by an expanded form of the \*(C`spec\*(C' argument. For instance, the following hello argument:   $ng-&gt;arg(     spec =&gt; &apos;hello|h=s&apos;,     help =&gt; "Hello string",   ); would be displayed in the help output as:   -h, --hello=STRING     Hello string where the '-h, --hello=STRING' part is derived from the spec definition (by convention with short args first, then long, then label/type, if any).</p></li><li><p>Second, if the string contains a '%s' it will be formatted via \*(C`sprintf\*(C' with the 'default' as the argument i.e.   sprintf($help, $default)</p></li>
</ul><p>Multi-line help is useful in cases where an argument can be of different types and you want to make this explicit in your help output e.g.   $ng-&gt;arg(     spec =&gt; &apos;warning|w=s&apos;,     help =&gt; [       &apos;Exit with WARNING status if less than BYTES bytes of disk are free&apos;,       &apos;Exit with WARNING status if less than PERCENT of disk is free&apos;,     ],     label =&gt; [ &apos;BYTES&apos;, &apos;PERCENT%&apos; ],   ); would be displayed in the help output as:  -w, --warning=BYTES     Exit with WARNING status if less than BYTES bytes of disk are free  -w, --warning=PERCENT%     Exit with WARNING status if less than PERCENT of disk space is free Note that in this case we've also specified explicit labels in another arrayref corresponding to the \*(C`help\*(C' one - if this had been omitted the types would have defaulted to '\s-1STRING\s0', instead of '\s-1BYTES\s0' and 'PERCENT%'.</p>
  </dd>
  <dt>
    label
  </dt>
  <dd>
    <p>The \*(C`label\*(C' argument is a scalar or an arrayref (see 'Multi-line help' description above) that overrides the standard type expansion when generating help text from the spec definition. By default, \*(C`spec=i\*(C' arguments are labelled as \*(C`=INTEGER\*(C' in the help text, and \*(C`spec=s\*(C' arguments are labelled as \*(C`=STRING\*(C'. By supplying your own \*(C`label\*(C' argument you can override these standard '\s-1INTEGER\s0' and '\s-1STRING\s0' designations. For multi-line help, you can supply an ordered list (arrayref) of labels to match the list of help strings e.g.   label =&gt; [ &apos;BYTES&apos;, &apos;PERCENT%&apos; ] Any labels that are left as undef (or just omitted, if trailing) will just use the default '\s-1INTEGER\s0' or '\s-1STRING\s0' designations e.g.   label =&gt; [ undef, &apos;PERCENT%&apos; ]</p>
  </dd>
  <dt>
    default
  </dt>
  <dd>
    <p>The \*(C`default\*(C' argument is the default value to be given to this parameter if none is explicitly supplied.</p>
  </dd>
  <dt>
    required
  </dt>
  <dd>
    <p>The \*(C`required\*(C' argument is a boolean used to indicate that this argument is mandatory (Nagios::Plugin::Getopt will exit with your usage message and a 'Missing argument' indicator if any required arguments are not supplied).</p>
  </dd>

</dl>
<p>Note that --help lists your arguments in the order they are defined, so you should order your \*(C`arg()\*(C' calls accordingly.</p>
<h3>\s-1GETOPTS\s0</h3>
<p>The main parsing and processing functionality is provided by the <em>getopts()</em> method, which takes no arguments:</p><p>  # Parse and process arguments   $ng-&gt;getopts;</p><p>This parses the command line arguments passed to your plugin using Getopt::Long and the builtin and provided argument specifications. Flags and argument values are recorded within the object, and can be accessed either using the generic <em>get()</em> accessor, or using named accessors corresponding to your argument names. For example:</p><p>  print $ng-&gt;get(&apos;hello&apos;);   print $ng-&gt;hello();</p><p>  if ($ng-&gt;verbose) {     # ...   }</p><p>  if ($ng-&gt;get(&apos;ports&apos;) =~ m/:/) {     # ...   }</p><p>Note that where you have defined alternate argument names, the first is considered the citation form. All the builtin arguments are available using their long variant names.</p>
<h3>\s-1BUILTIN\s0 \s-1PROCESSING\s0</h3>
<p>The \*(C`getopts()\*(C' method also handles processing of the immediate builtin arguments, namely --usage, --version, --help, as well as checking all required arguments have been supplied, so you don't have to handle those yourself. This means that your plugin will exit from the <em>getopts()</em> call in these cases - if you want to catch that you can run <em>getopts()</em> within an eval{}.</p><p>\*(C`getopts()\*(C' also sets up a default \s-1ALRM\s0 timeout handler so you can use an</p><p>  alarm $ng-&gt;timeout;</p><p>around any blocking operations within your plugin (which you are free to override if you want to use a custom timeout message).</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Nagios::Plugin::Getopt&hellip;</h2>
        <div class="sectioncontent">
<p>Nagios::Plugin, Getopt::Long</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Gavin Carr &lt;gavin@openfusion.com.au&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT AND LICENSE</h2>
        <div class="sectioncontent">
<p>Copyright (C) 2006-2007 by the Nagios Plugin Development Team.</p><p>This module is free software. It may be used, redistributed and/or modified under either the terms of the Perl Artistic License (see http://www.perl.com/perl/misc/Artistic.html) or the \s-1GNU\s0 General Public Licence (see http://www.fsf.org/licensing/licenses/gpl.txt).</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Nagios::Plugin::Functions.3pm.html"><span aria-hidden="true">&larr;</span> Nagios::Plugin::Functions.3pm: Functions to simplify the creation of nagios plugins</a></li>
   <li class="next"><a href="Nagios::Plugin::Performance.3pm.html">Nagios::Plugin::Performance.3pm: Class for handling nagios::plugin performance data. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
