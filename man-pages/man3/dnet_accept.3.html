<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>dnet_accept: Decnet daemon functions</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Decnet daemon functions">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="dnet_accept (3) manual">
  <meta name="twitter:description" content="Decnet daemon functions">
  <meta name="twitter:image" content="https://www.carta.tech/images/libdnet-dev-dnet_accept-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/dnet_accept.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="dnet_accept (3) manual" />
  <meta property="og:description" content="Decnet daemon functions" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libdnet-dev-dnet_accept-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">dnet_accept<small> (3)</small></h1>
        <p class="lead">Decnet daemon functions</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/dnet_accept.3.html">
      <span itemprop="name">dnet_accept: Decnet daemon functions</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libdnet-dev/">
      <span itemprop="name">libdnet-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/dnet_accept.3.html">
      <span itemprop="name">dnet_accept: Decnet daemon functions</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>#include &lt;netdnet/dn.h&gt;</strong></p><p><strong>#include &lt;netdnet/dnetdb.h&gt;</strong></p><p><strong>-ldnet -ldnet_daemon -lcrypt</strong></p><p><strong>int dnet_daemon (int object, char *named_object, int verbosity, int do_fork)</strong></p><p><strong>void dnet_accept (int sockfd, short status, char *data, int len)</strong></p><p><strong>void dnet_reject (int sockfd, short status, char *data, int len)</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>These functions are the core of writing a DECnet daemon under Linux. They provide all the functionality necessary to have a daemon that will run standalone or be forked from the <a href="../man8/dnetd.8.html"><strong>dnetd</strong>(8)</a></strong> DECnet super-server. (see <strong>dnetd.conf</strong>(3)</strong> for information on configuring <strong>dnetd.</strong></p><p><strong>dnet_daemon()</strong> returns a connected file descriptor which your daemon program uses to talk to the remote client. If your daemon is run from dnetd then this will be it's standard input.</p><p><strong>object</strong> is the numbered object which your daemon binds to. Alternatively you can bind to a</p><p><strong>named_object</strong> in which case the object number should be zero.</p><p><strong>verbosity</strong> determines how much logging the daemon functions will do. 0 means no logging, 1 is fairly verbose logging. Anything higher is useful only for debugging.</p><p><strong>do_fork</strong> If this is set then, when running standalone, the daemon will fork and detach itself from the parent process.</p><p><strong>dnet_accept()</strong> You MUST call this or dnetd_reject() after receiving a valid file descriptor from dnet_daemon. The optional data and status parameters provide extra information to the connecting host. See below for status values.</p><p><strong>dnet_reject()</strong> If you wish to reject the connection for any reason the call this function instead of <strong>dnet_accept()</strong> with the status set to the reason (see below) you are rejecting the connection. If your daemon is authenticated by dnetd then connections will already be rejected if they are not correctly authorized by either a valid username/password or the proxy database (see <strong>decnet.proxy</strong>(3)</strong> )</p><p>Here is a list of status codes available in dnetd.conf:</p>
<pre>
#define DNSTAT_REJECTED         0 /* Rejected by object */
#define DNSTAT_RESOURCES        1 /* No resources available */
#define DNSTAT_NODENAME         2 /* Unrecognised node name */
#define DNSTAT_LOCNODESHUT      3 /* Local Node is shut down */
#define DNSTAT_OBJECT           4 /* Unrecognised object */
#define DNSTAT_OBJNAMEFORMAT    5 /* Invalid object name format */
#define DNSTAT_TOOBUSY          6 /* Object too busy */
#define DNSTAT_NODENAMEFORMAT  10 /* Invalid node name format */
#define DNSTAT_REMNODESHUT     11 /* Remote Node is shut down */
#define DNSTAT_ACCCONTROL      34 /* Access control rejection */
#define DNSTAT_NORESPONSE      38 /* No response from object */
#define DNSTAT_NODEUNREACH     39 /* Node Unreachable */

/* Disconnect notification errors */
#define DNSTAT_MANAGEMENT       8 /* Abort by management/third party */
#define DNSTAT_ABORTOBJECT      9 /* Remote object aborted the link */
#define DNSTAT_FAILED          38 /* Node or object failed */

#define DNSTAT_NODERESOURCES   32 /* Node does not have sufficient resources for a new link */
#define DNSTAT_OBJRESOURCES    33 /* Object does not have sufficient resources for a new link */
#define DNSTAT_BADACCOUNT      36 /* The Account field in unacceptable */
#define DNSTAT_TOOLONG         43 /* A field in the access control message was too long */

</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>Here is an example MIRROR server. The real mirror server is built into dnetd. This also illustrates the logging functions in libdnetd_daemon.</p>
<pre>
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;stdarg.h&gt;
#include &lt;syslog.h&gt;
#include &lt;netdnet/dnetdb.h&gt;
#include &lt;netdnet/dn.h&gt;

int main(int argc, char *argv[])
{
    int insock;

    /* Set up logging. The parameters are:
     * daemon name to use
     * 's' means log to syslog
     */
    init_daemon_logging("mirror", 's');

    // Wait for something to happen (or check to see if it already has)
    insock = dnet_daemon(DNOBJECT_MIRROR, NULL, 0, 1);

    // Make sure we got a valid socket
    if (insock &gt; -1)
    {
        int readnum;
        char condata[] = {0x00, 0x20}; // Actually 4096 as a LE word
        char ibuf[4096];

        /* We must accept the connection */
        dnet_accept(insock, 0, condata, 2);

        while ( (readnum=read(insock,ibuf,sizeof(ibuf))) &gt; 0)
        {
            ibuf[0]=0x01;
            if (write(insock,ibuf,readnum) &lt; 0)
            {
                DNETLOG((LOG_WARNING, "mirror, write failed: %m&#92;n"));
                close(insock);
                break;
            }
        }
        close(insock);
    }
    return 0;
}

To compile:
gcc mirror.c -omirror -ldnet -ldnet_daemon -lcrypt

</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO dnet_accept&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/dnetd.8.html"><strong>dnetd</strong>(8)</a>, <a href="../man3/dnet_addr.3.html"><strong>dnet_addr</strong>(3)</a>, <a href="../man3/dnet_ntoa.3.html"><strong>dnet_ntoa</strong>(3)</a>, <a href="../man3/dnet_conn.3.html"><strong>dnet_conn</strong>(3)</a>, <a href="../man3/getnodeadd.3.html"><strong>getnodeadd</strong>(3)</a>, <a href="../man3/getnodebyname.3.html"><strong>getnodebyname</strong>(3)</a>, <a href="../man3/getnodebyaddr.3.html"><strong>getnodebyaddr</strong>(3)</a>, <a href="../man3/setnodeent.3.html"><strong>setnodeent</strong>(3)</a>, <a href="../man5/decnet.proxy.5.html"><strong>decnet.proxy</strong>(5)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="dn_expand.3.html"><span aria-hidden="true">&larr;</span> dn_expand.3: Resolver routines</a></li>
   <li class="next"><a href="dnet_addr.3.html">dnet_addr.3: Decnet nodename to address translation <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
