<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>crypt_r: Password and data encryption</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Password and data encryption">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="crypt_r (3) manual">
  <meta name="twitter:description" content="Password and data encryption">
  <meta name="twitter:image" content="https://www.carta.tech/images/manpages-dev-crypt_r-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/crypt_r.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="crypt_r (3) manual" />
  <meta property="og:description" content="Password and data encryption" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/manpages-dev-crypt_r-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">crypt_r<small> (3)</small></h1>
        <p class="lead">Password and data encryption</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/crypt_r.3.html">
      <span itemprop="name">crypt_r: Password and data encryption</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/manpages-dev/">
      <span itemprop="name">manpages-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/crypt_r.3.html">
      <span itemprop="name">crypt_r: Password and data encryption</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>#define _XOPEN_SOURCE</strong>       /* See <a href="../man7/feature_test_macros.7.html"><strong>feature_test_macros</strong>(7)</a> */

<strong>#include &lt;unistd.h&gt;</strong>

<strong>char *crypt(const char *</strong><em>key</em><strong>, const char *</strong><em>salt</em><strong>);</strong>

<strong>#define _GNU_SOURCE</strong>         /* See <a href="../man7/feature_test_macros.7.html"><strong>feature_test_macros</strong>(7)</a> */

<strong>#include &lt;crypt.h&gt;</strong>

<strong>char *crypt_r(const char *</strong><em>key</em><strong>, const char *</strong><em>salt</em><strong>,</strong>
<strong>              struct crypt_data *</strong><em>data</em><strong>);</strong>
</pre>
<p>Link with <em>-lcrypt</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>crypt</strong>() is the password encryption function. It is based on the Data Encryption Standard algorithm with variations intended (among other things) to discourage use of hardware implementations of a key search.</p><p><em>key</em> is a user's typed password.</p><p><em>salt</em> is a two-character string chosen from the set [<strong>a-zA-Z0-9./</strong>]. This string is used to perturb the algorithm in one of 4096 different ways.</p><p>By taking the lowest 7 bits of each of the first eight characters of the <em>key</em>, a 56-bit key is obtained. This 56-bit key is used to encrypt repeatedly a constant string (usually a string consisting of all zeros). The returned value points to the encrypted password, a series of 13 printable ASCII characters (the first two characters represent the salt itself). The return value points to static data whose content is overwritten by each call.</p><p>Warning: The key space consists of equal 7.2e16 possible values. Exhaustive searches of this key space are possible using massively parallel computers. Software, such as <strong>crack</strong>(1), is available which will search the portion of this key space that is generally used by humans for passwords. Hence, password selection should, at minimum, avoid common words and names. The use of a <a href="../man1/passwd.1.html"><strong>passwd</strong>(1)</a> program that checks for crackable passwords during the selection process is recommended.</p><p>The DES algorithm itself has a few quirks which make the use of the <strong>crypt</strong>() interface a very poor choice for anything other than password authentication. If you are planning on using the <strong>crypt</strong>() interface for a cryptography project, don't do it: get a good book on encryption and one of the widely available DES libraries.</p><p><strong>crypt_r</strong>() is a reentrant version of <strong>crypt</strong>(). The structure pointed to by <em>data</em> is used to store result data and bookkeeping information. Other than allocating it, the only thing that the caller should do with this structure is to set <em>data-&gt;initialized</em> to zero before the first call to <strong>crypt_r</strong>().</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>On success, a pointer to the encrypted password is returned. On error, NULL is returned.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>EINVAL</strong></p>
  </dt>
  <dd>
    <p><em>salt</em> has the wrong format.</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>ENOSYS</strong></p>
  </dt>
  <dd>
    <p>The <strong>crypt</strong>() function was not implemented, probably because of U.S.A. export restrictions.</p>
  </dd>
  <dt>
    <p><strong>EPERM</strong></p>
  </dt>
  <dd>
    <p><em>/proc/sys/crypto/fips_enabled</em> has a nonzero value, and an attempt was made to use a weak encryption type, such as DES.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ATTRIBUTES</h2>
        <div class="sectioncontent">
<h3>Multithreading (see <a href="../man7/pthreads.7.html"><strong>pthreads</strong>(7)</a>)</h3>
<p>The <strong>crypt</strong>() function is not thread-safe.</p><p>The <strong>crypt_r</strong>() function is thread-safe.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFORMING TO</h2>
        <div class="sectioncontent">
<p><strong>crypt</strong>(): SVr4, 4.3BSD, POSIX.1-2001. <strong>crypt_r</strong>() is a GNU extension.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<h3>Glibc notes</h3>
<p>The glibc2 version of this function supports additional encryption algorithms.</p><p>If <em>salt</em> is a character string starting with the characters "$<em>id</em>$" followed by a string terminated by "$":</p><p>$<em>id</em>$<em>salt</em>$<em>encrypted</em></p><p>then instead of using the DES machine, <em>id</em> identifies the encryption method used and this then determines how the rest of the password string is interpreted. The following values of <em>id</em> are supported:</p><table class="table table-striped">
<tr>
<th>ID  | Method</th>
<th></th></tr>

<tr>
<td>1   | MD5</td>
<td></td></tr>

<tr>
<td>2a  | Blowfish (not in mainline glibc; added in some</td>
<td></td></tr>

<tr>
<td>    | Linux distributions)</td>
<td></td></tr>

<tr>
<td>5   | SHA-256 (since glibc 2.7)</td>
<td></td></tr>

<tr>
<td>6   | SHA-512 (since glibc 2.7)</td>
<td></td></tr>
</table><p>So $5$<em>salt</em>$<em>encrypted</em> is an SHA-256 encoded password and $6$<em>salt</em>$<em>encrypted</em> is an SHA-512 encoded one.</p><p>"<em>salt</em>" stands for the up to 16 characters following "$<em>id</em>$" in the salt. The encrypted part of the password string is the actual computed password. The size of this string is fixed:</p><table class="table table-striped">
<tr>
<th>MD5     | 22 characters</th>
<th></th></tr>

<tr>
<td>SHA-256 | 43 characters</td>
<td></td></tr>

<tr>
<td>SHA-512 | 86 characters</td>
<td></td></tr>
</table><p>The characters in "<em>salt</em>" and "<em>encrypted</em>" are drawn from the set [<strong>a-zA-Z0-9./</strong>]. In the MD5 and SHA implementations the entire <em>key</em> is significant (instead of only the first 8 bytes in DES).</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO crypt_r&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/login.1.html"><strong>login</strong>(1)</a>, <a href="../man1/passwd.1.html"><strong>passwd</strong>(1)</a>, <a href="../man3/encrypt.3.html"><strong>encrypt</strong>(3)</a>, <a href="../man3/getpass.3.html"><strong>getpass</strong>(3)</a>, <a href="../man5/passwd.5.html"><strong>passwd</strong>(5)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COLOPHON</h2>
        <div class="sectioncontent">
<p>This page is part of release 3.74 of the Linux <em>man-pages</em> project. A description of the project, information about reporting bugs, and the latest version of this page, can be found at http://www.kernel.org/doc/man-pages/.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="crypt.3.html"><span aria-hidden="true">&larr;</span> crypt.3: Password and data encryption</a></li>
   <li class="next"><a href="cs_destroy.3.html">cs_destroy.3: Clean up and dealloc a parse tree <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
