<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Authen::Passphrase::MD5Crypt: Passphrases using the md5-based unix crypt()</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Passphrases using the md5-based unix crypt()">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Authen::Passphrase::MD5Crypt (3pm) manual">
  <meta name="twitter:description" content="Passphrases using the md5-based unix crypt()">
  <meta name="twitter:image" content="https://www.carta.tech/images/libauthen-passphrase-perl-Authen::Passphrase::MD5Crypt-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Authen::Passphrase::MD5Crypt.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Authen::Passphrase::MD5Crypt (3pm) manual" />
  <meta property="og:description" content="Passphrases using the md5-based unix crypt()" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libauthen-passphrase-perl-Authen::Passphrase::MD5Crypt-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Authen::Passphrase::MD5Crypt<small> (3pm)</small></h1>
        <p class="lead">Passphrases using the md5-based unix crypt()</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Authen::Passphrase::MD5Crypt.3pm.html">
      <span itemprop="name">Authen::Passphrase::MD5Crypt: Passphrases using the md5-based unix crypt()</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libauthen-passphrase-perl/">
      <span itemprop="name">libauthen-passphrase-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Authen::Passphrase::MD5Crypt.3pm.html">
      <span itemprop="name">Authen::Passphrase::MD5Crypt: Passphrases using the md5-based unix crypt()</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
        use Authen::Passphrase::MD5Crypt;

        $ppr = Authen::Passphrase::MD5Crypt-&gt;new(
                        salt =&gt; "Vd3f8aG6",
                        hash_base64 =&gt; "GcsdF4YCXb0PM2UmXjIoI1");

        $ppr = Authen::Passphrase::MD5Crypt-&gt;new(
                        salt_random =&gt; 1,
                        passphrase =&gt; "passphrase");

        $ppr = Authen::Passphrase::MD5Crypt-&gt;from_crypt(
                &apos;$1$Vd3f8aG6$GcsdF4YCXb0PM2UmXjIoI1&apos;);

        $ppr = Authen::Passphrase::MD5Crypt-&gt;from_rfc2307(
                &apos;{CRYPT}$1$Vd3f8aG6$GcsdF4YCXb0PM2UmXjIoI1&apos;);

        $salt = $ppr-&gt;salt;
        $hash_base64 = $ppr-&gt;hash_base64;

        if($ppr-&gt;match($passphrase)) { ...

        $passwd = $ppr-&gt;as_crypt;
        $userPassword = $ppr-&gt;as_rfc2307;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>An object of this class encapsulates a passphrase hashed using the MD5-based Unix <em>crypt()</em> hash function.  This is a subclass of Authen::Passphrase, and this document assumes that the reader is familiar with the documentation for that class.</p><p>The <em>crypt()</em> function in a modern Unix actually supports several different passphrase schemes.  This class is concerned only with one particular scheme, an MD5-based algorithm designed by Poul-Henning Kamp and originally implemented in FreeBSD.  To handle the whole range of passphrase schemes supported by the modern <em>crypt()</em>, see the from_crypt constructor and the as_crypt method in Authen::Passphrase.</p><p>The MD5-based <em>crypt()</em> scheme uses the whole passphrase, a salt which can in principle be an arbitrary byte string, and the \s-1MD5\s0 message digest algorithm.  First the passphrase and salt are hashed together, yielding an \s-1MD5\s0 message digest.  Then a new digest is constructed, hashing together the passphrase, the salt, and the first digest, all in a rather complex form.  Then this digest is passed through a thousand iterations of a function which rehashes it together with the passphrase and salt in a manner that varies between rounds.  The output of the last of these rounds is the resulting passphrase hash.</p><p>In the <em>crypt()</em> function the raw hash output is then represented in \s-1ASCII\s0 as a 22-character string using a base 64 encoding.  The base 64 digits are "<strong>.</strong>\*(L", \*(R"<strong>/</strong>\*(L", \*(R"<strong>0</strong>\*(L" to \*(R"<strong>9</strong>\*(L", \*(R"<strong>A</strong>\*(L" to \*(R"<strong>Z</strong>\*(L", \*(R"<strong>a</strong>\*(L" to \*(R"<strong>z</strong>" (in \s-1ASCII\s0 order).  Because the base 64 encoding can represent 132 bits in 22 digits, more than the 128 required, the last digit can only take four of the base 64 digit values.  An additional complication is that the bytes of the raw algorithm output are permuted in a bizarre order before being represented in base 64.</p><p>There is no tradition of handling these passphrase hashes in raw binary form.  The textual encoding described above, including the final permutation, is used universally, so this class does not support any binary format.</p><p>The complex algorithm was designed to be slow to compute, in order to resist brute force attacks.  However, the complexity is fixed, and the operation of Moore's Law has rendered it far less expensive than intended.  If efficiency of a brute force attack is a concern, see Authen::Passphrase::BlowfishCrypt.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONSTRUCTORS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    Authen::Passphrase::MD5Crypt-&gt;new(\s-1ATTR\s0 =&gt; \s-1VALUE\s0, ...)
  </dt>
  <dd>
    <p>Generates a new passphrase recogniser object using the MD5-based <em>crypt()</em> algorithm.  The following attributes may be given:</p>
<dl class='dl-vertical'>
  <dt>
    <strong>salt</strong>
  </dt>
  <dd>
    <p>The salt, as a raw string.  It may be any byte string, but in <em>crypt()</em> usage it is conventionally limited to zero to eight base 64 digits.</p>
  </dd>
  <dt>
    <strong>salt_random</strong>
  </dt>
  <dd>
    <p>Causes salt to be generated randomly.  The value given for this attribute is ignored.  The salt will be a string of eight base 64 digits. The source of randomness may be controlled by the facility described in Data::Entropy.</p>
  </dd>
  <dt>
    <strong>hash_base64</strong>
  </dt>
  <dd>
    <p>The hash, as a string of 22 base 64 digits.  This is the final part of what <em>crypt()</em> outputs.</p>
  </dd>
  <dt>
    <strong>passphrase</strong>
  </dt>
  <dd>
    <p>A passphrase that will be accepted.</p>
  </dd>

</dl>
<p>The salt must be given, and either the hash or the passphrase.</p>
  </dd>
  <dt>
    Authen::Passphrase::MD5Crypt-&gt;from_crypt(\s-1PASSWD\s0)
  </dt>
  <dd>
    <p>Generates a new passphrase recogniser object using the MD5-based <em>crypt()</em> algorithm, from a crypt string.  The crypt string must consist of "<strong></strong><strong>$1</strong><strong>$</strong>\*(L", the salt, \*(R"<strong>$</strong>\*(L", then 22 base 64 digits giving the hash. The salt may be up to 8 characters long, and cannot contain \*(R"<strong>$</strong>" or any character that cannot appear in a crypt string.</p>
  </dd>
  <dt>
    Authen::Passphrase::MD5Crypt-&gt;from_rfc2307(\s-1USERPASSWORD\s0)
  </dt>
  <dd>
    <p>Generates a new passphrase recogniser object using the MD5-based <em>crypt()</em> algorithm, from an \s-1RFC\s0 2307 string.  The string must consist of "<strong>{\s-1CRYPT\s0}</strong>" (case insensitive) followed by an acceptable crypt string.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>Returns the salt, in raw form. Returns the hash value, as a string of 22 base 64 digits. These methods are part of the standard Authen::Passphrase interface. Not every passphrase recogniser of this type can be represented as a crypt string: the crypt format only allows the salt to be up to eight bytes, and it cannot contain any \s-1NUL\s0 or "<strong>$</strong>" characters.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Authen::Passphrase::MD5Crypt&hellip;</h2>
        <div class="sectioncontent">
<p>Authen::Passphrase, Crypt::PasswdMD5</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Andrew Main (Zefram) &lt;zefram@fysh.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (C) 2006, 2007, 2009, 2010, 2012 Andrew Main (Zefram) &lt;zefram@fysh.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE</h2>
        <div class="sectioncontent">
<p>This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Authen::Passphrase::LANManagerHalf.3pm.html"><span aria-hidden="true">&larr;</span> Authen::Passphrase::LANManagerHalf.3pm: Passphrases using half the lan manager algorithm</a></li>
   <li class="next"><a href="Authen::Passphrase::MySQL323.3pm.html">Authen::Passphrase::MySQL323.3pm: Passphrases using the mysql v3.23 algorithm <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
