<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MPI_Reduce_local.openmpi: Perform a local reduction</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Perform a local reduction">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="MPI_Reduce_local.openmpi (3) manual">
  <meta name="twitter:description" content="Perform a local reduction">
  <meta name="twitter:image" content="https://www.carta.tech/images/openmpi-doc-MPI_Reduce_local.openmpi-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/MPI_Reduce_local.openmpi.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="MPI_Reduce_local.openmpi (3) manual" />
  <meta property="og:description" content="Perform a local reduction" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/openmpi-doc-MPI_Reduce_local.openmpi-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">MPI_Reduce_local.openmpi<small> (3)</small></h1>
        <p class="lead">Perform a local reduction</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/MPI_Reduce_local.openmpi.3.html">
      <span itemprop="name">MPI_Reduce_local.openmpi: Perform a local reduction</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/openmpi-doc/">
      <span itemprop="name">openmpi-doc</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/MPI_Reduce_local.openmpi.3.html">
      <span itemprop="name">MPI_Reduce_local.openmpi: Perform a local reduction</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNTAX</h2>
        <div class="sectioncontent">

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">C Syntax</h2>
        <div class="sectioncontent">

<pre>
#include &lt;mpi.h&gt;
int MPI_Reduce_local(void *<em>inbuf</em>, void *<em>inoutbuf</em>, int<em> count</em>,
	MPI_Datatype<em> datatype</em>, MPI_Op<em> op</em>)

</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Fortran Syntax</h2>
        <div class="sectioncontent">

<pre>
INCLUDE 'mpif.h'
MPI_REDUCE_LOCAL(<em>INBUF, INOUTBUF, COUNT, DATATYPE, OP, IERROR</em>)
	&lt;type&gt;	<em>INBUF(*), INOUTBUF(*)</em>
	INTEGER	<em>COUNT, DATATYPE, OP, IERROR</em>

</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">C++ Syntax</h2>
        <div class="sectioncontent">

<pre>
#include &lt;mpi.h&gt;
void MPI::Op::Reduce_local(const void* <em>inbuf</em>, void* <em>inoutbuf</em>,
	int <em>count</em>, const MPI::Datatype& <em>datatype</em>, const MPI::Op& <em>op</em>) const

</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INPUT PARAMETERS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>inbuf</p>
  </dt>
  <dd>
    <p>Address of input buffer (choice).</p>
  </dd>
  <dt>
    <p>count</p>
  </dt>
  <dd>
    <p>Number of elements in input buffer (integer).</p>
  </dd>
  <dt>
    <p>datatype</p>
  </dt>
  <dd>
    <p>Data type of elements of input buffer (handle).</p>
  </dd>
  <dt>
    <p>op</p>
  </dt>
  <dd>
    <p>Reduce operation (handle).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OUTPUT PARAMETERS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>inoutbuf</p>
  </dt>
  <dd>
    <p>Address of in/out buffer (choice).</p>
  </dd>
  <dt>
    <p>IERROR</p>
  </dt>
  <dd>
    <p>Fortran only: Error status (integer).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><em>The MPI_Reduce_local function is proposed for MPI-2.2 and (as of 10 Jan 2009) has not yet been ratified. Use at your own risk. See https://svn.mpi-forum.org/trac/mpi-forum-web/ticket/24.</em></p><p>The global reduce functions (MPI_Reduce_local, MPI_Op_create, MPI_Op_free, MPI_Allreduce, MPI_Reduce_local_scatter, MPI_Scan) perform a global reduce operation (such as sum, max, logical AND, etc.) across all the members of a group. The reduction operation can be either one of a predefined list of operations, or a user-defined operation. The global reduction functions come in several flavors: a reduce that returns the result of the reduction at one node, an all-reduce that returns this result at all nodes, and a scan (parallel prefix) operation. In addition, a reduce-scatter operation combines the functionality of a reduce and a scatter operation.</p><p>MPI_Reduce_local combines the elements provided in the input and input/output buffers of the local process, using the operation op, and returns the combined value in the inout/output buffer. The input buffer is defined by the arguments inbuf, count, and datatype; the output buffer is defined by the arguments inoutbuf, count, and datatype; both have the same number of elements, with the same type. The routine is a local call.  The process can provide one element, or a sequence of elements, in which case the combine operation is executed element-wise on each entry of the sequence. For example, if the operation is MPI_MAX and the input buffer contains two elements that are floating-point numbers (count = 2 and datatype = MPI_FLOAT), then <strong>inoutbuf</strong>(1) = global max (<strong>inbuf</strong>(1)) and <strong>inoutbuf</strong>(2) = global max(<strong>inbuf</strong>(2)).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USE OF IN-PLACE OPTION</h2>
        <div class="sectioncontent">
<p>The use of MPI_IN_PLACE is disallowed with MPI_Reduce_local.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PREDEFINED REDUCE OPERATIONS</h2>
        <div class="sectioncontent">
<p>The set of predefined operations provided by MPI is listed below (Predefined Reduce Operations). That section also enumerates the datatypes each operation can be applied to. In addition, users may define their own operations that can be overloaded to operate on several datatypes, either basic or derived. This is further explained in the description of the user-defined operations (see the man pages for MPI_Op_create and MPI_Op_free).</p><p>The operation op is always assumed to be associative. All predefined operations are also assumed to be commutative. Users may define operations that are assumed to be associative, but not commutative. The ``canonical'' evaluation order of a reduction is determined by the ranks of the processes in the group. However, the implementation can take advantage of associativity, or associativity and commutativity, in order to change the order of evaluation. This may change the result of the reduction for operations that are not strictly associative and commutative, such as floating point addition.</p><p>Predefined operators work only with the MPI types listed below (Predefined Reduce Operations, and the section MINLOC and MAXLOC, below).  User-defined operators may operate on general, derived datatypes. In this case, each argument that the reduce operation is applied to is one element described by such a datatype, which may contain several basic values. This is further explained in Section 4.9.4 of the MPI Standard, "User-Defined Operations."</p><p>The following predefined operations are supplied for MPI_Reduce_local and related functions MPI_Allreduce, MPI_Reduce_scatter, and MPI_Scan. These operations are invoked by placing the following in op:</p>
<pre>
	Name                Meaning
     ---------           --------------------
	MPI_MAX             maximum
	MPI_MIN             minimum
	MPI_SUM             sum
	MPI_PROD            product
	MPI_LAND            logical and
	MPI_BAND            bit-wise and
	MPI_LOR             logical or
	MPI_BOR             bit-wise or
	MPI_LXOR            logical xor
	MPI_BXOR            bit-wise xor
	MPI_MAXLOC          max value and location
	MPI_MINLOC          min value and location
</pre>
<p>The two operations MPI_MINLOC and MPI_MAXLOC are discussed separately below (MINLOC and MAXLOC). For the other predefined operations, we enumerate below the allowed combinations of op and datatype arguments. First, define groups of MPI basic datatypes in the following way:</p>
<pre>
	C integer:            MPI_INT, MPI_LONG, MPI_SHORT,
	                      MPI_UNSIGNED_SHORT, MPI_UNSIGNED,
	                      MPI_UNSIGNED_LONG
	Fortran integer:      MPI_INTEGER
	Floating-point:       MPI_FLOAT, MPI_DOUBLE, MPI_REAL,
	                      MPI_DOUBLE_PRECISION, MPI_LONG_DOUBLE
	Logical:              MPI_LOGICAL
	Complex:              MPI_COMPLEX
	Byte:                 MPI_BYTE
</pre>
<p>Now, the valid datatypes for each option is specified below.</p>
<pre>
	Op                      	Allowed Types
     ----------------         ---------------------------
	MPI_MAX, MPI_MIN		C integer, Fortran integer,
						floating-point

	MPI_SUM, MPI_PROD 		C integer, Fortran integer,
						floating-point, complex

	MPI_LAND, MPI_LOR,		C integer, logical
	MPI_LXOR

	MPI_BAND, MPI_BOR,		C integer, Fortran integer, byte
	MPI_BXOR
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MINLOC AND MAXLOC</h2>
        <div class="sectioncontent">
<p>The operator MPI_MINLOC is used to compute a global minimum and also an index attached to the minimum value. MPI_MAXLOC similarly computes a global maximum and index. One application of these is to compute a global minimum (maximum) and the rank of the process containing this value.</p><p>The operation that defines MPI_MAXLOC is</p>
<pre>
         ( u )    (  v )      ( w )
         (   )  o (    )   =  (   )
         ( i )    (  j )      ( k )

where

    w = max(u, v)

and

         ( i            if u &gt; v
         (
   k   = ( min(i, j)    if u = v
         (
         (  j           if u &lt; v)


MPI_MINLOC is defined similarly:

         ( u )    (  v )      ( w )
         (   )  o (    )   =  (   )
         ( i )    (  j )      ( k )

where

    w = min(u, v)

and

         ( i            if u &lt; v
         (
   k   = ( min(i, j)    if u = v
         (
         (  j           if u &gt; v)


</pre>
<p>Both operations are associative and commutative. Note that if MPI_MAXLOC is applied to reduce a sequence of pairs (u(0), 0), (u(1), 1),&nbsp;..., (u(n-1), n-1), then the value returned is (u , r), where u= max(i) u(i) and r is the index of the first global maximum in the sequence. Thus, if each process supplies a value and its rank within the group, then a reduce operation with op = MPI_MAXLOC will return the maximum value and the rank of the first process with that value. Similarly, MPI_MINLOC can be used to return a minimum and its index. More generally, MPI_MINLOC computes a lexicographic minimum, where elements are ordered according to the first component of each pair, and ties are resolved according to the second component.</p><p>The reduce operation is defined to operate on arguments that consist of a pair: value and index. For both Fortran and C, types are provided to describe the pair. The potentially mixed-type nature of such arguments is a problem in Fortran. The problem is circumvented, for Fortran, by having the MPI-provided type consist of a pair of the same type as value, and coercing the index to this type also. In C, the MPI-provided pair type has distinct types and the index is an int.</p><p>In order to use MPI_MINLOC and MPI_MAXLOC in a reduce operation, one must provide a datatype argument that represents a pair (value and index). MPI provides nine such predefined datatypes. The operations MPI_MAXLOC and MPI_MINLOC can be used with each of the following datatypes:</p>
<pre>
    Fortran:
    Name                     Description
    MPI_2REAL                pair of REALs
    MPI_2DOUBLE_PRECISION    pair of DOUBLE-PRECISION variables
    MPI_2INTEGER             pair of INTEGERs

    C:
    Name        	    	Description
    MPI_FLOAT_INT            float and int
    MPI_DOUBLE_INT           double and int
    MPI_LONG_INT             long and int
    MPI_2INT                 pair of ints
    MPI_SHORT_INT            short and int
    MPI_LONG_DOUBLE_INT      long double and int
</pre>
<p>The data type MPI_2REAL is equivalent to:</p>
<pre>
    MPI_TYPE_CONTIGUOUS(2, MPI_REAL, MPI_2REAL)
</pre>
<p>Similar statements apply for MPI_2INTEGER, MPI_2DOUBLE_PRECISION, and MPI_2INT.</p><p>The datatype MPI_FLOAT_INT is as if defined by the following sequence of instructions.</p>
<pre>
    type[0] = MPI_FLOAT
    type[1] = MPI_INT
    disp[0] = 0
    disp[1] = sizeof(float)
    block[0] = 1
    block[1] = 1
    MPI_TYPE_STRUCT(2, block, disp, type, MPI_FLOAT_INT)
</pre>
<p>Similar statements apply for MPI_LONG_INT and MPI_DOUBLE_INT.</p><p>All MPI objects (e.g., MPI_Datatype, MPI_Comm) are of type INTEGER in Fortran.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES ON COLLECTIVE OPERATIONS</h2>
        <div class="sectioncontent">
<p>The reduction operators ( <em>MPI_Op</em> ) do not return an error value.  As a result, if the functions detect an error, all they can do is either call <em>MPI_Abort</em> or silently skip the problem.  Thus, if you change the error handler from <em>MPI_ERRORS_ARE_FATAL</em> to something else, for example, <em>MPI_ERRORS_RETURN</em> , then no error may be indicated.</p><p>The reason for this is the performance problems in ensuring that all collective routines return the same error value.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">
<p>Almost all MPI routines return an error value; C routines as the value of the function and Fortran routines in the last argument. C++ functions do not return errors. If the default error handler is set to MPI::ERRORS_THROW_EXCEPTIONS, then on error the C++ exception mechanism will be used to throw an MPI:Exception object.</p><p>Before the error value is returned, the current MPI error handler is called. By default, this error handler aborts the MPI job, except for I/O function errors. The error handler may be changed with MPI_Comm_set_errhandler; the predefined error handler MPI_ERRORS_RETURN may be used to cause error values to be returned. Note that MPI does not guarantee that an MPI program can continue past an error.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO MPI_Reduce_local.openmpi&hellip;</h2>
        <div class="sectioncontent">
<p>MPI_Allreduce</p><p>MPI_Reduce</p><p>MPI_Reduce_scatter</p><p>MPI_Scan</p><p>MPI_Op_create</p><p>MPI_Op_free</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="MPI_Reduce_local.3.html"><span aria-hidden="true">&larr;</span> MPI_Reduce_local.3: Applies a reduction operator to local arguments.</a></li>
   <li class="next"><a href="lam-mpidoc-MPI_Reduce_scatter.3.html">MPI_Reduce_scatter.3: Combines values and scatters the results <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
