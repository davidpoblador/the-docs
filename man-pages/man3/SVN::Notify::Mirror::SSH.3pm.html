<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SVN::Notify::Mirror::SSH: Mirror a repository path via ssh</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Mirror a repository path via ssh">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="SVN::Notify::Mirror::SSH (3pm) manual">
  <meta name="twitter:description" content="Mirror a repository path via ssh">
  <meta name="twitter:image" content="https://www.carta.tech/images/libsvn-notify-mirror-perl-SVN::Notify::Mirror::SSH-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/SVN::Notify::Mirror::SSH.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="SVN::Notify::Mirror::SSH (3pm) manual" />
  <meta property="og:description" content="Mirror a repository path via ssh" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libsvn-notify-mirror-perl-SVN::Notify::Mirror::SSH-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">SVN::Notify::Mirror::SSH<small> (3pm)</small></h1>
        <p class="lead">Mirror a repository path via ssh</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/SVN::Notify::Mirror::SSH.3pm.html">
      <span itemprop="name">SVN::Notify::Mirror::SSH: Mirror a repository path via ssh</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libsvn-notify-mirror-perl/">
      <span itemprop="name">libsvn-notify-mirror-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/SVN::Notify::Mirror::SSH.3pm.html">
      <span itemprop="name">SVN::Notify::Mirror::SSH: Mirror a repository path via ssh</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>Use <em>svnnotify</em> in <em>post-commit</em>:</p>
<pre>
  svnnotify --repos-path "$1" --revision "$2" &#92;
   --handler Mirror::SSH --to "/path/to/www/htdocs" &#92;
   [--svn-binary /full/path/to/svn] &#92;
   [[--ssh-host remote_host] [--ssh-user remote_user] &#92;
   [--ssh-tunnel 10.0.0.2] &#92;
   [--ssh-identity /home/user/.ssh/id_rsa]]
</pre>
<p>or better yet, use SVN::Notify::Config for a more sophisticated setup:</p><p>  #!/usr/bin/perl -MSVN::Notify::Config=$0   --- #YAML:1.0   &apos;&apos;:     PATH: "/usr/bin:/usr/local/bin"   &apos;path/in/repository&apos;:     handler: Mirror     to: "/path/to/www/htdocs"   &apos;some/other/path/in/repository&apos;:     handler: Mirror::SSH     to: "/path/to/remote/www/htdocs"     ssh-host: "remote_host"     ssh-user: "remote_user"     ssh-tunnel: "10.0.0.2"     ssh-identity: "/home/user/.ssh/id_rsa"</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Keep a directory in sync with a portion of a Subversion repository. Typically used to keep a development web server in sync with the changes made to the repository.  This directory can either be on the same box as the repository itself, or it can be remote (via \s-1SSH\s0 connection).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE</h2>
        <div class="sectioncontent">
<p>Depending on whether the target is a \*(L"Local Mirror\*(R" or a Remote Mirror, there are different options available.  All options are available either as a commandline option to svnnotify or as a hash key in SVN::Notify::Config (see their respective documentation for more details).</p><h3>Working Copy on Mirror</h3>
<p>Because 'svn export' is not able to be consistently updated, the sync'd directory must be a full working copy, and if you are running Apache, you should add lines like the following to your Apache configuration file:</p><p>  # Disallow browsing of Subversion working copy   # administrative directories.   &lt;DirectoryMatch "^/.*/&#92;.svn/"&gt;    Order deny,allow    Deny from all   &lt;/DirectoryMatch&gt;</p><p>The files in the working copy must be writeable (preferrably owned) by the user identity executing the hook script (this is the user identity that is running Apache or svnserve respectively).</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Local Mirror</h2>
        <div class="sectioncontent">
<p>Please see \*(L" SVN::Notify::Mirror \*(R" for details.</p><h3>Remote Mirror</h3>
<p>Used for directories not located on the same machine as the repository itself.  Typically, this might be a production web server located in a \s-1DMZ\s0, so special consideration must be paid to security concerns.  In particular, the remote mirror server may not be able to directly access the repository box.</p><p>\s-1NOTE:\s0 be sure and consult \*(L"Remote Mirror Pre-requisites\*(R" before configuring your post-commit hook.</p><ul>
<li><p>ssh-host This value is required and must be the hostname or \s-1IP\s0 address of the remote host (where the mirror directories reside).</p></li><li><p>ssh-user This value is optional and specifies the remote username that owns the working copy mirror.</p></li><li><p>ssh-identity This value may be optional and should be the full path to the local identity file being used to authenticate with the remote host. If you are setting the ssh-user to be something other than the local user name, you will typically also have to set the ssh-identity.</p></li><li><p>ssh-tunnel If the remote server does not have direct access to the repository server, it is possible to use the tunneling capabilities of \s-1SSH\s0 to provide temporary access to the repository.  This works even if repository is located internally, and the remote server is located outside of a firewall or on a \s-1DMZ\s0. The value passed for ssh-tunnel should be the \s-1IP\s0 address to which the local repository service is bound (when using svnserve).  This will tunnel port 3690 from the repository box to localhost:3690 on the remote box.  This must also be the way that the original working copy was checked out (see below). To tunnel some other port, for example when using Apache/mod_dav, ssh-tunnel should be the entire mapping expression, as described in the OpenSSH documentation under the \*(C`-R\*(C' option (remote port forwarding). For most sites, passing \*(C`8080:10.0.0.2:80\*(C' will work (which will tunnel port 80 from the repository to port 8080 on the remote client).  If you are using \s-1SSL\s0 with Apache, you can use e.g. \*(C`80443:10.0.0.2:443\*(C'. For example, see \*(L"Remote Mirror Pre-requisites\*(R" and after step #6, perform the following additional steps (when using svnserve):   # su - localuser   $ ssh -i .ssh/id_rsa remote_user@remote_host -R3690:10.0.0.2:3690   $ cd /path/to/mirror/working/copy   $ svn co svn://127.0.0.1/repos/path/to/files . where 10.0.0.2 is the \s-1IP\s0 address hosting the repository service.  For the same configuration when using Apache/mod_dav, do this instead:   # su - localuser   $ ssh -i .ssh/id_rsa remote_user@remote_host -R8080:10.0.0.2:80   $ cd /path/to/mirror/working/copy   $ svn co http://127.0.0.1:8080/repos/path/to/files .</p></li><li><p>ssh-options If you have any other options that you would like to pass to the ssh client (for example to change the default \s-1SSH\s0 port), you can pass extra options using this parameter.  Be sure that you pass it a string that has ssh long option/value pairs separated by a space, or short options without any space at all.  Internally, parameter is split on spaces and passed in the @Net::SSH::options array.</p></li>
</ul>
<h3>Remote Mirror Pre-requisites</h3>
<p>Before you can configure a remote mirror, you need to produce an \s-1SSH\s0 identity file to use:</p>
<dl class='dl-vertical'>
  <dt>
    1. Log in as repository user
  </dt>
  <dd>
    <p>Give the user identity being used to execute the hook scripts (the user running Apache or svnserve) a shell and log in as that user, e.g. \*(C`su - svn\*(C';</p>
  </dd>
  <dt>
    2. Create \s-1SSH\s0 identity files on repository machine
  </dt>
  <dd>
    <p>Run \*(C`ssh-keygen\*(C' and create an identity file (without a password).</p>
  </dd>
  <dt>
    3. Log in as remote user
  </dt>
  <dd>
    <p>Perform the same steps as #1, but this time on the remote machine. This username doesn't have to be the same as in step #1, but it must be a user with full write access to the mirror working copy.</p>
  </dd>
  <dt>
    4. Create \s-1SSH\s0 identity files on remote machine
  </dt>
  <dd>
    <p>It is usually more efficient to go ahead and use \*(C`ssh-keygen\*(C' to create the .ssh folder in the home directory of the remote user.</p>
  </dd>
  <dt>
    5. Copy the public key from local to remote
  </dt>
  <dd>
    <p>Copy the .ssh/id_dsa.pub (or id_rsa.pub if you created an \s-1RSA\s0 key) to the remote server and add it to the .ssh/authorized_keys for the remote user.  See the \s-1SSH\s0 documentation for instructions on how to configure</p>
  </dd>
  <dt>
    6. Confirm configuration
  </dt>
  <dd>
    <p>As the repository user, confirm that you can sucessfully connect to the remote account, e.g.:   # su - local_user   $ ssh -i .ssh/id_rsa remote_user@remote_host This is actually a good time to either check out the working copy or to confirm that the remote account has rights to update the working copy mirror.  If the remote server does not have direct network access to the repository server, you can use the tunnel facility of \s-1SSH\s0 (see ssh-tunnel above) to provide access (e.g. through a firewall).</p>
  </dd>

</dl>
<p>Once you have set up the various accounts, you are ready to set your options.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>John Peacock &lt;jpeacock@cpan.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (c) 2005-2008 John Peacock</p><p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p><p>The full text of the license can be found in the \s-1LICENSE\s0 file included with this module.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO SVN::Notify::Mirror::SSH&hellip;</h2>
        <div class="sectioncontent">
<p>SVN::Notify, SVN::Notify::Config, SVN::Notify::Mirror</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">POD ERRORS</h2>
        <div class="sectioncontent">
<p>Hey! <strong>The above document had some coding errors, which are explained below:</strong></p>
<dl class='dl-vertical'>
  <dt>
    Around line 278:
  </dt>
  <dd>
    <p>You forgot a '=back' before '=head1'</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="SVN::Notify::Mirror::Rsync.3pm.html"><span aria-hidden="true">&larr;</span> SVN::Notify::Mirror::Rsync.3pm: Mirror a repository path via rsync</a></li>
   <li class="next"><a href="SVN::SVNLook.3pm.html">SVN::SVNLook.3pm: Perl wrapper to the svnlook command. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
