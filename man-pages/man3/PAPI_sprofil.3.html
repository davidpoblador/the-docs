<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>PAPI_sprofil: Generate pc histogram data from multiple code regions where hardware counter overflow occurs.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Generate pc histogram data from multiple code regions where hardware counter overflow occurs.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="PAPI_sprofil (3) manual">
  <meta name="twitter:description" content="Generate pc histogram data from multiple code regions where hardware counter overflow occurs.">
  <meta name="twitter:image" content="https://www.carta.tech/images/libpapi-dev-PAPI_sprofil-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/PAPI_sprofil.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="PAPI_sprofil (3) manual" />
  <meta property="og:description" content="Generate pc histogram data from multiple code regions where hardware counter overflow occurs." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libpapi-dev-PAPI_sprofil-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">PAPI_sprofil<small> (3)</small></h1>
        <p class="lead">Generate pc histogram data from multiple code regions where hardware counter overflow occurs.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/PAPI_sprofil.3.html">
      <span itemprop="name">PAPI_sprofil: Generate pc histogram data from multiple code regions where hardware counter overflow occurs.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libpapi-dev/">
      <span itemprop="name">libpapi-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/PAPI_sprofil.3.html">
      <span itemprop="name">PAPI_sprofil: Generate pc histogram data from multiple code regions where hardware counter overflow occurs.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Detailed Description</h2>
        <div class="sectioncontent">
<p><strong>C Interface:</strong></p><p>#include &lt;<strong>papi.h</strong>&gt;</p><p> int <strong>PAPI_sprofil( PAPI_sprofil_t * prof, int profcnt, int EventSet, int EventCode, int threshold, int flags )</strong>;</p><p><strong>Parameters:</strong></p><p><em>*prof</em> pointer to an array of <strong>PAPI_sprofil_t</strong> structures. Each copy of the structure contains the following:</p><ul>
<li><p>buf -- pointer to a buffer of bufsiz bytes in which the histogram counts are stored in an array of unsigned short, unsigned int, or unsigned long long values, or 'buckets'. The size of the buckets is determined by values in the flags argument.</p></li><li><p>bufsiz -- the size of the histogram buffer in bytes. It is computed from the length of the code region to be profiled, the size of the buckets, and the scale factor as discussed below.</p></li><li><p>offset -- the start address of the region to be profiled.</p></li><li><p>scale -- broadly and historically speaking, a contraction factor that indicates how much smaller the histogram buffer is than the region to be profiled. More precisely, scale is interpreted as an unsigned 16-bit fixed-point fraction with the decimal point implied on the left. Its value is the reciprocal of the number of addresses in a subdivision, per counter of histogram buffer.</p></li>
</ul><p><em>profcnt</em> number of structures in the prof array for hardware profiling.</p><p><em>EventSet</em> The PAPI EventSet to profile. This EventSet is marked as profiling-ready, but profiling doesn't actually start until a <strong>PAPI_start()</strong> call is issued.</p><p><em>EventCode</em> Code of the Event in the EventSet to profile. This event must already be a member of the EventSet.</p><p><em>threshold</em> minimum number of events that must occur before the PC is sampled. If hardware overflow is supported for your component, this threshold will trigger an interrupt when reached. Otherwise, the counters will be sampled periodically and the PC will be recorded for the first sample that exceeds the threshold. If the value of threshold is 0, profiling will be disabled for this event.</p><p><em>flags</em> bit pattern to control profiling behavior. Defined values are given in a table in the documentation for PAPI_pofil</p><p><strong>Return values:</strong></p><p><em>Return</em> values for <strong>PAPI_sprofil()</strong> are identical to those for <strong>PAPI_profil</strong>. Please refer to that page for further details.</p><p><strong>PAPI_sprofil()</strong> is a structure driven profiler that profiles one or more disjoint regions of code in a single call. It accepts a pointer to a preinitialized array of sprofil structures, and initiates profiling based on the values contained in the array. Each structure in the array defines the profiling parameters that are normally passed to <strong>PAPI_profil()</strong>. For more information on profiling, <strong>PAPI_profil</strong></p><p><strong>Example:</strong></p>
<pre>
* int retval;
* unsigned long length;
* PAPI_exe_info_t *prginfo;
* unsigned short *profbuf1, *profbuf2, profbucket;
* PAPI_sprofil_t sprof[3];
*
* prginfo = PAPI_get_executable_info();
* if (prginfo == NULL) handle_error( NULL );
* length = (unsigned long)(prginfo-&gt;text_end - prginfo-&gt;text_start);
* // Allocate 2 buffers of equal length
* profbuf1 = (unsigned short *)malloc(length);
* profbuf2 = (unsigned short *)malloc(length);
* if ((profbuf1 == NULL) || (profbuf2 == NULL))
*   handle_error( NULL );
* memset(profbuf1,0x00,length);
* memset(profbuf2,0x00,length);
* // First buffer
* sprof[0].pr_base = profbuf1;
* sprof[0].pr_size = length;
* sprof[0].pr_off = (caddr_t) DO_FLOPS;
* sprof[0].pr_scale = 0x10000;
* // Second buffer
* sprof[1].pr_base = profbuf2;
* sprof[1].pr_size = length;
* sprof[1].pr_off = (caddr_t) DO_READS;
* sprof[1].pr_scale = 0x10000;
* // Overflow bucket
* sprof[2].pr_base = profbucket;
* sprof[2].pr_size = 1;
* sprof[2].pr_off = 0;
* sprof[2].pr_scale = 0x0002;
* retval = PAPI_sprofil(sprof, EventSet, PAPI_FP_INS, 1000000,
* PAPI_PROFIL_POSIX | PAPI_PROFIL_BUCKET_16)) != PAPI_OK)
* if ( retval != PAPI_OK ) handle_error( retval );
*

</pre>
<p><strong>See Also:</strong></p><p><strong>PAPI_overflow</strong></p><p><strong>PAPI_get_executable_info</strong></p><p><strong>PAPI_profil</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Author</h2>
        <div class="sectioncontent">
<p>Generated automatically by Doxygen for PAPI from the source code.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="PAPI_shutdown.3.html"><span aria-hidden="true">&larr;</span> PAPI_shutdown.3: Finish using papi and free all related resources.</a></li>
   <li class="next"><a href="PAPI_sprofil_t.3.html">PAPI_sprofil_t.3: Papi_sprofil_t - <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
