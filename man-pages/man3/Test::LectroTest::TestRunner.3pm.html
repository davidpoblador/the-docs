<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Test::LectroTest::TestRunner: Configurable tap-compatible engine for running lectrotest property checks</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Configurable tap-compatible engine for running lectrotest property checks">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Test::LectroTest::TestRunner (3pm) manual">
  <meta name="twitter:description" content="Configurable tap-compatible engine for running lectrotest property checks">
  <meta name="twitter:image" content="https://www.carta.tech/images/libtest-lectrotest-perl-Test::LectroTest::TestRunner-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Test::LectroTest::TestRunner.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Test::LectroTest::TestRunner (3pm) manual" />
  <meta property="og:description" content="Configurable tap-compatible engine for running lectrotest property checks" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libtest-lectrotest-perl-Test::LectroTest::TestRunner-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Test::LectroTest::TestRunner<small> (3pm)</small></h1>
        <p class="lead">Configurable tap-compatible engine for running lectrotest property checks</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Test::LectroTest::TestRunner.3pm.html">
      <span itemprop="name">Test::LectroTest::TestRunner: Configurable tap-compatible engine for running lectrotest property checks</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libtest-lectrotest-perl/">
      <span itemprop="name">libtest-lectrotest-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Test::LectroTest::TestRunner.3pm.html">
      <span itemprop="name">Test::LectroTest::TestRunner: Configurable tap-compatible engine for running lectrotest property checks</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>version 0.5001</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
 use Test::LectroTest::TestRunner;

 my @args = trials =&gt; 1_000, retries =&gt; 20_000;
 my $runner = Test::LectroTest::TestRunner-&gt;new( @args );

 # test a single property and print details upon failure
 my $result = $runner-&gt;run( $a_single_lectrotest_property );
 print $result-&gt;details unless $result-&gt;success;

 # test a suite of properties, w/ Test::Harness::TAP output
 my $num_successful = $runner-&gt;run_suite( @properties );
 print "# All passed!" if $num_successful == @properties;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>\s-1STOP\s0!</strong> If you just want to write and run simple tests, see Test::LectroTest.  If you really want to learn about the property-checking apparatus or turn its control knobs, read on.</p><p>This module provides Test::LectroTest::TestRunner, a class of objects that tests properties by running repeated random trials.  Create a TestRunner, configure it, and then call its \*(C`run\*(C' or \*(C`run_suite\*(C' methods to test properties individually or in groups.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>The following methods are available.</p><h3>new(\fInamed-params\fP)</h3>
<p>  my $runner = new Test::LectroTest::TestRunner(     trials      =&gt; 1_000,     retries     =&gt; 20_000,     scalefn     =&gt; sub { $_[0] / 2 + 1 },     verbose     =&gt; 1,     regressions =&gt; "/path/to/regression_suite.txt",   );</p><p>Creates a new Test::LectroTest::TestRunner and configures it with the given named parameters, if any.  Typically, you need only provide the \*(C`trials\*(C' parameter because the other values are reasonable for almost all situations.  Here is what each parameter means:</p>
<dl class='dl-vertical'>
  <dt>
    trials
  </dt>
  <dd>
    <p>The number of trials to run against each property checked. The default is 1_000.</p>
  </dd>
  <dt>
    retries
  </dt>
  <dd>
    <p>The number of times to allow a property to retry trials (via \*(C`$tcon-&gt;retry\*(C') during the entire property check before aborting the check.  This is used to prevent infinite looping, should the property retry every attempt.</p>
  </dd>
  <dt>
    scalefn
  </dt>
  <dd>
    <p>A subroutine that scales the sizing guidance given to input generators. The TestRunner starts with an initial guidance of 1 at the beginning of a property check.  For each trial (or retry) of the property, the guidance value is incremented.  This causes successive trials to be tried using successively more complex inputs.  The \*(C`scalefn\*(C' subroutine gets to adjust this guidance on the way to the input generators.  Typically, you would change the \*(C`scalefn\*(C' subroutine if you wanted to change the rate and which inputs grow during the course of the trials.</p>
  </dd>
  <dt>
    verbose
  </dt>
  <dd>
    <p>If this parameter is set to true (the default) the TestRunner will use verbose output that includes things like label frequencies and counterexamples.  Otherwise, only one-line summaries will be output. Unless you have a good reason to do otherwise, leave this parameter alone because verbose output is almost always what you want.</p>
  </dd>
  <dt>
    record_failures
  </dt>
  <dd>
    <p>If this parameter is set to a file's pathname (or a FailureRecorder object), the TestRunner will record property-check failures to the file (or recorder).  (This is an easy way to build a regression-testing suite.)  If the file cannot be created or written to, this parameter will be ignored.  Set this parameter to \*(C`undef\*(C' (the default) to turn off recording.</p>
  </dd>
  <dt>
    playback_failures
  </dt>
  <dd>
    <p>If this parameter is set to a file's pathname (or a FailureRecorder object), the TestRunner will load previously recorded failures from the file (or recorder) and use them as <em>additional</em> test cases when checking properties.  If the file cannot be read, this option will be ignored.  Set this parameter to \*(C`undef\*(C' (the default) to turn off recording.</p>
  </dd>
  <dt>
    regressions
  </dt>
  <dd>
    <p>If this parameter is set to a file's pathname (or a FailureRecorder object), the TestRunner will load failures from and record failures to the file (or recorder).  Setting this parameter is a shortcut for, and exactly equivalent to, setting <em>record_failures</em> and &lt;playback_failures&gt; to the same value, which is typically what you want when managing a persistent suite of regression tests. This is a write-only accessor.</p>
  </dd>

</dl>
<p>You can also set and get the values of the configuration properties using accessors of the same name.  For example:</p><p>  $runner-&gt;trials( 10_000 );</p>
<h3>run(\fIproperty\fP)</h3>
<p>  $results = $runner-&gt;run( $a_property );   print $results-&gt;summary, "&#92;n";   if ($results-&gt;success) {       # celebrate!   }</p><p>Checks whether the given property holds by running repeated random trials.  The result is a Test::LectroTest::TestRunner::results object, which you can query for fined-grained information about the outcome of the check.</p><p>The \*(C`run\*(C' method takes an optional second argument which gives the test number.  If it is not provided (usually the case), the next number available from the TestRunner's internal counter is used.</p><p>  $results = $runner-&gt;run( $third_property, 3 );</p><p>Additionally, if the TestRunner's <em>playback_failures</em> parameter is defined, this method will play back any relevant failure cases from the given playback file (or FailureRecorder).</p><p>Additionally, if the TestRunner's <em>record_failures</em> parameter is defined, this method will record any new failures to the given file (or FailureRecorder).</p>
<h3>run_suite(\fIproperties\fP...)</h3>
<p>  my $num_successful = $runner-&gt;run_suite( @properties );   if ($num_successful == @properties) {       # celebrate most jubilantly!   }</p><p>Checks a suite of properties, sending the results of each property checked to \*(C`STDOUT\*(C' in a form that is compatible with Test::Harness::TAP.  For example:</p><p>  1..5   ok 1 - Property-&gt;new disallows use of &apos;tcon&apos; in bindings   ok 2 - magic Property syntax disallows use of &apos;tcon&apos; in bindings   ok 3 - exceptions are caught and reported as failures   ok 4 - pre-flight check catches new w/ no args   ok 5 - pre-flight check catches unbalanced arguments list</p><p>By default, labeling statistics and counterexamples (if any) are included in the output if the TestRunner's \*(C`verbose\*(C' property is true.  You may override the default by passing the \*(C`verbose\*(C' named parameter after all of the properties in the argument list:</p><p>  my $num_successes = $runner-&gt;run_suite( @properties,                                           verbose =&gt; 1 );   my $num_failed = @properties - $num_successes;</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HELPER OBJECTS</h2>
        <div class="sectioncontent">
<p>There are two kinds of objects that TestRunner uses as helpers. Neither is meant to be created by you.  Rather, a TestRunner will create them on your behalf when they are needed.</p><p>The objects are described in the following subsections.</p><h3>Test::LectroTest::TestRunner::results</h3>
<p>  my $results = $runner-&gt;run( $a_property );   print "Property name: ", $results-&gt;name, ": ";   print $results-&gt;success ? "Winner!" : "Loser!";</p><p>This is the object that you get back from \*(C`run\*(C'.  It contains all of the information available about the outcome of a property check and provides the following methods:</p>
<dl class='dl-vertical'>
  <dt>
    success
  </dt>
  <dd>
    <p>Boolean value:  True if the property checked out successfully; false otherwise.</p>
  </dd>
  <dt>
    summary
  </dt>
  <dd>
    <p>Returns a one line summary of the property-check outcome.  It does not end with a newline.  Example:   ok 1 - Property-&gt;new disallows use of &apos;tcon&apos; in bindings</p>
  </dd>
  <dt>
    details
  </dt>
  <dd>
    <p>Returns all relevant information about the property-check outcome as a series of lines.  The last line is terminated with a newline.  The details are identical to the summary (except for the terminating newline) unless label frequencies are present or a counterexample is present, in which case the details will have these extras (the summary does not).  Example:   1..1   not ok 1 - &apos;my_sqrt meets defn of sqrt&apos; falsified in 1 attempts   # Counterexample:   # $x = &apos;0.546384454460178&apos;;</p>
  </dd>
  <dt>
    name
  </dt>
  <dd>
    <p>Returns the name of the property to which the results pertain.</p>
  </dd>
  <dt>
    number
  </dt>
  <dd>
    <p>The number assigned to the property that was checked.</p>
  </dd>
  <dt>
    counterexample
  </dt>
  <dd>
    <p>Returns the counterexample that \*(L"broke\*(R" the code being tested, if there is one.  Otherwise, returns an empty string.  If any notes have been attached to the failing trial, they will be included.</p>
  </dd>
  <dt>
    labels
  </dt>
  <dd>
    <p>Label counts.  If any labels were applied to trials during the property check, this value will be a reference to a hash mapping each combination of labels to the count of trials that had that particular combination.  Otherwise, it will be undefined. Note that each trial is counted only once \*(-- for the <em>most-specific</em> combination of labels that was applied to it.  For example, consider the following labeling logic:   Property {     ##[ x &lt;- Int ]##     $tcon-&gt;label("negative") if $x &lt; 0;     $tcon-&gt;label("odd")      if $x % 2;     1;   }, name =&gt; "negative/odd labeling example"; For a particular trial, if <em>x</em> was 2 (positive and even), the trial would receive no labels.  If <em>x</em> was 3 (positive and odd), the trial would be labeled \*(L"odd\*(R".  If <em>x</em> was -2 (negative and even), the trial would be labeled \*(L"negative\*(R".  If <em>x</em> was -3 (negative and odd), the trial would be labeled \*(L"negative & odd\*(R".</p>
  </dd>
  <dt>
    label_frequencies
  </dt>
  <dd>
    <p>Returns a string containing a line-by-line accounting of labels applied during the series of trials:   print $results-&gt;label_frequencies; The corresponding output looks like this:   25% negative   25% negative & odd   25% odd If no labels were applied, an empty string is returned.</p>
  </dd>
  <dt>
    exception
  </dt>
  <dd>
    <p>Returns the text of the exception or error that caused the series of trials to be aborted, if the trials were aborted because an exception or error was intercepted by LectroTest.  Otherwise, returns an empty string.</p>
  </dd>
  <dt>
    attempts
  </dt>
  <dd>
    <p>Returns the count of trials performed.</p>
  </dd>
  <dt>
    incomplete
  </dt>
  <dd>
    <p>In the event that the series of trials was halted before it was completed (such as when the retry count was exhausted), this method will return the reason.  Otherwise, it returns an empty string. Note that a series of trials <em>is</em> complete if a counterexample was found.</p>
  </dd>

</dl>

<h3>Test::LectroTest::TestRunner::testcontroller</h3>
<p>During a live property-check trial, the variable $tcon is available to your Properties.  It lets you label the current trial or request that it be re-tried with new inputs.</p><p>The following methods are available.</p>
<dl class='dl-vertical'>
  <dt>
    retry
  </dt>
  <dd>
    <p>    Property {       ##[ x &lt;- Int ]##       return $tcon-&gt;retry if $x == 0;     }, ... ; Stops the current trial and tells the TestRunner to re-try it with new inputs.  Typically used to reject a particular case of inputs that doesn't make for a good or valid test.  While not required, you will probably want to call \*(C`$tcon-&gt;retry\*(C' as part of a \*(C`return\*(C' statement to prevent further execution of your property's logic, the results of which will be thrown out should it run to completion. The return value of \*(C`$tcon-&gt;retry\*(C' is itself meaningless; it is the side-effect of calling it that causes the current trial to be thrown out and re-tried.</p>
  </dd>
  <dt>
    label(<em>string</em>)
  </dt>
  <dd>
    <p>    Property {       ##[ x &lt;- Int ]##       $tcon-&gt;label("negative") if $x &lt; 0;       $tcon-&gt;label("odd")      if $x % 2;     }, ... ; Applies a label to the current trial.  At the end of the trial, all of the labels are gathered together, and the trial is dropped into a bucket bearing the combined label.  See the discussion of \*(L"labels\*(R" for more.</p>
  </dd>
  <dt>
    trivial
  </dt>
  <dd>
    <p>    Property {       ##[ x &lt;- Int ]##       $tcon-&gt;trivial if $x == 0;     }, ... ; Applies the label \*(L"trivial\*(R" to the current trial.  It is identical to calling \*(C`label\*(C' with \*(L"trivial\*(R" as the argument.</p>
  </dd>
  <dt>
    note(<em>string</em>...)
  </dt>
  <dd>
    <p>    Property {       ##[ s &lt;- String( charset=&gt;"A-Za-z0-9" ) ]##       my $s_enc     = encode($s);       my $s_enc_dec = decode($s_enc);       $tcon-&gt;note("s_enc     = $s_enc",                   "s_enc_dec = $s_enc_dec");       $s eq $s_enc_dec;     }, name =&gt; "decode is encode&apos;s inverse" ; Adds a note (or notes) to the current trial.  In the event that the trial fails, these notes will be emitted as part of the counterexample.  For example:     1..1     not ok 1 - property &apos;decode is encode&apos;s inverse&apos; &#92;         falsified in 68 attempts     #     Counterexample:     #     $s = "0";     #     Notes:     #     $s_enc     = "";     #     $s_enc_dec = ""; Notes can help you debug your code when something goes wrong.  Use them as debugging hints to yourself.  For example, you can use notes to record the output of each stage of a multi-stage test.  That way, if the test fails, you can see what happened in each stage without having to plug the counterexample into your code under a debugger. If you want to include complicated values or data structures in your notes, see the \*(C`dump\*(C' method, next, which may be more appropriate.</p>
  </dd>
  <dt>
    dump(<em>value</em>, <em>name</em>)
  </dt>
  <dd>
    <p>    Property {       ##[ s &lt;- String ]##       my $s_enc     = encode($s);       my $s_enc_dec = decode($s_enc);       $tcon-&gt;dump($s_enc, "s_enc");       $tcon-&gt;dump($s_enc_dec, "s_enc_dec");       $s eq $s_enc_dec;     }, name =&gt; "decode is encode&apos;s inverse" ; Adds a note to the current trial in which the given <em>value</em> is dumped.  The value will be dumped via Data::Dumper and thus may be complex and contain weird control characters and so on.  If you supply a <em>name</em>, it will be used to name the dumped value.  Returns <em>value</em> as its result. In the event that the trial fails, the note (and any others) will be emitted as part of the counterexample. See \*(C`note\*(C' above for more.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Test::LectroTest::TestRunner&hellip;</h2>
        <div class="sectioncontent">
<p>Test::LectroTest::Property explains in detail what you can put inside of your property specifications.</p><p>Test::LectroTest::RegressionTesting explains how to test for regressions and corner cases using LectroTest.</p><p>Test::Harness:TAP documents the Test Anything Protocol, Perl's simple text-based interface between testing modules such as Test::LectroTest and the test harness Test::Harness.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Tom Moertel (tom@moertel.com)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INSPIRATION</h2>
        <div class="sectioncontent">
<p>The LectroTest project was inspired by Haskell's QuickCheck module by Koen Claessen and John Hughes: http://www.cs.chalmers.se/~rjmh/QuickCheck/.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT and LICENSE</h2>
        <div class="sectioncontent">
<p>Copyright (c) 2004-13 by Thomas G Moertel.  All rights reserved.</p><p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Test::LectroTest::RegressionTesting.3pm.html"><span aria-hidden="true">&larr;</span> Test::LectroTest::RegressionTesting.3pm: How to do regression testing (for free!)</a></li>
   <li class="next"><a href="Test::LectroTest::Tutorial.3pm.html">Test::LectroTest::Tutorial.3pm: How to use lectrotest to test your software <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
