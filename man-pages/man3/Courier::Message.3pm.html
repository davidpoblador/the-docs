<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Courier::Message: Class implementing an interface to a mail message in the courier mta's message queue.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Class implementing an interface to a mail message in the courier mta's message queue.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Courier::Message (3pm) manual">
  <meta name="twitter:description" content="Class implementing an interface to a mail message in the courier mta's message queue.">
  <meta name="twitter:image" content="https://www.carta.tech/images/courier-filter-perl-Courier::Message-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Courier::Message.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Courier::Message (3pm) manual" />
  <meta property="og:description" content="Class implementing an interface to a mail message in the courier mta's message queue." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/courier-filter-perl-Courier::Message-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Courier::Message<small> (3pm)</small></h1>
        <p class="lead">Class implementing an interface to a mail message in the courier mta's message queue.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Courier::Message.3pm.html">
      <span itemprop="name">Courier::Message: Class implementing an interface to a mail message in the courier mta's message queue.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/courier-filter-perl/">
      <span itemprop="name">courier-filter-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Courier::Message.3pm.html">
      <span itemprop="name">Courier::Message: Class implementing an interface to a mail message in the courier mta's message queue.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>0.200</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    use Courier::Message;

    my $message = Courier::Message-&gt;new(
        file_name           =&gt; $message_file_name,
        control_file_names  =&gt; &#92;@control_file_names,
    );

    # File names:
    my $message_file_name   = $message-&gt;file_name;
    my @control_file_names  = $message-&gt;control_file_names;

    # Message data properties:
    my $raw_message_text    = $message-&gt;text;
    my $header_hash         = $message-&gt;header;
    my $header_field        = $message-&gt;header($field);
    my $raw_body            = $message-&gt;body;

    # Control properties:
    my $control_hash        = $message-&gt;control;
    my $is_authenticated    = $message-&gt;authenticated;
    my $authenticated_user  = $message-&gt;authenticated_user;
    my $is_trusted          = $message-&gt;trusted;
    my $sender              = $message-&gt;sender;
    my @recipients          = $message-&gt;recipients;
    my $remote_host         = $message-&gt;remote_host;
    my $remote_host_name    = $message-&gt;remote_host_name;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>Courier::Message</strong> encapsulates a mail message that is stored in the Courier \s-1MTA\s0's message queue, including the belonging control file(s), and provides an easy to use, read-only interface through its message data and control properties.  For light-weight calling of library functions or external commands, the message and control file names may be retrieved without causing the files to be parsed by <strong>Courier::Message</strong>.</p><h3>Constructor</h3>
<p>The following constructor is provided:</p>
<dl class='dl-vertical'>
  <dt>
    <strong>new(%options)</strong>: returns <em>Courier::Message</em>
  </dt>
  <dd>
    <p>Creates a new \*(C`Courier::Message\*(C' object from the given message file name and zero or more control file names. %options is a list of key/value pairs representing any of the following options:</p>
<dl class='dl-vertical'>
  <dt>
    <strong>file_name</strong>
  </dt>
  <dd>
    <p><em>Required</em>.  The absolute file name of the message file.</p>
  </dd>
  <dt>
    <strong>control_file_names</strong>
  </dt>
  <dd>
    <p><em>Required</em>.  An array-ref containing the absolute file name(s) of zero or more control files belonging to the message.</p>
  </dd>

</dl>

  </dd>

</dl>

<h3>Instance methods</h3>
<p><em>File names</em></p><p>The following file name accessors are provided:</p>
<dl class='dl-vertical'>
  <dt>
    <strong>file_name</strong>: returns <em>string</em>
  </dt>
  <dd>
    <p>Returns the absolute file name of the message file.</p>
  </dd>
  <dt>
    <strong>control_file_names</strong>: returns <em>list</em> of <em>string</em>
  </dt>
  <dd>
    <p>Returns the absolute file names of the control files belonging to the message.</p>
  </dd>

</dl>
<p><em>Message data properties</em></p>
<dl class='dl-vertical'>
  <dt>
    <strong>text</strong>: returns <em>string</em>; throws Perl exceptions
  </dt>
  <dd>
    <p>Reads the message text from the message file into memory once.  Returns the raw message text as bytes (see bytes, and \*(L"bytes\*(R" in PerlIO).  Throws a Perl exception if the message file cannot be read.</p>
  </dd>
  <dt>
    <strong>header</strong>: returns <em>hash-ref</em> of <em>string</em>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <strong>header($field)</strong>: returns <em>list</em> of <em>string</em>
  </dt>
  <dd>
    <p>Parses the message header once by doing the following: tries to interpret the header as <em>\s-1UTF-8\s0</em>, falling back to the 8-bit legacy encoding <em>Windows-1252</em> (a superset of <em>\s-1ISO-8859-1\s0</em>) and decoding that to <em>\s-1UTF-8\s0</em>; parses header fields from the header; and decodes any \s-1MIME\s0 encoded words in field values.  If no field name is specified, returns a hash-ref containing all header fields and array-refs of their values.  If a (case <em>in</em>sensitive) field name is specified, in list context returns a list of the values of all header fields of that name, in the order they occurred in the message header, or in scalar context returns the value of the first header field of that name (or <strong>undef</strong> if no such header field exists).</p>
  </dd>
  <dt>
    <strong>body</strong>: returns <em>string</em>
  </dt>
  <dd>
    <p>Returns the raw message body as bytes (see bytes, and \*(L"bytes\*(R" in PerlIO).</p>
  </dd>

</dl>
<p><em>Control properties</em></p>
<dl class='dl-vertical'>
  <dt>
    <strong>control</strong>: returns <em>hash-ref</em> of <em>string</em>; throws Perl exceptions
  </dt>
  <dd>
    
  </dd>
  <dt>
    <strong>control($field)</strong>: returns <em>list</em> of <em>string</em>; throws Perl exceptions
  </dt>
  <dd>
    <p>Reads and parses all of the message's control files once.  If a (case sensitive) field name (i.e. record type) is specified, returns a list of the values of all control fields of that name, in the order they occurred in the control file(s).  If no field name is specified, returns a hash-ref containing all control fields and array-refs of their values.  Throws a Perl exception if any of the control files cannot be read.</p>
  </dd>
  <dt>
    <strong>authenticated</strong>: returns <em>boolean</em>
  </dt>
  <dd>
    <p>Returns the authentication information (guaranteed to be a <strong>true</strong> value) if the message has been submitted by an authenticated user.  Returns <strong>false</strong> otherwise. <em>Note</em>:  The authentication status and information is currently determined and taken from the message's first (i.e. the trustworthy) \*(L"Received\*(R" header field. This is guaranteed to work correctly, but is not very elegant, so this is subject to change.  As soon as Courier supports storing the complete authentication info (including the authenticated user name) in a control field, <em>that</em> will be the preferred source.  This mostly just means that the <em>format</em> of the authentication info will probably change in the future.</p>
  </dd>
  <dt>
    <strong>authenticated_user</strong>: returns <em>string</em>
  </dt>
  <dd>
    <p>Returns the user name that was used for authentication during submission of the message.  Returns <strong>undef</strong> if no authentication took place.</p>
  </dd>
  <dt>
    <strong>trusted</strong>: returns <em>boolean</em>
  </dt>
  <dd>
    <p>Returns a boolean value indicating whether the message is trusted.  Currently, trusted messages are defined to be messages directly submitted by an authenticated user.  For details on how the authenticated status is determined, see the description of the \*(C`authenticated\*(C' property.</p>
  </dd>
  <dt>
    <strong>sender</strong>: returns <em>string</em>
  </dt>
  <dd>
    <p>Returns the message's envelope sender (from the \*(L"\s-1MAIL\s0 \s-1FROM\s0\*(R" \s-1SMTP\s0 command).</p>
  </dd>
  <dt>
    <strong>recipients</strong>: returns <em>list</em> of <em>string</em>
  </dt>
  <dd>
    <p>Returns all of the message's envelope recipients (from the \*(L"\s-1RCPT\s0 \s-1TO\s0\*(R" \s-1SMTP\s0 commands).</p>
  </dd>
  <dt>
    <strong>remote_host</strong>: returns <em>string</em>
  </dt>
  <dd>
    <p>Returns the \s-1IP\s0 address of the \s-1SMTP\s0 client that submitted the message.</p>
  </dd>
  <dt>
    <strong>remote_host_name</strong>: returns <em>string</em>
  </dt>
  <dd>
    <p>Returns the host name (gained by Courier through a \s-1DNS\s0 reverse lookup) of the \s-1SMTP\s0 client that submitted the message, if available.</p>
  </dd>
  <dt>
    <strong>remote_host_helo</strong>: returns <em>string</em>
  </dt>
  <dd>
    <p>Returns the \s-1HELO\s0 string that the \s-1SMTP\s0 client specified, if available.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Courier::Message&hellip;</h2>
        <div class="sectioncontent">
<p>For \s-1AVAILABILITY\s0, \s-1SUPPORT\s0, and \s-1LICENSE\s0 information, see Courier::Filter::Overview.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Julian Mehnle &lt;julian@mehnle.net&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Courier::Filter::Util.3pm.html"><span aria-hidden="true">&larr;</span> Courier::Filter::Util.3pm: Utility class used by the courier::filter framework</a></li>
   <li class="next"><a href="Crypt::CBC.3pm.html">Crypt::CBC.3pm: Encrypt data with cipher block chaining mode <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
