<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Sub::WrapPackages: Add pre- and post-execution wrappers around all the subroutines in packages or around individual subs</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Add pre- and post-execution wrappers around all the subroutines in packages or around individual subs">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Sub::WrapPackages (3pm) manual">
  <meta name="twitter:description" content="Add pre- and post-execution wrappers around all the subroutines in packages or around individual subs">
  <meta name="twitter:image" content="https://www.carta.tech/images/libsub-wrappackages-perl-Sub::WrapPackages-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Sub::WrapPackages.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Sub::WrapPackages (3pm) manual" />
  <meta property="og:description" content="Add pre- and post-execution wrappers around all the subroutines in packages or around individual subs" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libsub-wrappackages-perl-Sub::WrapPackages-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Sub::WrapPackages<small> (3pm)</small></h1>
        <p class="lead">Add pre- and post-execution wrappers around all the subroutines in packages or around individual subs</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Sub::WrapPackages.3pm.html">
      <span itemprop="name">Sub::WrapPackages: Add pre- and post-execution wrappers around all the subroutines in packages or around individual subs</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libsub-wrappackages-perl/">
      <span itemprop="name">libsub-wrappackages-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Sub::WrapPackages.3pm.html">
      <span itemprop="name">Sub::WrapPackages: Add pre- and post-execution wrappers around all the subroutines in packages or around individual subs</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    use Sub::WrapPackages
        packages =&gt; [qw(Foo Bar Baz::*)],   # wrap all subs in Foo and Bar
                                            #   and any Baz::* packages
        subs     =&gt; [qw(Barf::a, Barf::b)], # wrap these two subs as well
        wrap_inherited =&gt; 1,                # and wrap any methods
                                            #   inherited by Foo, Bar, or
                                            #   Baz::*
        pre      =&gt; sub {
            print "called $_[0] with params ".
              join(&apos;, &apos;, @_[1..$#_])."&#92;n";
        },
        post     =&gt; sub {
            print "$_[0] returned $_[1]&#92;n";
        };
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMPATIBILITY</h2>
        <div class="sectioncontent">
<p>While this module does broadly the same job as the 1.x versions did, the interface may have changed incompatibly.  Sorry.  Hopefully it'll be more maintainable and slightly less crazily magical.  Also, <em>caller()</em> should now work properly, ignoring wrappings.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This module installs pre- and post- execution subroutines for the subroutines or packages you specify.  The pre-execution subroutine is passed the wrapped subroutine's name and all its arguments.  The post-execution subroutine is passed the wrapped sub's name and its results.</p><p>The return values from the pre- and post- subs are ignored, and they are called in the same context (void, scalar or list) as the calling code asked for.</p><p>Normal usage is to pass a bunch of parameters when the module is used. However, you can also call Sub::WrapPackages::wrapsubs with the same parameters.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PARAMETERS</h2>
        <div class="sectioncontent">
<p>Either pass parameters on loading the module, as above, or pass them to ...</p><h3>the wrapsubs subroutine</h3>

<dl class='dl-vertical'>
  <dt>
    the subs arrayref
  </dt>
  <dd>
    <p>In the synopsis above, you will see two named parameters, \*(C`subs\*(C' and \*(C`packages\*(C'.  Any subroutine mentioned in \*(C`subs\*(C' will be wrapped. Any subroutines mentioned in 'subs' must already exist - ie their modules must be loaded - at the time you try to wrap them.</p>
  </dd>
  <dt>
    the packages arrayref
  </dt>
  <dd>
    <p>Any package mentioned here will have all its subroutines wrapped, including any that it imports at load-time.  Packages can be loaded in any order - they don't have to already be loaded for Sub::WrapPackages to work its magic. You can specify wildcard packages.  Anything ending in ::* is assumed to be such.  For example, if you specify Orchard::Tree::*, then that matches Orchard::Tree, Orchard::Tree::Pear, Orchard::Apple::KingstonBlack etc, but not - of course - Pine::Tree or My::Orchard::Tree. Note, however, that if a module exports a subroutine at load-time using \*(C`import\*(C' then that sub will be wrapped in the exporting module but not in the importing module.  This is because <em>import()</em> runs before we get a chance to fiddle with things.  Sorry. Deferred wrapping of subs in packages that aren't yet loaded works via a subroutine inserted in @INC.  This means that if you mess around with @INC, eg by inserting a directoy at the beginning of the path, the magic might not get a chance to run.  If you \*(C`use lib\*(C' to mess with @INC though, it should work, as I've over-ridden lib's <em>import()</em> method. That said, code this funky has no right to work.  Use with caution!</p>
  </dd>
  <dt>
    wrap_inherited
  </dt>
  <dd>
    <p>In conjunction with the \*(C`packages\*(C' arrayref, this wraps all calls to inherited methods made through those packages.  If you call those methods directly in the superclass then they are not affected - unless they're wrapped in the superclass of course.</p>
  </dd>
  <dt>
    pre and post
  </dt>
  <dd>
    <p>References to the subroutines you want to use as wrappers.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>\s-1AUTOLOAD\s0 and \s-1DESTROY\s0 are not treated as being special.  I'm not sure whether they should be or not.</p><p>If you use wrap_inherited but classes change their inheritance tree at run-time, then very bad things will happen. \s-1VERY\s0 \s-1BAD\s0 \s-1THINGS\s0.  So don't do that.  You shouldn't be doing that anyway.  Mind you, you shouldn't be doing the things that this module does either.  \s-1BAD\s0 \s-1PROGRAMMER\s0, \s-1NO\s0 \s-1BIKKIT\s0!</p><p>If you find any other lurking horrors, please report them using &lt;https://rt.cpan.org/Public/Dist/Display.html?Name=Sub-WrapPackages&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FEEDBACK</h2>
        <div class="sectioncontent">
<p>I like to know who's using my code.  All comments, including constructive criticism, are welcome.  Please email me.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SOURCE CODE REPOSITORY</h2>
        <div class="sectioncontent">
<p>&lt;http://www.cantrell.org.uk/cgit/cgit.cgi/perlmodules/&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT and LICENCE</h2>
        <div class="sectioncontent">
<p>Copyright 2003-2009 David Cantrell &lt;<em>david@cantrell.org.uk</em>&gt;</p><p>This software is free-as-in-speech software, and may be used, distributed, and modified under the terms of either the \s-1GNU\s0 General Public Licence version 2 or the Artistic Licence. It's up to you which one you use. The full text of the licences can be found in the files \s-1GPL2\s0.txt and \s-1ARTISTIC\s0.txt, respectively.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THANKS TO</h2>
        <div class="sectioncontent">
<p>Thanks to Tom Hukins for sending in a test case for the situation when a class and a subclass are both defined in the same file, and for prompting me to support inherited methods;</p><p>to Dagfinn Ilmari Mannsaker for help with the craziness for fiddling with modules that haven't yet been loaded;</p><p>to Lee Johnson for reporting a bug caused by perl 5.10's constant.pm being Far Too Clever, and providing a patch and test;</p><p>to Adam Trickett who thought this was a jolly good idea;</p><p>and to Ed Summers, whose code for figgering out what functions a package contains I borrowed out of Acme::Voodoo.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Sub::Uplevel.3pm.html"><span aria-hidden="true">&larr;</span> Sub::Uplevel.3pm: Apparently run a function in a higher stack frame</a></li>
   <li class="next"><a href="Subtitles.3pm.html">Subtitles.3pm: Handle video subtitles in various text formats <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
