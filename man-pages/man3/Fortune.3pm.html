<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Fortune: Read and write fortune (strfile) databases</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Read and write fortune (strfile) databases">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Fortune (3pm) manual">
  <meta name="twitter:description" content="Read and write fortune (strfile) databases">
  <meta name="twitter:image" content="https://www.carta.tech/images/libfortune-perl-Fortune-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Fortune.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Fortune (3pm) manual" />
  <meta property="og:description" content="Read and write fortune (strfile) databases" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libfortune-perl-Fortune-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Fortune<small> (3pm)</small></h1>
        <p class="lead">Read and write fortune (strfile) databases</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Fortune.3pm.html">
      <span itemprop="name">Fortune: Read and write fortune (strfile) databases</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libfortune-perl/">
      <span itemprop="name">libfortune-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Fortune.3pm.html">
      <span itemprop="name">Fortune: Read and write fortune (strfile) databases</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
   # input
   $ffile = new Fortune ($base_filename);
   $ffile-&gt;read_header ();
   $num_fortunes = $ffile-&gt;num_fortunes ();
   $fortune = $ffile-&gt;read_fortune ($num);
   $fortune = $ffile-&gt;get_random_fortune ();
</pre>
<p>   # create header file from data file -- NOT IMPLEMENTED YET    $ffile = new Fortune ($base_filename);    $ffile-&gt;write_header ();</p><p>   # write to data file -- NOT IMPLEMENTED YET    $ffile = new Fortune ("&gt;&gt;$base_filename");    $ffile-&gt;write_fortune ($fortune);</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The \*(C`fortune\*(C' program is a small but important part of the Unix culture, and this module aims to provide support for its \*(L"fortune cookie\*(R" databases to Perl programmers.  For efficiency, all versions of \*(C`fortune\*(C' rely on a binary header consisting mainly of offsets into the fortune file proper.  Modern versions of fortune keep this header in a separate file, and this is the style adopted by the \*(C`Fortune\*(C' module; the older style of munging the header and data into one large \*(L"compiled\*(R" file is not (currently) supported.</p><p>Using the \*(C`Fortune\*(C' module makes it trivial to write a simplified version of the \*(C`fortune\*(C' program:</p><p>   # trivial &apos;fortune&apos; progam    my $fortune_filename = $ARGV[0];    my $fortune_file = new Fortune ($fortune_filename);    $fortune_file-&gt;read_header ();    my $fortune = $fortune_file-&gt;get_random_fortune ();    print $fortune;</p><p>This can be compressed considerably:</p><p>   print new Fortune ($ARGV[0])-&gt;read_header()-&gt;get_random_fortune();</p><p>Of course, this doesn't provide all of \*(C`fortune\*(C''s interesting features, such as parallel databases of offensive fortunes, selection of long or short fortunes, dealing with multiple fortune files, etc.  If you want \*(C`fortune\*(C', use it \*(-- but if you just want a simple Perl interface to its data files, the \*(C`Fortune\*(C' module is for you.</p><p>Currently, the \*(C`Fortune\*(C' module does not support writing fortune databases.  If it did, writing a simplified \*(C`strfile\*(C' (the program that processes a fortune database to create the header file) would also be trivial:</p><p>   # trivial (and hypothetical) &apos;strfile&apos; program    my $fortune_filename = @ARGV[0];    my $fortune_file = new Fortune ($fortune_filename);    $fortune_file-&gt;write_header ();</p><p>Note that the header filename is assumed to be just the name of the main fortune database, with ".dat" appended.  You can supply an alternate header filename to the constructor, \*(C`new()\*(C', if you wish.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p><strong>&#92;$1</strong></p>
<dl class='dl-vertical'>
  <dt>
    new (\s-1FILE\s0 [, \s-1HEADER_FILE\s0])
  </dt>
  <dd>
    <p>Opens a fortune cookie database.  \s-1FILE\s0 is the name of the data file to open, and \s-1HEADER_FILE\s0 (if given) the name of the header file that contains (or will contain) meta-data about the fortune database.  If \s-1HEADER_FILE\s0 is not given, it defaults to \s-1FILE\s0 with ".dat" appended. The data file is opened via \*(C`open_file()\*(C', which \*(C`die\*(C's if the file cannot be opened.  The header file is <em>not</em> opened, whether you supply its filename or not \*(-- after all, it might not exist yet.  Rather, you must explicitly call \*(C`read_header()\*(C' or \*(C`write_header()\*(C' as appropriate.</p>
  </dd>
  <dt>
    open_file ()
  </dt>
  <dd>
    <p>Opens the fortune file whose name was supplied to the constructor.  Dies on failure.</p>
  </dd>
  <dt>
    close_file ()
  </dt>
  <dd>
    <p>Closes the fortune file if it's open; does nothing otherwise.</p>
  </dd>
  <dt>
    read_header ()
  </dt>
  <dd>
    <p>Reads the header file associated with this fortune database.  The name of the header file is determined by the constructor \*(C`new\*(C': either it is based on the name of the data file, or supplied by the caller. If the header file does not exist, this function calls \*(C`compute_header()\*(C' automatically, which has the same effect as reading the header from a file. The header contains the following values, which are stored as attributes of the \*(C`Fortune\*(C' object:</p><p>version number number of strings (fortunes) in the file length of longest string in the file length of shortest string in the file bit field for flags (see <em>strfile</em>\|(1) man page) character that delimits fortunes</p><p>\*(C`numstr\*(C' is available via the \*(C`num_fortunes()\*(C' method; if you're interested in the others, you'll have to go grubbing through the \*(C`Fortune\*(C' object, e.g.:    $fortune_file = new Fortune (&apos;fortunes&apos;);    $fortune_file-&gt;read_header ();    $delim = $fortune_file-&gt;{&apos;delim&apos;}; \*(C`read_header()\*(C' \*(C`die\*(C's if there are any problems reading the header file, e.g. if it seems to be corrupt or truncated. \*(C`read_header()\*(C' returns the current \*(C`Fortune\*(C' object, to allow for sneaky one-liners (see the examples above).</p>
  </dd>
  <dt>
    compute_header ([\s-1DELIM\s0])
  </dt>
  <dd>
    <p>Reads the contents of the fortune file and computes the header information that would normally be found in a header (<em>.dat</em>) file. This is useful if you maintain a file of fortunes by hand and do not have the corresponding data file. An optional delimiter argument may be passed to this function; if present, that delimiter will be used to separate entries in the fortune file.  If not provided, the existing \*(C`delim\*(C' attribute of the Fortune object will be used.  If that is not defined, then a percent sign (\*(L"%\*(R") will be used.</p>
  </dd>
  <dt>
    num_fortunes ()
  </dt>
  <dd>
    <p>Returns the number of fortunes found by \*(C`read_header()\*(C'.</p>
  </dd>
  <dt>
    write_header ([\s-1DELIM\s0])
  </dt>
  <dd>
    <p>is not yet implemented.</p>
  </dd>
  <dt>
    get_fortune (\s-1NUM\s0)
  </dt>
  <dd>
    <p>Reads string number \s-1NUM\s0 from the open fortune file.  \s-1NUM\s0 is zero-based, ie. it must be between 0 and \*(C`num_fortunes()-1\*(C' (inclusive).  \*(C`croak\*(C's if you haven't opened the file and read the header, or if \s-1NUM\s0 is out of range. (Opening the file is pretty hard to screw up, since it's taken care of for you by the constructor, but you have to read the header explicitly with \*(C`read_header()\*(C'.)  Returns the text of the fortune as a (possibly) multiline string.</p>
  </dd>
  <dt>
    get_random_fortune ()
  </dt>
  <dd>
    <p>Picks a random fortune for you and reads it with \*(C`read_fortune()\*(C'.</p>
  </dd>
  <dt>
    write_fortune (\s-1FORTUNE\s0)
  </dt>
  <dd>
    <p>is not yet implemented.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR AND COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Written by Greg Ward &lt;gward@python.net&gt;, 20 February 1999.</p><p>Copyright (c) 1999-2000 Gregory P. Ward. All rights reserved.  This is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AVAILABILITY</h2>
        <div class="sectioncontent">
<p>You can download the \*(C`Fortune\*(C' module from my web page:</p><p>   http://starship.python.net/~gward/perl/</p><p>and it can also be found on \s-1CPAN\s0.</p><p>If you are using an operating system lacking a sufficient sense of humour to include \*(C`fortune\*(C' as part of its standard installation (most commercial Unices seem to be so afflicted), the Linux world has a solution: the \*(C`fortune-mod\*(C' distribution.  The latest version as of this writing is \*(C`fortune-mod-9708\*(C', and the \s-1README\s0 file says you can find it at</p><p>   http://www.progsoc.uts.edu.au/~dbugger/hacks/hacks.html</p><p>This is the \*(C`fortune\*(C' implementation on which the \*(C`Fortune\*(C' module is based.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="FormValidator::Simple::Results.3pm.html"><span aria-hidden="true">&larr;</span> FormValidator::Simple::Results.3pm: Results of validation</a></li>
   <li class="next"><a href="FreezeThaw.3pm.html">FreezeThaw.3pm: Converting perl structures to strings and back. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
