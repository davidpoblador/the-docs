<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>POE::Component::Client::Ping: A non-blocking icmp ping client</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A non-blocking icmp ping client">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="POE::Component::Client::Ping (3pm) manual">
  <meta name="twitter:description" content="A non-blocking icmp ping client">
  <meta name="twitter:image" content="https://www.carta.tech/images/libpoe-component-client-ping-perl-POE::Component::Client::Ping-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/POE::Component::Client::Ping.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="POE::Component::Client::Ping (3pm) manual" />
  <meta property="og:description" content="A non-blocking icmp ping client" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libpoe-component-client-ping-perl-POE::Component::Client::Ping-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">POE::Component::Client::Ping<small> (3pm)</small></h1>
        <p class="lead">A non-blocking icmp ping client</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/POE::Component::Client::Ping.3pm.html">
      <span itemprop="name">POE::Component::Client::Ping: A non-blocking icmp ping client</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libpoe-component-client-ping-perl/">
      <span itemprop="name">libpoe-component-client-ping-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/POE::Component::Client::Ping.3pm.html">
      <span itemprop="name">POE::Component::Client::Ping: A non-blocking icmp ping client</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use POE qw(Component::Client::Ping);

  POE::Component::Client::Ping-&gt;spawn(
    Alias               =&gt; "pingthing",  # defaults to "pinger"
    Timeout             =&gt; 10,           # defaults to 1 second
    Retry               =&gt; 3,            # defaults to 1 attempt
    OneReply            =&gt; 1,            # defaults to disabled
    Parallelism         =&gt; 64,           # defaults to autodetect
    BufferSize          =&gt; 65536,        # defaults to undef
    AlwaysDecodeAddress =&gt; 1,            # defaults to 0
  );

  sub some_event_handler {
    $kernel-&gt;post(
      "pingthing", # Post the request to the "pingthing" component.
      "ping",      # Ask it to "ping" an address.
      "pong",      # Have it post an answer as a "pong" event.
      $address,    # This is the address we want to ping.
      $timeout,    # Optional timeout.  It overrides the default.
      $retry,      # Optional retries. It overrides the default.
    );
  }

  # This is the sub which is called when the session receives a "pong"
  # event.  It handles responses from the Ping component.
  sub got_pong {
    my ($request, $response) = @_[ARG0, ARG1];

    my ($req_address, $req_timeout, $req_time)      = @$request;
    my ($resp_address, $roundtrip_time, $resp_time, $resp_ttl) = @$response;

    # The response address is defined if this is a response.
    if (defined $resp_address) {
      printf(
        "ping to %-15.15s at %10d. pong from %-15.15s in %6.3f s&#92;n",
        $req_address, $req_time,
        $resp_address, $roundtrip_time,
      );
      return;
    }

    # Otherwise the timeout period has ended.
    printf(
      "ping to %-15.15s is done.&#92;n", $req_address,
    );
  }

  or

  use POE::Component::Client::Ping ":const";

  # Post an array ref as the callback to get data back to you
  $kernel-&gt;post("pinger", "ping", [ "pong", $user_data ]);

  # use the REQ_USER_ARGS constant to get to your data
  sub got_pong {
      my ($request, $response) = @_[ARG0, ARG1];
      my $user_data = $request-&gt;[REQ_USER_ARGS];
      ...;
  }
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>POE::Component::Client::Ping is non-blocking \s-1ICMP\s0 ping client.  It lets several other sessions ping through it in parallel, and it lets them continue doing other things while they wait for responses.</p><p>Ping client components are not proper objects.  Instead of being created, as most objects are, they are \*(L"spawned\*(R" as separate sessions. To avoid confusion (and hopefully not cause other confusion), they must be spawned with a \*(C`spawn\*(C' method, not created anew with a \*(C`new\*(C' one.</p><p>PoCo::Client::Ping's \*(C`spawn\*(C' method takes a few named parameters: \*(C`Alias\*(C' sets the component's alias.  It is the target of <em>post()</em> calls.  See the synopsis.  The alias defaults to \*(L"pinger\*(R". \*(C`Socket\*(C' allows developers to open an existing raw socket rather than letting the component attempt opening one itself.  If omitted, the component will create its own raw socket. This is useful for people who would rather not perform a security audit on \s-1POE\s0, since it allows them to create a raw socket in their own code and then run \s-1POE\s0 at reduced privileges. \*(C`Timeout\*(C' sets the default amount of time (in seconds) a Ping component will wait for a single \s-1ICMP\s0 echo reply before retrying.  It is 1 by default.  It is possible and meaningful to set the timeout to a fractional number of seconds. This default timeout is only used for ping requests that don't include their own timeouts. \*(C`Retry\*(C' sets the default number of attempts a ping will be sent before it should be considered failed. It is 1 by default.</p>
<dl class='dl-vertical'>
  <dt>
    OneReply =&gt; 0|1
  </dt>
  <dd>
    <p>Set \*(C`OneReply\*(C' to prevent the Ping component from waiting the full timeout period for replies.  Normally the \s-1ICMP\s0 protocol allows for multiple replies to a single request, so it's proper to wait for late responses.  This option disables the wait, ending the ping transaction at the first response.  Any subsequent responses will be silently ignored. \*(C`OneReply\*(C' is disabled by default, and a single successful request will generate at least two responses.  The first response is a successful \s-1ICMP\s0 \s-1ECHO\s0 \s-1REPLY\s0 event.  The second is an undefined response event, signifying that the timeout period has ended. A ping request will generate exactly one reply when \*(C`OneReply\*(C' is enabled.  This reply will represent either the first \s-1ICMP\s0 \s-1ECHO\s0 \s-1REPLY\s0 to arrive or that the timeout period has ended. Parallelism sets POE::Component::Client::Ping's maximum number of simultaneous \s-1ICMP\s0 requests.  Higher numbers speed up the processing of large host lists, up to the point where the operating system or network becomes oversaturated and begin to drop packets. The difference can be dramatic.  A tuned Parallelism can enable responses down to 1ms, depending on the network, although it will take longer to get through the hosts list.   Pinging 762 hosts at Parallelism=64   Starting to ping hosts.   Pinged 10.0.0.25       - Response from 10.0.0.25       in  0.002s   Pinged 10.0.0.200      - Response from 10.0.0.200      in  0.003s   Pinged 10.0.0.201      - Response from 10.0.0.201      in  0.001s</p><p>  real  1m1.923s   user  0m2.584s   sys   0m0.207s Responses will take significantly longer with an untuned Parallelism, but the total run time will be quicker.   Pinging 762 hosts at Parallelism=500   Starting to ping hosts.   Pinged 10.0.0.25       - Response from 10.0.0.25       in  3.375s   Pinged 10.0.0.200      - Response from 10.0.0.200      in  1.258s   Pinged 10.0.0.201      - Response from 10.0.0.201      in  2.040s</p><p>  real  0m13.410s   user  0m6.390s   sys   0m0.290s Excessively high parallelism values may saturate the \s-1OS\s0 or network, resulting in few or no responses.   Pinging 762 hosts at Parallelism=1000   Starting to ping hosts.</p><p>  real  0m20.520s   user  0m7.896s   sys   0m0.297s By default, POE::Component::Client::Ping will guess at an optimal Parallelism value based on the raw socket receive buffer size and the operating system's nominal \s-1ICMP\s0 packet size.  The latter figure is 3000 octets for Linux and 100 octets for other systems.  \s-1ICMP\s0 packets are generally under 90 bytes, but operating systems may use alternative numbers when calculating buffer capacities.  The component tries to mimic calculations observed in the wild. When in doubt, experiment with different Parallelism values and use the one that works best. If set, then the size of the receive buffer of the raw socket will be modified to the given value. The default size of the receive buffer is operating system dependent. If the buffer cannot be set to the given value, a warning will be generated but the system will continue working. Note that if the buffer is set too small and too many ping replies arrive at the same time, then the operating system may discard the ping replies and mistakenly cause this component to believe the ping to have timed out. In this case, you will typically see discards being noted in the counters displayed by 'netstat -s'. Increased BufferSize values can expand the practical limit for Parallelism.</p>
  </dd>
  <dt>
    AlwaysDecodeAddress =&gt; 0|1
  </dt>
  <dd>
    <p>If set, then any input addresses will always be looked up, even if the hostname happens to be only 4 characters in size. Ideally, you should be passing addresses in to the system to avoid slow hostname lookups, but if you must use hostnames and there is a possibility that you might have short hostnames, then you should set this. Sets the \s-1ICMP\s0 payload (data bytes).  Otherwise the component generates 56 data bytes internally.  Note that some firewalls will discard \s-1ICMP\s0 packets with nonstandard payload sizes.</p>
  </dd>

</dl>
<p>Sessions communicate asynchronously with the Client::Ping component. They post ping requests to it, and they receive pong events back.</p><p>Requests are posted to the component's \*(L"ping\*(R" handler.  They include the name of an event to post back, an address to ping, and an optional amount of time to wait for responses.  The address may be a numeric dotted quad, a packed inet_aton address, or a host name.  Host names are not recommended: they must be looked up for every ping request, and \s-1DNS\s0 lookups can be very slow.  The optional timeout overrides the one set when \*(C`spawn\*(C' is called.</p><p>Ping responses come with two array references:</p><p>  my ($request, $response) = @_[ARG0, ARG1];</p><p>$request contains information about the original request:</p><p>  my (     $req_address, $req_timeout, $req_time, $req_user_args,   ) = @$request; This is the original request address.  It matches the address posted along with the original \*(L"ping\*(R" request. It is useful along with $req_user_args for pairing requests with their corresponding responses. This is the original request timeout.  It's either the one passed with the \*(L"ping\*(R" request or the default timeout set with \*(C`spawn\*(C'. This is the time that the \*(L"ping\*(R" event was received by the Ping component.  It is a real number based on the current system's <em>time()</em> epoch. This is a scalar containing arbitrary data that can be sent along with a request.  It's often used to provide continuity between requests and their responses.  $req_user_args may contain a reference to some larger data structure. To use it, replace the response event with an array reference in the original request.  The array reference should contain two items: the actual response event and a scalar with the context data the program needs back.  See the \s-1SYNOPSIS\s0 for an example.</p><p>$response contains information about the \s-1ICMP\s0 ping response.  There may be multiple responses for a single request.</p><p>  my ($response_address, $roundtrip_time, $reply_time, $reply_ttl) =   @$response; This is the address that responded to the \s-1ICMP\s0 echo request.  It may be different than $request_address, especially if the request was sent to a broadcast address. $response_address will be undefined if $request_timeout seconds have elapsed.  This marks the end of responses for a given request. Programs can assume that no more responses will be sent for the request address.  They may use this marker to initiate another ping request. This is the number of seconds that elapsed between the \s-1ICMP\s0 echo request's transmission and its corresponding response's receipt.  It's a real number. This is purely the trip time and does *not* include any time spent queueing if the system's parallelism limit caused the ping transmission to be delayed. This is the time when the \s-1ICMP\s0 echo response was received.  It is a real number based on the current system's <em>time()</em> epoch. This is the ttl for the echo response packet we received.</p><p>If the \*(L":const\*(R" tagset is imported the following constants will be exported:</p><p>\s-1REQ_ADDRESS\s0, \s-1REQ_TIMEOUT\s0, \s-1REQ_TIME\s0 \s-1REQ_USER_ARGS\s0, \s-1RES_ADDRESS\s0, \s-1RES_ROUNDTRIP\s0, \s-1RES_TIME\s0, \s-1RES_TTL\s0</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO POE::Component::Client::Ping&hellip;</h2>
        <div class="sectioncontent">
<p>This component's \s-1ICMP\s0 ping code was lifted from Net::Ping, which is an excellent module when you only need to ping one host at a time.</p><p>See \s-1POE\s0, of course, which includes a lot of documentation about how \s-1POE\s0 works.</p><p>Also see the test program, t/01_ping.t, in the component's distribution.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUG TRACKER</h2>
        <div class="sectioncontent">
<p>https://rt.cpan.org/Dist/Display.html?Queue=POE-Component-Client-Ping</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPOSITORY</h2>
        <div class="sectioncontent">
<p>http://github.com/rcaputo/poe-component-client-ping/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OTHER RESOURCES</h2>
        <div class="sectioncontent">
<p>http://search.cpan.org/dist/POE-Component-Client-Ping/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR & COPYRIGHTS</h2>
        <div class="sectioncontent">
<p>POE::Component::Client::Ping is Copyright 1999-2009 by Rocco Caputo. All rights are reserved.  POE::Component::Client::Ping is free software; you may redistribute it and/or modify it under the same terms as Perl itself.</p><p>You can learn more about \s-1POE\s0 at http://poe.perl.org/</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="POE::Component::Client::Ident::Agent.3pm.html"><span aria-hidden="true">&larr;</span> POE::Component::Client::Ident::Agent.3pm: A component to provide a one-shot non-blocking ident query.</a></li>
   <li class="next"><a href="POE::Component::DBIAgent.3pm.html">POE::Component::DBIAgent.3pm: Poe component for running asynchronous dbi calls. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
