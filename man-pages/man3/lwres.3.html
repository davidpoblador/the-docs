<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>lwres: Introduction to the lightweight resolver library</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Introduction to the lightweight resolver library">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="lwres (3) manual">
  <meta name="twitter:description" content="Introduction to the lightweight resolver library">
  <meta name="twitter:image" content="https://www.carta.tech/images/libbind-dev-lwres-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/lwres.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="lwres (3) manual" />
  <meta property="og:description" content="Introduction to the lightweight resolver library" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libbind-dev-lwres-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">lwres<small> (3)</small></h1>
        <p class="lead">Introduction to the lightweight resolver library</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/lwres.3.html">
      <span itemprop="name">lwres: Introduction to the lightweight resolver library</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libbind-dev/">
      <span itemprop="name">libbind-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/lwres.3.html">
      <span itemprop="name">lwres: Introduction to the lightweight resolver library</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
#include &lt;lwres/lwres.h&gt;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The BIND 9 lightweight resolver library is a simple, name service independent stub resolver library. It provides hostname-to-address and address-to-hostname lookup services to applications by transmitting lookup requests to a resolver daemon <strong>lwresd</strong> running on the local host. The resover daemon performs the lookup using the DNS or possibly other name service protocols, and returns the results to the application through the library. The library and resolver daemon communicate using a simple UDP-based protocol.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OVERVIEW</h2>
        <div class="sectioncontent">
<p>The lwresd library implements multiple name service APIs. The standard <strong>gethostbyname()</strong>, <strong>gethostbyaddr()</strong>, <strong>gethostbyname_r()</strong>, <strong>gethostbyaddr_r()</strong>, <strong>getaddrinfo()</strong>, <strong>getipnodebyname()</strong>, and <strong>getipnodebyaddr()</strong> functions are all supported. To allow the lwres library to coexist with system libraries that define functions of the same name, the library defines these functions with names prefixed by lwres_. To define the standard names, applications must include the header file <em>&lt;lwres/netdb.h&gt;</em> which contains macro definitions mapping the standard function names into lwres_ prefixed ones. Operating system vendors who integrate the lwres library into their base distributions should rename the functions in the library proper so that the renaming macros are not needed.</p><p>The library also provides a native API consisting of the functions <strong>lwres_getaddrsbyname()</strong> and <strong>lwres_getnamebyaddr()</strong>. These may be called by applications that require more detailed control over the lookup process than the standard functions provide.</p><p>In addition to these name service independent address lookup functions, the library implements a new, experimental API for looking up arbitrary DNS resource records, using the <strong>lwres_getaddrsbyname()</strong> function.</p><p>Finally, there is a low-level API for converting lookup requests and responses to and from raw lwres protocol packets. This API can be used by clients requiring nonblocking operation, and is also used when implementing the server side of the lwres protocol, for example in the <strong>lwresd</strong> resolver daemon. The use of this low-level API in clients and servers is outlined in the following sections.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CLIENT-SIDE LOW-LEVEL API CALL FLOW</h2>
        <div class="sectioncontent">
<p>When a client program wishes to make an lwres request using the native low-level API, it typically performs the following sequence of actions.</p><p>(1) Allocate or use an existing <strong>lwres_packet_t</strong>, called <em>pkt</em> below.</p><p>(2) Set pkt.recvlength to the maximum length we will accept. This is done so the receiver of our packets knows how large our receive buffer is. The "default" is a constant in <em>lwres.h</em>: <strong>LWRES_RECVLENGTH = 4096</strong>.</p><p>(3) Set pkt.serial to a unique serial number. This value is echoed back to the application by the remote server.</p><p>(4) Set pkt.pktflags. Usually this is set to 0.</p><p>(5) Set pkt.result to 0.</p><p>(6) Call <strong>lwres_*request_render()</strong>, or marshall in the data using the primitives such as <strong>lwres_packet_render()</strong> and storing the packet data.</p><p>(7) Transmit the resulting buffer.</p><p>(8) Call <strong>lwres_*response_parse()</strong> to parse any packets received.</p><p>(9) Verify that the opcode and serial match a request, and process the packet specific information contained in the body.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SERVER-SIDE LOW-LEVEL API CALL FLOW</h2>
        <div class="sectioncontent">
<p>When implementing the server side of the lightweight resolver protocol using the lwres library, a sequence of actions like the following is typically involved in processing each request packet.</p><p>Note that the same <strong>lwres_packet_t</strong> is used in both the <strong>_parse()</strong> and <strong>_render()</strong> calls, with only a few modifications made to the packet header's contents between uses. This method is recommended as it keeps the serial, opcode, and other fields correct.</p><p>(1) When a packet is received, call <strong>lwres_*request_parse()</strong> to unmarshall it. This returns a <strong>lwres_packet_t</strong> (also called <em>pkt</em>, below) as well as a data specific type, such as <strong>lwres_gabnrequest_t</strong>.</p><p>(2) Process the request in the data specific type.</p><p>(3) Set the pkt.result, pkt.recvlength as above. All other fields can be left untouched since they were filled in by the <strong>*_parse()</strong> call above. If using <strong>lwres_*response_render()</strong>, pkt.pktflags will be set up properly. Otherwise, the <strong>LWRES_LWPACKETFLAG_RESPONSE</strong> bit should be set.</p><p>(4) Call the data specific rendering function, such as <strong>lwres_gabnresponse_render()</strong>.</p><p>(5) Send the resulting packet to the client.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO lwres&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man3/lwres_gethostent.3.html"><strong>lwres_gethostent</strong>(3)</a>, <a href="../man3/lwres_getipnode.3.html"><strong>lwres_getipnode</strong>(3)</a>, <a href="../man3/lwres_getnameinfo.3.html"><strong>lwres_getnameinfo</strong>(3)</a>, <a href="../man3/lwres_noop.3.html"><strong>lwres_noop</strong>(3)</a>, <a href="../man3/lwres_gabn.3.html"><strong>lwres_gabn</strong>(3)</a>, <a href="../man3/lwres_gnba.3.html"><strong>lwres_gnba</strong>(3)</a>, <a href="../man3/lwres_context.3.html"><strong>lwres_context</strong>(3)</a>, <a href="../man3/lwres_config.3.html"><strong>lwres_config</strong>(3)</a>, <a href="../man5/resolver.5.html"><strong>resolver</strong>(5)</a>, <a href="../man8/lwresd.8.html"><strong>lwresd</strong>(8)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2004, 2005, 2007 Internet Systems Consortium, Inc. ("ISC")</p><p>Copyright &copy; 2000, 2001 Internet Software Consortium.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="lutimes.3.html"><span aria-hidden="true">&larr;</span> lutimes.3: Change file timestamps</a></li>
   <li class="next"><a href="lwres_addr_parse.3.html">lwres_addr_parse.3: Lightweight resolver utility functions <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
