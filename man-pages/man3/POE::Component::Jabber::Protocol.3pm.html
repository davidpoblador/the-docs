<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>POE::Component::Jabber::Protocol: A base class for implementing protocol differences</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A base class for implementing protocol differences">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="POE::Component::Jabber::Protocol (3pm) manual">
  <meta name="twitter:description" content="A base class for implementing protocol differences">
  <meta name="twitter:image" content="https://www.carta.tech/images/libpoe-component-jabber-perl-POE::Component::Jabber::Protocol-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/POE::Component::Jabber::Protocol.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="POE::Component::Jabber::Protocol (3pm) manual" />
  <meta property="og:description" content="A base class for implementing protocol differences" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libpoe-component-jabber-perl-POE::Component::Jabber::Protocol-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">POE::Component::Jabber::Protocol<small> (3pm)</small></h1>
        <p class="lead">A base class for implementing protocol differences</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/POE::Component::Jabber::Protocol.3pm.html">
      <span itemprop="name">POE::Component::Jabber::Protocol: A base class for implementing protocol differences</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libpoe-component-jabber-perl/">
      <span itemprop="name">libpoe-component-jabber-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/POE::Component::Jabber::Protocol.3pm.html">
      <span itemprop="name">POE::Component::Jabber::Protocol: A base class for implementing protocol differences</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>Inherit from this base class when implementing specifc protocol extentions that may exist when writing to support various other jabber server implementations.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>PCJ::Protocol is the base class used when differences between authentication or other connection initialization methods require special processing.</p><p>A prime example is \s-1JABBER\s0(tm) vs. \s-1XMPP\s0. The Jabber protocol uses a much different method to authenticate (ie. using the iq:auth namespace) than \s-1XMPP\s0 which uses \s-1SASL\s0. While the rest of the protocol is substantially unchanged, these differences mean they must be accounted. In the 1.x versions of \s-1PCJ\s0, this was solved by having different duplicate classes in the same domain with these differences manifest. It led to lots of headaches if there was a problem because it then needed to be fixed in four places.</p><p>The solution is to keep the core aspect of \s-1PCJ\s0 immutable, while loading separate individual Protocol classes that then implement the details for each specific dialect.</p><p>As an end developer, if you wish to add support for another dialect (ie. support another jabber server implementation that does service management differently), subclass from this module and then add your entry into the ProtocolFactory.</p><p>Also be aware that \s-1PCJ\s0 uses object_states to construct its own session. Protocol subclassees are expected to fit smoothly into that. See the \s-1METHOD\s0 <em>get_states()</em> for more information.</p><p>And remember when you are finished handling the protocol specifics and the connection is finished, fire off the \s-1PCJ_INIT_FINISHED\s0 status, and call <em>relinquish_states()</em> from the $_[\s-1HEAP\s0] object to return control back to the \s-1PCJ\s0 Core. (Yes, you read that correctly, $_[\s-1HEAP\s0] is actually the \s-1PCJ\s0 object).</p><p>If in doubt, please see the source code for the other Protocol subclasses (ie. \s-1XMPP\s0.pm, J14.pm, etc).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>At a bare minimum, some methods must be implemented by the end developer. These will be indicated with a \s-1MANDATORY\s0 flag.</p>
<dl class='dl-vertical'>
  <dt>
    <em>new()</em> [\s-1OPTIONAL\s0]
  </dt>
  <dd>
    <p><em>new()</em> provides a default constructor. It returns a hash reference blessed into the provided class</p>
  </dd>
  <dt>
    <em>get_version()</em> [\s-1MANDATORY\s0]
  </dt>
  <dd>
    <p><em>get_version()</em> is used by \s-1PCJ\s0 to populate the 'version' attribute in the opening &lt;stream:stream/&gt;. For \s-1XMPP\s0 enabled clients, this must return '1.0'. For legacy Jabber connections, it should return '0.9' but it isn't required. For all other applications, see the appropriate \s-1RFC\s0 for details on what version it expects.</p>
  </dd>
  <dt>
    <em>get_xmlns()</em> [\s-1MANDATORY\s0]
  </dt>
  <dd>
    <p><em>get_xmlns()</em> is used by \s-1PCJ\s0 to populate the default \s-1XML\s0 namespace attribute in the opening &lt;stream:stream/&gt;. Please feel free to use the constants in POE::Filter::XML::NS to provide this.</p>
  </dd>
  <dt>
    <em>get_states()</em> [\s-1MANDATORY\s0]
  </dt>
  <dd>
    <p>get_states is used by \s-1PCJ\s0 to fill its object_states with the Protocol states. An array reference containing event names should be returned that corespond one-to-one with the methods you implement in your subclass. Or if a mapping is required, a hash reference should be returned that includes the mapping. See POE::Session for more detail on object_states.</p>
  </dd>
  <dt>
    <em>get_input_event()</em> [\s-1MANDATORY\s0]
  </dt>
  <dd>
    <p><em>get_input_event()</em> returns the main entry point event into the Protocol subclass. This is then used by \s-1PCJ\s0 to assign the event to the Wheel, so that the Protocol's events get fired from Wheel events.</p>
  </dd>
  <dt>
    <em>get_error_event()</em> [\s-1OPTIONAL\s0]
  </dt>
  <dd>
    <p><em>get_error_event()</em> returns the event to be called when an error occurs in the Wheel. Typically, this isn't required for Protocol subclasses, but is available if needed.</p>
  </dd>
  <dt>
    <em>get_flushed_event()</em> [\s-1OPTIONAL\s0]
  </dt>
  <dd>
    <p><em>get_flushed_event()</em> returns the event to be called when the flushed event occurs in the Wheel. Typically, this isn't required for Protocol subclasses, but is available if needed.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>Here are some quick tips to keep in mind when subclassing:</p><p>Protocol subclassees execute within the same Session space as \s-1PCJ\s0 $_[\s-1HEAP\s0] contains the \s-1PCJ\s0 object. If you need storage space, use $_[\s-1OBJECT\s0] (ie. yourself). Send status events. See PCJ::Status Don't forget to send \s-1PCJ_READY\s0. And don't forget to call $_[\s-1HEAP\s0]-&gt;<em>relinquish_states()</em> when finished. When in doubt, use the source!</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Copyright (c) 2007-2009 Nicholas Perez. Distributed under the \s-1GPL\s0.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="POE::Component::Jabber::Legacy.3pm.html"><span aria-hidden="true">&larr;</span> POE::Component::Jabber::Legacy.3pm: Connect using the pre-xmpp jabber protocol</a></li>
   <li class="next"><a href="POE::Component::Jabber::ProtocolFactory.3pm.html">POE::Component::Jabber::ProtocolFactory.3pm: Protected helper class to handle different protocols <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
