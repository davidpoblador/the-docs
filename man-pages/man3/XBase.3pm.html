<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>XBase: Perl module for reading and writing the dbf files</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Perl module for reading and writing the dbf files">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="XBase (3pm) manual">
  <meta name="twitter:description" content="Perl module for reading and writing the dbf files">
  <meta name="twitter:image" content="https://www.carta.tech/images/libdbd-xbase-perl-XBase-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/XBase.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="XBase (3pm) manual" />
  <meta property="og:description" content="Perl module for reading and writing the dbf files" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libdbd-xbase-perl-XBase-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">XBase<small> (3pm)</small></h1>
        <p class="lead">Perl module for reading and writing the dbf files</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/XBase.3pm.html">
      <span itemprop="name">XBase: Perl module for reading and writing the dbf files</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libdbd-xbase-perl/">
      <span itemprop="name">libdbd-xbase-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/XBase.3pm.html">
      <span itemprop="name">XBase: Perl module for reading and writing the dbf files</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use XBase;
  my $table = new XBase "dbase.dbf" or die XBase-&gt;errstr;
  for (0 .. $table-&gt;last_record) {
        my ($deleted, $id, $msg)
                = $table-&gt;get_record($_, "ID", "MSG");
        print "$id:&#92;t$msg&#92;n" unless $deleted;
  }
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This module can read and write XBase database files, known as dbf in dBase and FoxPro world. It also reads memo fields from the dbt and fpt files, if needed. An alpha code of reading index support for ndx, ntx, mdx, idx and cdx is available for testing \*(-- see the <em>DBD::Index</em>\|(3) man page. Module XBase provides simple native interface to XBase files. For \s-1DBI\s0 compliant database access, see the DBD::XBase and \s-1DBI\s0 modules and their man pages.</p><p>The following methods are supported by XBase module:</p><h3>General methods</h3>

<dl class='dl-vertical'>
  <dt>
    new
  </dt>
  <dd>
    <p>Creates the XBase object, loads the info about the table form the dbf file. The first parameter should be the name of existing dbf file (table, in fact) to read. A suffix .dbf will be appended if needed. This method creates and initializes new object, will also check for memo file, if needed. The parameters can also be specified in the form of hash: value of <strong>name</strong> is then the name of the table, other flags supported are: <strong>memofile</strong> specifies non standard name for the associated memo file. By default it's the name of the dbf file, with extension dbt or fpt. <strong>ignorememo</strong> ignore memo file at all. This is useful if you've lost the dbt file and you do not need it. Default is false. <strong>memosep</strong> separator of memo records in the dBase \s-1III\s0 dbt files. The standard says it should be "&#92;x1a&#92;x1a". There are however implamentations that only put in one "&#92;x1a". XBase.pm tries to guess which is valid for your dbt but if it fails, you can tell it yourself. <strong>nolongchars</strong> prevents XBase to treat the decimal value of character fields as high byte of the length \*(-- there are some broken products around producing character fields with decimal values set.     my $table = new XBase "table.dbf" or die XBase-&gt;errstr;</p><p>    my $table = new XBase "name" =&gt; "table.dbf",                                         "ignorememo" =&gt; 1; <strong>recompute_lastrecno</strong> forces XBase.pm to disbelieve the information about the number of records in the header of the dbf file and recompute the number of records. Use this only if you know that some other software of yours produces incorrect headers.</p>
  </dd>
  <dt>
    close
  </dt>
  <dd>
    <p>Closes the object/file, no arguments.</p>
  </dd>
  <dt>
    create
  </dt>
  <dd>
    <p>Creates new database file on disk and initializes it with 0 records. A dbt (memo) file will be also created if the table contains some memo fields. Parameters to create are passed as hash. You can call this method as method of another XBase object and then you only need to pass <strong>name</strong> value of the hash; the structure (fields) of the new file will be the same as of the original object. If you call <strong>create</strong> using class name (XBase), you have to (besides <strong>name</strong>) also specify another four values, each being a reference to list: <strong>field_names</strong>, <strong>field_types</strong>, <strong>field_lengths</strong> and <strong>field_decimals</strong>. The field types are specified by one letter strings (C, N, L, D, ...). If you set some value as undefined, create will make it into some reasonable default.     my $newtable = $table-&gt;create("name" =&gt; "copy.dbf");</p><p>    my $newtable = XBase-&gt;create("name" =&gt; "copy.dbf",                 "field_names" =&gt; [ "ID", "MSG" ],                 "field_types" =&gt; [ "N", "C" ],                 "field_lengths" =&gt; [ 6, 40 ],                 "field_decimals" =&gt; [ 0, undef ]); Other attributes are <strong>memofile</strong> for non standard memo file location, <strong>codepage</strong> to set the codepage flag in the dbf header (it does not affect how XBase.pm reads or writes the data though, just to make FoxPro happy), and <strong>version</strong> to force different version of the dbt (dbt) file. The default is the version of the object from which you create the new one, or 3 if you call this as class method (XBase-&gt;create). The new file mustn't exist yet \*(-- XBase will not allow you to overwrite existing table. Use <strong>drop</strong> (or unlink) to delete it first.</p>
  </dd>
  <dt>
    drop
  </dt>
  <dd>
    <p>This method closes the table and deletes it on disk (including associated memo file, if there is any).</p>
  </dd>
  <dt>
    last_record
  </dt>
  <dd>
    <p>Returns number of the last record in the file. The lines deleted but present in the file are included in this number.</p>
  </dd>
  <dt>
    last_field
  </dt>
  <dd>
    <p>Returns number of the last field in the file, number of fields minus 1.</p>
  </dd>
  <dt>
    field_names, field_types, field_lengths, field_decimals
  </dt>
  <dd>
    <p>Return list of field names and so on for the dbf file.</p>
  </dd>
  <dt>
    field_type, field_length, field_decimal
  </dt>
  <dd>
    <p>For a field name, returns the appropriate value. Returns undef if the field doesn't exist in the table.</p>
  </dd>

</dl>

<h3>Reading the data one by one</h3>
<p>When dealing with the records one by one, reading or writing (the following six methods), you have to specify the number of the record in the file as the first argument. The range is \*(C`0 .. $table-&gt;last_record\*(C'.</p>
<dl class='dl-vertical'>
  <dt>
    get_record
  </dt>
  <dd>
    <p>Returns a list of data (field values) from the specified record (line of the table). The first parameter in the call is the number of the record. If you do not specify any other parameters, all fields are returned in the same order as they appear in the file. You can also put list of field names after the record number and then only those will be returned. The first value of the returned list is always the 1/0 \*(C`_DELETED\*(C' value saying whether the record is deleted or not, so on success, <strong>get_record</strong> never returns empty list.</p>
  </dd>
  <dt>
    get_record_nf
  </dt>
  <dd>
    <p>Instead if the names of the fields, you can pass list of numbers of the fields to read.</p>
  </dd>
  <dt>
    get_record_as_hash
  </dt>
  <dd>
    <p>Returns hash (in list context) or reference to hash (in scalar context) containing field values indexed by field names. The name of the deleted flag is \*(C`_DELETED\*(C'. The only parameter in the call is the record number. The field names are returned as uppercase.</p>
  </dd>

</dl>

<h3>Writing the data</h3>
<p>All three writing methods always undelete the record. On success they return true \*(-- the record number actually written.</p>
<dl class='dl-vertical'>
  <dt>
    set_record
  </dt>
  <dd>
    <p>As parameters, takes the number of the record and the list of values of the fields. It writes the record to the file. Unspecified fields (if you pass less than you should) are set to undef/empty.</p>
  </dd>
  <dt>
    set_record_hash
  </dt>
  <dd>
    <p>Takes number of the record and hash as parameters, sets the fields, unspecified are undefed/emptied.</p>
  </dd>
  <dt>
    update_record_hash
  </dt>
  <dd>
    <p>Like <strong>set_record_hash</strong> but fields that do not have value specified in the hash retain their value.</p>
  </dd>

</dl>
<p>To explicitly delete/undelete a record, use methods <strong>delete_record</strong> or <strong>undelete_record</strong> with record number as a parameter.</p><p>Assorted examples of reading and writing:</p><p>    my @data = $table-&gt;get_record(3, "jezek", "krtek");     my $hashref = $table-&gt;get_record_as_hash(38);     $table-&gt;set_record_hash(8, "jezek" =&gt; "jezecek",                                         "krtek" =&gt; 5);     $table-&gt;<strong>undelete_record</strong>(4);</p><p>This is a code to update field \s-1MSG\s0 in record where \s-1ID\s0 is 123.</p><p>    use XBase;     my $table = new XBase "test.dbf" or die XBase-&gt;errstr;     for (0 .. $table-&gt;last_record) {         my ($deleted, $id) = $table-&gt;get_record($_, "ID")         die $table-&gt;errstr unless defined $deleted;         next if $deleted;         $table-&gt;update_record_hash($_, "MSG" =&gt; "New message")                                                 if $id == 123;     }</p>
<h3>Sequentially reading the file</h3>
<p>If you plan to sequentially walk through the file, you can create a cursor first and then repeatedly call <strong>fetch</strong> to get next record.</p>
<dl class='dl-vertical'>
  <dt>
    prepare_select
  </dt>
  <dd>
    <p>As parameters, pass list of field names to return, if no parameters, the following <strong>fetch</strong> will return all fields.</p>
  </dd>
  <dt>
    prepare_select_with_index
  </dt>
  <dd>
    <p>The first parameter is the file name of the index file, the rest is as above. For index types that can hold more index structures in on file, use arrayref instead of the file name and in that array include file name and the tag name, and optionaly the index type. The <strong>fetch</strong> will then return records in the ascending order, according to the index.</p>
  </dd>

</dl>
<p>Prepare will return object cursor, the following method are methods of the cursor, not of the table.</p>
<dl class='dl-vertical'>
  <dt>
    fetch
  </dt>
  <dd>
    <p>Returns the fields of the next available undeleted record. The list thus doesn't contain the \*(C`_DELETED\*(C' flag since you are guaranteed that the record is not deleted.</p>
  </dd>
  <dt>
    fetch_hashref
  </dt>
  <dd>
    <p>Returns a hash reference of fields for the next non deleted record.</p>
  </dd>
  <dt>
    last_fetched
  </dt>
  <dd>
    <p>Returns the number of the record last fetched.</p>
  </dd>
  <dt>
    find_eq
  </dt>
  <dd>
    <p>This only works with cursor created via <strong>prepare_select_with_index</strong>. Will roll to the first record what is equal to specified argument, or to the first greater if there is none equal. The following <strong>fetch</strong>es then continue normally.</p>
  </dd>

</dl>
<p>Examples of using cursors:</p><p>    my $table = new XBase "names.dbf" or die XBase-&gt;errstr;     my $cursor = $table-&gt;prepare_select("ID", "NAME", "STREET");     while (my @data = $cursor-&gt;fetch) {         ### do something here, like print "@data&#92;n";     }</p><p>    my $table = new XBase "employ.dbf";     my $cur = $table-&gt;prepare_select_with_index("empid.ndx");     ## my $cur = $table-&gt;prepare_select_with_index(                 ["empid.cdx", "ADDRES", "char"], "id", "address");     $cur-&gt;find_eq(1097);     while (my $hashref = $cur-&gt;fetch_hashref                         and $hashref-&gt;{"ID"} == 1097) {         ### do something here with $hashref     }</p><p>The second example shows that after you have done <strong>find_eq</strong>, the <strong>fetch</strong>es continue untill the end of the index, so you have to check whether you are still on records with given value. And if there is no record with value 1097 in the indexed field, you will just get the next record in the order.</p><p>The updating example can be rewritten to:</p><p>    use XBase;     my $table = new XBase "test.dbf" or die XBase-&gt;errstr;     my $cursor = $table-&gt;prepare_select("ID")     while (my ($id) = $cursor-&gt;fetch) {         $table-&gt;update_record_hash($cursor-&gt;last_fetched,                         "MSG" =&gt; "New message") if $id == 123     }</p>
<h3>Dumping the content of the file</h3>
<p>A method <strong>get_all_records</strong> returns reference to an array containing array of values for each undeleted record at once. As parameters, pass list of fields to return for each record.</p><p>To print the content of the file in a readable form, use method <strong>dump_records</strong>. It prints all not deleted records from the file. By default, all fields are printed, separated by colons, one record on a row. The method can have parameters in a form of a hash with the following keys:</p>
<dl class='dl-vertical'>
  <dt>
    rs
  </dt>
  <dd>
    <p>Record separator, string, newline by default.</p>
  </dd>
  <dt>
    fs
  </dt>
  <dd>
    <p>Field separator, string, one colon by default.</p>
  </dd>
  <dt>
    fields
  </dt>
  <dd>
    <p>Reference to a list of names of the fields to print. By default it's undef, meaning all fields.</p>
  </dd>
  <dt>
    undef
  </dt>
  <dd>
    <p>What to print for undefined (\s-1NULL\s0) values, empty string by default.</p>
  </dd>

</dl>
<p>Example of use is</p><p>    use XBase;     my $table = new XBase "table" or die XBase-&gt;errstr;     $table-&gt;dump_records("fs" =&gt; " | ", "rs" =&gt; " &lt;-+&#92;n",                         "fields" =&gt; [ "id", "msg" ]);&apos;</p><p>Also note that there is a script <em>dbf_dump</em>\|(1) that does the printing.</p>
<h3>Errors and debugging</h3>
<p>If the method fails (returns false or null list), the error message can be retrieved via <strong>errstr</strong> method. If the <strong>new</strong> or <strong>create</strong> method fails, you have no object so you get the error message using class syntax \*(C`XBase-&gt;errstr()\*(C'.</p><p>The method <strong>header_info</strong> returns (not prints) string with information about the file and about the fields.</p><p>Module <em>XBase::Base</em>\|(3) defines some basic functions that are inherited by both XBase and <em>XBase::Memo</em>\|(3) module.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DATA TYPES</h2>
        <div class="sectioncontent">
<p>The character fields are returned \*(L"as is\*(R". No charset or other translation is done. The numbers are converted to Perl numbers. The date fields are returned as 8 character string of the '\s-1YYYYMMDD\s0' form and when inserting the date, you again have to provide it in this form. No checking for the validity of the date is done. The datetime field is returned in the number of (possibly negative) seconds since 1970/1/1, possibly with decimal part (since it allows precision up to 1/1000 s). To get the fields, use the gmtime (or similar) Perl function.</p><p>If there is a memo field in the dbf file, the module tries to open file with the same name but extension dbt, fpt or smt. It uses module <em>XBase::Memo</em>\|(3) for this. It reads and writes this memo field transparently (you do not know about it) and returns the data as single scalar.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INDEX, LOCKS</h2>
        <div class="sectioncontent">
<p><strong>New:</strong> A support for ndx, ntx, mdx, idx and cdx index formats is available with alpha status for testing. Some of the formats are already rather stable (ndx). Please read the <em>XBase::Index</em>\|(3) man page and the eg/use_index file in the distribution for examples and ideas. Send me examples of your data files and suggestions for interface if you need indexes.</p><p>General locking methods are <strong>locksh</strong>, <strong>lockex</strong> and <strong>unlock</strong> for shared lock, exclusive lock and unlock. They call flock but you can redefine then in XBase::Base package.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INFORMATION SOURCE</h2>
        <div class="sectioncontent">
<p>This module is built using information from and article XBase File Format Description by Erik Bachmann, \s-1URL\s0</p><p>        http://www.clicketyclick.dk/databases/xbase/format/</p><p>Thanks a lot.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>1.02</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AVAILABLE FROM</h2>
        <div class="sectioncontent">
<p>http://www.adelton.com/perl/DBD-XBase/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>(c) 1997--2011 Jan Pazdziora.</p><p>All rights reserved. This package is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p><p>Contact the author at jpx dash perl at adelton dot com.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THANKS</h2>
        <div class="sectioncontent">
<p>Many people have provided information, test files, test results and patches. This project would not be so great without them. See the Changes file for (I hope) complete list. Thank you all, guys!</p><p>Special thanks go to Erik Bachmann for his great page about the file structures; to Frans van Loon, William McKee, Randy Kobes and Dan Albertsson for longtime cooperation and many emails we've exchanged when fixing and polishing the modules' behaviour; and to Dan Albertsson for providing support for the project.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO XBase&hellip;</h2>
        <div class="sectioncontent">
<p><em>perl</em>\|(1); <em>XBase::FAQ</em>\|(3); <em>DBD::XBase</em>\|(3) and \s-1<em>DBI\s0</em>\|(3) for \s-1DBI\s0 interface; <em>dbf_dump</em>\|(1)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="X500::RDN.3pm.html"><span aria-hidden="true">&larr;</span> X500::RDN.3pm: Handle x.500 rdns (relative distinguished names), parse and format them</a></li>
   <li class="next"><a href="XBase::Base.3pm.html">XBase::Base.3pm: Base input output module for xbase suite <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
