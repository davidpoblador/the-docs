<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Wiki::Toolkit::Plugin::Diff: Format differences between two wiki::toolkit pages</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Format differences between two wiki::toolkit pages">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Wiki::Toolkit::Plugin::Diff (3pm) manual">
  <meta name="twitter:description" content="Format differences between two wiki::toolkit pages">
  <meta name="twitter:image" content="https://www.carta.tech/images/libwiki-toolkit-plugin-diff-perl-Wiki::Toolkit::Plugin::Diff-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Wiki::Toolkit::Plugin::Diff.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Wiki::Toolkit::Plugin::Diff (3pm) manual" />
  <meta property="og:description" content="Format differences between two wiki::toolkit pages" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libwiki-toolkit-plugin-diff-perl-Wiki::Toolkit::Plugin::Diff-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Wiki::Toolkit::Plugin::Diff<small> (3pm)</small></h1>
        <p class="lead">Format differences between two wiki::toolkit pages</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Wiki::Toolkit::Plugin::Diff.3pm.html">
      <span itemprop="name">Wiki::Toolkit::Plugin::Diff: Format differences between two wiki::toolkit pages</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libwiki-toolkit-plugin-diff-perl/">
      <span itemprop="name">libwiki-toolkit-plugin-diff-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Wiki::Toolkit::Plugin::Diff.3pm.html">
      <span itemprop="name">Wiki::Toolkit::Plugin::Diff: Format differences between two wiki::toolkit pages</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use Wiki::Toolkit::Plugin::Diff;
  my $plugin = Wiki::Toolkit::Plugin::Diff-&gt;new;
  $wiki-&gt;register_plugin( plugin =&gt; $plugin );   # called before any node reads
  my %diff = $plugin-&gt;differences( node =&gt; &apos;Imperial College&apos;,
                                left_version =&gt; 3,
                                right_version =&gt; 5);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>A plug-in for Wiki::Toolkit sites, which provides a nice extract of differences between two versions of a node.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BASIC USAGE</h2>
        <div class="sectioncontent">
<p><strong>differences</strong></p><p>  my %diff_vars = $plugin-&gt;differences(       node          =&gt; "Home Page",       left_version  =&gt; 3,       right_version =&gt; 5   );</p><p>Takes a series of key/value pairs:</p>
<dl class='dl-vertical'>
  <dt>
    * <strong>left_version</strong>
  </dt>
  <dd>
    <p>The node version whose content we're considering canonical.</p>
  </dd>
  <dt>
    * <strong>right_version</strong>
  </dt>
  <dd>
    <p>The node version that we're showing the differences from.</p>
  </dd>
  <dt>
    * <strong>meta_include</strong>
  </dt>
  <dd>
    <p>Filter the list of metadata fields to only include a certain list in the diff output. The default is to include all metadata fields.</p>
  </dd>
  <dt>
    * <strong>meta_exclude</strong>
  </dt>
  <dd>
    <p>Filter the list of metadata fields to exclude certain fields from the diff output. The default is the following list, to match previous version (OpenGuides) behaviour:</p>
<pre>
   \*(C`qw(
   username
   comment
   _\|_categories_\|_checksum
   _\|_locales_\|_checksum )\*(C'
</pre>
<p>Agreed this list is hopelessly inadequate, especially for OpenGuides. Hopefully, future wiki designers will use the meta_include parameter to specify exactly what metadata they want to appear on the diff.</p>
  </dd>

</dl>
<p>The differences method returns a list of key/value pairs, which can be assigned to a hash:</p>
<dl class='dl-vertical'>
  <dt>
    <strong>left_version</strong>
  </dt>
  <dd>
    <p>The node version whose content we're considering canonical.</p>
  </dd>
  <dt>
    <strong>right_version</strong>
  </dt>
  <dd>
    <p>The node version that we're showing the differences from.</p>
  </dd>
  <dt>
    <strong>content</strong>
  </dt>
  <dd>
    <p>The (formatted) contents of the <em>Left</em> version of the node.</p>
  </dd>
  <dt>
    <strong>diff</strong>
  </dt>
  <dd>
    <p>An array of hashrefs of \*(C`hunks\*(C' of differences between the versions. It is assumed that the display will be rendered in \s-1HTML\s0, and \s-1SPAN\s0 tags are inserted with a class of diff1 or diff2, to highlight which individual words have actually changed. Display the contents of diff using a &lt;table&gt;, with each member of the array corresponding to a row &lt;\s-1TR\s0&gt;, and keys {left} and {right} being two columns &lt;\s-1TD\s0&gt;. Usually you will want to feed this through a templating system, such as Template Toolkit, which makes iterating the AoH very easy.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ADVANCED</h2>
        <div class="sectioncontent">
<p>Wiki::Toolkit::Plugin::Diff allows for a more flexible approach than \s-1HTML\s0 only rendering of pages. In particular, there are optional parameters to the constructor which control fine detail of the resultant output.</p><p>If this is not sufficient, the module is also subclassable, and the programmer can supply alternative methods.</p><p><strong>&#92;$1</strong></p><p>Most of these are called internally by the plugin, but provide hooks for alternative code if the module is subclassed.</p>
<dl class='dl-vertical'>
  <dt>
    <strong>new</strong>
  </dt>
  <dd>
    <p>  my $plugin = Wiki::Toolkit::Plugin::Diff-&gt;new( option =&gt; value, option =&gt; value...); Here, <em>option</em> can be one of the following:</p>
<dl class='dl-vertical'>
  <dt>
    <strong>metadata_separator</strong>
  </dt>
  <dd>
    <p>A string which is inserted between each metadata field, and also between the contents and the metadata. This defaults to "&lt;br /&gt;&#92;n" so as to render each metadata field on a new line.</p>
  </dd>
  <dt>
    <strong>line_number_format</strong>
  </dt>
  <dd>
    <p>Used to lay out the head line number for a difference hunk. The string is eval'ed with $_ containing the line number. Default is \*(L"== Line &#92;$_ ==\*(R" .</p>
  </dd>
  <dt>
    <strong>word_matcher</strong>
  </dt>
  <dd>
    <p>is a regular expression, used to tokenize the input string. This is the way of grouping together atomic sequences, so as to give a readable result. The default is the following:             &.+?;                   #HTML special characters e.g. &lt;             |&lt;br&#92;s*/&gt;               #Line breaks             |&#92;w+&#92;s*                 #Word with trailing spaces             |.                      #Any other single character</p>
  </dd>

</dl>

  </dd>
  <dt>
    <strong>differences</strong>
  </dt>
  <dd>
    <p>see above.</p>
  </dd>
  <dt>
    <strong>line_number</strong>
  </dt>
  <dd>
    <p>This method is called to format a line number into a suitable string. The supplied routine performs the necessary substitution of $self-&gt;{line_number_format} using eval.</p>
  </dd>
  <dt>
    <strong>serialise_metadata</strong>
  </dt>
  <dd>
    <p>The purpose of this method is to turn a metadata hash into a string suitable for diffing.</p>
  </dd>
  <dt>
    <strong>content_escape</strong>
  </dt>
  <dd>
    <p>This method is used to apply the necessary quoting or escaping of characters that could appear in the content body, that could interfere with the rendering of the diff text.</p>
  </dd>
  <dt>
    <strong>intradiff</strong>
  </dt>
  <dd>
    <p>This method turns an array of hunks as returned by VCS::Lite::Delta-&gt;hunks into a side by side diff listing, with highlights indicating different words and punctuation. Currently, this is hardcoded to present the differences with \s-1HTML\s0 tags. This module is a prime candidate for migration into VCS::Lite, where this functionality really belongs.</p>
  </dd>
  <dt>
    <strong>get_token</strong>
  </dt>
  <dd>
    <p>This allows the \*(L"false positive\*(R" bug discovered by Earle Martin to be solved (rt.cpan.org #6284). Effectively, the input strings (diff1 and diff2) are tokenised using the word_matcher regexp (see above), and turned into arrays of tokens. The default regexp absorbs trailing whitespace, to give a more readable result. However, if a word is followed by differing whitespace or no whitespace at all, this was throwing up a diff. The get_token method supplied removes trailing whitespace from the key values before they are compared.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TODO</h2>
        <div class="sectioncontent">
<p>Move intradiff functionality into VCS::Lite.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS AND ENHANCEMENTS</h2>
        <div class="sectioncontent">
<p>Please use rt.cpan.org to report any bugs in this module. If you have any ideas for how this module could be enhanced, please email the author, or post to the Wiki::Toolkit list (cgi (hyphen) wiki (hyphen) dev (at) earth (dot) li).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>I. P. Williams (ivorw_openguides [at] xemaps {dot} com) The Wiki::Toolkit team (http://www.wiki-toolkit.org/)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>     Copyright (C) 2003-2004 I. P. Williams (ivorw_openguides [at] xemaps {dot} com).      Copyright (C) 2006 the Wiki::Toolkit team (http://www.wiki-toolkit.org/)      All Rights Reserved.</p><p>This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Wiki::Toolkit::Plugin::Diff&hellip;</h2>
        <div class="sectioncontent">
<p>VCS::Lite, Wiki::Toolkit, Wiki::Toolkit::Plugin, OpenGuides</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Wiki::Toolkit::Plugin::Categoriser.3pm.html"><span aria-hidden="true">&larr;</span> Wiki::Toolkit::Plugin::Categoriser.3pm: Category management for wiki::toolkit.</a></li>
   <li class="next"><a href="Wiki::Toolkit::Plugin::Locator::Grid.3pm.html">Wiki::Toolkit::Plugin::Locator::Grid.3pm: A wiki::toolkit plugin to manage co-ordinate data. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
