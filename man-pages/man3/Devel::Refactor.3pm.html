<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Devel::Refactor: Perl extension for refactoring perl code.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Perl extension for refactoring perl code.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Devel::Refactor (3pm) manual">
  <meta name="twitter:description" content="Perl extension for refactoring perl code.">
  <meta name="twitter:image" content="https://www.carta.tech/images/libdevel-refactor-perl-Devel::Refactor-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Devel::Refactor.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Devel::Refactor (3pm) manual" />
  <meta property="og:description" content="Perl extension for refactoring perl code." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libdevel-refactor-perl-Devel::Refactor-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Devel::Refactor<small> (3pm)</small></h1>
        <p class="lead">Perl extension for refactoring perl code.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Devel::Refactor.3pm.html">
      <span itemprop="name">Devel::Refactor: Perl extension for refactoring perl code.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libdevel-refactor-perl/">
      <span itemprop="name">libdevel-refactor-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Devel::Refactor.3pm.html">
      <span itemprop="name">Devel::Refactor: Perl extension for refactoring perl code.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>$Revision: $  This is the \s-1CVS\s0 revision number.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use Devel::Refactor;

  my $refactory = Devel::Refactor-&gt;new;

  my ($new_sub_call,$new_sub_code) =
     $refactory-&gt;extract_subroutine($sub_name, $code_snippet);

  my $files_to_change = $refactory-&gt;rename_subroutine(&apos;./path/to/dir&apos;,
                                                      &apos;oldSubName&apos;,&apos;newSubName&apos;);
  # $files_to_change is a hashref where keys are file names, and values are
  # arrays of hashes with line_number =&gt; new_text
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ABSTRACT</h2>
        <div class="sectioncontent">
<p>Perl module that facilitates refactoring Perl code.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <strong>Devel::Refactor</strong> module is for code refactoring.</p><p>While <strong>Devel::Refactor</strong> may be used from Perl programs, it is also designed to be used with the <strong>\s-1EPIC\s0</strong> plug-in for the <strong>eclipse</strong> integrated development environment.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CLASS METHODS</h2>
        <div class="sectioncontent">
<p>Just the constructor for now.</p><h3>new</h3>
<p>Returns a new <strong>Devel::Refactor</strong> object.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PUBLIC OBJECT METHODS</h2>
        <div class="sectioncontent">
<p>Call on a object returned by <em>new()</em>.</p><h3>extract_subroutine($new_name,$old_code [,$syntax_check])</h3>
<p>Pass it a snippet of Perl code that belongs in its own subroutine as well as a name for that sub.  It figures out which variables need to be passed into the sub, and which variables might be passed back.  It then produces the sub along with a call to the sub.</p><p>Hashes and arrays within the code snippet are converted to hashrefs and arrayrefs.</p><p>If the <em>syntax_check</em> argument is true then a sytax check is performed on the refactored code.</p><p>Example:</p><p>    $new_name = &apos;newSub&apos;;     $old_code = &lt;&lt;&apos;eos&apos;;       my @results;       my %hash;       my $date = localtime;       $hash{foo} = &apos;value 1&apos;;       $hash{bar} = &apos;value 2&apos;;       for my $loopvar (@array) {          print "Checking $loopvar&#92;n";          push @results, $hash{$loopvar} || &apos;&apos;;       }     eos</p><p>    ($new_sub_call,$new_code) = $refactory-&gt;extract_subroutine($new_name,$old_code);     # $new_sub_call is &apos;my ($date, $hash, $results) = newSub (&#92;@array);&apos;     # $new_code is     # sub newSub {     #     my $array = shift;     #     #   my @results;     #   my %hash;     #   my $date = localtime;     #   $hash{foo} = &apos;value 1&apos;;     #   $hash{bar} = &apos;value 2&apos;;     #   for my $loopvar (@$array) {     #      print "Checking $loopvar&#92;n";     #      push @results, $hash{$loopvar} || &apos;&apos;;     #   }     #     #     #     return ($date, &#92;%hash, &#92;@results);     # }</p><p>Included in the examples directory is a script for use in \s-1KDE\s0 under Linux.  The script gets its code snippet from the \s-1KDE\s0 clipboard and returns the transformed code the same way.  The new sub name is prompted for via \s-1STDIN\s0.</p>
<h3>rename_subroutine($where,$old_name,$new_name,[$max_depth])</h3>
<p><em>where</em> is one of:</p>
<pre>
  path-to-file
  path-to-directory
</pre>
<p>If <em>where</em> is a directory then all Perl files (default is \*(C`.pl\*(C', \*(C`.pm\*(C', and \*(C`.pod\*(C' See the <strong>perl_file_extensions</strong> method.) in that directory and its' descendents (to <em>max_depth</em> deep,) are searched.</p><p>Default for <em>max_depth</em> is 0 \*(-- just the directory itself; <em>max_depth</em> of 1 means the specified directory, and it's immeadiate sub-directories; <em>max_depth</em> of 2 means the specified directory, it's sub-directories, and their sub-directrories, and so forth. If you want to scan very deep, use a high number like 99.</p><p>If no matches are found then returns <em>undef</em>, otherwise:</p><p>Returns a hashref that tells you which files you might want to change, and for each file gives you the line numbers and proposed new text for that line. The hashref looks like this,  where <em>old_name</em> was found on two lines in the first file and on one line in the second file:</p><p> {    ./path/to/file1.pl =&gt; [                            { 11  =&gt; "if (myClass-&gt;newName($x)) {&#92;n" },                            { 27  =&gt; "my $result = myClass-&gt;newName($foo);&#92;n"},                          ],    ./path/to/file2.pm =&gt; [                            { 235 =&gt; "sub newName {&#92;n"},                          ],  }</p><p>The keys are paths to individual files. The values are arraryrefs containing hashrefs where the keys are the line numbers where <em>old_name</em> was found and the values are the proposed new line, with <em>old_name</em> changed to <em>new_name</em>.</p>
<h3>is_perlfile($filename)</h3>
<p>Takes a filename or path and returns true if the file has one of the extensions in <strong>perl_file_extensions</strong>, otherwise returns false.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OBJECT ACCESSORS</h2>
        <div class="sectioncontent">
<p>These object methods return various data structures that may be stored in a <strong>Devel::Refactor</strong> object. In some cases the method also allows setting the property, e.g. <strong>perl_file_extensions</strong>.</p><h3>get_new_code</h3>
<p>Returns the <em>return_snippet</em> object property.</p>
<h3>get_eval_results</h3>
<p>Returns the <em>eval_err</em> object property.</p>
<h3>get_sub_call</h3>
<p>Returns the <em>return_sub_call</em> object property.</p>
<h3>get_scalars</h3>
<p>Returns an array of the keys from <em>scalar_vars</em> object property.</p>
<h3>get_arrays</h3>
<p>Returns an array of the keys from the <em>array_vars</em> object property.</p>
<h3>get_hashes</h3>
<p>Returns an array of the keys from the <em>hash_vars</em> object property.</p>
<h3>get_local_scalars</h3>
<p>Returns an array of the keys from the <em>local_scalars</em> object property.</p>
<h3>get_local_arrays</h3>
<p>Returns an array of the keys from the <em>local_arrays</em> object property.</p>
<h3>get_local_hashes</h3>
<p>Returns an array of the keys from the <em>local_hashes</em> object property.</p>
<h3>perl_file_extensions([$arrayref|$hashref])</h3>
<p>Returns a hashref where the keys are regular expressions that match filename extensions that we think are for Perl files. Default are \*(C`.pl\*(C', \*(C`.pm\*(C', and \*(C`.pod\*(C'</p><p>If passed a hashref then it replaces the current values for this object. The keys should be regular expressions, e.g. \*(C`&#92;.cgi$\*(C'.</p><p>If passed an arrayref then the list of values are added as valid Perl filename extensions. The list should be filename extensions, \s-1NOT\s0 regular expressions, For example:</p><p>  my @additonal_filetypes = qw( .ipl .cgi );   my $new_hash = $refactory-&gt;perl_file_extensions(&#92;@additional_filetypes);   # $new_hash = {   #   &apos;&#92;.pl$&apos;   =&gt; 1,   #   &apos;&#92;.pm$&apos;   =&gt; 1,   #   &apos;&#92;.pod$&apos;  =&gt; 1,   #   &apos;&#92;.ipl$&apos;  =&gt; 1,   #   &apos;&#92;.cgi$&apos;  =&gt; 1,   #   &apos;&#92;.t$&apos;    =&gt; 1,   # }</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TODO LIST</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    Come up with a more uniform approach to <strong>\s-1ACCESSORS\s0</strong>.
  </dt>
  <dd>
    
  </dd>
  <dt>
    Add more refactoring features, such as <em>add_parameter</em>.
  </dt>
  <dd>
    
  </dd>
  <dt>
    Add a \s-1SEE\s0 \s-1ALSO\s0 section with URLs for eclipse/EPIC, refactoring.com, etc.
  </dt>
  <dd>
    
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Scott Sotka, &lt;ssotka@barracudanetworks.com&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT AND LICENSE</h2>
        <div class="sectioncontent">
<p>Copyright 2005 by Scott Sotka</p><p>This library is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Devel::Profile.3pm.html"><span aria-hidden="true">&larr;</span> Devel::Profile.3pm: Tell me why my perl program runs so slowly</a></li>
   <li class="next"><a href="Devel::SimpleTrace.3pm.html">Devel::SimpleTrace.3pm: See where you code warns and dies using stack traces <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
