<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>wrap_log_reader: A function to read internally formatted wrap disk logs</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A function to read internally formatted wrap disk logs">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="wrap_log_reader (3erl) manual">
  <meta name="twitter:description" content="A function to read internally formatted wrap disk logs">
  <meta name="twitter:image" content="https://www.carta.tech/images/erlang-manpages-wrap_log_reader-3erl.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3erl/wrap_log_reader.3erl.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="wrap_log_reader (3erl) manual" />
  <meta property="og:description" content="A function to read internally formatted wrap disk logs" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/erlang-manpages-wrap_log_reader-3erl.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">wrap_log_reader<small> (3erl)</small></h1>
        <p class="lead">A function to read internally formatted wrap disk logs</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3erl/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3erl/wrap_log_reader.3erl.html">
      <span itemprop="name">wrap_log_reader: A function to read internally formatted wrap disk logs</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/erlang-manpages/">
      <span itemprop="name">erlang-manpages</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3erl/wrap_log_reader.3erl.html">
      <span itemprop="name">wrap_log_reader: A function to read internally formatted wrap disk logs</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><em>wrap_log_reader</em> is a function to read internally formatted wrap disk logs, refer to disk_log(3erl). <em>wrap_log_reader</em> does not interfere with disk_log activities; there is however a known bug in this version of the <em>wrap_log_reader</em>, see chapter <em>bugs</em> below.</p><p>A wrap disk log file consists of several files, called index files. A log file can be opened and closed. It is also possible to open just one index file separately. If an non-existent or a non-internally formatted file is opened, an error message is returned. If the file is corrupt, no attempt to repair it will be done but an error message is returned.</p><p>If a log is configured to be distributed, there is a possibility that all items are not loggen on all nodes. <em>wrap_log_reader</em> does only read the log on the called node, it is entirely up to the user to be sure that all items are read.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DATA TYPES</h2>
        <div class="sectioncontent">

<pre>
<strong>continuation()</strong>

</pre>
<p>Continuation returned by <em>open/1,2</em> or <em>chunk/1,2</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXPORTS</h2>
        <div class="sectioncontent">

<pre>
<strong></strong>
chunk(Continuation) -&gt; chunk_ret()

</pre>

<pre>
<strong></strong>
chunk(Continuation, N) -&gt; chunk_ret()

</pre>
<p>Types:</p><p>Continuation = <strong>continuation()</strong></p><p>N = infinity | integer() &gt;= 1</p>
<pre>
<strong>chunk_ret()</strong> = {Continuation2, Terms :: [term()]}

            | {Continuation2,

               Terms :: [term()],

               Badbytes :: integer() &gt;= 0}

            | {Continuation2, eof}

            | {error, Reason :: term()}
</pre>
<p>This function makes it possible to efficiently read the terms which have been appended to a log. It minimises disk I/O by reading large 8K chunks from the file.</p><p>The first time <em>chunk</em> is called an initial continuation returned from the <em>open/1</em>, <em>open/2</em> must be provided.</p><p>When <em>chunk/3</em> is called, <em>N</em> controls the maximum number of terms that are read from the log in each chunk. Default is <em>infinity</em>, which means that all the terms contained in the 8K chunk are read. If less than <em>N</em> terms are returned, this does not necessarily mean that end of file is reached.</p><p>The <em>chunk</em> function returns a tuple <em>{Continuation2, Terms}</em>, where <em>Terms</em> is a list of terms found in the log. <em>Continuation2</em> is yet another continuation which must be passed on into any subsequent calls to <em>chunk</em>. With a series of calls to <em>chunk</em> it is then possible to extract all terms from a log.</p><p>The <em>chunk</em> function returns a tuple <em>{Continuation2, Terms, Badbytes}</em> if the log is opened in read only mode and the read chunk is corrupt. <em>Badbytes</em> indicates the number of non-Erlang terms found in the chunk. Note also that the log is not repaired.</p><p><em>chunk</em> returns <em>{Continuation2, eof}</em> when the end of the log is reached, and <em>{error, Reason}</em> if an error occurs.</p><p>The returned continuation may or may not be valid in the next call to <em>chunk</em>. This is because the log may wrap and delete the file into which the continuation points. To make sure this does not happen, the log can be blocked during the search.</p>
<pre>
<strong></strong>
close(Continuation) -&gt; ok | {error, Reason}

</pre>
<p>Types:</p><p>Continuation = <strong>continuation()</strong></p><p>Reason = <strong>file:posix()</strong></p><p>This function closes a log file properly.</p>
<pre>
<strong></strong>
open(Filename) -&gt; open_ret()

</pre>

<pre>
<strong></strong>
open(Filename, N) -&gt; open_ret()

</pre>
<p>Types:</p><p>Filename = string() | atom()</p><p>N = integer()</p>
<pre>
<strong>open_ret()</strong> = {ok, Continuation :: <strong>continuation()</strong>}

           | {error, Reason :: tuple()}
</pre>
<p><em>Filename</em> specifies the name of the file which is to be read.</p><p><em>N</em> specifies the index of the file which is to be read. If <em>N</em> is omitted the whole wrap log file will be read; if it is specified only the specified index file will be read.</p><p>The <em>open</em> function returns <em>{ok, Continuation}</em> if the log/index file was successfully opened. The <em>Continuation</em> is to be used when chunking or closing the file.</p><p>The function returns <em>{error, Reason}</em> for all errors.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>This version of the <em>wrap_log_reader</em> does not detect if the <em>disk_log</em> wraps to a new index file between a <em>wrap_log_reader:open</em> and the first <em>wrap_log_reader:chunk</em>. In this case the chuck will actually read the last logged items in the log file, because the opened index file was truncated by the <em>disk_log</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO wrap_log_reader&hellip;</h2>
        <div class="sectioncontent">
<p><strong>disk_log(3erl)</strong></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="win32reg.3erl.html"><span aria-hidden="true">&larr;</span> win32reg.3erl: Win32reg provides access to the registry on windows</a></li>
   <li class="next"><a href="wx.3erl.html">wx.3erl: A port of wxwidgets. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
