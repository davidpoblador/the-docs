<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Class::Container: Glues object frameworks together transparently</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Glues object frameworks together transparently">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Class::Container (3pm) manual">
  <meta name="twitter:description" content="Glues object frameworks together transparently">
  <meta name="twitter:image" content="https://www.carta.tech/images/libclass-container-perl-Class::Container-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Class::Container.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Class::Container (3pm) manual" />
  <meta property="og:description" content="Glues object frameworks together transparently" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libclass-container-perl-Class::Container-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Class::Container<small> (3pm)</small></h1>
        <p class="lead">Glues object frameworks together transparently</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Class::Container.3pm.html">
      <span itemprop="name">Class::Container: Glues object frameworks together transparently</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libclass-container-perl/">
      <span itemprop="name">libclass-container-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Class::Container.3pm.html">
      <span itemprop="name">Class::Container: Glues object frameworks together transparently</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
 package Car;
 use Class::Container;
 @ISA = qw(Class::Container);

 _\|_PACKAGE_\|_-&gt;valid_params
   (
    paint  =&gt; {default =&gt; &apos;burgundy&apos;},
    style  =&gt; {default =&gt; &apos;coupe&apos;},
    windshield =&gt; {isa =&gt; &apos;Glass&apos;},
    radio  =&gt; {isa =&gt; &apos;Audio::Device&apos;},
   );

 _\|_PACKAGE_\|_-&gt;contained_objects
   (
    windshield =&gt; &apos;Glass::Shatterproof&apos;,
    wheel      =&gt; { class =&gt; &apos;Vehicle::Wheel&apos;,
                    delayed =&gt; 1 },
    radio      =&gt; &apos;Audio::MP3&apos;,
   );

 sub new {
   my $package = shift;

   # &apos;windshield&apos; and &apos;radio&apos; objects are created automatically by
   # SUPER::new()
   my $self = $package-&gt;SUPER::new(@_);

   $self-&gt;{right_wheel} = $self-&gt;create_delayed_object(&apos;wheel&apos;);
   ... do any more initialization here ...
   return $self;
 }
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This class facilitates building frameworks of several classes that inter-operate.  It was first designed and built for \*(C`HTML::Mason\*(C', in which the Compiler, Lexer, Interpreter, Resolver, Component, Buffer, and several other objects must create each other transparently, passing the appropriate parameters to the right class, possibly substituting other subclasses for any of these objects.</p><p>The main features of \*(C`Class::Container\*(C' are:</p><ul>
<li><p>Explicit declaration of containment relationships (aggregation, factory creation, etc.)</p></li><li><p>Declaration of constructor parameters accepted by each member in a class framework</p></li><li><p>Transparent passing of constructor parameters to the class that needs them</p></li><li><p>Ability to create one (automatic) or many (manual) contained objects automatically and transparently</p></li>
</ul><h3>Scenario</h3>
<p>Suppose you've got a class called \*(C`Parent\*(C', which contains an object of the class \*(C`Child\*(C', which in turn contains an object of the class \*(C`GrandChild\*(C'.  Each class creates the object that it contains. Each class also accepts a set of named parameters in its \*(C`new()\*(C' method.  Without using \*(C`Class::Container\*(C', \*(C`Parent\*(C' will have to know all the parameters that \*(C`Child\*(C' takes, and \*(C`Child\*(C' will have to know all the parameters that \*(C`GrandChild\*(C' takes.  And some of the parameters accepted by \*(C`Parent\*(C' will really control aspects of \*(C`Child\*(C' or \*(C`GrandChild\*(C'.  Likewise, some of the parameters accepted by \*(C`Child\*(C' will really control aspects of \*(C`GrandChild\*(C'.  So, what happens when you decide you want to use a \*(C`GrandDaughter\*(C' class instead of the generic \*(C`GrandChild\*(C'?  \*(C`Parent\*(C' and \*(C`Child\*(C' must be modified accordingly, so that any additional parameters taken by \*(C`GrandDaughter\*(C' can be accommodated.  This is a pain - the kind of pain that object-oriented programming was supposed to shield us from.</p><p>Now, how can \*(C`Class::Container\*(C' help?  Using \*(C`Class::Container\*(C', each class (\*(C`Parent\*(C', \*(C`Child\*(C', and \*(C`GrandChild\*(C') will declare what arguments they take, and declare their relationships to the other classes (\*(C`Parent\*(C' creates/contains a \*(C`Child\*(C', and \*(C`Child\*(C' creates/contains a \*(C`GrandChild\*(C').  Then, when you create a \*(C`Parent\*(C' object, you can pass \*(C`Parent-&gt;new()\*(C' all the parameters for all three classes, and they will trickle down to the right places. Furthermore, \*(C`Parent\*(C' and \*(C`Child\*(C' won't have to know anything about the parameters of its contained objects.  And finally, if you replace \*(C`GrandChild\*(C' with \*(C`GrandDaughter\*(C', no changes to \*(C`Parent\*(C' or \*(C`Child\*(C' will likely be necessary.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<h3>\fInew()\fP</h3>
<p>Any class that inherits from \*(C`Class::Container\*(C' should also inherit its \*(C`new()\*(C' method.  You can do this simply by omitting it in your class, or by calling \*(C`SUPER::new(@_)\*(C' as indicated in the \s-1SYNOPSIS\s0. The \*(C`new()\*(C' method ensures that the proper parameters and objects are passed to the proper constructor methods.</p><p>At the moment, the only possible constructor method is \*(C`new()\*(C'.  If you need to create other constructor methods, they should call \*(C`new()\*(C' internally.</p>
<h3>_\|_PACKAGE_\|_-&gt;\fIcontained_objects()\fP</h3>
<p>This class method is used to register what other objects, if any, a given class creates.  It is called with a hash whose keys are the parameter names that the contained class's constructor accepts, and whose values are the default class to create an object of.</p><p>For example, consider the \*(C`HTML::Mason::Compiler\*(C' class, which uses the following code:</p><p>  _\|_PACKAGE_\|_-&gt;contained_objects( lexer =&gt; &apos;HTML::Mason::Lexer&apos; );</p><p>This defines the relationship between the \*(C`HTML::Mason::Compiler\*(C' class and the class it creates to go in its \*(C`lexer\*(C' slot.  The \*(C`HTML::Mason::Compiler\*(C' class \*(L"has a\*(R" \*(C`lexer\*(C'.  The \*(C`HTML::Mason::Compiler-&gt;new()\*(C' method will accept a \*(C`lexer\*(C' parameter and, if no such parameter is given, an object of the \*(C`HTML::Mason::Lexer\*(C' class should be constructed.</p><p>We implement a bit of magic here, so that if \*(C`HTML::Mason::Compiler-&gt;new()\*(C' is called with a \*(C`lexer_class\*(C' parameter, it will load the indicated class (presumably a subclass of \*(C`HTML::Mason::Lexer\*(C'), instantiate a new object of that class, and use it for the Compiler's \*(C`lexer\*(C' object.  We're also smart enough to notice if parameters given to \*(C`HTML::Mason::Compiler-&gt;new()\*(C' actually should go to the \*(C`lexer\*(C' contained object, and it will make sure that they get passed along.</p><p>Furthermore, an object may be declared as \*(L"delayed\*(R", which means that an object <em>won't</em> be created when its containing class is constructed. Instead, these objects will be created \*(L"on demand\*(R", potentially more than once.  The constructors will still enjoy the automatic passing of parameters to the correct class.  See the \*(C`create_delayed_object()\*(C' for more.</p><p>To declare an object as \*(L"delayed\*(R", call this method like this:</p><p>  _\|_PACKAGE_\|_-&gt;contained_objects( train =&gt; { class =&gt; &apos;Big::Train&apos;,                                              delayed =&gt; 1 } );</p>
<h3>_\|_PACKAGE_\|_-&gt;valid_params(...)</h3>
<p>Specifies the parameters accepted by this class's \*(C`new()\*(C' method as a set of key/value pairs.  Any parameters accepted by a superclass/subclass will also be accepted, as well as any parameters accepted by contained objects.  This method is a get/set accessor method, so it returns a reference to a hash of these key/value pairs. As a special case, if you wish to set the valid params to an empty set and you previously set it to a non-empty set, you may call \*(C`_\|_PACKAGE_\|_-&gt;valid_params(undef)\*(C'.</p><p>\*(C`valid_params()\*(C' is called with a hash that contains parameter names as its keys and validation specifications as values.  This validation specification is largely the same as that used by the \*(C`Params::Validate\*(C' module, because we use \*(C`Params::Validate\*(C' internally.</p><p>As an example, consider the following situation:</p><p>  use Class::Container;   use Params::Validate qw(:types);   _\|_PACKAGE_\|_-&gt;valid_params       (        allow_globals        =&gt; { type =&gt; ARRAYREF, parse =&gt; &apos;list&apos;,   default =&gt; [] },        default_escape_flags =&gt; { type =&gt; SCALAR,   parse =&gt; &apos;string&apos;, default =&gt; &apos;&apos; },        lexer                =&gt; { isa =&gt; &apos;HTML::Mason::Lexer&apos; },        preprocess           =&gt; { type =&gt; CODEREF,  parse =&gt; &apos;code&apos;,   optional =&gt; 1 },        postprocess_perl     =&gt; { type =&gt; CODEREF,  parse =&gt; &apos;code&apos;,   optional =&gt; 1 },        postprocess_text     =&gt; { type =&gt; CODEREF,  parse =&gt; &apos;code&apos;,   optional =&gt; 1 },       );</p><p>  _\|_PACKAGE_\|_-&gt;contained_objects( lexer =&gt; &apos;HTML::Mason::Lexer&apos; );</p><p>The \*(C`type\*(C', \*(C`default\*(C', and \*(C`optional\*(C' parameters are part of the validation specification used by \*(C`Params::Validate\*(C'.  The various constants used, \*(C`ARRAYREF\*(C', \*(C`SCALAR\*(C', etc. are all exported by \*(C`Params::Validate\*(C'.  This means that any of these six parameter names, plus the \*(C`lexer_class\*(C' parameter (because of the \*(C`contained_objects()\*(C' specification given earlier), are valid arguments to the Compiler's \*(C`new()\*(C' method.</p><p>Note that there are also some \*(C`parse\*(C' attributes declared.  These have nothing to do with \*(C`Class::Container\*(C' or \*(C`Params::Validate\*(C' - any extra entries like this are simply ignored, so you are free to put extra information in the specifications as long as it doesn't overlap with what \*(C`Class::Container\*(C' or \*(C`Params::Validate\*(C' are looking for. If a contained object was declared with \*(C`delayed =&gt; 1\*(C', use this method to create an instance of the object.  Note that this is an object method, not a class method:</p><p>   my $foo =       $self-&gt;create_delayed_object(&apos;foo&apos;, ...); # YES!    my $foo = _\|_PACKAGE_\|_-&gt;create_delayed_object(&apos;foo&apos;, ...); # NO!</p><p>The first argument should be a key passed to the \*(C`contained_objects()\*(C' method.  Any additional arguments will be passed to the \*(C`new()\*(C' method of the object being created, overriding any parameters previously passed to the container class constructor. (Could I possibly be more alliterative?  Veni, vedi, vici.) Allows you to adjust the parameters that will be used to create any delayed objects in the future.  The first argument specifies the \*(L"name\*(R" of the object, and any additional arguments are key-value pairs that will become parameters to the delayed object.</p><p>When called with only a $name argument and no list of parameters to set, returns a hash reference containing the parameters that will be passed when creating objects of this type. Returns the class that will be used when creating delayed objects of the given name.  Use this sparingly - in most situations you shouldn't care what the class is.</p>
<h3>_\|_PACKAGE_\|_-&gt;\fIdecorates()\fP</h3>
<p>Version 0.09 of Class::Container added [as yet experimental] support for so-called \*(L"decorator\*(R" relationships, using the term as defined in <em>Design Patterns</em> by Gamma, et al. (the Gang of Four book).  To declare a class as a decorator of another class, simply set @ISA to the class which will be decorated, and call the decorator class's \*(C`decorates()\*(C' method.</p><p>Internally, this will ensure that objects are instantiated as decorators.  This means that you can mix & match extra add-on functionality classes much more easily.</p><p>In the current implementation, if only a single decoration is used on an object, it will be instantiated as a simple subclass, thus avoiding a layer of indirection. Returns a hash reference suitable for passing to the \*(C`Params::Validate\*(C' \*(C`validate\*(C' function.  Does <em>not</em> include any arguments that can be passed to contained objects. Returns a hash reference of every parameter this class will accept, <em>including</em> parameters it will pass on to its own contained objects. The keys are the parameter names, and the values are their corresponding specifications from their \*(C`valid_params()\*(C' definitions. If a parameter is used by both the current object and one of its contained objects, the specification returned will be from the container class, not the contained.</p><p>Because the parameters accepted by \*(C`new()\*(C' can vary based on the parameters <em>passed</em> to \*(C`new()\*(C', you can pass any parameters to the \*(C`allowed_params()\*(C' method too, ensuring that the hash you get back is accurate. Returns the object that created you.  This is remembered by storing a reference to that object, so we use the \*(C`Scalar::Utils\*(C' \*(C`weakref()\*(C' function to avoid persistent circular references that would cause memory leaks.  If you don't have \*(C`Scalar::Utils\*(C' installed, we don't make these references in the first place, and calling \*(C`container()\*(C' will result in a fatal error.</p><p>If you weren't created by another object via \*(C`Class::Container\*(C', \*(C`container()\*(C' returns \*(C`undef\*(C'.</p><p>In most cases you shouldn't care what object created you, so use this method sparingly. This method returns a string meant to describe the containment relationships among classes.  You should not depend on the specific formatting of the string, because I may change things in a future release to make it prettier.</p><p>For example, the HTML::Mason code returns the following when you do \*(C`$interp-&gt;show_containers\*(C':</p><p> HTML::Mason::Interp=HASH(0x238944)    resolver -&gt; HTML::Mason::Resolver::File    compiler -&gt; HTML::Mason::Compiler::ToObject      lexer -&gt; HTML::Mason::Lexer    request -&gt; HTML::Mason::Request (delayed)      buffer -&gt; HTML::Mason::Buffer (delayed)</p><p>Currently, containment is shown by indentation, so the Interp object contains a resolver and a compiler, and a delayed request (or several delayed requests).  The compiler contains a lexer, and each request contains a delayed buffer (or several delayed buffers). Returns a hash reference containing a set of parameters that should be sufficient to re-create the given object using its class's \*(C`new()\*(C' method.  This is done by fetching the current value for each declared parameter (i.e. looking in $object for hash entries of the same name), then recursing through all contained objects and doing the same.</p><p>A few words of caution here.  First, the dumped parameters represent the <em>current</em> state of the object, not the state when it was originally created.</p><p>Second, a class's declared parameters may not correspond exactly to its data members, so it might not be possible to recover the former from the latter.  If it's possible but requires some manual fudging, you can override this method in your class, something like so:</p><p> sub dump_parameters {    my $self = shift;    my $dump = $self-&gt;SUPER::dump_parameters();</p><p>   # Perform fudgery    $dump-&gt;{incoming} = $self-&gt;{_private};    delete $dump-&gt;{superfluous};    return $dump;  }</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Class::Container&hellip;</h2>
        <div class="sectioncontent">
<p>Params::Validate</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Originally by Ken Williams &lt;ken@mathforum.org&gt; and Dave Rolsky &lt;autarch@urth.org&gt; for the HTML::Mason project.  Important feedback contributed by Jonathan Swartz &lt;swartz@pobox.com&gt;.  Extended by Ken Williams for the AI::Categorizer project.</p><p>Currently maintained by Ken Williams.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Class::CSV.3pm.html"><span aria-hidden="true">&larr;</span> Class::CSV.3pm: Class based csv parser/writer</a></li>
   <li class="next"><a href="Class::DBI.3pm.html">Class::DBI.3pm: Simple database abstraction <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
