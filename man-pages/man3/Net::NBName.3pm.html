<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Net::NBName: Netbios name service requests</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Netbios name service requests">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Net::NBName (3pm) manual">
  <meta name="twitter:description" content="Netbios name service requests">
  <meta name="twitter:image" content="https://www.carta.tech/images/libnet-nbname-perl-Net::NBName-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Net::NBName.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Net::NBName (3pm) manual" />
  <meta property="og:description" content="Netbios name service requests" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libnet-nbname-perl-Net::NBName-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Net::NBName<small> (3pm)</small></h1>
        <p class="lead">Netbios name service requests</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Net::NBName.3pm.html">
      <span itemprop="name">Net::NBName: Netbios name service requests</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libnet-nbname-perl/">
      <span itemprop="name">libnet-nbname-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Net::NBName.3pm.html">
      <span itemprop="name">Net::NBName: Netbios name service requests</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use Net::NBName;
  my $nb = Net::NBName-&gt;new;
</pre>
<p>  # a unicast node status request   my $ns = $nb-&gt;node_status("10.0.0.1");   if ($ns) {       print $ns-&gt;as_string;   }</p><p>  # a unicast name query request   my $nq = $nb-&gt;name_query("10.0.1.80", "SPARK", 0x00);   if ($nq) {       print $nq-&gt;as_string;   }</p><p>  # a broadcast name query request   my $nq = $nb-&gt;name_query(undef, "SPARK", 0x00);   if ($nq) {       print $nq-&gt;as_string;   }</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Net::NBName is a class that allows you to perform simple NetBIOS Name Service Requests in your Perl code. It performs these NetBIOS operations over \s-1TCP/IP\s0 using Perl's built-in socket support.</p><p>I've currently implemented two \s-1NBNS\s0 requests: the node status request and the name query request.</p>
<dl class='dl-vertical'>
  <dt>
    NetBIOS Node Status Request
  </dt>
  <dd>
    <p>This allows you to determine the registered NetBIOS names for a specified remote host. The decoded response is returned as a \*(C`Net::NBName::NodeStatus\*(C' object.     querying 192.168.0.10 for node status...     SPARK          &lt;20&gt; UNIQUE M-node Registered Active     SPARK          &lt;00&gt; UNIQUE M-node Registered Active     PLAYGROUND     &lt;00&gt; GROUP  M-node Registered Active     PLAYGROUND     &lt;1C&gt; GROUP  M-node Registered Active     PLAYGROUND     &lt;1B&gt; UNIQUE M-node Registered Active     PLAYGROUND     &lt;1E&gt; GROUP  M-node Registered Active     SPARK          &lt;03&gt; UNIQUE M-node Registered Active     PLAYGROUND     &lt;1D&gt; UNIQUE M-node Registered Active     ..__MSBROWSE__.&lt;01&gt; GROUP  M-node Registered Active     MAC Address = 00-1C-2B-3A-49-58</p>
  </dd>
  <dt>
    NetBIOS Name Query Request
  </dt>
  <dd>
    <p>This allows you to resolve a name to an \s-1IP\s0 address using NetBIOS Name Resolution. These requests can either be unicast (e.g. if you are querying an \s-1NBNS\s0 server) or broadcast on the local subnet. In either case, the decoded response is returned as an \*(C`Net::NBName::NameQuery\*(C' object.     querying 192.168.0.10 for playground&lt;00&gt;...     255.255.255.255 GROUP  B-node     ttl = 0 (default is 300000)     RA set, this was an NBNS server     broadcasting for playground&lt;1C&gt;...     192.168.0.10    GROUP  B-node     ttl = 0 (default is 300000)     RA set, this was an NBNS server     broadcasting for spark&lt;20&gt;...     192.168.0.10    UNIQUE H-node     ttl = 0 (default is 300000)     RA set, this was an NBNS server</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONSTRUCTOR</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    $nb = Net::NBName-&gt;new
  </dt>
  <dd>
    <p>Creates a new \*(C`Net::NBName\*(C' object. This can be used to perform NetBIOS Name Service requests.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>This will query the host for its node status. The response will be returned as a \*(C`Net::NBName::NodeStatus\*(C' object. If no response is received from the host, the method will return undef. You can also optionally specify the timeout in seconds for the node status request. The timeout defaults to .25 seconds. This will query the host for the specified name. The response will be returned as a \*(C`Net::NBName::NameQuery\*(C' object. If $host is undef, then a broadcast name query will be performed; otherwise, a unicast name query will be performed. Broadcast name queries can sometimes receive multiple responses. Only the first positive response will be decoded and returned as a \*(C`Net::NBName::NameQuery\*(C' object. If no response is received or a negative name query response is received, the method will return undef. You can override the flags in the NetBIOS name request, if you *really* want to. See the notes on Hacking Name Query Flags. You can also optionally specify the timeout in seconds for the name query request. It defaults to .25 seconds for unicast name queries and 1 second for broadcast name queries.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p><strong>&#92;$1</strong></p><p>You can use this example to query for a NetBIOS name. If you specify a host, it will perform a unicast query; if you don't specify a host, it will perform a broadcast query. I've used the shorthand of specifying the name as &lt;name&gt;#&lt;suffix&gt; where the suffix should be in hex.</p><p>\*(L"namequery.pl spark#0\*(R"</p><p>\*(L"namequery.pl spark#20 192.168.0.10\*(R"</p><p>    use strict;     use Net::NBName;</p><p>    my $nb = Net::NBName-&gt;new;     my $param = shift;     my $host = shift;     if ($param =~ /^([&#92;w-]+)&#92;#(&#92;w{1,2})$/) {         my $name = $1;         my $suffix = hex $2;</p><p>        my $nq;         if (defined($host) && $host =~ /&#92;d+&#92;.&#92;d+&#92;.&#92;d+&#92;.&#92;d+/) {             printf "querying %s for %s&lt;%02X&gt;...&#92;n", $host, $name, $suffix;             $nq = $nb-&gt;name_query($host, $name, $suffix);         } else {             printf "broadcasting for %s&lt;%02X&gt;...&#92;n", $name, $suffix;             $nq = $nb-&gt;name_query(undef, $name, $suffix);         }         if ($nq) {             print $nq-&gt;as_string;         }     } else {         die "expected: &lt;name&gt;#&lt;suffix&gt; [&lt;host&gt;]&#92;n";     } This example emulates the windows nbtstat -A command. By specifying the ip address of the remote host, you can check its NetBIOS Name Table.</p><p>\*(L"nodestat.pl 192.168.0.10\*(R"</p><p>    use Net::NBName;</p><p>    my $nb = Net::NBName-&gt;new;     my $host = shift;     if (defined($host) && $host =~ /&#92;d+&#92;.&#92;d+&#92;.&#92;d+&#92;.&#92;d+/) {         my $ns = $nb-&gt;node_status($host);         if ($ns) {             print $ns-&gt;as_string;         } else {             print "no response&#92;n";         }     } else {         die "expected: &lt;host&gt;&#92;n";     } This example can be used to scan for NetBIOS hosts on a subnet. It uses Net::Netmask to parse the subnet parameter and enumerate the hosts in that subnet.</p><p>\*(L"nodescan.pl 192.168.0.0/24\*(R"</p><p>    use Net::NBName;     use Net::Netmask;</p><p>    $mask = shift or die "expected: &lt;subnet&gt;&#92;n";</p><p>    $nb = Net::NBName-&gt;new;     $subnet = Net::Netmask-&gt;new2($mask);     for $ip ($subnet-&gt;enumerate) {         print "$ip ";         $ns = $nb-&gt;node_status($ip);         if ($ns) {             for my $rr ($ns-&gt;names) {                 if ($rr-&gt;suffix == 0 && $rr-&gt;G eq "GROUP") {                     $domain = $rr-&gt;name;                 }                 if ($rr-&gt;suffix == 3 && $rr-&gt;G eq "UNIQUE") {                     $user = $rr-&gt;name;                 }                 if ($rr-&gt;suffix == 0 && $rr-&gt;G eq "UNIQUE") {                     $machine = $rr-&gt;name unless $rr-&gt;name =~ /^IS~/;                 }             }             $mac_address = $ns-&gt;mac_address;             print "$mac_address $domain&#92;&#92;$machine $user";         }         print "&#92;n";     }</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>When performing name queries, you should note that when Microsoft implemented their \s-1NBNS\s0 Name Server (Microsoft \s-1WINS\s0 Server) they mapped group names to the single \s-1IP\s0 address 255.255.255.255 (the limited broadcast address). In order to support <em>real</em> group names, Microsoft modified \s-1WINS\s0 to provide support for special groups. These groups appear differently in \s-1WINS\s0. For example, the Domain Controllers (0x1C) group appears as \*(L"Domain Name\*(R" instead of \*(L"Group\*(R".</p><p>The complete set of \s-1WINS\s0 mapping types is:</p><p>    Unique     Group     Domain Name     Internet group     Multihomed</p><p>Unique and Group map to a single \s-1IP\s0 address. Domain Name, Internet group, and Multihomed are special groups that can include up to 25 \s-1IP\s0 addresses. NetBIOS Name Service Requests have a number of flags associated with them. These are set to sensible defaults by the code when sending node status and name query requests.</p><p>However, it is possible to override these settings by calling the name_query method of a \*(C`Net::NBName\*(C' object with a fourth parameter:</p><p>    $nb-&gt;name_query( $host, $name, $suffix, $flags );</p><p>For a unicast name query, the flags default to 0x0100 which sets the \s-1RD\s0 (recursion desired) flag. For a broadcast name query, the flags default to 0x0010 which sets the B (broadcast) flag.</p><p>Experimentation gave the following results:</p><ul>
<li><p>If B is set, the remote name table will be used. There will be no response if the queried name is not present.</p></li><li><p>If B is not set and the host is an \s-1NBNS\s0 server, the \s-1NBNS\s0 server will be used before the remote name table and you will get a negative response if the name is not present; if the host is not an \s-1NBNS\s0 server, you will get no response if the name is not present.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (c) 2002, 2003, 2004 James Macfarlane. All rights reserved. This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Net::ManageSieve.3pm.html"><span aria-hidden="true">&larr;</span> Net::ManageSieve.3pm: Managesieve protocol client</a></li>
   <li class="next"><a href="Net::NBName::NameQuery.3pm.html">Net::NBName::NameQuery.3pm: Netbios name query response <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
