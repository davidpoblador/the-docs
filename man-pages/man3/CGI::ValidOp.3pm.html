<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CGI::ValidOp: Simple validation of cgi parameters and runmodes.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Simple validation of cgi parameters and runmodes.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="CGI::ValidOp (3pm) manual">
  <meta name="twitter:description" content="Simple validation of cgi parameters and runmodes.">
  <meta name="twitter:image" content="https://www.carta.tech/images/libcgi-validop-perl-CGI::ValidOp-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/CGI::ValidOp.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="CGI::ValidOp (3pm) manual" />
  <meta property="og:description" content="Simple validation of cgi parameters and runmodes." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libcgi-validop-perl-CGI::ValidOp-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">CGI::ValidOp<small> (3pm)</small></h1>
        <p class="lead">Simple validation of cgi parameters and runmodes.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/CGI::ValidOp.3pm.html">
      <span itemprop="name">CGI::ValidOp: Simple validation of cgi parameters and runmodes.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libcgi-validop-perl/">
      <span itemprop="name">libcgi-validop-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/CGI::ValidOp.3pm.html">
      <span itemprop="name">CGI::ValidOp: Simple validation of cgi parameters and runmodes.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    # given the following CGI parameters:
    # op=add_item; name=William Blake; ssn=345-21-6789; crackme=$ENV{EVIL_MEAT};

    use CGI::ValidOp;

    my $cgi = CGI::ValidOp-&gt;new({
        add_item =&gt; {   # using full syntax
            name =&gt; {
                label =&gt; &apos;Name&apos;,
                checks =&gt; [ &apos;required&apos;, &apos;text::words&apos; ],
            },
            ssn =&gt; {
                label =&gt; &apos;Social Security number&apos;,
                checks =&gt; [ &apos;demographics::us_ssn&apos; ],
            },
        },
        remove_item =&gt; {   # using shortcut syntax
            ssn =&gt; [ &apos;Social Security number&apos;, &apos;required&apos;, &apos;demographics::us_ssn&apos; ],
            confirm =&gt; [ &apos;Confirmation checkbox&apos;, &apos;required&apos;, &apos;checkbox::boolean&apos; ],
        },
        cgi_object =&gt; new CGI($fh),
    });

    my $name    = $cgi-&gt;param( &apos;name&apos; );    # eq "William Blake"
    my $ssn     = $cgi-&gt;param( &apos;ssn&apos; );     # eq "345-21-6789"
    my $crackme = $cgi-&gt;param( &apos;crackme&apos; ); # is undef; it was removed by the check
    my $confirm = $cgi-&gt;param( &apos;confirm&apos; ); # is undef; it doesn&apos;t exist

    my $op      = $cgi-&gt;op;                 # eq "add_item"
    my @errors  = $cgi-&gt;errors;             # eq ( &apos;Parameter "crackme" contained invalid data.&apos; )
    my %vars    = $cgi-&gt;Vars;               # eq (
                                            #   name    =&gt; "William Blake",
                                            #   ssn     =&gt; "345-21-6789",
                                            #   crackme =&gt; undef,
                                            # )
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>CGI::ValidOp is a \s-1CGI\s0 parameter validator that also helps you manage runmodes. Its aims are similar to Perl's: make the easy jobs easy and the complex jobs possible.  \s-1CGI\s0 parameter validation is boring, and precisely for that reason it's easy to get wrong or ignore.  CGI::ValidOp takes as much of the repetition as possible out of this job, replacing it with a simple interface.</p><h3>Unique features</h3>
<p>There are many \s-1CGI\s0 parameter validation modules on \s-1CPAN\s0; why on earth would I write another one, and why should you use it?  Before writing ValidOp I made a list of requirements and checked all available modules against it, hoping that even if nothing matched there'd be a project which I could subclass or contribute to.  I didn't find anything.  Here's what I think ValidOp does right:</p>
<dl class='dl-vertical'>
  <dt>
    Simple \s-1API\s0.
  </dt>
  <dd>
    
  </dd>
  <dt>
    Minimal usage is useful.
  </dt>
  <dd>
    
  </dd>
  <dt>
    Easy to add new checks.
  </dt>
  <dd>
    
  </dd>
  <dt>
    Relation of parameters to run-modes/operations.
  </dt>
  <dd>
    <p>In addition to validating parameters, CGI::ValidOp has a number of methods for dealing with runmodes (henceforth referred to as 'ops').  In fact, the 'op' concept is key to ValidOp's advanced usage:  parameters are defined as children of ops.  A \*(L"display_item\*(R" op may need only a numeric id, while an \*(L"add_item\*(R" op will take several parameters.  All these can be defined once in a single location.</p>
  </dd>
  <dt>
    Validation defaults settable on many levels to minimize repetition.
  </dt>
  <dd>
    <p>You can change the validation defaults for the entire app, all parameters for one runmode, or per-parameter.</p>
  </dd>
  <dt>
    \s-1CGI\s0 integration and compatibility.
  </dt>
  <dd>
    <p>Parameters can be accessed just like with \s-1CGI\s0.pm: param for individual parameters and Vars for all of them.</p>
  </dd>
  <dt>
    Per-parameter error messages.
  </dt>
  <dd>
    <p>While error message must be available globally, having per-parameter error messages is an important usability improvement.  When returning a long form page to a user, it's good to show them error messages where they're most useful.</p>
  </dd>
  <dt>
    \s-1OO\s0 and test-driven
  </dt>
  <dd>
    <p>ValidOp is test-driven, object-oriented Perl.</p>
  </dd>
  <dt>
    Extensive and public test suite.
  </dt>
  <dd>
    <p>If you're going to trust someone else's code for security purposes it's nice to have proof that it works.  CGI::ValidOp has an extensive test suite that checks every part of its operation, particularly the validation routines.  I keep the current version running at &lt;http://sonofhans.net&gt; validop with a full test page.  If you can produce unexpected output, file a bug report.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<h3>new( &#92;%options )</h3>
<p>Creates and returns a new CGI::ValidOp object.  The initializing hashref is optional.  If supplied, it may contain two types of values:  configuration options and runmode definitions.  Configuration options must be prepended with a dash (\*(C`-\*(C'); runmodes must not be.</p><p>Setting 'cgi_object' will allow you to override the \s-1CGI\s0 object that would be provided by default, if say, you needed to use this module under mod_perl.</p><p>    my $cgi = CGI::ValidOp-&gt;new({         -allow_unexpected =&gt; 0,     # configuration option         add =&gt; {},                  # op, or runmode definition     );</p><p>See Configuration and \*(L"Runmode Management\*(R" for more details. \*(C`param\*(C' behaves similarly to the \s-1CGI\s0.pm method of the same name, returning the value for the named parameter.  The differences from \s-1CGI\s0.pm's \*(C`param\*(C' are:</p><ul>
<li><p>The return value will be validated against all defined checks.</p></li><li><p>The return value will be untainted if the checks require it.</p></li><li><p>Any necessary error messages will be created.</p></li>
</ul><p>The \*(C`&#92;@checks\*(C' arrayref is optional.  If supplied, it replaces all previously defined checks for the parameter and overrides all defaults.  An empty arrayref (\*(C`[]\*(C') will give you the parameter as input by the user, unchecked; it will still be tainted.</p>
<h3>Vars</h3>
<p>\*(C`Vars\*(C' behaves similarly to the \s-1CGI\s0.pm method of the same name, returning the entire parameter list.  In scalar context it returns a hash reference; in list context it returns a hash.  The differences from \s-1CGI\s0.pm's \*(C`Vars\*(C' method are:</p><ul>
<li><p>Multivalue parameters are returned as an arrayref, rather than a null-byte packed string.</p></li><li><p>The runmnode_name parameter (\*(L"op\*(R" by default) is not returned; see op for more details.</p></li><li><p>Unexpected parameters are not returned (see allow_unexpected).</p></li><li><p>Parameters that failed one or more checks are returned as \*(C`undef\*(C'.</p></li><li><p>In scalar context the hashref is not tied, and changes to it do not affect the parameter list.</p></li>
</ul>
<h3>op</h3>
<p>Returns the current runmode name.  In the normal case, this is the \s-1CGI\s0 parameter given for \*(L"op\*(R" (but see runmode_name).  Several factors affect the return value:</p><ul>
<li><p>If a runmode parameter is given but it doesn't match the name of any defined runmode, \*(L"runmode aliases\*(R" are searched.</p></li><li><p>If no \*(L"runmode alias\*(R" matches, the value of default_op is returned.</p></li>
</ul><p>Note that while ValidOp doesn't require you to use its runmode management features, it still uses them internally.  Even in the of no defined parameters or runmodes, ValidOp uses \*(L"default\*(R" as its runmode and all parameters are subsidiary to it.  This is invisible to the user.</p>
<h3>errors</h3>
<p>Returns an arrayref of all error messages for the current parameter list and parameter definitions.  Returns \*(C`undef\*(C' if there are no errors. Returns the CGI::ValidOp::Op object for the current runmode, or the runmode given.  See \*(L"Op Objects\*(R" for more details, or the documentation for CGI::ValidOp::Op for all the details.</p>
<h3>set_vars( &#92;%params )</h3>
<p>Resets the parameter list to the given hash reference.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION</h2>
        <div class="sectioncontent">
<p>ValidOp has a number of configurable options which alter its behavior.  These options can be given in the constructor, via accessor methods, or both:</p><p>    my $cgi = CGI::ValidOp-&gt;new({         -allow_unexpected   =&gt; 0,         -default_op         =&gt; &apos;home&apos;,     });</p><p>    $cgi-&gt;default_op( &apos;view&apos; );  # overrides &apos;home&apos; above</p><h3>allow_unexpected</h3>
<p>Default: <strong>1</strong>.  Accepts: <strong>1 or 0</strong>.  Controls whether ValidOp accepts incoming \s-1CGI\s0 parameters which you have not defined.  If true, all incoming parameters are accepted and validated.  If false, parameters you have not defined are ignored.</p>
<h3>return_only_received</h3>
<p>Default: <strong>0</strong>.  Accepts: <strong>1 or 0</strong>.  If true, will not return any data for a parameter not received in the query string.  ValidOp's default behavior is to return an \*(C`undef\*(C' value in this situation.</p>
<h3>default_op</h3>
<p>Default: <strong>'default'</strong>.  Accepts: <strong>word</strong>.  The default runmode name.  If no runmode parameter is given, or if the runmode given does not exist, the runmode specified here will be used.  See \*(L"Runmode Management\*(R".</p>
<h3>disable_uploads</h3>
<p>Default: <strong>1</strong>.  Accepts: <strong>positive integer</strong>.  Passed through to \s-1CGI\s0.pm when getting parameters.  See \s-1CGI\s0.pm.</p>
<h3>error_decoration</h3>
<p>Default: <strong>undef</strong>.  Accepts: <strong>array</strong>.  Text with which to surround parameter labels in error messages.  If given a single scalar, it is inserted both before and after the label.  If given an arrayref, the first value is inserted before and the second is inserted after.</p><p>Given an error message of \*(C`$label is required.\*(C' and a label of \*(L"Confirmation checkbox,\*(R" ValidOp would normally output \*(C`Confirmation checkbox is required.\*(C'.  Here's how various values affect the error message:</p><p>    $cgi-&gt;error_decoration( &apos;"&apos; );     # "Confirmation checkbox" is required.</p><p>    $cgi-&gt;error_decoration( &apos;* &apos;, undef );     # * Confirmation checkbox is required.</p><p>    $cgi-&gt;error_decoration( undef, &apos;:&apos; );     # Confirmation checkbox: is required.</p><p>    $cgi-&gt;error_decoration( &apos;&lt;strong&gt;&apos;, &apos;&lt;/strong&gt;&apos; );     # &lt;strong&gt;Confirmation checkbox&lt;/strong&gt; is required.</p>
<h3>post_max</h3>
<p>Default: <strong>25,000</strong>.  Accepts: <strong>positive integer</strong>.  Passed through to \s-1CGI\s0.pm when getting parameters.  See \s-1CGI\s0.pm.</p>
<h3>runmode_name</h3>
<p>Default: <strong>'op'</strong>.  Accepts: <strong>word</strong>.  The name of the runmode.  ValidOp treates the runmode parameter differently from other parameters; see \*(L"Runmode Management\*(R" for more details.</p>
<h3>on_error_return...</h3>
<p>These routines control what values are returned by \*(C`Vars()\*(C' and \*(C`param()\*(C'.  They are mutually exclusive, and have the following order of precedence:</p><ul>
<li><p>on_error_return_undef</p></li><li><p>on_error_return_encoded</p></li><li><p>on_error_return_tainted</p></li>
</ul><p>In other words, if both \*(C`on_error_return_undef\*(C' and \*(C`on_error_return_tainted\*(C' are given as true, \*(C`on_error_return_undef\*(C' will apply.</p><p><em>on_error_return_undef</em></p><p>The default behavior.  Values which fail validation are ignored, and returned as \*(C`undef\*(C'.</p><p><em>on_error_return_encoded</em></p><p>Values which fail validation are returned as input, but first encoded with HTML::Entities's \*(C`encode()\*(C' method.</p><p><em>on_error_return_tainted</em></p><p>Values which fail validation are returned unchanged.  Don't do this.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Defining Checks</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    ValidOp checks
  </dt>
  <dd>
    <p>When constructing a CGI::ValidOp object, you may pass a \*(C`-checks\*(C' option.  The default checks are: \*(C`[&apos;text&apos;]\*(C'.</p>
  </dd>
  <dt>
    Op checks
  </dt>
  <dd>
    <p>When defining an op within the CGI::ValidOp constructor, you may pass a \*(C`-checks\*(C' option.</p>
  </dd>
  <dt>
    Parameter checks
  </dt>
  <dd>
    <p>When defining a param within the op definition, you may pass a \*(C`-checks\*(C' option.</p>
  </dd>
  <dt>
    On-the-fly checks
  </dt>
  <dd>
    <p>When calling the \*(C`param\*(C' method, you may pass an array reference as the second parameter.  This arrayref is passed straight through to the parameter's \*(C`checks\*(C' accessor.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (c) 2003-2005 Randall Hansen. All rights reserved.</p><p>This program is free software; you may redistribute it and/or modify it under the same terms as Perl itself.</p><p>See http://www.perl.com/perl/misc/Artistic.html</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Randall Hansen &lt;legless@cpan.org&gt;</p><p>Chad Granum &lt;exodist7@gmail.com&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="CGI::Untaint::email.3pm.html"><span aria-hidden="true">&larr;</span> CGI::Untaint::email.3pm: Validate an email address</a></li>
   <li class="next"><a href="CGI::ValidOp::Base.3pm.html">CGI::ValidOp::Base.3pm: Base class for cgi::validop and its associates. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
