<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>heart: Heartbeat monitoring of an erlang runtime system</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Heartbeat monitoring of an erlang runtime system">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="heart (3erl) manual">
  <meta name="twitter:description" content="Heartbeat monitoring of an erlang runtime system">
  <meta name="twitter:image" content="https://www.carta.tech/images/erlang-manpages-heart-3erl.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3erl/heart.3erl.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="heart (3erl) manual" />
  <meta property="og:description" content="Heartbeat monitoring of an erlang runtime system" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/erlang-manpages-heart-3erl.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">heart<small> (3erl)</small></h1>
        <p class="lead">Heartbeat monitoring of an erlang runtime system</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3erl/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3erl/heart.3erl.html">
      <span itemprop="name">heart: Heartbeat monitoring of an erlang runtime system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/erlang-manpages/">
      <span itemprop="name">erlang-manpages</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3erl/heart.3erl.html">
      <span itemprop="name">heart: Heartbeat monitoring of an erlang runtime system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This modules contains the interface to the <em>heart</em> process. <em>heart</em> sends periodic heartbeats to an external port program, which is also named <em>heart</em>. The purpose of the heart port program is to check that the Erlang runtime system it is supervising is still running. If the port program has not received any heartbeats within <em>HEART_BEAT_TIMEOUT</em> seconds (default is 60 seconds), the system can be rebooted. Also, if the system is equipped with a hardware watchdog timer and is running Solaris, the watchdog can be used to supervise the entire system.</p><p>An Erlang runtime system to be monitored by a heart program, should be started with the command line flag <em>-heart</em> (see also <a href="../man1/erl.1.html"><strong>erl</strong>(1)</a></strong>). The <em>heart</em> process is then started automatically:</p>
<pre>
% erl -heart ...
</pre>
<p>If the system should be rebooted because of missing heart-beats, or a terminated Erlang runtime system, the environment variable <em>HEART_COMMAND</em> has to be set before the system is started. If this variable is not set, a warning text will be printed but the system will not reboot. However, if the hardware watchdog is used, it will trigger a reboot <em>HEART_BEAT_BOOT_DELAY</em> seconds later nevertheless (default is 60).</p><p>To reboot on the WINDOWS platform <em>HEART_COMMAND</em> can be set to <em>heart -shutdown</em> (included in the Erlang delivery) or of course to any other suitable program which can activate a reboot.</p><p>The hardware watchdog will not be started under Solaris if the environment variable <em>HW_WD_DISABLE</em> is set.</p><p>The <em>HEART_BEAT_TIMEOUT</em> and <em>HEART_BEAT_BOOT_DELAY</em> environment variables can be used to configure the heart timeouts, they can be set in the operating system shell before Erlang is started or be specified at the command line:</p>
<pre>
% erl -heart -env HEART_BEAT_TIMEOUT 30 ...
</pre>
<p>The value (in seconds) must be in the range 10 &lt; X &lt;= 65535.</p><p>It should be noted that if the system clock is adjusted with more than <em>HEART_BEAT_TIMEOUT</em> seconds, <em>heart</em> will timeout and try to reboot the system. This can happen, for example, if the system clock is adjusted automatically by use of NTP (Network Time Protocol).</p><p>If a crash occurs, an <em>erl_crash.dump</em> will <em>not</em> be written unless the environment variable <em>ERL_CRASH_DUMP_SECONDS</em> is set.</p>
<pre>
% erl -heart -env ERL_CRASH_DUMP_SECONDS 10 ...
</pre>
<p>Furthermore, <em>ERL_CRASH_DUMP_SECONDS</em> has the following behaviour on <em>heart</em>:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p><em>ERL_CRASH_DUMP_SECONDS=0</em>: Suppresses the writing a crash dump file entirely, thus rebooting the runtime system immediately. This is the same as not setting the environment variable.</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p><em>ERL_CRASH_DUMP_SECONDS=-1</em>: Setting the environment variable to a negative value will not reboot the runtime system until the crash dump file has been completly written.</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p><em>ERL_CRASH_DUMP_SECONDS=S</em>: Heart will wait for <em>S</em> seconds to let the crash dump file be written. After <em>S</em> seconds <em>heart</em> will reboot the runtime system regardless of the crash dump file has been written or not.</p>
  </dd>

</dl>
<p>In the following descriptions, all function fails with reason <em>badarg</em> if <em>heart</em> is not started.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXPORTS</h2>
        <div class="sectioncontent">

<pre>
<strong></strong>
set_cmd(Cmd) -&gt; ok | {error, {bad_cmd, Cmd}}

</pre>
<p>Types:</p><p>Cmd = string()</p><p>Sets a temporary reboot command. This command is used if a <em>HEART_COMMAND</em> other than the one specified with the environment variable should be used in order to reboot the system. The new Erlang runtime system will (if it misbehaves) use the environment variable <em>HEART_COMMAND</em> to reboot.</p><p>Limitations: The <em>Cmd</em> command string will be sent to the heart program as a ISO-latin-1 or UTF-8 encoded binary depending on the file name encoding mode of the emulator (see <strong></strong><em>file:native_name_encoding/0</em>). The size of the encoded binary must be less than 2047 bytes.</p>
<pre>
<strong></strong>
clear_cmd() -&gt; ok

</pre>
<p>Clears the temporary boot command. If the system terminates, the normal <em>HEART_COMMAND</em> is used to reboot.</p>
<pre>
<strong></strong>
get_cmd() -&gt; {ok, Cmd}

</pre>
<p>Types:</p><p>Cmd = string()</p><p>Get the temporary reboot command. If the command is cleared, the empty string will be returned.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="gs.3erl.html"><span aria-hidden="true">&larr;</span> gs.3erl: The graphics system for erlang.</a></li>
   <li class="next"><a href="http_uri.3erl.html">http_uri.3erl: Uri utility module <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
