<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>mallinfo: Obtain memory allocation information</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Obtain memory allocation information">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="mallinfo (3) manual">
  <meta name="twitter:description" content="Obtain memory allocation information">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/mallinfo.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="mallinfo (3) manual" />
  <meta property="og:description" content="Obtain memory allocation information" />
  <meta property="fb:app_id" content="1241677679199500" />

</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">mallinfo<small> (3)</small></h1>
        <p class="lead">Obtain memory allocation information</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/mallinfo.3.html">
      <span itemprop="name">mallinfo: Obtain memory allocation information</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/man-pages/">
      <span itemprop="name">man-pages</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/mallinfo.3.html">
      <span itemprop="name">mallinfo: Obtain memory allocation information</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>#include &lt;malloc.h&gt;</strong></p><p><strong>struct mallinfo mallinfo(void);</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <strong>mallinfo</strong>() function returns a copy of a structure containing information about memory allocations performed by <a href="../man3/malloc.3.html"><strong>malloc</strong>(3)</a> and related functions. This structure is defined as follows:</p>
<pre>
struct mallinfo {
    int arena;     /* Non-mmapped space allocated (bytes) */
    int ordblks;   /* Number of free chunks */
    int smblks;    /* Number of free fastbin blocks */
    int hblks;     /* Number of mmapped regions */
    int hblkhd;    /* Space allocated in mmapped regions (bytes) */
    int usmblks;   /* Maximum total allocated space (bytes) */
    int fsmblks;   /* Space in freed fastbin blocks (bytes) */
    int uordblks;  /* Total allocated space (bytes) */
    int fordblks;  /* Total free space (bytes) */
    int keepcost;  /* Top-most, releasable space (bytes) */
};
</pre>
<p>The fields of the <em>mallinfo</em> structure contain the following information:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>arena</em></p>
  </dt>
  <dd>
    <p>The total amount of memory allocated by means other than <a href="../man2/mmap.2.html"><strong>mmap</strong>(2)</a> (i.e., memory allocated on the heap). This figure includes both in-use blocks and blocks on the free list.</p>
  </dd>
  <dt>
    <p><em>ordblks</em></p>
  </dt>
  <dd>
    <p>The number of ordinary (i.e., non-fastbin) free blocks.</p>
  </dd>
  <dt>
    <p><em>smblks</em></p>
  </dt>
  <dd>
    <p>The number of fastbin free blocks (see <a href="../man3/mallopt.3.html"><strong>mallopt</strong>(3)</a>).</p>
  </dd>
  <dt>
    <p><em>hblks</em></p>
  </dt>
  <dd>
    <p>The number of blocks currently allocated using <a href="../man2/mmap.2.html"><strong>mmap</strong>(2)</a>. (See the discussion of <strong>M_MMAP_THRESHOLD</strong> in <a href="../man3/mallopt.3.html"><strong>mallopt</strong>(3)</a>.)</p>
  </dd>
  <dt>
    <p><em>hblkhd</em></p>
  </dt>
  <dd>
    <p>The number of bytes in blocks currently allocated using <a href="../man2/mmap.2.html"><strong>mmap</strong>(2)</a>.</p>
  </dd>
  <dt>
    <p><em>usmblks</em></p>
  </dt>
  <dd>
    <p>The "highwater mark" for allocated space&ndash;that is, the maximum amount of space that was ever allocated. This field is maintained only in nonthreading environments.</p>
  </dd>
  <dt>
    <p><em>fsmblks</em></p>
  </dt>
  <dd>
    <p>The total number of bytes in fastbin free blocks.</p>
  </dd>
  <dt>
    <p><em>uordblks</em></p>
  </dt>
  <dd>
    <p>The total number of bytes used by in-use allocations.</p>
  </dd>
  <dt>
    <p><em>fordblks</em></p>
  </dt>
  <dd>
    <p>The total number of bytes in free blocks.</p>
  </dd>
  <dt>
    <p><em>keepcost</em></p>
  </dt>
  <dd>
    <p>The total amount of releasable free space at the top of the heap. This is the maximum number of bytes that could ideally (i.e., ignoring page alignment restrictions, and so on) be released by <a href="../man3/malloc_trim.3.html"><strong>malloc_trim</strong>(3)</a>.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ATTRIBUTES</h2>
        <div class="sectioncontent">
<p>For an explanation of the terms used in this section, see <a href="../man7/attributes.7.html"><strong>attributes</strong>(7)</a>.</p><table class="table table-striped">
<tr>
<th>Interface</th>
<th>Attribute</th>
<th>Value</th></tr>

<tr>
<td><strong>mallinfo</strong>()  </td>
<td>Thread safety</td>
<td>MT-Unsafe init const:mallopt</td></tr>
</table><p><strong>mallinfo</strong>() would access some global iternal objects. If modify them with non-atomically, may get inconsistent results. The identifier <em>mallopt</em> in <em>const:mallopt</em> mean that <strong>mallopt</strong>() would modify the global iternal objects with atomics, that make sure <strong>mallinfo</strong>() is safe enough, others modify with non-atomically maybe not.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFORMING TO</h2>
        <div class="sectioncontent">
<p>This function is not specified by POSIX or the C standards. A similar function exists on many System V derivatives, and was specified in the SVID.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p><strong>Information is returned for only the main memory allocation area.</strong> Allocations in other arenas are excluded. See <a href="../man3/malloc_stats.3.html"><strong>malloc_stats</strong>(3)</a> and <a href="../man3/malloc_info.3.html"><strong>malloc_info</strong>(3)</a> for alternatives that include information about other arenas.</p><p>The fields of the <em>mallinfo</em> structure are typed as <em>int</em>. However, because some internal bookkeeping values may be of type <em>long</em>, the reported values may wrap around zero and thus be inaccurate.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>The program below employs <strong>mallinfo</strong>() to retrieve memory allocation statistics before and after allocating and freeing some blocks of memory. The statistics are displayed on standard output.</p><p>The first two command-line arguments specify the number and size of blocks to be allocated with <a href="../man3/malloc.3.html"><strong>malloc</strong>(3)</a>.</p><p>The remaining three arguments specify which of the allocated blocks should be freed with <a href="../man3/free.3.html"><strong>free</strong>(3)</a>. These three arguments are optional, and specify (in order): the step size to be used in the loop that frees blocks (the default is 1, meaning free all blocks in the range); the ordinal position of the first block to be freed (default 0, meaning the first allocated block); and a number one greater than the ordinal position of the last block to be freed (default is one greater than the maximum block number). If these three arguments are omitted, then the defaults cause all allocated blocks to be freed.</p><p>In the following example run of the program, 1000 allocations of 100 bytes are performed, and then every second allocated block is freed:</p>
<pre>
$ <strong>./a.out 1000 100 2</strong>
============== Before allocating blocks ==============
Total non-mmapped bytes (arena):       0
# of free chunks (ordblks):            1
# of free fastbin blocks (smblks):     0
# of mapped regions (hblks):           0
Bytes in mapped regions (hblkhd):      0
Max. total allocated space (usmblks):  0
Free bytes held in fastbins (fsmblks): 0
Total allocated space (uordblks):      0
Total free space (fordblks):           0
Topmost releasable block (keepcost):   0

============== After allocating blocks ==============
Total non-mmapped bytes (arena):       135168
# of free chunks (ordblks):            1
# of free fastbin blocks (smblks):     0
# of mapped regions (hblks):           0
Bytes in mapped regions (hblkhd):      0
Max. total allocated space (usmblks):  0
Free bytes held in fastbins (fsmblks): 0
Total allocated space (uordblks):      104000
Total free space (fordblks):           31168
Topmost releasable block (keepcost):   31168

============== After freeing blocks ==============
Total non-mmapped bytes (arena):       135168
# of free chunks (ordblks):            501
# of free fastbin blocks (smblks):     0
# of mapped regions (hblks):           0
Bytes in mapped regions (hblkhd):      0
Max. total allocated space (usmblks):  0
Free bytes held in fastbins (fsmblks): 0
Total allocated space (uordblks):      52000
Total free space (fordblks):           83168
Topmost releasable block (keepcost):   31168
</pre>
<h3>Program source</h3>

<pre>
#include &lt;malloc.h&gt;
#include "tlpi_hdr.h"

static void
display_mallinfo(void)
{
    struct mallinfo mi;

    mi = mallinfo();

    printf("Total non-mmapped bytes (arena):       %d&#92;n", mi.arena);
    printf("# of free chunks (ordblks):            %d&#92;n", mi.ordblks);
    printf("# of free fastbin blocks (smblks):     %d&#92;n", mi.smblks);
    printf("# of mapped regions (hblks):           %d&#92;n", mi.hblks);
    printf("Bytes in mapped regions (hblkhd):      %d&#92;n", mi.hblkhd);
    printf("Max. total allocated space (usmblks):  %d&#92;n", mi.usmblks);
    printf("Free bytes held in fastbins (fsmblks): %d&#92;n", mi.fsmblks);
    printf("Total allocated space (uordblks):      %d&#92;n", mi.uordblks);
    printf("Total free space (fordblks):           %d&#92;n", mi.fordblks);
    printf("Topmost releasable block (keepcost):   %d&#92;n", mi.keepcost);
}

int
main(int argc, char *argv[])
{
#define MAX_ALLOCS 2000000
    char *alloc[MAX_ALLOCS];
    int numBlocks, j, freeBegin, freeEnd, freeStep;
    size_t blockSize;

    if (argc &lt; 3 || strcmp(argv[1], "--help") == 0)
        usageErr("%s num-blocks block-size [free-step [start-free "
                "[end-free]]]&#92;n", argv[0]);

    numBlocks = atoi(argv[1]);
    blockSize = atoi(argv[2]);
    freeStep = (argc &gt; 3) ? atoi(argv[3]) : 1;
    freeBegin = (argc &gt; 4) ? atoi(argv[4]) : 0;
    freeEnd = (argc &gt; 5) ? atoi(argv[5]) : numBlocks;

    printf("============== Before allocating blocks ==============&#92;n");
    display_mallinfo();

    for (j = 0; j &lt; numBlocks; j++) {
        if (numBlocks &gt;= MAX_ALLOCS)
            fatal("Too many allocations");

        alloc[j] = malloc(blockSize);
        if (alloc[j] == NULL)
            errExit("malloc");
    }

    printf("&#92;n============== After allocating blocks ==============&#92;n");
    display_mallinfo();

    for (j = freeBegin; j &lt; freeEnd; j += freeStep)
        free(alloc[j]);

    printf("&#92;n============== After freeing blocks ==============&#92;n");
    display_mallinfo();

    exit(EXIT_SUCCESS);
}
</pre>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO mallinfo&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man2/mmap.2.html"><strong>mmap</strong>(2)</a>, <a href="../man3/malloc.3.html"><strong>malloc</strong>(3)</a>, <a href="../man3/malloc_info.3.html"><strong>malloc_info</strong>(3)</a>, <a href="../man3/malloc_stats.3.html"><strong>malloc_stats</strong>(3)</a>, <a href="../man3/malloc_trim.3.html"><strong>malloc_trim</strong>(3)</a>, <a href="../man3/mallopt.3.html"><strong>mallopt</strong>(3)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="makedev.3.html"><span aria-hidden="true">&larr;</span> makedev.3: Manage a device number</a></li>
   <li class="next"><a href="malloc.3.html">malloc.3: Allocate and free dynamic memory <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
