<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>RTF::Cookbook: Rtf overview and quick reference</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Rtf overview and quick reference">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="RTF::Cookbook (3pm) manual">
  <meta name="twitter:description" content="Rtf overview and quick reference">
  <meta name="twitter:image" content="https://www.carta.tech/images/librtf-writer-perl-RTF::Cookbook-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/RTF::Cookbook.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="RTF::Cookbook (3pm) manual" />
  <meta property="og:description" content="Rtf overview and quick reference" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/librtf-writer-perl-RTF::Cookbook-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">RTF::Cookbook<small> (3pm)</small></h1>
        <p class="lead">Rtf overview and quick reference</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/RTF::Cookbook.3pm.html">
      <span itemprop="name">RTF::Cookbook: Rtf overview and quick reference</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/librtf-writer-perl/">
      <span itemprop="name">librtf-writer-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/RTF::Cookbook.3pm.html">
      <span itemprop="name">RTF::Cookbook: Rtf overview and quick reference</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  # Time-stamp: "2003-09-23 21:27:56 ADT"
  # This document is in Perl POD format, but you can read it
  # with just an ASCII text viewer, if you want.
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>\s-1RTF\s0 is a nearly ubiquitous text formatting language devised by Microsoft.  Microsoft's <em>Rich Text Format Specification</em> is widely available, but it's usable mainly just as a reference for the language's entire command set.</p><p>This short document, however, is meant as a quick reference and overview.  It is meant for people interested in writing programs that generate a minimal subset of \s-1RTF\s0.</p><p><strong></strong><strong>\s-1NOTE\s0</strong><strong></strong> : I've mostly superceded this document with my book <em>\s-1RTF\s0 Pocket Guide</em>, which is much longer and more comprehensive \*(-- see &lt;http://www.oreilly.com/catalog/rtfpg/&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INTRODUCTION</h2>
        <div class="sectioncontent">
<p>\s-1RTF\s0 code consists of plaintext, commands, escapes, and groups:</p><p>Plaintext contains seven bit (\s-1US\s0 \s-1ASCII\s0) characters except for &#92;, {, and }.  Returns and linefeeds can be present but are ignored, and are harmless (as long as they are not in the middle of an \s-1RTF\s0 command).  Space (\s-1ASCII\s0 0x20) characters <em>are</em> significant \*(-- five spaces means five spaces.  (The only exception is a space that ends an \s-1RTF\s0 command; such a space is ignored.) Example of plaintext: \*(L"I like pie\*(R".</p><p>An \s-1RTF\s0 command consists of a backslash, then some characters a-z, and then an optional positive or negative integer argument.  The command is then terminated either by a space, return, or linefeed (all of which are ignored), or by some character (like brace or backslash, etc.) that couldn't possibly be a continuation of this command.  A simple rule of thumb for emitting \s-1RTF\s0 is that every command should be immediately followed either by a space, return, or linefeed, (as in \*(L"&#92;foo bar\*(R"), or by another command (as in \*(L"&#92;foo&#92;bar\*(R"). Examples of \s-1RTF\s0 commands: \*(L"&#92;page\*(R" (command \*(L"page\*(R" with no parameter), \*(L"&#92;f3\*(R" (command \*(L"f\*(R" with parameter 3), \*(L"&#92;li-320\*(R" (command \*(L"li\*(R" with parameter -320).</p><p>An \s-1RTF\s0 escape consists of a backslash followed by something other than a letter.  There are few of these in the language, and the basic ones to know now are the two-byte long escape sequences: &#92;{, &#92;}, &#92;&#92; (to convey a literal openbrace, closebrace, or backslash), and the only four-byte-long escape sequence, &#92;'xx, where xx is two hexadecimal digits.  This is used for expressing any byte value in a document.  For example, &#92;x'\s-1BB\s0 expresses character value \s-1BB\s0 (decimal 187), which for Latin-1/ANSI is close-angle-quote (which looks like a little \*(L"&gt;&gt;\*(R").</p><p>An \s-1RTF\s0 group consists of an openbrace \*(L"{\*(R", any amount of \s-1RTF\s0 code (possibly including other groups), and then a closebrace \*(L"}\*(R".  Roughly speaking, you can treat an \s-1RTF\s0 group as the conceptual equivalent of an \s-1SGML\s0 element. Effectively, a group limits the scope of commands in that group.  So if you're in a group and you turn on italics, then that can apply only as far as the end of the group \*(-- regardless of whether you do this at the start of the group, as in {&#92;i I like pie}, or the middle, as in {I like &#92;i pie}.  Note that you must emit just as many openbraces as closebraces \*(-- otherwise your document is syntactally invalid, and \s-1RTF\s0 readers will not tolerate that.</p><p>This is an example of a paragraph using plaintext, escapes, commands, and groups:</p><p>  {&#92;pard&#92;fs32&#92;b NOTES&#92;par}   {&#92;pard&#92;fs26 Recently I skimmed {&#92;i Structure and Interpretation of    Computer Programs}, by Sussman and Abelson, and I think there should    have been more pictures.   &#92;line I like pictures.  Is that so na&#92;&apos;efve?   &#92;par}</p><p>(&#92;'ef makes an i-dieresis, in the Latin-1/ANSI character set.)</p><p>Note that \*(L"foo[newline]bar\*(R" isn't the same as \*(L"foo bar\*(R", it's the same as \*(L"foobar\*(R", because the newline is <em>ignored</em>.  So if you mean \*(L"foo bar\*(R", and want to work in a newline, you should consider \*(L"foo[newline] bar\*(R", or \*(L"foo [newline]bar\*(R", or even things like \*(L"fo[newline]o bar\*(R".</p><p>Note that newlines aren't needed in your output file at all, and there's no reason to get your \s-1RTF\s0 code to be wrapped at 72 columns or anywhere else; but it's very useful to be able to open a \s-1RTF\s0 file in a plaintext editor and see something other than a giant sea of unbroken text.  So at the very least, I emit a newline before every paragraph.</p><p>(Note that if you <em>are</em> ambitiously trying to wrap your \s-1RTF\s0 code by inserting newlines, consider that just about the only really <em>harmful</em> places to insert a newline are in the middle of a command or an escape \*(-- because \*(L"&#92;pa[newline]ge\*(R" doesn't mean the same as \*(L"&#92;page\*(R", it means the same as \*(L"&#92;pa ge\*(R" (i.e., a &#92;pa command, and then two text characters \*(L"ge\*(R"); and \*(L"&#92;'f[newline]8\*(R" is not good \s-1RTF\s0. So I suggest making wrapping algorithms insert a newline only after a space character \*(-- a guaranteed safe spot.)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Twips</h2>
        <div class="sectioncontent">
<p>Measurements in \s-1RTF\s0 are generally in twips.  A twip is a twentieth of a point, i.e., a 1440th of an inch.  That leads to some large numbers sometimes (like &#92;li2160, to set the left indent to an inch and a half), but this table should be useful for conversions:</p><p> inches    twips     points   centimeters  ------  -------     ------   -----------            20 tw     1 pt            40 tw     2 pt           ~57 tw                .1cm            60 tw     3 pt            80 tw     4 pt  1/16"     90 tw     4.5 pts           100 tw     5 pts          ~113 tw                .2cm  1/9"     160 tw     8 pts          ~170 tw                .3cm  1/8"     180 tw     9 pts  1/7"    ~206 tw     ~10.3 pts          ~227 tw                .4cm  1/6"     240 tw     12 pts  3/16"    270 tw     13.5 pts          ~283 tw                .5cm  1/5"     288 tw     14.4 pts          ~340 tw                .6cm  1/4"     360 tw     18 pts          ~397 tw                .7cm          ~454 tw                .8cm  1/3"     480 tw     24 pts          ~510 tw                .9cm          ~567 tw                 1cm  1/2"     720 tw     36 pts          ~850 tw               1.5cm  3/4     1080 tw     54 pts         ~1134 tw                 2cm   1"     1440 tw     72 pts         ~1701 tw                 3cm   1.5"   2160 tw    108 pts         ~2268 tw                 4cm         ~2835 tw                 5cm   2"     2880 tw    144 pts         ~3402 tw                 6cm   2.5"   3600 tw    180 pts   3"     4320 tw    216 pts         ~5669 tw                10cm   4"     5760 tw    288 pts   5"     7200 tw    360 pts</p><p>(Conversions between centimeters and anything else are approximate, so figures with a preceding \*(L"~\*(R" have been rounded.)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RTF Document Structure</h2>
        <div class="sectioncontent">
<p>An \s-1RTF\s0 document consists of:</p><ul>
<li><p>a prolog, which starts with a \*(L"{\*(R", and then has essential information for the document</p></li><li><p>then some optional document-formatting commands</p></li><li><p>then any amount of commands, groups, plaintext, and escapes</p></li><li><p>then a closing \*(L"}\*(R" (which closes the group opened by the start of the prolog).</p></li>
</ul><h3>\s-1RTF\s0 Prolog</h3>
<p>A minimal \s-1RTF\s0 prolog looks like this:</p><p>  {&#92;rtf1&#92;ansi&#92;deff0{&#92;fonttbl{&#92;f0 Times New Roman;}}</p><p>This declares this file as being in \s-1RTF\s0 version 1 (the only version there is at time of writing), that the charset in use in \s-1ANSI\s0 (Latin-1), the default font is the 0th entry in the font table (to follow).  And then this declares a font table consisting only of one entry, number 0, for Times New Roman.</p><p>A font table with three fonts might look like:</p><p>  {&#92;rtf1&#92;ansi&#92;deff0{&#92;fonttbl   {&#92;f0 Georgia;}   {&#92;f1 Braille Kiama;}   {&#92;f2 Courier New;}   }</p><p>Note that each font-name has to be followed by a semicolon. Recall that the newlines here ignored, and so are useful here only for readability.  But unlike most computer languages, you can't indent this (or any other part of an \s-1RTF\s0 document) with space characters or tabs \*(-- those would <em>not</em> be ignored!</p><p>A generally optional but sometimes necessary part of the prolog is a color table.  This is a color table:</p><p>  {&#92;colortbl;&#92;red255&#92;green0&#92;blue0;&#92;red0&#92;green0&#92;blue255;}</p><p>That declares three colors: a 0th entry, with null (default) color (expressed by the zero-length string between \*(L"&#92;colortbl\*(R" and \*(L";\*(R"), then a 1st entry, which is 100% red, and then a 2nd entry, which is 100% blue.  (Note that each entry, whether null or &#92;redN&#92;greenN&#92;blueN, must be followed by a semicolon.)  A color table is necessary only if you need to change text foreground or background colors \*(-- in that case, you need to refer to entries in the color table.  For more information, see the \s-1RTF\s0 spec.  If you aren't changing text color in the document, you needn't bother with a color table.  (Some graphics options might involve the color table, but graphics is not discussed in this document.)</p>
<h3>\s-1RTF\s0 Document Formatting Commands</h3>
<p>Then following the prolog, there are document-formatting codes \*(-- i.e., codes that apply to the document as a whole. This section is often left empty, but a commonly useful string is:</p><p>  &#92;deflang1033&#92;widowctrl</p><p>That declares that the default language in the document is \s-1US\s0 English (for purposes of spellchecking and possibly hyphenation), and also turns on widow-and-orphan control.</p><p>A useful bit of code that's worth emitting right after the document-formatting commands, is this:</p><p>  {&#92;header&#92;pard&#92;qr&#92;plain&#92;f0&#92;chpgn&#92;par}</p><p>That turns on page numbering.  Strictly speaking, it is not a document-formatting command, but a section-formatting command.  However, as \*(L"section\*(R" is not a concept addressed in this document, you can just think of that code as just something to be emitted before you start your document content, and after any real document-formatting commands.</p>
<h3>\s-1RTF\s0 Document Content</h3>
<p>Document content is basically text (plaintext, commands, and escapes) in paragraphs (in the broad sense of \*(L"paragraph\*(R", including things like headers). Although it's not necessary to put braces (\*(L"{...}\*(R") around each paragraph, it is often useful to do so, to keep character formatting codes from bleeding into the next paragraph.  Taking that approach, a basic paragraph looks like this:</p><p>  {&#92;pard   ...stuff...   &#92;par}</p><p>Here, &#92;pard signals that this paragraph shouldn't inherit paragraph-formatting attributes from the previous paragraph. (You're free to try experimenting with leaving out the &#92;pard in order to inherit attributes, but I advise against it, as I find it leads to abstruse \s-1RTF\s0 and hard-to-find bugs.) And &#92;par signals the end of this paragraph.</p><p>Paragraph-formatting attributes include justification (like &#92;qj for full justification), &#92;liN, &#92;riN, and &#92;fiN for (respectively) paragraph indenting on the left, paragraph indenting on the right, and left indenting for just the first line.</p><p>For example:</p><p>  {&#92;pard   &#92;li1440&#92;ri1440&#92;fi480&#92;qj   A resource can be anything that has identity.  Familiar    examples include an electronic document, an image, a service    (e.g., "today&apos;s weather report for Los Angeles"), and a    collection of other resources.  Not all resources are network    "retrievable"; e.g., human beings, corporations, and bound    books in a library can also be considered resources.   &#92;par}</p><p>This sets left and right margins of 1 inch, and an additional first-line indenting of a third of an inch (480 twips), and full justification.  Formatted, it'll look like this:</p><p>          A resource can be anything that has identity.   Familiar       examples include an electronic document, an image, a service       (e.g.,  "today&apos;s  weather report for  Los Angeles"),  and  a       collection of other resources. Not all resources are network       "retrievable";  e.g.,  human beings, corporations, and bound</p><p>You can have a negative figure for first-line indenting, to give the effect of a \*(L"hanging paragraph\*(R":</p><p>  {&#92;pard   &#92;li500&#92;fi-300&#92;ri200&#92;ql   {&#92;b&#92;f2&#92;fs30 resource:} [jargon] {&#92;i n.}  anything that has identity.    Familiar examples include an electronic document, an image, a    service (e.g., "today&apos;s  weather report for Los Angeles"), and a    collection of other resources.   &#92;par   }</p><p>This says that the paragraph's left margin is 500 twips; the first line indent is -300 twips \*(-- meaning 300 twips <em>back</em> from the paragraph's left end (i.e., 200 twips from the page's left margin!); the right indent is 200 twips; and the paragraph is to be left-justified (i.e., with a ragged right edge).</p><p>Formatted, it'll look like this:</p><p>    resource: [jargon] n.  anything that has anything that has         identity.  Familiar examples include an electronic         document, an image, a service (e.g., "today&apos;s weather         report for Los Angeles"), and a collection of other         resources.</p><p>If you want a newline in the middle of a paragraph (like a \*(L"&lt;br&gt;\*(R" in \s-1HTML\s0), use the &#92;line command:</p><p>  {&#92;par&#92;pard&#92;sb300&#92;sa300     my $x = "&lt;&lt;&lt;&gt;&lt;&lt;&lt;&gt;&gt;&lt;&gt;&gt;&lt;&lt;&gt;&gt;&lt;&gt;&gt;&gt;";&#92;line     print "[$x] initially&#92;&apos;5cn";&#92;line     print "[$x]&#92;&apos;5cn"&#92;line       while $x =~ s/&lt;&gt;//;&#92;line     print "[$x] finally&#92;&apos;5cn";&#92;line   &#92;par}</p><p>That paragraph expresses a block of Perl code, with 300 twips of vertical space before it all, and 300 twips of vertical space after it all.</p><p>Even headings are typically expressed as paragraphs:</p><p>  {&#92;pard   &#92;qc   &#92;b&#92;f3&#92;fs40 Section 1: The Larch   &#92;par}</p><p>This uses the &#92;qc code, for paragraph-centering, which is useful generally only in headings.  The character-formatting codes used here are: &#92;b for bold, &#92;f3 to change to whatever is entry 3 in the font table, and &#92;fs40 to change the current point size to 20-point.  The integer parameter for the &#92;fsN command is in half-points, so that's why 40 means 20-point type.  &#92;fsN is is one of the few commands in \s-1RTF\s0 (and the only one that I mention here) that expresses size/distance in units other than twips.</p><p>Character formatting codes are given further below, and they are relatively straightforward.</p>
<h3>\s-1RTF\s0 Conclusion</h3>
<p>To conclude your document, you should emit a \*(L"}\*(R", and then close the file. That closebrace closes the group that the first character of the file opened.  Presumably that's all the groups you have to close.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FORMATTING CODES</h2>
        <div class="sectioncontent">
<p>The following are references for: 1) Character Formatting, 2) Paragraph and Block-Level Formatting, 3) Document Formatting, and 4) Characters, Escapes, and Character Commands</p><h3>Character Formatting</h3>
<p>  &#92;plain -- turn off all formatting   &#92;ul -- underline   &#92;b  -- bold   &#92;i  -- italic   &#92;sub   -- subscript   &#92;super -- superscript</p><p>  &#92;fN -- change to font #N (where that&apos;s the number of a font declared            in the fonttable in the prolog)   &#92;fsN -- set current font size to N half-points          e.g., &#92;fs30 = 15 point   &#92;scaps -- smallcaps   &#92;strike -- strikethru   &#92;v -- hidden text (For comments?)   &#92;langN -- language N               US English: 1033    MX Spanish: 2058     French: 1036               Turkish: 1055       No language: 1024   &#92;noproof -- disable spellchecking here  (not known to older RTF readers)</p><p>  {&#92;super&#92;chftn}{&#92;footnote&#92;pard&#92;plain&#92;chftn. Foo!}     -- set an autonumbered footnote of "Foo!" hanging off of the current        point in the text</p><p>  {&#92;field{&#92;*&#92;fldinst{HYPERLINK "http://www.suck.com/"}}{&#92;fldrslt{&#92;ul   stuff   }}}     -- make "stuff" a link to http://www.suck.com/</p><p>  &#92;cfN -- select foreground color #N (from color table)   &#92;cbN -- select background color #N (from color table)</p>
<h3>Paragraph and Block-Level Formatting</h3>
<p>  &#92;page -- pagebreak   &#92;line -- newline (not a real paragraph break)   &#92;tab  -- tab (better than using a literal tab character)   &#92;par  -- End this paragraph, and start a new one, inheriting paragraph            properties from the previous one.            (Note that &#92;par means END-paragraph, but if you treat it as it             if means start-paragraph, you won&apos;t break too many things.)   &#92;par&#92;pard -- End previous paragraph, and start a new one that doesn&apos;t                inherit paragraph properties from the previous one.            (The &#92;par ends the previous paragraph, the &#92;pard resets             the new paragraph&apos;s formatting attributes.)</p><p>  &#92;ql -- left (i.e., no) justification   &#92;qr -- right-justify (i.e., align right)   &#92;qj -- full-justify (i.e., smooth margins on both sides)   &#92;qc -- center</p><p>  &#92;liN -- left-indent this whole paragraph by N twips (default: 0)   &#92;riN -- right-indent this whole paragraph by N twips (default: 0)   &#92;fiN -- first-line left-indent this paragraph by N twips (default: 0)     (Note that this indenting is relative to the margin set by &#92;liN!)     (Note also that the above can have negative values.      E.g., &#92;fi-120 backdents (to the left!) the first line by      120 twips from the paragraph&apos;s left margin.)</p><p>  &#92;sbN -- N twips of extra (vertical) space before this paragraph (default: 0)   &#92;saN -- N twips of extra (vertical) space after this paragraph (default: 0)</p><p>  &#92;pagebb -- pagebreak before this paragraph   &#92;keep -- don&apos;t split up this paragraph (i.e., across pages)   &#92;keepn -- don&apos;t split up this paragraph from the next one   &#92;widctlpar -- widow-and-orphans control for this paragraph                (antonym: &#92;nowidctlpar)</p><p>  {&#92;header&#92;pard&#92;qr&#92;plain&#92;f0&#92;chpgn&#92;par}     -- turn on page numbering.  Lasts until next &#92;sect&#92;sectd.</p><p>  &#92;colsN -- N newspaper-columns per page.  Lasts until next &#92;sect&#92;sectd.   &#92;linebetcol -- show lines between columns.</p><p>  &#92;sect&#92;sectd -- new section.  (Resets header and columnation.)</p>
<h3>Document Formatting</h3>
<p>If you emit these, do it right after the prolog:</p><p>  &#92;ftnbj&#92;ftnrestart -- initialize footnote numbering   &#92;deflangN -- set the document&apos;s default language to N.                    (See &#92;languageN, above)   &#92;widowctrl -- turn on widows-and-orphans control for the document   &#92;hyphcaps  -- allow hyphenation of capitalized words (&#92;hyphcaps0 turns off)   &#92;hyphauto  -- automatic hyphenation (&#92;hyphauto0 turns off)   &#92;pgnstartN -- for page numbering, set first page to N   &#92;marglN -- set left page-margin to N twips (default: 1800)   &#92;margrN -- set right page-margin to N twips (default: 1800)   &#92;margtN -- set top page-margin to N twips (default: 1440)   &#92;margbN -- set top page-margin to N twips (default: 1440)   &#92;landscape -- document is in landscape format      (i.e., it&apos;s sideways on the page)</p>
<h3>Characters, Escapes, and Character Commands</h3>
<p>  [return] -- ignored (unless preceded by an escaping backslash)   [linefeed] -- ignored (unless preceded by an escaping backslash)   [space] -- a space (yes, space and tabs ARE significant whitespace)   [tab] -- a tab to the next tab stop.  Use the command &#92;tab instead, or             consider expanding tabs to spaces.             (Setting tab stops is not covered in this document.)   &#92;&apos;XX  -- character with hex code XX (e.g., &#92;&apos;BB is character 187)   &#92;&#92; -- a backslash   (same as &#92;&apos;5c)   &#92;{ -- an open-brace (same as &#92;&apos;7b)   &#92;} -- a close-brace (same as &#92;&apos;7d)   &#92;~ -- non-breaking space   &#92;- -- optional hyphen (!)   &#92;_ -- non-breaking hyphen</p><p>Remember that all of the following, unlike the above, are commands; and so you can't say, for example, \*(L"&#92;bulleta\*(R" to get a bullet and then an \*(L"a\*(R".  Instead, you'd need to have: \*(L"&#92;bullet a\*(R".  Or \*(L"&#92;bullet\*(R", a newline, and \*(L"a\*(R".</p><p>  &#92;bullet -- bullet character (same as Latin-1 character 149)   &#92;endash -- n-width dash   &#92;emdash -- m-width dash   &#92;enspace -- n-width non-breaking space   &#92;emspace -- m-width non-breaking space   &#92;lquote -- single openquote (6)   &#92;rquote -- single closequote (9)   &#92;ldblquote -- double openquote (66)   &#92;rdblquote -- double closequote (66)</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SAMPLE COMPLETE RTF DOCUMENT</h2>
        <div class="sectioncontent">
<p>  {&#92;rtf1&#92;ansi&#92;deff0</p><p>  {&#92;fonttbl   {&#92;f0 Times New Roman;}   }</p><p>  &#92;deflang1033&#92;widowctrl   {&#92;header&#92;pard&#92;qr&#92;plain&#92;f0{&#92;noproof&#92;i La dame} p.&#92;chpgn&#92;par}</p><p>  &#92;lang1036&#92;fs36</p><p>  {&#92;pard&#92;qc&#92;f1&#92;fs60&#92;b&#92;i La dame&#92;par}</p><p>  {&#92;pard&#92;sb300&#92;li900   Toc toc Il a ferm&#92;&apos;e9 la porte&#92;line   Les lys du jardin sont fl&#92;&apos;e9tris&#92;line   Quel est donc ce mort qu&apos;on emporte   &#92;par}</p><p>  {&#92;pard&#92;sb300&#92;li900   Tu viens de toquer &#92;&apos;e0 sa porte&#92;line      Et trotte trotte&#92;line      Trotte la petite souris   &#92;par}</p><p>  {&#92;pard&#92;sb900&#92;li900&#92;scaps&#92;fs44   &#92;endash  Guillaume Apollinaire, {&#92;i Alcools}&#92;par}</p><p>  &#92;page&#92;lang1033&#92;fs32   {&#92;pard&#92;b&#92;ul&#92;fs40 Vocabulary&#92;par}   {&#92;pard&#92;li300&#92;fi-150{&#92;noproof&#92;b toc }{&#92;i(n.m.)} &#92;endash  tap; knock&#92;par}   {&#92;pard&#92;li300&#92;fi-150{&#92;noproof&#92;b lys }{&#92;i(n.m.)} &#92;endash  lily&#92;par}   {&#92;pard&#92;li300&#92;fi-150{&#92;noproof&#92;b fl&#92;&apos;e9trir }   {&#92;i(v.itr.)} &#92;endash  to wilt; for a flower or beauty to fade;    for a plant to wither&#92;par}   {&#92;pard&#92;li300&#92;fi-150{&#92;noproof&#92;b mort }   {&#92;i(adj., here used as a masc. noun)} &#92;endash  dead&#92;par}   {&#92;pard&#92;li300&#92;fi-150{&#92;noproof&#92;b emporter }   {&#92;i(v.tr.)} &#92;endash  to take a person or thing [somewhere];    to take&#92;~[out/away/etc.] or carry&#92;~[away] a thing&#92;par}   {&#92;pard&#92;li300&#92;fi-150{&#92;noproof&#92;b toquer }   {&#92;i(v.itr.)} &#92;endash  to tap; to knock&#92;par}   {&#92;pard&#92;li300&#92;fi-150{&#92;noproof&#92;b trotter }   {&#92;i(v.itr.)} &#92;endash  to trot; to scurry&#92;par}   {&#92;pard&#92;li300&#92;fi-150{&#92;noproof&#92;b souris }{&#92;i(n.f.)} &#92;endash  mouse&#92;par}</p><p>  {&#92;pard&#92;sb200&#92;b&#92;ul&#92;fs40 Free Translation&#92;par}   {&#92;pard   Click click He closed the door / Garden lilies faded / Which body is today    // You just tapped on the door / And tip toe / Taps the little mouse   &#92;line  &#92;_Translation Sean M. Burke, 2001   &#92;par}   }</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>* This document does not discuss the \s-1RTF\s0 commands specific to the MSWin .HLP compiler.</p><p>* There may be slight differences in how the same \s-1RTF\s0 is interpreted by different word processors.  For example, wordpad understands only a subset of \s-1RTF\s0.  Also, the last version of WordPerfect that I dealt with (8.0) would occasionally apply margin-changing codes to more paragraphs than the \s-1RTF\s0 actually said to.  The most \*(L"reliable\*(R" rendering of \s-1RTF\s0 is generally what you get from MSWord, since \s-1RTF\s0 is after all (as far as I can tell), a direct recapitulation of the MSWord's internal representation of documents.</p><p>* In this document, I don't cover embedding graphics in \s-1RTF\s0, because it's a big old mess.</p><p>* A hint: if you're writing a program that generates \s-1RTF\s0, and it runs happily, but the generated document crashes your word processor, then make sure you've got as many {'s as }'s.  If you represent literal openbrace and closebrace as &#92;'7b and &#92;'7d, then all \*(L"{\*(R"s in your \s-1RTF\s0 code will be group-openers, all \*(L"}\*(R"s in \s-1RTF\s0 code will be group-closers, and there should be equal numbers of them.  (They should also nest properly, but most errors are detectable thru unequal numbers of braces.)</p><p>This bit of Perl code can be used to check a given file for matching {'s and }'s:</p><p>  # Assuming all that literal {&apos;s are encoded as &#92;&apos;7b   #  that all literal }&apos;s are encoded as &#92;&apos;7d   $/ = &apos;}&apos;;   use strict;   my $stack = &apos;&apos;;   my $open_count = my $close_count = 0;   while(&lt;&gt;) {     tr/{}//cd;     $open_count  += tr/{//;     $close_count += tr/}//;     while( s/{}//g ) {1};     $stack .= $_;   }   while( $stack =~ s/{}//g ) {1}   print "$open_count x {&#92;n$close_count x }&#92;n",     length($stack) ? "Unbalanced.&#92;n" : "Balanced.&#92;n";</p><p>Altho note that this fails to trap the case where you close the document's top-level group and then open another (which you shouldn't do).</p><p>* I don't cover making tables here, because they're rather hard to do; because they're not really isomorphic with \s-1HTML\s0 tables or TeX tables (just to name two models of tables that people know, and that are rather more sane than \s-1RTF\s0); and also because messing up the code for tables (as you are prone to do while experimenting with a writer-program) sometimes crashes MSWord!  However, if you need to make tables, you can mull over this code while referring to the murky explanation of tables in the \s-1RTF\s0 Spec:</p><p>  {&#92;pard Hmmm &#92;par}   {&#92;pard   &#92;trowd&#92;trgaph300&#92;trleft400&#92;cellx1500&#92;cellx3000&#92;cellx4500   &#92;pard&#92;intbl Wun. Doo wah ditty ditty dum ditty do &#92;cell   &#92;pard&#92;intbl Too. Doo wah ditty ditty dum ditty do &#92;cell   &#92;pard&#92;intbl Chree. Doo wah ditty ditty dum ditty do &#92;cell   &#92;row   &#92;trowd&#92;trgaph300&#92;trleft400&#92;cellx1500&#92;cellx3000&#92;cellx4500   &#92;pard&#92;intbl Foh. Doo wah ditty ditty dum ditty do &#92;cell   &#92;pard&#92;intbl Fahv. Doo wah ditty ditty dum ditty do &#92;cell   &#92;pard&#92;intbl Saxe. Doo wah ditty ditty dum ditty do &#92;cell   &#92;row   &#92;trowd&#92;trgaph300&#92;trleft400&#92;cellx1500&#92;cellx3500   &#92;pard&#92;intbl Saven. Doo wah ditty ditty dum ditty do &#92;cell   &#92;pard&#92;intbl Ight. Doo wah ditty ditty dum ditty do &#92;cell   &#92;row   }   {&#92;pard I LIKE PIE}</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT AND DISCLAIMER</h2>
        <div class="sectioncontent">
<p>Copyright 2001,2,3 Sean M. Burke.</p><p>This document is not in the public domain, but you can redistribute this document and/or modify it under the same terms as Perl itself, as explained in the Perl Artistic License.</p><p>This document is distributed in the hope that it will be useful, but without any warranty; without even the implied warranty of accuracy, merchantability, or fitness for a particular purpose.</p><p>The author of this document is not affiliated with the Microsoft corporation.</p><p>Product and company names mentioned in this document may be the trademarks or service marks of their respective owners.  Trademarks and service marks are not identified, although this must not be construed as the author's expression of validity or invalidity of each trademark or service mark.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Sean M. Burke, sburke@cpan.org</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="RT::Extension::JSGantt.3pm.html"><span aria-hidden="true">&larr;</span> RT::Extension::JSGantt.3pm: Gantt charts for your tickets</a></li>
   <li class="next"><a href="RTF::Document.3pm.html">RTF::Document.3pm: Perl extension for generating rich text (rtf) files <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
