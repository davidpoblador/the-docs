<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FreezeThaw: Converting perl structures to strings and back.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Converting perl structures to strings and back.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="FreezeThaw (3pm) manual">
  <meta name="twitter:description" content="Converting perl structures to strings and back.">
  <meta name="twitter:image" content="https://www.carta.tech/images/libfreezethaw-perl-FreezeThaw-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/FreezeThaw.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="FreezeThaw (3pm) manual" />
  <meta property="og:description" content="Converting perl structures to strings and back." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libfreezethaw-perl-FreezeThaw-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">FreezeThaw<small> (3pm)</small></h1>
        <p class="lead">Converting perl structures to strings and back.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/FreezeThaw.3pm.html">
      <span itemprop="name">FreezeThaw: Converting perl structures to strings and back.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libfreezethaw-perl/">
      <span itemprop="name">libfreezethaw-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/FreezeThaw.3pm.html">
      <span itemprop="name">FreezeThaw: Converting perl structures to strings and back.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use FreezeThaw qw(freeze thaw cmpStr safeFreeze cmpStrHard);
  $string = freeze $data1, $data2, $data3;
  ...
  ($olddata1, $olddata2, $olddata3) = thaw $string;
  if (cmpStr($olddata2,$data2) == 0) {print "OK!"}
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Converts data to/from stringified form, appropriate for saving-to/reading-from permanent storage.</p><p>Deals with objects, circular lists, repeated appearance of the same reference. Does not deal with overloaded <em>stringify</em> operator yet.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXPORT</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    Default
  </dt>
  <dd>
    <p>None.</p>
  </dd>
  <dt>
    Exportable
  </dt>
  <dd>
    <p>\*(C`freeze thaw cmpStr cmpStrHard safeFreeze\*(C'.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">User API</h2>
        <div class="sectioncontent">
<p>analogue of \*(C`cmp\*(C' for data. Takes two arguments and compares them as separate entities. analogue of \*(C`cmp\*(C' for data. Takes two arguments and compares them considered as a group. returns a string that encupsulates its arguments (considered as a group). \*(C`thaw\*(C'ing this string leads to a fatal error if arguments to \*(C`freeze\*(C' contained references to \*(C`GLOB\*(C's and \*(C`CODE\*(C's. returns a string that encupsulates its arguments (considered as a group). The result is \*(C`thaw\*(C'able in the same process. \*(C`thaw\*(C'ing the result in a different process should result in a fatal error if arguments to \*(C`safeFreeze\*(C' contained references to \*(C`GLOB\*(C's and \*(C`CODE\*(C's. takes one string argument and returns an array. The elements of the array are \*(L"equivalent\*(R" to arguments of the \*(C`freeze\*(C' command that created the string. Can result in a fatal error (see above).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Developer API</h2>
        <div class="sectioncontent">
<p>\*(C`FreezeThaw\*(C' \*(C`freeze\*(C's and \*(C`thaw\*(C's data blessed in some package by calling methods \*(C`Freeze\*(C' and \*(C`Thaw\*(C' in the package. The fallback methods are provided by the \*(C`FreezeThaw\*(C' itself. The fallback \*(C`Freeze\*(C' freezes the \*(L"content\*(R" of blessed object (from Perl point of view). The fallback \*(C`Thaw\*(C' blesses the \*(C`thaw\*(C'ed data back into the package.</p><p>So the package needs to define its own methods only if the fallback methods will fail (for example, for a lot of data the \*(L"content\*(R" of an object is an address of some <strong>C</strong> data). The methods are called like</p><p>  $newcooky = $obj-&gt;Freeze($cooky);   $obj = Package-&gt;Thaw($content,$cooky);</p><p>To save and restore the data the following method are applicable:</p><p>  $cooky-&gt;FreezeScalar($data,$ignorePackage,$noduplicate);</p><p>during <em>Freeze()</em>ing, and</p><p>  $data = $cooky-&gt;ThawScalar;</p><p>Two optional arguments $ignorePackage and $noduplicate regulate whether the freezing should not call the methods even if $data is a reference to a blessed object, and whether the data should not be marked as seen already even if it was seen before. The default methods</p><p>  sub UNIVERSAL::Freeze {     my ($obj, $cooky) = (shift, shift);     $cooky-&gt;FreezeScalar($obj,1,1);   }</p><p>  sub UNIVERSAL::Thaw {     my ($package, $cooky) = (shift, shift);     my $obj = $cooky-&gt;ThawScalar;     bless $obj, $package;   }</p><p>call the \*(C`FreezeScalar\*(C' method of the $cooky since the freezing engine will see the data the second time during this call. Indeed, it is the freezing engine who calls <em>UNIVERSAL::Freeze()</em>, and it calls it because it needs to freeze $obj. The above call to $cooky-&gt;<em>FreezeScalar()</em> handles the same data back to engine, but because flags are different, the code does not cycle.</p><p>Freezing and thawing $cooky also allows the following additional methods:</p><p>  $cooky-&gt;isSafe;</p><p>to find out whether the current freeze was initiated by \*(C`freeze\*(C' or \*(C`safeFreeze\*(C' command. Analogous method for thaw $cooky returns whether the current thaw operation is considered safe (i.e., either does not contain cached elsewhere data, or comes from the same application). You can use</p><p>  $cooky-&gt;makeSafe;</p><p>to prohibit cached data for the duration of the rest of freezing or thawing of current object.</p><p>Two methods</p><p>  $value = $cooky-&gt;repeatedOK;   $cooky-&gt;noRepeated;           # Now repeated are prohibited</p><p>allow to find out/change the current setting for allowing repeated references.</p><p>If you want to flush the cache of saved objects you can use</p><p>  FreezeThaw-&gt;flushCache;</p><p>this can invalidate some frozen string, so that thawing them will result in fatal error.</p><h3>Instantiating</h3>
<p>Sometimes, when an object from a package is recreated in presense of repeated references, it is not safe to recreate the internal structure of an object in one step. In such a situation recreation of an object is carried out in two steps: in the first the object is \*(C`allocate\*(C'd, in the second it is \*(C`instantiate\*(C'd.</p><p>The restriction is that during the <em>allocation</em> step you cannot use any reference to any Perl object that can be referenced from any other place. This restriction is applied since that object may not exist yet.</p><p>Correspondingly, during <em>instantiation</em> step the previosly <em>allocated</em> object should be \*(C`filled\*(C', i.e., it can be changed in any way such that the references to this object remain valid.</p><p>The methods are called like this:</p><p>  $pre_object_ref = Package-&gt;Allocate($pre_pre_object_ref);         # Returns reference   Package-&gt;Instantiate($pre_object_ref,$cooky);         # Converts into reference to blessed object</p><p>The reverse operations are</p><p>  $object_ref-&gt;FreezeEmpty($cooky);   $object_ref-&gt;FreezeInstance($cooky);</p><p>during these calls object can \*(C`freezeScalar\*(C' some information (in a usual way) that will be used during \*(C`Allocate\*(C' and \*(C`Instantiate\*(C' calls (via \*(C`thawScalar\*(C'). Note that the return value of \*(C`FreezeEmpty\*(C' is cached during the phase of creation of uninialized objects. This <strong>must</strong> be used like this: the return value is the reference to the created object, so it is not destructed until other objects are created, thus the frozen values of the different objects will not share the same references. Example of bad result:</p><p>  $o1-&gt;FreezeEmpty($cooky)</p><p>freezes \*(C`{}\*(C', and \*(C`$o2-&gt;FreezeEmpty($cooky)\*(C' makes the same. Now nobody guaranties that that these two copies of \*(C`{}\*(C' are different, unless a reference to the first one is preserved during the call to \*(C`$o2-&gt;FreezeEmpty($cooky)\*(C'. If \*(C`$o1-&gt;FreezeEmpty($cooky)\*(C' returns the value of \*(C`{}\*(C' it uses, it will be preserved by the engine.</p><p>The helper function \*(C`FreezeThaw::copyContents\*(C' is provided for simplification of instantiation. The syntax is</p><p>  FreezeThaw::copyContents $to, $from;</p><p>The function copies contents the object $from point to into what the object $to points to (including package for blessed references). Both arguments should be references.</p><p>The default methods are provided. They do the following: Freezes an <em>empty</em> object of underlying type. Calls \*(C`Freeze\*(C'. Thaws what was frozen by \*(C`FreezeEmpty\*(C'. Thaws what was frozen by \*(C`FreezeInstance\*(C', uses \*(C`copyContents\*(C' to transfer this to the $pre_object.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS and LIMITATIONS</h2>
        <div class="sectioncontent">
<p>A lot of objects are blessed in some obscure packages by \s-1XSUB\s0 typemaps. It is not clear how to (automatically) prevent the \*(C`UNIVERSAL\*(C' methods to be called for objects in these packages.</p><p>The objects which can survive <em>freeze()</em>/<em>thaw()</em> cycle must also survive a change of a \*(L"member\*(R" to an equal member.  Say, after</p><p>  $a = [a =&gt; 3];   $a-&gt;{b} = &#92; $a-&gt;{a};</p><p>$a satisfies</p><p>  $a-&gt;{b} == &#92; $a-&gt;{a}</p><p>This property will be broken by <em>freeze()</em>/<em>thaw()</em>, but it is also broken by</p><p>  $a-&gt;{a} = delete $a-&gt;{a};</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Fortune.3pm.html"><span aria-hidden="true">&larr;</span> Fortune.3pm: Read and write fortune (strfile) databases</a></li>
   <li class="next"><a href="Frontier::Client.3pm.html">Frontier::Client.3pm: Issue frontier xml rpc requests to a server <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
