<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CGI::ValidOp::Check: Base class for cgi::validop checks</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Base class for cgi::validop checks">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="CGI::ValidOp::Check (3pm) manual">
  <meta name="twitter:description" content="Base class for cgi::validop checks">
  <meta name="twitter:image" content="https://www.carta.tech/images/libcgi-validop-perl-CGI::ValidOp::Check-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/CGI::ValidOp::Check.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="CGI::ValidOp::Check (3pm) manual" />
  <meta property="og:description" content="Base class for cgi::validop checks" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libcgi-validop-perl-CGI::ValidOp::Check-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">CGI::ValidOp::Check<small> (3pm)</small></h1>
        <p class="lead">Base class for cgi::validop checks</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/CGI::ValidOp::Check.3pm.html">
      <span itemprop="name">CGI::ValidOp::Check: Base class for cgi::validop checks</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libcgi-validop-perl/">
      <span itemprop="name">libcgi-validop-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/CGI::ValidOp::Check.3pm.html">
      <span itemprop="name">CGI::ValidOp::Check: Base class for cgi::validop checks</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    package CGI::ValidOp::Check::demo;
    use base qw/ CGI::ValidOp::Check /;

    sub default {
        (
            qr/^demo$/,                  # validator
            &apos;$label must equal "demo."&apos;, # error message
        )
    }

    sub color {
        my $self = shift;
        (
            sub {
                my( $value, $color ) = @_;
                $self-&gt;pass( $1 ) if $value =~ /^($color)$/i;
                $self-&gt;fail( "&#92;$label must be the color: $color." );
            },
        )
    }
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>CGI::ValidOp::Check contains all the code to validate data from CGI::ValidOp::Param objects, and enables simple creation your own checks.  Unless you're creating or testing your own checks, you should use and read the documentation for CGI::ValidOp instead.</p><h3>How checks are used</h3>
<p>Each check module must contain at least one check, and can contain as many as you care to create.  This document walks through the creation of one module containing mutliple checks.  Some of ValidOp's default checks are organized by types of data (e.g. 'text', 'number'), but there's nothing to say you must also do this.  You may find it convenient to package all the checks for one project in a single module.</p><p>Your check can be used in three ways.  The first is with a simple scalar corresponding to the module name:</p><p>    $validop-&gt;param( &apos;price&apos;, [ &apos;mychecks&apos; ]);</p><p>The second is by calling a particular check within the package:</p><p>    $validop-&gt;param( &apos;price&apos;, [ &apos;mychecks::robot&apos; ]);</p><p>The third is by passing parameters to either the module or a check:</p><p>    $validop-&gt;param( &apos;price&apos;, [ &apos;mychecks(3,6)&apos; ]);     $validop-&gt;param( &apos;price&apos;, [ &apos;mychecks::robot("Robbie")&apos; ]);</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>Unless you're creating or testing your own checks, this reference is not likely to help you.  You can use ValidOp's public \s-1API\s0 without knowing a thing about ValidOp::Check's internals.</p><h3>\fIparams()\fP</h3>
<p>The 'params' method returns a list passed to the check by the user:</p><p>    $validop-&gt;param( &apos;price&apos;, [ &apos;mychecks(3,6)&apos; ]);</p><p>These parameters are captured by splitting the contents of the parenthesis on commas.  The resulting list is made available with the 'params' method. Sets or returns the validator. Sets or returns the error message.  When CGI::ValidOp::Param parses these error messages, it replaces every isntance of $label with the parameter's 'label' property or, if that does not exist, with the parameter's 'name'. <em>check()</em> runs its calling object's validator against the incoming tainted value.  It returns the resulting value on success, or \*(C`undef\*(C' on failure.  <em>check()</em> itself does very little work; it finds what type of validator it has (regex and coderef are the only types currently allowed) and farms out the work to the appropriate method. <em>check_regexp()</em> captures the result of matching $tainted against $validator, using code similar to this:</p><p>    $tainted =~ /($validator)/;     return $1;</p><p>Note that the return value is untainted.  Also note that the code does <strong>not</strong> anchor the regular expression with ^ (at the beginning) or $ (at the end).  In other words, if you used this quoted regex as a check:</p><p>    qr/demo/</p><p>any string containing \*(L"demo\*(R" (e.g. \*(L"demographics,\*(R" \*(L"modemophobia\*(R") would pass.  This may or may not be what you intend. <em>check_code()</em> passes $tainted to the anonymous subroutine referenced by $validator and returns the result.  The two most notable differences from regex checks are that the value of <em>params()</em> is passed into the validator subroutine and that the entire thing croaks if the return value is tainted.</p><p>ValidOp's default behavior is to die like a dog if your coderef returns a tainted value.  This safe default can be changed by returning a third list item from your check subroutine, a hashref of additional properties:</p><p>    sub should_allow_tainted {(         sub { $_[ 0 ] },         &apos;This should be an error message&apos;,         { allow_tainted =&gt; 1, }     )}</p>
<h3>is_tainted</h3>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CREATING A CHECK MODULE</h2>
        <div class="sectioncontent">
<h3>Starting a check module</h3>
<p>For the moment, your check module must be in the CGI::ValidOp::Check namespace; future versions will allow more flexibility.  The module must be in Perl's search path.</p><p>    package CGI::ValidOp::Check::demo;</p><p>You must subclass CGI::ValidOp::Check for your module.  It contains methods that the rest of the code uses to perform the validation.</p><p>    use base qw/ CGI::ValidOp::Check /;</p>
<h3>Creating checks</h3>
<p>Each check is completely defined by a single subroutine.  If you define only one check in your module, it should be called 'default'.  Using only the module name as a check, the 'default' subroutine is called.  There's nothing to stop you calling your single check something else, but it does mean less intuitive use.</p><p>Checks return one to three scalar values.  The first value is the check itself, and is required.  The second value is an optional error message.  The third is an optional list of additional properties, defined for the check and made available as methods.</p><p>    sub check_name {         ( $check, $errmsg, &#92;%options )     }</p>
<h3>Types of checks</h3>
<p><em>Quoted regular expression</em></p><p>The simplest checks are quoted regular expressions.  These are perfect for relatively static data.  This one checks that the incoming value is \*(L"demo\*(R" and sets a custom error message.  Any instance of '$label' in an error message is substituted with the parameter's 'label' property, if you define one, or the parameter's 'name' property (which is required and thus guaranteed to exist).</p><p>    sub default {         (             qr/^demo$/,                  # validator             &apos;$label must equal "demo."&apos;, # error message         )     }</p><p>Parameters are validated against Regex checks with the check_regexp method.</p><p>You cannot pass parameters to a regex check (more to the point you can, but they'll be ignored).</p><p><em>Subroutine reference</em></p><p>These checks can be much more powerful and flexible, but require a little extra work.</p><p>    sub color {         my $self = shift;         (             sub {                 my( $value, $color ) = @_;                 return $1 if $value =~ /^($color)$/i;                 $self-&gt;errmsg( "&#92;$label must be the color: $color." );                 return;             },         )     }</p><p>You'll note that the check only returns one item, an anonymous subroutine.  This coderef sets the check's error message with the 'errmsg' method, allowing it to pass incoming parameters into the error message.  (You could supply an error message here as the second array element, but it would be overridden.)</p><p>Parameters are validated against coderef checks with the check_code method:</p><p>Right now the only additional property available ValidOp checks is 'allow_tainted.'  ValidOp's stock 'length' check uses this, reasoning that just knowing the length of an incoming value isn't reason enough to trust it.</p><p>    package Main;</p><p>    my $demo = CGI::ValidOp::Check::demo-&gt;new;     is( $demo-&gt;check( &apos;failure&apos; ), undef );     is( $demo-&gt;check( &apos;demo&apos; ), &apos;demo&apos; );         my $value = $demo-&gt;check( &apos;demo&apos; );     ok( ! $demo-&gt;is_tainted( $value ));</p><p>    my $demo_color = CGI::ValidOp::Check::demo-&gt;new( &apos;color&apos;, &apos;red&apos; );     is( $demo_color-&gt;check( &apos;green&apos; ), undef );     is( $demo_color-&gt;errmsg, &apos;$label must be the color: red.&apos; );     is( $demo_color-&gt;check( &apos;red&apos; ), &apos;red&apos; );</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Randall Hansen &lt;legless@cpan.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (c) 2003-2005 Randall Hansen. All rights reserved.</p><p>This program is free software; you may redistribute it and/or modify it under the same terms as Perl itself.</p><p>See http://www.perl.com/perl/misc/Artistic.html</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="CGI::ValidOp::Base.3pm.html"><span aria-hidden="true">&larr;</span> CGI::ValidOp::Base.3pm: Base class for cgi::validop and its associates.</a></li>
   <li class="next"><a href="CGI::ValidOp::Check::checkbox.3pm.html">CGI::ValidOp::Check::checkbox.3pm: Cgi::validop::check module to validate a checkbox control. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
