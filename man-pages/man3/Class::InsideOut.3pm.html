<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Class::InsideOut: A safe, simple inside-out object construction kit</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A safe, simple inside-out object construction kit">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Class::InsideOut (3pm) manual">
  <meta name="twitter:description" content="A safe, simple inside-out object construction kit">
  <meta name="twitter:image" content="https://www.carta.tech/images/libclass-insideout-perl-Class::InsideOut-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Class::InsideOut.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Class::InsideOut (3pm) manual" />
  <meta property="og:description" content="A safe, simple inside-out object construction kit" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libclass-insideout-perl-Class::InsideOut-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Class::InsideOut<small> (3pm)</small></h1>
        <p class="lead">A safe, simple inside-out object construction kit</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Class::InsideOut.3pm.html">
      <span itemprop="name">Class::InsideOut: A safe, simple inside-out object construction kit</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libclass-insideout-perl/">
      <span itemprop="name">libclass-insideout-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Class::InsideOut.3pm.html">
      <span itemprop="name">Class::InsideOut: A safe, simple inside-out object construction kit</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>version 1.13</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  package My::Class;

  use Class::InsideOut qw( public readonly private register id );

  public     name =&gt; my %name;    # accessor: name()
  readonly   ssn  =&gt; my %ssn;     # read-only accessor: ssn()
  private    age  =&gt; my %age;     # no accessor

  sub new { register( shift ) }

  sub greeting {
    my $self = shift;
    return "Hello, my name is $name{ id $self }";
  }
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This is a simple, safe and streamlined toolkit for building inside-out objects. Unlike most other inside-out object building modules already on \s-1CPAN\s0, this module aims for minimalism and robustness:</p><ul>
<li><p>Does not require derived classes to subclass it</p></li><li><p>Uses no source filters, attributes or \*(C`CHECK\*(C' blocks</p></li><li><p>Supports any underlying object type including black-box inheritance</p></li><li><p>Does not leak memory on object destruction</p></li><li><p>Overloading-safe</p></li><li><p>Thread-safe for Perl 5.8.5 or better</p></li><li><p>\*(C`mod_perl\*(C' compatible</p></li><li><p>Makes no assumption about inheritance or initializer needs</p></li>
</ul><p>It provides the minimal support necessary for creating safe inside-out objects and generating flexible accessors.</p><h3>Additional documentation</h3>
<ul>
<li><p>Class::InsideOut::Manual::About \*(-- Guide to the inside-out technique, the \*(C`Class::InsideOut\*(C' philosophy, and other inside-out implementations</p></li><li><p>Class::InsideOut::Manual::Advanced \*(-- Advanced topics including customizing accessors, black-box inheritance, serialization and thread safety</p></li>
</ul>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE</h2>
        <div class="sectioncontent">
<p>\*(C`Class::InsideOut\*(C' automatically imports several critical methods into the calling package, including \*(C`DESTROY\*(C' and support methods for serializing objects with \*(C`Storable\*(C'.  These methods are intimately tied to correct functioning of inside-out objects and will always be imported regardless of whether additional functions are requested.</p><p>Additional functions may be imported as usual by including them as arguments to \*(C`use\*(C'.  For example:</p><p>  use Class::InsideOut qw( register public );</p><p>  public name =&gt; my %name;</p><p>  sub new { register( shift ) }</p><p>As a shortcut, \*(C`Class::InsideOut\*(C' supports two tags for importing sets of functions:</p><ul>
<li><p>\*(C`:std\*(C' provides \*(C`id\*(C', \*(C`private\*(C', \*(C`public\*(C', \*(C`readonly\*(C' and \*(C`register\*(C'</p></li><li><p>\*(C`:all\*(C' imports all functions (including an optional constructor)</p></li>
</ul><p><strong>Note</strong>: Automatic imports can be bypassed via \*(C`require\*(C' or by passing an empty list to \*(C`use Class::InsideOut\*(C'. There is almost no circumstance in which this is a good idea.</p><h3>Object properties and accessors</h3>
<p>Object properties are declared with the \*(C`public\*(C', \*(C`readonly\*(C' and \*(C`private\*(C' functions.  They must be passed a label and the lexical hash that will be used to store object properties:</p><p>  public   name =&gt; my %name;   readonly ssn  =&gt; my %ssn;   private  age  =&gt; my %age;</p><p>Properties for an object are accessed through an index into the lexical hash based on the memory address of the object.  This memory address <em>must</em> be obtained via \*(C`Scalar::Util::refaddr\*(C'.  The alias \*(C`id\*(C' may be imported for brevity.</p><p>  $name{ refaddr $self } = "James";   $ssn { id      $self } = 123456789;   $age { id      $self } = 32;</p><p><strong>Tip</strong>: since \*(C`refaddr\*(C' and \*(C`id\*(C' are function calls, it may be efficient to store the value once at the beginning of a method, particularly if it is being called repeatedly, e.g. within a loop.</p><p>Object properties declared with \*(C`public\*(C' will have an accessor created with the same name as the label.  If the accessor is passed an argument, the property will be set to the argument.  The accessor always returns the value of the property.</p><p>  # Outside the class   $person = My::Class-&gt;new;   $person-&gt;name( "Larry" );</p><p>Object properties declared with \*(C`readonly\*(C' will have a read-only accessor created.  The accessor will die if passed an argument to set the property value.  The property may be set directly in the hash from within the class package as usual.</p><p>  # Inside the class   $ssn { id $person } = 987654321;</p><p>  # Inside or outside the class   $person-&gt;ssn( 123456789 );      # dies</p><p>Property accessors may also be hand-written by declaring the property \*(C`private\*(C' and writing whatever style of accessor is desired.  For example:</p><p>  sub age     { $age{ id $_[0] } }   sub set_age { $age{ id $_[0] } = $_[1] }</p><p>Hand-written accessors will be very slightly faster as generated accessors hold a reference to the property hash rather than accessing the property hash directly.</p><p>It is also possible to use a package hash instead of a lexical hash to store object properties:</p><p>  public name =&gt; our %name;</p><p>However, this makes private object data accessible outside the class and incurs a slight performance penalty when accessing the property hash directly; it is not recommended to do this unless you really need it for some specialized reason.</p>
<h3>Object construction</h3>
<p>\*(C`Class::InsideOut\*(C' provides no default constructor method as there are many possible ways of constructing an inside-out object. This avoids constraining users to any particular object initialization or superclass initialization methodology.</p><p>By using the memory address of the object as the index for properties, <em>any</em> type of reference may be used as the basis for an inside-out object with \*(C`Class::InsideOut\*(C'.</p><p>  sub new {     my $class = shift;</p><p>    my $self = &#92;( my $scalar );    # anonymous scalar   # my $self = {};                 # anonymous hash   # my $self = [];                 # anonymous array   # open my $self, "&lt;", $filename; # filehandle reference</p><p>    bless $self, $class;     register( $self );   }</p><p>However, to ensure that the inside-out object is thread-safe, the \*(C`register\*(C' function <em>must</em> be called on the newly created object.  The \*(C`register\*(C' function may also be called with just the class name for the common case of blessing an anonymous scalar.</p><p>  register( $class ); # same as register( bless &#92;(my $s), $class )</p><p>As a convenience, \*(C`Class::InsideOut\*(C' provides an optional \*(C`new\*(C' constructor for simple objects.  This constructor automatically initializes the object from key/value pairs passed to the constructor for all keys matching the name of a property (including otherwise \*(L"private\*(R" or \*(L"readonly\*(R" properties).</p><p>A more advanced technique for object construction uses another object, usually a superclass object, as the object reference.  See \*(L"black-box inheritance\*(R" in Class::InsideOut::Manual::Advanced.</p>
<h3>Object destruction</h3>
<p>\*(C`Class::InsideOut\*(C' automatically exports a special \*(C`DESTROY\*(C' function. This function cleans up object property memory for all declared properties the class and for all \*(C`Class::InsideOut\*(C' based classes in the @ISA array to avoid memory leaks or data collision.</p><p>Additionally, if a user-supplied \*(C`DEMOLISH\*(C' function is available in the same package, it will be called with the object being destroyed as its argument. \*(C`DEMOLISH\*(C' can be used for custom destruction behavior such as updating class properties, closing sockets or closing database connections.  Object properties will not be deleted until after \*(C`DEMOLISH\*(C' returns.</p><p>  # Sample DEMOLISH: Count objects demolished (for whatever reason)</p><p>  my $objects_destroyed;</p><p>  sub DEMOLISH {     $objects_destroyed++;   }</p><p>\*(C`DEMOLISH\*(C' will only be called if it exists for an object's actual class.  \*(C`DEMOLISH\*(C' will not be inherited and \*(C`DEMOLISH\*(C' will not be called automatically for any superclasses.</p><p>\*(C`DEMOLISH\*(C' should manage any necessary calls to superclass \*(C`DEMOLISH\*(C' methods.  As with \*(C`new\*(C', implementation details are left to the user based on the user's approach to object inheritance.  Depending on how the inheritance chain is constructed and how \*(C`DEMOLISH\*(C' is being used, users may wish to entirely override superclass \*(C`DEMOLISH\*(C' methods, rely upon \*(C`SUPER::DEMOLISH\*(C', or may prefer to walk the entire @ISA tree:</p><p>  use Class::ISA;</p><p>  sub DEMOLISH {     my $self = shift;     # class specific demolish actions</p><p>    # DEMOLISH for all parent classes, but only once     my @parents = Class::ISA::super_path( _\|_PACKAGE_\|_ );     my %called;     for my $p ( @parents  ) {       my $demolish = $p-&gt;can(&apos;DEMOLISH&apos;);       $demolish-&gt;($self) if not $called{ $demolish }++;     }   }</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FUNCTIONS</h2>
        <div class="sectioncontent">
<p>  $name{ id $object } = "Larry";</p><p>This is a shorter, mnemonic alias for \*(C`Scalar::Util::refaddr\*(C'.  It returns the memory address of an object (just like \*(C`refaddr\*(C') as the index to access the properties of an inside-out object.   My::Class-&gt;new( name =&gt; "Larry", age =&gt; 42 );</p><p>This simplistic constructor is provided as a convenience and is only exported on request.  When called as a class method, it returns a blessed anonymous scalar.  Arguments will be used to initialize all matching inside-out class properties in the @ISA tree.  The argument may be a hash or hash reference.</p><p>Note: Properties are set directly, not via accessors.  This means \*(C`set_hook\*(C' functions will not be called.  For more robust argument checking, you will need to implement your own constructor.   Class::InsideOut::options( &#92;%new_options );   %current_options = Class::InsideOut::options();</p><p>The \*(C`options\*(C' function sets default options for use with all subsequent property definitions for the calling package.  If called without arguments, this function will return the options currently in effect.  When called with a hash reference of options, these will be joined with the existing defaults, overriding any options of the same name.   private weight =&gt; my %weight;   private haircolor =&gt; my %hair_color, { %options };</p><p>This is an alias to \*(C`property\*(C' that also sets the privacy option to 'private'. It will override default options or options passed as an argument.   property name =&gt; my %name;   property rank =&gt; my %rank, { %options };</p><p>Declares an inside-out property.  Two arguments are required and a third is optional.  The first is a label for the property; this label will be used for introspection and generating accessors and thus must be a valid perl identifier.  The second argument must be the lexical hash that will be used to store data for that property.  Note that the \*(C`my\*(C' keyword can be included as part of the argument rather than as a separate statement.  The property will be tracked for memory cleanup during object destruction and for proper thread-safety.</p><p>If a third, optional argument is provided, it must be a reference to a hash of options that will be applied to the property and will override any default options that have been set.   public height =&gt; my %height;   public age =&gt; my %age, { %options };</p><p>This is an alias to \*(C`property\*(C' that also sets the privacy option to 'public'. It will override default options or options passed as an argument.   readonly ssn =&gt; my %ssn;   readonly fingerprint =&gt; my %fingerprint, { %options };</p><p>This is an alias to \*(C`property\*(C' that sets the privacy option to 'public' and adds a \*(C`set_hook\*(C' option that dies if an attempt is made to use the accessor to change the property.  It will override default options or options passed as an argument.   register( bless( $object, $class ) ); # register the object   register( $reference, $class );       # automatic bless   register( $class );                   # automatic blessed scalar</p><p>Registers objects for thread-safety.  This should be called as part of a constructor on a object blessed into the current package.  Returns the resulting object.  When called with only a class name, \*(C`register\*(C' will bless an anonymous scalar reference into the given class.  When called with both a reference and a class name, \*(C`register\*(C' will bless the reference into the class.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>Options customize how properties are generated.  Options may be set as a default with the \*(C`options\*(C' function or passed as a hash reference to \*(C`public\*(C', \*(C`private\*(C' or \*(C`property\*(C'.</p><p>Valid options include:   property rank =&gt; my %rank, { privacy =&gt; &apos;public&apos; };   property serial =&gt; my %serial, { privacy =&gt; &apos;private&apos; };</p><p>If the <em>privacy</em> option is set to <em>public</em>, an accessor will be created with the same name as the label.  If the accessor is passed an argument, the property will be set to the argument.  The accessor always returns the value of the property.   public list =&gt; my %list, {       get_hook =&gt; sub { @$_ }   };</p><p>Defines an accessor hook for when values are retrieved.  $_ is locally aliased to the property value for the object.  <em>The return value of the hook is</em> passed through as the return value of the accessor. See \*(L"Customizing Accessors\*(R" in Class::InsideOut::Manual::Advanced for details.</p><p>The hook must be a coderef, including blessed coderefs and overloaded objects.   public age =&gt; my %age, {      set_hook =&gt; sub { /^&#92;d+$/ or die "must be an integer" }   };</p><p>Defines an accessor hook for when values are set. The hook subroutine receives the entire argument list.  $_ is locally aliased to the first argument for convenience.  The property receives the value of $_. See \*(L"Customizing Accessors\*(R" in Class::InsideOut::Manual::Advanced for details.</p><p>The hook must be a coderef, including blessed coderefs and overloaded objects.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Class::InsideOut&hellip;</h2>
        <div class="sectioncontent">
<p>Programmers seeking a more full-featured approach to inside-out objects are encouraged to explore Object::InsideOut.  Other implementations are also noted in Class::InsideOut::Manual::About.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">KNOWN LIMITATIONS</h2>
        <div class="sectioncontent">
<p>Requires weak reference support (Perl &gt;= 5.6) and <em>Scalar::Util::weaken()</em> to avoid memory leaks and to provide thread-safety.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ROADMAP</h2>
        <div class="sectioncontent">
<p>Features slated for after the 1.0 release include:</p><ul>
<li><p>Adding support for Data::Dump::Streamer serialization hooks</p></li><li><p>Adding additional accessor styles (e.g. <em>get_name()</em>/<em>set_name()</em>)</p></li><li><p>Further documentation revisions and clarification</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SUPPORT</h2>
        <div class="sectioncontent">
<h3>Bugs / Feature Requests</h3>
<p>Please report any bugs or feature requests through the issue tracker at https://github.com/dagolden/class-insideout/issues &lt;https://github.com/dagolden/class-insideout/issues&gt;. You will be notified automatically of any progress on your issue.</p>
<h3>Source Code</h3>
<p>This is open source software.  The code repository is available for public review and contribution under the terms of the license.</p><p>https://github.com/dagolden/class-insideout &lt;https://github.com/dagolden/class-insideout&gt;</p><p>  git clone git://github.com/dagolden/class-insideout.git</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>David Golden &lt;dagolden@cpan.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONTRIBUTORS</h2>
        <div class="sectioncontent">
<ul>
<li><p>Karen Etheridge &lt;ether@cpan.org&gt;</p></li><li><p>Toby Inkster &lt;tonyink@cpan.org&gt;</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT AND LICENSE</h2>
        <div class="sectioncontent">
<p>This software is Copyright (c) 2006 by David A. Golden.</p><p>This is free software, licensed under:</p><p>  The Apache License, Version 2.0, January 2004</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Class::Inner.3pm.html"><span aria-hidden="true">&larr;</span> Class::Inner.3pm: A perlish implementation of java like inner classes</a></li>
   <li class="next"><a href="Class::InsideOut::Manual::About.3pm.html">Class::InsideOut::Manual::About.3pm: Guide to this and other implementations of the inside-out technique <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
