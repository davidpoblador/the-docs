<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Test::Log4perl: Test log4perl</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Test log4perl">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Test::Log4perl (3pm) manual">
  <meta name="twitter:description" content="Test log4perl">
  <meta name="twitter:image" content="https://www.carta.tech/images/libtest-log4perl-perl-Test::Log4perl-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Test::Log4perl.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Test::Log4perl (3pm) manual" />
  <meta property="og:description" content="Test log4perl" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libtest-log4perl-perl-Test::Log4perl-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Test::Log4perl<small> (3pm)</small></h1>
        <p class="lead">Test log4perl</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Test::Log4perl.3pm.html">
      <span itemprop="name">Test::Log4perl: Test log4perl</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libtest-log4perl-perl/">
      <span itemprop="name">libtest-log4perl-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Test::Log4perl.3pm.html">
      <span itemprop="name">Test::Log4perl: Test log4perl</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use Test::More tests =&gt; 1;

  # setup l4p
  use Log::Log4Perl;
  # do your normal Log::Log4Perl setup here
  use Test::Log4perl;

  # get the loggers
  my $logger  = Log::Log4perl-&gt;get_logger("Foo::Bar");
  my $tlogger = Test::Log4perl-&gt;get_logger("Foo::Bar");

  # test l4p
  Test::Log4perl-&gt;start();

  # declare we&apos;re going to log something
  $tlogger-&gt;error("This is a test");

  # log that something
  $logger-&gt;error("This is a test");

  # test that those things matched
  Test::Log4perl-&gt;end("Test that that logs okay");

  # we also have a simplified version:
  {
    my $foo = Test::Logger-&gt;expect([&apos;foo.bar.quux&apos;, warn =&gt; qr/hello/ ]);
    # ... do something that should log &apos;hello&apos;
  }
  # $foo goes out of scope; this triggers the test.
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This module can be used to test that you're logging the right thing with Log::Log4perl.  It checks that we get what, and only what, we expect logged by your code.</p><p>The basic process is very simple.  Within your test script you get one or more loggers from <strong>Test::Log4perl</strong> with the \*(C`get_logger\*(C' method just like you would with <strong>Log::Log4perl</strong>.  You're going to use these loggers to declare what you think the code you're going to test should be logging.</p><p>  # declare a bunch of test loggers   my $tlogger = Test::Log4perl-&gt;get_logger("Foo::Bar");</p><p>Then, for each test you want to do you need to start up the module.</p><p>  # start the test   Test::Log4perl-&gt;start();</p><p>This diverts all subsequent attempts <strong>Log::Log4perl</strong> makes to log stuff and records them internally rather than passing them though to the Log4perl appenders as normal.</p><p>You then need to declare with the loggers we created earlier what we hope Log4perl will be asked to log.  This is the same syntax as Test::Log4perl uses, except if you want you can use regular expressions:</p><p>  $tlogger-&gt;debug("fish");   $tlogger-&gt;warn(qr/bar/);</p><p>You then need to run your code that you're testing.</p><p>  # call some code that hopefully will call the log4perl methods   # &apos;debug&apos; with "fish" and &apos;warn&apos; with something that contains &apos;bar&apos;   some_code();</p><p>We finally need to tell <strong>Test::Log4Perl</strong> that we're done and it should do the comparisons.</p><p>  # start the test   Test::Log4perl-&gt;end("test name");</p><h3>Methods</h3>

<dl class='dl-vertical'>
  <dt>
    get_logger($category)
  </dt>
  <dd>
    <p>Returns a new instance of Test::Logger that can be used to log expected messages in the category passed.</p>
  </dd>
  <dt>
    Test::Logger-&gt;expect(['dotted.path', 'warn' =&gt; qr'this', 'warn' =&gt; qr'that'], ..)
  </dt>
  <dd>
    <p>Class convenience method. Used like this:   { # start local scope     my $foo = Test::Logger-&gt;expect([&apos;foo.bar.quux&apos;, warn =&gt; qr/hello/ ]);     # ... do something that should log &apos;hello&apos;   } # $foo goes out of scope; this triggers the test.</p>
  </dd>
  <dt>
    start
  </dt>
  <dd>
    <p>Class method.  Start logging.  When you call this method it temporarly redirects all logging from the standard logging locations to the internal logging routine until end is called.  Takes parameters to change the behavior of this (and only this) test.  See below.</p>
  </dd>
  <dt>
    debug(@what)
  </dt>
  <dd>
    
  </dd>
  <dt>
    info(@what)
  </dt>
  <dd>
    
  </dd>
  <dt>
    warn(@what)
  </dt>
  <dd>
    
  </dd>
  <dt>
    error(@what)
  </dt>
  <dd>
    
  </dd>
  <dt>
    fatal(@what)
  </dt>
  <dd>
    <p>Instance methods.  String of things that you're expecting to log, at the level you're expecting them, in what class.</p>
  </dd>
  <dt>
    <em>end()</em>
  </dt>
  <dd>
    
  </dd>
  <dt>
    end($name)
  </dt>
  <dd>
    <p>Ends the test and compares what we've got with what we expected. Switches logging back from being captured to going to wherever it was originally directed in the config.</p>
  </dd>

</dl>

<h3>Ignoring All Logging Messages</h3>
<p>Sometimes you're going to be testing something that generates a load of spurious log messages that you simply want to ignore without testing their contents, but you don't want to have to reconfigure your log file.  The simpliest way to do this is to do:</p><p>  use Test::Log4perl;   Test::Log4perl-&gt;suppress_logging;</p><p>All logging functions stop working.  Do not alter the Logging classes (for example, by changing the config file and use Log4perl's \*(C`init_and_watch\*(C' functionality) after this call has been made.</p><p>This function will be effectivly a no-op if the enviromental variable \*(C`NO_SUPRESS_LOGGING\*(C' is set to a true value (so if your code is behaving weirdly you can turn all the logging back on from the command line without changing any of the code)</p>
<h3>Selectivly Ignoring Logging Messages By Priority</h3>
<p>It's a bad idea to completely ignore all messages.  What you probably want to do is ignore some of the trivial messages that you don't care about, and just test that there aren't any unexpected messages of a set priority.</p><p>You can temporarly ignore any logging messages that are made by passing parameters to the \*(C`start\*(C' routine</p><p>  # for this test, just ignore DEBUG, INFO, and WARN   Test::Log4perl-&gt;start( ignore_priority =&gt; "warn" );</p><p>  # you can use the levels constants to do the same thing   use Log::Log4perl qw(:levels);   Test::Log4perl-&gt;start( ignore_priority =&gt; $WARN );</p><p>You might want to ignore all logging events at all (this can be used as quick way to not test the actual log messages, but just ignore the output.</p><p>  # for this test, ignore everything   Test::Log4perl-&gt;start( ignore_priority =&gt; "everything" );</p><p>  # contary to readability, the same thing (try not to write this)   use Log::Log4perl qw(:levels);   Test::Log4perl-&gt;start( ignore_priority =&gt; $OFF );</p><p>Or you might want to not ignore anything (which is the default, unless you've played with the method calls mentioned below:)</p><p>  # for this test, ignore nothing   Test::Log4perl-&gt;start( ignore_priority =&gt; "nothing" );</p><p>  # contary to readability, the same thing (try not to write this)   use Log::Log4perl qw(:levels);   Test::Log4perl-&gt;start( ignore_priority =&gt; $ALL );</p><p>You can also perminatly effect what things are ignored with the \*(C`ignore_priority\*(C' method call.  This persists between tests and isn't autoically reset after each call to \*(C`start\*(C'.</p><p>  # ignore DEBUG, INFO and WARN for all future tests   Test::Log4perl-&gt;ignore_priority("warn");</p><p>  # you can use the levels constants to do the same thing   use Log::Log4perl qw(:levels);   Test::Log4perl-&gt;ignore_priority($WARN);</p><p>  # ignore everything (no log messages will be logged)   Test::Log4perl-&gt;ignore_priority("everything");</p><p>  # ignore nothing (messages will be logged reguardless of priority)   Test::Log4perl-&gt;ignore_priority("nothing");</p><p>Obviously, you may temporarly override whatever perminant</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Logging methods don't return the number of appenders they've written to (or rather, they do, as it's always zero.)</p><p>Changing the config file (if you're watching it) while this is testing / supressing everything will probably break everything.  As will creating new appenders, etc...</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>  Mark Fowler &lt;mark@twoshortplanks.com&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>  Copyright 2005 Fotango Ltd all rights reserved.   Licensed under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Test::LectroTest::Tutorial.3pm.html"><span aria-hidden="true">&larr;</span> Test::LectroTest::Tutorial.3pm: How to use lectrotest to test your software</a></li>
   <li class="next"><a href="Test::Log::Dispatch.3pm.html">Test::Log::Dispatch.3pm: Test what you are logging <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
