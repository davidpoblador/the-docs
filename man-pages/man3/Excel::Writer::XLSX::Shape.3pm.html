<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Excel::Writer::XLSX::Shape: A class for creating excel drawing shapes</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A class for creating excel drawing shapes">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Excel::Writer::XLSX::Shape (3pm) manual">
  <meta name="twitter:description" content="A class for creating excel drawing shapes">
  <meta name="twitter:image" content="https://www.carta.tech/images/libexcel-writer-xlsx-perl-Excel::Writer::XLSX::Shape-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Excel::Writer::XLSX::Shape.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Excel::Writer::XLSX::Shape (3pm) manual" />
  <meta property="og:description" content="A class for creating excel drawing shapes" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libexcel-writer-xlsx-perl-Excel::Writer::XLSX::Shape-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Excel::Writer::XLSX::Shape<small> (3pm)</small></h1>
        <p class="lead">A class for creating excel drawing shapes</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Excel::Writer::XLSX::Shape.3pm.html">
      <span itemprop="name">Excel::Writer::XLSX::Shape: A class for creating excel drawing shapes</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libexcel-writer-xlsx-perl/">
      <span itemprop="name">libexcel-writer-xlsx-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Excel::Writer::XLSX::Shape.3pm.html">
      <span itemprop="name">Excel::Writer::XLSX::Shape: A class for creating excel drawing shapes</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>To create a simple Excel file containing shapes using Excel::Writer::XLSX:</p>
<pre>
    #!/usr/bin/perl

    use strict;
    use warnings;
    use Excel::Writer::XLSX;

    my $workbook  = Excel::Writer::XLSX-&gt;new( &apos;shape.xlsx&apos; );
    my $worksheet = $workbook-&gt;add_worksheet();

    # Add a default rectangle shape.
    my $rect = $workbook-&gt;add_shape();

    # Add an ellipse with centered text.
    my $ellipse = $workbook-&gt;add_shape(
        type =&gt; &apos;ellipse&apos;,
        text =&gt; "Hello&#92;nWorld"
    );

    # Add a plus shape.
    my $plus = $workbook-&gt;add_shape( type =&gt; &apos;plus&apos;);

    # Insert the shapes in the worksheet.
    $worksheet-&gt;insert_shape( &apos;B3&apos;, $rect );
    $worksheet-&gt;insert_shape( &apos;C3&apos;, $ellipse );
    $worksheet-&gt;insert_shape( &apos;D3&apos;, $plus );
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The \*(C`Excel::Writer::XLSX::Shape\*(C' module is used to create Shape objects for Excel::Writer::XLSX.</p><p>A Shape object is created via the Workbook \*(C`add_shape()\*(C' method:</p><p>    my $shape_rect = $workbook-&gt;add_shape( type =&gt; &apos;rect&apos; );</p><p>Once the object is created it can be inserted into a worksheet using the \*(C`insert_shape()\*(C' method:</p><p>    $worksheet-&gt;insert_shape(&apos;A1&apos;, $shape_rect);</p><p>A Shape can be inserted multiple times if required.</p><p>    $worksheet-&gt;insert_shape(&apos;A1&apos;, $shape_rect);     $worksheet-&gt;insert_shape(&apos;B2&apos;, $shape_rect, 20, 30);</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>The \*(C`add_shape()\*(C' Workbook method specifies the properties of the Shape in hash \*(C`property =&gt; value\*(C' format:</p><p>    my $shape = $workbook-&gt;add_shape( %properties );</p><p>The available properties are shown below. The \*(C`insert_shape()\*(C' Worksheet method sets the location and scale of the shape object within the worksheet.</p><p>    # Insert the shape into the worksheet.     $worksheet-&gt;insert_shape( &apos;E2&apos;, $shape );</p><p>Using the cell location and the $x and $y cell offsets it is possible to position a shape anywhere on the canvas of a worksheet.</p><p>A more detailed explanation of the \*(C`insert_shape()\*(C' method is given in the main Excel::Writer::XLSX documentation.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SHAPE PROPERTIES</h2>
        <div class="sectioncontent">
<p>Any shape property can be queried or modified by the corresponding get/set method:</p><p>    my $ellipse = $workbook-&gt;add_shape( %properties );     $ellipse-&gt;set_type( &apos;plus&apos; );    # No longer an ellipse!     my $type = $ellipse-&gt;get_type();  # Find out what it really is.</p><p>Multiple shape properties may also be modified in one go by using the \*(C`set_properties()\*(C' method:</p><p>    $shape-&gt;set_properties( type =&gt; &apos;ellipse&apos;, text =&gt; &apos;Hello&apos; );</p><p>The properties of a shape object that can be defined via \*(C`add_shape()\*(C' are shown below.</p><h3>name</h3>
<p>Defines the name of the shape. This is an optional property and the shape will be given a default name if not supplied. The name is generally only used by Excel Macros to refer to the object.</p>
<h3>type</h3>
<p>Defines the type of the object such as \*(C`rect\*(C', \*(C`ellipse\*(C' or \*(C`triangle\*(C':</p><p>    my $ellipse = $workbook-&gt;add_shape( type =&gt; &apos;ellipse&apos; );</p><p>The default type is \*(C`rect\*(C'.</p><p>The full list of available shapes is shown below.</p><p>See also the \*(C`shapes_all.pl\*(C' program in the \*(C`examples\*(C' directory of the distro. It creates an example workbook with all supported shapes labelled with their shape names.</p><ul>
<li><p>Basic Shapes     blockArc              can            chevron       cube          decagon     diamond               dodecagon      donut         ellipse       funnel     gear6                 gear9          heart         heptagon      hexagon     homePlate             lightningBolt  line          lineInv       moon     nonIsoscelesTrapezoid noSmoking      octagon       parallelogram pentagon     pie                   pieWedge       plaque        rect          round1Rect     round2DiagRect        round2SameRect roundRect     rtTriangle    smileyFace     snip1Rect             snip2DiagRect  snip2SameRect snipRoundRect star10     star12                star16         star24        star32        star4     star5                 star6          star7         star8         sun     teardrop              trapezoid      triangle</p></li><li><p>Arrow Shapes     bentArrow        bentUpArrow       circularArrow     curvedDownArrow     curvedLeftArrow  curvedRightArrow  curvedUpArrow     downArrow     leftArrow        leftCircularArrow leftRightArrow    leftRightCircularArrow     leftRightUpArrow leftUpArrow       notchedRightArrow quadArrow     rightArrow       stripedRightArrow swooshArrow       upArrow     upDownArrow      uturnArrow</p></li><li><p>Connector Shapes     bentConnector2   bentConnector3   bentConnector4     bentConnector5   curvedConnector2 curvedConnector3     curvedConnector4 curvedConnector5 straightConnector1</p></li><li><p>Callout Shapes     accentBorderCallout1  accentBorderCallout2  accentBorderCallout3     accentCallout1        accentCallout2        accentCallout3     borderCallout1        borderCallout2        borderCallout3     callout1              callout2              callout3     cloudCallout          downArrowCallout      leftArrowCallout     leftRightArrowCallout quadArrowCallout      rightArrowCallout     upArrowCallout        upDownArrowCallout    wedgeEllipseCallout     wedgeRectCallout      wedgeRoundRectCallout</p></li><li><p>Flow Chart Shapes     flowChartAlternateProcess  flowChartCollate        flowChartConnector     flowChartDecision          flowChartDelay          flowChartDisplay     flowChartDocument          flowChartExtract        flowChartInputOutput     flowChartInternalStorage   flowChartMagneticDisk   flowChartMagneticDrum     flowChartMagneticTape      flowChartManualInput    flowChartManualOperation     flowChartMerge             flowChartMultidocument  flowChartOfflineStorage     flowChartOffpageConnector  flowChartOnlineStorage  flowChartOr     flowChartPredefinedProcess flowChartPreparation    flowChartProcess     flowChartPunchedCard       flowChartPunchedTape    flowChartSort     flowChartSummingJunction   flowChartTerminator</p></li><li><p>Action Shapes     actionButtonBackPrevious actionButtonBeginning actionButtonBlank     actionButtonDocument     actionButtonEnd       actionButtonForwardNext     actionButtonHelp         actionButtonHome      actionButtonInformation     actionButtonMovie        actionButtonReturn    actionButtonSound</p></li><li><p>Chart Shapes Not to be confused with Excel Charts.     chartPlus chartStar chartX</p></li><li><p>Math Shapes     mathDivide mathEqual mathMinus mathMultiply mathNotEqual mathPlus</p></li><li><p>Stars and Banners     arc            bevel          bracePair  bracketPair chord     cloud          corner         diagStripe doubleWave  ellipseRibbon     ellipseRibbon2 foldedCorner   frame      halfFrame   horizontalScroll     irregularSeal1 irregularSeal2 leftBrace  leftBracket leftRightRibbon     plus           ribbon         ribbon2    rightBrace  rightBracket     verticalScroll wave</p></li><li><p>Tab Shapes     cornerTabs plaqueTabs squareTabs</p></li>
</ul>
<h3>text</h3>
<p>This property is used to make the shape act like a text box.</p><p>    my $rect = $workbook-&gt;add_shape( type =&gt; &apos;rect&apos;, text =&gt; "Hello&#92;nWorld" );</p><p>The text is super-imposed over the shape. The text can be wrapped using the newline character \*(C`&#92;n\*(C'.</p>
<h3>id</h3>
<p>Identification number for internal identification. This number will be auto-assigned, if not assigned, or if it is a duplicate.</p>
<h3>format</h3>
<p>Workbook format for decorating the shape text (font family, size, and decoration).</p>
<h3>start, start_index</h3>
<p>Shape indices of the starting point for a connector and the index of the connection. Index numbers are zero-based, start from the top dead centre and are counted clockwise.</p><p>Indices are typically created for vertices and centre points of shapes. They are the blue connection points that appear when connection shapes are selected manually in Excel.</p>
<h3>end, end_index</h3>
<p>Same as above but for end points and end connections.</p>
<h3>start_side, end_side</h3>
<p>This is either the letter \*(C`b\*(C' or \*(C`r\*(C' for the bottom or right side of the shape to be connected to and from.</p><p>If the \*(C`start\*(C', \*(C`start_index\*(C', and \*(C`start_side\*(C' parameters are defined for a connection shape, the shape will be auto located and linked to the starting and ending shapes respectively. This can be very useful for flow and organisation charts.</p>
<h3>flip_h, flip_v</h3>
<p>Set this value to 1, to flip the shape horizontally and/or vertically.</p>
<h3>rotation</h3>
<p>Shape rotation, in degrees, from 0 to 360.</p>
<h3>line, fill</h3>
<p>Shape colour for the outline and fill. Colours may be specified as a colour index, or in \s-1RGB\s0 format, i.e. \*(C`AA00FF\*(C'.</p><p>See \*(C`COLOURS IN EXCEL\*(C' in the main documentation for more information.</p>
<h3>line_type</h3>
<p>Line type for shape outline. The default is solid. The list of possible values is:</p><p>    dash, sysDot, dashDot, lgDash, lgDashDot, lgDashDotDot, solid</p>
<h3>valign, align</h3>
<p>Text alignment within the shape.</p><p>Vertical alignment can be:</p><p>    Setting     Meaning     =======     =======     t           Top     ctr         Centre     b           Bottom</p><p>Horizontal alignment can be:</p><p>    Setting     Meaning     =======     =======     l           Left     r           Right     ctr         Centre     just        Justified</p><p>The default is to centre both horizontally and vertically.</p>
<h3>scale_x, scale_y</h3>
<p>Scale factor in x and y dimension, for scaling the shape width and height. The default value is 1.</p><p>Scaling may be set on the shape object or via \*(C`insert_shape()\*(C'.</p>
<h3>adjustments</h3>
<p>Adjustment of shape vertices. Most shapes do not use this. For some shapes, there is a single adjustment to modify the geometry. For instance, the plus shape has one adjustment to control the width of the spokes.</p><p>Connectors can have a number of adjustments to control the shape routing. Typically, a connector will have 3 to 5 handles for routing the shape. The adjustment is in percent of the distance from the starting shape to the ending shape, alternating between the x and y dimension. Adjustments may be negative, to route the shape away from the endpoint.</p>
<h3>stencil</h3>
<p>Shapes work in stencil mode by default. That is, once a shape is inserted, its connection is separated from its master. The master shape may be modified after an instance is inserted, and only subsequent insertions will show the modifications.</p><p>This is helpful for Org charts, where an employee shape may be created once, and then the text of the shape is modified for each employee.</p><p>The \*(C`insert_shape()\*(C' method returns a reference to the inserted shape (the child).</p><p>Stencil mode can be turned off, allowing for shape(s) to be modified after insertion. In this case the \*(C`insert_shape()\*(C' method returns a reference to the inserted shape (the master). This is not very useful for inserting multiple shapes, since the x/y coordinates also gets modified.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TIPS</h2>
        <div class="sectioncontent">
<p>Use \*(C`$worksheet-&gt;<strong>hide_gridlines</strong>(2)\*(C' to prepare a blank canvas without gridlines.</p><p>Shapes do not need to fit on one page. Excel will split a large drawing into multiple pages if required. Use the page break preview to show page boundaries superimposed on the drawing.</p><p>Connected shapes will auto-locate in Excel if you move either the starting shape or the ending shape separately. However, if you select both shapes (lasso or control-click), the connector will move with it, and the shape adjustments will not re-calculate.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>    #!/usr/bin/perl</p><p>    use strict;     use warnings;     use Excel::Writer::XLSX;</p><p>    my $workbook  = Excel::Writer::XLSX-&gt;new( &apos;shape.xlsx&apos; );     my $worksheet = $workbook-&gt;add_worksheet();</p><p>    # Add a default rectangle shape.     my $rect = $workbook-&gt;add_shape();</p><p>    # Add an ellipse with centered text.     my $ellipse = $workbook-&gt;add_shape(         type =&gt; &apos;ellipse&apos;,         text =&gt; "Hello&#92;nWorld"     );</p><p>    # Add a plus shape.     my $plus = $workbook-&gt;add_shape( type =&gt; &apos;plus&apos;);</p><p>    # Insert the shapes in the worksheet.     $worksheet-&gt;insert_shape( &apos;B3&apos;, $rect );     $worksheet-&gt;insert_shape( &apos;C3&apos;, $ellipse );     $worksheet-&gt;insert_shape( &apos;D3&apos;, $plus );</p><p>See also the \*(C`shapes_*.pl\*(C' program in the \*(C`examples\*(C' directory of the distro.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TODO</h2>
        <div class="sectioncontent">
<ul>
<li><p>Add shapes which have custom geometries.</p></li><li><p>Provide better integration of workbook formats for shapes.</p></li><li><p>Add further validation of shape properties to prevent creation of workbooks that will not open.</p></li><li><p>Auto connect shapes that are not anchored to cell A1.</p></li><li><p>Add automatic shape connection to shape vertices besides the object centre.</p></li><li><p>Improve automatic shape connection to shapes with concave sides (e.g. chevron).</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Dave Clarke dclarke@cpan.org</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>(c) MM-MMXIIII, John McNamara.</p><p>All Rights Reserved. This module is free software. It may be used, redistributed and/or modified under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Excel::Writer::XLSX::Package::XMLwriter.3pm.html"><span aria-hidden="true">&larr;</span> Excel::Writer::XLSX::Package::XMLwriter.3pm: A base class for the excel::writer::xlsx writer classes.</a></li>
   <li class="next"><a href="Excel::Writer::XLSX::Utility.3pm.html">Excel::Writer::XLSX::Utility.3pm: Helper functions for excel::writer::xlsx. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
