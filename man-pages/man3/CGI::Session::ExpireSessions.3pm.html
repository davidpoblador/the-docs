<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CGI::Session::ExpireSessions: Expires cgi::session db-based and file-based sessions</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Expires cgi::session db-based and file-based sessions">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="CGI::Session::ExpireSessions (3pm) manual">
  <meta name="twitter:description" content="Expires cgi::session db-based and file-based sessions">
  <meta name="twitter:image" content="https://www.carta.tech/images/libcgi-session-expiresessions-perl-CGI::Session::ExpireSessions-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/CGI::Session::ExpireSessions.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="CGI::Session::ExpireSessions (3pm) manual" />
  <meta property="og:description" content="Expires cgi::session db-based and file-based sessions" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libcgi-session-expiresessions-perl-CGI::Session::ExpireSessions-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">CGI::Session::ExpireSessions<small> (3pm)</small></h1>
        <p class="lead">Expires cgi::session db-based and file-based sessions</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/CGI::Session::ExpireSessions.3pm.html">
      <span itemprop="name">CGI::Session::ExpireSessions: Expires cgi::session db-based and file-based sessions</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libcgi-session-expiresessions-perl/">
      <span itemprop="name">libcgi-session-expiresessions-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/CGI::Session::ExpireSessions.3pm.html">
      <span itemprop="name">CGI::Session::ExpireSessions: Expires cgi::session db-based and file-based sessions</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">Synopsis</h2>
        <div class="sectioncontent">

<pre>
        #!/usr/bin/env perl

        use strict;
        use warnings;

        use CGI::Session::ExpireSessions;
        use DBI;

        # -----------------------------------------------

        my($dbh) = DBI -&gt; connect
        (
          &apos;dbi:mysql:aussi:127.0.0.1&apos;,
          &apos;root&apos;,
          &apos;pass&apos;,
          {
            AutoCommit         =&gt; 1,
            PrintError         =&gt; 0,
            RaiseError         =&gt; 1,
            ShowErrorStatement =&gt; 1,
          }
        );

        CGI::Session::ExpireSessions -&gt; new(dbh =&gt; $dbh, verbose =&gt; 1) -&gt; expire_db_sessions();
        CGI::Session::ExpireSessions -&gt; new(temp_dir =&gt; &apos;/tmp&apos;, verbose =&gt; 1) -&gt; expire_file_sessions();
        CGI::Session::ExpireSessions -&gt; new(verbose =&gt; 1) -&gt; expire_sessions();

        # Note: You are strongly urged to use method expire_sessions() (it requires CGI::Session V 4 or later),
        # since it does not eval the session data, and hence avoids the security issues of evaling a string
        # which comes from outside the program. See examples/expire-set.pl, which contains extensive comments.
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Description</h2>
        <div class="sectioncontent">
<p>\*(C`CGI::Session::ExpireSessions\*(C' is a pure Perl module.</p><p>It deletes \*(C`CGI::Session\*(C'-type sessions which have passed their use-by date.</p><p>It works with \*(C`CGI::Session\*(C'-type sessions in a database or in disk files, but does not appear to work with \*(C`CGI::Session::PureSQL\*(C'-type sessions.</p><p>The recommended way to use this module is via method \*(C`expire_sessions()\*(C', which requires \*(C`CGI::Session\*(C' V 4 or later.</p><p>Sessions can be expired under one of three conditions:</p>
<dl class='dl-vertical'>
  <dt>
    o You deem the session to be expired as of now
  </dt>
  <dd>
    <p>You want the session to be expired and hence deleted now because it's last access time is longer ago than the time you specify in the call to new, using the delta parameter. That is, delete the session because the time span, between the \*(C`last access\*(C' time and now, is greater than delta. In other words, force sessions to expire. The module has always used this condition to delete sessions. You want the session to be expired and hence deleted now because it's \*(C`last access\*(C' time is longer ago than the time you specify in the call to new, using the delta parameter.</p>
  </dd>
  <dt>
    o The session has already expired
  </dt>
  <dd>
    <p>This section applies to all 3 methods: \*(C`expire_db_sessions()\*(C', \*(C`expire_file_sessions()\*(C' and \*(C`expire_sessions()\*(C'. This condition is new as of V 1.02. You want the session to be deleted now because it has already expired. That is, you want this module to delete the session, rather than getting \*(C`CGI::Session\*(C' to delete it, when \*(C`CGI::Session\*(C' would delete the session automatically if you used \*(C`CGI::Session\*(C' to retrieve the session. Note: This condition assumes the session's expiration time is defined (it does not have to be).</p>
  </dd>
  <dt>
    o The file size is &lt;= 5 bytes and was accessed more than 'delta' seconds ago
  </dt>
  <dd>
    <p>This condition is new as of V 1.03. This section applies to method: \*(C`expire_file_sessions()\*(C'. See below for how to provide a value of delta to the constructor. Old versions of \*(C`CGI::Session\*(C' sometimes create a file of size 0 bytes, so this test checks for such files, and deletes them if they are old enough.</p>
  </dd>

</dl>
<p>Sessions are deleted if any of these conditions is true.</p><p>Sessions are deleted from the 'sessions' table in the database, or from the temp directory, depending on how you use \*(C`CGI::Session\*(C'.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Distributions</h2>
        <div class="sectioncontent">
<p>This module is available both as a Unix-style distro (*.tgz) and an ActiveState-style distro (*.ppd). The latter is shipped in a *.zip file.</p><p>See http://savage.net.au/Perl-modules.html for details.</p><p>See http://savage.net.au/Perl-modules/html/installing-a-module.html for help on unpacking and installing each type of distro.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Security</h2>
        <div class="sectioncontent">
<p>For file-based sessions, method \*(C`expire_file_sessions()\*(C' parses the contents of the file, using eval{}, in an attempt to determine the access and expiration times recorded within the file.</p><p>So, if you are uneasy about the security implication of this (as you should be), don't use this method. Use method \*(C`expire_sessions()\*(C' instead. The latter is a much more sophisticated way of expiring sessions, but it does require \*(C`CGI::Session\*(C' V 4 or later.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Constructor and initialization</h2>
        <div class="sectioncontent">
<p>new(...) returns a \*(C`CGI::Session::ExpireSessions\*(C' object.</p><p>This is the class's contructor.</p><p>Usage: CGI::Session::ExpireSessions -&gt; <em>new()</em>.</p><p>This method takes a set of parameters. Only some of these parameters are mandatory.</p><p>For each parameter, call method \*(C`new()\*(C' as new(param_1 =&gt; value_1, param_2 =&gt; value_2, ...).</p><p>Note: As of V 1.07 of this module, you may call method \*(C`set()\*(C' to set parameters after calling method \*(C`new()\*(C'.</p><p>Not only that, but you may pass into all of the 3 methods \*(C`expire_db_sessions()\*(C', \*(C`expire_file_sessions()\*(C' and \*(C`expire_sessions()\*(C' any of the parameters accepted by \*(C`new()\*(C', since these 3 methods call \*(C`set()\*(C' if their caller provides parameters.</p><p>Parameters which can be used with \*(C`new()\*(C', \*(C`set()\*(C', or \*(C`expire_*()\*(C':</p>
<dl class='dl-vertical'>
  <dt>
    o cgi_session_dsn
  </dt>
  <dd>
    <p>This is the \s-1DSN\s0 (Data Source Name) used by \*(C`CGI::Session\*(C' to control what type of sessions you previously created and what type of sessions you now wish to expire. Do not confuse this with the \s-1DSN\s0 used by \*(C`CGI::Session\*(C''s method find(param_1, &#92;&sub, {DataSource =&gt; other_dsn...}, ...) when referring to db-based sessions. Method \*(C`expire_sessions()\*(C' is the only method in this module which uses this parameter. So, when you call \*(C`expire_sessions()\*(C', this parameter - cgi_session_dsn - determines the set of sessions processed by, and possibly expired by, the call to \*(C`expire_sessions()\*(C'. The default value is undef, which means \*(C`CGI::Session\*(C' defaults to file-based sessions. This parameter is optional for file-based sessions, and mandatory for db-based sessions.</p>
  </dd>
  <dt>
    o dbh
  </dt>
  <dd>
    <p>This is a database handle for the database containing the table 'sessions'. Either this parameter is mandatory, or the temp_dir parameter is mandatory.</p>
  </dd>
  <dt>
    o delta
  </dt>
  <dd>
    <p>This is the number of seconds since the \*(C`last access\*(C' to the session, which determines whether or not the session will be expired. This is the number of seconds since the \*(C`last access\*(C' time of the session, which determines whether or not the session will be expired.</p><p>The default value is 2 * 24 * 60 * 60, which is the number of seconds in 2 days. By default, then, sessions which were last accessed more than 2 days ago are expired. This parameter is optional.</p>
  </dd>
  <dt>
    o dsn_args
  </dt>
  <dd>
    <p>If your cgi_session_dsn uses file-based storage, then this hashref might contain keys such as:         {                 Directory =&gt; Value 1,                 NoFlock   =&gt; Value 2,                 UMask     =&gt; Value 3         } If your cgi_session_dsn uses db-based storage, then this hashref contains (up to) 3 keys, and looks like:         {                 DataSource =&gt; Value 1,                 User       =&gt; Value 2,                 Password   =&gt; Value 3         } These 3 form the \s-1DSN\s0, username and password used by \s-1DBI\s0 to control access to your database server, and hence are only relevant when using db-based sessions. Method \*(C`expire_sessions()\*(C' is the only method in this module which uses the parameter dsn_args. The default value for this parameter is undef. These parameters are optional for file-based sessions, and mandatory for db-based sessions.</p>
  </dd>
  <dt>
    o table_name
  </dt>
  <dd>
    <p>This is the name of the database table used to hold the sessions. The default value is 'sessions'. This parameter is optional.</p>
  </dd>
  <dt>
    o temp_dir
  </dt>
  <dd>
    <p>This is the name of the temp directory where you store CGI::Session-type session files. The default value is '/tmp'. Either this parameter is mandatory, or the dbh parameter is mandatory.</p>
  </dd>
  <dt>
    o time
  </dt>
  <dd>
    <p>The session's \*(C`last access\*(C' time is subtracted from the value of this parameter, and if the result is greater than or equal to the value of parameter 'delta', then the session is expired. Method \*(C`expire_sessions()\*(C' is the only method in this module which uses this parameter. The default value is obtained by calling <em>time()</em>. This parameter is optional.</p>
  </dd>
  <dt>
    o verbose
  </dt>
  <dd>
    <p>This is a integer, 0 or 1, which - when set to 1 - causes progress messages to be written to \s-1STDOUT\s0. The default value is 0. This parameter is optional.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Method: \fIexpire_db_sessions()\fP</h2>
        <div class="sectioncontent">
<p>Returns nothing.</p><p>This method uses the dbh parameter passed to \*(C`new()\*(C' to delete database-type sessions.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Method: \fIexpire_file_sessions()\fP</h2>
        <div class="sectioncontent">
<p>Returns nothing.</p><p>This method uses the temp_dir parameter passed to \*(C`new()\*(C' to delete file-type sessions.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Method: \fIexpire_sessions()\fP</h2>
        <div class="sectioncontent">
<p>Return value:</p>
<dl class='dl-vertical'>
  <dt>
    o undef
  </dt>
  <dd>
    <p>Returns undef if your version of \*(C`CGI::Session\*(C' does not support method \*(C`find()\*(C'. Also, returns undef when \*(C`CGI::Session\*(C''s method \*(C`find()\*(C' failed for some reason.</p>
  </dd>
  <dt>
    o 1
  </dt>
  <dd>
    <p>Returns 1 when \*(C`find()\*(C' succeeds.</p>
  </dd>

</dl>
<p>Returns the result of calling CGI::Session's method <em>find()</em>, which will be undef for some sort of failure, and 1 for success.</p><p>This method handles both file-based and db-based sessions.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Example code</h2>
        <div class="sectioncontent">
<p>See the examples/ directory in the distro.</p><p>There are 2 demo programs: expire-sessions.pl and expire-set.pl.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Author</h2>
        <div class="sectioncontent">
<p>\*(C`CGI::Session::ExpireSessions\*(C' was written by Ron Savage <em>&lt;ron@savage.net.au&gt;</em> in 2004.</p><p>Home page: http://savage.net.au/index.html</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Copyright</h2>
        <div class="sectioncontent">
<p>Australian copyright (c) 2004, Ron Savage. 	All Programs of mine are '\s-1OSI\s0 Certified Open Source Software'; 	you can redistribute them and/or modify them under the terms of 	The Artistic License, a copy of which is available at: 	http://www.opensource.org/licenses/index.html</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="CGI::Session::Driver::memcached.3pm.html"><span aria-hidden="true">&larr;</span> CGI::Session::Driver::memcached.3pm: Cgi::session driver for memcached</a></li>
   <li class="next"><a href="CGI::Session::Serialize::yaml.3pm.html">CGI::Session::Serialize::yaml.3pm: Serializer for cgi::session <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
