<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>XkbSetMap: Send a complete new set of values for entire components to the server.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Send a complete new set of values for entire components to the server.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="XkbSetMap (3) manual">
  <meta name="twitter:description" content="Send a complete new set of values for entire components to the server.">
  <meta name="twitter:image" content="https://www.carta.tech/images/libx11-doc-XkbSetMap-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/XkbSetMap.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="XkbSetMap (3) manual" />
  <meta property="og:description" content="Send a complete new set of values for entire components to the server." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libx11-doc-XkbSetMap-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">XkbSetMap<small> (3)</small></h1>
        <p class="lead">Send a complete new set of values for entire components to the server.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/XkbSetMap.3.html">
      <span itemprop="name">XkbSetMap: Send a complete new set of values for entire components to the server.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libx11-doc/">
      <span itemprop="name">libx11-doc</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/XkbSetMap.3.html">
      <span itemprop="name">XkbSetMap: Send a complete new set of values for entire components to the server.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>Bool XkbSetMap</strong> <strong>(\^Display *</strong><em>dpy</em><strong>\^,</strong> <strong>unsigned int </strong><em>which</em><strong>\^,</strong> <strong>XkbDescPtr </strong><em>xkb</em><strong>\^);</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ARGUMENTS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>- dpy</em></p>
  </dt>
  <dd>
    <p>connection to X server</p>
  </dd>
  <dt>
    <p><em>- which</em></p>
  </dt>
  <dd>
    <p>mask selecting subcomponents to update</p>
  </dd>
  <dt>
    <p><em>- xkb</em></p>
  </dt>
  <dd>
    <p>description from which new values are taken</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>There are two ways to make changes to map components: either change a local copy of the keyboard map and call <em>XkbSetMap</em> to send the modified map to the server, or, to reduce network traffic, use an XkbMapChangesRec structure and call <em>XkbChangeMap.</em></p><p>Use <em>XkbSetMap</em> to send a complete new set of values for entire components (for example, all symbols, all actions, and so on) to the server. The <em>which</em> parameter specifies the components to be sent to the server, and is a bitwise inclusive OR of the masks listed in Table 1. The <em>xkb</em> parameter is a pointer to an XkbDescRec structure and contains the information to be copied to the server. For each bit set in the <em>which</em> parameter, <em>XkbSetMap</em> takes the corresponding structure values from the <em>xkb</em> parameter and sends it to the server specified by <em>dpy.</em></p><p>If any components specified by <em>which</em> are not present in the <em>xkb</em> parameter, <em>XkbSetMap</em> returns False. Otherwise, it sends the update request to the server and returns True. <em>XkbSetMap</em> can generate BadAlloc, BadLength, and BadValue protocol errors.</p><p>Key types, symbol maps, and actions are all interrelated; changes in one require changes in the others. Xkb provides functions to make it easier to edit these components and handle the interdependencies. Table 1 lists these helper functions and provides a pointer to where they are defined.</p><table class="table table-striped">
<tr>
<th>Table 1 Xkb Mapping Component Masks</th>
<th></th>
<th></th>
<th></th>
<th></th></tr>

<tr>
<td>and Convenience Functions</td>
<td></td>
<td></td>
<td></td>
<td></td></tr>

<tr>
<td>Mask</td>
<td>Value</td>
<td>Map</td>
<td>Fields</td>
<td>Convenience</td></tr>

<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Functions</td></tr>

<tr>
<td>XkbKeyTypesMask    </td>
<td>(1&lt;&lt;0)</td>
<td>client</td>
<td>types          size_types          num_types    </td>
<td>XkbGetKeyTypes          XkbResizeKeyType          XkbCopyKeyType          XkbCopyKeyTypes    </td></tr>

<tr>
<td>XkbKeySymsMask    </td>
<td>(1&lt;&lt;1)</td>
<td>client</td>
<td>syms          size_syms          num_syms          key_sym_map    </td>
<td>XkbGetKeySyms          XkbResizeKeySyms          XkbChangeTypesOfKey    </td></tr>

<tr>
<td>XkbModifierMapMask    </td>
<td>(1&lt;&lt;2)</td>
<td>client</td>
<td>modmap</td>
<td>XkbGetKeyModifierMap    </td></tr>

<tr>
<td>XkbExplicitComponentsMask    </td>
<td>(1&lt;&lt;3)</td>
<td>server</td>
<td>explicit    </td>
<td>XkbGetKeyExplicitComponents    </td></tr>

<tr>
<td>XkbKeyActionsMask    </td>
<td>(1&lt;&lt;4)</td>
<td>server</td>
<td>key_acts          acts          num_acts          size_acts    </td>
<td>XkbGetKeyActions          XkbResizeKeyActions    </td></tr>

<tr>
<td>XkbKeyBehaviorsMask    </td>
<td>(1&lt;&lt;5)</td>
<td>server</td>
<td>behaviors    </td>
<td>XkbGetKeyBehaviors    </td></tr>

<tr>
<td>XkbVirtualModsMask    </td>
<td>(1&lt;&lt;6)</td>
<td>server</td>
<td>vmods    </td>
<td>XkbGetVirtualMods    </td></tr>

<tr>
<td>XkbVirtualModMapMask    </td>
<td>(1&lt;&lt;7)</td>
<td>server</td>
<td>vmodmap    </td>
<td>XkbGetVirtualModMap    </td></tr>
</table><p>The <em>changed</em> field identifies the map components that have changed in an XkbDescRec structure and may contain any of the bits in Table 1, which are also shown in Table 2. Every 1 bit in <em>changed</em> also identifies which other fields in the XkbMapChangesRec structure contain valid values, as indicated in Table 2. The <em>min_key_code</em> and <em>max_key_code</em> fields are for reference only; they are ignored on any requests sent to the server and are always updated by the server whenever it returns the data for an XkbMapChangesRec.</p><table class="table table-striped">
<tr>
<th>Table 2 XkbMapChangesRec Masks</th>
<th></th>
<th></th></tr>

<tr>
<td></td>
<td>Valid</td>
<td></td></tr>

<tr>
<td>Mask</td>
<td>XkbMapChangesRec</td>
<td>XkbDescRec Field Containing</td></tr>

<tr>
<td></td>
<td>Fields</td>
<td>Changed Data</td></tr>

<tr>
<td>XkbKeyTypesMask</td>
<td>first_type,</td>
<td>map-&gt;type[first_type] ..</td></tr>

<tr>
<td></td>
<td>num_types</td>
<td>map-&gt;type[first_type + num_types - 1]</td></tr>

<tr>
<td></td>
<td></td>
<td></td></tr>

<tr>
<td>XkbKeySymsMask</td>
<td>first_key_sym,</td>
<td>map-&gt;key_sym_map[first_key_sym] ..</td></tr>

<tr>
<td></td>
<td>num_key_syms</td>
<td>map-&gt;key_sym_map[first_key_sym +</td></tr>

<tr>
<td></td>
<td></td>
<td>num_key_syms - 1]</td></tr>

<tr>
<td>XkbModifierMapMask</td>
<td>first_modmap_key,</td>
<td>map-&gt;modmap[first_modmap_key] ..</td></tr>

<tr>
<td></td>
<td>num_modmap_keys</td>
<td>map-&gt;modmap[first_modmap_key +</td></tr>

<tr>
<td></td>
<td></td>
<td>num_modmap_keys-1]</td></tr>

<tr>
<td>XkbExplicitComponentsMask</td>
<td>first_key_explicit,</td>
<td></td></tr>

<tr>
<td>server-&gt;explicit[first_key_explicit] ..</td>
<td></td>
<td></td></tr>

<tr>
<td></td>
<td>num_key_explicit</td>
<td>server-&gt;explicit[first_key_explicit +</td></tr>

<tr>
<td></td>
<td></td>
<td>num_key_explicit - 1]</td></tr>

<tr>
<td>XkbKeyActionsMask</td>
<td>first_key_act,</td>
<td>server-&gt;key_acts[first_key_act] ..</td></tr>

<tr>
<td></td>
<td>num_key_acts</td>
<td>server-&gt;key_acts[first_key_act +</td></tr>

<tr>
<td></td>
<td></td>
<td>num_key_acts - 1]</td></tr>

<tr>
<td>XkbKeyBehaviorsMask</td>
<td>first_key_behavior,</td>
<td></td></tr>

<tr>
<td>server-&gt;behaviors[first_key_behavior] ..</td>
<td></td>
<td></td></tr>

<tr>
<td></td>
<td>num_key_behaviors</td>
<td>server-&gt;behaviors[first_key_behavior +</td></tr>

<tr>
<td></td>
<td></td>
<td>num_key_behaviors - 1]</td></tr>

<tr>
<td>XkbVirtualModsMask</td>
<td>vmods</td>
<td>server-&gt;vmods[*]</td></tr>

<tr>
<td>XkbVirtualModMapMask</td>
<td>first_vmodmap_key,</td>
<td></td></tr>

<tr>
<td>server-&gt;vmodmap[first_vmodmap_key]</td>
<td></td>
<td></td></tr>

<tr>
<td></td>
<td>num_vmodmap_keys</td>
<td> ..</td></tr>

<tr>
<td></td>
<td></td>
<td>server-&gt;vmodmap[first_vmodmap_key</td></tr>

<tr>
<td></td>
<td></td>
<td>+ num_vmodmap_keys - 1]</td></tr>
</table>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>True</p>
  </dt>
  <dd>
    <p>The <em>XkbSetMap</em> function returns True all components specified by <em>which</em> are present in the <em>xkb</em> parameter.</p>
  </dd>
  <dt>
    <p>False</p>
  </dt>
  <dd>
    <p>The <em>XkbSetMap</em> function returns False if any component specified by <em>which</em> is not present in the <em>xkb</em> parameter.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">STRUCTURES</h2>
        <div class="sectioncontent">
<p>Use the XkbMapChangesRec structure to identify and track partial modifications to the mapping components and to reduce the amount of traffic between the server and clients.</p>
<pre>
typedef struct _XkbMapChanges {
    unsigned short   changed;            /\(** identifies valid components in structure */
    KeyCode          min_key_code;       /\(** lowest numbered keycode for device */
    KeyCode          max_key_code;       /\(** highest numbered keycode for device */
    unsigned char    first_type;         /\(** index of first key type modified */
    unsigned char    num_types;          /\(** # types modified */
    KeyCode          first_key_sym;      /\(** first key whose key_sym_map changed */
    unsigned char    num_key_syms;       /\(** # key_sym_map entries changed */
    KeyCode          first_key_act;      /\(** first key whose key_acts entry changed */
    unsigned char    num_key_acts;       /\(** # key_acts entries changed */
    KeyCode          first_key_behavior; /\(** first key whose behaviors changed */
    unsigned char    num_key_behaviors;  /\(** # behaviors entries changed */
    KeyCode          first_key_explicit; /\(** first key whose explicit entry changed */
    unsigned char    num_key_explicit;   /\(** # explicit entries changed */
    KeyCode          first_modmap_key;   /\(** first key whose modmap entry changed */
    unsigned char    num_modmap_keys;    /\(** # modmap entries changed */
    KeyCode          first_vmodmap_key;  /\(** first key whose vmodmap changed */
    unsigned char    num_vmodmap_keys;   /\(** # vmodmap entries changed */
    unsigned char    pad1;               /\(** reserved */
    unsigned short   vmods;              /\(** mask indicating which vmods changed */
} XkbMapChangesRec,*XkbMapChangesPtr;

</pre>
<p>The complete description of an Xkb keyboard is given by an XkbDescRec. The component structures in the XkbDescRec represent the major Xkb components.</p>
<pre>
typedef struct {
   struct _XDisplay * display;      /\(** connection to X server */
   unsigned short     flags;        /\(** private to Xkb, do not modify */
   unsigned short     device_spec;  /\(** device of interest */
   KeyCode            min_key_code; /\(** minimum keycode for device */
   KeyCode            max_key_code; /\(** maximum keycode for device */
   XkbControlsPtr     ctrls;        /\(** controls */
   XkbServerMapPtr    server;       /\(** server keymap */
   XkbClientMapPtr    map;          /\(** client keymap */
   XkbIndicatorPtr    indicators;   /\(** indicator map */
   XkbNamesPtr        names;        /\(** names for all components */
   XkbCompatMapPtr    compat;       /\(** compatibility map */
   XkbGeometryPtr     geom;         /\(** physical geometry of keyboard */
} XkbDescRec, *XkbDescPtr;

</pre>
<p>The <em>display</em> field points to an X display structure. The <em>flags field is private to the library: modifying</em> <em>flags</em> may yield unpredictable results. The <em>device_spec</em> field specifies the device identifier of the keyboard input device, or XkbUseCoreKeyboard, which specifies the core keyboard device. The <em>min_key_code</em> and <em>max_key_code</em> fields specify the least and greatest keycode that can be returned by the keyboard.</p><p>Each structure component has a corresponding mask bit that is used in function calls to indicate that the structure should be manipulated in some manner, such as allocating it or freeing it. These masks and their relationships to the fields in the XkbDescRec are shown in Table 3.</p><table class="table table-striped">
<tr>
<th>Table 3 Mask Bits for XkbDescRec</th>
<th></th>
<th></th></tr>

<tr>
<td>Mask Bit</td>
<td>XkbDescRec Field</td>
<td>Value</td></tr>

<tr>
<td>XkbControlsMask</td>
<td>ctrls</td>
<td>(1L&lt;&lt;0)</td></tr>

<tr>
<td>XkbServerMapMask</td>
<td>server</td>
<td>(1L&lt;&lt;1)</td></tr>

<tr>
<td>XkbIClientMapMask</td>
<td>map</td>
<td>(1L&lt;&lt;2)</td></tr>

<tr>
<td>XkbIndicatorMapMask</td>
<td>indicators</td>
<td>(1L&lt;&lt;3)</td></tr>

<tr>
<td>XkbNamesMask</td>
<td>names</td>
<td>(1L&lt;&lt;4)</td></tr>

<tr>
<td>XkbCompatMapMask</td>
<td>compat</td>
<td>(1L&lt;&lt;5)</td></tr>

<tr>
<td>XkbGeometryMask</td>
<td>geom</td>
<td>(1L&lt;&lt;6)</td></tr>

<tr>
<td>XkbAllComponentsMask</td>
<td>All Fields</td>
<td>(0x7f)</td></tr>
</table>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>BadAlloc</strong></p>
  </dt>
  <dd>
    <p>Unable to allocate storage</p>
  </dd>
  <dt>
    <p><strong>BadLength</strong></p>
  </dt>
  <dd>
    <p>The length of a request is shorter or longer than that required to minimally contain the arguments</p>
  </dd>
  <dt>
    <p><strong>BadValue</strong></p>
  </dt>
  <dd>
    <p>An argument is out of range</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO XkbSetMap&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man3/XkbChangeMap.3.html"><strong>XkbChangeMap</strong>(3)</a>, <a href="../man3/XkbChangeTypesOfKey.3.html"><strong>XkbChangeTypesOfKey</strong>(3)</a>, <a href="../man3/XkbCopyKeyType.3.html"><strong>XkbCopyKeyType</strong>(3)</a>, <a href="../man3/XkbCopyKeyTypes.3.html"><strong>XkbCopyKeyTypes</strong>(3)</a>, <a href="../man3/XkbGetKeyActions.3.html"><strong>XkbGetKeyActions</strong>(3)</a>, <a href="../man3/XkbGetKeyBehaviors.3.html"><strong>XkbGetKeyBehaviors</strong>(3)</a>, <a href="../man3/XkbGetKeyExplicitComponents.3.html"><strong>XkbGetKeyExplicitComponents</strong>(3)</a>, <a href="../man3/XkbGetKeyModifierMap.3.html"><strong>XkbGetKeyModifierMap</strong>(3)</a>, <a href="../man3/XkbGetKeySyms.3.html"><strong>XkbGetKeySyms</strong>(3)</a>, <a href="../man3/XkbGetKeyTypes.3.html"><strong>XkbGetKeyTypes</strong>(3)</a>, <a href="../man3/XkbResizeKeyActions.3.html"><strong>XkbResizeKeyActions</strong>(3)</a>, <a href="../man3/XkbResizeKeySyms.3.html"><strong>XkbResizeKeySyms</strong>(3)</a>, <a href="../man3/XkbResizeKeyType.3.html"><strong>XkbResizeKeyType</strong>(3)</a>, <strong>XkbGetVirtualModMap</strong>(3), <a href="../man3/XkbGetVirtualMods.3.html"><strong>XkbGetVirtualMods</strong>(3)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="XkbSetIndicatorMap.3.html"><span aria-hidden="true">&larr;</span> XkbSetIndicatorMap.3: Downloads the changes to the server based on modifications to a local copy of the keyboard description which will update the maps for one or more indicators</a></li>
   <li class="next"><a href="XkbSetModActionVMods.3.html">XkbSetModActionVMods.3: Sets the vmods1 and vmods2 fields of act using the vmods format of an xkb modifier description <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
