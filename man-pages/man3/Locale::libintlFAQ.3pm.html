<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Locale::libintlFAQ: Frequently asked questions for libintl-perl</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Frequently asked questions for libintl-perl">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Locale::libintlFAQ (3pm) manual">
  <meta name="twitter:description" content="Frequently asked questions for libintl-perl">
  <meta name="twitter:image" content="https://www.carta.tech/images/libintl-perl-Locale::libintlFAQ-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Locale::libintlFAQ.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Locale::libintlFAQ (3pm) manual" />
  <meta property="og:description" content="Frequently asked questions for libintl-perl" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libintl-perl-Locale::libintlFAQ-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Locale::libintlFAQ<small> (3pm)</small></h1>
        <p class="lead">Frequently asked questions for libintl-perl</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Locale::libintlFAQ.3pm.html">
      <span itemprop="name">Locale::libintlFAQ: Frequently asked questions for libintl-perl</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libintl-perl/">
      <span itemprop="name">libintl-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Locale::libintlFAQ.3pm.html">
      <span itemprop="name">Locale::libintlFAQ: Frequently asked questions for libintl-perl</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This \s-1FAQ\s0</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">QUESTIONS AND ANSWERS</h2>
        <div class="sectioncontent">
<h3>Why is libintl-perl so big?  Why don't you use \fIEncode\fP\|(3pm) for character set conversion instead of rolling your own version?</h3>
<p><em>Encode</em>\|(3pm) requires at least Perl 5.7.x, whereas libintl-perl needs to be operational on Perl 5.004.  Internally, libintl-perl uses <em>Encode</em>\|(3pm) if it is available.</p>
<h3>Why do the gettext functions always unset the utf-8 flag on the strings it returns?</h3>
<p>Because the gettext functions do not know whether the string is encoded in utf-8 or not.  Instead of taking guesses, it rather unsets the flag.</p>
<h3>Can I set the utf-8 flag on strings returned by the gettext family of functions?</h3>
<p>Yes, but it is not recommended.  If you absolutely want to do it, use the function bind_textdomain_filter in Locale::Messages for it.</p><p>The strings returned by gettext and friends are by default encoded in the preferred charset for the user's locale, but there is no portable way to find out, whether this is utf-8 or not.  That means, you either have to enforce utf-8 as the output character set (by means of <em>bind_textdomain_codeset()</em> and/or the environment variable \s-1OUTPUT_CHARSET\s0) and override the user preference, or you run the risk of marking strings as utf-8 which really aren't utf-8.</p><p>The whole concept behind that utf-8 flag introduced in Perl 5.6 is seriously broken, and the above described dilemma is a proof for that. The best thing you can do with that flag is get rid of it, and turn it off.  Your code will benefit from it and become less error prone, more portable and faster.</p>
<h3>Why do non-ASCII characters in my Gtk2 application look messed up?</h3>
<p>The Perl binding of Gtk2 has a design flaw.  It expects all \s-1UI\s0 messages to be in \s-1UTF-8\s0 and it also expects messages to be flagged as utf-8.  The only solution for you is to enforce all your po files to be encoded in utf-8 (convert them manually, if you need to), and also enforce that charset in your application, regardless of the user's locale settings. Assumed that your textdomain is \*(L"org.bar.foo\*(R", you have to code the following into your main module or script:</p>
<pre>
  BEGIN {
      bind_textdomain_filter &apos;org.bar.foo&apos;, &#92;&turn_utf_8_on;
      bind_textdomain_codeset &apos;org.bar.foo&apos;, &apos;utf-8&apos;;
  }
</pre>
<p>See the File GTestRunner.pm of <em>Test::Unit::GTestRunner</em>\|(3pm) for details.</p>
<h3>How do I interface Glade2 \s-1UI\s0 definitions with libintl-perl?</h3>
<p><em>Gtk2::GladeXML</em>\|(3pm) seems to ignore calls to <em>bind_textdomain()</em>. See the File GTestRunner.pm of <em>Test::Unit::GTestRunner</em>\|(3pm) for a possible solution.</p>
<h3>Why does Locale::TextDomain use a double underscore?  I am used to a single underscore from C or other languages.</h3>
<p>Function names that consist of exactly one non-alphanumerical character make the function automatically global in Perl.  Besides, in Perl 6 the concatenation operator will be the underscore instead of the dot.</p>
<h3>How do I switch languages or force a certain language independently from user settings read from the environment?</h3>
<p>The simple answer is:</p><p>    use POSIX qw (setlocale LC_ALL);</p><p>    my $language = &apos;fr&apos;;     my $country = &apos;FR&apos;;     my $charset = &apos;iso-8859-1&apos;;</p><p>    setlocale LC_ALL, "${language}_$country.$charset";</p><p>Sadly enough, this will fail in many cases.  The problem is that locale identifiers are not standardized and are completely system-dependent.  Not only their overall format, but also other details like case-sensitivity. Some systems are very forgiving about the system - for example normalizing charset descriptions - others very strict.  In order to be reasonably platform independent, you should try a list of possible locale identifiers for your desired settings.  This is about what I would try for achieving the above:</p><p>   my @tries = qw (         fr_FR.iso-8859-1 fr_FR.iso8859-1 fr_FR.iso88591         fr_FR.ISO-8859-1 fr_FR.ISO8859-1 fr_FR.ISO88591         fr.iso-8859-1 fr.iso8859-1 fr.iso88591         fr.ISO-8859-1 fr.ISO8859-1 fr.ISO88591         fr_FR         French_France.iso-8859-1 French_France.iso8859-1 French_France.iso88591         French_France.ISO-8859-1 French_France.ISO8859-1 French_France.ISO88591         French.iso-8859-1 French.iso8859-1 French.iso88591         French.ISO-8859-1 French.ISO8859-1 French.ISO88591    );    foreach my $try (@tries) {         last if setlocale LC_ALL, $try;    }</p><p>Set <em>Locale::Util</em>\|(3pm) for functions that help you with this.</p><p>Alternatively, you can force a certain language by setting the environment variables \s-1LANGUAGE\s0, \s-1LANG\s0 and \s-1OUTPUT_CHARSET\s0, but this is only guaranteed to work, if you use the pure Perl implementation of gettext (see the documentation for <em>select_package()</em> in <em>Locale::Messages</em>\|(3pm)). You would do the above like this:</p><p>    use Locale::Messages qw (nl_putenv);</p><p>    # LANGUAGE is a colon separated list of languages.     nl_putenv("LANGUAGE=fr_FR");</p><p>    # If LANGUAGE is set, LANG should be set to the primary language.     # This is not needed for gettext, but for other parts of the system     # it is.     nl_putenv("LANG=fr_FR");</p><p>    # Force an output charset like this:     nl_putenv("OUTPUT_CHARSET=iso-8859-1");</p><p>    setlocale (LC_MESSAGES, &apos;C&apos;);</p><p>These environment variables are \s-1GNU\s0 extensions, and they are also honored by libintl-perl.  Still, you should always try to set the locale with setlocale for the catch-all category \s-1LC_ALL\s0.  If you miss to do so, your program's output maybe cluttered, mixing languages and charsets, if the system runs in a locale that is not compatible with your own language settings.</p><p>Remember that these environment variables are not guaranteed to work, if you use an \s-1XS\s0 version of gettext.  In order to force usage of the pure Perl implementation, do the following:</p><p>    Locale::Messages-&gt;select_package (&apos;gettext_pp&apos;);</p><p>If you think, this is brain-damaged, you are right, but I cannot help you.  Actually there should be a more flexible \s-1API\s0 than setlocale, but at the time of this writing there isn't.  Until then, the recommentation goes like this:</p><p>        1) Try setting LC_ALL with Locale::Util.         2) If that does not succeed, either give up or ...         3) Reset LC_MESSAGES to C/POSIX.         4) Switch to pure Perl for gettext.         5) Set the environment variables LANGUAGE, LANG,            and OUTPUT_CHARSET to your desired values.</p>
<h3>What is the advantage of libintl-perl over Locale::Maketext?</h3>
<p>Of course, I can only give my personal opinion as an answer.</p><p>Locale::Maketext claims to fix design flaws in gettext.  These alleged design flaws, however, boil down to one pathological case which always has a workaround.  But both programmers and translators pay this fix with an unnecessarily complicated interface.</p><p>The paramount advantage of libintl-perl is that it uses an approved technology and concept.  Except for Java(tm) programs, this is the state-of-the-art concept for localizing Un*x software.  Programmers that have already localized software in C, \*(C+, C#, Python, \s-1PHP\s0, or a number of other languages will feel instantly at home, when localizing software written in Perl with libintl-perl.  The same holds true for the translators, because the files they deal with have exactly the same format as those for other programming languages. They can use the same set of tools, and even the commands they have to execute are the same.</p><p>With libintl-perl refactoring of the software is painless, even if you modify, add or delete translatable strings.  The gettext tools are powerful enough to reduce the effort of the translators to the bare minimum.  Maintaining the message catalogs of Locale::Maketext in larger scale projects, is \s-1IMHO\s0 unfeasible.</p><p>Editing the message catalogs of Locale::Maketext - they are really Perl modules - asks too much from most translators, unless they are programmers.  The portable object (po) files used by libintl-perl have a simple syntax, and there are a bunch of specialized \s-1GUI\s0 editors for these files, that facilitate the translation process and hide most complexity from the user.</p><p>Furthermore, libintl-perl makes it possible to mix programming languages without a paradigm shift in localization.  Without any special efforts, you can write a localized software that has modules written in C, modules in Perl, and builds a Gtk user interface with Glade. All translatable strings end up in one single message catalog.</p><p>Last but not least, the interface used by libintl-perl is plain simple:  Prepend translatable strings with a double underscore, and you are done in most cases.</p>
<h3>Why do single-quoted strings not work?</h3>
<p>You probably write something like this:</p><p>    print _\|_&apos;Hello&apos;;</p><p>And you get an error message like \*(L"Can't find string terminator \*(R"'\*(L" anywhere before \s-1EOF\s0 at ...\*(R", or even \*(L"Bareword found where operator expected at ... Might be a runaway multi-line '' string starting on\*(R".  The above line is (really!) essentially the same as writing:</p><p>    print _\|_::Hello&apos;;</p><p>A lesser know feature of Perl is that you can use a single quote (\*(L"'\*(R") as the separator in packages instead of the double colon (\*(L":\*(R").  What the Perl parser sees in the first example is a valid package name (\*(L"_\|_\*(R") followed by the separator (\*(L"'\*(R"), then another valid package name (\*(L"Hello\*(R") followed by a lone single quote.  It is therefore not a problem in libintl-perl but simple wrong Perl syntax.  You have to correct alternatives:</p><p>    print _\|_ &apos;Hello&apos;;   # Insert a space to disambiguate.</p><p>Or use double-quotes:</p><p>    print _\|_"Hello";</p><p>Thanks to Slavi Agafonkin for pointing me to the solution of this mystery.</p>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Locale::gettext_pp.3pm.html"><span aria-hidden="true">&larr;</span> Locale::gettext_pp.3pm: Pure perl implementation of uniforum message translation</a></li>
   <li class="next"><a href="LockFile::Simple.3pm.html">LockFile::Simple.3pm: Simple file locking scheme <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
