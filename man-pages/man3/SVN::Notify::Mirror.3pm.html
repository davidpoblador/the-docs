<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SVN::Notify::Mirror: Keep a mirrored working copy of a repository path</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Keep a mirrored working copy of a repository path">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="SVN::Notify::Mirror (3pm) manual">
  <meta name="twitter:description" content="Keep a mirrored working copy of a repository path">
  <meta name="twitter:image" content="https://www.carta.tech/images/libsvn-notify-mirror-perl-SVN::Notify::Mirror-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/SVN::Notify::Mirror.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="SVN::Notify::Mirror (3pm) manual" />
  <meta property="og:description" content="Keep a mirrored working copy of a repository path" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libsvn-notify-mirror-perl-SVN::Notify::Mirror-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">SVN::Notify::Mirror<small> (3pm)</small></h1>
        <p class="lead">Keep a mirrored working copy of a repository path</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/SVN::Notify::Mirror.3pm.html">
      <span itemprop="name">SVN::Notify::Mirror: Keep a mirrored working copy of a repository path</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libsvn-notify-mirror-perl/">
      <span itemprop="name">libsvn-notify-mirror-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/SVN::Notify::Mirror.3pm.html">
      <span itemprop="name">SVN::Notify::Mirror: Keep a mirrored working copy of a repository path</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>Use <em>svnnotify</em> in <em>post-commit</em>:</p>
<pre>
  svnnotify --repos-path "$1" --revision "$2" &#92;
   --handler Mirror --to "/path/to/www/htdocs" &#92;
   [--svn-binary /full/path/to/svn] &#92;
   [--tag-regex "regex"]
   [--minimal]
</pre>
<p>or better yet, use SVN::Notify::Config for a more sophisticated setup:</p><p>  #!/usr/bin/perl -MSVN::Notify::Config=$0   --- #YAML:1.0   &apos;&apos;:     PATH: "/usr/bin:/usr/local/bin"   &apos;path/in/repository&apos;:     handler: Mirror     minimal: 1     to: "/path/to/www/htdocs"   &apos;some/other/path/in/repository&apos;:     handler: Mirror     to: "/path/to/remote/www/htdocs"   &apos;some/project/tags&apos;:     handler: Mirror     to: "/path/to/another/dir"     tag-regex: "TRUNK-"</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Keep a directory in sync with a portion of a Subversion repository. Typically used to keep a development web server in sync with the changes made to the repository.  This directory can either be on the same box as the repository itself, or it can be remote (via \s-1SSH\s0 connection).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE</h2>
        <div class="sectioncontent">
<p>Depending on whether the target is a \*(L"Local Mirror\*(R" or a Remote Mirror, there are different options available.  All options are available either as a commandline option to svnnotify or as a hash key in SVN::Notify::Config (see their respective documentation for more details).</p><h3>Common Options</h3>
<p>In addition to all of the options available to svnnotify, there is a single global option that affects both \*(L"Local Mirror\*(R" and Remote Mirror targets:</p>
<dl class='dl-vertical'>
  <dt>
    minimal
  </dt>
  <dd>
    <p>If the \*(C`--minimal\*(C' flag is passed on the commandline (or a hash entry created in a config file), then the update will occur at the shortest common path of all files/dirs that are changed for that revision.  For example, using the example config file above, the following changes occured in rev 23:   Changed paths:     M path/in/repository/subdir/subdir2/file.1     A path/in/repository/subdir/file.2     M path/in/repository/subdir/subdir3/file.3 <strong>and</strong> the checked-out mirror was in \*(C`/path/to/www/htdocs\*(C', then the update would be executed in the \*(C`/path/to/www/htdocs/subdir\*(C' directory. This is the shorted common path of the updated files. \s-1NOTE:\s0 when using the SVN::Notify::Config mode, the matching path (in the above example \*(C`path/in/repository\*(C') is stripped off of the shortest common path prior to appending that to the destination path (the \*(C`to:\*(C' key).  It is assumed that a matching key is the \*(L"root\*(R" of the working copy.</p>
  </dd>

</dl>

<h3>Working Copy on Mirror</h3>
<p>Because 'svn export' is not able to be consistently updated, the sync'd directory must be a full working copy, and if you are running Apache, you should add lines like the following to your Apache configuration file:</p><p>  # Disallow browsing of Subversion working copy   # administrative directories.   &lt;DirectoryMatch "^/.*/&#92;.svn/"&gt;    Order deny,allow    Deny from all   &lt;/DirectoryMatch&gt;</p><p>The files in the working copy must be writeable (preferrably owned) by the user identity executing the hook script (this is the user identity that is running Apache or svnserve respectively).</p>
<h3>Local Mirror</h3>
<p>Used for directories local to the repository itself (\s-1NFS\s0 or other network mounted drives count).  The only required options are:</p><ul>
<li><p>handler = Mirror Specifies that this module is called to process the Notify event.</p></li><li><p>to = /path/to/working/copy Specified which directory should be updated.</p></li>
</ul>
<h3>Remote Mirror</h3>
<p>Used for mirrors on some other box, e.g. a web server in a \s-1DMZ\s0 network.  See SVN::Notify::Mirror::SSH or SVN::Notify::Mirror::Rsync for more details.  All \*(C`ssh-*\*(C' options are now deprecated in the base class and support for them will be removed in the next major release. Please update your configurations (see SVN::Notify::Mirror::SSH for details).</p>
<h3>Methods of Mirroring</h3>
<p>There are two schemes to keep a directory synced to a path in the repository:</p>
<dl class='dl-vertical'>
  <dt>
    1. Update a checked out working copy
  </dt>
  <dd>
    <p>This is the normal mode of operation and is commonly used to keep a test web server in sync with the repository on every commit.</p>
  </dd>
  <dt>
    2. Switch a working copy to a new tag
  </dt>
  <dd>
    <p>This is the preferred method when you want to keep a production web server up to date with only specific revisions, through the use of smart tagging.</p>
  </dd>

</dl>
<p>For the latter case, SVN::Notify::Mirror can be configured to monitor a path in the repository and only trigger an update when the path matches a specific regular expression, and do so by switching the mirrored path to the new tag.</p><ul>
<li><p>tag-regex This optional parameter works with any \*(L"Local Mirror\*(R" or \*(L"Remote Mirror\*(R", using any of the applicable transfer methods (currently local, \s-1SSH\s0, or Rsync).  The \*(C`--tag-regex\*(C' parameter takes a string which will be interpreted as a conventional Perl regex, and only those repository paths which match the regex will be updated.  The regex also determines what the mirrored directory will be switched to. For example, using a SVN::Notify::Config file (which is the most useful way to employ this option):   #!/usr/bin/perl -MSVN::Notify::Config=$0   --- #YAML:1.0   &apos;&apos;:     PATH: "/usr/bin:/usr/local/bin"   &apos;project1/trunk&apos;:     handler: Mirror     to: "/path/to/test/htdocs"   &apos;project1/tags&apos;:     handler: Mirror     to: "/path/to/production/htdocs"     tag-regex: "TRUNK-" This would have the effect of keeping the path \*(C`/path/to/test/htdocs\*(C' in sync on every commit, but \*(C`/path/to/production/htdocs\*(C' would be switched only when a tag was created in \*(C`project1/tags\*(C' that matched the string \*(C`TRUNK-\*(C'.  <strong>\s-1NOTE:\s0</strong> this is not a sophisticated regex; in particular you should not employ anchors, since the \s-1URL\s0 is not split into repos-root and path segments before testing. To initialize the switch directory, you must perform an initial checkout like this:  $ svn checkout file://$REPOS/project1/tags/TRUNK-0_0_1 where \*(C`TRUNK-0_0_1\*(C' is the name of any path in the \*(C`.../tags/\*(C' folder.</p></li>
</ul>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PREREQUISITES (Optional and otherwise)</h2>
        <div class="sectioncontent">
<p>The only mandatory prerequisite is SVN::Notify (obviously), but the presence of several other modules will enable other features:</p>
<dl class='dl-vertical'>
  <dt>
    SVN::Notify::Config
  </dt>
  <dd>
    <p>Permits a \s-1YAML\s0 config file to be used as the entire postcommit script, like the second example in the \s-1SYNOPSIS\s0 above.</p>
  </dd>
  <dt>
    Net::SSH
  </dt>
  <dd>
    <p>Required to use \s-1SSH\s0 to update a remote working copy.  See SVN::Notify::Mirror::SSH for usage of that transport method.</p>
  </dd>
  <dt>
    File::Rsync
  </dt>
  <dd>
    <p>Required to use rsync to update a remote working copy  See SVN::Notify::Mirror::RSync for usage of that transport method..</p>
  </dd>

</dl>
<p>If you install any of these modules after installing SVN::Notify::Mirror, those features will be available immediately (though you can rerun the install in order to see the tests).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>John Peacock &lt;jpeacock@cpan.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (c) 2005-2008 John Peacock</p><p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p><p>The full text of the license can be found in the \s-1LICENSE\s0 file included with this module.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO SVN::Notify::Mirror&hellip;</h2>
        <div class="sectioncontent">
<p>SVN::Notify, SVN::Notify::Config</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">POD ERRORS</h2>
        <div class="sectioncontent">
<p>Hey! <strong>The above document had some coding errors, which are explained below:</strong></p>
<dl class='dl-vertical'>
  <dt>
    Around line 275:
  </dt>
  <dd>
    <p>You forgot a '=back' before '=head2'</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="SVG::Graph::Glyph::wedge.3pm.html"><span aria-hidden="true">&larr;</span> SVG::Graph::Glyph::wedge.3pm: Svg::graph::glyph::wedge object</a></li>
   <li class="next"><a href="SVN::Notify::Mirror::ConfigData.3pm.html">SVN::Notify::Mirror::ConfigData.3pm: Configuration for svn::notify::mirror <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
