<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Sub::Uplevel: Apparently run a function in a higher stack frame</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Apparently run a function in a higher stack frame">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Sub::Uplevel (3pm) manual">
  <meta name="twitter:description" content="Apparently run a function in a higher stack frame">
  <meta name="twitter:image" content="https://www.carta.tech/images/libsub-uplevel-perl-Sub::Uplevel-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Sub::Uplevel.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Sub::Uplevel (3pm) manual" />
  <meta property="og:description" content="Apparently run a function in a higher stack frame" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libsub-uplevel-perl-Sub::Uplevel-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Sub::Uplevel<small> (3pm)</small></h1>
        <p class="lead">Apparently run a function in a higher stack frame</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Sub::Uplevel.3pm.html">
      <span itemprop="name">Sub::Uplevel: Apparently run a function in a higher stack frame</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libsub-uplevel-perl/">
      <span itemprop="name">libsub-uplevel-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Sub::Uplevel.3pm.html">
      <span itemprop="name">Sub::Uplevel: Apparently run a function in a higher stack frame</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>version 0.24</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use Sub::Uplevel;

  sub foo {
      print join " - ", caller;
  }

  sub bar {
      uplevel 1, &#92;&foo;
  }

  #line 11
  bar();    # main - foo.plx - 11
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Like Tcl's <em>uplevel()</em> function, but not quite so dangerous.  The idea is just to fool <em>caller()</em>.  All the really naughty bits of Tcl's <em>uplevel()</em> are avoided.</p><p><strong>\s-1THIS\s0 \s-1IS\s0 \s-1NOT\s0 \s-1THE\s0 \s-1SORT\s0 \s-1OF\s0 \s-1THING\s0 \s-1YOU\s0 \s-1WANT\s0 \s-1TO\s0 \s-1DO\s0 \s-1EVERYDAY\s0</strong></p>
<dl class='dl-vertical'>
  <dt>
    <strong>uplevel</strong>
  </dt>
  <dd>
    <p>  uplevel $num_frames, &#92;&func, @args; Makes the given function think it's being executed $num_frames higher than the current stack level.  So when they use caller($frames) it will actually give caller($frames + $num_frames) for them. \*(C`uplevel(1, &#92;&some_func, @_)\*(C' is effectively \*(C`goto &some_func\*(C' but you don't immediately exit the current subroutine.  So while you can't do this:     sub wrapper {         print "Before&#92;n";         goto &some_func;         print "After&#92;n";     } you can do this:     sub wrapper {         print "Before&#92;n";         my @out = uplevel 1, &some_func;         print "After&#92;n";         return @out;     } \*(C`uplevel\*(C' has the ability to issue a warning if $num_frames is more than the current call stack depth, although this warning is disabled and compiled out by default as the check is relatively expensive. To enable the check for debugging or testing, you should set the global $Sub::Uplevel::CHECK_FRAMES to true before loading Sub::Uplevel for the first time as follows:     #!/usr/bin/perl</p><p>    BEGIN {         $Sub::Uplevel::CHECK_FRAMES = 1;     }     use Sub::Uplevel; Setting or changing the global after the module has been loaded will have no effect.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>The main reason I wrote this module is so I could write wrappers around functions and they wouldn't be aware they've been wrapped.</p><p>    use Sub::Uplevel;</p><p>    my $original_foo = &#92;&foo;</p><p>    *foo = sub {         my @output = uplevel 1, $original_foo;         print "foo() returned:  @output";         return @output;     };</p><p>If this code frightens you <strong>you should not use this module.</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS and CAVEATS</h2>
        <div class="sectioncontent">
<p>Well, the bad news is <em>uplevel()</em> is about 5 times slower than a normal function call.  \s-1XS\s0 implementation anyone?  It also slows down every invocation of <em>caller()</em>, regardless of whether <em>uplevel()</em> is in effect.</p><p>Sub::Uplevel overrides CORE::GLOBAL::caller temporarily for the scope of each uplevel call.  It does its best to work with any previously existing CORE::GLOBAL::caller (both when Sub::Uplevel is first loaded and within each uplevel call) such as from Contextual::Return or Hook::LexWrap.</p><p>However, if you are routinely using multiple modules that override CORE::GLOBAL::caller, you are probably asking for trouble.</p><p>You <strong>should</strong> load Sub::Uplevel as early as possible within your program.  As with all \s-1CORE::GLOBAL\s0 overloading, the overload will not affect modules that have already been compiled prior to the overload.  One module that often is unavoidably loaded prior to Sub::Uplevel is Exporter.  To forcibly recompile Exporter (and Exporter::Heavy) after loading Sub::Uplevel, use it with the \*(L":aggressive\*(R" tag:</p><p>    use Sub::Uplevel qw/:aggressive/;</p><p>The private function \*(C`Sub::Uplevel::_force_reload()\*(C' may be passed a list of additional modules to reload if \*(L":aggressive\*(R" is not aggressive enough. Reloading modules may break things, so only use this as a last resort.</p><p>As of version 0.20, Sub::Uplevel requires Perl 5.6 or greater.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">
<p>Those who do not learn from \s-1HISTORY\s0 are doomed to repeat it.</p><p>The lesson here is simple:  Don't sit next to a Tcl programmer at the dinner table.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THANKS</h2>
        <div class="sectioncontent">
<p>Thanks to Brent Welch, Damian Conway and Robin Houston.</p><p>See http://www.perl.com/perl/misc/Artistic.html</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Sub::Uplevel&hellip;</h2>
        <div class="sectioncontent">
<p>PadWalker (for the similar idea with lexicals), Hook::LexWrap, Tcl's <em>uplevel()</em> at http://www.scriptics.com/man/tcl8.4/TclCmd/uplevel.htm</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SUPPORT</h2>
        <div class="sectioncontent">
<h3>Bugs / Feature Requests</h3>
<p>Please report any bugs or feature requests through the issue tracker at http://rt.cpan.org/Public/Dist/Display.html?Name=Sub-Uplevel &lt;http://rt.cpan.org/Public/Dist/Display.html?Name=Sub-Uplevel&gt;. You will be notified automatically of any progress on your issue.</p>
<h3>Source Code</h3>
<p>This is open source software.  The code repository is available for public review and contribution under the terms of the license.</p><p>https://github.com/dagolden/sub-uplevel &lt;https://github.com/dagolden/sub-uplevel&gt;</p><p>  git clone https://github.com/dagolden/sub-uplevel.git</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<ul>
<li><p>Michael Schwern &lt;mschwern@cpan.org&gt;</p></li><li><p>David Golden &lt;dagolden@cpan.org&gt;</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT AND LICENSE</h2>
        <div class="sectioncontent">
<p>This software is copyright (c) 2012 by Michael Schwern and David Golden.</p><p>This is free software; you can redistribute it and/or modify it under the same terms as the Perl 5 programming language system itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Sub::Delete.3pm.html"><span aria-hidden="true">&larr;</span> Sub::Delete.3pm: Perl module enabling one to delete subroutines</a></li>
   <li class="next"><a href="Sub::WrapPackages.3pm.html">Sub::WrapPackages.3pm: Add pre- and post-execution wrappers around all the subroutines in packages or around individual subs <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
