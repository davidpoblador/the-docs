<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DateTime::Format::Duration: Format and parse datetime::durations</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Format and parse datetime::durations">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="DateTime::Format::Duration (3pm) manual">
  <meta name="twitter:description" content="Format and parse datetime::durations">
  <meta name="twitter:image" content="https://www.carta.tech/images/libdatetime-format-duration-perl-DateTime::Format::Duration-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/DateTime::Format::Duration.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="DateTime::Format::Duration (3pm) manual" />
  <meta property="og:description" content="Format and parse datetime::durations" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libdatetime-format-duration-perl-DateTime::Format::Duration-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">DateTime::Format::Duration<small> (3pm)</small></h1>
        <p class="lead">Format and parse datetime::durations</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/DateTime::Format::Duration.3pm.html">
      <span itemprop="name">DateTime::Format::Duration: Format and parse datetime::durations</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libdatetime-format-duration-perl/">
      <span itemprop="name">libdatetime-format-duration-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/DateTime::Format::Duration.3pm.html">
      <span itemprop="name">DateTime::Format::Duration: Format and parse datetime::durations</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
        use DateTime::Format::Duration;

        $d = DateTime::Format::Duration-&gt;new(
                pattern =&gt; &apos;%Y years, %m months, %e days, &apos;.
                                &apos;%H hours, %M minutes, %S seconds&apos;
        );

        print $d-&gt;format_duration(
                DateTime::Duration-&gt;new(
                        years   =&gt; 3,
                        months  =&gt; 5,
                        days    =&gt; 1,
                        hours   =&gt; 6,
                        minutes =&gt; 15,
                        seconds =&gt; 45,
                        nanoseconds =&gt; 12000
                )
        );
        # 3 years, 5 months, 1 days, 6 hours, 15 minutes, 45 seconds


        $duration = $d-&gt;parse_duration(
                &apos;3 years, 5 months, 1 days, 6 hours, 15 minutes, 45 seconds&apos;
        );
        # Returns DateTime::Duration object


        print $d-&gt;format_duration_from_deltas(
                years   =&gt; 3,
                months  =&gt; 5,
                days    =&gt; 1,
                hours   =&gt; 6,
                minutes =&gt; 15,
                seconds =&gt; 45,
                nanoseconds =&gt; 12000
        );
        # 3 years, 5 months, 1 days, 6 hours, 15 minutes, 45 seconds

        %deltas = $d-&gt;parse_duration_as_deltas(
                &apos;3 years, 5 months, 1 days, 6 hours, 15 minutes, 45 seconds&apos;
        );
        # Returns hash:
        # (years=&gt;3, months=&gt;5, days=&gt;1, hours=&gt;6, minutes=&gt;15, seconds=&gt;45)
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ABSTRACT</h2>
        <div class="sectioncontent">
<p>This module formats and parses DateTime::Duration objects as well as other durations representations.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONSTRUCTOR</h2>
        <div class="sectioncontent">
<p>This module contains a single constructor:</p><ul>
<li><p>\*(C`new( ... )\*(C' The \*(C`new\*(C' constructor takes the following attributes:</p><ul>
<li><p>\*(C`pattern =\*(C' $string&gt; This is a strf type pattern detailing the format of the duration. See the \*(L"Patterns\*(R" sections below for more information.</p></li><li><p>\*(C`&lt;normalise =\*(C' $one_or_zero_or_ISO&gt;&gt;</p></li><li><p>\*(C`&lt;normalize =\*(C' $one_or_zero_or_ISO&gt;&gt; This determines whether durations are 'normalised'. For example, does 120 seconds become 2 minutes? Setting this value to true without also setting a \*(C`base\*(C' means we will normalise without a base. See the \*(L"Normalising without a base\*(R" section below.</p></li><li><p>\*(C`&lt;base =\*(C' $datetime_object&gt;&gt; If a base DateTime is given then that is the normalisation date. Setting this attribute overrides the above option and sets normalise to true.</p></li>
</ul></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>DateTime::Format::Duration has the following methods:</p><ul>
<li><p>\*(C`format_duration( $datetime_duration_object )\*(C'</p></li><li><p>\*(C`&lt;format_duration( duration =\*(C' $dt_duration, pattern =&gt; $pattern )&gt;&gt; Returns a string representing a DateTime::Duration object in the format set by the pattern. If the first form is used, the pattern is taken from the object. If the object has no pattern then this method will croak.</p></li><li><p>\*(C`format_duration_from_deltas( %deltas )\*(C'</p></li><li><p>\*(C`format_duration_from_deltas( %deltas, pattern =\*(C' $pattern )&gt; As above, this method returns a string representing a duration in the format set by the pattern. However this method takes a hash of values. Permissable hash keys are \*(C`years, months, days, hours, minutes, seconds\*(C' and \*(C`nanoseconds\*(C' as well as \*(C`negative\*(C' which, if true, inverses the duration. (\*(C`years =&gt; -1\*(C' is the same as \*(C`years =&gt; 1, negative=&gt;1\*(C')</p></li><li><p>\*(C`parse_duration( $string )\*(C' This method takes a string and returns a DateTime::Duration object that is the equivalent according to the pattern.</p></li><li><p>\*(C`parse_duration_as_deltas( $string )\*(C' Once again, this method is the same as above, however it returns a hash rather than an object.</p></li><li><p>\*(C`normalise( $duration_object )\*(C'</p></li><li><p>\*(C`normalize( %deltas )\*(C' Returns a hash of deltas after normalising the input. See the \*(L"\s-1NORMALISE\s0\*(R" section below for more information.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ACCESSORS</h2>
        <div class="sectioncontent">
<ul>
<li><p>\*(C`pattern()\*(C' Returns the current pattern.</p></li><li><p>\*(C`base()\*(C' Returns the current base.</p></li><li><p>\*(C`normalising()\*(C' Indicates whether or not the durations are being normalised.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SETTERS</h2>
        <div class="sectioncontent">
<p>All setters return the object so that they can be strung together.</p><ul>
<li><p>\*(C`set_pattern( $new_pattern )\*(C' Sets the pattern and returns the object.</p></li><li><p>\*(C`set_base( $new_DateTime )\*(C' Sets the base DateTime and returns the object.</p></li><li><p>\*(C`set_normalising( $true_or_false_or_ISO )\*(C' Turns normalising on or off and returns the object.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<h3>Patterns</h3>
<p>This module uses a similar set of patterns to strftime. These patterns have been kept as close as possible to the original time-based patterns.</p><ul>
<li><p>%C The number of hundreds of years in the duration. 400 years would return 4. This is similar to centuries.</p></li><li><p>%d The number of days zero-padded to two digits. 2 days returns 02. 22 days returns 22 and 220 days returns 220.</p></li><li><p>%e The number of days.</p></li><li><p>%F Equivelent of %Y-%m-%d</p></li><li><p>%H The number of hours zero-padded to two digits.</p></li><li><p>%I Same as %H</p></li><li><p>%j The duration expressed in whole days. 36 hours returns 1</p></li><li><p>%k The hours without any padding</p></li><li><p>%l Same as %k</p></li><li><p>%m The months, zero-padded to two digits</p></li><li><p>%M The minutes, zero-padded to two digits</p></li><li><p>%n A linebreak when formatting and any whitespace when parsing</p></li><li><p>%N Nanoseconds - see note on precision at end</p></li><li><p>%p Either a '+' or a '-' indicating the positive-ness of the duration</p></li><li><p>%P A '-' for negative durations and nothing for positive durations.</p></li><li><p>%r Equivelent of %H:%M:%S</p></li><li><p>%R Equivelent of %H:%M</p></li><li><p>%s Returns the value as seconds. 1 day, 5 seconds return 86405</p></li><li><p>%S Returns the seconds, zero-padded to two digits</p></li><li><p>%t A tab character when formatting or any whitespace when parsing</p></li><li><p>%T Equivelent of %P%H:%M:%S</p></li><li><p>%u Days after weeks are removed. 4 days returns 4, but 22 days returns 1 (22 days is three weeks, 1 day)</p></li><li><p>%V Duration expressed as weeks. 355 days returns 52.</p></li><li><p>%W Duration expressed as floating weeks. 10 days, 12 hours returns 1.5 weeks.</p></li><li><p>%y Years in the century. 145 years returns 45.</p></li><li><p>%Y Years, zero-padded to four digits</p></li><li><p>%% A '%' symbol</p></li>
</ul><p><strong>Precision</strong> can be changed for any and all the above values. For all but nanoseconds (%N), the precision is the zero-padding. To change the precision insert a number between the '%' and the letter. For example: 1 year formatted with %6Y would return 000001 rather than the default 0001. Likewise, to remove padding %1Y would just return a 1.</p><p>Nanosecond precision is the other way (nanoseconds are fractional and thus should be right padded). 123456789 nanoseconds formatted with %3N would return 123 and formatted as %12N would return 123456789000.</p>
<h3>Normalisation</h3>
<p>This module contains a complex method for normalising durations. The method ensures that the vslues for all components are as close to zero as possible. Rather than returning 68 minutes, it is normalised to 1 hour, 8 minutes.</p><p>The complexity comes from three places:</p><ul>
<li><p>Mixed positive and negative components The duration of 1 day, minus 2 hours is easy to normalise in your head to 22 hours. However consider something more complex such as -2 years, +1 month, +22 days, +11 hours, -9 minutes. This module works from lowest to highest precision to calculate the duration. So, based on a \*(C`base\*(C' of 2004-03-28T00:00:00 the following transformations take place:         2003-01-01T00:00:00 - 2 years   = 2001-01-01T00:00:00 === -2 years         2001-01-01T00:00:00 + 1 month   = 2001-02-01T00:00:00 === -1 year, 11 months         2001-02-01T00:00:00 + 22 days   = 2001-02-23T00:00:00 === -1yr, 10mths, 6days         2001-02-22T00:00:00 + 11 hours  = 2001-02-23T11:00:00 === -1y, 10m, 6d, 13h         2001-02-22T11:00:00 - 9 minutes = 2001-02-23T10:51:00 === -1y, 10m, 6d, 13h, 9m See: http://search.cpan.org/src/RICKM/DateTime-Format-Duration-1.0002/docs/figure1.gif Figure 1 illustrates that, with the given base, -2 years, +1 month, +22 days, +11 hours, -9 minutes is normalised to -1 year, 10 months, 6 days, 13 hours and 9 minutes.</p></li><li><p>Months of unequal length. Unfortunately months can have 28, 29, 30 or 31 days and it can change from year to year. Thus if I wanted to normalise 2 months it could be any of 59 (Feb-Mar), 60 (Feb-Mar in a leap year), 61 (Mar-Apr, Apr-May, May-Jun, Jun-Jul, Aug-Sep, Sep-Oct, Oct-Nov or Nov-Dec) or 62 days (Dec-Jan or Jul-Aug). Because of this the module uses a base datetime for its calculations. If we use the base 2003-01-01T00:00:00 then two months would be 59 days (2003-03-01 - 2003-01-01)</p></li><li><p>The order of components Components will always be assessed from lowest to highest precision (years, months, days, hours, minutes, seconds, nanoseconds). This can really change things. Consider the duration of 1 day, 24 hours. Normally this will normalise to 2 days. However, consider changes to Daylight Savings. On the changes to and from \s-1DST\s0 days have 25 and 23 hours. If we take the base DateTime as midnight on the day \s-1DST\s0 ends (when there's 25 hours in the day), and add 1 day, 24 hours we end up at midnight 2 days later. So our duration normalises to two days. However, if we add 24 hours, 1 day we end up at 11pm on the next day! Why is this? Because midnight + 24 hours = 11pm (there's 25 hours on this day!), then we add 1 day and end up at 11pm on the following day. See: http://search.cpan.org/src/RICKM/DateTime-Format-Duration-1.0002/docs/figure2.gif Figure 2 illustrates the above problem on timelines.</p></li><li><p>Leap years and leap seconds Leap years and seconds further add to the confusion in normalisation. Leap seconds mean there are minutes that are 61 seconds long, thus 130 seconds can be 2 minutes, 10 seconds or 2 minutes 9 seconds, depending on the base DateTime. Simmilarly leap years mean a day can have 23, 24 or 25 hours. See: http://search.cpan.org/src/RICKM/DateTime-Format-Duration-1.0002/docs/figure3.gif Figure 3 shows how leaps are calculated on timelines.</p></li>
</ul>
<h3>Normalising without a base</h3>
<p>This module includes two ways to normalise without a base.</p><ul>
<li><p>Standard Normalisation Using standard normalisation without a base, 45 days will stay as 45 days as there is no way to accurately convert to months. However the following assumptions will be made: There are 24 hours in a day and there are 60 seconds in a minute.</p></li><li><p>\s-1ISO\s0 Normalisation In ISO8601v2000, Section 5.5.3.2 says that \*(L"The values used must not exceed the 'carry-over points' of 12 months, 30 days, 24 hours, 60 minutes and 60 seconds\*(R". Thus if you set the normalise option of the constructor, or use set_normalising to '\s-1ISO\s0', months will be normalised to 30 days.</p></li>
</ul>
<h3>Deltas vs Duration Objects</h3>
<p>This module can bypass duration objects and just work with delta hashes. This used to be of greatest value with earlier versions of DateTime::Duration when DateTime::Duration assumed a duration with one negative component was a negative duration (that is, -2 hours, 34 minutes was assumed to be -2 hours, -34 minutes).</p><p>These extra methods have been left in here firstly for backwards-compatibility but also as an added 'syntactic sugar'. Consider these two equivelent expressions:</p><p>        $one = $o-&gt;format_duration(                 DateTime::Duration-&gt;new(                         years =&gt; -2,                         days  =&gt; 13,                         hours =&gt; -1                 )         );</p><p>        $two = $o-&gt;format_duration_from_deltas(                 years =&gt; -2,                 days  =&gt; 13,                 hours =&gt; -1         );</p><p>These both create the same string in $one and $two, but if you don't already have a DateTime::Duration object, the later looks cleaner.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Rick Measham &lt;rickm@cpan.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (c) 2003 - 2004 Rick Measham.  All rights reserved.  This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p><p>The full text of the license can be found in the \s-1LICENSE\s0 file included with this module.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO DateTime::Format::Duration&hellip;</h2>
        <div class="sectioncontent">
<p>datetime@perl.org mailing list</p><p>http://datetime.perl.org/</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="DateTime::Format::DateParse.3pm.html"><span aria-hidden="true">&larr;</span> DateTime::Format::DateParse.3pm: Parses date::parse compatible formats</a></li>
   <li class="next"><a href="DateTime::Format::Epoch.3pm.html">DateTime::Format::Epoch.3pm: Convert datetimes to/from epoch seconds <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
