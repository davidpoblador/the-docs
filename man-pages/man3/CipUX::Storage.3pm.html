<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CipUX::Storage: Storage abstraction layer for cipux</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Storage abstraction layer for cipux">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="CipUX::Storage (3pm) manual">
  <meta name="twitter:description" content="Storage abstraction layer for cipux">
  <meta name="twitter:image" content="https://www.carta.tech/images/libcipux-storage-perl-CipUX::Storage-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/CipUX::Storage.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="CipUX::Storage (3pm) manual" />
  <meta property="og:description" content="Storage abstraction layer for cipux" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libcipux-storage-perl-CipUX::Storage-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">CipUX::Storage<small> (3pm)</small></h1>
        <p class="lead">Storage abstraction layer for cipux</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/CipUX::Storage.3pm.html">
      <span itemprop="name">CipUX::Storage: Storage abstraction layer for cipux</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libcipux-storage-perl/">
      <span itemprop="name">libcipux-storage-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/CipUX::Storage.3pm.html">
      <span itemprop="name">CipUX::Storage: Storage abstraction layer for cipux</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>version 3.4.0.2</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use CipUX::Storage;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The CipUX Storage abstraction layer is a generic abstract class, which can be used to access \s-1LDAP\s0 servers via Perl by issuing simple actions and via shell command line interface. It was tested with openLDAP version 3. The layer is capable of operating on different sets of \s-1LDAP\s0 nodes. A set of nodes might be defined by an \s-1LDAP\s0 objectClass or \s-1LDAP\s0 attribute. Example: cipuxAccount or posixAccount.  The number of objects inside a set might be ranged from one to many. The abstraction layer performs a method on a set of nodes. Valid methods are: 'get', 'set', 'get-all', 'set-all' on \s-1LDAP\s0 attribute values and  'add', 'delete', 'rename' on \s-1LDAP\s0 nodes.</p><p>It provides the functions get_value, set_value to modify \s-1LDAP\s0 attribute values. The function add_node, delete_node and rename_node for adding, deleting and renaming \s-1LDAP\s0 objects.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SUBROUTINES/METHODS</h2>
        <div class="sectioncontent">
<p>The following functions will be exported by CipUX::Storage.</p><h3>\s-1BUILD\s0</h3>
<p>This is the constructor, see new.</p><p>  use CipUX::Storage;</p><p>  use base qw(CipUX::Storage);</p><p>  my $storage = CipUX::Storage-&gt;new();</p>
<h3>\s-1DEMOLISH\s0</h3>
<p>This is the destructor.</p>
<h3>get_value</h3>
<p>The get_value queries the \s-1LDAP\s0 and returns one ore more values depending on the parameter 'scope'.</p><p><strong>Syntax:</strong></p><p>  eval {</p><p>      my $object    = &apos;ckuelker&apos;;       my $attribute = &apos;cipuxFirstname&apos;;       my $type      = &apos;all_user_node&apos;;       $value_hr = $ldap-&gt;get_value({                                        scope=&gt;&apos;one&apos;,                                        type=&gt;$type,                                        obj=&gt;$object,                                        attr_ar=&gt;[$attribute]                                       });   } or croak "ERROR: can&apos;t get value: $@!" if $@;</p><p>returns one value:</p><p>    %$ret_hr = (               &apos;ckuelker&apos; =&gt; {                                &apos;cipuxFirstname&apos; =&gt; [&apos;Christian&apos;],                             }                 );</p><p>  eval {</p><p>      my $object    = &apos;&apos;;       my $attribute = &apos;cipuxFirstname&apos;;       my $type      = &apos;all_user_node&apos;;       $value_hr = $ldap-&gt;get_value({                                        scope=&gt;&apos;all&apos;,                                        type=&gt;$type,                                        obj=&gt;$object,                                        attr_ar=&gt;[$attribute]                                       });   } or croak "ERROR: can&apos;t get value: $@!" if $@;</p><p>  %$ret_hr = (               &apos;ckuelker&apos; =&gt; {                                &apos;cipuxFirstname&apos; =&gt; [&apos;Christian&apos;],                                &apos;cipuxLastname&apos; =&gt;  [&apos;Kuelker&apos;],                             },               &apos;xoswald&apos; =&gt; {                                &apos;cipuxFirstname&apos; =&gt; [&apos;Xavier&apos;],                                &apos;cipuxLastname&apos; =&gt;  [&apos;Oswald&apos;],                             },</p><p>          );</p><p><em>Return values</em></p><p>    %ret = (               &apos;ckuelker&apos; =&gt; {                                &apos;cipuxFirstname&apos; =&gt; [&apos;Christian&apos;],                                &apos;cipuxLastname&apos; =&gt;  [&apos;Kuelker&apos;],                             }</p>
<h3>set_value</h3>
<p>Sets a value for a given object in the \s-1LDAP\s0 database.</p><p> my $rslt = set_value( {      obj=&gt;$obj,      attr_ar=&gt;$attr_ar,      changes=&gt;$changes,      scope=&gt;$scope,      escope=&gt;$escope,      type=&gt;$type  } ;</p><p>     obj:      object      attr_ar:  reference to an array of LDAP attributes and values      changes:      scope:    &apos;one|all&apos;        set/modify value      escope:   &apos;one|all|none&apos;   erase scope      type:</p><p><em>Modify Syntax</em></p><p>        my $msg = $ldap-&gt;modify( $dn,                                    changes =&gt; [                                        # add sn=Baggins                                      add     =&gt; [ sn =&gt; &apos;Baggins&apos; ],                                        # delete all fax numbers                                      delete  =&gt; [ faxNumber =&gt; []],                                        # delete phone number 911                                      delete  =&gt; [ telephoneNumber =&gt; [&apos;911&apos;]],                                        # change email address                                      replace =&gt; [ mail =&gt; &apos;bilbo@baggins.org&apos;]                                    ]                                  );</p>
<h3>add_node</h3>
<p>Adds an \s-1LDAP\s0 node to the \s-1LDAP\s0 database.</p><p> my $rslt = $cipux-&gt;add_node({obj=&gt;$obj, type=&gt;$type, attr_hr=&gt;$attr_hr});</p><p> obj :    The object to be added  type:    kind of object to be added  attr_hr: Hash reference with &apos;ldap_attribute=&gt;value&apos; structure</p><p> $rslt:   is the reslult from Net::LDAP add</p>
<h3>delete_node</h3>
<p>Deletes an \s-1LDAP\s0 node from the \s-1LDAP\s0 database.</p><p> my $rslt = $cipux-&gt;delete_node( { obj=&gt;$obj, type=&gt;$type } );</p><p> obj :    The object to be added  type:    kind of object to be added</p><p> $rslt:   is the result from Net::LDAP delete</p>
<h3>rename_node</h3>
<p>Rename an \s-1LDAP\s0 node of the \s-1LDAP\s0 database.</p><p> my $rslt = $cipux-&gt;rename_node({obj=&gt;$obj, type=&gt;$type, value=&gt;$value });</p><p> obj :    The object to be added  type:    kind of object to be added  value:   The new name</p><p> $rslt:   is the result from Net::LDAP rename</p>
<h3>_ldap_start</h3>
<p>Binds to the \s-1LDAP\s0 server.</p><p> my %access        = ();  $access_cfg{ident $self}-&gt;{uri}      = &apos;ldap://localhost&apos;;  $access_cfg{ident $self}-&gt;{bind_dn}  = &apos;cn=admin,dc=nodomain&apos;;  $access_cfg{ident $self}-&gt;{password} = &apos;secret&apos;;  my $ldap = $cipux-&gt;_ldap_start();</p><p> $ldap:   is the LDAP Perl object returned from Net::LDAP.</p>
<h3>_ldap_start</h3>
<p>Unbinds from the \s-1LDAP\s0 server.</p><p> my $msg = $cipux-&gt;_ldap_end( { ldap=&gt;$ldap} );</p><p> $msg:   is the message returned from Net::LDAP.</p>
<h3>list_storage_type</h3>
<p>Lists all CipUX \s-1LDAP\s0 nodes entities, sorted.</p><p> my $list_ar = $cipux-&gt;list_type( { ldap=&gt;$ldap} );</p><p> $list_ar:   reference to an array of sorted CipUX LDAP entities.</p>
<h3>_ldap_struct</h3>
<p>Parses cipux-storage.perl with for object, type, filter of a given scope. It also performs some simple validation of that file.</p><p> my $ldap_structure_hr = $cipux-&gt;_ldap_struct( {      obj=&gt;$obj,      type=&gt;$type,      scope=&gt;$scope,      filter=&gt;$filter  });</p><p> $ldap_structure_hr: returns a structure hash reference</p>
<h3>oid_number_supremum</h3>
<p>Searches the storage database for uidNumber and gidNumber. It returns the one number above the largest number or the minimum number in the number range for users and groups.</p><p>To perform the search it uses get_value (the storage layer itself).</p>
<h3>get_sid</h3>
<p>Retrieve sambaSID and return it if successful</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Configuration files</h2>
        <div class="sectioncontent">
<h3>cipux-access.ini</h3>
<p>The CipUX access configuration has the following entries:</p><p> [ldap]  uri      = ldaps://ldap  bind_dn  = cn=cipuxroot,dc=nodomain  base_dn  = ou=CipUX,dc=nodomain  password = secret  system   = debian  customer =</p>
<h3>cipux_storage.perl</h3>
<p>The storage structure configuration might look like this:</p><p>    $cfg = {         &apos;structure&apos; =&gt; {                 all_group_node =&gt; {                     desc         =&gt; &apos;access to all CN group objects&apos;,                     struc_rdn    =&gt; &apos;ou=Group&apos;,                     dn_attr      =&gt; &apos;cn&apos;,                     filter       =&gt; &apos;(cn=?)&apos;,                 },                 all_user_node =&gt; {                     desc         =&gt; &apos;access to all system UID objects&apos;,                     struc_rdn    =&gt; &apos;ou=User&apos;,                     dn_attr      =&gt; &apos;uid&apos;,                     filter       =&gt; &apos;(uid=?)&apos;,                 },                 course_group_node =&gt; {                     desc         =&gt; &apos;access to all system GID objects&apos;,                     struc_rdn    =&gt; &apos;ou=Group&apos;,                     dn_attr      =&gt; &apos;cn&apos;,                     filter       =&gt; &apos;&(cn=?)(groupType=public)&apos;,                 },             }, }</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">
<p>\s-1TODO\s0</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION AND ENVIRONMENT</h2>
        <div class="sectioncontent">
<p>See cipux-access.ini and cipux-storage.perl man page for details on configuration. CipUX::Storage do not use the environment for configuration.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DEPENDENCIES</h2>
        <div class="sectioncontent">
<p> Carp  Class::Std  CipUX  Data::Dumper  English  Net::LDAP  Log::Log4perl  Readonly  utf8  version</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INCOMPATIBILITIES</h2>
        <div class="sectioncontent">
<p>Not known.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS AND LIMITATIONS</h2>
        <div class="sectioncontent">
<p>Not known.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO CipUX::Storage&hellip;</h2>
        <div class="sectioncontent">
<p>See the CipUX web page and the manual at &lt;http://www.cipux.org&gt;</p><p>See the mailing list http://sympa.cipworx.org/wws/info/cipux-devel &lt;http://sympa.cipworx.org/wws/info/cipux-devel&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Christian Kuelker  &lt;christian.kuelker@cipworx.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE AND COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (C) 2007 - 2009 by Christian Kuelker</p><p>This program is free software; you can redistribute it and/or modify it under the terms of the \s-1GNU\s0 General Public License as published by the Free Software Foundation; either version 2, or (at your option) any later version.</p><p>This program is distributed in the hope that it will be useful, but \s-1WITHOUT\s0 \s-1ANY\s0 \s-1WARRANTY\s0; without even the implied warranty of \s-1MERCHANTABILITY\s0 or \s-1FITNESS\s0 \s-1FOR\s0 A \s-1PARTICULAR\s0 \s-1PURPOSE\s0.  See the \s-1GNU\s0 General Public License for more details.</p><p>You should have received a copy of the \s-1GNU\s0 General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, \s-1MA\s0 02111-1307 \s-1USA\s0</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="CipUX::RPC::Test::Client.3pm.html"><span aria-hidden="true">&larr;</span> CipUX::RPC::Test::Client.3pm: Libray for test clients</a></li>
   <li class="next"><a href="CipUX::Storage::Client.3pm.html">CipUX::Storage::Client.3pm: Command line client library for cipux-storage <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
