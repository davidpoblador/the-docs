<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>curl_multi_socket: Reads/writes available data</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Reads/writes available data">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="curl_multi_socket (3) manual">
  <meta name="twitter:description" content="Reads/writes available data">
  <meta name="twitter:image" content="https://www.carta.tech/images/libcurl4-doc-curl_multi_socket-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/curl_multi_socket.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="curl_multi_socket (3) manual" />
  <meta property="og:description" content="Reads/writes available data" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libcurl4-doc-curl_multi_socket-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">curl_multi_socket<small> (3)</small></h1>
        <p class="lead">Reads/writes available data</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/curl_multi_socket.3.html">
      <span itemprop="name">curl_multi_socket: Reads/writes available data</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libcurl4-doc/">
      <span itemprop="name">libcurl4-doc</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/curl_multi_socket.3.html">
      <span itemprop="name">curl_multi_socket: Reads/writes available data</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
#include &lt;curl/curl.h&gt;
CURLMcode curl_multi_socket(CURLM * multi_handle, curl_socket_t sockfd,
                            int *running_handles);

CURLMcode curl_multi_socket_all(CURLM *multi_handle,
                                int *running_handles);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>These functions are deprecated. Do not use! See <a href="../man3/curl_multi_socket_action.3.html"><strong>curl_multi_socket_action</strong>(3)</a></em> instead!</p><p>At return, the integer <strong>running_handles</strong> points to will contain the number of still running easy handles within the multi handle. When this number reaches zero, all transfers are complete/done. Note that when you call <a href="../man3/curl_multi_socket_action.3.html"><strong>curl_multi_socket_action</strong>(3)</a></em> on a specific socket and the counter decreases by one, it DOES NOT necessarily mean that this exact socket/transfer is the one that completed. Use <a href="../man3/curl_multi_info_read.3.html"><strong>curl_multi_info_read</strong>(3)</a></em> to figure out which easy handle that completed.</p><p>The <a href="../man3/curl_multi_socket_action.3.html"><strong>curl_multi_socket_action</strong>(3)</a></strong> functions inform the application about updates in the socket (file descriptor) status by doing none, one, or multiple calls to the socket callback function set with the CURLMOPT_SOCKETFUNCTION option to <a href="../man3/curl_multi_setopt.3.html"><strong>curl_multi_setopt</strong>(3)</a></em>. They update the status with changes since the previous time the callback was called.</p><p>Get the timeout time by setting the <em>CURLMOPT_TIMERFUNCTION</em> option with <a href="../man3/curl_multi_setopt.3.html"><strong>curl_multi_setopt</strong>(3)</a></em>. Your application will then get called with information on how long to wait for socket actions at most before doing the timeout action: call the <a href="../man3/curl_multi_socket_action.3.html"><strong>curl_multi_socket_action</strong>(3)</a></strong> function with the <strong>sockfd</strong> argument set to CURL_SOCKET_TIMEOUT. You can also use the <a href="../man3/curl_multi_timeout.3.html"><strong>curl_multi_timeout</strong>(3)</a></em> function to poll the value at any given time, but for an event-based system using the callback is far better than relying on polling the timeout value.</p><p>Usage of <a href="../man3/curl_multi_socket.3.html"><strong>curl_multi_socket</strong>(3)</a></em> is deprecated, whereas the function is equivalent to <a href="../man3/curl_multi_socket_action.3.html"><strong>curl_multi_socket_action</strong>(3)</a></em> with <strong>ev_bitmask</strong> set to 0.</p><p>Force libcurl to (re-)check all its internal sockets and transfers instead of just a single one by calling <strong>curl_multi_socket_all</strong>(3)</strong>. Note that there should not be any reason to use this function!</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CALLBACK DETAILS</h2>
        <div class="sectioncontent">
<p>The socket <strong>callback</strong> function uses a prototype like this</p>
<pre>
  int curl_socket_callback(CURL *easy,      /* easy handle */
                           curl_socket_t s, /* socket */
                           int action,      /* see values below */
                           void *userp,    /* private callback pointer */
                           void *socketp); /* private socket pointer */

</pre>
<p>The callback MUST return 0.</p><p>The <em>easy</em> argument is a pointer to the easy handle that deals with this particular socket. Note that a single handle may work with several sockets simultaneously.</p><p>The <em>s</em> argument is the actual socket value as you use it within your system.</p><p>The <em>action</em> argument to the callback has one of five values:</p>
<dl class='dl-vertical'>
  <dt>
    CURL_POLL_NONE (0)
  </dt>
  <dd>
    <p>register, not interested in readiness (yet)</p>
  </dd>
  <dt>
    CURL_POLL_IN (1)
  </dt>
  <dd>
    <p>register, interested in read readiness</p>
  </dd>
  <dt>
    CURL_POLL_OUT (2)
  </dt>
  <dd>
    <p>register, interested in write readiness</p>
  </dd>
  <dt>
    CURL_POLL_INOUT (3)
  </dt>
  <dd>
    <p>register, interested in both read and write readiness</p>
  </dd>
  <dt>
    CURL_POLL_REMOVE (4)
  </dt>
  <dd>
    <p>unregister</p>
  </dd>

</dl>
<p>The <em>socketp</em> argument is a private pointer you have previously set with <a href="../man3/curl_multi_assign.3.html"><strong>curl_multi_assign</strong>(3)</a></em> to be associated with the <em>s</em> socket. If no pointer has been set, socketp will be NULL. This argument is of course a service to applications that want to keep certain data or structs that are strictly associated to the given socket.</p><p>The <em>userp</em> argument is a private pointer you have previously set with <a href="../man3/curl_multi_setopt.3.html"><strong>curl_multi_setopt</strong>(3)</a></em> and the CURLMOPT_SOCKETDATA option.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>CURLMcode type, general libcurl multi interface error code.</p><p>Legacy: If you receive <em>CURLM_CALL_MULTI_PERFORM</em>, this basically means that you should call <a href="../man3/curl_multi_socket.3.html"><strong>curl_multi_socket</strong>(3)</a></em> again, before you wait for more actions on libcurl's sockets. You don't have to do it immediately, but the return code means that libcurl may have more data available to return or that there may be more data to send off before it is "satisfied".</p><p>In modern libcurls, <em>CURLM_CALL_MULTI_PERFORM</em> or <em>CURLM_CALL_MULTI_SOKCET</em> should not be returned and no application needs to care about them.</p><p>NOTE that the return code is for the whole multi stack. Problems still might have occurred on individual transfers even when one of these functions return OK.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TYPICAL USAGE</h2>
        <div class="sectioncontent">
<p>1. Create a multi handle</p><p>2. Set the socket callback with CURLMOPT_SOCKETFUNCTION</p><p>3. Set the timeout callback with CURLMOPT_TIMERFUNCTION, to get to know what timeout value to use when waiting for socket activities.</p><p>4. Add easy handles with curl_multi_add_handle()</p><p>5. Provide some means to manage the sockets libcurl is using, so you can check them for activity. This can be done through your application code, or by way of an external library such as libevent or glib.</p><p>6. Wait for activity on any of libcurl's sockets, use the timeout value your callback has been told</p><p>7, When activity is detected, call curl_multi_socket_action() for the socket(s) that got action. If no activity is detected and the timeout expires, call <a href="../man3/curl_multi_socket_action.3.html"><strong>curl_multi_socket_action</strong>(3)</a></em> with <em>CURL_SOCKET_TIMEOUT</em></p><p>8. Go back to step 6.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AVAILABILITY</h2>
        <div class="sectioncontent">
<p>This function was added in libcurl 7.15.4, and is deemed stable since 7.16.0.</p><p><a href="../man3/curl_multi_socket.3.html"><strong>curl_multi_socket</strong>(3)</a></em> is deprecated, use <a href="../man3/curl_multi_socket_action.3.html"><strong>curl_multi_socket_action</strong>(3)</a></em> instead!</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO curl_multi_socket&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man3/curl_multi_cleanup.3.html"><strong>curl_multi_cleanup</strong>(3)</a>, <a href="../man3/curl_multi_init.3.html"><strong>curl_multi_init</strong>(3)</a>,  <a href="../man3/curl_multi_fdset.3.html"><strong>curl_multi_fdset</strong>(3)</a>, <a href="../man3/curl_multi_info_read.3.html"><strong>curl_multi_info_read</strong>(3)</a>,  <strong>the hiperfifo.c example</strong></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="curl_multi_setopt.3.html"><span aria-hidden="true">&larr;</span> curl_multi_setopt.3: Set options for a curl multi handle</a></li>
   <li class="next"><a href="curl_multi_socket_action.3.html">curl_multi_socket_action.3: Reads/writes available data given an action <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
