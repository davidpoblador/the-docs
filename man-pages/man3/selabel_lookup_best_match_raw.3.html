<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>selabel_lookup_best_match_raw - obtain a best match SELinux security context - Only supported on file backend. .</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Obtain a best match selinux security context - only supported on file backend. .">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">selabel_lookup_best_match_raw<small> (3)</small></h1>
        <p class="lead">Obtain a best match selinux security context - only supported on file backend. .</p>
      </div>

    <ol class="breadcrumb">
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="https://www.carta.tech/man-pages/"><span itemprop="title">Linux Man Pages</span></a>
	</li>
	<li id="breadcrumb_section" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_page" itemprop="child">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man3/"><span itemprop="title">Library calls</span></a>
	</li>
	<li id="breadcrumb_page" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="active">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man3/selabel_lookup_best_match_raw.3.html"><span itemprop="title">selabel_lookup_best_match_raw</span></a>
	</li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p><strong>#include &lt;selinux/selinux.h&gt;</strong></p>
<p class='spacer'>

<p><strong>#include &lt;selinux/label.h&gt;</strong></p>
<p class='spacer'>

<p><strong>int selabel_lookup_best_match(struct selabel_handle *</strong><em>hnd</em><strong>,</strong> <strong>char **</strong><em>context</em><strong>,</strong></p>
<p class='spacer'>

<p><strong>const char *</strong><em>key</em><strong>,</strong></p>
<p class='spacer'>

<p><strong>const char **</strong><em>links</em><strong>,</strong></p>
<p class='spacer'>

<p><strong>int </strong><em>type</em><strong>);</strong></p>
<p class='spacer'>

<p><strong>int selabel_lookup_best_match_raw(struct selabel_handle *</strong><em>hnd</em><strong>,</strong> <strong>char **</strong><em>context</em><strong>,</strong></p>
<p class='spacer'>

<p><strong>const char *</strong><em>key</em><strong>,</strong></p>
<p class='spacer'>

<p><strong>const char **</strong><em>links</em><strong>,</strong></p>
<p class='spacer'>

<p><strong>int </strong><em>type</em><strong>);</strong> .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

    <p><strong>selabel_lookup_best_match</strong>() performs a best match lookup operation on the handle <em>hnd</em>, returning the result in the memory pointed to by <em>context</em>, which must be freed by the caller using <a href="../man3/freecon.3.html"><strong>freecon</strong>(3)</a>. The <em>key</em> parameter is a file path to check for best match using zero or more <em>link</em> (aliases) parameters. The order of precedence for best match is:</p>
    <dl class='dl-horizontal'>
      <dt>1.</dt>
      <dd>
    <p>An exact match for the real path (<em>key</em>) or</p>
      </dd>
      <dt>2.</dt>
      <dd>
    <p>An exact match for any of the <em>link</em>s (aliases), or</p>
      </dd>
      <dt>3.</dt>
      <dd>
    <p>The longest fixed prefix match.</p>
      </dd>
    </dl>
<p class='spacer'>

<p>The <em>type</em> parameter is an optional file <em>mode</em> argument that should be set to the mode bits of the file, as determined by <a href="../man2/lstat.2.html"><strong>lstat</strong>(2)</a>. <em>mode</em> may be zero, however full matching may not occur.</p>
<p class='spacer'>

<p><strong>selabel_lookup_best_match_raw</strong>() behaves identically to <strong>selabel_lookup_best_match</strong>() but does not perform context translation. .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">

<p>On success, zero is returned.  On error, -1 is returned and <em>errno</em> is set appropriately. .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">

  <dl class='dl-vertical'>
    <dt><strong>ENOENT</strong></dt>
    <dd>
  <p>No context corresponding to the input <em>key</em> and <em>type</em> was found.</p>
    </dd>
    <dt><strong>EINVAL</strong></dt>
    <dd>
  <p>The <em>key</em> and/or <em>type</em> inputs are invalid, or the context being returned failed validation.</p>
    </dd>
    <dt><strong>ENOMEM</strong></dt>
    <dd>
  <p>An attempt to allocate memory failed.</p>
<p class='spacer'>

    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<p>Example usage - When a service creates a device node, it may also create one or more symlinks to the device node.  These symlinks may be the only stable name for the device, e.g. if the partition is dynamically assigned. The file label backend supports this by looking up the "best match" for a device node based on its real path (<em>key</em>) and any <em>link</em>s to it (aliases). The order of precedence for best match is described above.</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<p><a href="../man3/selabel_open.3.html"><strong>selabel_open</strong>(3)</a>, <a href="../man3/selabel_stats.3.html"><strong>selabel_stats</strong>(3)</a>, <a href="../man3/selinux_set_callback.3.html"><strong>selinux_set_callback</strong>(3)</a>, <a href="../man8/selinux.8.html"><strong>selinux</strong>(8)</a>, <a href="../man2/lstat.2.html"><strong>lstat</strong>(2)</a>, <a href="../man5/selabel_file.5.html"><strong>selabel_file</strong>(5)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="selabel_lookup_best_match.3.html"><span aria-hidden="true">&larr;</span> selabel_lookup_best_match.3: obtain a best match SELinux security context - Only supported on file backend. .</a></li>
   <li class="next"><a href="selabel_lookup_raw.3.html">selabel_lookup_raw.3: obtain SELinux security context from a string label . <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
