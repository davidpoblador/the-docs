<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Net::OpenID::Server: Library for building your own openid server/provider</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Library for building your own openid server/provider">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Net::OpenID::Server (3pm) manual">
  <meta name="twitter:description" content="Library for building your own openid server/provider">
  <meta name="twitter:image" content="https://www.carta.tech/images/libnet-openid-server-perl-Net::OpenID::Server-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Net::OpenID::Server.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Net::OpenID::Server (3pm) manual" />
  <meta property="og:description" content="Library for building your own openid server/provider" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libnet-openid-server-perl-Net::OpenID::Server-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Net::OpenID::Server<small> (3pm)</small></h1>
        <p class="lead">Library for building your own openid server/provider</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Net::OpenID::Server.3pm.html">
      <span itemprop="name">Net::OpenID::Server: Library for building your own openid server/provider</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libnet-openid-server-perl/">
      <span itemprop="name">libnet-openid-server-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Net::OpenID::Server.3pm.html">
      <span itemprop="name">Net::OpenID::Server: Library for building your own openid server/provider</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>version 1.09</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use Net::OpenID::Server;

  my $nos = Net::OpenID::Server-&gt;new(
    args         =&gt; $cgi,
    get_user     =&gt; &#92;&get_user,
    get_identity =&gt; &#92;&get_identity,
    is_identity  =&gt; &#92;&is_identity,
    is_trusted   =&gt; &#92;&is_trusted,
    endpoint_url =&gt; "http://example.com/server.bml",
    setup_url    =&gt; "http://example.com/pass-identity.bml",
  );

  # From your OpenID server endpoint:

  my ($type, $data) = $nos-&gt;handle_page;
  if ($type eq "redirect") {
      WebApp::redirect_to($data);
  } elsif ($type eq "setup") {
      my %setup_opts = %$data;
      # ... show them setup page(s), with options from setup_map
      # it&apos;s then your job to redirect them at the end to "return_to"
      # (or whatever you&apos;ve named it in setup_map)
  } else {
      WebApp::set_content_type($type);
      WebApp::print($data);
  }
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This is the Perl \s-1API\s0 for (the server half of) OpenID, a distributed identity system based on proving you own a \s-1URL\s0, which is then your identity.  More information is available at:</p><p>  http://openid.net/</p><p>As of version 1.01 this module has support for both OpenID 1.1 and 2.0. Prior to this, only 1.1 was supported.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONSTRUCTOR</h2>
        <div class="sectioncontent">
<p>You can set anything in the constructor options that there are getters/setters methods for below.  That includes: args, get_user, is_identity, is_trusted, setup_url, and setup_map.  See below for docs.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>Returns a $type and $data, where $type can be:</p><p>... in which case you redirect the user (via your web framework's redirect functionality) to the \s-1URL\s0 specified in $data. ... in which case you should show the user a page (or redirect them to one of your pages) where they can setup trust for the given \*(L"trust_root\*(R" in the hashref in $data, and then redirect them to \*(L"return_to\*(R" at the end.  Note that the parameters in the $data hashref are as you named them with setup_map.</p>
<dl class='dl-vertical'>
  <dt>
    Some content type
  </dt>
  <dd>
    <p>Otherwise, set the content type to $type and print the page out, the contents of which are in $data.</p>
  </dd>

</dl>
<p>The optional %opts may contain: If set to a true value, signals that you don't want to handle the \*(C`setup\*(C' return type from handle_page, and you'd prefer it just be converted to a \*(C`redirect\*(C' type to your already-defined \*(C`setup_url\*(C', with the arguments from setup_map already appended.</p><p>Generates a positive identity assertion \s-1URL\s0 that you'd redirect a user to.  Typically this would be after they've completed your setup_url. Once trust has been setup, the \*(C`handle_page\*(C' method will redirect you to this signed return automatically. The \s-1URL\s0 generated is the consumer site's return_to \s-1URL\s0, with a signed identity included in the \s-1GET\s0 arguments.  The %opts are:</p><p>Required.  The identity \s-1URL\s0 to sign. Optional.  The claimed_id \s-1URL\s0 to sign. Required.  The base of the \s-1URL\s0 being generated. The association handle to use for the signature.  If blank, dumb consumer mode is used, and the library picks the handle. Optional.  If present, the \*(C`return_to\*(C' \s-1URL\s0 will be checked to be within (\*(L"under\*(R") this trust_root.  If not, the \s-1URL\s0 returned will be undef. Optional. Optional.  If present, must be a hashref with keys starting with \*(L"&#92;w+&#92;.\*(R". All keys and values will be returned in the response, and signed.  This is used for OpenID extensions.</p><p>Generates a cancel notice to the return_to \s-1URL\s0, if a user declines to share their identity.  %opts are:</p><p>Required.  The base of the \s-1URL\s0 being generated.</p><p>Can be used in 1 of 3 ways: 1. Setting the way which the Server instances obtains parameters: $nos-&gt;args( $reference ) Where $reference is either a \s-1HASH\s0 ref, \s-1CODE\s0 ref, Apache $r (for get_args only), Apache::Request $apreq, or \s-1CGI\s0.pm $cgi.  If a \s-1CODE\s0 ref, the subref must return the value given one argument (the parameter to retrieve) 2. Get a paramater: my $foo = $nos-&gt;get_args(\*(L"foo\*(R"); When given an unblessed scalar, it retrieves the value.  It croaks if you haven't defined a way to get at the parameters. 3. Get the getter: my $code = $nos-&gt;get_args; Without arguments, returns a subref that returns the value given a parameter name. Get/set the subref returning a defined value representing the logged in user, or undef if no user.  The return value (let's call it $u) is not touched.  It's simply given back to your other callbacks (is_identity and is_trusted). For OpenID 2.0. Get/set the subref returning a identity. This is called when claimed identity is 'identifier_select'. Get/set the subref which is responsible for returning true if the logged in user $u (which may be undef if user isn't logged in) owns the \s-1URL\s0 tree given by $identity_url.  Note that if $u is undef, your function should always return 0.  The framework doesn't do that for you so you can do unnecessary work on purpose if you care about exposing information via timing attacks. Get/set the subref which is responsible for returning true if the logged in user $u (which may be undef if user isn't logged in) trusts the \s-1URL\s0 given by $trust_root to know his/her identity.  Note that if either $u is undef, or $is_identity is false (this is the result of your previous is_identity callback), you should return 0.  But your callback is always run so you can avoid timing attacks, if you care. The server secret is used to generate and sign lots of per-consumer secrets, and is never handed out directly. In the simplest (and least secure) form, you configure a static secret value with a scalar.  If you use this method and change the scalar value, all consumers that have cached their per-consumer secrets will start failing, since their secrets no longer work. The recommended usage, however, is to supply a subref that returns a secret based on the provided <em></em><strong>$time</strong><em></em>, a unix timestamp.  And if one doesn't exist for that time, create, store and return it (with appropriate locking so you never return different secrets for the same time.)  Your secret can just be random characters, but it's your responsibility to do the locking and storage.  If you want help generating random characters, call \*(C`Net::OpenID::Server::rand_chars($len)\*(C'. Your secret may not exceed 255 characters. Get/set the user setup \s-1URL\s0.  This is the \s-1URL\s0 the user is told to go to if they're either not logged in, not who they said they were, or trust hasn't been setup.  You use the same \s-1URL\s0 in all three cases.  Your setup \s-1URL\s0 may contain existing query parameters. For OpenID 2.0. Get/set the op_endpoint \s-1URL\s0. When this module gives a consumer site a user_setup_url from your provided setup_url, it also has to append a number of get parameters onto your setup_url, so your app based at that setup_url knows what it has to setup.  Those keys are named, by default, \*(L"trust_root\*(R", \*(L"return_to\*(R", \*(L"identity\*(R", and \*(L"assoc_handle\*(R".  If you don't like those parameter names, this $hashref setup_map lets you change one or more of them.  The hashref's keys should be the default values, with values being the parameter names you want.</p>
<dl class='dl-vertical'>
  <dt>
    Net::OpenID::Server-&gt;rand_chars($len)
  </dt>
  <dd>
    <p>Utility function to return a string of $len random characters.  May be called as package method, object method, or regular function. Returns the last error, in form \*(L"errcode: errtext\*(R"; Returns the last error code. Returns the last error text.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>This module is Copyright (c) 2005 Brad Fitzpatrick. All rights reserved.</p><p>You may distribute under the terms of either the \s-1GNU\s0 General Public License or the Artistic License, as specified in the Perl \s-1README\s0 file. If you need more liberal licensing terms, please contact the maintainer.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">WARRANTY</h2>
        <div class="sectioncontent">
<p>This is free software. \s-1IT\s0 \s-1COMES\s0 \s-1WITHOUT\s0 \s-1WARRANTY\s0 \s-1OF\s0 \s-1ANY\s0 \s-1KIND\s0.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MAILING LIST</h2>
        <div class="sectioncontent">
<p>The Net::OpenID family of modules has a mailing list powered by Google Groups. For more information, see http://groups.google.com/group/openid-perl .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Net::OpenID::Server&hellip;</h2>
        <div class="sectioncontent">
<p>OpenID website:  http://openid.net/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Brad Fitzpatrick &lt;brad@danga.com&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Net::OAuth::YahooAccessTokenRefreshRequest.3pm.html"><span aria-hidden="true">&larr;</span> Net::OAuth::YahooAccessTokenRefreshRequest.3pm: Yahoo oauth extension</a></li>
   <li class="next"><a href="Net::OpenSRS.3pm.html">Net::OpenSRS.3pm: Domain registration via the tucows opensrs https xml api <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
