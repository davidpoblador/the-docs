<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>lttng-health-check: Monitor health of the session daemon</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Monitor health of the session daemon">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="lttng-health-check (3) manual">
  <meta name="twitter:description" content="Monitor health of the session daemon">
  <meta name="twitter:image" content="https://www.carta.tech/images/lttng-tools-lttng-health-check-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/lttng-health-check.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="lttng-health-check (3) manual" />
  <meta property="og:description" content="Monitor health of the session daemon" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/lttng-tools-lttng-health-check-3.png" />

</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">lttng-health-check<small> (3)</small></h1>
        <p class="lead">Monitor health of the session daemon</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/lttng-health-check.3.html">
      <span itemprop="name">lttng-health-check: Monitor health of the session daemon</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/lttng-tools/">
      <span itemprop="name">lttng-tools</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/lttng-health-check.3.html">
      <span itemprop="name">lttng-health-check: Monitor health of the session daemon</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>#include &lt;lttng/lttng.h&gt;</strong>

<strong>int lttng_health_check(enum lttng_health_component c);</strong>
</pre>
<p>Link with -llttng-ctl.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <strong>lttng_health_check</strong>() is used to check the session daemon health for either a specific component <strong>c</strong> or for all of them. Each component represent a subsystem of the session daemon. Those components are set with health counters that are atomically incremented once reached. An even value indicates progress in the execution of the component. An odd value means that the code has entered a blocking state which is not a <strong>poll</strong>(7) wait period.</p><p>A bad health is defined by a fatal error code path reached or any IPC used in the session daemon that was blocked for more than 20 seconds (default timeout). The condition for this bad health to be detected is that one or many of the counters are odd.</p><p>The health check mechanism of the session daemon can only be reached through the health socket which is a different one from the command and the application socket. An isolated thread serves this socket and only computes the health counters across the code when asked by the lttng control library (using this call). This subsystem is highly unlikely to fail due to its simplicity.</p><p>The <strong>c</strong> argument can be one of the following values:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>LTTNG_HEALTH_CMD</strong></p>
  </dt>
  <dd>
    <p>Command subsystem which handles user commands coming from the liblttng-ctl or the <strong>lttng</strong>(1)</strong> command line interface.</p>
  </dd>
  <dt>
    <p><strong>LTTNG_HEALTH_APP_MANAGE</strong></p>
  </dt>
  <dd>
    <p>The session daemon manages application socket in order to route client command and check if they get closed which indicates the application shutdown.</p>
  </dd>
  <dt>
    <p><strong>LTTNG_HEALTH_APP_REG</strong></p>
  </dt>
  <dd>
    <p>The application registration mechanism is an important and vital part of for user space tracing. Upon startup, applications instrumented with <strong>lttng-ust</strong>(3)</strong> try to register to the session daemon through this subsystem.</p>
  </dd>
  <dt>
    <p><strong>LTTNG_HEALTH_KERNEL</strong></p>
  </dt>
  <dd>
    <p>Monitor the Kernel tracer streams and main channel of communication (/proc/lttng). If this component malfunction, the Kernel tracer is not usable anymore by lttng-tools.</p>
  </dd>
  <dt>
    <p><strong>LTTNG_HEALTH_CONSUMER</strong></p>
  </dt>
  <dd>
    <p>The session daemon can spawn up to <strong>three</strong> consumer daemon for kernel, user space 32 and 64 bit. This subsystem monitors the consumer daemon(s). A bad health state means that the consumer(s) are not usable anymore hence likely making tracing not usable.</p>
  </dd>
  <dt>
    <p><strong>LTTNG_HEALTH_ALL</strong></p>
  </dt>
  <dd>
    <p>Check all components. If only one of them is in a bad state, a health check error is returned.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>Return 0 if the health is OK, or 1 is it's in a bad state. A return code of -1 indicates that the control library was not able to connect to the session daemon health socket.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LIMITATIONS</h2>
        <div class="sectioncontent">
<p>For the LTTNG_HEALTH_CONSUMER, you can not know which consumer daemon has failed but only that either the consumer subsystem has failed or that a lttng-consumerd died.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>lttng-health-check was originally written by David Goulet and is currently maintained by Jérémie Galarneau &lt;jeremie.galarneau@efficios.com&gt;.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="lsetfilecon_raw.3.html"><span aria-hidden="true">&larr;</span> lsetfilecon_raw.3: Set selinux security context of a file</a></li>
   <li class="next"><a href="lutimes.3.html">lutimes.3: Change file timestamps <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
