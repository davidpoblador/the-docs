<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>HTTP::Negotiate: Choose a variant to serve</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Choose a variant to serve">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="HTTP::Negotiate (3pm) manual">
  <meta name="twitter:description" content="Choose a variant to serve">
  <meta name="twitter:image" content="https://www.carta.tech/images/libhttp-negotiate-perl-HTTP::Negotiate-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/HTTP::Negotiate.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="HTTP::Negotiate (3pm) manual" />
  <meta property="og:description" content="Choose a variant to serve" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libhttp-negotiate-perl-HTTP::Negotiate-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">HTTP::Negotiate<small> (3pm)</small></h1>
        <p class="lead">Choose a variant to serve</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/HTTP::Negotiate.3pm.html">
      <span itemprop="name">HTTP::Negotiate: Choose a variant to serve</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libhttp-negotiate-perl/">
      <span itemprop="name">libhttp-negotiate-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/HTTP::Negotiate.3pm.html">
      <span itemprop="name">HTTP::Negotiate: Choose a variant to serve</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
 use HTTP::Negotiate qw(choose);

 #  ID       QS     Content-Type   Encoding Char-Set        Lang   Size
 $variants =
  [[&apos;var1&apos;,  1.000, &apos;text/html&apos;,   undef,   &apos;iso-8859-1&apos;,   &apos;en&apos;,   3000],
   [&apos;var2&apos;,  0.950, &apos;text/plain&apos;,  &apos;gzip&apos;,  &apos;us-ascii&apos;,     &apos;no&apos;,    400],
   [&apos;var3&apos;,  0.3,   &apos;image/gif&apos;,   undef,   undef,          undef, 43555],
  ];

 @preferred = choose($variants, $request_headers);
 $the_one   = choose($variants);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This module provides a complete implementation of the \s-1HTTP\s0 content negotiation algorithm specified in <em>draft-ietf-http-v11-spec-00.ps</em> chapter 12.  Content negotiation allows for the selection of a preferred content representation based upon attributes of the negotiable variants and the value of the various Accept* header fields in the request.</p><p>The variants are ordered by preference by calling the function <em>choose()</em>.</p><p>The first parameter is reference to an array of the variants to choose among. Each element in this array is an array with the values [$id, $qs, $content_type, $content_encoding, $charset, $content_language, $content_length] whose meanings are described below. The $content_encoding and $content_language can be either a single scalar value or an array reference if there are several values.</p><p>The second optional parameter is either a HTTP::Headers or a HTTP::Request object which is searched for \*(L"Accept*\*(R" headers.  If this parameter is missing, then the accept specification is initialized from the \s-1CGI\s0 environment variables \s-1HTTP_ACCEPT\s0, \s-1HTTP_ACCEPT_CHARSET\s0, \s-1HTTP_ACCEPT_ENCODING\s0 and \s-1HTTP_ACCEPT_LANGUAGE\s0.</p><p>In an array context, <em>choose()</em> returns a list of [variant identifier, calculated quality, size] tuples.  The values are sorted by quality, highest quality first.  If the calculated quality is the same for two variants, then they are sorted by size (smallest first). <em>E.g.</em>:</p><p>  ([&apos;var1&apos;, 1, 2000], [&apos;var2&apos;, 0.3, 512], [&apos;var3&apos;, 0.3, 1024]);</p><p>Note that also zero quality variants are included in the return list even if these should never be served to the client.</p><p>In a scalar context, it returns the identifier of the variant with the highest score or \*(C`undef\*(C' if none have non-zero quality.</p><p>If the $HTTP::Negotiate::DEBUG variable is set to \s-1TRUE\s0, then a lot of noise is generated on \s-1STDOUT\s0 during evaluation of <em>choose()</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VARIANTS</h2>
        <div class="sectioncontent">
<p>A variant is described by a list of the following values.  If the attribute does not make sense or is unknown for a variant, then use \*(C`undef\*(C' instead.</p>
<dl class='dl-vertical'>
  <dt>
    identifier
  </dt>
  <dd>
    <p>This is a string that you use as the name for the variant.  This identifier for the preferred variants returned by <em>choose()</em>.</p>
  </dd>
  <dt>
    qs
  </dt>
  <dd>
    <p>This is a number between 0.000 and 1.000 that describes the \*(L"source quality\*(R".  This is what <em>draft-ietf-http-v11-spec-00.ps</em> says about this value: Source quality is measured by the content provider as representing the amount of degradation from the original source.  For example, a picture in \s-1JPEG\s0 form would have a lower qs when translated to the \s-1XBM\s0 format, and much lower qs when translated to an ASCII-art representation.  Note, however, that this is a function of the source - an original piece of ASCII-art may degrade in quality if it is captured in \s-1JPEG\s0 form.  The qs values should be assigned to each variant by the content provider; if no qs value has been assigned, the default is generally \*(L"qs=1\*(R".</p>
  </dd>
  <dt>
    content-type
  </dt>
  <dd>
    <p>This is the media type of the variant.  The media type does not include a charset attribute, but might contain other parameters. Examples are:   text/html   text/html;version=2.0   text/plain   image/gif   image/jpg</p>
  </dd>
  <dt>
    content-encoding
  </dt>
  <dd>
    <p>This is one or more content encodings that has been applied to the variant.  The content encoding is generally used as a modifier to the content media type.  The most common content encodings are:   gzip   compress</p>
  </dd>
  <dt>
    content-charset
  </dt>
  <dd>
    <p>This is the character set used when the variant contains text. The charset value should generally be \*(C`undef\*(C' or one of these:   us-ascii   iso-8859-1 ... iso-8859-9   iso-2022-jp   iso-2022-jp-2   iso-2022-kr   unicode-1-1   unicode-1-1-utf-7   unicode-1-1-utf-8</p>
  </dd>
  <dt>
    content-language
  </dt>
  <dd>
    <p>This describes one or more languages that are used in the variant. Language is described like this in <em>draft-ietf-http-v11-spec-00.ps</em>: A language is in this context a natural language spoken, written, or otherwise conveyed by human beings for communication of information to other human beings.  Computer languages are explicitly excluded. The language tags are defined by \s-1RFC\s0 3066.  Examples are:   no               Norwegian   en               International English   en-US            US English   en-cockney</p>
  </dd>
  <dt>
    content-length
  </dt>
  <dd>
    <p>This is the number of bytes used to represent the content.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ACCEPT HEADERS</h2>
        <div class="sectioncontent">
<p>The following Accept* headers can be used for describing content preferences in a request (This description is an edited extract from <em>draft-ietf-http-v11-spec-00.ps</em>):</p>
<dl class='dl-vertical'>
  <dt>
    Accept
  </dt>
  <dd>
    <p>This header can be used to indicate a list of media ranges which are acceptable as a response to the request.  The \*(L"*\*(R" character is used to group media types into ranges, with \*(L"*/*\*(R" indicating all media types and \*(L"type/*\*(R" indicating all subtypes of that type. The parameter q is used to indicate the quality factor, which represents the user's preference for that range of media types.  The parameter mbx gives the maximum acceptable size of the response content. The default values are: q=1 and mbx=infinity. If no Accept header is present, then the client accepts all media types with q=1. For example:   Accept: audio/*;q=0.2;mbx=200000, audio/basic would mean: \*(L"I prefer audio/basic (of any size), but send me any audio type if it is the best available after an 80% mark-down in quality and its size is less than 200000 bytes\*(R"</p>
  </dd>
  <dt>
    Accept-Charset
  </dt>
  <dd>
    <p>Used to indicate what character sets are acceptable for the response. The \*(L"us-ascii\*(R" character set is assumed to be acceptable for all user agents.  If no Accept-Charset field is given, the default is that any charset is acceptable.  Example:   Accept-Charset: iso-8859-1, unicode-1-1</p>
  </dd>
  <dt>
    Accept-Encoding
  </dt>
  <dd>
    <p>Restricts the Content-Encoding values which are acceptable in the response.  If no Accept-Encoding field is present, the server may assume that the client will accept any content encoding.  An empty Accept-Encoding means that no content encoding is acceptable.  Example:   Accept-Encoding: compress, gzip</p>
  </dd>
  <dt>
    Accept-Language
  </dt>
  <dd>
    <p>This field is similar to Accept, but restricts the set of natural languages that are preferred in a response.  Each language may be given an associated quality value which represents an estimate of the user's comprehension of that language.  For example:   Accept-Language: no, en-gb;q=0.8, de;q=0.55 would mean: "I prefer Norwegian, but will accept British English (with 80% comprehension) or German (with 55% comprehension).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright 1996,2001 Gisle Aas.</p><p>This library is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Gisle Aas &lt;gisle@aas.no&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="HTTP::Message.3pm.html"><span aria-hidden="true">&larr;</span> HTTP::Message.3pm: Http style message (base class)</a></li>
   <li class="next"><a href="HTTP::OAI.3pm.html">HTTP::OAI.3pm: Api for the oai-pmh <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
