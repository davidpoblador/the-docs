<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Geo::Postcode: Uk postcode validation and location</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Uk postcode validation and location">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Geo::Postcode (3pm) manual">
  <meta name="twitter:description" content="Uk postcode validation and location">
  <meta name="twitter:image" content="https://www.carta.tech/images/libgeo-postcode-perl-Geo::Postcode-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Geo::Postcode.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Geo::Postcode (3pm) manual" />
  <meta property="og:description" content="Uk postcode validation and location" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libgeo-postcode-perl-Geo::Postcode-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Geo::Postcode<small> (3pm)</small></h1>
        <p class="lead">Uk postcode validation and location</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Geo::Postcode.3pm.html">
      <span itemprop="name">Geo::Postcode: Uk postcode validation and location</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libgeo-postcode-perl/">
      <span itemprop="name">libgeo-postcode-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Geo::Postcode.3pm.html">
      <span itemprop="name">Geo::Postcode: Uk postcode validation and location</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use Geo::Postcode;
  my $postcode = Geo::Postcode-&gt;new(&apos;SW1 1AA&apos;);

  return unless $postcode-&gt;valid;
  my ($n, $e) = ($postcode-&gt;gridn, $postcode-&gt;gride);

  # is the same as

  my ($n, $e) = $postcode-&gt;coordinates;

  # and alternative to

  my @location = ($postcode-&gt;lat, $postcode-&gt;long);

  # or the impatient can skip the construction step:

  my ($n, $e) = Geo::Postcode-&gt;coordinates(&apos;SW1 1AA&apos;);

  my $clean_postcode = Geo::Postcode-&gt;valid( $postcode );

  my ($unit, $sector, $district, $area) = Geo::Postcode-&gt;analyse(&apos;SW1 1AA&apos;);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Geo::Postcode will accept full or partial \s-1UK\s0 postcodes, validate them against the official spec, separate them into their significant parts, translate them into map references or co-ordinates and calculate distances between them.</p><p>It does not check whether the supplied postcode exists: only whether it is well-formed according to British Standard 7666, which you can find here:</p><p>  http://www.govtalk.gov.uk/gdsc/html/frames/PostCode.htm</p><p>Geo::Postcode will also work with partial codes, ie areas, districts and sectors. They won't validate, but you can test them for legitimacy with a call to \*(C`valid_fragment\*(C', and you can still turn them into grid references.</p><p>To work with \s-1US\s0 zipcodes, you need Geo::Postalcode instead.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">GRID REFERENCES AND DATA FILES</h2>
        <div class="sectioncontent">
<p>Any postcode, whether fully or partly specified, can be turned into a grid reference. The Post Office calls it a centroid, and it marks the approximate centre of the area covered by the code.</p><p>Unfortunately, and inexplicably, this information is not public domain: unless you're prepared to work at a very crude level, you have to buy location data either from the Post Office or a data shop.</p><p>This module does not come with any postcode data of its own, therefore, and so the coordinate and distance calculation facilities are unavailable unless you plug in your own database.</p><p>See the \s-1POD\s0 for Geo::Delivery::Location for how to override the standard data set something more comprehensive.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INTERFACE</h2>
        <div class="sectioncontent">
<p>This is a mostly vanilla \s-1OOP\s0 module, but for quick and dirty work you can skip the object construction step and call a method directly with a postcode string. It will build the necessary object behind the scenes and return the result of the operation.</p><p>  my @coordinates = Geo::Postcode-&gt;coordinates(&apos;LA23 3PA&apos;);   my $postcode = Geo::Postcode-&gt;valid($input-&gt;param(&apos;postcode&apos;));</p><p>The object will not be available for any more requests, of course.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INTERNALS</h2>
        <div class="sectioncontent">
<p>The main Geo::Postcode object is very simple blessed hashref. The postcode information is stored as a four-element listref in $self-&gt;{postcode}. Location information is retrieved by the separate Geo::Postcode::Location, which by default uses SQLite but can easily be overridden to use the database or other source of your choice. The location machinery is not loaded until it's needed, so you can validate and parse postcodes very cheaply.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONSTRUCTION</h2>
        <div class="sectioncontent">
<h3>new ( postcode_string, location_class )</h3>
<p>Constructs and returns the very simple postcode object. All other processing and loading is deferred.</p><p>You can also pass in a couple of parameters up front, as a hashref after the postcode:</p><p>  my $postcode = Geo::Postcode-&gt;new(&apos;SW1 1AA&apos;, {     location_class =&gt; &apos;My::Location::Data::Class&apos;,     distance_units =&gt; &apos;miles&apos;,   })</p><p>This list will probably grow.</p>
<h3>postcode_string ( )</h3>
<p>Always returns the (uppercased) postcode string with which the object was constructed. Cannot be set after construction.</p>
<h3>fragments ( )</h3>
<p>Breaks the postcode into its significant parts, eg:</p><p>  EC1R 8DH --&gt; | EC | 1R | 8 | DH |</p><p>then stores the parts for later reference and returns them as a listref. Most other methods in this class call \*(C`fragments()\*(C' first to get their raw material.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOCATION</h2>
        <div class="sectioncontent">
<p>The first call to a location-related method of Geo::Postcode will cause the location class - normally Geo::Postcode::Location - to be loaded along with its data file, and a location object to be associated with this postcode object. We then pass all location-related queries on to the location object.</p><p>The accuracy of the information returned by location methods depends on the resolution of the location data file: see the \s-1POD\s0 for Geo::Postcode::Location for how to supply your own dataset instead of using the crude set that comes with this module.</p><h3>location ()</h3>
<p>Returns - and if necessary, creates - the location object associated with this postcode object. This operation is avoided until explicitly requested, so that simple postcode-validation can be as economical as possible. The location object does all the work of looking up map reference data, calculating distances and translating into other forms.</p>
<h3>location_class ()</h3>
<p>Sets and/or returns the full name of the class that should be called to get a location object. Calling \*(C`location_class\*(C' after a location object has been constructed will cause that object to be destroyed, so that the next call to a location-dependent method constructs a new object of the newly-specified class.</p>
<h3>default_location_class ()</h3>
<p>Returns the name of the location class we'll use if no other is specified. The default default is Geo::Postcode::Location, but if you're subclassing you will probably want to replace that with one of your own.</p>
<h3>gridn () gride ()</h3>
<p>Return the \s-1OS\s0 grid reference coordinates of the centre of this postcode.</p>
<h3>gridref ()</h3>
<p>Return the proper \s-1OS\s0 grid reference for this postcode, in classic \s-1AA123456\s0 style.</p>
<h3>lat () long ()</h3>
<p>Return the latitude and longitude of the centre of this postcode.</p>
<h3>placename () ward () nhsarea ()</h3>
<p>These return information from other fields that may or may not be present in your dataset. The default set supplied with this module doesn't have these extra fields but a set derived from the \s-1PAF\s0 normally will.</p>
<h3>coordinates ()</h3>
<p>Return the grid reference x, y coordinates of this postcode as two separate values. The grid reference we use here are completely numerical: the usual \s-1OS\s0 prefix is omitted and an absolute coordinate value returned unless you get a stringy version from \*(C`gridref()\*(C'.</p>
<h3>distance_from ( postcode object or string, unit )</h3>
<p>Accepts a postcode object or string, and returns the distance from here to there.</p><p>As usual, you can call this method directly (ie without first constructing an object), or with any combination of postcode strings and objects:</p><p>  my $distance = Geo::Postcode-&gt;distance_from(&apos;LA23 3PA&apos;, &apos;EC1Y 8PQ&apos;);   my $distance = Geo::Postcode-&gt;distance_from($postcode, &apos;EC1Y 8PQ&apos;);   my $distance = Geo::Postcode-&gt;distance_from(&apos;EC1Y 8PQ&apos;, $postcode);</p><p>Will do what you would expect, and the last two should be exactly the same. \*(C`distance_between\*(C' is provided as a synonym of \*(C`distance_from\*(C' to make that read more sensibly:</p><p>  my $distance = Geo::Postcode-&gt;distance_between(&apos;LA23 3PA&apos;, &apos;EC1Y 8PQ&apos;);</p><p>In any of these cases you can supply an additional parameter dictating the units of distance: the options are currently 'miles', 'm' or 'km' (the default).</p><p>  my $distance = Geo::Postcode-&gt;distance_between(&apos;LA23 3PA&apos;, &apos;EC1Y 8PQ&apos;, &apos;miles&apos;);</p><p>The same thing can be accomplished by supplying a 'distance_units' parameter at construction time or, if you don't mind acting global, by setting $Geo::Postcode::Location::units.</p>
<h3>bearing_to ( postcode objects or strings)</h3>
<p>Accepts a list of postcode objects and/or strings, and returns a corresponding list of the bearings from here to there, as degrees clockwise from grid North.</p>
<h3>friendly_bearing_to ( postcode objects or strings)</h3>
<p>Accepts a list of postcode objects and/or strings, and returns a corresponding list of rough directions from here to there. '\s-1NW\s0', '\s-1ESE\s0', that sort of thing.</p><p>  print "That&apos;s " . $postcode1-&gt;distance_to($postcode2) . " km " .     $postcode1-&gt;friendly_bearing_to($postcode2) . " of here.";</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VALIDATION</h2>
        <div class="sectioncontent">
<p>Postcodes are checked against \s-1BS7666\s0, which specifies the various kinds of sequences allowed and the characters which may appear in each position.</p><h3>valid ()</h3>
<p>If the postcode is well-formed and complete, this method returns true (in the useful form of the postcode itself, properly formatted). Otherwise, returns false.</p>
<h3>valid_fragment ()</h3>
<p>A looser check that doesn't mind incomplete postcodes. It will test that area, district or sector codes follow the rules for valid characters in that part of the postcode, and return true unless it finds anything that's not allowed.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEGMENTATION</h2>
        <div class="sectioncontent">
<p>These methods provide the various sector, area and district codes that can be derived from a full postcode, each of which identifies a larger area that encloses the postcode area.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">analyse ()</h2>
        <div class="sectioncontent">
<p>Returns a list of all the codes present in this postcode, in descending order of specificity. So:</p><p>  Geo::Postcode-&gt;analyse(&apos;EC1Y8PQ&apos;);</p><p>will return:</p><p>  (&apos;EC1Y 8PQ&apos;, &apos;EC1Y 8&apos;, &apos;EC1Y&apos;, &apos;EC&apos;)</p><p>which is useful mostly for dealing with situations where you don't know what resolution will be available and need to try alternatives. We do this when location-finding, so as to be able to work with data of unpredictable or variable specificity (ie we are cheap and only buy very rough data sets, but people enter exact postcodes).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">area ()</h2>
        <div class="sectioncontent">
<p>Returns the area code part of this postcode. This is the broadest area of all and is identified by the first one or two letters of the code: 'E' or '\s-1EC\s0' or '\s-1LA\s0' or whatever.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">district ()</h2>
        <div class="sectioncontent">
<p>Returns the district code part of this postcode. This is also called the 'outward' part, by the post office: it consists of the first two or three characters and identifies the delivery office for this address. It will look like '\s-1LA23\s0' or '\s-1EC1Y\s0'.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">sector ()</h2>
        <div class="sectioncontent">
<p>Returns the sector code part of this postcode. This is getting more local: it includes the first part of the code and the first digit of the second part, and is apparent used by the delivery office to sort the package. It will look something like '\s-1EC1Y\s0 8' or 'E1 7', and note that the space *is* meaningful. 'E1 7' and 'E17' are not the same thing.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">unit ()</h2>
        <div class="sectioncontent">
<p>Returns the whole postcode, properly formatted (ie in caps and with a space in the right place, regardless of how it came in).</p><p>This is similar to what you get just by stringifying the postcode object, with the important difference that <em>unit()</em> will only work for a well-formed postcode:</p><p>    print Geo::Postcode-&gt;unit(&apos;LA233PA&apos;);   # prints LA23 3PA     print Geo::Postcode-&gt;new(&apos;LA233PA&apos;);   # prints LA23 3PA     print Geo::Postcode-&gt;unit(&apos;LA23333&apos;);   # prints nothing     print Geo::Postcode-&gt;new(&apos;LA23333&apos;);   # prints LA23</p><p>Whereas normal stringification - which calls \*(C`_as_string\*(C' will print all the valid parts of a postcode.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">special_cases ()</h2>
        <div class="sectioncontent">
<p>Returns a list of known valid but non-conformist postcodes. The only official one is 'G1R 0AA', the old girobank address, but you can override this method to extend the list.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PLANS</h2>
        <div class="sectioncontent">
<p>The next majorish version of this module will support (but not require) the interface offered by Geo::Postalcode, so that one can be dropped into the place of the other. Some methods will not be relevant, but I'll try and keep as close a match as I can.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>William Ross, wross@cpan.org</p><p>Development of this library is kindly supported by Amnesty International \s-1UK\s0, who are pleased to see it distributed for public use but should not be held responsible for any shortcomings (or inadvertent copyright violations :).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright 2004 William Ross, spanner ltd.</p><p>This library is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Geo::METAR.3pm.html"><span aria-hidden="true">&larr;</span> Geo::METAR.3pm: Process aviation weather reports in the metar format.</a></li>
   <li class="next"><a href="Geo::Postcode::Location.3pm.html">Geo::Postcode::Location.3pm: Helper class for geo::postcode that handles grid reference lookups <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
