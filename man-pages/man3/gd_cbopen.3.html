<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>gd_cbopen: Gd_cbopen, gd_open  open or create a dirfile</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Gd_cbopen, gd_open  open or create a dirfile">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="gd_cbopen (3) manual">
  <meta name="twitter:description" content="Gd_cbopen, gd_open  open or create a dirfile">
  <meta name="twitter:image" content="https://www.carta.tech/images/libgetdata-dev-gd_cbopen-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/gd_cbopen.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="gd_cbopen (3) manual" />
  <meta property="og:description" content="Gd_cbopen, gd_open  open or create a dirfile" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libgetdata-dev-gd_cbopen-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">gd_cbopen<small> (3)</small></h1>
        <p class="lead">Gd_cbopen, gd_open  open or create a dirfile</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/gd_cbopen.3.html">
      <span itemprop="name">gd_cbopen: Gd_cbopen, gd_open  open or create a dirfile</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libgetdata-dev/">
      <span itemprop="name">libgetdata-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/gd_cbopen.3.html">
      <span itemprop="name">gd_cbopen: Gd_cbopen, gd_open  open or create a dirfile</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>#include &lt;getdata.h&gt;</strong> <strong>DIRFILE* gd_cbopen(const char *</strong><em>dirfilename</em><strong>, unsigned long</strong> <em>flags</em><strong>, gd_parser_callback_t </strong><em>sehandler</em><strong>, void *</strong><em>extra</em><strong>);</strong> <strong>DIRFILE* gd_open(const char *</strong><em>dirfilename</em><strong>, unsigned long </strong><em>flags</em><strong>);</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <strong>gd_cbopen</strong>() function opens or creates the dirfile specified by <em>dirfilename</em>, returning a DIRFILE object associated with it.  Opening a dirfile will cause the library to read and parse the dirfile's format specification (see <a href="../man5/dirfile-format.5.html"><strong>dirfile-format</strong>(5)</a>).</p><p>If not NULL, <em>sehandler</em> should be a pointer to a function which will be called whenever a syntax error is encountered during parsing the format specification.  Specify NULL for this parameter if no callback function is to be used.  The caller may use this function to correct the error or modify the error handling of the format specification parser.  See <strong>The Callback Function</strong> section below for details on this function.  The <em>extra</em> argument allows the caller to pass data to the callback function.  The pointer will be passed to the callback function verbatim.</p><p>The <strong>gd_open</strong>() function is equivalent to <strong>gd_cbopen</strong>(), with <em>sehandler</em> and <em>extra</em> set to NULL.</p><p>The <em>flags</em> argument should include one of the <em>access modes</em>: <strong>GD_RDONLY</strong> (read-only) or <strong>GD_RDWR</strong> (read-write), and may also contain zero or more of the following flags, bitwise-or'd together:</p><p><strong>GD_ARM_ENDIAN</strong></p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>GD_NOT_ARM_ENDIAN</strong></p>
  </dt>
  <dd>
    <p>Specifies that double precision floating point raw data on disk is, or is not, stored in the middle-endian format used by older ARM processors.</p><p>These flag are only set the default endianness, and will be overridden when an <strong>/ENDIAN</strong> directive specifies the byte sex of <strong>RAW</strong> fields, unless <strong>GD_FORCE_ENDIAN</strong> is also specified.</p><p>On every platform, one of these flags (<strong>GD_NOT_ARM_ENDIAN</strong> on all but middle-ended ARM systems) indicates the native behaviour of the platform.  That symbol will equal zero, and may be omitted.</p>
  </dd>

</dl>
<p><strong>GD_BIG_ENDIAN</strong></p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>GD_LITTLE_ENDIAN</strong></p>
  </dt>
  <dd>
    <p>Specifies the default byte sex of raw data stored on disk to be either big-endian (most significant byte first) or little-endian (least significant byte first).  Omitting both flags indicates the default should be the native endianness of the platform.</p><p>Unlike the ARM endianness flags above, neither of these symbols is ever zero. Specifying both these flags together will cause the library to assume that the endianness of the data is opposite to that of the native architecture, whatever that might be.</p><p>These flag are only set the default endianness, and will be overridden when an <strong>/ENDIAN</strong> directive specifies the byte sex of <strong>RAW</strong> fields, unless <strong>GD_FORCE_ENDIAN</strong> is also specified.</p>
  </dd>
  <dt>
    <p><strong>GD_CREAT</strong></p>
  </dt>
  <dd>
    <p>An empty dirfile will be created, if one does not already exist.  This will create both the dirfile directory and an empty format specification file called <em>format</em>. The directory will have have mode <strong>S_IRWXU</strong> | <strong>S_IRWXG</strong> | <strong>S_IRWXO</strong> (0777), modified by the caller's umask value (see <a href="../man2/umask.2.html"><strong>umask</strong>(2)</a>). The <em>format</em> file will have mode <strong>S_IRUSR</strong> | <strong>S_IWUSR</strong> | <strong>S_IRGRP</strong> | <strong>S_IWGRP</strong> | <strong>S_IROTH</strong> | <strong>S_IWOTH</strong> (0666), also modified by the caller's umask.</p><p>The owner of the dirfile directory and <em>format</em> file will be the effective user ID of the caller.  Group ownership follows the rules outlined in <a href="../man2/mkdir.2.html"><strong>mkdir</strong>(2)</a>.</p>
  </dd>
  <dt>
    <p><strong>GD_EXCL</strong></p>
  </dt>
  <dd>
    <p>Ensure that this call creates a dirfile: when specified along with <strong>GD_CREAT</strong>, the call will fail if the dirfile specified by <em>dirfilename</em> already exists.  Behaviour of this flag is undefined if <strong>GD_CREAT</strong> is not specified.  This flag suffers from all the limitations of the <strong>O_EXCL</strong> flag as indicated in <a href="../man2/open.2.html"><strong>open</strong>(2)</a>.</p>
  </dd>
  <dt>
    <p><strong>GD_FORCE_ENCODING</strong></p>
  </dt>
  <dd>
    <p>Specifies that <strong>/ENCODING</strong> directives (see <a href="../man5/dirfile-format.5.html"><strong>dirfile-format</strong>(5)</a>) found in the dirfile format specification should be ignored.  The encoding scheme specified in <em>flags</em> will be used instead (see below).</p>
  </dd>
  <dt>
    <p><strong>GD_FORCE_ENDIAN</strong></p>
  </dt>
  <dd>
    <p>Specifies that <strong>/ENDIAN</strong> directives (see <a href="../man5/dirfile-format.5.html"><strong>dirfile-format</strong>(5)</a>) found in the dirfile format specification should be ignored.  All raw data will be assumed to have the byte sex indicated through the presence or absense of the <strong>GD_ARM_ENDIAN</strong>,\~<strong>GD_BIG_ENDIAN</strong>,\~<strong>GD_LITTLE_ENDIAN</strong>, and <strong>GD_NOT_ARM_ENDIAN</strong> flags.</p>
  </dd>
  <dt>
    <p><strong>GD_IGNORE_DUPS</strong></p>
  </dt>
  <dd>
    <p>If the dirfile format metadata specifies more than one field with the same name, all but one of them will be ignored by the parser.  Without this flag, parsing would fail with the <strong>GD_E_FORMAT</strong> error, possibly resulting in invocation of the registered callback function. Which of the duplicate fields is kept is not specified.  As a result, this flag is typically only useful in the case where identical copies of a field specification line are present.</p><p>No indication is provided to indicate whether a duplicate field has been discarded.  If finer grained control is required, the caller should handle <strong>GD_E_FORMAT_DUPLICATE</strong> suberrors itself with an appropriate callback function.</p>
  </dd>
  <dt>
    <p><strong>GD_PEDANTIC</strong></p>
  </dt>
  <dd>
    <p>Reject dirfiles which don't conform to the Dirfile Standards.  See the <strong>Standards Compliance</strong> section below for full details.</p>
  </dd>
  <dt>
    <p><strong>GD_PERMISSIVE</strong></p>
  </dt>
  <dd>
    <p>Allow non-compliant format specification syntax, even when given along with a conflicting <strong>/VERSION</strong> directive.  See the <strong>Standards Compliance</strong> section below for full details.</p>
  </dd>
  <dt>
    <p><strong>GD_PRETTY_PRINT</strong></p>
  </dt>
  <dd>
    <p>When dirfile metadata is flushed to disk (either explicitly via <strong>gd_metaflush</strong>(),\~<strong>gd_rewrite_fragment</strong>(), or <strong>gd_flush</strong>() or implicitly by closing the dirfile), an attempt will be made to create a nicer looking format specification (from a human-readable standpoint).  What this explicitly means is not part of the API, and any particular behaviour should not be relied on.  If the dirfile is opened read-only, this flag is ignored.</p>
  </dd>
  <dt>
    <p><strong>GD_TRUNC</strong></p>
  </dt>
  <dd>
    <p>If <em>dirfilename</em> specifies an already existing dirfile, it will be truncated before opening. Since <strong>gd_cbopen</strong>() decides whether <em>dirfilename</em> specifies an existing dirfile before attempting to parse the dirfile, <em>dirfilename</em> is considered to specify an existing dirfile if it refers to a directory containing a regular file called <strong>format</strong>, regardless of the content or form of that file.</p><p>Truncation occurs by deleting every regular file in the specified directory, whether the files were referred to by the dirfile before truncation or not. Accordingly, this flag should be used with caution.  Subdirectories are left untouched.  Notably, this operation does not consider the presence of subdirfiles declared by <strong>INCLUDE</strong> directives.  If the dirfile does not exist, this flag is ignored.</p>
  </dd>
  <dt>
    <p><strong>GD_VERBOSE</strong></p>
  </dt>
  <dd>
    <p>Specifies that whenever an error is triggered by the library when working on this dirfile, the corresponding error string, which can be retrieved by calling <a href="../man3/gd_error_string.3.html"><strong>gd_error_string</strong>(3)</a>, should be written on standard error by the library.  Without this flag, GetData writes nothing to standard error.  (GetData never writes to standard output.)</p>
  </dd>

</dl>
<p>The <em>flags</em> argument may also be bitwise or'd with one of the following symbols indicating the default encoding scheme of the dirfile.  Like the endianness flags, the choice of encoding here is ignored if the encoding is specified in the dirfile itself, unless <strong>GD_FORCE_ENCODED</strong> is also specified.  If none of these symbols is present, <strong>GD_AUTO_ENCODED</strong> is assumed, unless the <strong>gd_cbopen</strong>() call results in creation or truncation of the dirfile.  In that case, <strong>GD_UNENCODED</strong> is assumed.  See <a href="../man5/dirfile-encoding.5.html"><strong>dirfile-encoding</strong>(5)</a> for details on dirfile encoding schemes.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>GD_AUTO_ENCODED</strong></p>
  </dt>
  <dd>
    <p>Specifies that the encoding type is not known in advance, but should be detected by the GetData library.  Detection is accomplished by searching for raw data files with extensions appropriate to the encoding scheme.  This method will notably fail if the the library is called via <strong>putdata</strong>(3) to create a previously non-existent raw field unless a read is first successfully performed on the dirfile.  Once the library has determined the encoding scheme for the first time, it remembers it for subsequent calls.</p>
  </dd>
  <dt>
    <p><strong>GD_BZIP2_ENDODED</strong></p>
  </dt>
  <dd>
    <p>Specifies that raw data files are compressed using the Burrows-Wheeler block sorting text compression algorithm and Huffman coding, as implemented in the bzip2 format.</p>
  </dd>
  <dt>
    <p><strong>GD_GZIP_ENDODED</strong></p>
  </dt>
  <dd>
    <p>Specifies that raw data files are compressed using Lempel-Ziv coding (LZ77) as implemented in the gzip format.</p>
  </dd>
  <dt>
    <p><strong>GD_LZMA_ENDODED</strong></p>
  </dt>
  <dd>
    <p>Specifies that raw data files are compressed using the Lempel-Ziv Markov Chain Algorithm (LZMA) as implemented in the xz container format.</p>
  </dd>
  <dt>
    <p><strong>GD_SLIM_ENCODED</strong></p>
  </dt>
  <dd>
    <p>Specifies that raw data files are compressed using the slimlib library.</p>
  </dd>
  <dt>
    <p><strong>GD_TEXT_ENCODED</strong></p>
  </dt>
  <dd>
    <p>Specifies that raw data files are encoded as text files containing one data sample per line.</p>
  </dd>
  <dt>
    <p><strong>GD_UNENCODED</strong></p>
  </dt>
  <dd>
    <p>Specifies that raw data files are not encoded, but written verbatim to disk.</p>
  </dd>

</dl>
<h3>Standards Compliance</h3>
<p>The latest Dirfile Standards Version which this release of GetData understands is provided in the preprocessor macro <strong>GD_DIRFILE_STANDARDS_VERSION</strong> defined in getdata.h.  GetData is able to open and parse any dirfile which conforms to this Standards Version, or to any earlier Version.  The <a href="../man5/dirfile-format.5.html"><strong>dirfile-format</strong>(5)</a> manual page lists the changes between Standards Versions.</p><p>The GetData parser can operate in two modes: a <em>permissive</em> mode, in which much non-Standards compliant syntax is allowed, and a <em>pedanitc</em> mode, in which the parser adheres strictly to the Standards.  If <strong>GD_PEDANTIC</strong> is passed to <strong>gd_cbopen</strong>(), the parser will start parsing the format specification in <em>pedantic</em> mode, otherwise it will start in <em>permissive</em> mode.</p><p><em>Permissive</em> mode is provided primarily to allow GetData to be used on dirfiles which conform to no single Standard, but which were accepted by the GetData parser in previous versions.  It is notably lax regarding reserved field names, and field name characters, the mixing of old and new data type specifiers, and generally ignores the presence of <strong>/VERSION</strong> directives. In read-write mode, <em>permissive</em> mode should be used with caution, as it can cause unintentional corruption of dirfile metadata on write, if the heuristics in the parser incorrectly guessed the intention of non-compliant syntax.  In <em>permissive</em> mode, actual syntax errors are still reported as such.</p><p>In <em>pedantic</em> mode, the parser conforms to one specified Standards Version. This target version may change any number of times in the course of scanning a single format specification.  If invoked using the <strong>GD_PEDANTIC</strong> flag, the parser will start in <em>pedantic</em> mode with a target version equal to <strong>GD_DIRFILE_STANDARDS_VERSION</strong>. Whenever a <strong>/VERSION</strong> directive is encountered in the format specification, the target version is changed to the Standards Version specified.  When encountering a <strong>/VERSION</strong> directive in <em>permissive</em> mode, the parser will switch to <em>pedantic</em> mode, unless the <strong>GD_PERMISSIVE</strong> flag was passed to <strong>gd_cbopen</strong>(), in which case no mode switch will take place.</p><p>Independent of the mode of the parser when parsing the format specification, GetData will calculate a list of Standards Versions to which the parsed metadata conform to.  The <a href="../man3/gd_dirfile_standards.3.html"><strong>gd_dirfile_standards</strong>(3)</a> function can provide this information, and also specify the desired Standards Version for writing format metadata back to disk.</p>
<h3>The Callback Function</h3>
<p>The caller-supplied <em>sehandler</em> function is called whenever the format specification parser encounters a syntax error (<em>i.e.</em> whenever it would return the <strong>GD_E_FORMAT</strong> error).  This callback may be used to correct the error, or to tell the parser how to recover from it.</p><p>This function should take two pointers as arguments, and return an <strong>int</strong>:</p><p><strong>int </strong><em>sehandler</em><strong>(gd_parser_data_t *</strong><em>pdata</em><strong>, void *</strong><em>extra</em><strong>);</strong></p><p>The <em>extra</em> parameter is the pointer supplied to <strong>gd_cbopen</strong>(), passed verbatim to this function.  It can be used to pass caller data to the callback.  GetData does not inspect this pointer, not even to check its validity.  If the caller needs to pass no data to the callback, it may be NULL.</p><p>The <strong>gd_parser_data_t</strong> type is a structure with at least the following members:</p>
<pre>
typedef struct {
  const DIRFILE* dirfile;
  int suberror;
  int linenum;
  const char* filename;
  char* line;
  size_t buflen;

  ...
} gd_parser_data_t;
</pre>
<p>The <em>pdata</em>-&gt;<em>dirfile</em> member will be a pointer to a DIRFILE object suitable only for passing to <strong>gd_error_string</strong>(). Notably, the caller should not assume this pointer will be the same as the pointer eventually returned by <strong>gd_cbopen</strong>(), nor that it will be valid after the callback function returns.</p><p>The <em>pdata</em>-&gt;<em>suberror</em> parameter will be one of the following symbols indicating the type of syntax error encountered:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>GD_E_FORMAT_BAD_LINE</strong></p>
  </dt>
  <dd>
    <p>The line was indecipherable.  Typically this means that the line contained neither a reserved word, nor a field type.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_BAD_NAME</strong></p>
  </dt>
  <dd>
    <p>The specified field name was invalid.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_BAD_SPF</strong></p>
  </dt>
  <dd>
    <p>The samples-per-frame of a RAW field was out-of-range.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_BAD_TYPE</strong></p>
  </dt>
  <dd>
    <p>The data type of a RAW field was unrecognised.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_BITNUM</strong></p>
  </dt>
  <dd>
    <p>The first bit of a BIT field was out-of-range.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_BITSIZE</strong></p>
  </dt>
  <dd>
    <p>The last bit of a BIT field was out-of-range.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_CHARACTER</strong></p>
  </dt>
  <dd>
    <p>An invalid character was found in the line, or a character escape sequence was malformed.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_DUPLICATE</strong></p>
  </dt>
  <dd>
    <p>The specified field name already exists.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_ENDIAN</strong></p>
  </dt>
  <dd>
    <p>The byte sex specified by an <strong>/ENDIAN</strong> directive was unrecognised.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_LITERAL</strong></p>
  </dt>
  <dd>
    <p>An unexpected character was encountered in a complex literal.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_LOCATION</strong></p>
  </dt>
  <dd>
    <p>The parent of a metafield was defined in another fragment.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_METARAW</strong></p>
  </dt>
  <dd>
    <p>An attempt was made to add a RAW metafield.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_N_FIELDS</strong></p>
  </dt>
  <dd>
    <p>The number of fields of a LINCOM field was out-of-range.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_N_TOK</strong></p>
  </dt>
  <dd>
    <p>An insufficient number of tokens was found on the line.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_NO_PARENT</strong></p>
  </dt>
  <dd>
    <p>The parent of a metafield was not found.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_NUMBITS</strong></p>
  </dt>
  <dd>
    <p>The number of bits of a BIT field was out-of-range.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_PROTECT</strong></p>
  </dt>
  <dd>
    <p>The protection level specified by a <strong>PROTECT</strong> directive was unrecognised.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_RES_NAME</strong></p>
  </dt>
  <dd>
    <p>A field was specified with the reserved name <em>INDEX</em> (or with the reserved name <em>FILEFRAM</em> in a dirfile conforming to Standards Version 5 or earlier).</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT_UNTERM</strong></p>
  </dt>
  <dd>
    <p>The last token of the line was unterminated.</p>
  </dd>

</dl>
<p><em>pdata</em>-&gt;<em>filename</em> and <em>pdata</em>-&gt;<em>linenum</em> members contains the pathname of the fragment and line number where the syntax error was encountered.  The first line in a fragment is line one.</p><p>The <em>pdata</em>-&gt;<em>line</em> member contains a copy of the line containing the syntax error.  This line may be freely modified by the callback function.  It will then be reparsed if the callback function returns the symbol <strong>GD_SYNTAX_RESCAN</strong> (see below).  The size of the memory buffer (which may be greater than the length of the actual string) is provided in <em>pdata</em>-&gt;<em>buflen</em>, and space is available for at least GD_MAX_LINE_LENGTH bytes.  A larger buffer may be used if desired, by assigning a pointer to the new buffer of the desired length to <em>pdata</em>-&gt;<em>line</em>. The new buffer should be allocated with <a href="../man3/malloc.3.html"><strong>malloc</strong>(3)</a>. It will be freed by the parser.  Do not call <a href="../man3/free.3.html"><strong>free</strong>(3)</a> or <a href="../man3/realloc.3.html"><strong>realloc</strong>(3)</a> on the original pointer passed to the callback as <em>pdata</em>-&gt;<em>line</em>: it, too, will be freed by the parser.</p><p>The callback function should return one of the following symbols, which tells the parser how to subsequently handle the error:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>GD_SYNTAX_ABORT</strong></p>
  </dt>
  <dd>
    <p>The parser should immediately abort parsing the format specification and fail with the error <strong>GD_E_FORMAT</strong>. This is the default behaviour, if no callback function is provided (or if the parser is invoked by calling <strong>gd_open</strong>()).</p>
  </dd>
  <dt>
    <p><strong>GD_SYNTAX_CONTINUE</strong></p>
  </dt>
  <dd>
    <p>The parser should continue parsing the format specification.  However, once parsing has finished, the parser will fail with the error <strong>GD_E_FORMAT</strong>, even if no further syntax errors are encountered.  This behaviour may be used by the caller to identify all lines containing syntax errors in the format specification, instead of just the first one.</p>
  </dd>
  <dt>
    <p><strong>GD_SYNTAX_IGNORE</strong></p>
  </dt>
  <dd>
    <p>The parser should ignore the line containing the syntax error completely, and carry on parsing the format specification.  If no further errors are encountered, the dirfile will be successfully opened.</p>
  </dd>
  <dt>
    <p><strong>GD_SYNTAX_RESCAN</strong></p>
  </dt>
  <dd>
    <p>The parser should rescan the <em>line</em> argument, which replaces the line which originally contained the syntax error. The line is assumed to have been corrected by the callback function.  If the line still contains a syntax error, the callback function will be called again.</p><p>Note: the line is not corrected on disk; however, the caller may subsequently correct the fragment on disk by calling <a href="../man3/gd_rewrite_fragment.3.html"><strong>gd_rewrite_fragment</strong>(3)</a>.</p>
  </dd>

</dl>
<p>The callback function handles only syntax errors.  The parser may still abort early, if a different kind of library error is encountered.  Furthermore, although a line may contain more than one syntax error, the parser will only ever report one syntax error per line, even if the callback function returns <strong>GD_SYNTAX_CONTINUE</strong>.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>A call to <strong>gd_cbopen</strong>() or <strong>gd_open</strong>() always returns a pointer to a newly allocated DIRFILE object.  The DIRFILE object is an opaque structure containing the parsed dirfile metadata. If an error occurred, the dirfile error will be set to a non-zero error value. The DIRFILE object will also be internally flagged as invalid.  Possible error values are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>GD_E_ACCMODE</strong></p>
  </dt>
  <dd>
    <p>The library was asked to create or truncate a dirfile opened read-only (i.e. <strong>GD_CREAT</strong> or <strong>GD_TRUNC</strong> was specified in <em>flags</em> along with <strong>GD_RDONLY</strong>).</p>
  </dd>
  <dt>
    <p><strong>GD_E_ALLOC</strong></p>
  </dt>
  <dd>
    <p>The library was unable to allocate memory.</p>
  </dd>
  <dt>
    <p><strong>GD_E_BAD_REFERENCE</strong></p>
  </dt>
  <dd>
    <p>The reference field specified by a <strong>/REFERENCE</strong> directive in the format specification (see <a href="../man5/dirfile-format.5.html"><strong>dirfile-format</strong>(5)</a>) was not found, or was not a <strong>RAW</strong> field.</p>
  </dd>
  <dt>
    <p><strong>GD_E_CALLBACK</strong></p>
  </dt>
  <dd>
    <p>The registered callback function, <em>sehandler</em>, returned an unrecognised response.</p>
  </dd>
  <dt>
    <p><strong>GD_E_CREAT</strong></p>
  </dt>
  <dd>
    <p>The library was unable to create the dirfile, or the dirfile exists and both <strong>GD_CREAT</strong> and <strong>GD_EXCL</strong> were specified.</p>
  </dd>
  <dt>
    <p><strong>GD_E_FORMAT</strong></p>
  </dt>
  <dd>
    <p>A syntax error occurred in the format specification.  See also <strong>The Callback Function</strong> section above.</p>
  </dd>
  <dt>
    <p><strong>GD_E_INTERNAL_ERROR</strong></p>
  </dt>
  <dd>
    <p>An internal error occurred in the library while trying to perform the task. This indicates a bug in the library.  Please report the incident to the GetData developers.</p>
  </dd>
  <dt>
    <p><strong>GD_E_LINE_TOO_LONG</strong></p>
  </dt>
  <dd>
    <p>The parser encountered a line in the format specification longer than it was able to deal with.  Lines are limited by the storage size of <strong>ssize_t</strong>. On 32-bit systems, this limits format specification lines to 2**31 bytes.  The limit is larger on 64-bit systems.</p>
  </dd>
  <dt>
    <p><strong>GD_E_OPEN</strong></p>
  </dt>
  <dd>
    <p>The dirfile format specification could not be opened, or <em>dirfilename</em> does not specify a valid dirfile.</p>
  </dd>
  <dt>
    <p><strong>GD_E_OPEN_FRAGMENT</strong></p>
  </dt>
  <dd>
    <p>A file specified in an <strong>/INCLUDE</strong> directive could not be opened.</p>
  </dd>
  <dt>
    <p><strong>GD_E_TRUNC</strong></p>
  </dt>
  <dd>
    <p>The library was unable to truncate the dirfile.</p>
  </dd>

</dl>
<p>The dirfile error may be retrieved by calling <a href="../man3/gd_error.3.html"><strong>gd_error</strong>(3)</a>. A descriptive error string for the last error encountered can be obtained from a call to <a href="../man3/gd_error_string.3.html"><strong>gd_error_string</strong>(3)</a>. When finished with it, a caller should de-allocate the DIRFILE object by calling <a href="../man3/gd_close.3.html"><strong>gd_close</strong>(3)</a>, or <a href="../man3/gd_discard.3.html"><strong>gd_discard</strong>(3)</a>, even if the open failed.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>When working with dirfiles conforming to Standards Versions 4 and earlier (before the introduction of the <strong>ENDIAN</strong> directive), GetData assumes the dirfile has native byte sex, even though, officially, these early Standards stipulated data to be little-endian.  This is necessary since, in the absense of an explicit <strong>/VERSION</strong> directive, it is often impossible to determine the intended Standards Version of a dirfile, and the current behaviour is to assume native byte sex for modern dirfiles lacking <strong>/ENDIAN</strong>. To read an old, little-ended dirfile on a big-ended platform, an <strong>/ENDIAN</strong> directive should be added to the format specification, or else <strong>GD_LITTLE_ENDIAN</strong> should be specified by the caller.</p><p>GetData artifically limits the size of a <strong>CARRAY</strong> field to GD_MAX_CARRAY_LENGTH elements, to be certain it is always able to write the CARRAY back to disk without overrunning its maximum line length. On 32-bit systems, GD_MAX_CARRAY_LENGTH is 2**24.  It is larger on 64-bit systems.  Excess elements are silently truncatd on dirfile open.</p><p>GetData's parser assumes it is running on an ASCII-compatible platform.  Format specification parsing will fail gloriously on an EBCDIC platform.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO gd_cbopen&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/dirfile.5.html"><strong>dirfile</strong>(5)</a>, <a href="../man5/dirfile-encoding.5.html"><strong>dirfile-encoding</strong>(5)</a>, <a href="../man5/dirfile-format.5.html"><strong>dirfile-format</strong>(5)</a>, <a href="../man3/gd_close.3.html"><strong>gd_close</strong>(3)</a>, <a href="../man3/gd_dirfile_standards.3.html"><strong>gd_dirfile_standards</strong>(3)</a>, <a href="../man3/gd_discard.3.html"><strong>gd_discard</strong>(3)</a>, <a href="../man3/gd_error.3.html"><strong>gd_error</strong>(3)</a>, <a href="../man3/gd_error_string.3.html"><strong>gd_error_string</strong>(3)</a>, <a href="../man3/gd_getdata.3.html"><strong>gd_getdata</strong>(3)</a>, <a href="../man3/gd_include.3.html"><strong>gd_include</strong>(3)</a>, <a href="../man3/gd_parser_callback.3.html"><strong>gd_parser_callback</strong>(3)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="gd_carrays.3.html"><span aria-hidden="true">&larr;</span> gd_carrays.3: Gd_constants  retrieve a list of carray values from a dirfile</a></li>
   <li class="next"><a href="gd_close.3.html">gd_close.3: Gd_close, gd_discard  close a dirfile and free associated memory. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
