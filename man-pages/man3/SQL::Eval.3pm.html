<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SQL::Eval: Base for deriving evaluation objects for sql::statement</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Base for deriving evaluation objects for sql::statement">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="SQL::Eval (3pm) manual">
  <meta name="twitter:description" content="Base for deriving evaluation objects for sql::statement">
  <meta name="twitter:image" content="https://www.carta.tech/images/libsql-statement-perl-SQL::Eval-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/SQL::Eval.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="SQL::Eval (3pm) manual" />
  <meta property="og:description" content="Base for deriving evaluation objects for sql::statement" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libsql-statement-perl-SQL::Eval-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">SQL::Eval<small> (3pm)</small></h1>
        <p class="lead">Base for deriving evaluation objects for sql::statement</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/SQL::Eval.3pm.html">
      <span itemprop="name">SQL::Eval: Base for deriving evaluation objects for sql::statement</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libsql-statement-perl/">
      <span itemprop="name">libsql-statement-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/SQL::Eval.3pm.html">
      <span itemprop="name">SQL::Eval: Base for deriving evaluation objects for sql::statement</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    require SQL::Statement;
    require SQL::Eval;

    # Create an SQL statement; use a concrete subclass of
    # SQL::Statement
    my $stmt = MyStatement-&gt;new("SELECT * FROM foo, bar",
                                SQL::Parser-&gt;new(&apos;Ansi&apos;));

    # Get an eval object by calling open_tables; this
    # will call MyStatement::open_table
    my $eval = $stmt-&gt;open_tables($data);

    # Set parameter 0 to &apos;Van Gogh&apos;
    $eval-&gt;param(0, &apos;Van Gogh&apos;);
    # Get parameter 2
    my $param = $eval-&gt;<strong>param</strong>(2);

    # Get the SQL::Eval::Table object referring the &apos;foo&apos; table
    my $fooTable = $eval-&gt;table(&apos;foo&apos;);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This module implements two classes that can be used for deriving subclasses to evaluate SQL::Statement objects. The SQL::Eval object can be thought as an abstract state engine for executing \s-1SQL\s0 queries and the SQL::Eval::Table object is a table abstraction. It implements methods for fetching or storing rows, retrieving column names and numbers and so on.  See the \*(C`test.pl\*(C' script as an example for implementing a subclass.</p><p>While reading on, keep in mind that these are abstract classes, you *must* implement at least some of the methods described below. In addition, you need not derive from SQL::Eval or SQL::Eval::Table, you just need to implement the method interface.</p><p>All methods throw a Perl exception in case of errors.</p><h3>Method interface of SQL::Eval</h3>

<dl class='dl-vertical'>
  <dt>
    new
  </dt>
  <dd>
    <p>Constructor; use it like this:     $eval = SQL::Eval-&gt;new(&#92;%attr); Blesses the hash ref &#92;%attr into the SQL::Eval class (or a subclass).</p>
  </dd>
  <dt>
    param
  </dt>
  <dd>
    <p>Used for getting or setting input parameters, as in the \s-1SQL\s0 query     INSERT INTO foo VALUES (?, ?); Example:     $eval-&gt;param(0, $val);        # Set parameter 0     $eval-&gt;<strong>param</strong>(0);              # Get parameter 0</p>
  </dd>
  <dt>
    params
  </dt>
  <dd>
    <p>Used for getting or setting the complete array of input parameters. Example:     $eval-&gt;params($params);       # Set the array     $eval-&gt;params();              # Get the array</p>
  </dd>
  <dt>
    table
  </dt>
  <dd>
    <p>Returns or sets a table object. Example:     $eval-&gt;table(&apos;foo&apos;, $fooTable);  # Set the &apos;foo&apos; table object     $eval-&gt;table(&apos;foo&apos;);             # Return the &apos;foo&apos; table object</p>
  </dd>
  <dt>
    column
  </dt>
  <dd>
    <p>Return the value of a column with a given name; example:     $col = $eval-&gt;column(&apos;foo&apos;, &apos;id&apos;);  # Return the &apos;id&apos; column of                                         # the current row in the                                         # &apos;foo&apos; table This is equivalent to and a shorthand for     $col = $eval-&gt;table(&apos;foo&apos;)-&gt;column(&apos;id&apos;);</p>
  </dd>
  <dt>
    _gen_access_fastpath
  </dt>
  <dd>
    <p>Return a subroutine reference for fast accessing columns for read-only access. This routine simply returns the \*(C`_gen_access_fastpath\*(C' of the referenced table.</p>
  </dd>

</dl>

<h3>Method interface of SQL::Eval::Table</h3>

<dl class='dl-vertical'>
  <dt>
    new
  </dt>
  <dd>
    <p>Constructor; use it like this:     $eval = SQL::Eval::Table-&gt;new(&#92;%attr); Blesses the hash ref &#92;%attr into the SQL::Eval::Table class (or a subclass). The following attributes are used by \*(C`SQL::Eval::Table\*(C':</p>
<dl class='dl-vertical'>
  <dt>
    col_names
  </dt>
  <dd>
    <p>Array reference containing the names of the columns in order they appear in the table. This attribute <strong>must</strong> be provided by the derived class.</p>
  </dd>
  <dt>
    col_nums
  </dt>
  <dd>
    <p>Hash reference containing the column names as keys and the column indexes as values. If this is omitted (does not exist), it will be created from \*(C`col_names\*(C'.</p>
  </dd>
  <dt>
    capabilities
  </dt>
  <dd>
    <p>Hash reference containing additional capabilities.</p>
  </dd>
  <dt>
    _gen_access_fastpath
  </dt>
  <dd>
    <p>Return a subroutine reference for fast accessing columns for read-only access. When the instantiated object doesn't provide own methods for \*(C`column\*(C' and \*(C`column_num\*(C' a subroutine reference is returned which directly access the internal data structures. For all other cases a subroutine directly calling \*(C`$self-&gt;column($_[0])\*(C' is returned.</p>
  </dd>

</dl>

  </dd>
  <dt>
    row
  </dt>
  <dd>
    <p>Used to get the current row as an array ref. Do not confuse getting the current row with the fetch_row method! In fact this method is valid only after a successful \*(C`$table-&gt;fetchrow()\*(C'. Example:     $row = $table-&gt;row();</p>
  </dd>
  <dt>
    column
  </dt>
  <dd>
    <p>Get the column with a given name in the current row. Valid only after a successful \*(C`$table-&gt;fetchrow()\*(C'. Example:     $col = $table-&gt;column($colName);</p>
  </dd>
  <dt>
    column_num
  </dt>
  <dd>
    <p>Return the number of the given column name. Column numbers start with 0. Returns undef, if a column name is not defined, so that you can use this for verifying column names. Example:     $colNum = $table-&gt;column_num($colNum);</p>
  </dd>
  <dt>
    col_nums
  </dt>
  <dd>
    <p>Returns an hash ref of column names with the column names as keys and the column indexes as the values.</p>
  </dd>
  <dt>
    col_names
  </dt>
  <dd>
    <p>Returns an array ref of column names ordered by their index within the table.</p>
  </dd>
  <dt>
    capability
  </dt>
  <dd>
    <p>Returns a boolean value whether the table has the specified capability or not. This method might be overridden by derived classes, but ensure that in that case the parent capability method is called when the derived class does not handle the requested capability. The following capabilities are used (and requested) by SQL::Statement:</p>
<dl class='dl-vertical'>
  <dt>
    update_one_row
  </dt>
  <dd>
    <p>Defines whether the table is able to update one single row. This capability is used for backward compatibility and might have (depending on table implementation) several limitations. Please carefully study the documentation of the table or ask the author of the table, if this information is not provided. This capability is evaluated automatically on first request and must not be handled by any derived classes.</p>
  </dd>
  <dt>
    update_specific_row
  </dt>
  <dd>
    <p>Defines if the table is able to update one single row, but keeps the original content of the row to update. This capability is evaluated automatically on first request and must not be handled by derived classes.</p>
  </dd>
  <dt>
    update_current_row
  </dt>
  <dd>
    <p>Defines if the table is able to update the currently touched row. This capability requires the capability of \*(C`inplace_update\*(C'. This capability is evaluated automatically on first request and must not be handled by derived classes.</p>
  </dd>
  <dt>
    rowwise_update
  </dt>
  <dd>
    <p>Defines if the table is able to do row-wise updates which means one of \*(C`update_one_row\*(C', \*(C`update_specific_row\*(C' or \*(C`update_current_row\*(C'. The \*(C`update_current_row\*(C' is only evaluated if the table has the \*(C`inplace_update\*(C' capability. This capability is evaluated automatically on first request and must not be handled by derived classes.</p>
  </dd>
  <dt>
    inplace_update
  </dt>
  <dd>
    <p>Defines if an update of a row has side effects (capability is not available) or can be done without harming any other currently running task on the table. Example: The table storage is using a hash on the \*(C`PRIMARY KEY\*(C' of the table. Real perl hashes do not care when an item is updated while the hash is traversed using \*(C`each\*(C'. \*(C`SDBM_File\*(C' 1.06 has a bug, which does not adjust the traversal pointer when an item is deleted. \*(C`SQL::Statement::RAM::Table\*(C' recognizes such situations and adjusts the traversal pointer. This might not be possible for all implementations which can update single rows. This capability could be provided by a derived class only.</p>
  </dd>
  <dt>
    delete_one_row
  </dt>
  <dd>
    <p>Defines whether the table can delete one single row by it's content or not. This capability is evaluated automatically on first request and must not be handled by derived classes.</p>
  </dd>
  <dt>
    delete_current_row
  </dt>
  <dd>
    <p>Defines whether a table can delete the current traversed row or not. This capability requires the \*(C`inplace_delete\*(C' capability. This capability is evaluated automatically on first request and must not be handled by derived classes.</p>
  </dd>
  <dt>
    rowwise_delete
  </dt>
  <dd>
    <p>Defines if any row-wise delete operation is provided by the table. \*(C`row-wise\*(C' delete capabilities are \*(C`delete_one_row\*(C' and \*(C`delete_current_row\*(C'. This capability is evaluated automatically on first request and must not be handled by derived classes.</p>
  </dd>
  <dt>
    inplace_delete
  </dt>
  <dd>
    <p>Defines if the deletion of a row has side effects (capability is not available) or can be done without harming any other currently running task on the table. This capability should be provided by a derived class only.</p>
  </dd>
  <dt>
    insert_new_row
  </dt>
  <dd>
    <p>Defines if a table can easily insert a new row without need to seek or truncate. This capability is provided by defining the table class method \*(C`insert_new_row\*(C'. This capability is evaluated automatically on first request and must not be handled by derived classes.</p>
  </dd>

</dl>
<p>If the capabilities <em>rowwise_update</em> and <em>insert_new_row</em> are provided, the table primitive \*(C`push_row\*(C' is not required anymore and may be omitted.</p>
  </dd>

</dl>
<p>The above methods are implemented by SQL::Eval::Table. The following methods are not, so that they *must* be implemented by the subclass. See the \*(C`DBD::DBM::Table\*(C' or \*(C`DBD::CSV::Table\*(C' for example.</p>
<dl class='dl-vertical'>
  <dt>
    drop
  </dt>
  <dd>
    <p>Drops the table. All resources allocated by the table must be released after \*(C`$table-\*(C'drop($data)&gt;.</p>
  </dd>
  <dt>
    fetch_row
  </dt>
  <dd>
    <p>Fetches the next row from the table. Returns \*(C`undef\*(C', if the last row was already fetched. The argument $data is for private use of the subclass. Example:     $row = $table-&gt;fetch_row($data); Note, that you may use     $row = $table-&gt;row(); for retrieving the same row again, until the next call of \*(C`fetch_row\*(C'. \*(C`SQL::Statement\*(C' requires that the last fetched row is available again and again via \*(C`$table-\*(C'<em>row()</em>&gt;.</p>
  </dd>
  <dt>
    push_row
  </dt>
  <dd>
    <p>As fetch_row except for storing rows. Example:     $table-&gt;push_row($data, $row);</p>
  </dd>
  <dt>
    push_names
  </dt>
  <dd>
    <p>Used by the <em>\s-1CREATE\s0 \s-1TABLE\s0</em> statement to set the column names of the new table. Receives an array ref of names. Example:     $table-&gt;push_names($data, $names);</p>
  </dd>
  <dt>
    seek
  </dt>
  <dd>
    <p>Similar to the seek method of a filehandle; used for setting the number of the next row being written. Example:     $table-&gt;seek($data, $whence, $rowNum); Actually the current implementation only uses \*(C`seek($data, 0, 0)\*(C' (first row) and \*(C`seek($data, 2, 0)\*(C' (beyond last row, end of file).</p>
  </dd>
  <dt>
    truncate
  </dt>
  <dd>
    <p>Truncates a table after the current row. Example:     $table-&gt;truncate($data);</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INTERNALS</h2>
        <div class="sectioncontent">
<p>The current implementation is quite simple: An SQL::Eval object is an hash ref with only two attributes. The \*(C`params\*(C' attribute is an array ref of parameters. The \*(C`tables\*(C' attribute is an hash ref of table names (keys) and table objects (values).</p><p>SQL::Eval::Table instances are implemented as hash refs. Attributes used are \*(C`row\*(C' (the array ref of the current row), \*(C`col_nums\*(C' (an hash ref of column names as keys and column numbers as values) and \*(C`col_names\*(C', an array ref of column names with the column numbers as indexes.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MULTITHREADING</h2>
        <div class="sectioncontent">
<p>All methods are working with instance-local data only, thus the module is reentrant and thread safe, if you either don't share handles between threads or grant serialized use.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Please report any bugs or feature requests to \*(C`bug-sql-statement at rt.cpan.org\*(C', or through the web interface at http://rt.cpan.org/NoAuth/ReportBug.html?Queue=SQL-Statement &lt;http://rt.cpan.org/NoAuth/ReportBug.html?Queue=SQL-Statement&gt;.  I will be notified, and then you will automatically be notified of progress on your bug as I make changes.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SUPPORT</h2>
        <div class="sectioncontent">
<p>You can find documentation for this module with the perldoc command.</p><p>    perldoc SQL::Eval     perldoc SQL::Statement</p><p>You can also look for information at:</p><ul>
<li><p>\s-1RT:\s0 \s-1CPAN\s0's request tracker http://rt.cpan.org/NoAuth/Bugs.html?Dist=SQL-Statement &lt;http://rt.cpan.org/NoAuth/Bugs.html?Dist=SQL-Statement&gt;</p></li><li><p>AnnoCPAN: Annotated \s-1CPAN\s0 documentation http://annocpan.org/dist/SQL-Statement &lt;http://annocpan.org/dist/SQL-Statement&gt;</p></li><li><p>\s-1CPAN\s0 Ratings http://cpanratings.perl.org/s/SQL-Statement &lt;http://cpanratings.perl.org/s/SQL-Statement&gt;</p></li><li><p>Search \s-1CPAN\s0 http://search.cpan.org/dist/SQL-Statement/ &lt;http://search.cpan.org/dist/SQL-Statement/&gt;</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR AND COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Written by Jochen Wiedmann and currently maintained by Jens Rehsack.</p><p>This module is Copyright (C) 1998 by</p><p>    Jochen Wiedmann     Am Eisteich 9     72555 Metzingen     Germany</p><p>    Email: joe@ispsoft.de     Phone: +49 7123 14887</p><p>and Copyright (C) 2009, 2010 by</p><p>     Jens Rehsack &lt; rehsackATcpan.org&gt;</p><p>All rights reserved.</p><p>You may distribute this module under the terms of either the \s-1GNU\s0 General Public License or the Artistic License, as specified in the Perl \s-1README\s0 file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO SQL::Eval&hellip;</h2>
        <div class="sectioncontent">
<p><em>SQL::Statement</em>\|(3)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="SQL::Dialects::Role.3pm.html"><span aria-hidden="true">&larr;</span> SQL::Dialects::Role.3pm: The role of being a sql::dialect</a></li>
   <li class="next"><a href="SQL::Parser.3pm.html">SQL::Parser.3pm:  <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
