<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Excel::Writer::XLSX::Chart::Pie: A class for writing excel pie charts.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A class for writing excel pie charts.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Excel::Writer::XLSX::Chart::Pie (3pm) manual">
  <meta name="twitter:description" content="A class for writing excel pie charts.">
  <meta name="twitter:image" content="https://www.carta.tech/images/libexcel-writer-xlsx-perl-Excel::Writer::XLSX::Chart::Pie-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Excel::Writer::XLSX::Chart::Pie.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Excel::Writer::XLSX::Chart::Pie (3pm) manual" />
  <meta property="og:description" content="A class for writing excel pie charts." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libexcel-writer-xlsx-perl-Excel::Writer::XLSX::Chart::Pie-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Excel::Writer::XLSX::Chart::Pie<small> (3pm)</small></h1>
        <p class="lead">A class for writing excel pie charts.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Excel::Writer::XLSX::Chart::Pie.3pm.html">
      <span itemprop="name">Excel::Writer::XLSX::Chart::Pie: A class for writing excel pie charts.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libexcel-writer-xlsx-perl/">
      <span itemprop="name">libexcel-writer-xlsx-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Excel::Writer::XLSX::Chart::Pie.3pm.html">
      <span itemprop="name">Excel::Writer::XLSX::Chart::Pie: A class for writing excel pie charts.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>To create a simple Excel file with a Pie chart using Excel::Writer::XLSX:</p>
<pre>
    #!/usr/bin/perl

    use strict;
    use warnings;
    use Excel::Writer::XLSX;

    my $workbook  = Excel::Writer::XLSX-&gt;new( &apos;chart.xlsx&apos; );
    my $worksheet = $workbook-&gt;add_worksheet();

    my $chart     = $workbook-&gt;add_chart( type =&gt; &apos;pie&apos; );

    # Configure the chart.
    $chart-&gt;add_series(
        categories =&gt; &apos;=Sheet1!$A$2:$A$7&apos;,
        values     =&gt; &apos;=Sheet1!$B$2:$B$7&apos;,
    );

    # Add the worksheet data the chart refers to.
    my $data = [
        [ &apos;Category&apos;, 2, 3, 4, 5, 6, 7 ],
        [ &apos;Value&apos;,    1, 4, 5, 2, 1, 5 ],
    ];

    $worksheet-&gt;write( &apos;A1&apos;, $data );

    _\|_END_\|_
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This module implements Pie charts for Excel::Writer::XLSX. The chart object is created via the Workbook \*(C`add_chart()\*(C' method:</p><p>    my $chart = $workbook-&gt;add_chart( type =&gt; &apos;pie&apos; );</p><p>Once the object is created it can be configured via the following methods that are common to all chart classes:</p><p>    $chart-&gt;add_series();     $chart-&gt;set_title();</p><p>These methods are explained in detail in Excel::Writer::XLSX::Chart. Class specific methods or settings, if any, are explained below.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Pie Chart Methods</h2>
        <div class="sectioncontent">
<h3>\fIset_rotation()\fP</h3>
<p>The \*(C`set_rotation()\*(C' method is used to set the rotation of the first segment of a Pie/Doughnut chart. This has the effect of rotating the entire chart:</p><p>    $chart-&gt;set_rotation( 90 );</p><p>The angle of rotation must be \*(C`0 &lt;= rotation &lt;= 360\*(C'.</p>
<h3>User defined colors</h3>
<p>It is possible to define chart colors for most types of Excel::Writer::XLSX charts via the <em>add_series()</em> method. However, Pie/Doughnut charts are a special case since each segment is represented as a point so it is necessary to assign formatting to each point in the series:</p><p>    $chart-&gt;add_series(         values =&gt; &apos;=Sheet1!$A$1:$A$3&apos;,         points =&gt; [             { fill =&gt; { color =&gt; &apos;#FF0000&apos; } },             { fill =&gt; { color =&gt; &apos;#CC0000&apos; } },             { fill =&gt; { color =&gt; &apos;#990000&apos; } },         ],     );</p><p>See the main Excel::Writer::XLSX::Chart documentation for more details.</p><p>Pie charts support leader lines:</p><p>    $chart-&gt;add_series(         name        =&gt; &apos;Pie sales data&apos;,         categories  =&gt; [ &apos;Sheet1&apos;, 1, 3, 0, 0 ],         values      =&gt; [ &apos;Sheet1&apos;, 1, 3, 1, 1 ],         data_labels =&gt; {             series_name  =&gt; 1,             percentage   =&gt; 1,             leader_lines =&gt; 1,             position     =&gt; &apos;outside_end&apos;         },     );</p><p>Note: Even when leader lines are turned on they aren't automatically visible in Excel or Excel::Writer::XLSX. Due to an Excel limitation (or design) leader lines only appear if the data label is moved manually or if the data labels are very close and need to be adjusted automatically.</p>
<h3>Unsupported Methods</h3>
<p>A Pie chart doesn't have an X or Y axis so the following common chart methods are ignored.</p><p>    $chart-&gt;set_x_axis();     $chart-&gt;set_y_axis();</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>Here is a complete example that demonstrates most of the available features when creating a chart.</p><p>    #!/usr/bin/perl</p><p>    use strict;     use warnings;     use Excel::Writer::XLSX;</p><p>    my $workbook  = Excel::Writer::XLSX-&gt;new( &apos;chart_pie.xlsx&apos; );     my $worksheet = $workbook-&gt;add_worksheet();     my $bold      = $workbook-&gt;add_format( bold =&gt; 1 );</p><p>    # Add the worksheet data that the charts will refer to.     my $headings = [ &apos;Category&apos;, &apos;Values&apos; ];     my $data = [         [ &apos;Apple&apos;, &apos;Cherry&apos;, &apos;Pecan&apos; ],         [ 60,       30,       10     ],     ];</p><p>    $worksheet-&gt;write( &apos;A1&apos;, $headings, $bold );     $worksheet-&gt;write( &apos;A2&apos;, $data );</p><p>    # Create a new chart object. In this case an embedded chart.     my $chart = $workbook-&gt;add_chart( type =&gt; &apos;pie&apos;, embedded =&gt; 1 );</p><p>    # Configure the series. Note the use of the array ref to define ranges:     # [ $sheetname, $row_start, $row_end, $col_start, $col_end ].     $chart-&gt;add_series(         name       =&gt; &apos;Pie sales data&apos;,         categories =&gt; [ &apos;Sheet1&apos;, 1, 3, 0, 0 ],         values     =&gt; [ &apos;Sheet1&apos;, 1, 3, 1, 1 ],     );</p><p>    # Add a title.     $chart-&gt;set_title( name =&gt; &apos;Popular Pie Types&apos; );</p><p>    # Set an Excel chart style. Colors with white outline and shadow.     $chart-&gt;set_style( 10 );</p><p>    # Insert the chart into the worksheet (with an offset).     $worksheet-&gt;insert_chart( &apos;C2&apos;, $chart, 25, 10 );</p><p>    _\|_END_\|_</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>John McNamara jmcnamara@cpan.org</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright MM-MMXIIII, John McNamara.</p><p>All Rights Reserved. This module is free software. It may be used, redistributed and/or modified under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Excel::Writer::XLSX::Chart::Line.3pm.html"><span aria-hidden="true">&larr;</span> Excel::Writer::XLSX::Chart::Line.3pm: A class for writing excel line charts.</a></li>
   <li class="next"><a href="Excel::Writer::XLSX::Chart::Radar.3pm.html">Excel::Writer::XLSX::Chart::Radar.3pm: A class for writing excel radar charts. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
