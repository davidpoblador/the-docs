<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>erts_alloc_config: Configuration tool for erts_alloc</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Configuration tool for erts_alloc">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="erts_alloc_config (3erl) manual">
  <meta name="twitter:description" content="Configuration tool for erts_alloc">
  <meta name="twitter:image" content="https://www.carta.tech/images/erlang-manpages-erts_alloc_config-3erl.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3erl/erts_alloc_config.3erl.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="erts_alloc_config (3erl) manual" />
  <meta property="og:description" content="Configuration tool for erts_alloc" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/erlang-manpages-erts_alloc_config-3erl.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">erts_alloc_config<small> (3erl)</small></h1>
        <p class="lead">Configuration tool for erts_alloc</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3erl/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3erl/erts_alloc_config.3erl.html">
      <span itemprop="name">erts_alloc_config: Configuration tool for erts_alloc</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/erlang-manpages/">
      <span itemprop="name">erlang-manpages</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3erl/erts_alloc_config.3erl.html">
      <span itemprop="name">erts_alloc_config: Configuration tool for erts_alloc</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong></strong> Note:</p><p><em>erts_alloc_config</em> is currently an experimental tool and might be subject to backward incompatible changes.</p><p><strong>erts_alloc(3erl)</strong> is an Erlang Run-Time System internal memory allocator library. <em>erts_alloc_config</em> is intended to be used to aid creation of an <strong>erts_alloc(3erl)</strong> configuration that is suitable for a limited number of runtime scenarios. The configuration that <em>erts_alloc_config</em> produce is intended as a suggestion, and may need to be adjusted manually.</p><p>The configuration is created based on information about a number of runtime scenarios. It is obviously impossible to foresee every runtime scenario that can occur. The important scenarios are those that cause maximum or minimum load on specific memory allocators. Load in this context is total size of memory blocks allocated.</p><p>The current implementation of <em>erts_alloc_config</em> concentrate on configuration of multi-block carriers. Information gathered when a runtime scenario is saved is mainly current and maximum use of multi-block carriers. If a parameter that change the use of multi-block carriers is changed, a previously generated configuration is invalid and <em>erts_alloc_config</em> needs to be run again. It is mainly the single block carrier threshold that effects the use of multi-block carriers, but other single-block carrier parameters might as well. If another value of a single block carrier parameter than the default is desired, use the desired value when running <em>erts_alloc_config</em>.</p><p>A configuration is created in the following way:</p>
<dl class='dl-vertical'>
  <dt>
    <p>*</p>
  </dt>
  <dd>
    <p>Pass the <strong>+Mea config</strong> command-line flag to the Erlang runtime system you are going to use for creation of the allocator configuration. It will disable features that prevent <em>erts_alloc_config</em> from doing its job. Note, you should <em>not</em> use this flag when using the created configuration. Also note that it is important that you use the same <strong>amount of schedulers</strong> when creating the configuration as you are going the use on the system using the configuration.</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    <p>*</p>
  </dt>
  <dd>
    <p>Run your applications with different scenarios (the more the better) and save information about each scenario by calling <strong>save_scenario/0</strong>. It may be hard to know when the applications are at an (for <em>erts_alloc_config</em>) important runtime scenario. A good approach may therefore be to call <strong>save_scenario/0</strong> repeatedly, e.g. once every tenth second. Note that it is important that your applications reach the runtime scenarios that are important for <em>erts_alloc_config</em> when you are saving scenarios; otherwise, the configuration may perform bad.</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    <p>*</p>
  </dt>
  <dd>
    <p>When you have covered all scenarios, call <strong>make_config/1</strong> in order to create a configuration. The configuration is written to a file that you have chosen. This configuration file can later be read by an Erlang runtime-system at startup. Pass the command line argument <strong>-args_file FileName</strong> to the <a href="../man1/erl.1.html"><strong>erl</strong>(1)</a></strong> command.</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    <p>*</p>
  </dt>
  <dd>
    <p>The configuration produced by <em>erts_alloc_config</em> may need to be manually adjusted as already stated. Do not modify the file produced by <em>erts_alloc_config</em>; instead, put your modifications in another file and load this file after the file produced by <em>erts_alloc_config</em>. That is, put the <strong>-args_file FileName</strong> argument that reads your modification file later on the command-line than the <strong>-args_file FileName</strong> argument that reads the configuration file produced by <em>erts_alloc_config</em>. If a memory allocation parameter appear multiple times, the last version of will be used, i.e., you can override parameters in the configuration file produced by <em>erts_alloc_config</em>. Doing it this way simplifies things when you want to rerun <em>erts_alloc_config</em>.</p>
  </dd>

</dl>
<p><strong></strong> Note:</p><p>The configuration created by <em>erts_alloc_config</em> may perform bad, ever horrible, for runtime scenarios that are very different from the ones saved when creating the configuration. You are, therefore, advised to rerun <em>erts_alloc_config</em> if the applications run when the configuration was made are changed, or if the load on the applications have changed since the configuration was made. You are also advised to rerun <em>erts_alloc_config</em> if the Erlang runtime system used is changed.</p><p><em>erts_alloc_config</em> saves information about runtime scenarios and performs computations in a server that is automatically started. The server register itself under the name <em>'__erts_alloc_config__'</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXPORTS</h2>
        <div class="sectioncontent">
<p><strong></strong> save_scenario() -&gt; ok | {error, Error}</p><p>Types:</p><p>Error = term()</p><p><em>save_scenario/0</em> saves information about the current runtime scenario. This information will later be used when <strong>make_config/0</strong>, or <strong>make_config/1</strong> is called.</p><p>The first time <em>save_scenario/0</em> is called a server will be started. This server will save runtime scenarios. All saved scenarios can be removed by calling <strong>stop/0</strong>.</p><p><strong></strong> make_config() -&gt; ok | {error, Error}</p><p>Types:</p><p>Error = term()</p><p>This is the same as calling <strong>make_config(group_leader())</strong>.</p><p><strong></strong> make_config(FileNameOrIODev) -&gt; ok | {error, Error}</p><p>Types:</p><p>FileNameOrIODev = string() | io_device()</p><p>Error = term()</p><p><em>make_config/1</em> uses the information previously saved by <strong>save_scenario/0</strong> in order to produce an <em>erts_alloc</em> configuration. At least one scenario have had to be saved. All scenarios previously saved will be used when creating the configuration.</p><p>If <em>FileNameOrIODev</em> is a <em>string()</em>, <em>make_config/1</em> will use <em>FileNameOrIODev</em> as a filename. A file named <em>FileNameOrIODev</em> is created and the configuration will be written to that file. If <em>FileNameOrIODev</em> is an <strong>io_device()</strong> (see the documentation of the module <strong>io</strong>), the configuration will be written to the io device.</p><p><strong></strong> stop() -&gt; ok | {error, Error}</p><p>Types:</p><p>Error = term()</p><p>Stops the server that saves runtime scenarios.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO erts_alloc_config&hellip;</h2>
        <div class="sectioncontent">
<p><strong>erts_alloc(3erl)</strong>, <a href="../man1/erl.1.html"><strong>erl</strong>(1)</a></strong>, <strong>io(3erl)</strong></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="erts_alloc.3erl.html"><span aria-hidden="true">&larr;</span> erts_alloc.3erl: An erlang run-time system internal memory allocator library.</a></li>
   <li class="next"><a href="et.3erl.html">et.3erl: Main api of the event trace (et) application <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
