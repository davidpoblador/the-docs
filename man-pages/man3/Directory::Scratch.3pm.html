<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Directory::Scratch: Easy-to-use self-cleaning scratch space.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Easy-to-use self-cleaning scratch space.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Directory::Scratch (3pm) manual">
  <meta name="twitter:description" content="Easy-to-use self-cleaning scratch space.">
  <meta name="twitter:image" content="https://www.carta.tech/images/libdirectory-scratch-perl-Directory::Scratch-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Directory::Scratch.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Directory::Scratch (3pm) manual" />
  <meta property="og:description" content="Easy-to-use self-cleaning scratch space." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libdirectory-scratch-perl-Directory::Scratch-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Directory::Scratch<small> (3pm)</small></h1>
        <p class="lead">Easy-to-use self-cleaning scratch space.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Directory::Scratch.3pm.html">
      <span itemprop="name">Directory::Scratch: Easy-to-use self-cleaning scratch space.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libdirectory-scratch-perl/">
      <span itemprop="name">libdirectory-scratch-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Directory::Scratch.3pm.html">
      <span itemprop="name">Directory::Scratch: Easy-to-use self-cleaning scratch space.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>When writing test suites for modules that operate on files, it's often inconvenient to correctly create a platform-independent temporary storage space, manipulate files inside it, then clean it up when the test exits.  The inconvenience usually results in tests that don't work everwhere, or worse, no tests at all.</p><p>This module aims to eliminate that problem by making it easy to do things right.</p><p>Example:</p>
<pre>
    use Directory::Scratch;

    my $temp = Directory::Scratch-&gt;new();
    my $dir  = $temp-&gt;mkdir(&apos;foo/bar&apos;);
    my @lines= qw(This is a file with lots of lines);
    my $file = $temp-&gt;touch(&apos;foo/bar/baz&apos;, @lines);

    my $fh = openfile($file);
    print {$fh} "Here is another line.&#92;n";
    close $fh;

    $temp-&gt;delete(&apos;foo/bar/baz&apos;);

    undef $temp; # everything else is removed

    # Directory::Scratch objects stringify to base
    $temp-&gt;touch(&apos;foo&apos;);
    ok(-e "$temp/foo");  # /tmp/xYz837/foo should exist
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXPORT</h2>
        <div class="sectioncontent">
<p>The first argument to the module is optional, but if specified, it's interperted as the name of the \s-1OS\s0 whose file naming semantics you want to use with Directory::Scratch.  For example, if you choose \*(L"Unix\*(R", then you can provide paths to Directory::Scratch in UNIX-form ('foo/bar/baz') on any platform.  Unix is the default if you don't choose anything explicitly.</p><p>If you want to use the local platform's flavor (not recommended), specify an empty import list:</p><p>    use Directory::Scratch &apos;&apos;; # use local path flavor</p><p>Recognized platforms (from File::Spec):</p>
<dl class='dl-vertical'>
  <dt>
    Mac
  </dt>
  <dd>
    
  </dd>
  <dt>
    \s-1UNIX\s0
  </dt>
  <dd>
    
  </dd>
  <dt>
    Win32
  </dt>
  <dd>
    
  </dd>
  <dt>
    \s-1VMS\s0
  </dt>
  <dd>
    
  </dd>
  <dt>
    \s-1OS2\s0
  </dt>
  <dd>
    
  </dd>

</dl>
<p>The names are case sensitive, since they simply specify which \*(C`File::Spec::\*(C' module to use when splitting the path.</p><h3>\s-1EXAMPLE\s0</h3>
<p>    use Directory::Scratch &apos;Win32&apos;;     my $tmp = Directory::Scratch-&gt;new();     $tmp-&gt;touch("foo&#92;&#92;bar&#92;&#92;baz"); # and so on</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>The file arguments to these methods are always relative to the temporary directory.  If you specify \*(C`touch(&apos;/etc/passwd&apos;)\*(C', then a file called \*(C`/tmp/whatever/etc/passwd\*(C' will be created instead.</p><p>This means that the program's \s-1PWD\s0 is ignored (for these methods), and that a leading \*(C`/\*(C' on the filename is meaningless (and will cause portability problems).</p><p>Finally, whenever a filename or path is returned, it is a Path::Class object rather than a string containing the filename.  Usually, this object will act just like the string, but to be extra-safe, call \*(C`$path-&gt;stringify\*(C' to ensure that you're really getting a string.  (Some clever modules try to determine whether a variable is a filename or a filehandle; these modules usually guess wrong when confronted with a \*(C`Path::Class\*(C' object.)</p><h3>new</h3>
<p>Creates a new temporary directory (via File::Temp and its defaults). When the object returned by this method goes out of scope, the directory and its contents are removed.</p><p>    my $temp = Directory::Scratch-&gt;new;     my $another = $temp-&gt;new(); # will be under $temp</p><p>    # some File::Temp arguments get passed through (may be less portable)     my $temp = Directory::Scratch-&gt;new(         DIR      =&gt; &apos;/var/tmp&apos;,       # be specific about where your files go         CLEANUP  =&gt; 0,                # turn off automatic cleanup         TEMPLATE =&gt; &apos;ScratchDirXXXX&apos;, # specify a template for the dirname     );</p><p>If \*(C`DIR\*(C', \*(C`CLEANUP\*(C', or \*(C`TEMPLATE\*(C' are omitted, reasonable defaults are selected.  \*(C`CLEANUP\*(C' is on by default, and \*(C`DIR\*(C' is set to \*(C`File::Spec-\*(C'tmpdir&gt;;</p>
<h3>child</h3>
<p>Creates a new \*(C`Directory::Scratch\*(C' directory inside the current \*(C`base\*(C', copying \s-1TEMPLATE\s0 and \s-1CLEANUP\s0 options from the current instance.  Returns a \*(C`Directory::Scratch\*(C' object.</p>
<h3>base</h3>
<p>Returns the full path of the temporary directory, as a Path::Class object.</p>
<h3>platform([$platform])</h3>
<p>Returns the name of the platform that the filenames are being interperted as (i.e., \*(L"Win32\*(R" means that this module expects paths like \*(C`&#92;foo&#92;bar\*(C', whereas \*(L"\s-1UNIX\s0\*(R" means it expects \*(C`/foo/bar\*(C').</p><p>If $platform is sepcified, the platform is changed to the passed value.  (Overrides the platform specified at module \*(C`use\*(C' time, for <em>this instance</em> only, not every \*(C`Directory::Scratch\*(C' object.)</p>
<h3>touch($filename, [@lines])</h3>
<p>Creates a file named $filename, optionally containing the elements of @lines separated by the output record separator \*(C`$&#92;\*(C'.</p><p>The Path::Class object representing the new file is returned if the operation is successful, an exception is thrown otherwise.</p>
<h3>create_tree(&#92;%tree)</h3>
<p>Creates a file for every key/value pair if the hash, using the key as the filename and the value as the contents.  If the value is an arrayref, the array is used as the optional @lines argument to \*(C`touch\*(C'.  If the value is a reference to \*(C`undef\*(C', then a directory is created instead of a file.</p><p>Example:</p><p>    %tree = ( &apos;foo&apos;     =&gt; &apos;this is foo&apos;,               &apos;bar/baz&apos; =&gt; &apos;this is baz inside bar&apos;,               &apos;lines&apos;   =&gt; [qw|this file contains 5 lines|],               &apos;dir&apos;     =&gt; &#92;undef,             );     $tmp-&gt;create_tree(&#92;%tree);</p><p>In this case, two directories are created, \*(C`dir\*(C' and \*(C`bar\*(C'; and three files are created, \*(C`foo\*(C', \*(C`baz\*(C' (inside \*(C`bar\*(C'), and \*(C`lines\*(C'. \*(C`foo\*(C' and \*(C`baz\*(C' contain a single line, while \*(C`lines\*(C' contains 5 lines.</p>
<h3>openfile($filename)</h3>
<p>Opens $filename for writing and reading (\*(C`+&gt;\*(C'), and returns the filehandle.  If $filename already exists, it will be truncated.  It's up to you to take care of flushing/closing.</p><p>In list context, returns both the filehandle and the filename \*(C`($fh, $path)\*(C'.</p>
<h3>mkdir($directory)</h3>
<p>Creates a directory (and its parents, if necessary) inside the temporary directory and returns its name.  Any leading \*(C`/\*(C' on the directory name is ignored; all directories are created inside the \*(C`base\*(C'.</p><p>The full path of this directory is returned if the operation is successful, otherwise an exception is thrown.</p>
<h3>tempfile([$path])</h3>
<p>Returns an empty filehandle + filename in $path.  If $path is omitted, the base directory is assumed.</p><p>See File::Temp::tempfile.</p><p>    my($fh,$name) = $scratch-&gt;tempfile;</p>
<h3>exists($file)</h3>
<p>Returns the file's real (system) path if $file exists, undefined otherwise.</p><p>Example:</p><p>    my $path = $tmp-&gt;exists($file);     if(defined $path){        say "Looks like you have a file at $path!";        open(my $fh, &apos;&gt;&gt;&apos;, $path) or die $!;        print {$fh} "add another line&#92;n";        close $fh or die $!;     }     else {        say "No file called $file."     }</p>
<h3>stat($file)</h3>
<p>Stats $file.  In list context, returns the list returned by the \*(C`stat\*(C' builtin.  In scalar context, returns a \*(C`File::stat\*(C' object.</p>
<h3>read($file)</h3>
<p>Returns the contents of $file.  In array context, returns a list of chompped lines.  In scalar context, returns the raw octets of the file (with any trailing newline removed).</p><p>If you wrote the file with $, set, you'll want to set $/ to $, when reading the file back in:</p><p>    local $, = &apos;!&apos;;     $tmp-&gt;touch(&apos;foo&apos;, qw{foo bar baz}); # writes "foo!bar!baz!" to disk     scalar $tmp-&gt;read(&apos;foo&apos;) # returns "foo!bar!baz!"     $tmp-&gt;read(&apos;foo&apos;) # returns ("foo!bar!baz!")     local $/ = &apos;!&apos;;     $tmp-&gt;read(&apos;foo&apos;) # returns ("foo", "bar", "baz") Replaces the contents of file with @lines.  Each line will be ended with a \*(C`&#92;n\*(C', or $, if it is defined.  The file will be created if necessary. Appends @lines to $file, as per \*(C`write\*(C'.</p>
<h3>\fIrandfile()\fP</h3>
<p>Generates a file with random string data in it.   If String::Random is available, it will be used to generate the file's data.  Takes 0, 1, or 2 arguments - default size, max size, or size range.</p><p>A max size of 0 will cause an exception to be thrown.</p><p>Examples:</p><p>    my $file = $temp-&gt;randfile(); # size is between 1024 and 131072     my $file = $temp-&gt;randfile( 4192 ); # size is below 4129     my $file = $temp-&gt;randfile( 1000000, 4000000 ); Symlinks a file in the temporary directory to another file in the temporary directory.</p><p>Note: symlinks are not supported on Win32.  Portable code must not use this method.  (The method will \*(C`croak\*(C' if it won't work.)</p>
<h3>ls([$path])</h3>
<p>Returns a list (in no particular order) of all files below $path. If $path is omitted, the root is assumed.  Note that directories are not returned.</p><p>If $path does not exist, an exception is thrown.</p>
<h3>delete($path)</h3>
<p>Deletes the named file or directory at $path.</p><p>If the path is removed successfully, the method returns true. Otherwise, an exception is thrown.</p><p>(Note: delete means \*(C`unlink\*(C' for a file and \*(C`rmdir\*(C' for a directory. \*(C`delete\*(C'-ing an unempty directory is an error.) Sets the permissions $octal_permissions on @files, returning the number of files successfully changed. Note that &apos;0644&apos; is \*(C`--w----r-T\*(C', not \*(C`-rw-r--r--\*(C'.  You need to pass in \*(C`oct(&apos;0644&apos;)\*(C' or a literal 0644 for this method to \s-1DWIM\s0.  The method is just a passthru to perl's built-in \*(C`chmod\*(C' function, so see \*(C`perldoc -f chmod\*(C' for full details.</p>
<h3>cleanup</h3>
<p>Forces an immediate cleanup of the current object's directory.  See File::Path's <em>rmtree()</em>.  It is not safe to use the object after this method is called.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">
<p>If the \*(C`PERL_DIRECTORYSCRATCH_CLEANUP\*(C' variable is set to 0, automatic cleanup will be suppressed.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PATCHES</h2>
        <div class="sectioncontent">
<p>Commentary, patches, etc. are most welcome.  If you send a patch, try patching the git version available from:</p><p>git://git.jrock.us/Directory-Scratch &lt;git://git.jrock.us/Directory-Scratch&gt;.</p><p>You can check out a copy by running:</p><p>    git clone git://git.jrock.us/Directory-Scratch</p><p>Then you can use git to commit changes and then e-mail me a patch, or you can publish the repository and ask me to pull the changes.  More information about git is available from</p><p>&lt;http://git.or.cz/&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Directory::Scratch&hellip;</h2>
        <div class="sectioncontent">
<p> L&lt;File::Temp&gt;  L&lt;File::Path&gt;  L&lt;File::Spec&gt;  L&lt;Path::Class&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Please report any bugs or feature through the web interface at http://rt.cpan.org/NoAuth/ReportBug.html?Queue=Directory-Scratch &lt;http://rt.cpan.org/NoAuth/ReportBug.html?Queue=Directory-Scratch&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ACKNOWLEDGEMENTS</h2>
        <div class="sectioncontent">
<p>Thanks to Al Tobey (\s-1TOBEYA\s0) for some excellent patches, notably:</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT & LICENSE</h2>
        <div class="sectioncontent">
<p>Copyright 2006 Jonathan Rockway, all rights reserved.</p><p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Dir::Purge.3pm.html"><span aria-hidden="true">&larr;</span> Dir::Purge.3pm: Purge directories to a given number of files.</a></li>
   <li class="next"><a href="Directory::Scratch::Structured.3pm.html">Directory::Scratch::Structured.3pm:  <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
