<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Marshal: Marshaling of data structures.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Marshaling of data structures.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Marshal (3o) manual">
  <meta name="twitter:description" content="Marshaling of data structures.">
  <meta name="twitter:image" content="https://www.carta.tech/images/ocaml-nox-Marshal-3o.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3o/Marshal.3o.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Marshal (3o) manual" />
  <meta property="og:description" content="Marshaling of data structures." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/ocaml-nox-Marshal-3o.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Marshal<small> (3o)</small></h1>
        <p class="lead">Marshaling of data structures.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3o/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3o/Marshal.3o.html">
      <span itemprop="name">Marshal: Marshaling of data structures.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/ocaml-nox/">
      <span itemprop="name">ocaml-nox</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3o/Marshal.3o.html">
      <span itemprop="name">Marshal: Marshaling of data structures.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">Module</h2>
        <div class="sectioncontent">
<p>Module   Marshal</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Documentation</h2>
        <div class="sectioncontent">
<p>Module <strong>Marshal</strong>  : <strong>sig end</strong></p><p>Marshaling of data structures.</p><p>This module provides functions to encode arbitrary data structures as sequences of bytes, which can then be written on a file or sent over a pipe or network connection.  The bytes can then be read back later, possibly in another process, and decoded back into a data structure. The format for the byte sequences is compatible across all machines for a given version of OCaml.</p><p>Warning: marshaling is currently not type-safe. The type of marshaled data is not transmitted along the value of the data, making it impossible to check that the data read back possesses the type expected by the context. In particular, the result type of the <strong>Marshal.from_*</strong> functions is given as <strong>'a</strong> , but this is misleading: the returned OCaml value does not possess type <strong>'a</strong> for all <strong>'a</strong> ; it has one, unique type which cannot be determined at compile-type.  The programmer should explicitly give the expected type of the returned value, using the following syntax:</p><p>- <strong>(Marshal.from_channel chan : type)</strong> . Anything can happen at run-time if the object in the file does not belong to the given type.</p><p>OCaml exception values (of type <strong>exn</strong> ) returned by the unmarhsaller should not be pattern-matched over through <strong>match ... with</strong> or <strong>try</strong> <strong>... with</strong> , because unmarshalling does not preserve the information required for matching their exception constructor. Structural equalities with other exception values, or most other uses such as Printexc.to_string, will still work as expected.</p><p>The representation of marshaled values is not human-readable, and uses bytes that are not printable characters. Therefore, input and output channels used in conjunction with <strong>Marshal.to_channel</strong> and <strong>Marshal.from_channel</strong> must be opened in binary mode, using e.g. <strong>open_out_bin</strong> or <strong>open_in_bin</strong> ; channels opened in text mode will cause unmarshaling errors on platforms where text channels behave differently than binary channels, e.g. Windows.</p><p><em>type extern_flags</em> =  | No_sharing  (* Don't preserve sharing *)  | Closures  (* Send function closures *)  | Compat_32  (* Ensure 32-bit compatibility *)</p><p>The flags to the <strong>Marshal.to_*</strong> functions below.</p><p><em>val to_channel</em> : <strong>Pervasives.out_channel -&gt; 'a -&gt; extern_flags list -&gt; unit</strong></p><p><strong>Marshal.to_channel chan v flags</strong> writes the representation of <strong>v</strong> on channel <strong>chan</strong> . The <strong>flags</strong> argument is a possibly empty list of flags that governs the marshaling behavior with respect to sharing, functional values, and compatibility between 32- and 64-bit platforms.</p><p>If <strong>flags</strong> does not contain <strong>Marshal.No_sharing</strong> , circularities and sharing inside the value <strong>v</strong> are detected and preserved in the sequence of bytes produced. In particular, this guarantees that marshaling always terminates. Sharing between values marshaled by successive calls to <strong>Marshal.to_channel</strong> is neither detected nor preserved, though. If <strong>flags</strong> contains <strong>Marshal.No_sharing</strong> , sharing is ignored. This results in faster marshaling if <strong>v</strong> contains no shared substructures, but may cause slower marshaling and larger byte representations if <strong>v</strong> actually contains sharing, or even non-termination if <strong>v</strong> contains cycles.</p><p>If <strong>flags</strong> does not contain <strong>Marshal.Closures</strong> , marshaling fails when it encounters a functional value inside <strong>v</strong> : only 'pure' data structures, containing neither functions nor objects, can safely be transmitted between different programs. If <strong>flags</strong> contains <strong>Marshal.Closures</strong> , functional values will be marshaled as a position in the code of the program. In this case, the output of marshaling can only be read back in processes that run exactly the same program, with exactly the same compiled code. (This is checked at un-marshaling time, using an MD5 digest of the code transmitted along with the code position.)</p><p>If <strong>flags</strong> contains <strong>Marshal.Compat_32</strong> , marshaling fails when it encounters an integer value outside the range <strong>[-2{^30}, 2{^30}-1]</strong> of integers that are representable on a 32-bit platform.  This ensures that marshaled data generated on a 64-bit platform can be safely read back on a 32-bit platform.  If <strong>flags</strong> does not contain <strong>Marshal.Compat_32</strong> , integer values outside the range <strong>[-2{^30}, 2{^30}-1]</strong> are marshaled, and can be read back on a 64-bit platform, but will cause an error at un-marshaling time when read back on a 32-bit platform.  The <strong>Mashal.Compat_32</strong> flag only matters when marshaling is performed on a 64-bit platform; it has no effect if marshaling is performed on a 32-bit platform.</p><p><em>val to_string</em> : <strong>'a -&gt; extern_flags list -&gt; string</strong></p><p><strong>Marshal.to_string v flags</strong> returns a string containing the representation of <strong>v</strong> as a sequence of bytes. The <strong>flags</strong> argument has the same meaning as for <strong>Marshal.to_channel</strong> .</p><p><em>val to_buffer</em> : <strong>string -&gt; int -&gt; int -&gt; 'a -&gt; extern_flags list -&gt; int</strong></p><p><strong>Marshal.to_buffer buff ofs len v flags</strong> marshals the value <strong>v</strong> , storing its byte representation in the string <strong>buff</strong> , starting at character number <strong>ofs</strong> , and writing at most <strong>len</strong> characters.  It returns the number of characters actually written to the string. If the byte representation of <strong>v</strong> does not fit in <strong>len</strong> characters, the exception <strong>Failure</strong> is raised.</p><p><em>val from_channel</em> : <strong>Pervasives.in_channel -&gt; 'a</strong></p><p><strong>Marshal.from_channel chan</strong> reads from channel <strong>chan</strong> the byte representation of a structured value, as produced by one of the <strong>Marshal.to_*</strong> functions, and reconstructs and returns the corresponding value.</p><p><em>val from_string</em> : <strong>string -&gt; int -&gt; 'a</strong></p><p><strong>Marshal.from_string buff ofs</strong> unmarshals a structured value like <strong>Marshal.from_channel</strong> does, except that the byte representation is not read from a channel, but taken from the string <strong>buff</strong> , starting at position <strong>ofs</strong> .</p><p><em>val header_size</em> : <strong>int</strong></p><p>The bytes representing a marshaled value are composed of a fixed-size header and a variable-sized data part, whose size can be determined from the header. <strong>Marshal.header_size</strong> is the size, in characters, of the header. <strong>Marshal.data_size</strong> <strong>buff ofs</strong> is the size, in characters, of the data part, assuming a valid header is stored in <strong>buff</strong> starting at position <strong>ofs</strong> . Finally, <strong>Marshal.total_size</strong> <strong>buff ofs</strong> is the total size, in characters, of the marshaled value. Both <strong>Marshal.data_size</strong> and <strong>Marshal.total_size</strong> raise <strong>Failure</strong> if <strong>buff</strong> , <strong>ofs</strong> does not contain a valid header.</p><p>To read the byte representation of a marshaled value into a string buffer, the program needs to read first <strong>Marshal.header_size</strong> characters into the buffer, then determine the length of the remainder of the representation using <strong>Marshal.data_size</strong> , make sure the buffer is large enough to hold the remaining data, then read it, and finally call <strong>Marshal.from_string</strong> to unmarshal the value.</p><p><em>val data_size</em> : <strong>string -&gt; int -&gt; int</strong></p><p>See <strong>Marshal.header_size</strong> .</p><p><em>val total_size</em> : <strong>string -&gt; int -&gt; int</strong></p><p>See <strong>Marshal.header_size</strong> .</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Map.S.3o.html"><span aria-hidden="true">&larr;</span> Map.S.3o: Output signature of the functor map.make.</a></li>
   <li class="next"><a href="MoreLabels.3o.html">MoreLabels.3o: Extra labeled libraries. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
