<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>asgrad: Asgrad- demonstrates rendering of multi point linear gradients libafterimage/tutorials/asgrad</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Asgrad- demonstrates rendering of multi point linear gradients libafterimage/tutorials/asgrad">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="asgrad (3x) manual">
  <meta name="twitter:description" content="Asgrad- demonstrates rendering of multi point linear gradients libafterimage/tutorials/asgrad">
  <meta name="twitter:image" content="https://www.carta.tech/images/libafterimage-dev-asgrad-3x.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3x/asgrad.3x.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="asgrad (3x) manual" />
  <meta property="og:description" content="Asgrad- demonstrates rendering of multi point linear gradients libafterimage/tutorials/asgrad" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libafterimage-dev-asgrad-3x.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">asgrad<small> (3x)</small></h1>
        <p class="lead">Asgrad- demonstrates rendering of multi point linear gradients libafterimage/tutorials/asgrad</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3x/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3x/asgrad.3x.html">
      <span itemprop="name">asgrad: Asgrad- demonstrates rendering of multi point linear gradients libafterimage/tutorials/asgrad</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libafterimage-dev/">
      <span itemprop="name">libafterimage-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3x/asgrad.3x.html">
      <span itemprop="name">asgrad: Asgrad- demonstrates rendering of multi point linear gradients libafterimage/tutorials/asgrad</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">NAMEASGrad</h2>
        <div class="sectioncontent">

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>libAfterImage application for drawing multipoint linear gradients.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>New steps described in this tutorial are : ASGrad.1. Building gradient specs. ASGrad.2. Actual rendering gradient.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO asgrad&hellip;</h2>
        <div class="sectioncontent">
<p>Tutorial 1: ASView  - explanation of basic steps needed to use</p>
<pre>
                      libAfterImage and some other simple things.
</pre>
<p>Tutorial 2: ASScale - image scaling basics. Tutorial 3: ASTile  - image tiling and tinting. Tutorial 4: ASMerge - scaling and blending of arbitrary number of</p>
<pre>
                      images.
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SOURCE</h2>
        <div class="sectioncontent">
<p>#include "../afterbase.h" #include "../afterimage.h" #include "common.h"</p><p>ARGB32 default_colors[] = {</p>
<pre>
    0xFF000000,
    0xFF700070,                                /* violet */
    0xFF0000FF,                                /* blue   */
    0xFF00FFFF,                                /* cyan   */
    0xFF00FF00,
    0XFFFFFF00,
    0XFF700000,
    0XFFFF0000,
    0xFF8080A0,
    0xFFE0E0FF,
    0xFFa0a0FF,
</pre>
<p>}; double default_offsets[] = { 0, 0.1, 0.15, 0.20, 0.35, 0.45, 0.55, 0.50,</p>
<pre>
                             0.65, 0.8, 1.0} ;
</pre>
<p>void usage() {</p>
<pre>
    printf( "  Usage: asgrad -h | &lt;geometry&gt; &lt;gradient_type&gt; &lt;color1&gt; "
            "&lt;offset2&gt; &lt;color2&gt; [ &lt;offset3&gt; &lt;color3&gt; ...]&#92;n");
    printf( "  Where: geometry - size of the resulting image and window;&#92;n");
    printf( "         gradient_type - One of the fiollowing values :&#92;n");
    printf( "            0 - linear   left-to-right gradient,&#92;n");
    printf( "            1 - diagonal lefttop-to-rightbottom,&#92;n");
    printf( "            2 - linear   top-to-bottom gradient,&#92;n");
    printf( "            3 - diagonal righttop-to-leftbottom;&#92;n");
    printf( "         offset   - floating point value from 0.0 to 1.0&#92;n");
</pre>
<p>}</p><p>int main(int argc, char* argv[]) {</p>
<pre>
    Display *dpy = NULL;
    ASVisual *asv ;
    int screen = 0, depth = 0;
    int dummy, geom_flags = 0;
    unsigned int to_width, to_height ;
    ASGradient grad ;
    ASGradient default_grad = { 1, 11, &(default_colors[0]),
                                       &(default_offsets[0])} ;
    ASImage *grad_im = NULL;
</pre>

<pre>
    /* see ASView.1 : */
    set_application_name( argv[0] );
</pre>
<p>#if (HAVE_AFTERBASE_FLAG==1)</p>
<pre>
    set_output_threshold(OUTPUT_LEVEL_DEBUG);
</pre>
<p>#endif</p>
<pre>
    if( argc &gt; 1 )
    {
        if( strcmp( argv[1], "-h") == 0 )
        {
            usage();
            return 0;
        }
        /* see ASScale.1 : */
        geom_flags = XParseGeometry( argv[1], &dummy, &dummy,
                                     &to_width, &to_height );
    }else
        usage();
    memset( &grad, 0x00, sizeof(ASGradient));
</pre>
<p>#ifndef X_DISPLAY_MISSING</p>
<pre>
    dpy = XOpenDisplay(NULL);
    _XA_WM_DELETE_WINDOW = XInternAtom( dpy, "WM_DELETE_WINDOW", False);
    screen = DefaultScreen(dpy);
    depth = DefaultDepth( dpy, screen );
</pre>
<p>#endif</p>
<pre>
    if( argc &gt;= 5 )
    {
        int i = 2;
        /* see ASGrad.1 : */
        grad.type = atoi( argv[2] );
        grad.npoints = 0 ;
        grad.color = safemalloc( ((argc-2)/2)*sizeof(ARGB32));
        grad.offset = safemalloc( ((argc-2)/2)*sizeof(double));
        while( ++i &lt; argc )
        {
            if( grad.npoints &gt; 0 )
            {
                if( i == argc-1 )
                    grad.offset[grad.npoints] = 1.0;
                else
                    grad.offset[grad.npoints] = atof( argv[i] );
                ++i ;
            }
</pre>

<pre>
            /* see ASTile.1 : */
            if( parse_argb_color( argv[i], &(grad.color[grad.npoints]))
                != argv[i] )
                if( grad.offset[grad.npoints] &gt;= 0. &&
                    grad.offset[grad.npoints]&lt;= 1.0 )
                    grad.npoints++ ;
        }
    }else
    {
        grad = default_grad ;
        if( argc &gt;= 3 )
            grad.type = atoi( argv[2] );
    }
</pre>

<pre>
    if( grad.npoints &lt;= 0 )
    {
        show_error( " not enough gradient points specified.");
        return 1;
    }
</pre>

<pre>
    /* Making sure tiling geometry is sane : */
</pre>
<p>#ifndef X_DISPLAY_MISSING</p>
<pre>
    if( !get_flags(geom_flags, WidthValue ) )
        to_width  = DisplayWidth(dpy, screen)*2/3 ;
    if( !get_flags(geom_flags, HeightValue ) )
        to_height = DisplayHeight(dpy, screen)*2/3 ;
</pre>
<p>#else</p>
<pre>
    if( !get_flags(geom_flags, WidthValue ) )
        to_width  = 500 ;
    if( !get_flags(geom_flags, HeightValue ) )
        to_height = 500 ;
</pre>
<p>#endif</p>
<pre>
    printf( "%s: rendering gradient of type %d to %dx%d&#92;n",
            get_application_name(), grad.type&GRADIENT_TYPE_MASK,
            to_width, to_height );
</pre>

<pre>
    /* see ASView.3 : */
    asv = create_asvisual( dpy, screen, depth, NULL );
    /* see ASGrad.2 : */
    grad_im = make_gradient( asv, &grad, to_width, to_height,
                             SCL_DO_ALL,
</pre>
<p>#ifndef X_DISPLAY_MISSING</p>
<pre>
                             ASA_XImage,
</pre>
<p>#else</p>
<pre>
                             ASA_ASImage,
</pre>
<p>#endif</p>
<pre>
                             0, ASIMAGE_QUALITY_DEFAULT );
    if( grad_im )
    {
</pre>
<p>#ifndef X_DISPLAY_MISSING</p>
<pre>
        /* see ASView.4 : */
        Window w = create_top_level_window( asv,
                                            DefaultRootWindow(dpy), 32, 32,
                                            to_width, to_height, 1, 0, NULL,
                                            "ASGradient", NULL );
        if( w != None )
        {
            Pixmap p ;
</pre>

<pre>
            XMapRaised   (dpy, w);
            /* see ASView.5 : */
            p = asimage2pixmap( asv, DefaultRootWindow(dpy), grad_im,
                                NULL, True );
            destroy_asimage( &grad_im );
            /* see common.c: set_window_background_and_free() : */
            p = set_window_background_and_free( w, p );
            /* see common.c: wait_closedown() : */
        }
        wait_closedown(w);
        dpy = NULL;
</pre>
<p>#else</p>
<pre>
        ASImage2file( grad_im, NULL, "asgrad.jpg", ASIT_Jpeg, NULL );
        destroy_asimage( &grad_im );
</pre>
<p>#endif</p>
<pre>
    }
    return 0 ;
</pre>
<p>}</p><p>libAfterImage/tutorials/ASGrad.1 [5.1]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>Step 1. Building gradient specs.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Multipoint gradient is defined as set of color values with offsets of each point from the beginning of the gradient on 1.0 scale. Offsets of the first and last point in gradient should always be 0. and 1.0 respectively, and other points should go in between. For example 2 point gradient will have always offsets 0. and 1.0, 3 points gradient will have 0. for first color, 1.0 for last color and anything in between for middle color. If offset is incorrect - point will be skipped at the time of rendering.</p><p>There are 4 types of gradients supported : horizontal, top-left to bottom-right diagonal, vertical and top-right to bottom-left diagonal. Any cilindrical gradient could be drawn as a 3 point gradient with border colors being the same.</p><p>Each gradient point has ARGB color, which means that it is possible to draw gradients in alpha channel as well as RGB. That makes for semitransparent gradients, fading gradients, etc.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<pre>
    grad.type = atoi( argv[2] );
        grad.npoints = 0 ;
        grad.color = safemalloc( ((argc-2)/2)*sizeof(ARGB32));
        grad.offset = safemalloc( ((argc-2)/2)*sizeof(double));
        while( ++i &lt; argc )
        {
            if( grad.npoints &gt; 0 )
            {
                if( i == argc-1 )
                    grad.offset[grad.npoints] = 1.0;
                else
                    grad.offset[grad.npoints] = atof( argv[i] );
                ++i ;
            }
        if( parse_argb_color( argv[i], &(grad.color[grad.npoints]))
             != argv[i] )
                if(grad.offset[grad.npoints] &gt;= 0. &&
                grad.offset[grad.npoints]&lt;= 1.0 )
                    grad.npoints++ ;
        }
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO asgrad&hellip;</h2>
        <div class="sectioncontent">
<p>ARGB32, parse_argb_color(), ASGradient libAfterImage/tutorials/ASGrad.2 [5.2]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>Step 2. Actually rendering gradient.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>All that is needed to draw gradient is to call make_gradient(), passing pointer to ASGradient structure, that describes gradient. Naturally size of the gradient is needed too. Another parameter is filter - that is a bit mask that allows one to draw gradient using only a subset of the channels, represented by set bits. SCL_DO_ALL means that all 4 channels must be rendered. make_gradient() creates ASImage of requested size and fills it with gradient. Special techinque based on error diffusion is utilized to avoid sharp steps between grades of colors when limited range of colors is used for gradient.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<pre>
        grad_im = make_gradient( asv, &grad, to_width, to_height,
                                 SCL_DO_ALL,
                             ASA_XImage, 0, ASIMAGE_QUALITY_DEFAULT );
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>make_gradient(), ASScanline, ASImage.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="asfont.3x.html"><span aria-hidden="true">&larr;</span> asfont.3x: Asfont- text drawing functionality and handling of ttf and x11 fonts libafterimage/asfont.h</a></li>
   <li class="next"><a href="asimage.3x.html">asimage.3x: Asimage- internal structures and methods used for image manipulation in libafterimage libafterimage/asimage.h <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
