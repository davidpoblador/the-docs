<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FunImageGet: Get an image or image section</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Get an image or image section">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="FunImageGet (3) manual">
  <meta name="twitter:description" content="Get an image or image section">
  <meta name="twitter:image" content="https://www.carta.tech/images/libfuntools-dev-FunImageGet-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/FunImageGet.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="FunImageGet (3) manual" />
  <meta property="og:description" content="Get an image or image section" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libfuntools-dev-FunImageGet-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">FunImageGet<small> (3)</small></h1>
        <p class="lead">Get an image or image section</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/FunImageGet.3.html">
      <span itemprop="name">FunImageGet: Get an image or image section</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libfuntools-dev/">
      <span itemprop="name">libfuntools-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/FunImageGet.3.html">
      <span itemprop="name">FunImageGet: Get an image or image section</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  #include &lt;funtools.h&gt;
</pre>
<p>  void *FunImageGet(Fun fun, void *buf, char *plist)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <strong></strong><strong>FunImageGet()</strong><strong></strong> routine returns an binned image array of the specified section of a Funtools data file.  If the input data are already of type image, the array is generated by extracting the specified image section and then binning it according to the specified bin factor.  If the input data are contained in a binary table or raw event file, the rows are binned on the columns specified by the <strong>bincols=</strong> keyword (using appropriate default columns as necessary), after which the image section and bin factors are applied. In both cases, the data is automatically converted from \s-1FITS\s0 to native format, if necessary.</p><p>The first argument is the Funtools handle returned by <em>FunOpen()</em>.  The second <strong>buf</strong> argument is a pointer to a data buffer to fill. If \s-1NULL\s0 is specified, FunImageGet will allocate a buffer of the appropriate size. Generally speaking, you always want Funtools to allocate the buffer because the image dimensions will be determined by Funtools image sectioning on the command line.</p><p>The third <strong>plist</strong> (i.e., parameter list) argument is a string containing one or more comma-delimited <strong>keyword=value</strong> parameters.  It can be used to specify the return data type using the <strong>bitpix=</strong> keyword.  If no such keyword is specified in the plist string, the data type of the returned image is the same as the data type of the original input file, or is of type int for \s-1FITS\s0 binary tables.</p><p>If the <strong>bitpix=</strong> keyword is supplied in the plist string, the data type of the returned image will be one of the supported \s-1FITS\s0 image data types:</p><ul>
<li><p>8 unsigned char</p></li><li><p>16 short</p></li><li><p>32 int</p></li><li><p>\-32 float</p></li><li><p>\-64 double</p></li>
</ul><p>For example:</p><p>  void *buf;   /* extract data section into an image buffer */   if( !(buf = FunImageGet(fun, NULL, NULL)) )     gerror(stderr, "could not FunImageGet: %s&#92;n", iname);</p><p>will allocate buf and retrieve the image in the file data format. In this case, you will have to determine the data type (using the \s-1FUN_SECT_BITPIX\s0 value in the <em>FunInfoGet()</em> routine) and then use a switch statement to process each data type:</p><p>  int bitpix;   void *buf;   unsigned char *cbuf;   short *sbuf;   int *ibuf;   ...   buf = FunImageGet(fun, NULL, NULL);   FunInfoGet(fun, FUN_SECT_BITPIX,  &bitpix, 0);   /* set appropriate data type buffer to point to image buffer */   switch(bitpix){   case 8:     cbuf = (unsigned char *)buf; break;   case 16:     sbuf = (short *)buf; break;   case 32:     ibuf = (int *)buf; break;  ...</p><p>See the imblank example code for more details on how to process an image when the data type is not specified beforehand.</p><p>It often is easier to specify the data type directly:</p><p>  double *buf;   /* extract data section into a double image buffer */   if( !(buf = FunImageGet(fun, NULL, "bitpix=-64")) )     gerror(stderr, "could not FunImageGet: %s&#92;n", iname);</p><p>will extract the image while converting to type double.</p><p>On success, a pointer to the image buffer is returned. (This will be the same as the second argument, if \s-1NULL\s0 is not passed to the latter.) On error, \s-1NULL\s0 is returned.</p><p>In summary, to retrieve image or row data into a binned image, you simply call <em>FunOpen()</em> followed by <em>FunImageGet()</em>.  Generally, you then will want to call <em>FunInfoGet()</em> to retrieve the axis dimensions (and data type) of the section you are processing (so as to take account of sectioning and blocking of the original data):</p><p>  double *buf;   int i, j;   int dim1, dim2;   ... other declarations, etc.</p><p>  /* open the input FITS file */   if( !(fun = FunOpen(argv[1], "rc", NULL)) )     gerror(stderr, "could not FunOpen input file: %s&#92;n", argv[1]);</p><p>  /* extract and bin the data section into a double float image buffer */   if( !(buf = FunImageGet(fun, NULL, "bitpix=-64")) )     gerror(stderr, "could not FunImageGet: %s&#92;n", argv[1]);</p><p>  /* get dimension information from funtools structure */   FunInfoGet(fun, FUN_SECT_DIM1, &dim1, FUN_SECT_DIM2, &dim2, 0);</p><p>  /* loop through pixels and reset values below limit to value */   for(i=0; i&lt;dim1*dim2; i++){     if( buf[i] &lt;= blimit ) buf[i] = bvalue;   }</p><p>Another useful plist string value is \*(L"mask=all\*(R", which returns an image populated with regions id values. Image pixels within a region will contain the associated region id (region values start at 1), and otherwise will contain a 0 value. Thus, the returned image is a region mask which can be used to process the image data (which presumably is retrieved by a separate call to FunImageGet) pixel by pixel.</p><p>If a \s-1FITS\s0 binary table or a non-FITS raw event file is being binned into an image, it is necessary to specify the two columns that will be used in the 2D binning.  This usually is done on the command line using the <strong>bincols=(x,y)</strong> keyword:</p><p>  funcnts "foo.ev[EVENTS,bincols=(detx,dety)]"</p><p>The full form of the <strong>bincols=</strong> specifier is:</p><p>  bincols=([xname[:tlmin[:tlmax:[binsiz]]]],[yname[:tlmin[:tlmax[:binsiz]]]])</p><p>where the tlmin, tlmax, and binsiz specifiers determine the image binning dimensions:</p><p>  dim = (tlmax - tlmin)/binsiz     (floating point data)   dim = (tlmax - tlmin)/binsiz + 1 (integer data)</p><p>These tlmin, tlmax, and binsiz specifiers can be omitted if \s-1TLMIN\s0, \s-1TLMAX\s0, and \s-1TDBIN\s0 header parameters (respectively) are present in the \s-1FITS\s0 binary table header for the column in question.  Note that if only one parameter is specified, it is assumed to be tlmax, and tlmin defaults to 1. If two parameters are specified, they are assumed to be tlmin and tlmax.</p><p>If <strong>bincols</strong> is not specified on the command line, Funtools tries to use appropriate defaults: it looks for the environment variable \s-1FITS_BINCOLS\s0 (or \s-1FITS_BINKEY\s0). Then it looks for the Chandra parameters \s-1CPREF\s0 (or \s-1PREFX\s0) in the \s-1FITS\s0 binary table header. Failing this, it looks for columns named \*(L"X\*(R" and \*(L"Y\*(R" and if these are not found, it looks for columns containing the characters \*(L"X\*(R" and \*(L"Y\*(R".</p><p>See Binning \s-1FITS\s0 Binary Tables and Non-FITS Event Files for more information.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO FunImageGet&hellip;</h2>
        <div class="sectioncontent">
<p>See <a href="../man7/funtools.7.html"><strong>funtools</strong>(7)</a> for a list of Funtools help pages</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="FunFlush.3.html"><span aria-hidden="true">&larr;</span> FunFlush.3: Flush data to output file</a></li>
   <li class="next"><a href="FunImagePut.3.html">FunImagePut.3: Put an image to a funtools file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
