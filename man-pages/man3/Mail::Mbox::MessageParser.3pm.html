<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Mail::Mbox::MessageParser: A fast and simple mbox folder reader</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A fast and simple mbox folder reader">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Mail::Mbox::MessageParser (3pm) manual">
  <meta name="twitter:description" content="A fast and simple mbox folder reader">
  <meta name="twitter:image" content="https://www.carta.tech/images/libmail-mbox-messageparser-perl-Mail::Mbox::MessageParser-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Mail::Mbox::MessageParser.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Mail::Mbox::MessageParser (3pm) manual" />
  <meta property="og:description" content="A fast and simple mbox folder reader" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libmail-mbox-messageparser-perl-Mail::Mbox::MessageParser-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Mail::Mbox::MessageParser<small> (3pm)</small></h1>
        <p class="lead">A fast and simple mbox folder reader</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Mail::Mbox::MessageParser.3pm.html">
      <span itemprop="name">Mail::Mbox::MessageParser: A fast and simple mbox folder reader</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libmail-mbox-messageparser-perl/">
      <span itemprop="name">libmail-mbox-messageparser-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Mail::Mbox::MessageParser.3pm.html">
      <span itemprop="name">Mail::Mbox::MessageParser: A fast and simple mbox folder reader</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  #!/usr/bin/perl

  use Mail::Mbox::MessageParser;

  my $file_name = &apos;mail/saved-mail&apos;;
  my $file_handle = new FileHandle($file_name);

  # Set up cache. (Not necessary if enable_cache is false.)
  Mail::Mbox::MessageParser::SETUP_CACHE(
    { &apos;file_name&apos; =&gt; &apos;/tmp/cache&apos; } );

  my $folder_reader =
    new Mail::Mbox::MessageParser( {
      &apos;file_name&apos; =&gt; $file_name,
      &apos;file_handle&apos; =&gt; $file_handle,
      &apos;enable_cache&apos; =&gt; 1,
      &apos;enable_grep&apos; =&gt; 1,
    } );

  die $folder_reader unless ref $folder_reader;

  # Any newlines or such before the start of the first email
  my $prologue = $folder_reader-&gt;prologue;
  print $prologue;

  # This is the main loop. It&apos;s executed once for each email
  while(!$folder_reader-&gt;end_of_file())
  {
    my $email = $folder_reader-&gt;read_next_email();
    print $$email;
  }
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This module implements a fast but simple mbox folder reader. One of three implementations (Cache, Grep, Perl) will be used depending on the wishes of the user and the system configuration. The first implementation is a cached-based one which stores email information about mailboxes on the file system. Subsequent accesses will be faster because no analysis of the mailbox will be needed. The second implementation is one based on \s-1GNU\s0 grep, and is significantly faster than the Perl version for mailboxes which contain very large (10MB) emails. The final implementation is a fast Perl-based one which should always be applicable.</p><p>The Cache implementation is about 6 times faster than the standard Perl implementation. The Grep implementation is about 4 times faster than the standard Perl implementation. If you have \s-1GNU\s0 grep, it's best to enable both the Cache and Grep implementations. If the cache information is available, you'll get very fast speeds. Otherwise, you'll take about a 1/3 performance hit when the Grep version is used instead.</p><p>The overriding requirement for this module is speed. If you wish more sophisticated parsing, use Mail::MboxParser (which is based on this module) or Mail::Box.</p><h3>\s-1METHODS\s0 \s-1AND\s0 \s-1FUNCTIONS\s0</h3>

<dl class='dl-vertical'>
  <dt>
    \s-1SETUP_CACHE\s0(...)
  </dt>
  <dd>
    <p>  SETUP_CACHE( { &apos;file_name&apos; =&gt; &lt;cache file name&gt; } );</p><p>  &lt;cache file name&gt; - the file name of the cache Call this function once to set up the cache before creating any parsers. You must provide the location to the cache file. There is no default value.</p>
  </dd>
  <dt>
    new(...)
  </dt>
  <dd>
    <p>  new( { &apos;file_name&apos; =&gt; &lt;mailbox file name&gt;,     &apos;file_handle&apos; =&gt; &lt;mailbox file handle&gt;,     &apos;enable_cache&apos; =&gt; &lt;1 or 0&gt;,     &apos;enable_grep&apos; =&gt; &lt;1 or 0&gt;,     &apos;force_processing&apos; =&gt; &lt;1 or 0&gt;,     &apos;debug&apos; =&gt; &lt;1 or 0&gt;,   } );</p><p>  &lt;mailbox file name&gt; - the file name of the mailbox   &lt;mailbox file handle&gt; - the already opened file handle for the mailbox   &lt;enable_cache&gt; - true to attempt to use the cache implementation   &lt;enable_grep&gt; - true to attempt to use the grep implementation   &lt;force_processing&gt; - true to force processing of files that look invalid   &lt;debug&gt; - true to print some debugging information to STDERR The constructor takes either a file name or a file handle, or both. If the file handle is not defined, Mail::Mbox::MessageParser will attempt to open the file using the file name. You should always pass the file name if you have it, so that the parser can cache the mailbox information. This module will automatically decompress the mailbox as necessary. If a filename is available but the file handle is undef, the module will call either bzip2, or gzip to decompress the file in memory if the filename ends with .tz, .bz2, or .gz, respectively. If the file handle is defined, it will detect the type of compression and apply the correct decompression program. The Cache, Grep, or Perl implementation of the parser will be loaded, whichever is most appropriate. For example, the first time you use caching, there will be no cache. In this case, the grep implementation can be used instead. The cache will be updated in memory as the grep implementation parses the mailbox, and the cache will be written after the program exits. The file name is optional, in which case <em>enable_cache</em> and <em>enable_grep</em> must both be false. <em>force_processing</em> will cause the module to process folders that look to be binary, or whose text data doesn't look like a mailbox. Returns a reference to a Mail::Mbox::MessageParser object on success, and a scalar desribing an error on failure. (\*(L"Not a mailbox\*(R", \*(L"Can't open &lt;filename&gt;: &lt;system error&gt;\*(R", \*(L"Can't execute &lt;uncompress command&gt; for file &lt;filename&gt;\*(R"</p>
  </dd>
  <dt>
    <em>reset()</em>
  </dt>
  <dd>
    <p>Reset the filehandle and all internal state. Note that this will not work with filehandles which are streams. If there is enough demand, I may add the ability to store the previously read stream data internally so that <em></em><em>reset()</em><em></em> will work correctly.</p>
  </dd>
  <dt>
    <em>endline()</em>
  </dt>
  <dd>
    <p>Returns \*(L"&#92;n\*(R" or \*(L"&#92;r&#92;n\*(R", depending on the file format.</p>
  </dd>
  <dt>
    <em>prologue()</em>
  </dt>
  <dd>
    <p>Returns any newlines or other content at the start of the mailbox prior to the first email.</p>
  </dd>
  <dt>
    <em>end_of_file()</em>
  </dt>
  <dd>
    <p>Returns true if the end of the file has been encountered.</p>
  </dd>
  <dt>
    <em>line_number()</em>
  </dt>
  <dd>
    <p>Returns the line number for the start of the last email read.</p>
  </dd>
  <dt>
    <em>number()</em>
  </dt>
  <dd>
    <p>Returns the number of the last email read. (i.e. The first email will have a number of 1.)</p>
  </dd>
  <dt>
    <em>length()</em>
  </dt>
  <dd>
    <p>Returns the length of the last email read.</p>
  </dd>
  <dt>
    <em>offset()</em>
  </dt>
  <dd>
    <p>Returns the byte offset of the last email read.</p>
  </dd>
  <dt>
    <em>read_next_email()</em>
  </dt>
  <dd>
    <p>Returns a reference to a scalar holding the text of the next email in the mailbox, or undef at the end of the file.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>No known bugs.</p><p>Contact david@coppit.org for bug reports and suggestions.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>David Coppit &lt;david@coppit.org&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE</h2>
        <div class="sectioncontent">
<p>This software is distributed under the terms of the \s-1GPL\s0. See the file \*(L"\s-1LICENSE\s0\*(R" for more information.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">
<p>This code was originally part of the grepmail distribution. See http://grepmail.sf.net/ for previous versions of grepmail which included early versions of this code.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Mail::Mbox::MessageParser&hellip;</h2>
        <div class="sectioncontent">
<p>Mail::MboxParser, Mail::Box</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Mail::ListDetector::List.3pm.html"><span aria-hidden="true">&larr;</span> Mail::ListDetector::List.3pm: An object representing a mailing list</a></li>
   <li class="next"><a href="Mail::Mbox::MessageParser::Cache.3pm.html">Mail::Mbox::MessageParser::Cache.3pm: A cache-based mbox folder reader <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
