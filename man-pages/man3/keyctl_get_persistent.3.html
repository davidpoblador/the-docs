<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>keyctl_get_persistent - Get the persistent keyring for a user</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Get the persistent keyring for a user">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">keyctl_get_persistent<small> (3)</small></h1>
        <p class="lead">Get the persistent keyring for a user</p>
      </div>

    <ol class="breadcrumb">
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="/"><span itemprop="title">Carta.tech</span></a>
	</li>
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="https://www.carta.tech/man-pages/"><span itemprop="title">man-pages</span></a>
	</li>
	<li id="breadcrumb_section" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_page" itemprop="child">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man3/"><span itemprop="title">Library calls</span></a>
	</li>
	<li id="breadcrumb_page" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="active">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man3/keyctl_get_persistent.3.html"><span itemprop="title">keyctl_get_persistent</span></a>
	</li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre><strong>#include &lt;keyutils.h&gt;</strong>

<strong>long keyctl_get_persistent(uid_t </strong><em>uid</em><strong>, key_serial_t </strong><em>keyring</em><strong>);</strong></pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p><strong>keyctl_get_persistent</strong>() gets the persistent keyring for the specified user ID.  Unlike the session and user keyrings, this keyring will persist once all login sessions have been deleted and can thus be used to carry authentication tokens for processes that run without user interaction, such as programs started by cron.</p>
<p class='spacer'>

<p>The persistent keyring will be created by the kernel if it does not yet exist. Each time this function is called, the persistent keyring will have its expiration timeout reset to the value in:</p>
<p class='spacer'>

<p>/proc/sys/kernel/keys/persistent_keyring_expiry</p>
<p class='spacer'>

<p>(by default three days).  Should the timeout be reached, the persistent keyring will be removed and everything it pins can then be garbage collected.</p>
<p class='spacer'>

<p>If <em>uid</em> is <strong>-1</strong> then the calling process's real user ID will be used.  If <em>uid</em> is not <strong>-1</strong> then error <em>EPERM</em> will be given if the user ID requested does not match either the caller's real or effective user IDs or if the calling process does not have <strong>SetUid</strong> capability.</p>
<p class='spacer'>

<p>If successful, a link to the persistent keyring will be added into <em>keyring</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">

<p>On success <strong>keyctl_get_persistent</strong>() returns the serial number of the persistent keyring.  On error, the value <strong>-1</strong> will be returned and errno will have been set to an appropriate error.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">

  <dl class='dl-vertical'>
    <dt><strong>EPERM</strong></dt>
    <dd>
  <p>Not permitted to access the persistent keyring for the requested <em>uid</em>.</p>
    </dd>
    <dt><strong>ENOMEM</strong></dt>
    <dd>
  <p>Insufficient memory to create the persistent keyring or to extend <em>keyring</em>.</p>
    </dd>
    <dt><strong>ENOKEY</strong></dt>
    <dd>
  <p><em>keyring</em> does not exist.</p>
    </dd>
    <dt><strong>EKEYEXPIRED</strong></dt>
    <dd>
  <p><em>keyring</em> has expired.</p>
    </dd>
    <dt><strong>EKEYREVOKED</strong></dt>
    <dd>
  <p><em>keyring</em> has been revoked.</p>
    </dd>
    <dt><strong>EDQUOT</strong></dt>
    <dd>
  <p>The user does not have sufficient quota to extend <em>keyring</em>.</p>
    </dd>
    <dt><strong>EACCES</strong></dt>
    <dd>
  <p><em>keyring</em> exists, but does not grant <strong>write</strong> permission to the calling process.</p>
<p class='spacer'>

    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LINKING</h2>
        <div class="sectioncontent">

<p>This is a library function that can be found in <em>libkeyutils</em>. When linking, <strong>-lkeyutils</strong> should be specified to the linker.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<p><a href="../man1/keyctl.1.html"><strong>keyctl</strong>(1)</a>,</p>
<p class='spacer'>

<p><a href="../man2/add_key.2.html"><strong>add_key</strong>(2)</a>,</p>
<p class='spacer'>

<p><a href="../man2/keyctl.2.html"><strong>keyctl</strong>(2)</a>,</p>
<p class='spacer'>

<p><a href="../man2/request_key.2.html"><strong>request_key</strong>(2)</a>,</p>
<p class='spacer'>

<p><a href="../man3/keyctl.3.html"><strong>keyctl</strong>(3)</a>,</p>
<p class='spacer'>

<p><a href="../man7/persistent-keyring.7.html"><strong>persistent-keyring</strong>(7)</a>,</p>
<p class='spacer'>

<p><a href="../man7/keyutils.7.html"><strong>keyutils</strong>(7)</a>,</p>
<p class='spacer'>

<p><a href="../man7/keyrings.7.html"><strong>keyrings</strong>(7)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="keyctl_get_keyring_ID.3.html"><span aria-hidden="true">&larr;</span> keyctl_get_keyring_ID.3: Get the ID of a special keyring</a></li>
   <li class="next"><a href="keyctl_get_security.3.html">keyctl_get_security.3: Retrieve a key's security context <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
