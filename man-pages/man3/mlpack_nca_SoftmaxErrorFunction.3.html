<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>mlpack_nca_SoftmaxErrorFunction: The 'softmax' stochastic neighbor assignment probability function.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="The 'softmax' stochastic neighbor assignment probability function.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="mlpack_nca_SoftmaxErrorFunction (3) manual">
  <meta name="twitter:description" content="The 'softmax' stochastic neighbor assignment probability function.">
  <meta name="twitter:image" content="https://www.carta.tech/images/mlpack-doc-mlpack_nca_SoftmaxErrorFunction-3.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3/mlpack_nca_SoftmaxErrorFunction.3.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="mlpack_nca_SoftmaxErrorFunction (3) manual" />
  <meta property="og:description" content="The 'softmax' stochastic neighbor assignment probability function." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/mlpack-doc-mlpack_nca_SoftmaxErrorFunction-3.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">mlpack_nca_SoftmaxErrorFunction<small> (3)</small></h1>
        <p class="lead">The 'softmax' stochastic neighbor assignment probability function.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/mlpack_nca_SoftmaxErrorFunction.3.html">
      <span itemprop="name">mlpack_nca_SoftmaxErrorFunction: The 'softmax' stochastic neighbor assignment probability function.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/mlpack-doc/">
      <span itemprop="name">mlpack-doc</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/mlpack_nca_SoftmaxErrorFunction.3.html">
      <span itemprop="name">mlpack_nca_SoftmaxErrorFunction: The 'softmax' stochastic neighbor assignment probability function.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<h3>Public Member Functions</h3>
<p><strong>SoftmaxErrorFunction</strong> (const arma::mat &<strong>dataset</strong>, const arma::Col&lt; size_t &gt; &<strong>labels</strong>, MetricType <strong>metric</strong>=MetricType())</p><p><em>Initialize with the given kernel; useful when the kernel has some state to store, which is set elsewhere. </em> double <strong>Evaluate</strong> (const arma::mat &covariance)</p><p><em>Evaluate the softmax function for the given covariance matrix. </em> double <strong>Evaluate</strong> (const arma::mat &covariance, const size_t i)</p><p><em>Evaluate the softmax objective function for the given covariance matrix on only one point of the dataset. </em> const arma::mat <strong>GetInitialPoint</strong> () const </p><p><em>Get the initial point. </em> void <strong>Gradient</strong> (const arma::mat &covariance, arma::mat &gradient)</p><p><em>Evaluate the gradient of the softmax function for the given covariance matrix. </em> void <strong>Gradient</strong> (const arma::mat &covariance, const size_t i, arma::mat &gradient)</p><p><em>Evaluate the gradient of the softmax function for the given covariance matrix on only one point of the dataset. </em> size_t <strong>NumFunctions</strong> () const </p><p><em>Get the number of functions the objective function can be decomposed into. </em> std::string <strong>ToString</strong> () const </p>
<h3>Private Member Functions</h3>
<p>void <strong>Precalculate</strong> (const arma::mat &coordinates)</p><p><em>Precalculate the denominators and numerators that will make up the p_ij, but only if the coordinates matrix is different than the last coordinates the </em><strong>Precalculate()</strong><em> method was run with. </em><strong></strong></p>
<h3>Private Attributes</h3>
<p>const arma::mat & <strong>dataset</strong></p><p><em>The dataset. </em> arma::vec <strong>denominators</strong></p><p><em>Holds denominators for calculation of p_ij, for the non-separable </em><strong>Evaluate()</strong><em> and </em><strong>Gradient()</strong><em>. </em><strong></strong> const arma::Col&lt; size_t &gt; & <strong>labels</strong></p><p><em>Labels for each point in the dataset. </em> arma::mat <strong>lastCoordinates</strong></p><p><em>Last coordinates. Used for the non-separable </em><strong>Evaluate()</strong><em> and </em><strong>Gradient()</strong><em>. </em><strong></strong> MetricType <strong>metric</strong></p><p><em>The instantiated metric. </em> arma::vec <strong>p</strong></p><p><em>Holds calculated p_i, for the non-separable </em><strong>Evaluate()</strong><em> and </em><strong>Gradient()</strong><em>. </em><strong></strong> bool <strong>precalculated</strong></p><p><em>False if nothing has ever been precalculated (only at construction time). </em> arma::mat <strong>stretchedDataset</strong></p><p><em>Stretched dataset. Kept internal to avoid memory reallocations. </em></p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Detailed Description</h2>
        <div class="sectioncontent">
<h3>template&lt;typename MetricType = metric::SquaredEuclideanDistance&gt;class mlpack::nca::SoftmaxErrorFunction&lt; MetricType &gt;</h3>
<p>The 'softmax' stochastic neighbor assignment probability function.</p><p>The actual function is</p><p>p_ij = (exp(-|| A x_i - A x_j || ^ 2)) / (sum_{k != i} (exp(-|| A x_i - A x_k || ^ 2)))</p><p>where x_n represents a point and A is the current scaling matrix.</p><p>This class is more flexible than the original paper, allowing an arbitrary metric function to be used in place of || A x_i - A x_j ||^2, meaning that the squared Euclidean distance is not the only allowed metric for <strong>NCA</strong>. However, that is probably the best way to use this class.</p><p>In addition to the standard <strong>Evaluate()</strong> and <strong>Gradient()</strong> functions which MLPACK optimizers use, overloads of <strong>Evaluate()</strong> and <strong>Gradient()</strong> are given which only operate on one point in the dataset. This is useful for optimizers like stochastic gradient descent (see <strong>mlpack::optimization::SGD</strong>).</p><p>Definition at line 52 of file nca_softmax_error_function.hpp.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Constructor & Destructor Documentation</h2>
        <div class="sectioncontent">
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::\fBSoftmaxErrorFunction\fP (const arma::mat &dataset, const arma::Col&lt; size_t &gt; &labels, MetricTypemetric = \fCMetricType()\fP)</h3>
<p>Initialize with the given kernel; useful when the kernel has some state to store, which is set elsewhere. If no kernel is given, an empty kernel is used; this way, you can call the constructor with no arguments. A reference to the dataset we will be optimizing over is also required.</p><p><strong>Parameters:</strong></p><p><em>dataset</em> Matrix containing the dataset.</p><p><em>labels</em> Vector of class labels for each point in the dataset.</p><p><em>kernel</em> Instantiated kernel (optional).</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Member Function Documentation</h2>
        <div class="sectioncontent">
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; double \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::Evaluate (const arma::mat &covariance)</h3>
<p>Evaluate the softmax function for the given covariance matrix. This is the non-separable implementation, where the objective function is not decomposed into the sum of several objective functions.</p><p><strong>Parameters:</strong></p><p><em>covariance</em> Covariance matrix of Mahalanobis distance.</p>
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; double \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::Evaluate (const arma::mat &covariance, const size_ti)</h3>
<p>Evaluate the softmax objective function for the given covariance matrix on only one point of the dataset. This is the separable implementation, where the objective function is decomposed into the sum of many objective functions, and here, only one of those constituent objective functions is returned.</p><p><strong>Parameters:</strong></p><p><em>covariance</em> Covariance matrix of Mahalanobis distance.</p><p><em>i</em> Index of point to use for objective function.</p>
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; const arma::mat \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::GetInitialPoint () const</h3>
<p>Get the initial point.</p>
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; void \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::Gradient (const arma::mat &covariance, arma::mat &gradient)</h3>
<p>Evaluate the gradient of the softmax function for the given covariance matrix. This is the non-separable implementation, where the objective function is not decomposed into the sum of several objective functions.</p><p><strong>Parameters:</strong></p><p><em>covariance</em> Covariance matrix of Mahalanobis distance.</p><p><em>gradient</em> Matrix to store the calculated gradient in.</p>
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; void \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::Gradient (const arma::mat &covariance, const size_ti, arma::mat &gradient)</h3>
<p>Evaluate the gradient of the softmax function for the given covariance matrix on only one point of the dataset. This is the separable implementation, where the objective function is decomposed into the sum of many objective functions, and here, only one of those constituent objective functions is returned.</p><p><strong>Parameters:</strong></p><p><em>covariance</em> Covariance matrix of Mahalanobis distance.</p><p><em>i</em> Index of point to use for objective function.</p><p><em>gradient</em> Matrix to store the calculated gradient in.</p>
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; size_t \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::NumFunctions () const\fC [inline]\fP</h3>
<p>Get the number of functions the objective function can be decomposed into. This is just the number of points in the dataset.</p><p>Definition at line 124 of file nca_softmax_error_function.hpp.</p>
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; void \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::Precalculate (const arma::mat &coordinates)\fC [private]\fP</h3>
<p>Precalculate the denominators and numerators that will make up the p_ij, but only if the coordinates matrix is different than the last coordinates the <strong>Precalculate()</strong> method was run with. This method is only called by the non-separable <strong>Evaluate()</strong> and <strong>Gradient()</strong>.</p><p>This will update last_coordinates_ and stretched_dataset_, and also calculate the p_i and denominators_ which are used in the calculation of p_i or p_ij. The calculation will be O((n * (n + 1)) / 2), which is not great.</p><p><strong>Parameters:</strong></p><p><em>coordinates</em> Coordinates matrix to use for precalculation.</p>
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; std::string \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::ToString () const</h3>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Member Data Documentation</h2>
        <div class="sectioncontent">
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; const arma::mat& \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::dataset\fC [private]\fP</h3>
<p>The dataset.</p><p>Definition at line 131 of file nca_softmax_error_function.hpp.</p>
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; arma::vec \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::denominators\fC [private]\fP</h3>
<p>Holds denominators for calculation of p_ij, for the non-separable <strong>Evaluate()</strong> and <strong>Gradient()</strong>.</p><p>Definition at line 146 of file nca_softmax_error_function.hpp.</p>
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; const arma::Col&lt;size_t&gt;& \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::labels\fC [private]\fP</h3>
<p>Labels for each point in the dataset.</p><p>Definition at line 133 of file nca_softmax_error_function.hpp.</p>
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; arma::mat \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::lastCoordinates\fC [private]\fP</h3>
<p>Last coordinates. Used for the non-separable <strong>Evaluate()</strong> and <strong>Gradient()</strong>.</p><p>Definition at line 139 of file nca_softmax_error_function.hpp.</p>
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; MetricType \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::metric\fC [private]\fP</h3>
<p>The instantiated metric.</p><p>Definition at line 136 of file nca_softmax_error_function.hpp.</p>
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; arma::vec \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::p\fC [private]\fP</h3>
<p>Holds calculated p_i, for the non-separable <strong>Evaluate()</strong> and <strong>Gradient()</strong>.</p><p>Definition at line 143 of file nca_softmax_error_function.hpp.</p>
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; bool \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::precalculated\fC [private]\fP</h3>
<p>False if nothing has ever been precalculated (only at construction time).</p><p>Definition at line 149 of file nca_softmax_error_function.hpp.</p>
<h3>template&lt;typename MetricType  = metric::SquaredEuclideanDistance&gt; arma::mat \fBmlpack::nca::SoftmaxErrorFunction\fP&lt; MetricType &gt;::stretchedDataset\fC [private]\fP</h3>
<p>Stretched dataset. Kept internal to avoid memory reallocations.</p><p>Definition at line 141 of file nca_softmax_error_function.hpp.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Author</h2>
        <div class="sectioncontent">
<p>Generated automatically by Doxygen for MLPACK from the source code.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="mlpack_nca_NCA.3.html"><span aria-hidden="true">&larr;</span> mlpack_nca_NCA.3: An implementation of neighborhood components analysis, both a linear dimensionality reduction technique and a distance learning technique.</a></li>
   <li class="next"><a href="mlpack_neighbor.3.html">mlpack_neighbor.3: Neighbor-search routines. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
