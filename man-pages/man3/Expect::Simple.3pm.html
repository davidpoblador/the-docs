<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Expect::Simple: Wrapper around the expect module</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Wrapper around the expect module">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Expect::Simple (3pm) manual">
  <meta name="twitter:description" content="Wrapper around the expect module">
  <meta name="twitter:image" content="https://www.carta.tech/images/libexpect-simple-perl-Expect::Simple-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Expect::Simple.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Expect::Simple (3pm) manual" />
  <meta property="og:description" content="Wrapper around the expect module" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libexpect-simple-perl-Expect::Simple-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Expect::Simple<small> (3pm)</small></h1>
        <p class="lead">Wrapper around the expect module</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Expect::Simple.3pm.html">
      <span itemprop="name">Expect::Simple: Wrapper around the expect module</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libexpect-simple-perl/">
      <span itemprop="name">libexpect-simple-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Expect::Simple.3pm.html">
      <span itemprop="name">Expect::Simple: Wrapper around the expect module</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use Expect::Simple;

  my $obj = new Expect::Simple
        { Cmd =&gt; [ dmcoords =&gt; &apos;verbose=1&apos;, "infile=$infile"],
          Prompt =&gt; [ -re =&gt; &apos;dmcoords&gt;:&#92;s+&apos; ],
          DisconnectCmd =&gt; &apos;q&apos;,
          Verbose =&gt; 0,
          Debug =&gt; 0,
          Timeout =&gt; 100
        };

  $obj-&gt;send( $cmd );
  print $obj-&gt;before;
  print $obj-&gt;after;
  print $obj-&gt;match_str, "&#92;n";
  print $obj-&gt;match_idx, "&#92;n";
  print $obj-&gt;error_expect;
  print $obj-&gt;error;

  $expect_object = $obj-&gt;expect_handle;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>\*(C`Expect::Simple\*(C' is a wrapper around the \*(C`Expect\*(C' module which should suffice for simple applications.  It hides most of the \*(C`Expect\*(C' machinery; the \*(C`Expect\*(C' object is available for tweaking if need be.</p><p>Generally, one starts by creating an <strong>Expect::Simple</strong> object using <strong>new</strong>.  This will start up the target program, and will wait until one of the specified prompts is output by the target.  At that point the caller should <strong></strong><strong>send()</strong><strong></strong> commands to the program; the results are available via the <strong>before</strong>, <strong>after</strong>, <strong>match_str</strong>, and <strong>match_idx</strong> methods.  Since <strong>Expect</strong> simulates a terminal, there will be extra \*(C`&#92;r\*(C' characters at the end of each line in the result (on \s-1UNIX\s0 at least).  This is easily fixed:</p><p>    ($res = $obj-&gt;before) =~ tr/&#92;r//d;     @lines = split( "&#92;n", $res );</p><p>This is <strong>not</strong> done automatically.</p><p>Exceptions will be thrown on error (match with \*(C`/Expect::Simple/\*(C'). Errors from <strong>Expect</strong> are available via the <strong>error_expect</strong> method. More human readable errors are available via the <strong>error</strong> method.</p><p>The connection is automatically broken (by sending the specified disconnect command to the target) when the <strong>Expect::Simple</strong> object is destroyed.</p><h3>Methods</h3>

<dl class='dl-vertical'>
  <dt>
    new
  </dt>
  <dd>
    <p>    $obj = Expect::Simple-&gt;new( &#92;%attr ); This creates a new object, starting up the program with which to communicate (using the <strong>Expect</strong> <strong>spawn</strong> method) and waiting for a prompt.  The passed hash reference must contain at least the <strong>Prompt</strong>, <strong>DisconnectCmd</strong>, and <strong>Cmd</strong> elements.  The available attributes are:</p>
<dl class='dl-vertical'>
  <dt>
    Cmd
  </dt>
  <dd>
    <p>  Cmd =&gt; $command,   Cmd =&gt; [ $command, $arg1, $arg2, ... ], The command to which to connect.  The passed command may either be a scalar or an array.</p>
  </dd>
  <dt>
    Prompt
  </dt>
  <dd>
    <p>This specifies one or more prompts to scan for.  For a single prompt, the value may be a scalar; for more, or for matching of regular expressions, it should be an array reference.  For example,   Prompt =&gt; &apos;prompt1&gt; &apos;,   Prompt =&gt; [ &apos;prompt1&gt; &apos;, &apos;prompt2&gt; &apos;, -re =&gt; &apos;prompt&#92;d+&gt;&#92;s+&apos; ] All prompts are taken literally, unless immediately preceded by a \*(C`-re\*(C' flag, in which case they are regular expressions.</p>
  </dd>
  <dt>
    DisconnectCmd
  </dt>
  <dd>
    <p>This is the command to be sent to the target program which will cause it to exit.</p>
  </dd>
  <dt>
    RawPty
  </dt>
  <dd>
    <p>If set, then underlying <strong>Expect</strong> object's pty mode is set to raw mode (see  <strong></strong><strong>Expect::raw_pty()</strong><strong></strong>).</p>
  </dd>
  <dt>
    Timeout
  </dt>
  <dd>
    <p>The time in seconds to wait until giving up on the target program responding.  This is used during program startup and when any commands are sent to the program.  It defaults to 1000 seconds.</p>
  </dd>
  <dt>
    Debug
  </dt>
  <dd>
    <p>The value is passed to <strong>Expect</strong> via its <strong>debug</strong> method.</p>
  </dd>
  <dt>
    Verbose
  </dt>
  <dd>
    <p>This results in various messages printed to the \s-1STDERR\s0 stream. If greater than 3, it turns on <strong>Expect</strong>'s logging to \s-1STDOUT\s0 (via the <strong>log_stdout</strong> <strong>Expect</strong> method.</p>
  </dd>

</dl>

  </dd>
  <dt>
    send
  </dt>
  <dd>
    <p>   $obj-&gt;send( $cmd );    $obj-&gt;send( @cmds ); Send one or more commands to the target.  After each command is sent, it waits for a prompt from the target.  Only the output resulting from the last command is available via the <strong>after</strong>, <strong>before</strong>, etc. methods.</p>
  </dd>
  <dt>
    match_idx
  </dt>
  <dd>
    <p>This returns a unary based index indicating which prompt (in the list of prompts specified via the \*(C`Prompt\*(C' attribute to the <strong>new</strong> method) was received after the last command was sent.  It will be undef if none was returned.</p>
  </dd>
  <dt>
    match_str
  </dt>
  <dd>
    <p>This returns the prompt which was matched after the last command was sent.</p>
  </dd>
  <dt>
    before
  </dt>
  <dd>
    <p>This returns the string received before the prompt.  If no prompt was seen, it returns all output accumulated.  This is usually what the caller wants to parse.  Note that the first line will (usually) be the command that was sent to the target, because of echoing.  Check this out to be sure!</p>
  </dd>
  <dt>
    after
  </dt>
  <dd>
    <p>This returns the 'after' string.  Please read the <strong>Expect</strong> docs for more enlightenment.</p>
  </dd>
  <dt>
    error
  </dt>
  <dd>
    <p>This returns a cleaned up, more humanly readable version of the errors from <strong>Expect</strong>.  It'll be undef if there was no error.</p>
  </dd>
  <dt>
    error_expect
  </dt>
  <dd>
    <p>This returns the original <strong>Expect</strong> error.</p>
  </dd>
  <dt>
    expect_handle
  </dt>
  <dd>
    <p>This returns the <strong>Expect</strong> object, in case further tweaking is necessary.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>If the command to be run does not exist (or not in the current execution path), it's quite possible that the <strong>new</strong> method will not throw an exception.  It's up to the caller to make sure that the command will run!  There's no known workaround for this.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE</h2>
        <div class="sectioncontent">
<p>This software is released under the \s-1GNU\s0 General Public License.  You may find a copy at</p><p>   http://www.fsf.org/copyleft/gpl.html</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Diab Jerius (djerius@cpan.org)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Expect.3pm.html"><span aria-hidden="true">&larr;</span> Expect.3pm: Expect for perl</a></li>
   <li class="next"><a href="Exporter::Renaming.3pm.html">Exporter::Renaming.3pm: Allow renaming of symbols on import <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
