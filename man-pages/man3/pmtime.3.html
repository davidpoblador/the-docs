<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pmtime: Time control functions for synchronizing the archive position and update interval between one or more applications</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Time control functions for synchronizing the archive position and update interval between one or more applications">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pmtime<small> (3)</small></h1>
        <p class="lead">Time control functions for synchronizing the archive position and update interval between one or more applications</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/">
      <span itemprop="name">Library calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/pmtime.3.html">
      <span itemprop="name">pmtime: Time control functions for synchronizing the archive position and update interval between one or more applications</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/pcp/">
      <span itemprop="name">pcp</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3/pmtime.3.html">
      <span itemprop="name">pmtime: Time control functions for synchronizing the archive position and update interval between one or more applications</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">C SYNOPSIS</h2>
        <div class="sectioncontent">

<p>#include &lt;pcp/pmtime.h&gt;</p>
<p class='spacer'>

<p>int pmTimeConnect(int <em>port</em>, pmTime *<em>state</em>);</p>
<p class='spacer'>

<p>int pmTimeDisconnect(int <em>fd</em>);</p>
<p class='spacer'>

<p>int pmTimeSendAck(int <em>fd</em>, struct timeval *<em>fetchTime</em>);</p>
<p class='spacer'>

<p>int pmTimeShowDialog(int <em>fd</em>, int <em>show</em>);</p>
<p class='spacer'>

<p>int pmTimeRecv(int <em>fd</em>, pmTime *<em>state</em>);</p>
<p class='spacer'>

<p>cc ... -lpcp_gui</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p>These functions form part of the Performance Metrics Applications Programming Interface (PMAPI) and are intended to provide a uniform mechanism for applications to both replay archive data and report live data in a time synchronized manner.</p>
<p class='spacer'>

<p>The <em>pmTime</em> structure has the following fields:</p>
<p class='spacer'>

<pre>typedef struct {
    unsigned int        magic;
    unsigned int        length;
    pm_tctl_command     command;
    pm_tctl_source      source;
    pm_tctl_state       state;
    pm_tctl_mode        mode;
    struct timeval      delta;
    struct timeval      position;
    struct timeval      start;     /* archive only */
    struct timeval      end;       /* archive only */
    char                data[0];   /* arbitrary length info (TZ) */
} pmTime;</pre>

<p class='spacer'>

<p>In the simplest case, the application should call <strong>pmTimeConnect</strong> to connect to the time control server, <a href="../man1/pmtime.1.html"><strong>pmtime</strong>(1)</a>, and then repeatedly call <strong>pmTimeRecv</strong> in the main loop of the application. On success, <strong>pmTimeConnect</strong> returns a non-negative file descriptor. In applications which have multiple threads of control, rather than simply blocking in <strong>pmTimeRecv</strong>, the file descriptor may be used in calls to <a href="../man2/select.2.html"><strong>select</strong>(2)</a>. In graphical applications, the file descriptor may be used to interface with the event loop.</p>
<p class='spacer'>

<p>The <em>port</em> parameter to <strong>pmTimeConnect</strong> is the port number of the socket on which the time control server is (or will be) listening for new connections.</p>
<p class='spacer'>

<p>The state parameter to <strong>pmTimeConnect</strong> is used to initialize a new time control server or to pass additional information to an existing time control server. The <em>start</em> and <em>finish</em> fields indicate the chronological bounds interesting to the application. The <em>showdialog</em> field indicates whether the time control server should initially show or hide the dialog. The <em>position</em>, <em>delta,</em> and <em>data</em> fields indicate the initial archive position, update interval, time zone string and time zone label string.</p>
<p class='spacer'>

<p><strong>pmTimeRecv</strong> blocks until the time control server sends a command message. It then updates the state parameter and returns one of the PM_TCTL command identifiers.</p>
<p class='spacer'>

<p>The PM_TCTL_SET command indicates the application should seek to the archive position (see <strong>pmSetMode</strong>(3)) returned in the position field of the state parameter.</p>
<p class='spacer'>

<p>The PM_TCTL_STEP command indicates the application should perform an update, i.e. advance (or rewind, if delta is negative) to the time indicated by position and then fetch new metric values, update the display or whatever.  In order for several application to remain synchronized, the time control server will wait until all applications have acknowledged that they have completed the step command. Applications should call pmTimeSendAck when the step command has been processed.  Note that PM_TCTL_STEP is the only command that requires an explicit acknowledgement.</p>
<p class='spacer'>

<p>The PM_TCTL_VCRMODE command is used by the time control server to indicate the current VCR mode.</p>
<p class='spacer'>

<p>The value is returned in the vcrmode field of the state parameter passed to <strong>pmTimeRecv</strong>, and remains valid until the next PM_TCTL_VCRMODE command is received.</p>
<p class='spacer'>

<p>The PM_TCTL_TZ command indicates the application should use a new time- zone, as indicated in the <em>tz</em> and <em>tzlabel</em> fields of the state parameter.</p>
<p class='spacer'>

<p>The PM_TCTL_BOUNDS command is sent to all applications when the time control server changes its chronological bounds. This may occur when a new application connects to the time control server or the user changes the bounds manually. Most applications will ignore this command.</p>
<p class='spacer'>

<p>The PM_TCTL_SHOWDIALOG command will be sent to all applications when the visibility of the time control server changes. This allows applications to alter the text in menus or buttons to reflect this change. Applications may change the visibility of the time control dialog using the <strong>pmTimeShowDialog</strong> function. The initial visibility is determined when the time control dialog is first created by an application calling <strong>pmTimeConnect</strong> with the showdialog field in the state parameter set to the desired value.</p>
<p class='spacer'>

<p>The <strong>pmTimeDisconnect</strong> function may be used to close the command socket to the time control server. This is useful when applications need to change the connection mode, e.g. to divorce the current time control server and connect to a new one.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO pmtime&hellip;</h2>
        <div class="sectioncontent">

<p><a href="../man1/pmtime.1.html"><strong>pmtime</strong>(1)</a>, <strong>PMAPI</strong>(3) and <strong>pmSetMode</strong>(3).</p>
        </div>
      </section>

<nav>
  <ul class="pager">
   <li class="previous"><a href="pmspeclocalpmda.3.html"><span aria-hidden="true">&larr;</span> pmspeclocalpmda.3: Process command-line argument for the table of dso pmdas</a></li>
   <li class="next"><a href="pmtraversepmns.3.html">pmtraversepmns.3: Traverse the performance metrics name space <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
