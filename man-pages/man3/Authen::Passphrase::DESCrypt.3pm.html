<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Authen::Passphrase::DESCrypt: Passphrases using the des-based unix crypt()</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Passphrases using the des-based unix crypt()">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Authen::Passphrase::DESCrypt (3pm) manual">
  <meta name="twitter:description" content="Passphrases using the des-based unix crypt()">
  <meta name="twitter:image" content="https://www.carta.tech/images/libauthen-passphrase-perl-Authen::Passphrase::DESCrypt-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Authen::Passphrase::DESCrypt.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Authen::Passphrase::DESCrypt (3pm) manual" />
  <meta property="og:description" content="Passphrases using the des-based unix crypt()" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libauthen-passphrase-perl-Authen::Passphrase::DESCrypt-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Authen::Passphrase::DESCrypt<small> (3pm)</small></h1>
        <p class="lead">Passphrases using the des-based unix crypt()</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Authen::Passphrase::DESCrypt.3pm.html">
      <span itemprop="name">Authen::Passphrase::DESCrypt: Passphrases using the des-based unix crypt()</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libauthen-passphrase-perl/">
      <span itemprop="name">libauthen-passphrase-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Authen::Passphrase::DESCrypt.3pm.html">
      <span itemprop="name">Authen::Passphrase::DESCrypt: Passphrases using the des-based unix crypt()</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
        use Authen::Passphrase::DESCrypt;

        $ppr = Authen::Passphrase::DESCrypt-&gt;new(
                        salt_base64 =&gt; "my",
                        hash_base64 =&gt; "TYK.j.88/9s");

        $ppr = Authen::Passphrase::DESCrypt-&gt;new(
                        salt_random =&gt; 12,
                        passphrase =&gt; "passphrase");

        $ppr = Authen::Passphrase::DESCrypt
                -&gt;from_crypt(&apos;myTYK.j.88/9s&apos;);

        $ppr = Authen::Passphrase::DESCrypt-&gt;new(
                        fold =&gt; 1,
                        initial =&gt; "xyzzy!!!",
                        nrounds =&gt; 500,
                        salt_base64 =&gt; "quux",
                        hash_base64 =&gt; "QCKcHlgVsRY");

        $fold = $ppr-&gt;fold;
        $initial = $ppr-&gt;initial;
        $initial_base64 = $ppr-&gt;initial_base64;
        $nrounds = $ppr-&gt;nrounds;
        $nrounds_base64 = $ppr-&gt;nrounds_base64_4;
        $salt = $ppr-&gt;salt;
        $salt_base64 = $ppr-&gt;salt_base64_2;
        $salt_base64 = $ppr-&gt;salt_base64_4;
        $hash = $ppr-&gt;hash;
        $hash_base64 = $ppr-&gt;hash_base64;

        if($ppr-&gt;match($passphrase)) { ...

        $passwd = $ppr-&gt;as_crypt;
        $userPassword = $ppr-&gt;as_rfc2307;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>An object of this class encapsulates a passphrase hashed using some form of the DES-based Unix <em>crypt()</em> hash function.  This is a subclass of Authen::Passphrase, and this document assumes that the reader is familiar with the documentation for that class.</p><p>The <em>crypt()</em> function in a modern Unix actually supports several different passphrase schemes.  That is not what this class is about.  This class is concerned only with one family of schemes, variants of the DES-based scheme that <em>crypt()</em> originally implemented, which confusingly is usually referred to merely as \*(L"<em>crypt()</em>\*(R".  To handle the whole range of passphrase schemes supported by the modern <em>crypt()</em>, see the from_crypt constructor and the as_crypt method in Authen::Passphrase.</p><p><em>Warning:</em> this password scheme is weak by modern standards, and in any case does not support a large password space.  Cracking <em>crypt()</em>ed passwords has been a routine activity since the early 1990s.  This scheme is supported for compatibility reasons only, and should not be used except when compatibility is required.  Do not use this in the design of any new system or for new passwords in any system that supports better passphrase schemes.</p><h3>The traditional DES-based Unix \fIcrypt()\fP password scheme</h3>
<p>The traditional Unix <em>crypt()</em> password scheme is based on the \s-1DES\s0 block encryption algorithm.  Using the password as a 56-bit key, it passes a 64-bit data block, initialised to zero, through the encryption function 25 times, and the hash is the 64-bit output of this process.  A 12-bit salt is used to tweak the encryption algorithm.</p><p>The 56-bit key is extracted from the password in a very poor way. Only the first eight bytes of the password are used, and any remainder is ignored.  This makes it impossible to use a passphrase, rather than a password, hence the terminology in this section.  Of the eight bytes used, the top bit is also ignored; this function hails from the days of pure \s-1ASCII\s0.</p><p>A password hash of this scheme is conventionally represented in \s-1ASCII\s0 as a 13-character string using a base 64 encoding.  The base 64 digits are "<strong>.</strong>\*(L", \*(R"<strong>/</strong>\*(L", \*(R"<strong>0</strong>\*(L" to \*(R"<strong>9</strong>\*(L", \*(R"<strong>A</strong>\*(L" to \*(R"<strong>Z</strong>\*(L", \*(R"<strong>a</strong>\*(L" to \*(R"<strong>z</strong>" (in \s-1ASCII\s0 order).  The first two characters give the 12-bit salt. The remaining eleven characters give the 64-bit hash.  Because the base 64 encoding can represent 66 bits in eleven digits, more than the 64 required, the last character of the string can only take sixteen of the base 64 digit values.</p>
<h3>Variant DES-based Unix \fIcrypt()\fP passphrase schemes</h3>
<p>To make password cracking more difficult, historically some Unix sites modified the <em>crypt()</em> function to be incompatible with the standard one. This was easily achieved by initialising the data block to something other than the standard all-bits-zero.  Another variation used was to increase the number of encryption rounds, which makes cracking take longer in addition to being non-standard.  Password hashes on such a system looked normal but were not interoperable with standard <em>crypt()</em> implementations.  To interpret them properly it is necessary to know the modified parameters.</p><p>BSDi standardised an extended DES-based scheme.  The salt is extended to 24 bits, and the number of encryption rounds is variable.  Passphrases longer than 8 characters are handled by an additional step that folds (hashes) them down to 8 characters, rather than just throwing away the characters after the eighth.  Passphrase hashes in this scheme are conventionally represented in \s-1ASCII\s0 as a "<strong>_</strong>" followed by 19 characters of base 64.  The first four base 64 digits give the number of encryption rounds, the next four give the salt, and the remaining eleven give the hash.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONSTRUCTORS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    Authen::Passphrase::DESCrypt-&gt;new(\s-1ATTR\s0 =&gt; \s-1VALUE\s0, ...)
  </dt>
  <dd>
    <p>Generates a new passphrase recogniser object using the generalised DES-based <em>crypt()</em> algorithm.  The following attributes may be given:</p>
<dl class='dl-vertical'>
  <dt>
    <strong>fold</strong>
  </dt>
  <dd>
    <p>Truth value indicating whether the BSDi passphrase folding scheme should be used for long passphrases.  Default false, for compatibility with the original DES-based scheme.</p>
  </dd>
  <dt>
    <strong>initial</strong>
  </dt>
  <dd>
    <p>The initial data block to encrypt, as a string of exactly eight bytes. Default all bits zero, for compatibility with the original DES-based scheme.</p>
  </dd>
  <dt>
    <strong>initial_base64</strong>
  </dt>
  <dd>
    <p>The initial data block to encrypt, as a string of eleven base 64 digits.</p>
  </dd>
  <dt>
    <strong>nrounds</strong>
  </dt>
  <dd>
    <p>The number of encryption rounds to use, as a Perl integer.  Default 25, for compatibility with the original DES-based scheme.</p>
  </dd>
  <dt>
    <strong>nrounds_base64</strong>
  </dt>
  <dd>
    <p>The number of encryption rounds to use, as a string of four base 64 digits.</p>
  </dd>
  <dt>
    <strong>salt</strong>
  </dt>
  <dd>
    <p>The salt, as an integer in the range [0, 16777216).</p>
  </dd>
  <dt>
    <strong>salt_base64</strong>
  </dt>
  <dd>
    <p>The salt, as a string of two or four base 64 digits.</p>
  </dd>
  <dt>
    <strong>salt_random</strong>
  </dt>
  <dd>
    <p>Causes salt to be generated randomly.  The value given for this attribute must be either 12 or 24, giving the number of bits of salt to generate. The source of randomness may be controlled by the facility described in Data::Entropy.</p>
  </dd>
  <dt>
    <strong>hash</strong>
  </dt>
  <dd>
    <p>The hash (output of encryption), as a string of exactly eight bytes.</p>
  </dd>
  <dt>
    <strong>hash_base64</strong>
  </dt>
  <dd>
    <p>The hash, as a string of eleven base 64 digits.</p>
  </dd>
  <dt>
    <strong>passphrase</strong>
  </dt>
  <dd>
    <p>A passphrase that will be accepted.</p>
  </dd>

</dl>
<p>The salt must be given, and either the hash or the passphrase.  The other parameters default to those used in the original DES-based <em>crypt()</em>.</p>
  </dd>
  <dt>
    Authen::Passphrase::DESCrypt-&gt;from_crypt(\s-1PASSWD\s0)
  </dt>
  <dd>
    <p>Generates a new passphrase recogniser object using the DES-based <em>crypt()</em> algorithm, from a crypt string.  Two forms of crypt string are supported. The first form of crypt string must consist of 13 base 64 digits. The first two give the salt, and the next eleven give the hash. Long passphrases are not folded, the initial block is all bits zero, and 25 encryption rounds are performed. The second form of crypt string must consist of an "<strong>_</strong>" followed by 19 base 64 digits.  The first four give the number of encryption rounds, the next four give the salt, and the next eleven give the hash. Long passphrases are folded, and the initial block is all bits zero.</p>
  </dd>
  <dt>
    Authen::Passphrase::DESCrypt-&gt;from_rfc2307(\s-1USERPASSWORD\s0)
  </dt>
  <dd>
    <p>Generates a new passphrase recogniser object using the DES-based <em>crypt()</em> algorithm, from an \s-1RFC\s0 2307 string.  The string must consist of "<strong>{\s-1CRYPT\s0}</strong>" (case insensitive) followed by an acceptable crypt string.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>Returns a truth value indicating whether passphrase folding is used. Returns the initial block, as a string of eight bytes. Returns the initial block, as a string of eleven base 64 digits. Returns the number of encryption rounds, as a Perl integer. Returns the number of encryption rounds, as a string of four base 64 digits. Returns the salt, as a Perl integer. Returns the salt, as a string of two base 64 digits.  \*(C`die\*(C's if it doesn't fit into two digits. Returns the salt, as a string of four base 64 digits. Returns the hash value, as a string of eight bytes. Returns the hash value, as a string of eleven base 64 digits. These methods are part of the standard Authen::Passphrase interface.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO Authen::Passphrase::DESCrypt&hellip;</h2>
        <div class="sectioncontent">
<p>Authen::Passphrase, Crypt::UnixCrypt_XS</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Andrew Main (Zefram) &lt;zefram@fysh.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (C) 2006, 2007, 2009, 2010, 2012 Andrew Main (Zefram) &lt;zefram@fysh.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE</h2>
        <div class="sectioncontent">
<p>This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Authen::Passphrase::Crypt16.3pm.html"><span aria-hidden="true">&larr;</span> Authen::Passphrase::Crypt16.3pm: Passphrases using ultrix crypt16 algorithm</a></li>
   <li class="next"><a href="Authen::Passphrase::EggdropBlowfish.3pm.html">Authen::Passphrase::EggdropBlowfish.3pm: Passphrases using eggdrop's blowfish.mod <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
