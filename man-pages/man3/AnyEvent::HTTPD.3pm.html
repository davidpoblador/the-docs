<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AnyEvent::HTTPD: A simple lightweight event based web (application) server</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A simple lightweight event based web (application) server">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="AnyEvent::HTTPD (3pm) manual">
  <meta name="twitter:description" content="A simple lightweight event based web (application) server">
  <meta name="twitter:image" content="https://www.carta.tech/images/libanyevent-httpd-perl-AnyEvent::HTTPD-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/AnyEvent::HTTPD.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="AnyEvent::HTTPD (3pm) manual" />
  <meta property="og:description" content="A simple lightweight event based web (application) server" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libanyevent-httpd-perl-AnyEvent::HTTPD-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">AnyEvent::HTTPD<small> (3pm)</small></h1>
        <p class="lead">A simple lightweight event based web (application) server</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/AnyEvent::HTTPD.3pm.html">
      <span itemprop="name">AnyEvent::HTTPD: A simple lightweight event based web (application) server</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libanyevent-httpd-perl/">
      <span itemprop="name">libanyevent-httpd-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/AnyEvent::HTTPD.3pm.html">
      <span itemprop="name">AnyEvent::HTTPD: A simple lightweight event based web (application) server</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>Version 0.93</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    use AnyEvent::HTTPD;

    my $httpd = AnyEvent::HTTPD-&gt;new (port =&gt; 9090);

    $httpd-&gt;reg_cb (
       &apos;/&apos; =&gt; sub {
          my ($httpd, $req) = @_;

          $req-&gt;respond ({ content =&gt; [&apos;text/html&apos;,
             "&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello World!&lt;/h1&gt;"
             . "&lt;a href=&#92;"/test&#92;"&gt;another test page&lt;/a&gt;"
             . "&lt;/body&gt;&lt;/html&gt;"
          ]});
       },
       &apos;/test&apos; =&gt; sub {
          my ($httpd, $req) = @_;

          $req-&gt;respond ({ content =&gt; [&apos;text/html&apos;,
             "&lt;html&gt;&lt;body&gt;&lt;h1&gt;Test page&lt;/h1&gt;"
             . "&lt;a href=&#92;"/&#92;"&gt;Back to the main page&lt;/a&gt;"
             . "&lt;/body&gt;&lt;/html&gt;"
          ]});
       },
    );

    $httpd-&gt;run; # making a AnyEvent condition variable would also work
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This module provides a simple \s-1HTTPD\s0 for serving simple web application interfaces. It's completely event based and independend from any event loop by using the AnyEvent module.</p><p>It's \s-1HTTP\s0 implementation is a bit hacky, so before using this module make sure it works for you and the expected deployment. Feel free to improve the \s-1HTTP\s0 support and send in patches!</p><p>The documentation is currently only the source code, but next versions of this module will be better documented hopefully. See also the \*(C`samples/\*(C' directory in the AnyEvent::HTTPD distribution for basic starting points.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FEATURES</h2>
        <div class="sectioncontent">
<ul>
<li><p>support for \s-1GET\s0 and \s-1POST\s0 requests.</p></li><li><p>support for \s-1HTTP\s0 1.0 keep-alive.</p></li><li><p>processing of \*(C`x-www-form-urlencoded\*(C' and \*(C`multipart/form-data\*(C' (\*(C`multipart/mixed\*(C') encoded form parameters.</p></li><li><p>support for streaming responses.</p></li><li><p>with version 0.8 no more dependend on \s-1LWP\s0 for HTTP::Date.</p></li><li><p>(limited) support for \s-1SSL\s0</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">METHODS</h2>
        <div class="sectioncontent">
<p>The AnyEvent::HTTPD class inherits directly from AnyEvent::HTTPD::HTTPServer which inherits the event callback interface from Object::Event.</p><p>Event callbacks can be registered via the Object::Event \s-1API\s0 (see the documentation of Object::Event for details).</p><p>For a list of available events see below in the <em>\s-1EVENTS\s0</em> section.</p>
<dl class='dl-vertical'>
  <dt>
    <strong>new (%args)</strong>
  </dt>
  <dd>
    <p>This is the constructor for a AnyEvent::HTTPD object. The %args hash may contain one of these key/value pairs:</p><p>The \s-1TCP\s0 address of the \s-1HTTP\s0 server will listen on. Usually 0.0.0.0 (the default), for a public server, or 127.0.0.1 for a local server. The \s-1TCP\s0 port the \s-1HTTP\s0 server will listen on. If undefined some free port will be used. You can get it via the \*(C`port\*(C' method. If this option is given the server will listen for a \s-1SSL/TLS\s0 connection on the configured port. As $tls_ctx you can pass anything that you can pass as \*(C`tls_ctx\*(C' to an AnyEvent::Handle object. Example:    my $httpd =       AnyEvent::HTTPD-&gt;new (          port =&gt; 443,          ssl  =&gt; { cert_file =&gt; "/path/to/my/server_cert_and_key.pem" }       ); Or:    my $httpd =       AnyEvent::HTTPD-&gt;new (          port =&gt; 443,          ssl  =&gt; AnyEvent::TLS-&gt;new (...),       ); This will set the request timeout for connections. The default value is 60 seconds. The backlog argument defines the maximum length the queue of pending connections may grow to.  The real maximum queue length will be 1.5 times more than the value specified in the backlog argument. See also \*(C`man 2 listen\*(C'. By default will be set by AnyEvent::Socket\*(C`::tcp_server\*(C' to 128. This is a special parameter that you can use to pass your own connection class to AnyEvent::HTTPD::HTTPServer.  This is only of interest to you if you plan to subclass AnyEvent::HTTPD::HTTPConnection. This is a special parameter that you can use to pass your own request class to AnyEvent::HTTPD.  This is only of interest to you if you plan to subclass AnyEvent::HTTPD::Request. This parameter sets the allowed \s-1HTTP\s0 methods for requests, defaulting to \s-1GET\s0, \s-1HEAD\s0 and \s-1POST\s0.  Each request received is matched against this list, and a '501 not implemented' is returned if no match is found.  Requests using disallowed handlers will never trigger callbacks.</p>
  </dd>
  <dt>
    <strong>port</strong>
  </dt>
  <dd>
    <p>Returns the port number this server is bound to.</p>
  </dd>
  <dt>
    <strong>host</strong>
  </dt>
  <dd>
    <p>Returns the host/ip this server is bound to.</p>
  </dd>
  <dt>
    <strong>allowed_methods</strong>
  </dt>
  <dd>
    <p>Returns an arrayref of allowed \s-1HTTP\s0 methods, possibly as set by the allowed_methods argument to the constructor.</p>
  </dd>
  <dt>
    <strong>stop_request</strong>
  </dt>
  <dd>
    <p>When the server walks the request \s-1URI\s0 path upwards you can stop the walk by calling this method. You can even stop further handling after the \*(C`request\*(C' event. Example:    $httpd-&gt;reg_cb (       &apos;/test&apos; =&gt; sub {          my ($httpd, $req) = @_;</p><p>         # ...</p><p>         $httpd-&gt;stop_request; # will prevent that the callback below is called       },       &apos;&apos; =&gt; sub { # this one wont be called by a request to &apos;/test&apos;          my ($httpd, $req) = @_;</p><p>         # ...       }    );</p>
  </dd>
  <dt>
    <strong>run</strong>
  </dt>
  <dd>
    <p>This method is a simplification of the \*(C`AnyEvent\*(C' condition variable idiom. You can use it instead of writing:    my $cvar = AnyEvent-&gt;condvar;    $cvar-&gt;wait;</p>
  </dd>
  <dt>
    <strong>stop</strong>
  </dt>
  <dd>
    <p>This will stop the \s-1HTTP\s0 server and return from the \*(C`run\*(C' method <strong>if you started the server via that method!</strong></p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EVENTS</h2>
        <div class="sectioncontent">
<p>Every request goes to a specific \s-1URL\s0. After a (\s-1GET\s0 or \s-1POST\s0) request is received the \s-1URL\s0's path segments are walked down and for each segment a event is generated. An example:</p><p>If the \s-1URL\s0 '/test/bla.jpg' is requestes following events will be generated:</p><p>  &apos;/test/bla.jpg&apos; - the event for the last segment   &apos;/test&apos;         - the event for the &apos;test&apos; segment   &apos;&apos;              - the root event of each request</p><p>To actually handle any request you just have to register a callback for the event name with the empty string. To handle all requests in the '/test' directory you have to register a callback for the event with the name &apos;/test&apos;. Here is an example how to register an event for the example \s-1URL\s0 above:</p><p>   $httpd-&gt;reg_cb (       &apos;/test/bla.jpg&apos; =&gt; sub {          my ($httpd, $req) = @_;</p><p>         $req-&gt;respond ([200, &apos;ok&apos;, { &apos;Content-Type&apos; =&gt; &apos;text/html&apos; }, &apos;&lt;h1&gt;Test&lt;/h1&gt;&apos; }]);       }    );</p><p>See also \*(C`stop_request\*(C' about stopping the walk of the path segments.</p><p>The first argument to such a callback is always the AnyEvent::HTTPD object itself.  The second argument ($req) is the AnyEvent::HTTPD::Request object for this request. It can be used to get the (possible) form parameters for this request or the transmitted content and respond to the request.</p><p>Along with the above mentioned events these events are also provided: Every request also emits the \*(C`request\*(C' event, with the same arguments and semantics as the above mentioned path request events.  You can use this to implement your own request multiplexing. You can use \*(C`stop_request\*(C' to stop any further processing of the request as the \*(C`request\*(C' event is the first thing that is executed for an incoming request. An example of one of many possible uses:    $httpd-&gt;reg_cb (       request =&gt; sub {          my ($httpd, $req) = @_;</p><p>         my $url = $req-&gt;url;</p><p>         if ($url-&gt;path =~ /&#92;/images&#92;/img_(&#92;d+).jpg$/) {             handle_image_request ($req, $1); # your task :)</p><p>            # stop the request from emitting further events             # so that the &apos;/images/img_001.jpg&apos; and the             # &apos;/images&apos; and &apos;&apos; events are NOT emitted:             $httpd-&gt;stop_request;          }       }    ); These events are emitted whenever a client coming from \*(C`$host:$port\*(C' connects to your server or is disconnected from it.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CACHING</h2>
        <div class="sectioncontent">
<p>Any response from the \s-1HTTP\s0 server will have \*(C`Cache-Control\*(C' set to \*(C`max-age=0\*(C' and also the \*(C`Expires\*(C' header set to the \*(C`Date\*(C' header. Meaning: Caching is disabled.</p><p>You can of course set those headers yourself in the response, or remove them by setting them to undef, but keep in mind that the default for those headers are like mentioned above.</p><p>If you need more support here you can send me a mail or even better: a patch :)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Robin Redeker, \*(C`&lt;elmex at ta-sa.org&gt;\*(C'</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Please report any bugs or feature requests to \*(C`bug-bs-httpd at rt.cpan.org\*(C', or through the web interface at http://rt.cpan.org/NoAuth/ReportBug.html?Queue=AnyEvent-HTTPD &lt;http://rt.cpan.org/NoAuth/ReportBug.html?Queue=AnyEvent-HTTPD&gt;.  I will be notified, and then you'll automatically be notified of progress on your bug as I make changes.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SUPPORT</h2>
        <div class="sectioncontent">
<p>You can find documentation for this module with the perldoc command.</p><p>    perldoc AnyEvent::HTTPD</p><p>You can also look for information at:</p><ul>
<li><p>Git repository http://git.ta-sa.org/AnyEvent-HTTPD.git &lt;http://git.ta-sa.org/AnyEvent-HTTPD.git&gt;</p></li><li><p>\s-1RT:\s0 \s-1CPAN\s0's request tracker http://rt.cpan.org/NoAuth/Bugs.html?Dist=AnyEvent-HTTPD &lt;http://rt.cpan.org/NoAuth/Bugs.html?Dist=AnyEvent-HTTPD&gt;</p></li><li><p>AnnoCPAN: Annotated \s-1CPAN\s0 documentation http://annocpan.org/dist/AnyEvent-HTTPD &lt;http://annocpan.org/dist/AnyEvent-HTTPD&gt;</p></li><li><p>\s-1CPAN\s0 Ratings http://cpanratings.perl.org/d/AnyEvent-HTTPD &lt;http://cpanratings.perl.org/d/AnyEvent-HTTPD&gt;</p></li><li><p>Search \s-1CPAN\s0 http://search.cpan.org/dist/AnyEvent-HTTPD &lt;http://search.cpan.org/dist/AnyEvent-HTTPD&gt;</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ACKNOWLEDGEMENTS</h2>
        <div class="sectioncontent">
<p>   Andrey Smirnov   - for keep-alive patches.    Pedro Melo       - for valuable input in general and patches.    Nicholas Harteau - patch for &apos;;&apos; pair separator support,                       patch for allowed_methods support    Chris Kastorff   - patch for making default headers removable                       and more fault tolerant w.r.t. case.    Mons Anderson    - Optimizing the regexes in L&lt;AnyEvent::HTTPD::HTTPConnection&gt;                       and adding the C&lt;backlog&gt; option to L&lt;AnyEvent::HTTPD&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT & LICENSE</h2>
        <div class="sectioncontent">
<p>Copyright 2008-2011 Robin Redeker, all rights reserved.</p><p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="AnyEvent::ForkObject.3pm.html"><span aria-hidden="true">&larr;</span> AnyEvent::ForkObject.3pm: Async access on objects.</a></li>
   <li class="next"><a href="AnyEvent::HTTPD::HTTPConnection.3pm.html">AnyEvent::HTTPD::HTTPConnection.3pm: A simple http connection for request and response handling <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
