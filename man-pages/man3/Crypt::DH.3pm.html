<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Crypt::DH: Diffie-hellman key exchange system</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Diffie-hellman key exchange system">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Crypt::DH (3pm) manual">
  <meta name="twitter:description" content="Diffie-hellman key exchange system">
  <meta name="twitter:image" content="https://www.carta.tech/images/libcrypt-dh-perl-Crypt::DH-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Crypt::DH.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Crypt::DH (3pm) manual" />
  <meta property="og:description" content="Diffie-hellman key exchange system" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libcrypt-dh-perl-Crypt::DH-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Crypt::DH<small> (3pm)</small></h1>
        <p class="lead">Diffie-hellman key exchange system</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Crypt::DH.3pm.html">
      <span itemprop="name">Crypt::DH: Diffie-hellman key exchange system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libcrypt-dh-perl/">
      <span itemprop="name">libcrypt-dh-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Crypt::DH.3pm.html">
      <span itemprop="name">Crypt::DH: Diffie-hellman key exchange system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
    use Crypt::DH;
    my $dh = Crypt::DH-&gt;new;
    $dh-&gt;g($g);
    $dh-&gt;p($p);

    ## Generate public and private keys.
    $dh-&gt;generate_keys;

    $my_pub_key = $dh-&gt;pub_key;

    ## Send $my_pub_key to "other" party, and receive "other"
    ## public key in return.

    ## Now compute shared secret from "other" public key.
    my $shared_secret = $dh-&gt;compute_secret( $other_pub_key );
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><em>Crypt::DH</em> is a Perl implementation of the Diffie-Hellman key exchange system. Diffie-Hellman is an algorithm by which two parties can agree on a shared secret key, known only to them. The secret is negotiated over an insecure network without the two parties ever passing the actual shared secret, or their private keys, between them.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THE ALGORITHM</h2>
        <div class="sectioncontent">
<p>The algorithm generally works as follows: Party A and Party B choose a property <em>p</em> and a property <em>g</em>; these properties are shared by both parties. Each party then computes a random private key integer <em>priv_key</em>, where the length of <em>priv_key</em> is at most (number of bits in <em>p</em>) - 1. Each party then computes a public key based on <em>g</em>, <em>priv_key</em>, and <em>p</em>; the exact value is</p><p>    g ^ priv_key mod p</p><p>The parties exchange these public keys.</p><p>The shared secret key is generated based on the exchanged public key, the private key, and <em>p</em>. If the public key of Party B is denoted <em>pub_key_B</em>, then the shared secret is equal to</p><p>    pub_key_B ^ priv_key mod p</p><p>The mathematical principles involved insure that both parties will generate the same shared secret key.</p><p>More information can be found in \s-1PKCS\s0 #3 (Diffie-Hellman Key Agreement Standard):</p><p>    http://www.rsasecurity.com/rsalabs/pkcs/pkcs-3/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE</h2>
        <div class="sectioncontent">
<p><em>Crypt::DH</em> implements the core routines needed to use Diffie-Hellman key exchange. To actually use the algorithm, you'll need to start with values for <em>p</em> and <em>g</em>; <em>p</em> is a large prime, and <em>g</em> is a base which must be larger than 0 and less than <em>p</em>.</p><p><em>Crypt::DH</em> uses <em>Math::BigInt</em> internally for big-integer calculations. All accessor methods (<em>p</em>, <em>g</em>, <em>priv_key</em>, and <em>pub_key</em>) thus return <em>Math::BigInt</em> objects, as does the <em>compute_secret</em> method.  The accessors, however, allow setting with a scalar decimal string, hex string (^0x), Math::BigInt object, or Math::Pari object (for backwards compatibility). Constructs a new <em>Crypt::DH</em> object and returns the object. <em></em><strong>%param</strong><em></em> may include none, some, or all of the keys <em>p</em>, <em>g</em>, and <em>priv_key</em>. Given an argument <em></em><strong>$p</strong><em></em>, sets the <em>p</em> parameter (large prime) for this <em>Crypt::DH</em> object.</p><p>Returns the current value of <em>p</em>.  (as a Math::BigInt object) Given an argument <em></em><strong>$g</strong><em></em>, sets the <em>g</em> parameter (base) for this <em>Crypt::DH</em> object.</p><p>Returns the current value of <em>g</em>. Generates the public and private key portions of the <em>Crypt::DH</em> object, assuming that you've already filled <em>p</em> and <em>g</em> with appropriate values.</p><p>If you've provided a priv_key, it's used, otherwise a random priv_key is created using either Crypt::Random (if already loaded), or /dev/urandom, or Perl's rand, in that order. Given the public key <em></em><strong>$public_key</strong><em></em> of Party B (the party with which you're performing key negotiation and exchange), computes the shared secret key, based on that public key, your own private key, and your own large prime value (<em>p</em>).</p><p>The historical method name \*(L"compute_key\*(R" is aliased to this for compatibility. Returns the private key.  Given an argument <em></em><strong>$priv_key</strong><em></em>, sets the <em>priv_key</em> parameter for this <em>Crypt::DH</em> object. Returns the public key.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Benjamin Trott (cpan:BTROTT) &lt;ben+cpan@stupidfool.org&gt;</p><p>Brad Fitzpatrick (cpan:BRADFITZ) &lt;brad@danga.com&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONTRIBUTORS</h2>
        <div class="sectioncontent">
<p>BinGOs - Chris Williams (cpan:BINGOS) &lt;chris@bingosnet.co.uk&gt;</p><p>Mithaldu - Christian Walde (cpan:MITHALDU) &lt;walde.christian@googlemail.com&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (c) 2012 the Crypt::DH \*(L"\s-1AUTHOR\s0\*(R" and \*(L"\s-1CONTRIBUTORS\s0\*(R" as listed above.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE</h2>
        <div class="sectioncontent">
<p>This library is free software and may be distributed under the same terms as perl itself.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Crypt::DES_EDE3.3pm.html"><span aria-hidden="true">&larr;</span> Crypt::DES_EDE3.3pm: Triple-des ede encryption/decryption</a></li>
   <li class="next"><a href="Crypt::DSA.3pm.html">Crypt::DSA.3pm: Dsa signatures and key generation <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
