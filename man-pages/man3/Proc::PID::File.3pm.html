<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Proc::PID::File: A module to manage process id files</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A module to manage process id files">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="Proc::PID::File (3pm) manual">
  <meta name="twitter:description" content="A module to manage process id files">
  <meta name="twitter:image" content="https://www.carta.tech/images/libproc-pid-file-perl-Proc::PID::File-3pm.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man3pm/Proc::PID::File.3pm.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Proc::PID::File (3pm) manual" />
  <meta property="og:description" content="A module to manage process id files" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libproc-pid-file-perl-Proc::PID::File-3pm.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">Proc::PID::File<small> (3pm)</small></h1>
        <p class="lead">A module to manage process id files</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Proc::PID::File.3pm.html">
      <span itemprop="name">Proc::PID::File: A module to manage process id files</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libproc-pid-file-perl/">
      <span itemprop="name">libproc-pid-file-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man3pm/Proc::PID::File.3pm.html">
      <span itemprop="name">Proc::PID::File: A module to manage process id files</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  use Proc::PID::File;
  die "Already running!" if Proc::PID::File-&gt;running();
</pre>
<p>Process that spawn child processes may want to protect each separately by using multiple <em>pidfiles</em>.</p><p>  my $child1 = Proc::PID::File-&gt;new(name =&gt; "lock.1");   my $child2 = Proc::PID::File-&gt;new(name =&gt; "lock.2");</p><p>which may be checked like this:</p><p>  &lt;do-something&gt; if $child1-&gt;alive();</p><p>and should be released manually:</p><p>  $child1-&gt;release();</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This Perl module is useful for writers of daemons and other processes that need to tell whether they are already running, in order to prevent multiple process instances.  The module accomplishes this via *nix-style <em>pidfiles</em>, which are files that store a process identifier.</p><p>The module provides two interfaces: 1) a simple call, and 2) an object-oriented interface</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Simple Interface</h2>
        <div class="sectioncontent">
<p>The simple interface consists of a call as indicated in the first example of the <strong>Synopsis</strong> section above.  This approach avoids causing race conditions whereby one instance of a daemon could read the <em>pidfile</em> after a previous instance has read it but before it has had a chance to write to it.</p><h3>running [hash[-ref]]</h3>
<p>The parameter signature for this function is identical to that of the <em>-&gt;</em><em>new()</em><em></em> method described below in the <strong>\s-1OO\s0 Interface</strong> section of this document. The method's return value is the same as that of <em>-&gt;</em><em>alive()</em><em></em>.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OO Interface</h2>
        <div class="sectioncontent">
<p>The following methods are provided:</p><h3>new [hash[-ref]]</h3>
<p>This method is used to create an instance object.  It automatically calls the <em>-&gt;</em><em>file()</em><em></em> method described below and receives the same paramters.  For a listing of valid keys in this hash please refer to the aforementioned method documentation below.</p><p>In addition to the above, the following constitute valid keys:</p>
<dl class='dl-vertical'>
  <dt>
    <em>verify</em> = 1 | string
  </dt>
  <dd>
    <p>This parameter implements the second solution outlined in the \s-1WARNING\s0 section of this document and is used to verify that an existing <em>pidfile</em> correctly represents a live process other than the current.  If set to a string, it will be interpreted as a <em>regular expression</em> and used to search within the name of the running process.  Alternatively, a 1 may be passed: For Linux/FreeBSD, this indicates that the value of <em></em><strong>$0</strong><em></em> will be used (stripped of its full path); for Cygwin, <em>$^X</em> (stripped of path and extension) will be used. If the parameter is not passed, no verification will take place.  Please note that verification will only work for the operating systems listed below and that the \s-1OS\s0 will be auto-sensed.  See also \s-1DEPENDENCIES\s0 section below. Supported platforms: Linux, FreeBSD, Cygwin</p>
  </dd>
  <dt>
    <em>debug</em>
  </dt>
  <dd>
    <p>Any non-zero value turns debugging output on.  Additionally, if a string is passed containing the character <strong>M</strong>, the module name will be prefixed to the debugging output.</p>
  </dd>

</dl>

<h3>file [hash[-ref]]</h3>
<p>Use this method to set the path of the <em>pidfile</em>.  The method receives an optional hash (or hash reference) with the keys listed below, from which it makes a path of the format: <em></em><strong>$dir</strong><em>/$name.pid</em>.</p>
<dl class='dl-vertical'>
  <dt>
    <em>dir</em>
  </dt>
  <dd>
    <p>Specifies the directory to place the pid file.  If left unspecified, defaults to <em>/var/run</em>.</p>
  </dd>
  <dt>
    <em>name</em>
  </dt>
  <dd>
    <p>Indicates the name of the current process.  When not specified, defaults to <em>basename($0)</em>.</p>
  </dd>

</dl>

<h3>alive</h3>
<p>Returns true when the process is already running.  Please note that this call must be made *after* daemonisation i.e. subsequent to the call to <em>fork()</em>. If the <strong>verify</strong> flag was set during the instance creation, the process id is verified, alternatively the flag may be passed directly to this method.</p>
<h3>touch</h3>
<p>Causes for the current process id to be written to the <em>pidfile</em>.</p>
<h3>release</h3>
<p>This method is used to delete the <em>pidfile</em> and is automatically called by \s-1DESTROY\s0 method.  It should thus be unnecessary to call it directly.</p>
<h3>locktime [hash[-ref]]</h3>
<p>This method returns the <em>mtime</em> of the <em>pidfile</em>.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Erick Calder &lt;ecalder@cpan.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ACKNOWLEDGEMENTS</h2>
        <div class="sectioncontent">
<p>1k thx to Steven Haryanto &lt;steven@haryan.to&gt; whose package (Proc::RID_File) inspired this implementation.</p><p>Our gratitude also to Alan Ferrency &lt;alan@pair.com&gt; for fingering the boot-up problem and suggesting possible solutions.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DEPENDENCIES</h2>
        <div class="sectioncontent">
<p>For Linux, FreeBSD and Cygwin, support of the <em>verify</em> option requires availability of the <strong>ps</strong> utility.  For Linux/FreeBSD This is typically found in the <strong>procps</strong> package. Cygwin users need to run version 1.5.20 or later for this to work.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">WARNING</h2>
        <div class="sectioncontent">
<p>This module may prevent daemons from starting at system boot time.  The problem occurs because the process id written to the <em>pidfile</em> by an instance of the daemon may coincidentally be reused by another process after a system restart, thus making the daemon think it's already running.</p><p>Some ideas on how to fix this problem are catalogued below, but unfortunately, no platform-independent solutions have yet been gleaned.</p>
<dl class='dl-vertical'>
  <dt>
    - leaving the <em>pidfile</em> open for the duration of the daemon's life
  </dt>
  <dd>
    
  </dd>
  <dt>
    - looking at /proc/$PID/stat for a process name
  </dt>
  <dd>
    
  </dd>
  <dt>
    - check mtime of the pidfile versus uptime; don't trust old pidfiles
  </dt>
  <dd>
    
  </dd>
  <dt>
    - try to get the script to nuke its pidfile when it exits (this is vulnerable to hardware resets and hard reboots)
  </dt>
  <dd>
    
  </dd>
  <dt>
    - try to nuke the pidfile at boot time before the script runs; this solution suffers from a race condition wherein two instances read the <em>pidfile</em> before one manages to lock it, thus allowing two instances to run simultaneously.
  </dt>
  <dd>
    
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SUPPORT</h2>
        <div class="sectioncontent">
<p>For help and thank you notes, e-mail the author directly.  To report a bug, submit a patch or add to our wishlist please visit the \s-1CPAN\s0 bug manager at: <em>http://rt.cpan.org</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AVAILABILITY</h2>
        <div class="sectioncontent">
<p>The latest version of the tarball, \s-1RPM\s0 and \s-1SRPM\s0 may always be found at: <em>http://perl.arix.com/</em>  Additionally the module is available from \s-1CPAN\s0.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENCE</h2>
        <div class="sectioncontent">
<p>This utility is free and distributed under \s-1GPL\s0, the Gnu Public License.  A copy of this license was included in a file called \s-1LICENSE\s0. If for some reason, this file was not included, please see <em>http://www.gnu.org/licenses/</em> to obtain a copy of this license.</p><p>$Id: File.pm,v 1.16 2004-04-08 02:27:25 ekkis Exp $</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="Proc::Background::Win32.3pm.html"><span aria-hidden="true">&larr;</span> Proc::Background::Win32.3pm: Interface to process mangement on win32 systems</a></li>
   <li class="next"><a href="Proc::Reliable.3pm.html">Proc::Reliable.3pm: Run external processes reliably with many options. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
