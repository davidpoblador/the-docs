<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pthread_attr_init, pthread_attr_destroy - initialize and destroy thread attributes object</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="${metadescription}">
  
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pthread_attr_destroy<small> (3)</small></h1>
        <p class="lead">initialize and destroy thread attributes object</p>
      </div>

    <ol class="breadcrumb">
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="https://www.carta.tech/man-pages/"><span itemprop="title">Linux Man Pages</span></a>
	</li>
	<li id="breadcrumb_section" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_page" itemprop="child">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man3/"><span itemprop="title">Library calls</span></a>
	</li>
	<li id="breadcrumb_page" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="active">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man3/pthread_attr_destroy.3.html"><span itemprop="title">pthread_attr_destroy</span></a>
	</li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre><strong>#include &lt;pthread.h&gt;</strong>

<strong>int pthread_attr_init(pthread_attr_t *</strong><em>attr</em><strong>);</strong>
<strong>int pthread_attr_destroy(pthread_attr_t *</strong><em>attr</em><strong>);</strong>

Compile and link with <em>-pthread</em>.</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p>The <strong>pthread_attr_init</strong>() function initializes the thread attributes object pointed to by <em>attr</em> with default attribute values. After this call, individual attributes of the object can be set using various related functions (listed under SEE ALSO), and then the object can be used in one or more <a href="../man3/pthread_create.3.html"><strong>pthread_create</strong>(3)</a> calls that create threads.</p>
<p class='spacer'>

<p>Calling <strong>pthread_attr_init</strong>() on a thread attributes object that has already been initialized results in undefined behavior.</p>
<p class='spacer'>

<p>When a thread attributes object is no longer required, it should be destroyed using the <strong>pthread_attr_destroy</strong>() function. Destroying a thread attributes object has no effect on threads that were created using that object.</p>
<p class='spacer'>

<p>Once a thread attributes object has been destroyed, it can be reinitialized using <strong>pthread_attr_init</strong>(). Any other use of a destroyed thread attributes object has undefined results.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">

<p>On success, these functions return 0; on error, they return a nonzero error number.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">

<p>POSIX.1 documents an <strong>ENOMEM</strong> error for <strong>pthread_attr_init</strong>(); on Linux these functions always succeed (but portable and future-proof applications should nevertheless handle a possible error return).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ATTRIBUTES</h2>
        <div class="sectioncontent">

<p>For an explanation of the terms used in this section, see <a href="../man7/attributes.7.html"><strong>attributes</strong>(7)</a>.</p>
<table class="table table-striped">
<tr>
<th>Interface</th>
<th>Attribute</th>
<th>Value</th></tr>

<tr>
<td><strong>pthread_attr_init</strong>(),   <strong>pthread_attr_destroy</strong>()  </td>
<td>Thread safety</td>
<td>MT-Safe</td></tr>
</table>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFORMING TO</h2>
        <div class="sectioncontent">

<p>POSIX.1-2001, POSIX.1-2008.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<p>The <em>pthread_attr_t</em> type should be treated as opaque: any access to the object other than via pthreads functions is nonportable and produces undefined results.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<p>The program below optionally makes use of <strong>pthread_attr_init</strong>() and various related functions to initialize a thread attributes object that is used to create a single thread. Once created, the thread uses the <a href="../man3/pthread_getattr_np.3.html"><strong>pthread_getattr_np</strong>(3)</a> function (a nonstandard GNU extension) to retrieve the thread's attributes, and then displays those attributes.</p>
<p class='spacer'>

<p>If the program is run with no command-line argument, then it passes NULL as the <em>attr</em> argument of <a href="../man3/pthread_create.3.html"><strong>pthread_create</strong>(3)</a>, so that the thread is created with default attributes. Running the program on Linux/x86-32 with the NPTL threading implementation, we see the following:</p>
<p class='spacer'>

<pre>$<strong> ulimit -s</strong>       # No stack limit ==&gt; default stack size is 2MB
unlimited
$<strong> ./a.out</strong>
Thread attributes:
        Detach state        = PTHREAD_CREATE_JOINABLE
        Scope               = PTHREAD_SCOPE_SYSTEM
        Inherit scheduler   = PTHREAD_INHERIT_SCHED
        Scheduling policy   = SCHED_OTHER
        Scheduling priority = 0
        Guard size          = 4096 bytes
        Stack address       = 0x40196000
        Stack size          = 0x201000 bytes</pre>

<p class='spacer'>

<p>When we supply a stack size as a command-line argument, the program initializes a thread attributes object, sets various attributes in that object, and passes a pointer to the object in the call to <a href="../man3/pthread_create.3.html"><strong>pthread_create</strong>(3)</a>. Running the program on Linux/x86-32 with the NPTL threading implementation, we see the following:</p>
<p class='spacer'>

<pre>$<strong> ./a.out 0x3000000</strong>
posix_memalign() allocated at 0x40197000
Thread attributes:
        Detach state        = PTHREAD_CREATE_DETACHED
        Scope               = PTHREAD_SCOPE_SYSTEM
        Inherit scheduler   = PTHREAD_EXPLICIT_SCHED
        Scheduling policy   = SCHED_OTHER
        Scheduling priority = 0
        Guard size          = 0 bytes
        Stack address       = 0x40197000
        Stack size          = 0x3000000 bytes</pre>

  <h3>Program source</h3>
  <p> </p>
<pre>#define _GNU_SOURCE     /* To get pthread_getattr_np() declaration */
#include &lt;pthread.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;errno.h&gt;

#define handle_error_en(en, msg) &#92;
        do { errno = en; perror(msg); exit(EXIT_FAILURE); } while (0)

static void
display_pthread_attr(pthread_attr_t *attr, char *prefix)
{
    int s, i;
    size_t v;
    void *stkaddr;
    struct sched_param sp;

    s = pthread_attr_getdetachstate(attr, &i);
    if (s != 0)
        handle_error_en(s, "pthread_attr_getdetachstate");
    printf("%sDetach state        = %s&#92;n", prefix,
            (i == PTHREAD_CREATE_DETACHED) ? "PTHREAD_CREATE_DETACHED" :
            (i == PTHREAD_CREATE_JOINABLE) ? "PTHREAD_CREATE_JOINABLE" :
            "???");

    s = pthread_attr_getscope(attr, &i);
    if (s != 0)
        handle_error_en(s, "pthread_attr_getscope");
    printf("%sScope               = %s&#92;n", prefix,
            (i == PTHREAD_SCOPE_SYSTEM)  ? "PTHREAD_SCOPE_SYSTEM" :
            (i == PTHREAD_SCOPE_PROCESS) ? "PTHREAD_SCOPE_PROCESS" :
            "???");

    s = pthread_attr_getinheritsched(attr, &i);
    if (s != 0)
        handle_error_en(s, "pthread_attr_getinheritsched");
    printf("%sInherit scheduler   = %s&#92;n", prefix,
            (i == PTHREAD_INHERIT_SCHED)  ? "PTHREAD_INHERIT_SCHED" :
            (i == PTHREAD_EXPLICIT_SCHED) ? "PTHREAD_EXPLICIT_SCHED" :
            "???");

    s = pthread_attr_getschedpolicy(attr, &i);
    if (s != 0)
        handle_error_en(s, "pthread_attr_getschedpolicy");
    printf("%sScheduling policy   = %s&#92;n", prefix,
            (i == SCHED_OTHER) ? "SCHED_OTHER" :
            (i == SCHED_FIFO)  ? "SCHED_FIFO" :
            (i == SCHED_RR)    ? "SCHED_RR" :
            "???");

    s = pthread_attr_getschedparam(attr, &sp);
    if (s != 0)
        handle_error_en(s, "pthread_attr_getschedparam");
    printf("%sScheduling priority = %d&#92;n", prefix, sp.sched_priority);

    s = pthread_attr_getguardsize(attr, &v);
    if (s != 0)
        handle_error_en(s, "pthread_attr_getguardsize");
    printf("%sGuard size          = %d bytes&#92;n", prefix, v);

    s = pthread_attr_getstack(attr, &stkaddr, &v);
    if (s != 0)
        handle_error_en(s, "pthread_attr_getstack");
    printf("%sStack address       = %p&#92;n", prefix, stkaddr);
    printf("%sStack size          = 0x%zx bytes&#92;n", prefix, v);
}

static void *
thread_start(void *arg)
{
    int s;
    pthread_attr_t gattr;

    /* pthread_getattr_np() is a non-standard GNU extension that
       retrieves the attributes of the thread specified in its
       first argument */

    s = pthread_getattr_np(pthread_self(), &gattr);
    if (s != 0)
        handle_error_en(s, "pthread_getattr_np");

    printf("Thread attributes:&#92;n");
    display_pthread_attr(&gattr, "&#92;t");

    exit(EXIT_SUCCESS);         /* Terminate all threads */
}

int
main(int argc, char *argv[])
{
    pthread_t thr;
    pthread_attr_t attr;
    pthread_attr_t *attrp;      /* NULL or &attr */
    int s;

    attrp = NULL;

    /* If a command-line argument was supplied, use it to set the
       stack-size attribute and set a few other thread attributes,
       and set attrp pointing to thread attributes object */

    if (argc &gt; 1) {
        int stack_size;
        void *sp;

        attrp = &attr;

        s = pthread_attr_init(&attr);
        if (s != 0)
            handle_error_en(s, "pthread_attr_init");

        s = pthread_attr_setdetachstate(&attr, PTHREAD_CREATE_DETACHED);
        if (s != 0)
            handle_error_en(s, "pthread_attr_setdetachstate");

        s = pthread_attr_setinheritsched(&attr, PTHREAD_EXPLICIT_SCHED);
        if (s != 0)
            handle_error_en(s, "pthread_attr_setinheritsched");

        stack_size = strtoul(argv[1], NULL, 0);

        s = posix_memalign(&sp, sysconf(_SC_PAGESIZE), stack_size);
        if (s != 0)
            handle_error_en(s, "posix_memalign");

        printf("posix_memalign() allocated at %p&#92;n", sp);

        s = pthread_attr_setstack(&attr, sp, stack_size);
        if (s != 0)
            handle_error_en(s, "pthread_attr_setstack");
    }

    s = pthread_create(&thr, attrp, &thread_start, NULL);
    if (s != 0)
        handle_error_en(s, "pthread_create");

    if (attrp != NULL) {
        s = pthread_attr_destroy(attrp);
        if (s != 0)
            handle_error_en(s, "pthread_attr_destroy");
    }

    pause();    /* Terminates when other thread calls exit() */
}</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<p><a href="../man3/pthread_attr_setaffinity_np.3.html"><strong>pthread_attr_setaffinity_np</strong>(3)</a>, <a href="../man3/pthread_attr_setdetachstate.3.html"><strong>pthread_attr_setdetachstate</strong>(3)</a>, <a href="../man3/pthread_attr_setguardsize.3.html"><strong>pthread_attr_setguardsize</strong>(3)</a>, <a href="../man3/pthread_attr_setinheritsched.3.html"><strong>pthread_attr_setinheritsched</strong>(3)</a>, <a href="../man3/pthread_attr_setschedparam.3.html"><strong>pthread_attr_setschedparam</strong>(3)</a>, <a href="../man3/pthread_attr_setschedpolicy.3.html"><strong>pthread_attr_setschedpolicy</strong>(3)</a>, <a href="../man3/pthread_attr_setscope.3.html"><strong>pthread_attr_setscope</strong>(3)</a>, <a href="../man3/pthread_attr_setstack.3.html"><strong>pthread_attr_setstack</strong>(3)</a>, <a href="../man3/pthread_attr_setstackaddr.3.html"><strong>pthread_attr_setstackaddr</strong>(3)</a>, <a href="../man3/pthread_attr_setstacksize.3.html"><strong>pthread_attr_setstacksize</strong>(3)</a>, <a href="../man3/pthread_create.3.html"><strong>pthread_create</strong>(3)</a>, <a href="../man3/pthread_getattr_np.3.html"><strong>pthread_getattr_np</strong>(3)</a>, <a href="../man7/pthreads.7.html"><strong>pthreads</strong>(7)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
  <li class="previous"><a href="psignal.3.html"><span aria-hidden="true">&larr;</span> psignal.3: print signal message</a></li><li class="next"><a href="pthread_attr_getaffinity_np.3.html">pthread_attr_getaffinity_np.3: set/get CPU affinity attribute in thread attributes object <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>
  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
