<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>dacsauth: Authentication check</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Authentication check">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="dacsauth (1) manual">
  <meta name="twitter:description" content="Authentication check">
  <meta name="twitter:image" content="https://www.carta.tech/images/dacs-dacsauth-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/dacsauth.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="dacsauth (1) manual" />
  <meta property="og:description" content="Authentication check" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/dacs-dacsauth-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">dacsauth<small> (1)</small></h1>
        <p class="lead">Authentication check</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/dacsauth.1.html">
      <span itemprop="name">dacsauth: Authentication check</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/dacs/">
      <span itemprop="name">dacs</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/dacsauth.1.html">
      <span itemprop="name">dacsauth: Authentication check</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>dacsauth</strong> [<strong>-m&nbsp;</strong><strong></strong><em>auth-module-spec</em>] [...] [<strong>-r&nbsp;</strong><strong></strong><em>roles-module-spec</em>] [...] [<strong>-D</strong><strong></strong><em>directive</em><strong>=</strong><strong></strong><em>value</em>] [<strong>-aux</strong>]</p><p>[<strong>-fj&nbsp;</strong><strong></strong><em>jurname</em>] [<strong>-fn&nbsp;</strong><strong></strong><em>fedname</em>] [<strong>-h</strong> | <strong>-help</strong>] [<strong>-id</strong>] [<strong>-ll&nbsp;</strong><strong></strong><em>log_level</em>] [<strong>-p&nbsp;</strong><strong></strong><em>password</em>]</p><p>[<strong>-pf&nbsp;</strong><strong></strong><em>file</em>] [<strong>-prompt</strong>] [<strong>-q</strong>] [{<strong>-u</strong>&nbsp;|&nbsp;<strong>-user</strong>}&nbsp;<em>username</em>] [<strong>-v</strong>]</p><p><strong>dacsauth</strong><strong>-modules</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This program is part of the <strong>DACS</strong> suite.</p><p>The <strong>dacsauth</strong> utility tests whether given authentication material satisfies authentication requirements and indicates the outcome through the process&apos;s exit status. It is similar to \m[blue]<a href="../man8/dacs_authenticate.8.html"><strong>dacs_authenticate</strong>(8)</a></strong>\m[]\s-2\u[1]\d\s+2 and \m[blue]<a href="../man1/dacscred.1.html"><strong>dacscred</strong>(1)</a></strong>\m[]\s-2\u[2]\d\s+2.</p><p><strong>dacsauth</strong> provides a way for scripts and other programs to leverage the <strong>DACS</strong> authentication infrastructure. They might use successful authentication as a coarse form of authorization; only a user that provides a correct password might be allowed to run the program, for instance. Or they might return some type of credentials after successful authentication, or perhaps use \m[blue]<a href="../man8/dacs_auth_agent.8.html"><strong>dacs_auth_agent</strong>(8)</a></strong>\m[]\s-2\u[3]\d\s+2 to return <strong>DACS</strong> credentials.</p><p><strong>dacsauth</strong> can also be used to retrieve role information associated with a given user.</p><p><strong>dacsauth</strong> does not read any <strong>DACS</strong> configuration files. Everything needed to perform the test must be specified as an argument.</p><p><strong>Tip</strong></p><p>If <strong>dacsauth</strong> uses a built-in module to perform authentication, or look up roles, <em>no server component is required</em>. This means that you can use <strong>dacsauth</strong> without having to access or even configure a web server, including Apache.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>The following command line flags are recognized. At least one <strong>-m</strong> flag (to perform authentication testing), or at least one <strong>-r</strong> flag must be specified (to form a role descriptor string for the identity and print it to stdout). A combination of both flags is allowed, in which case a role descriptor string is output only if the authentication test is successful.</p><p><strong>-D</strong><strong></strong><em>directive</em><strong>=</strong><strong></strong><em>value</em></p><p>This is equivalent to setting <em>directive</em>, a general <strong>DACS</strong> configuration directive, to <em>value</em>. See \m[blue]<strong>dacs.conf</strong>(5)</strong>\m[]\s-2\u[4]\d\s+2.</p><p><strong>-aux</strong></p><p>The next string provided by the <strong>-p</strong>, <strong>-pf</strong>, or <strong>-prompt</strong> flag will be the value of the <em>AUXILIARY</em> authentication argument. This provides a secure way to pass sensitive auxiliary information, such as a PIN, to the program. A flag to obtain the password, if any, must precede this flag on the command line.</p><p><strong>-fj</strong> <em>jurname</em></p><p>Use <em>jurname</em>, which must be syntactically valid, as the jurisdiction name. If required but not provided, a value derived from the host&apos;s domain name will be used.</p><p><strong>-fn</strong> <em>fedname</em></p><p>Use <em>fedname</em>, which must be syntactically valid, as the federation name. If required but not provided, a value derived from the host&apos;s domain name will be used.</p><p><strong>-h</strong></p><p><strong>-help</strong></p><p>Display a help message and exit.</p><p><strong>-id</strong></p><p>If successful, print the authenticated <strong>DACS</strong> identity to the standard output.</p><p><strong>-ll</strong> <em>log_level</em></p><p>Set the debugging output level to <em>log_level</em> (see \m[blue]<a href="../man1/dacs.1.html"><strong>dacs</strong>(1)</a></strong>\m[]\s-2\u[5]\d\s+2). The default level is warn.</p><p><strong>-m</strong> <em>auth-module-spec</em></p><p>Each type of authentication test that is required is described by an <em>auth-module-spec</em> that immediately follows the <strong>-m</strong> flag. Each <em>auth-module-spec</em> is essentially an alternate representation of an \m[blue]<strong>Auth clause</strong>\m[]\s-2\u[6]\d\s+2 and its directives, which are used by \m[blue]<a href="../man8/dacs_authenticate.8.html"><strong>dacs_authenticate</strong>(8)</a></strong>\m[]\s-2\u[1]\d\s+2. Just as the order in which Auth clauses appear in a <strong>DACS</strong> configuration file, the order in which the <strong>-m</strong> flags appear may be significant, depending on the <em>control</em> keywords. During processing, successive <strong>-m</strong> components are automatically assigned names, auth_module_1, auth_module_2, and so on, mainly for error reporting purposes.</p><p>An <em>auth-module-spec</em> has the following syntax:</p><p>The <em>module</em> begins with either the name of a built-in module, or a valid abbreviation thereof, or the (absolute) URL of an external authentication module (equivalent to the \m[blue]<strong>URL</strong>\m[]\s-2\u[7]\d\s+2 directive). Next must appear a recognized authentication style keyword specifier (equivalent to the \m[blue]<strong>STYLE</strong>\m[]\s-2\u[8]\d\s+2 directive). Next, the <em>control</em> keyword follows, which is identical to the \m[blue]<strong>CONTROL</strong>\m[]\s-2\u[9]\d\s+2 directive in the Auth clause. After the <em>control</em> keyword, the flags described below may follow, in any order.</p><p>An <em>auth-module-spec</em> ends when the first invalid flag (or the end of flags) is encountered.</p><p>The <strong>-O</strong> flag is equivalent to an \m[blue]<strong>OPTION</strong>\m[]\s-2\u[10]\d\s+2 directive.</p><p>The <strong>-Of</strong> flag is followed by an argument that is the name of a file from which to read options, one per line, in the format <em>name</em>=<em>value</em>. Blank lines and lines beginning with a &apos;#&apos; are ignored; note that these lines do not begin with "-O" and quotes are simply copied and not interpreted. The <strong>-Of</strong> flag can be used to avoid putting passwords on the command line and makes it easier to write expressions that would otherwise have to be carefully escaped to prevent interpretation by the shell, for example.</p><p>The <strong>-expr</strong> flag is equivalent to the \m[blue]<strong>EXPR</strong>\m[]\s-2\u[11]\d\s+2 directive. The <strong>-vfs</strong> flag is used to configure \m[blue]<strong>VFS</strong>\m[]\s-2\u[12]\d\s+2 directives required by this module.</p><p><strong>-modules</strong></p><p>Display a list of built-in authentication modules and roles modules, one per line, and then exit. The canonical module name is printed, followed by zero or more equivalent abbreviations. For authentication modules, the authentication style is shown. To list the available modules, run the command:</p>
<pre>
% dacsauth -modules
</pre>
<p>The set of available (enabled) built-in authentication and roles modules is determined when <strong>DACS</strong> is built.</p><p><strong>-p </strong><strong></strong><em>password</em></p><p>Specify the password to use (equivalent to the <em>PASSWORD</em> argument to <strong>dacs_authenticate</strong>).</p><p><strong>Security</strong></p><p>A password given on the command line may be visible to other users on the same system.</p><p><strong>-pf </strong><strong></strong><em>file</em></p><p>Read the password to use from <em>file</em> (equivalent to the <em>PASSWORD</em> argument to <strong>dacs_authenticate</strong>). If <em>file</em> is "-", then the password is read from the standard input without prompting.</p><p><strong>-prompt</strong></p><p>Prompt for the password and read it from stdin (equivalent to the <em>PASSWORD</em> argument to <strong>dacs_authenticate</strong>). The password is not echoed.</p><p><strong>-q</strong></p><p>Be more quiet by reducing the debugging output level.</p><p><strong>-r</strong> <em>role-module-spec</em></p><p>Roles for <em>username</em> can be determined by giving this flag, which is immediately followed by a <em>roles-module-spec</em>. The <strong>-r</strong> flag may be repeated, and the resulting roles are combined. Each <em>roles-module-spec</em> is essentially an alternate representation of a Roles clause that is used by \m[blue]<a href="../man8/dacs_authenticate.8.html"><strong>dacs_authenticate</strong>(8)</a></strong>\m[]\s-2\u[13]\d\s+2. Successive <strong>-r</strong> components are assigned names, roles_module_1, roles_module_2, and so on, mainly for error reporting purposes.</p><p>A <em>roles-module-spec</em> has the following syntax: The <em>module</em> component is equivalent to the Roles clause&apos;s \m[blue]<strong>URL</strong>\m[]\s-2\u[14]\d\s+2 directive and is either the name of an available built-in roles module, a valid abbreviation thereof, or the (absolute) URL of an external roles module.</p><p>Flags may follow the <em>module</em> component, in any order. A <em>roles-module-spec</em> ends when the first invalid flag (or the end of flags) is encountered.</p><p>The <strong>-O</strong> flag is equivalent to an \m[blue]<strong>OPTION</strong>\m[]\s-2\u[10]\d\s+2 directive.</p><p>The <strong>-Of</strong> flag is followed by an argument that is the name of a file from which to read options, one per line, in the format <em>name</em>=<em>value</em>. Blank lines and lines beginning with a &apos;#&apos; are ignored; note that these lines do not begin with "-O" and quotes are simply copied and not interpreted. The <strong>-Of</strong> flag can be used to avoid putting passwords on the command line and makes it easier to write expressions that would otherwise have to be carefully escaped to prevent interpretation by the shell, for example.</p><p>The <strong>-expr</strong> flag is equivalent to the \m[blue]<strong>EXPR</strong>\m[]\s-2\u[11]\d\s+2 directive. The <strong>-vfs</strong> flag is used to configure \m[blue]<strong>VFS</strong>\m[]\s-2\u[12]\d\s+2 directives required by <em>module</em>.</p><p><strong>-u </strong><strong></strong><em>username</em></p><p><strong>-user </strong><strong></strong><em>username</em></p><p>The username to authenticate against (equivalent to the <em>USERNAME</em> argument to <strong>dacs_authenticate</strong>). This username is implicitly associated with the effective federation and jurisdiction (see the \m[blue]<strong>-fn</strong>\m[]\s-2\u[15]\d\s+2 and \m[blue]<strong>-fj</strong>\m[]\s-2\u[16]\d\s+2 flags).</p><p><strong>-v</strong></p><p>The <strong>-v</strong> flag bumps the debugging output level to debug or (if repeated) trace.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p><strong>Security</strong></p><p>If <strong>dacsauth</strong> uses a built-in module to perform authentication, it must run setuid or setgid to obtain sufficient privileges to access the required password file (the same is true for built-in roles modules). If it uses an external module, that module will need to execute with sufficient privileges to access <strong>DACS</strong> cryptographic keys, specifically federation_keys and possibly <strong>DACS</strong> or system password files; the external module will then need to execute with sufficient privileges to access any files it requires.</p><p>Be sure to use the federation_keys that are correct for your federation. Referencing authentication modules in two or more federations will probably not work.</p><p><strong>dacsauth</strong> should therefore not ordinarily run as the UID of the user that invokes it (unless that happens to be root) because it will not be able to access the information it requires. This will also prevent a user from "cheating" (e.g., by attaching to the running module with a debugger).</p><p>This example authenticates user "bobo" with password "test" against the <strong>DACS</strong> password file /usr/local/dacs/conf/passwd:</p>
<pre>
% dacsauth -m passwd passwd required
  -vfs "[passwds]dacs-kwv-fs:/usr/local/dacs/conf/passwd" -q -u bobo -p test
</pre>
<p>If the command&apos;s exit status is zero, the authentication test succeeded, otherwise it failed.</p><p>The following example attempts to authenticate "bobo" against her Unix password file. The program prompts for the password.</p>
<pre>
% dacsauth -m unix passwd required -u bobo -prompt
</pre>
<p>In the next example, <strong>dacsauth</strong> attempts to authenticate "bobo" via NTLM on winders.example.com:</p>
<pre>
% dacsauth -m ntlm passwd suff -OSAMBA_SERVER="winders.example.com" -prompt -u bobo
</pre>
<p>This example is similar to the previous one, except that an external authentication module is used and the password is read from a file. Because of the external module, additional configuration must be provided; in particular, the location of federation_keys and the federation and jurisdiction names must be specified.</p>
<pre>
% dacsauth -m https://example.example.com/cgi-bin/dacs/local_ntlm_authenticate &#92;
   passwd sufficient -OSAMBA_SERVER="winders.example.com" &#92;
  -fn EXAMPLE -fj FEDROOT -u bobo -pf mypass &#92;
  -DVFS="[federation_keys]dacs-fs:/usr/local/dacs/federations/example/federation_keys"
</pre>
<p>To authenticate against the \m[blue]<strong>Google</strong>\m[]\s-2\u[17]\d\s+2 account nobody@gmail.com, one might use:</p>
<pre>
% dacsauth -m http passwd suff &#92;
  -OAUTH_URL="https://www.google.com/accounts/ClientLogin" &#92;
  -OUSERNAME_PARAMETER=Email -OPASSWORD_PARAMETER=Passwd &#92;
  -Oservice=xapi -Osource=DSS-DACS-1.4 -prompt -u nobody@gmail.com
</pre>
<p>In the following example, an expression is evaluated to determine whether authentication should succeed. The user ("bobo") is prompted for a password. Only if the string "foo" is given will authentication succeed. A more realistic example might call another program to help make the determination, for instance.</p>
<pre>
% dacsauth -m expr expr suffi &#92;
 -expr &apos;${Args::PASSWORD} eq "foo" ? ${Args::USERNAME} : ""&apos; -user bobo -prompt
</pre>
<p>Authentication against an Apache <strong>htdigest</strong> password file is performed in the following example, where the password is read from stdin:</p>
<pre>
% echo "test" | dacsauth -m apache digest sufficient &#92;
  -OAUTH_MODULE=mod_auth_digest &#92;
  -OAUTH_FILE=/usr/local/apache2/conf/passwords.digest &#92;
  -OAUTH_REALM="DACS Digest Auth Area" &#92;
  -u bobo -pf -
</pre>
<p>Authentication via the PAM module works differently than the other modules - and is more complicated to use - because <strong>dacsauth</strong> may need to be run several times, depending on what information PAM requires. Instead of returning a yes/no decision, <strong>dacsauth</strong> may print prompts for more information to stdout. Please review the operational details presented in \m[blue]<a href="../man8/dacs_authenticate.8.html"><strong>dacs_authenticate</strong>(8)</a></strong>\m[]\s-2\u[18]\d\s+2 and \m[blue]<a href="../man8/pamd.8.html"><strong>pamd</strong>(8)</a></strong>\m[]\s-2\u[19]\d\s+2 before attempting to use this module.</p><p>The following example demonstrates use of the module from the command line. Once the basic ideas are understood, it should be apparent how to write a script to performed the necessary iterations. Details in the example, such as paths, may need to be adjusted for your environment. Note that in this example the username is not specified the first time <strong>dacsauth</strong> is run, although it could be if it were known.</p>
<pre>
% dacsauth -m pam prompted suffic &#92;
 -vfs "[federation_keys]dacs-fs:/usr/local/dacs/federations/dss/federation_keys" &#92;
 -OPAMD_HOST=localhost -OPAMD_PORT=dacs-pamd -fj EXAMPLE -fn TEST
AUTH_PROMPT_VAR1="Login:"
AUTH_TRANSID="10.0.0.124:57849:85748:9997c5588a6239e3"
% dacsauth -m pam prompted suffic &#92;
 -vfs "[federation_keys]dacs-fs:/usr/local/dacs/federations/dss/federation_keys" &#92;
 -OAUTH_PROMPT_VAR1="bobo" &#92;
 -OAUTH_TRANSID="10.0.0.124:57849:85748:9997c5588a6239e3"-fj EXAMPLE -fn TEST
AUTH_PROMPT_VAR2="Password:"
AUTH_TRANSID="10.0.0.124:52188:88417:5ffb0015f21ea546"
% dacsauth -m pam prompted suffic &#92;
 -vfs "[federation_keys]dacs-fs:/usr/local/dacs/federations/dss/federation_keys" &#92;
 -OAUTH_PROMPT_VAR2="apassword" &#92;
 -OAUTH_TRANSID="10.0.0.124:57849:85748:9997c5588a6239e3"-fj EXAMPLE -fn TEST
</pre>
<p>The first time <strong>dacsauth</strong> is run in the example it returns a prompt for the username ("Login:") that is associated with the transaction variable <em>AUTH_PROMPT_VAR1</em> and a transaction identifier (<em>AUTH_TRANSID</em>). The latter must be passed to the subsequent executions of <strong>dacsauth</strong>. The second run of <strong>dacsauth</strong> passes the username ("bobo") and returns another prompt ("Password:") that is associated with the transaction variable <em>AUTH_PROMPT_VAR2</em>. The third run passes the password ("apassword") but no prompt is returned, indicating that the session is complete and the program&apos;s exit status reflects the outcome of authentication.</p><p><strong>Tip</strong></p><p>Whether <strong>dacsauth</strong> requires a password to retrieve roles depends on the particular roles module being used. For example, a password is not required by \m[blue]<strong>local_unix_roles</strong>\m[]\s-2\u[20]\d\s+2 or \m[blue]<strong>local_roles</strong>\m[]\s-2\u[21]\d\s+2 to obtain roles, but \m[blue]<strong>local_ldap_roles</strong>\m[]\s-2\u[22]\d\s+2 will probably need a password to bind to the directory and obtain roles.</p><p>This example prints the role string for user "bobo" by calling the built-in \m[blue]<strong>local_unix_roles</strong>\m[]\s-2\u[20]\d\s+2 module:</p>
<pre>
% dacsauth -r unix -u bobo
bobo,wheel,www,users
</pre>
<p>The next example is similar to the previous one, except an external roles module is used:</p>
<pre>
% dacsauth -r https://example.example.com/cgi-bin/dacs/local_unix_roles &#92;
  -DVFS="[federation_keys]dacs-fs:/usr/local/dacs/federations/federation_keys" &#92;
  -fn EXAMPLE -u bobo
bobo,wheel,www,users
</pre>
<p>The external roles module might be executed on a different host than the one running <strong>dacsauth</strong>. Provided <strong>dacsauth</strong> has been installed and a matching federation_keys file is available on the local host, the local host need not be a <strong>DACS</strong> jurisdiction or have any other <strong>DACS</strong> configuration.</p><p>The following example prints the \m[blue]<strong>role string</strong>\m[]\s-2\u[23]\d\s+2 for user "bobo", known within the directory by the Common Name "Bobo Baggins", using the (external) \m[blue]<strong>local_ldap_roles</strong>\m[]\s-2\u[22]\d\s+2 module and the "direct" binding method:</p>
<pre>
% dacsauth -r https://example.example.com/cgi-bin/dacs/local_ldap_roles &#92;
    -Of /usr/local/dacs/ldap_roles_options_direct -u "Bobo Baggins" &#92;
    -DVFS="[federation_keys]dacs-fs:/usr/local/dacs/federations/federation_keys" &#92;
     -fn EXAMPLE -fj FEDROOT -prompt
DnsAdmins,Print_Operators,Domain_Admins,Administrators
</pre>
<p>Because there are too many flags to easily and correctly place on the command line, the options that are needed to do this are read from a file that is specified by the <strong>-Of</strong> flag. This also provides a more secure way to pass passwords to the program; ensure that access to the file is restricted appropriately. The file /usr/local/dacs/ldap_roles_options_direct might contain configuration such as this:</p>
<pre>
LDAP_BIND_METHOD=direct
LDAP_ADMIN_URL*="ldap://winders.example.com/CN=" . encode(url,${Args::DACS_USERNAME}) . ",CN=Users,DC=example,DC=com"

LDAP_ROLES_SELECTOR*="${LDAP::attrname}" eq "memberOf" ? strtr(ldap(rdn_attrvalue, &#92;
    ldap(dn_index, "${LDAP::attrvalue}", 1)), " ", "_") : ""
</pre>
<p>The following example is like the previous one, except that it uses the "indirect" binding method and therefore does not need to be given the user&apos;s Common Name:</p>
<pre>
% dacsauth -r https://example.example.com/cgi-bin/dacs/local_ldap_roles &#92;
    -Of /usr/local/dacs/ldap_roles_options_indirect -u bobo &#92;
    -DVFS="[federation_keys]dacs-fs:/usr/local/dacs/federations/federation_keys" &#92;
     -fn EXAMPLE -fj FEDROOT -p bobospassword
DnsAdmins,Print_Operators,Domain_Admins,Administrators
</pre>
<p>The file /usr/local/dacs/ldap_roles_options_indirect might contain configuration such as this:</p>
<pre>
LDAP_BIND_METHOD=indirect
LDAP_ADMIN_URL=ldap://winders.example.com/CN=Administrator,CN=Users,DC=example,DC=com

# Search under Users...
LDAP_SEARCH_ROOT_DN=CN=Users,DC=example,DC=com

LDAP_ADMIN_PASSWORD=theSecretAdminPassword
LDAP_SEARCH_FILTER*="(sAMAccountName=${Args::DACS_USERNAME})"
LDAP_ROLES_SELECTOR*="${LDAP::attrname}" eq "memberOf" ? strtr(ldap(rdn_attrvalue, &#92;
    ldap(dn_index, "${LDAP::attrvalue}", 1)), " ", "_") : ""
</pre>
<p>Suppose one wanted to use <strong>dacsauth</strong> to authenticate a user via LDAP in a way analogous to this dacs.conf configuration:</p>
<pre>
&lt;Auth id="ldap"&gt;
URL "http://example.example.com/cgi-bin/dacs/local_ldap_authenticate"
STYLE "password,add_roles"
CONTROL "required"
LDAP_BIND_METHOD "direct"
LDAP_USERNAME_URL* &apos;"ldap://winders.example.com/cn=" . encode(url, ${Args::USERNAME}) . ",cn=Users,dc=example,dc=local"&apos;
LDAP_USERNAME_EXPR* &apos;"${LDAP::sAMAccountName}"&apos;
LDAP_ROLES_SELECTOR* &apos;"${LDAP::attrname}" eq "memberOf" &#92;
    ? strtr(ldap(rdn_attrvalue, ldap(dn_index, "${LDAP::attrvalue}", 1)), " ", "_") : ""&apos;
&lt;/Auth&gt;
</pre>
<p>A file like this (e.g., /usr/local/dacs/ldap_auth_options_direct) would contain the following directives:</p>
<pre>
LDAP_BIND_METHOD=direct
LDAP_USERNAME_URL*="ldap://winders.example.com/cn=" . encode(url, ${Args::USERNAME}) . ",cn=Users,dc=example,dc=local"
LDAP_USERNAME_EXPR*="${LDAP::sAMAccountName}"
LDAP_ROLES_SELECTOR*="${LDAP::attrname}" eq "memberOf" &#92;
    ? strtr(ldap(rdn_attrvalue, ldap(dn_index, "${LDAP::attrvalue}", 1)), " ", "_") : ""
</pre>
<p>Authentication could then be performed using a command like this:</p>
<pre>
% dacsauth -fj FEDROOT -m http://example.example.com/cgi-bin/dacs/local_ldap_authenticate passwd suff &#92;
  -Of /usr/local/dacs/ldap_auth_options_direct &#92;
  -DVFS="[federation_keys]dacs-fs:/usr/local/dacs/federations/federation_keys" &#92;
  -fn EXAMPLE -u bobo -prompt
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">
<p>The program exits 0 if authentication was successful or with 1 if authentication failed or an error occurred.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>This command only supplies partial support for interacting with <strong>dacs_authenticate</strong>. It may not be possible for an authentication module to return role information, as can be done by <strong>dacs_authenticate</strong>.</p><p>It would be better if the <strong>-m</strong> flag were instead <strong>-a</strong> (for "authenticate").</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO dacsauth&hellip;</h2>
        <div class="sectioncontent">
<p>\m[blue]<a href="../man1/dacscred.1.html"><strong>dacscred</strong>(1)</a></strong>\m[]\s-2\u[2]\d\s+2, \m[blue]<a href="../man8/dacs_authenticate.8.html"><strong>dacs_authenticate</strong>(8)</a></strong>\m[]\s-2\u[1]\d\s+2, \m[blue]<a href="../man5/dacs.exprs.5.html"><strong>dacs.exprs</strong>(5)</a></strong>\m[]\s-2\u[24]\d\s+2</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Distributed Systems Software (\m[blue]<strong>www.dss.ca</strong>\m[]\s-2\u[25]\d\s+2)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYING</h2>
        <div class="sectioncontent">
<p>Copyright2003-2013 Distributed Systems Software. See the \m[blue]<strong>LICENSE</strong>\m[]\s-2\u[26]\d\s+2 file that accompanies the distribution for licensing information.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
     1.
  </dt>
  <dd>
    <p><a href="../man8/dacs_authenticate.8.html"><strong>dacs_authenticate</strong>(8)</a></p><p>http://dacs.dss.ca/man/dacs_authenticate.8.html</p>
  </dd>
  <dt>
     2.
  </dt>
  <dd>
    <p><a href="../man1/dacscred.1.html"><strong>dacscred</strong>(1)</a></p><p>http://dacs.dss.ca/man/dacscred.1.html</p>
  </dd>
  <dt>
     3.
  </dt>
  <dd>
    <p><a href="../man8/dacs_auth_agent.8.html"><strong>dacs_auth_agent</strong>(8)</a></p><p>http://dacs.dss.ca/man/dacs_auth_agent.8.html</p>
  </dd>
  <dt>
     4.
  </dt>
  <dd>
    <p><strong>dacs.conf</strong>(5)</p><p>http://dacs.dss.ca/man/dacs.conf.5.html</p>
  </dd>
  <dt>
     5.
  </dt>
  <dd>
    <p><a href="../man1/dacs.1.html"><strong>dacs</strong>(1)</a></p><p>http://dacs.dss.ca/man/dacs.1.html</p>
  </dd>
  <dt>
     6.
  </dt>
  <dd>
    <p>Auth clause</p><p>http://dacs.dss.ca/man/dacs_authenticate.html#auth_clause</p>
  </dd>
  <dt>
     7.
  </dt>
  <dd>
    <p>URL</p><p>http://dacs.dss.ca/man/dacs_authenticate.8.html#URL</p>
  </dd>
  <dt>
     8.
  </dt>
  <dd>
    <p>STYLE</p><p>http://dacs.dss.ca/man/dacs_authenticate.8.html#STYLE</p>
  </dd>
  <dt>
     9.
  </dt>
  <dd>
    <p>CONTROL</p><p>http://dacs.dss.ca/man/dacs_authenticate.8.html#CONTROL</p>
  </dd>
  <dt>
    10.
  </dt>
  <dd>
    <p>OPTION</p><p>http://dacs.dss.ca/man/dacs_authenticate.8.html#OPTION</p>
  </dd>
  <dt>
    11.
  </dt>
  <dd>
    <p>EXPR</p><p>http://dacs.dss.ca/man/dacs_authenticate.8.html#EXPR</p>
  </dd>
  <dt>
    12.
  </dt>
  <dd>
    <p>VFS</p><p>http://dacs.dss.ca/man/dacs.conf.5.html#VFS</p>
  </dd>
  <dt>
    13.
  </dt>
  <dd>
    <p><a href="../man8/dacs_authenticate.8.html"><strong>dacs_authenticate</strong>(8)</a></p><p>http://dacs.dss.ca/man/dacs_authenticate.8.html#roles_clause</p>
  </dd>
  <dt>
    14.
  </dt>
  <dd>
    <p>URL</p><p>http://dacs.dss.ca/man/dacs_authenticate.8.html#r_URL</p>
  </dd>
  <dt>
    15.
  </dt>
  <dd>
    <p>-fn</p><p>http://dacs.dss.ca/man/#fn_flag</p>
  </dd>
  <dt>
    16.
  </dt>
  <dd>
    <p>-fj</p><p>http://dacs.dss.ca/man/#fj_flag</p>
  </dd>
  <dt>
    17.
  </dt>
  <dd>
    <p>Google</p><p>http://www.google.com</p>
  </dd>
  <dt>
    18.
  </dt>
  <dd>
    <p><a href="../man8/dacs_authenticate.8.html"><strong>dacs_authenticate</strong>(8)</a></p><p>http://dacs.dss.ca/man/dacs_authenticate.8.html#local_pam_authenticate</p>
  </dd>
  <dt>
    19.
  </dt>
  <dd>
    <p><a href="../man8/pamd.8.html"><strong>pamd</strong>(8)</a></p><p>http://dacs.dss.ca/man/pamd.8.html</p>
  </dd>
  <dt>
    20.
  </dt>
  <dd>
    <p>local_unix_roles</p><p>http://dacs.dss.ca/man/dacs_authenticate.8.html#local_unix_roles</p>
  </dd>
  <dt>
    21.
  </dt>
  <dd>
    <p>local_roles</p><p>http://dacs.dss.ca/man/dacs_authenticate.8.html#local_roles</p>
  </dd>
  <dt>
    22.
  </dt>
  <dd>
    <p>local_ldap_roles</p><p>http://dacs.dss.ca/man/dacs_authenticate.8.html#local_ldap_roles</p>
  </dd>
  <dt>
    23.
  </dt>
  <dd>
    <p>role string</p><p>http://dacs.dss.ca/man/dacs.1.html#roles</p>
  </dd>
  <dt>
    24.
  </dt>
  <dd>
    <p><a href="../man5/dacs.exprs.5.html"><strong>dacs.exprs</strong>(5)</a></p><p>http://dacs.dss.ca/man/dacs.exprs.5.html</p>
  </dd>
  <dt>
    25.
  </dt>
  <dd>
    <p>www.dss.ca</p><p>http://www.dss.ca</p>
  </dd>
  <dt>
    26.
  </dt>
  <dd>
    <p>LICENSE</p><p>http://dacs.dss.ca/man/../misc/LICENSE</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="dacsacl.1.html"><span aria-hidden="true">&larr;</span> dacsacl.1: List, check, or re-index access control rules</a></li>
   <li class="next"><a href="dacscheck.1.html">dacscheck.1: Authorization check <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
