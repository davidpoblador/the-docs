<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>spectrum1d: Compute auto- [and cross- ] spectra from one [or two] timeseries.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Compute auto- [and cross- ] spectra from one [or two] timeseries.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="spectrum1d (1gmt) manual">
  <meta name="twitter:description" content="Compute auto- [and cross- ] spectra from one [or two] timeseries.">
  <meta name="twitter:image" content="https://www.carta.tech/images/gmt-manpages-spectrum1d-1gmt.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1gmt/gmt-manpages-spectrum1d.1gmt.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="spectrum1d (1gmt) manual" />
  <meta property="og:description" content="Compute auto- [and cross- ] spectra from one [or two] timeseries." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/gmt-manpages-spectrum1d-1gmt.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">spectrum1d<small> (1gmt)</small></h1>
        <p class="lead">Compute auto- [and cross- ] spectra from one [or two] timeseries.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1gmt/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1gmt/spectrum1d.1gmt.html">
      <span itemprop="name">spectrum1d: Compute auto- [and cross- ] spectra from one [or two] timeseries.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/gmt-manpages/">
      <span itemprop="name">gmt-manpages</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1gmt/spectrum1d.1gmt.html">
      <span itemprop="name">spectrum1d: Compute auto- [and cross- ] spectra from one [or two] timeseries.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>spectrum1d</strong> [ <em>x[y]file</em> ] <strong>-S</strong><em>segment_size</em>] [ <strong>-C</strong>[<strong>xycnpago</strong>] ] [ <strong>-D</strong><em>dt</em> ] [ <strong>-N</strong><em>name_stem</em> ] [ <strong>-V</strong> ] [ <strong>-W</strong> ] [ <strong>-bi</strong>[<strong>s</strong>][<em>n</em>] ] [ <strong>-bo</strong>[<strong>s</strong>][<em>n</em>] ]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>spectrum1d</strong> reads X [and Y] values from the first [and second] columns on standard input [or <em>x[y]file</em>]. These values are treated as timeseries X(t) [Y(t)] sampled at equal intervals spaced <em>dt</em> units apart. There may be any number of lines of input. <strong>spectrum1d</strong> will create file[s] containing auto- [and cross- ] spectral density estimates by Welch's method of ensemble ' averaging of multiple overlapped windows, using standard error estimates from Bendat and Piersol.</p><p>The output files have 3 columns: f or w, p, and e. f or w is the frequency or wavelength, p is the spectral density estimate, and e is the one standard deviation error bar size. These files are named based on <em>name_stem</em>. If the <strong>-C</strong> option is used, up to eight files are created; otherwise only one (xpower) is written. The files (which are ASCII unless <strong>-bo</strong> is set) are as follows:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>name_stem</em>.xpower</p>
  </dt>
  <dd>
    <p>Power spectral density of X(t). Units of X * X * <em>dt</em>.</p>
  </dd>
  <dt>
    <p><em>name_stem</em>.ypower</p>
  </dt>
  <dd>
    <p>Power spectral density of Y(t). Units of Y * Y * <em>dt</em>.</p>
  </dd>
  <dt>
    <p><em>name_stem</em>.cpower</p>
  </dt>
  <dd>
    <p>Power spectral density of the coherent output. Units same as ypower.</p>
  </dd>
  <dt>
    <p><em>name_stem</em>.npower</p>
  </dt>
  <dd>
    <p>Power spectral density of the noise output. Units same as ypower.</p>
  </dd>
  <dt>
    <p><em>name_stem</em>.gain</p>
  </dt>
  <dd>
    <p>Gain spectrum, or modulus of the transfer function. Units of (Y / X).</p>
  </dd>
  <dt>
    <p><em>name_stem</em>.phase</p>
  </dt>
  <dd>
    <p>Phase spectrum, or phase of the transfer function. Units are radians.</p>
  </dd>
  <dt>
    <p><em>name_stem</em>.admit</p>
  </dt>
  <dd>
    <p>Admittance spectrum, or real part of the transfer function. Units of (Y / X).</p>
  </dd>
  <dt>
    <p><em>name_stem</em>.coh</p>
  </dt>
  <dd>
    <p>(Squared) coherency spectrum, or linear correlation coefficient as a function of frequency. Dimensionless number in [0, 1]. The Signal-to-Noise-Ratio (SNR) is coh / (1 - coh). SNR = 1 when coh = 0.5.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REQUIRED ARGUMENTS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>x[y]file</em></p>
  </dt>
  <dd>
    <p>ASCII (or binary, see <strong>-bi</strong>) file holding X(t) [Y(t)] samples in the first 1 [or 2] columns. If no file is specified, <strong>spectrum1d</strong> will read from standard input.</p>
  </dd>
  <dt>
    <p><strong>-S</strong></p>
  </dt>
  <dd>
    <p><em>segment_size</em> is a radix-2 number of samples per window for ensemble averaging. The smallest frequency estimated is 1.0/(<em>segment_size</em> * <em>dt</em>), while the largest is 1.0/(2 * <em>dt</em>). One standard error in power spectral density is approximately 1.0 / sqrt(<em>n_data</em> / <em>segment_size</em>), so if <em>segment_size</em> = 256, you need 25,600 data to get a one standard error bar of 10%. Cross-spectral error bars are larger and more complicated, being a function also of the coherency.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-C</strong></p>
  </dt>
  <dd>
    <p>Read the first two columns of input as samples of two timeseries, X(t) and Y(t).</p>
<pre>
  Consider Y(t) to be the
</pre>
<p>output and X(t) the input in a linear system with noise. Estimate the optimum f requency response function by least squares, such that the noise output is minimized and the coherent outpu t and the noise output are uncorrelated. Optionally specify up to 8 letters from the set { <strong>x y c n p a g o</strong> } in any order to create only those output files instead of the default [all]. <strong>x</strong> = xpower, <strong>y</strong> = ypower, <strong>c</strong> = cpower, <strong>n</strong> = npower, <strong>p</strong> = phase, <strong>a</strong> = admit, <strong>g</strong> = gain, <strong>o</strong> = coh.</p>
  </dd>
  <dt>
    <p><strong>-D</strong></p>
  </dt>
  <dd>
    <p><em>dt</em> Set the spacing between samples in the timeseries [Default = 1].</p>
  </dd>
  <dt>
    <p><strong>-N</strong></p>
  </dt>
  <dd>
    <p><em>name_stem</em> Supply the name stem to be used for output files [Default = "spectrum"].</p>
  </dd>
  <dt>
    <p><strong>-V</strong></p>
  </dt>
  <dd>
    <p>Selects verbose mode, which will send progress reports to stderr [Default runs "silently"].</p>
  </dd>
  <dt>
    <p><strong>-W</strong></p>
  </dt>
  <dd>
    <p>Write Wavelength rather than frequency in column 1 of the output file[s] [Default = frequency, (cycles / <em>dt</em>)].</p>
  </dd>
  <dt>
    <p><strong>-bi</strong></p>
  </dt>
  <dd>
    <p>Selects binary input. Append <strong>s</strong> for single precision [Default is double]. Append <em>n</em> for the number of columns in the binary file(s). [Default is 2 input columns].</p>
  </dd>
  <dt>
    <p><strong>-bo</strong></p>
  </dt>
  <dd>
    <p>Selects binary output. Append <strong>s</strong> for single precision [Default is double].</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Suppose data.g is gravity data in mGal, sampled every 1.5 km. To write its power spectrum, in mGal**2-km, to the file data.xpower, try</p><p>spectrum1d data.g <strong>-S</strong>256 <strong>-D</strong>1.5 <strong>-N</strong>data</p><p>Suppose in addition to data.g you have data.t, which is topography in meters sampled at the same points as data.g. To estimate various features of the transfer function, considering data.t as input and data.g as output, try</p><p>paste data.t data.g | spectrum1d <strong>-S</strong>256 <strong>-D</strong>1.5 <strong>-N</strong>data <strong>-C</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO spectrum1d&hellip;</h2>
        <div class="sectioncontent">
<p><em>gmt</em>(1gmt), <em>grdfft</em>(1gmt)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REFERENCES</h2>
        <div class="sectioncontent">
<p>Bendat, J. S., and A. G. Piersol, 1986, Random Data, 2nd revised ed., John Wiley & Sons.</p><p>Welch, P. D., 1967, "The use of Fast Fourier Transform for the estimation of power spectra:  a method based on time averaging over short, modified periodograms", IEEE Transactions on Audio and Electroacoustics, Vol AU-15, No 2.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="gmt-spectrum1d.1gmt.html"><span aria-hidden="true">&larr;</span> spectrum1d.1gmt: Compute auto- [and cross- ] spectra from one [or two] timeseries.</a></li>
   <li class="next"><a href="sphdistance.1gmt.html">sphdistance.1gmt: Calculate nearest distances from voronoi construction of spherical data <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
