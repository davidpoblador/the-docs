<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>debirf: Build an initrd to boot a full debian system entirely from ram</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Build an initrd to boot a full debian system entirely from ram">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="debirf (1) manual">
  <meta name="twitter:description" content="Build an initrd to boot a full debian system entirely from ram">
  <meta name="twitter:image" content="https://www.carta.tech/images/debirf-debirf-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/debirf.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="debirf (1) manual" />
  <meta property="og:description" content="Build an initrd to boot a full debian system entirely from ram" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/debirf-debirf-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">debirf<small> (1)</small></h1>
        <p class="lead">Build an initrd to boot a full debian system entirely from ram</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/debirf.1.html">
      <span itemprop="name">debirf: Build an initrd to boot a full debian system entirely from ram</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/debirf/">
      <span itemprop="name">debirf</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/debirf.1.html">
      <span itemprop="name">debirf: Build an initrd to boot a full debian system entirely from ram</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>debirf &lt;subcommand&gt; [options] [args]</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>debirf</strong> (DEBian on Initial Ram Filesystem) is a set of tools designed to create and prepare a kernel and initial ram filesystem that can run a full-blown Debian environment entirely from RAM.</p><p><strong>debirf</strong> has various subcommands (see <strong>SUBCOMMANDS</strong>) which act on a specified debirf profile (see <strong>PROFILES</strong>).</p><p>The debirf system is outlined at:</p>
<pre>
   http://cmrg.fifthhorseman.net/wiki/debirf
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Make a stock debirf rescue image using the default settings:</p>
<pre>
 $ tar xzf /usr/share/doc/debirf/example-profiles/rescue.tgz
 $ debirf make rescue
</pre>
<p>Make a debirf rescue image, specifying the mirror and a local HTTP proxy:</p>
<pre>
 $ tar xzf /usr/share/doc/debirf/example-profiles/rescue.tgz
 $ DEBIRF_MIRROR=http://ftp.debian.org/debian http_proxy=http://127.0.0.1:3128/ debirf make rescue
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SUBCOMMANDS</h2>
        <div class="sectioncontent">
<p><strong>debirf</strong> takes various subcommands:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>make [options] PROFILE</strong></p>
  </dt>
  <dd>
    <p>Create a debirf system based on profile PROFILE.  This will create the root for the profile, run all modules on the root, and then generate the kernel image (see <strong>KERNEL</strong>) and debirf initramfs.  This subcommand takes various options (see <strong>OPTIONS</strong>).</p>
  </dd>
  <dt>
    <p><strong>enter PROFILE</strong></p>
  </dt>
  <dd>
    <p>Chroot into root of profile PROFILE, with full profile environment.</p>
  </dd>
  <dt>
    <p><strong>makeiso PROFILE</strong></p>
  </dt>
  <dd>
    <p>Create a bootable CD-ROM image from the kernel and initramfs in PROFILE.  This requires a bootloader to be available.  If grub-mkrescue (in the grub-common package on debian) is available, it will be used.  Otherwise, isolinux (from the syslinux-common package) is used if it is available.  You may use the <strong>DEBIRF_ISO_BOOTLOADER</strong> environment variable to specify a preference manually (see below).</p>
  </dd>
  <dt>
    <p><strong>help</strong></p>
  </dt>
  <dd>
    <p>Output a brief usage summary.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS (for make subcommand only)</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-c</strong>, <strong>--check-vars</strong></p>
  </dt>
  <dd>
    <p>check variables before make</p>
  </dd>
  <dt>
    <p><strong>-n</strong>, <strong>--new</strong></p>
  </dt>
  <dd>
    <p>create new root, even if old one exists</p>
  </dd>
  <dt>
    <p><strong>-o</strong>, <strong>--overwrite</strong></p>
  </dt>
  <dd>
    <p>debootstrap on top of old root if it exists</p>
  </dd>
  <dt>
    <p><strong>-s</strong>, <strong>--skip</strong></p>
  </dt>
  <dd>
    <p>skip debootstrap step altogether if old root exists</p>
  </dd>
  <dt>
    <p><strong>-r</strong>, <strong>--root-build</strong></p>
  </dt>
  <dd>
    <p>use real chroot to build instead of fakechroot (requires superuser privileges or CAP_SYS_CHROOT)</p>
  </dd>
  <dt>
    <p><strong>-w</strong>, <strong>--no-warning</strong></p>
  </dt>
  <dd>
    <p>skip superuser warning</p>
  </dd>
  <dt>
    <p><strong>-i</strong>, <strong>--initrd-only</strong></p>
  </dt>
  <dd>
    <p>remake initramfs from existing root (skip debootstrap and module stages)</p>
  </dd>
  <dt>
    <p><strong>-k</strong>, <strong>--kernel-deb=KERNEL</strong></p>
  </dt>
  <dd>
    <p>install KERNEL .deb, instead of default kernel</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PROFILES</h2>
        <div class="sectioncontent">
<p>A debirf profile is a directory containing a debirf.conf config file and a modules sub-directory (see <strong>MODULES</strong>).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MODULES</h2>
        <div class="sectioncontent">
<p><strong>Modules</strong> are used to configure the debirf system, and can be used to extend the capabilities of debirf.  Modules are bash shell scripts that are executed in alpha-numeric order by <strong>run-parts</strong> in a chroot in the debirf root during the module stage of the debirf build. The module stage is right after the debirf debootstrap stage, and right before the initramfs archive is created.  All shell variables beginning with "DEBIRF_", including those defined in the <em>debirf.conf</em> file, are available to the modules.</p><p><strong>NOTE:</strong> Some modules are more important to the proper functioning of debirf than others, and the ordering of modules is important.  Some modules may depend on certain other modules having already been, or not yet been, run.  For instance, the module that cleans the debirf apt cache ("z1_clean_root") should be the last module run at the end of the module stage.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">KERNEL</h2>
        <div class="sectioncontent">
<p>The <strong>debirf</strong> "install-kernel" module will try to pick the most up-to-date kernel for the suite you are installing (versions 2.6 only), with the arch determined by the kernel running on the host build system.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FUNCTIONS</h2>
        <div class="sectioncontent">
<p>A set of pre-defined bash shell functions are available to the modules to fasciliate configuring the debirf system:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>debirf_exec &lt;command&gt;</strong></p>
  </dt>
  <dd>
    <p>Execute &lt;command&gt; within debirf root (<strong>DEBIRF_ROOT</strong>) with chroot.</p>
  </dd>
  <dt>
    <p><strong>msg &lt;message&gt;</strong></p>
  </dt>
  <dd>
    <p>Output a message to standard out during the build process.</p>
  </dd>
  <dt>
    <p><strong>failure &lt;message&gt; &lt;exit-code&gt;</strong></p>
  </dt>
  <dd>
    <p>Cause debirf script to fail with &lt;exit-code&gt;, and &lt;message&gt; to stderr.</p>
  </dd>
  <dt>
    <p><strong>debirf_info_sh &lt;message&gt;</strong></p>
  </dt>
  <dd>
    <p>Write one line of sh code to the <em>debirf.info</em> file on the debirf root.</p>
  </dd>
  <dt>
    <p><strong>debirf_info_comment &lt;message&gt;</strong></p>
  </dt>
  <dd>
    <p>Write one line of comment to the <em>debirf.info</em> file on the debirf root.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">
<p>The following environment variables are used by debirf:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>DEBIRF_LABEL</strong></p>
  </dt>
  <dd>
    <p>debirf label (default: debirf)</p>
  </dd>
  <dt>
    <p><strong>DEBIRF_BUILDD</strong></p>
  </dt>
  <dd>
    <p>where to build the debirf (default: ./)</p>
  </dd>
  <dt>
    <p><strong>DEBIRF_ARCH</strong></p>
  </dt>
  <dd>
    <p>architecture to build (default is the architecture of the build machine)</p>
  </dd>
  <dt>
    <p><strong>DEBIRF_SUITE</strong></p>
  </dt>
  <dd>
    <p>suite to build from (default determined from lsb_release, otherwise "sid")</p>
  </dd>
  <dt>
    <p><strong>DEBIRF_DISTRO</strong></p>
  </dt>
  <dd>
    <p>distro for suite (default determined from lsb_release, otherwise "debian")</p>
  </dd>
  <dt>
    <p><strong>DEBIRF_MIRROR</strong></p>
  </dt>
  <dd>
    <p>mirror to pull suite (default determined by DEBIRF_DISTRO)</p>
  </dd>
  <dt>
    <p><strong>DEBIRF_KEYRING</strong></p>
  </dt>
  <dd>
    <p>keyring to verify debootstrap (default determined by DEBIRF_DISTRO)</p>
  </dd>
  <dt>
    <p><strong>DEBIRF_KERNEL_FLAVOR</strong></p>
  </dt>
  <dd>
    <p>the flavor of kernel debirf should install.  Supply everything from a typical debian package name after the version number.  e.g. 486, vserver-686-bigmem, openvz-amd64. (default chosen based on currently-running kernel)</p>
  </dd>
  <dt>
    <p><strong>DEBIRF_ISO_BOOTLOADER</strong></p>
  </dt>
  <dd>
    <p>whether to use "grub" or "isolinux" as the El Torito bootloader for <strong>debirf makeiso</strong>.  if not specified, "grub" is the default.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>$DEBIRF_PROFILE/debirf.conf</p>
  </dt>
  <dd>
    <p>Debirf profile configuration file.  Contains values for the various debirf environment variables (see <strong>ENVIRONMENT</strong>).  Variables specified in the debirf.conf override those specified on the command line.</p>
  </dd>
  <dt>
    <p>$DEBIRF_ROOT/etc/debirf/debirf.info</p>
  </dt>
  <dd>
    <p>File that stores various information about the debirf build.  This is a bash-sourceable file.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Written by Jameson Rollins and Daniel Kahn Gillmor.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Debirf does not work as a non-privileged user across different versions of libc. In particular, this means that you probably won't be able to build an image from a different version of the operating system than you're using without building as root. (see http://bugs.debian.org/650242)</p><p>Please report bugs in debirf via the debian BTS: http://bugs.debian.org/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2007-2011 Jameson Rollins and Daniel Kahn Gillmor</p><p>This is free software.  You may redistribute copies of it under the terms of the GNU General Public License &lt;http://www.gnu.org/licenses/gpl.html&gt;. There is NO WARRANTY, to the extent permitted by law.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO debirf&hellip;</h2>
        <div class="sectioncontent">
<p><strong>/usr/share/doc/debirf/README,</strong> <a href="../man8/debootstrap.8.html"><strong>debootstrap</strong>(8)</a>, <strong>fakechroot</strong>(1)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="debianize-vdrplugin.1.html"><span aria-hidden="true">&larr;</span> debianize-vdrplugin.1: Debianize a vdr plugin source archive</a></li>
   <li class="next"><a href="debman.1.html">debman.1: Read man pages from uninstalled packages <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
