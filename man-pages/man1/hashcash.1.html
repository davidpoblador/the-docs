<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>hashcash: Hashcash anti-spam / denial of service counter-measure tool</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Hashcash anti-spam / denial of service counter-measure tool">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="hashcash (1) manual">
  <meta name="twitter:description" content="Hashcash anti-spam / denial of service counter-measure tool">
  <meta name="twitter:image" content="https://www.carta.tech/images/hashcash-hashcash-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/hashcash.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="hashcash (1) manual" />
  <meta property="og:description" content="Hashcash anti-spam / denial of service counter-measure tool" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/hashcash-hashcash-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">hashcash<small> (1)</small></h1>
        <p class="lead">Hashcash anti-spam / denial of service counter-measure tool</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/hashcash.1.html">
      <span itemprop="name">hashcash: Hashcash anti-spam / denial of service counter-measure tool</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/hashcash/">
      <span itemprop="name">hashcash</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/hashcash.1.html">
      <span itemprop="name">hashcash: Hashcash anti-spam / denial of service counter-measure tool</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>&#92;$1</strong></p><p><strong>hashcash</strong> <em>-m</em> [ [ <em>options</em> ] [ <em>resource</em> ... ] ... ] <strong>hashcash</strong> <em>-c</em> [ [ <em>options</em> ] <em>-r resource</em> ... ] [ <em>stamp</em> ... ] <strong>hashcash</strong> <em>-s</em> [ <em>options</em> ] [ <em>-b bits</em> ] <strong>hashcash</strong> <em>-p now</em> [ <em>-j resource</em> ] [ <em>-k</em> ] [ <em>-t time</em> ] [ <em>-u</em> ] <strong>hashcash</strong> <em>-w</em> [ <em>options</em> ] [ <em>stamp</em> ... ] <strong>hashcash</strong> <em>-n</em> [ <em>options</em> ] [ <em>stamp</em> ... ] <strong>hashcash</strong> <em>-l</em> [ <em>options</em> ] <em>-e period</em> [ <em>stamp</em> ... ]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Hashcash is a denial-of-service counter measure tool.  Its main current use is to help hashcash users avoid losing email due to content based and blacklist based anti-spam systems.</p><p>The hashcash tool allows you to create hashcash stamps to attach to emails you send, and to verify hashcash stamps attached to emails you receive.  Email senders attach hashcash stamps with the X-Hashcash: header.  Vendors and authors of anti-spam tools are encouraged to exempt mail sent with hashcash from their blacklists and content based filtering rules.</p><p>A hashcash stamp constitutes a proof-of-work which takes a parameterizable amount of work to compute for the sender.  The recipient can verify received stamps efficiently.</p><p>The hashcash proof-of-work function is to compute partial hash collisions (the \s-1SHA1\s0 hash function is used).  By choosing the number of bits of collision, the work required to compute a collision can be made arbitrarily expensive \*(-- from fractions of a second to minutes or hours.  The verification is efficient requiring the same small cost whatever the collision size.</p><p>For more detailed discussion of other applications hashcash has been used for see http://www.hashcash.org/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE NOTES</h2>
        <div class="sectioncontent">
<p>In this man page a resource name is the name of the service or address the stamp is created for.  In the case of email, the resource name is the recipient's email address in the form user@domain.com. The <em>-m</em> flag must be given to mint a stamp.</p><p>The resource name (recipient's email address) to mint the stamp against can be passed as an argument, or if omitted is read from stdin.  If stdin is a tty the user is prompted, if stdin is a pipe the resource name is just silently read.  The desired collision size can be specified with the -b option.  If no collision size is specified, the default is 20 bits.  See also the <em>-b default</em> option. The <em>-c</em> flag must be given to check a stamps expiry.  The stamp to check can be given as an argument to \*(C`hashcash\*(C'.  If no stamp is given the stamp is read from stdin.  If stdin is a tty the user will be prompted, if stdin is a pipe the stamp is just silently read.  A resource name (the recipient's email address) can be given with the <em>-r</em> option.  If a resource name is given the resource name is compared to the resource name in the stamp, if they do not match, the stamp is rejected.</p><p>Note: if no resource name is given the stamp is anyway checked to see if it is otherwise valid, but it could be minted for a different resource, which would allow stamps to be reused across different resources, so hashcash will return unchecked exit code on exit.</p><p>Stamps are by default considered to be valid for 28 days.  The validity period can be changed using the <em>-e</em> flag.</p><p>If the stamp has expired or has a date in the future the stamp is rejected and the program exits immediately.</p><p>If a required collision size is given with the <em>-b</em> flag, the stamps value is computed and compared, if the stamp has insufficent value it is rejected, and the program exits immediately.  If the <em>-b</em> flag is not given, the stamp is checked to see if it is otherwise valid, but hashcash will return unchecked exit code on exit.</p><p>If the stamp is double spent the stamp is rejected.  Double spending protection is discussed in more detail below in \*(L"Double Spending Protection\*(R".  If double spending protection is not enabled, the stamp could be double spent, so hashcash will return unchecked exit code (exit code 2) on exit.</p><p>The <em>-w</em> flag can be used to request that the number of bits of the collision are counted and displayed. The <em>-n</em> flag can be used to request that the resource name in the stamp is parsed out and displayed.  The <em>-l</em> flag can be used to request the number of seconds until expiry of the stamp is output.</p><p>The program will only return exit codes valid or invalid if the <em>-c</em> flag is used, the <em>-b</em> flag is used, <em>-d</em>, <em>-r resource</em> are used. These are the minimum set of options necessary to fully check the validty of a stamp.  If these criteria are not met, the program will return exit code unchecked (exit code 2) on exit.  (See also the <em>-y</em> flag.) If the <em>-d</em> flag is used when checking stamps, a database of spent stamps is kept.</p><p>By default stamps expire after 28 days, without expiry the database would grow indefinately.  You can specify an alternate expiry period with the <em>-e</em> flag.  The recommended (and default) expiry period for email is 28 days.  After the expiry period amount of time, the stamp is anyway considered expired and may be purged from the database to save space.  (See \*(L"Purging Periodically vs on Next Access\*(R" for how to purge stamps.)</p><p>For efficiency reasons a stamp is verified before it is checked in the database; if it is otherwise invalid no database activity will occur.</p><p>Note: The decision about how long the stamp should be considered valid is up to the verifier.  If it is too short it is possible for some applications that the stamp will expire before arriving at the recipient (eg with email.)  The suggested value of 28 days should be safe for normal email delivery delays.  The choice is a trade-off between database size and risk of expiry prior to arrival, and depends on the application.</p><p>Note: Different stamps in the same database can have different validity periods, so for example stamps for different resources with different validity periods can be stored in the same database, or the recipient may change the validity period for future stamps without affecting the validity of old stamps. To purge old stamps periodically while checking stamps use the <em>-p</em> period option to purge no sooner than the given time period since the last purge.  Purging can be used with the <em>-k</em> option to purge unexpired stamps also, and with the <em>-j resource</em> flag to purge only stamps for the given resource.</p><p>There are circumstances where it may be inconvenient to purge stamps on the next access, for example if there is a large double spend database which takes some time to purge, and the response time of the hashcash checker is important.  To avoid this problem, purging can be done separately using just the <em>-p now</em> option to request just the purge operation.  On unix for example you could call \*(C`hashcash -p now\*(C' in a cron job once per day, or on demand when disk was running low. The <em>-s</em> flag requests measurement of how many collisions can be tested per second.  No stamp is minted, or verified.</p><p>If the <em>-b</em> flag is used with this option, instead an estimate of how many seconds it would take to mint a stamp of the given size in bits is computed.  To find out how much time it will take to mint a default sized stamp use <em>-s -b default</em>. All informational output is printed on stderr.  Minted stamps, and results of stamp verification and timing are printed on stdout.  The quiet flag <em>-q</em> suppresses all informational output.  The <em>-v</em> flag requests more informational output.  The requested output, which is the only information that is output in quiet mode (when <em>-q</em> is specified) is printed on standard output.  If stdout is a pipe, or when quiet mode is in effect the output is printed without description (ie just bits, just seconds, just resource).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <em>-c</em>
  </dt>
  <dd>
    <p>Check the expiry information of stamps given as an argument or on stdin.  (Use with <em>-b</em>, <em>-d</em> and <em>-r resource</em> to fully check stamps).</p>
  </dd>
  <dt>
    <em>-m</em>
  </dt>
  <dd>
    <p>Mint stamps with the resources given as arguments or on stdin.</p>
  </dd>
  <dt>
    <em>-b bits</em>
  </dt>
  <dd>
    <p>When minting a stamp, create a collision of at least this many bits. When verifying a stamp require that it have a collision of at minimum this many bits, otherwise reject it.  If omitted the default is used. When checking stamps, require that the stamps have this many bits. The default number of bits can be specified with <em>-b default</em>.  Bits relative to the default can also be specified with <em>-b +n</em> for n bits more than the default and <em>-b -n</em> for n bits less than the default. <em>-b default</em>, <em>-b +0</em> and <em>-b -0</em> are all equivalent. When doing the speed test <em>-s</em>, can to measure speed of default token with <em>-s -b default</em>.</p>
  </dd>
  <dt>
    <em>-r resource</em>
  </dt>
  <dd>
    <p>When minting stamps, the resource name (recipient's email address) to mint the stamp against can be given either with <em>-r resource</em> or as an argument to \*(C`hashcash\*(C'. When checking stamps, the resource name (your own email address) is given with the <em>-r</em> option.  If the resource name is given it is checked against the resource name in the stamp, and if they do not match the stamp is rejected.  Note if the resource name is not given, stamps for other resources would be accepted, and therefore hashcash returns exit code unchecked (exit code 2) on exit.</p>
  </dd>
  <dt>
    <em>-o</em>
  </dt>
  <dd>
    <p>When verifying stamps multiple resources can be given.  By default the resources are just checked one by one until a matching valid resource is found.  However when you use wildcards or regular expressions (see <em>-E</em>), it is useful to be able to specify that one resource overrides another.  For example this: <em>-b15 -r adam@dev.null -o -b10 *@dev.null</em> states that mail to address <em>adam@dev.null</em> requires 15 bits, but mail to <em>*@dev.null</em> requires only 10 bits.  If we omitted the <em>-o</em> override relationship between the two resources, a stamp of 10 bits would be accepted for address <em>adam@dev.null</em> because while it would be rejected as having insufficient bits under the first rule, it would be accepted under the 2nd rule.  The <em>-o</em> option allows you avoid this problem.</p>
  </dd>
  <dt>
    <em>-e time</em>
  </dt>
  <dd>
    <p>Expiry period for spent stamps.  While checking stamps (using the <em>-c</em> flag), if the stamp was minted more than the specified amount of time ago, it is considered expired.  If this option is not used, by default stamps expire after 28 days.  The expiry period is given in seconds by default (an argument of 0 means forever).  A single character suffix can be used to specify alternate units (m = minutes, h = hours, d = days, M = months, y = Y = years, and s = seconds). If used with the <em>-d</em> option, the spent stamp and its expiry period is recorded in the database.  See the <em>-p</em> option for description of how to purge stamps from the database. While minting stamps, the <em>-e</em> flag can have an effect on the resolution of time created in the stamp.  Without the <em>-e</em> option, the default resolution is days (time format: \s-1YYMMDD\s0).  Alternate formats based on range of expiry period are as follows: While minting you can also given an explicit time width with the <em>-z</em> option instead.  (<em>-z</em> overrides <em>-e</em> if both are given.  If neither are given the default is 6 chars (time format: \s-1YYMMDD\s0)). The rules for automatically determining appropriate time width from <em>-e</em> if no <em>-z</em> option is given are:</p>
<dl class='dl-vertical'>
  <dt>
    * period &gt;= 2 years then time format \s-1YY\s0 is used rounded down to the nearest year start;
  </dt>
  <dd>
    
  </dd>
  <dt>
    * 2 years &lt; period &lt;= 2 months then time format \s-1YYMM\s0 is used rounded down to the nearest month start;
  </dt>
  <dd>
    
  </dd>
  <dt>
    * 2 months &lt; period &lt;= 2 days then time format \s-1YYMMDD\s0 is used rounded down to the begining of the nearest day;
  </dt>
  <dd>
    
  </dd>
  <dt>
    * 2 days &lt; period &lt;= 2 minutes then time format YYMMDDhhmm is used rounded down to the begining of the nearest minute;
  </dt>
  <dd>
    
  </dd>
  <dt>
    * period &lt; 2 minutes then time format YYMMDDhhmmss is used in seconds.
  </dt>
  <dd>
    
  </dd>

</dl>
<p>Note the rounding down is based on \s-1UTC\s0 time, not local time.  This can lead to initially suprising results when rounding down to eg days in time zones other than \s-1GMT\s0 (\s-1UTC\s0 = \s-1GMT\s0).  It may be clearer to understand if you use the <em>-u</em> option.</p>
  </dd>
  <dt>
    <em>-z width</em>
  </dt>
  <dd>
    <p>The <em>-z</em> option is for use during minting and allows user choice of width of time width field.  See also the <em>-e</em> option given in combination with <em>-m</em> to specify an implicit time field width under the description of the <em>-e</em> flag.  Valid widths are 6,10 or 12 chars corresponding respectively to: \s-1YYMMDD\s0, YYMMDDhhmm, and YYMMDDhhmmss rounded down to the nearest day, or minute respectively. Note the rounding down is based on \s-1UTC\s0 time, not local time.  This can lead to initially suprising results when rounding down to eg days in time zones other than \s-1GMT\s0 (\s-1UTC\s0 = \s-1GMT\s0).  It may be clearer to understand if you use the <em>-u</em> option.</p>
  </dd>
  <dt>
    <em>-g period</em>
  </dt>
  <dd>
    <p>The <em>-g</em> option is for use when checking hashcash stamps with the <em>-c</em> option and specifies a grace period for clock skew, ie if a hashcash stamp arrives with a date in the future or in the past it will not be rejected as having a futuristic date (or as being expired) unless it is more futuristic (or has been expired for longer) than this period.  The default is 2 days, which means as long as the sending system's clock is no more than 2 days ahead (or 2 days behind) of the receiving system's clock, the hashcash stamp will still be accepted. The default units for grace period are seconds.  A single character suffix can be used to specify alternate units (m = minutes, h = hours, d = days, M = months, y = Y = years, and s = seconds).</p>
  </dd>
  <dt>
    <em>-d</em>
  </dt>
  <dd>
    <p>Store stamps in a double spend database.  If stamp has been seen before it will be rejected even if it is otherwise valid.  The default database file is <em>database.sdb</em> in the current directory.  Only otherwise valid stamps will be stored in the database.  Only fully validated stamps will be stored in the database, unless the <em>-y</em> option is given.</p>
  </dd>
  <dt>
    <em>-f dbname</em>
  </dt>
  <dd>
    <p>Use <em>dbname</em> instead of default filename for double spend database.</p>
  </dd>
  <dt>
    <em>-p period</em>
  </dt>
  <dd>
    <p>Purges the database of expired stamps if the given time period has passed since the last time it was purged.  As a convenience <em>-p now</em> is equivalent to <em>-p 0</em> both of which mean purge now, regardless of when the database was last purged. If used in combination with <em>-j resource</em> only the stamps minted for the given resource are purged. If used in combination with <em>-k</em> all stamps even un-expired stamps are purged.  Can be used in combination with <em>-t time</em> to expire as if the current time were the given time.</p>
  </dd>
  <dt>
    <em>-k</em>
  </dt>
  <dd>
    <p>Use with option <em>-p</em> to request all stamps are purged rather than just expired ones.</p>
  </dd>
  <dt>
    <em>-j resource</em>
  </dt>
  <dd>
    <p>Use with option <em>-p</em> to request that just stamps matching the given resource name are to be purged, rather than the default which is to purge all expired stamps.  If the resource name is the empty string, all stamps are matched (this is equivalent to omitting the <em>-j</em> option). Note the <em>-E</em>, <em>-M</em> and <em>-S</em> type of match flags also apply to resources given with the <em>-j resource</em> flag.</p>
  </dd>
  <dt>
    <em>-s</em>
  </dt>
  <dd>
    <p>Print timing information only, and don't proceed to create a stamp. If combined with <em>-b bits</em> flag print estimate of how long the requested collision size would take to compute, if <em>-s</em> given by itself, just prints speed of the collision finder.  To print an estimate of how long the default number of bits would take use <em>-b</em> default.</p>
  </dd>
  <dt>
    <em>-h</em>
  </dt>
  <dd>
    <p>Print short usage information.</p>
  </dd>
  <dt>
    <em>-v</em>
  </dt>
  <dd>
    <p>Print more verbose informational output about the stamp minting or verification.  (If -v is the only argument, prints the tool version number.)</p>
  </dd>
  <dt>
    <em>-V</em>
  </dt>
  <dd>
    <p>Prints tool version number.</p>
  </dd>
  <dt>
    <em>-q</em>
  </dt>
  <dd>
    <p>Batch mode.  Prints no information other than output.  This option overrides the <em>-v</em> option.</p>
  </dd>
  <dt>
    <em>-X</em>
  </dt>
  <dd>
    <p>When minting, prints the hashcash email X-header 'X-Hashcash: ' before the stamp.  Without this option just the bare stamp is printed. When checking, after scanning stamps given as arguments, scans stdin for lines starting with the string 'X-Hashcash:', and uses the rest of the matching line as the stamp.  Only the lines up to and ending at the first blank line are scanned (see also <em>-i</em> flag which can be used to override this).  A blank line is the separator used to separate the headers from the body of a mail message or \s-1USENET\s0 article.  This is meant to make it convenient to pipe a mail message or \s-1USENET\s0 article to hashcash on stdin.</p>
  </dd>
  <dt>
    <em>-x extension</em>
  </dt>
  <dd>
    <p>An extension string composed of name value sets.  The extension format is described below in the section on the hashcash stamp format.  This allows users to define their own stamp extensions which are hashed into the stamp, verified by recipients that support them, and ignored by recipients that don't support them.  Note the extension hook mechanism has not yet been implemented.  This will come in a subsequent release.</p>
  </dd>
  <dt>
    <em>-i</em>
  </dt>
  <dd>
    <p>When checking and using the <em>-X</em> flag, ignore the blank line boundary between headers and body of the message, and check for collision in the body too if one is not found in the headers.</p>
  </dd>
  <dt>
    <em>-t time</em>
  </dt>
  <dd>
    <p>Pretend the current time is the time given for purposes of minting stamps, verifying stamps and purging old stamps from the database. Time is given in a format based on \s-1UTCTIME\s0 format YYMMDD[hhmm[ss]]. Time is expressed in local time by default.  Use with <em>-u</em> flag to give time in \s-1UTC\s0 (\s-1GMT\s0). You can also give time relative to the current time by prefixing the argument with + or -.  The default units for relative time are seconds.  A single character suffix can be used to specify alternate units (m = minutes, h = hours, d = days, M = months, y = Y = years, and s = seconds). Note: when time is expressed in local time, if there is daylight savings in your timezone, there are one or two ambiguous hours per year at the time of change from daylight savings time to normal time.</p>
  </dd>
  <dt>
    <em>-u</em>
  </dt>
  <dd>
    <p>Input and output absolute times in \s-1UTC\s0 (\s-1GMT\s0) instead of local time.</p>
  </dd>
  <dt>
    <em>-a period</em>
  </dt>
  <dd>
    <p>Add (or subtract if number is negative) a random value from the current time before minting the stamp.  This hides the time the stamp was created, which may be useful for anonymous users.  Note adding (rather than subtracting) a random time may be risky if the stamp takes less than the added time to arrive as the recipient will reject stamps with time stamps in the future.</p>
  </dd>
  <dt>
    <em>-n</em>
  </dt>
  <dd>
    <p>Print resource name parsed from stamp being verified.  Returns exit code unchecked on exit.</p>
  </dd>
  <dt>
    <em>-l</em>
  </dt>
  <dd>
    <p>Print number of seconds left before stamp expires.  Returns exit code unchecked on exit. Note: the calculation includes the grace period, so can be up to 2 times grace period longer than you might otherwise expect (clock fast but system has to presume it could be slow).  If you want to exclude the grace period add <em>-g0</em> to set grace period to 0 for the calculation.</p>
  </dd>
  <dt>
    <em>-w</em>
  </dt>
  <dd>
    <p>Print number of bits of collision of stamp.  Returns exit code unchecked on exit.</p>
  </dd>
  <dt>
    <em>-y</em>
  </dt>
  <dd>
    <p>Returns success if the stamp is valid even if it is not fully checked. Use with <em>-c</em> where not all of <em>-d</em>, <em>-r</em> are specified to get success exit code on valid but partially checked stamp.  Similarly can use with <em>-n</em>, <em>-l</em>, <em>-w</em> with same effect.</p>
  </dd>
  <dt>
    <em>-M</em>
  </dt>
  <dd>
    <p>When checking stamps, allow wildcard <em>*</em> matching in the resource name to make it simpler to specify multiple email addresses and to allow matching catch-all addresses and addresses including subdomains. This is the default.  See also <em>-S</em>, <em>-E</em> and <em>-C</em></p>
  </dd>
  <dt>
    <em>-S</em>
  </dt>
  <dd>
    <p>When checking stamps use simple text compare to compare resource names to those in stamps.  See also <em>-M</em>, <em>-E</em> and <em>-C</em>.</p>
  </dd>
  <dt>
    <em>-E</em>
  </dt>
  <dd>
    <p>When checking stamps use regular expressions to specify resource names to make it simpler to specify multiple email addresses, catch-all addresses, classes of extension addresses and addresses including subdomains.  Note regular expression syntax is \s-1POSIX\s0 style: special characters do not need to be quoted to have their special meaning; but they do have to be quoted with &#92; to that character in the searched string.  The regular expression automatically has ^ added at the beginning and $ added at the end, if they are not specified.  The special characters ^ matches the beginning of the resouce, and $ matches the end of resource. (Note even if compiled with \s-1BSD\s0 regular expressions, \s-1POSIX\s0 style syntax is used; also note \s-1BSD\s0 regular expressions do not support ranges {}.)</p>
  </dd>
  <dt>
    <em>-C</em>
  </dt>
  <dd>
    <p>By default resources are canonicalized to lower case on minting and on checking.  The <em>-C</em> flag overrides this so that resources are treated as case sensitive on checking, and not canonizalized on minting.</p>
  </dd>
  <dt>
    <em>-P</em>
  </dt>
  <dd>
    <p>Print progress info (number of iterations, expected iterations, percentage done, best stamp size found so far).</p>
  </dd>
  <dt>
    <em>-O core</em>
  </dt>
  <dd>
    <p>Select hashcash core with that number.  Currently 0-9 are valid cores. Not all cores work on all architectures.  Eg some are x86 specific assembler, others \s-1PPC\s0 specific assembler.  If a core is not valid hashcash returns failure and explains what happened.</p>
  </dd>
  <dt>
    <em>-Z n</em>
  </dt>
  <dd>
    <p>Compress the stamp.  This is a time vs space trade off.  Larger stamps are faster, but arguably slightly ugly.  For fastest stamps (the default) use -Z 0; for partly compressed stamps use -Z 1; for very compressed, but somewhat slow stamps use -Z 2.  (Note: due to a late discovered bug, -Z2 is the same as -Z1 for now until I can fix that.)</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Print timing information about how many collisions the machine can try per second. More accurate but quite slow benchmarking of different processor specific minting cores. Print how long it would take the machine to compute a default sized collision (but don't actually compute a collision). Print how long it would take the machine to compute a 32 bit collision (but don't actually compute a collision). Mint a stamp.  Will prompt for resource name and mint with default value (number of collision bits). Compute collision on resource foo.  Will mint with default value (number of collision bits). Compute 10 bit collision on resource foo. Subtract a random time of between 0 days and 3 days from the stamp's creation time.  This is the same fuzz factor used by mixmaster to reduce risk of timing-correlations. Report the value of the stamp (how many bits of collision) there are. The example is a 24 bit collision, which takes on average 25 seconds to create on a 3Ghz P4. Create a stamp in batch mode, pass to hashcash on stdin to verify, have it print how many bits there were. Report the resource name from the stamp.  The resource name in the example is foo. Report how long until the stamp expires if it expires in 30 years from its creation date.  (Note dates too far into the future run into the 2038 end of Epoch, which is the unix time analog of the y2k bug). Check if the stamp is valid.  Note as we are not checking the stamp in a double spend database, and did not specify a resource name or required number of bits of collision and hashcash will consider the stamp not fully checked, and it will report it as valid but not fully unchecked, or as invalid if there is any problem with the stamp. Check that the value of the stamp is greater or equal to 24 bits. This example has 24 bit value.  If you increase the requested number of bits or replace the stamp with one with less than 24 bit collision the stamp will be rejected. As above check if the stamp has sufficient value, but in addition check that the resource name given matches the resource name in the stamp. The examples given in \*(L"Verifying Stamps\*(R" can be modified to keep a double spend database so that the same stamp will not be accepted twice.  Note a stamp will only be checked in and added to the database if it is otherwise valid and fully checked (a required number of bits of collision has been specified and a resource has been specified). Check the stamp and add to double spent database if it's valid (has correct resource name and sufficient value). Try to double spend the stamp.  It will be rejected as double spent. To prevent the double spend database growing indefinately, the recipient can request that stamps be no older than a specified period. After expiry old stamps can dropped from the double spend database as they will no longer be needed \*(-- expired stamps can be rejected based purely on their old date, so the space taken by expired stamps in the double spend database can be saved without risk of accepting an expired though otherwise valid stamp.</p><p>The third field of the stamp is the \s-1UTC\s0 time since 1st January 1970. The default time format is \s-1YYMMDD\s0, time rounded down to the nearest day.  The default validity period is 28 days.</p><p>You can provide an alternative validity period with the <em>-e</em> option. Try verifying an old stamp, the above stamp was created 11 Aug 2002. We gave option <em>-e 2d</em> so the stamps expiry date is 2 days after creation, which is now in the past. Note: if the creation time is expressed in the stamp in days, the precise creation date is the begining of the specified day in \s-1UTC\s0 time (similarly for alternate units the creation time is rounded down to the begining of the unit it is expressed in).  For units in days, for example, this may mean depending on your time zone that the stamp appears to be considered invalid in under the specified expiry period in days relative to your relative view of what day it is, as the calculation is based on current time in \s-1UTC\s0, and the creation time of the stamp is expressed in \s-1UTC\s0 time. Test whether the stamp is otherwise valid, apart from having expired. Omitting the <em>-e</em> tells hashcash that the stamp will never expire. An expiry period of forever can also be given explitly like this: <em>-e</em> 0, where an expiry period of 0 means forever. If the <em>-c</em>, <em>-d</em> options are used together, each time a stamp is checked, if it is valid and all of the mandatory aspects of the stamp are verified (collision bits check, resource name check) then the stamp and its expiry period is written to the database file.  The default expiry period if an expiry period is not given explicitly with the <em>-e</em> option is 28 days (ie stamps expire after 4 weeks).</p><p>First mint and then add a stamp: Note: we specified an expiry on minting in this example, to ensure that the stamp creation time is given in high enough resolution in the stamp that the stamp will not be considered expired at time of creation.  (Recall the default resolution is in days, a stamp created with a creation time rounded down to the beginging of the day is unlikely to be considered valid 1 minute later unless you mint it at midnight \s-1UTC\s0 time.) The stamp expires in 1 minute.  Wait 1 minute and then explicitly request that expired stamps be purged: Then try resubmitting the same stamp: and the stamp will be rejected anyway as it has expired, illustrating why it was not necessary to keep this stamp in the database. With the default database (the sdb format) the database contents are human readable, so you can view their contents by cating them to the terminal: to see that the stamp really is added and then after puring subsequently purged due to expiry. As a convenience you can purge at the same time as checking stamps by using the <em>-p</em> option with the <em>-c</em> option. It may be inefficient to purge stamps on every use as the entire database has to be scanned for expired stamps.  By giving a time period to the <em>-p</em> option, you can tell \*(C`hashcash\*(C' to purge no more frequently than that time period since the previous purge. For example: tells \*(C`hashcash\*(C' to purge any expired stamps no more than once per day. tells \*(C`hashcash\*(C' to purge only expired stamps matching resource foo once per month. tells \*(C`hashcash\*(C' to purge all stamps (expired and unexpired) now.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">stamp format (version 1)</h2>
        <div class="sectioncontent">
<p>The current stamp format is version 1.  This tool can verify hashcash version 0 stamps also, but version 0 stamps are no longer created as they are being phased out in favor of the more extensible v1 stamp format.</p>
<dl class='dl-vertical'>
  <dt>
    <em>ver</em>:<em>bits</em>:<em>date</em>:<em>resource</em>:[<em>ext</em>]:<em>rand</em>:<em>counter</em>
  </dt>
  <dd>
    
  </dd>

</dl>
<p>where</p>
<dl class='dl-vertical'>
  <dt>
    <em>ver</em> = 1
  </dt>
  <dd>
    
  </dd>
  <dt>
    <em>bits</em> = how many bits of partial-collision the stamp is claimed to have
  </dt>
  <dd>
    
  </dd>
  <dt>
    <em>date</em> = YYMMDD[hhmm[ss]]
  </dt>
  <dd>
    
  </dd>
  <dt>
    <em>resource</em> = resource string (eg \s-1IP\s0 address, email address)
  </dt>
  <dd>
    
  </dd>
  <dt>
    <em>ext</em> = extension \*(-- ignored in the current version
  </dt>
  <dd>
    <p>Format of extension:</p>
<dl class='dl-vertical'>
  <dt>
    [name1[=val1[,val2...]];[name2[=val1[,val2...]]...]]
  </dt>
  <dd>
    <p>Note the value can also contain =.  Example extension (not a real one):</p>
<pre>
        name1=2,3;name2;name3=var1=2,var2=3,2,val
</pre>
<p>Which would be extension name1 has values 2 and 3; extension name2 has no values; extension name3 has 3 values \*(L"var1=2\*(R", \*(L"var2=3\*(R", \*(L"2\*(R" and \*(L"val\*(R".  The hashcash extension may interpret the values as it sees fit eg \*(L"var1=2\*(R" could be the value of an option to the extension name3.</p>
  </dd>

</dl>

  </dd>
  <dt>
    <em>rand</em> = string of random characters from alphabet a-zA-Z0-9+/= to avoid collisions with other sender's stamps
  </dt>
  <dd>
    
  </dd>
  <dt>
    <em>counter</em> = to find a stamp with the desired number of collision bits need to try lots of different strings this counter is incremented on each try. The Counter is also composed of characters from the alphabet a-zA-Z0-9+/=.  (Note an implementation is not required to count sequentially).
  </dt>
  <dd>
    
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <em>hashcash.sdb</em>
  </dt>
  <dd>
    <p>default double spend database</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">
<p>\*(C`hashcash\*(C' returns success (exit code 0) after successfully minting a stamp, after fully checking a stamp and finding it valid, and after a timing test.</p><p>If when checking a stamp it is found to be invalid (due to being malformed, being expired, having insufficient value, having a date in the future, or being double spent), \*(C`hashcash\*(C' returns failure (exit code 1).</p><p>If insufficient options are given to fully check a stamp, if the stamp is otherwise valid return unchecked (exit code 2).  If the <em>-y</em> flag is given and hashcash would normally return unchecked, exit code success is returned instead.</p><p>If any exception occurs (file read failure for database checking or corrupted database contents) an exit status of 3 is returned.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Written by Adam Back &lt;adam@cypherspace.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO hashcash&hellip;</h2>
        <div class="sectioncontent">
<p><em>sha1sum</em>\|(1), <em>sha1</em>\|(1), http://www.hashcash.org/</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="hashalot.1.html"><span aria-hidden="true">&larr;</span> hashalot.1: Read a passphrase and print a hash</a></li>
   <li class="next"><a href="hashdeep.1.html">hashdeep.1: Compute, compare, or audit multiple message digests <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
