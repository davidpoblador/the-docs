<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>frag6: A security assessment tool for ipv6 fragmentation</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A security assessment tool for ipv6 fragmentation">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="frag6 (1) manual">
  <meta name="twitter:description" content="A security assessment tool for ipv6 fragmentation">
  <meta name="twitter:image" content="https://www.carta.tech/images/ipv6toolkit-frag6-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/frag6.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="frag6 (1) manual" />
  <meta property="og:description" content="A security assessment tool for ipv6 fragmentation" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/ipv6toolkit-frag6-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">frag6<small> (1)</small></h1>
        <p class="lead">A security assessment tool for ipv6 fragmentation</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/frag6.1.html">
      <span itemprop="name">frag6: A security assessment tool for ipv6 fragmentation</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/ipv6toolkit/">
      <span itemprop="name">ipv6toolkit</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/frag6.1.html">
      <span itemprop="name">frag6: A security assessment tool for ipv6 fragmentation</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>frag6</strong> [\|<strong>-i</strong> <em>INTERFACE\|</em>] -d DST_ADDR [-S LINK_SRC_ADDR] [-D LINK-DST-ADDR] [-s SRC_ADDR[/LEN]] [-A HOP_LIMIT] [-u DST_OPT_HDR_SIZE] [-U DST_OPT_U_HDR_SIZE] [-H HBH_OPT_HDR_SIZE] [-P FRAG_SIZE] [-O FRAG_TYPE] [-o FRAG_OFFSET] [-I FRAG_ID] [-T] [-n] [-p | -W | -X | -F N_FRAGS] [-l] [-z SECONDS] [-v] [-h]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>frag6</strong> is a security assessment tool for attack vectors based on IPv6 fragments. It is part of the SI6 Networks' IPv6 Toolkit: a security assessment and trouble-shooting suite for the IPv6 protocols.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p><strong>frag6</strong> takes it parameters as command-line options. Each of the options can be specified with a short name (one character preceded with the hyphen character, as e.g. "-i") or with a long name (a string preceded with two hyphen characters, as e.g. "--interface").</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-i</strong><em>INTERFACE</em><strong>,</strong><em>--interface</em><strong>INTERFACE</strong></p>
  </dt>
  <dd>
    <p>This option specifies the network interface that the tool will use. If the destination address ("-d" option) is a link-local address, the interface must be explicitly specified. The interface may also be specified along with a destination address, with the "-d" option.</p>
  </dd>
  <dt>
    <p><strong>-S</strong><em>SRC_LINK_ADDR</em><strong>,</strong><em>--src-link-address</em><strong>SRC_LINK_ADDR</strong></p>
  </dt>
  <dd>
    <p>This option specifies the link-layer Source Address of the probe packets. If left unspecified, the link-layer Source Address of the packets is set to the real link-layer address of the network interface.</p>
  </dd>
  <dt>
    <p><strong>-D</strong><em>DST_LINK_ADDR</em><strong>,</strong><em>--dst-link-address</em><strong>DST_LINK_ADDR</strong></p>
  </dt>
  <dd>
    <p>This option specifies the link-layer Destination Address of the probe packets. By default, the link-layer Destination Address is automatically set to the link-layer address of the destination host (for on-link destinations) or to the link-layer address of the first-hop router.</p>
  </dd>
  <dt>
    <p><strong>-s</strong><em>SRC_ADDR</em><strong>,</strong><em>--src-address</em><strong>SRC_ADDR</strong></p>
  </dt>
  <dd>
    <p>This option specifies the IPv6 source address (or IPv6 prefix) to be used for the Source Address of the outgoing packets. If an IPv6 prefix is specified, the IPv6 Source Address of the outgoing packets will be randomized from that prefix.</p>
  </dd>
  <dt>
    <p><strong>-d</strong><em>DST_ADDR</em><strong>,</strong><em>--dst-address</em><strong>DST_ADDR</strong></p>
  </dt>
  <dd>
    <p>This option specifies the IPv6 Destination Address of the target node. This option cannot be left unspecified.</p>
  </dd>
  <dt>
    <p><strong>-A</strong><em>HOP_LIMIT</em><strong>,</strong><em>--hop-limit</em><strong>HOP_LIMIT</strong></p>
  </dt>
  <dd>
    <p>This option specifies the Hop Limit to be used for the IPv6 packets. By default, the Hop Limit is randomized.</p>
  </dd>
  <dt>
    <p><strong>-u</strong><em>HDR_SIZE</em><strong>,</strong><em>--dst-opt-hdr</em><strong>HDR_SIZE</strong></p>
  </dt>
  <dd>
    <p>This option specifies that a Destination Options header is to be included in the outgoing packet(s). The extension header size must be specified as an argument to this option (the header is filled with padding options). Multiple Destination Options headers may be specified by means of multiple "-u" options.</p>
  </dd>
  <dt>
    <p><strong>-U</strong><em>HDR_SIZE</em><strong>,</strong><em>--dst-opt-u-hdr</em><strong>HDR_SIZE</strong></p>
  </dt>
  <dd>
    <p>This option specifies a Destination Options header to be included in the "unfragmentable part" of the outgoing packet(s). The header size must be specified as an argument to this option (the header is filled with padding options). Multiple Destination Options headers may be specified by means of multiple "-U" options.</p>
  </dd>
  <dt>
    <p><strong>-H</strong><em>HDR_SIZE</em><strong>,</strong><em>--hbh-opt-hdr</em><strong>HDR_SIZE</strong></p>
  </dt>
  <dd>
    <p>This option specifies that a Hop-by-Hop Options header is to be included in the outgoing packet(s). The header size must be specified as an argument to this option (the header is filled with padding options). Multiple Hop-by-Hop Options headers may be specified by means of multiple "-H" options.</p>
  </dd>
  <dt>
    <p><strong>-P</strong><em>FRAG_SIZE</em><strong>,</strong><em>--frag-size</em><strong>FRAG_SIZE</strong></p>
  </dt>
  <dd>
    <p>This option specifies the IPv6 fragment payload size.</p>
  </dd>
  <dt>
    <p><strong>-O</strong><em>FRAG_TYPE</em><strong>,</strong><em>--frag-type</em><strong>FRAG_TYPE</strong></p>
  </dt>
  <dd>
    <p>This option specifies the fragment "type". Possible types are "first", "middle", "last", and "atomic". If the selected fragment type is "first", the Fragment Offset is automatically set to 0, and the "M" ("More fragments") bit is set to 1. If the selected fragment type is "middle", the Fragment Offset is set to a non-zero value, and the "M" bit is set to 1. If the selected fragment type is "last", the Fragment Offset is set to a non-zero value, and the "M" bit is set to 0. Finally, if the selected fragment type is "atomic", the Fragment Offset is set to 0, and the "M" bit is set to 0.</p>
  </dd>
  <dt>
    <p><strong>-o</strong><em>FRAG_OFFSET</em><strong>,</strong><em>--frag-offset</em><strong>FRAG_OFFSET</strong></p>
  </dt>
  <dd>
    <p>This option specifies the Fragment Offset. The Fragment Offset specified by means of this option overrides the value implicitly specified by means of the "-O" option.</p>
  </dd>
  <dt>
    <p><strong>-I</strong><em>FRAG_ID</em><strong>,</strong><em>--frag-id</em><strong>FRAG_ID</strong></p>
  </dt>
  <dd>
    <p>This option specifies the fragment "Identification" value. If left unspecified, the "Identification" value is randomized.</p>
  </dd>
  <dt>
    <p><strong>-T\|</strong>,<strong>--no-timestamp</strong></p>
  </dt>
  <dd>
    <p>When assessing the fragment reassembly policy of a target, the fragment payload includes a timestamp value that is used to measure the fragment reassembly timeout. If this option is set, such timestamp will not be included in the payload (and the tool will not be able to measure the fragment reassembly timeout).</p>
  </dd>
  <dt>
    <p><strong>-n\|</strong>,<strong>--no-responses</strong></p>
  </dt>
  <dd>
    <p>This option instructs the frag6 tool not to display the responses to the fragments sent. This option is useful when performing a fragmentation-flooding attack, as multiple response packets (ICMPv6 errors) might be received.</p>
  </dd>
  <dt>
    <p><strong>-p\|</strong>,<strong>--frag-reass-policy</strong></p>
  </dt>
  <dd>
    <p>This option instructs the tool to determine the IPv6 fragment reassembly policy of the target. In order to determine the aforementioned policy, the tool performs a number of tests to determine how the target node processes overlapping fragments. The following figures illustrate the sequence of packets that correspond to each of the tests.</p>
  </dd>
  <dt>
    <p><strong>       Test #1</strong></p>
  </dt>
  <dd>
    
<pre>
          Frag. #1:  AAAAAAAAAAA
          Frag. #2:         BBBBBBBBBBB
</pre>
<p><strong>       Test #2</strong></p>
<pre>
          Frag. #1:  AAAAAAAAAA
          Frag. #2:                    BBBBBBBBBBB
          Frag. #3:         CCCCCCCCCCC
</pre>
<p><strong>       Test #3</strong></p>
<pre>
          Frag. #1:  AAAAAAAAAA
          Frag. #2:                    BBBBBBBBBBB
          Frag. #3:            CCCCCCCCCCC
</pre>
<p><strong>       Test #4</strong></p>
<pre>
          Frag. #1:  AAAAAAAAAA
          Frag. #2:                    BBBBBBBBBBB
          Frag. #3:            CCCCCCCCCCCCCCCCCCCCCCCCCC
</pre>
<p><strong>       Test #5</strong></p>
<pre>
          Frag. #1:  AAAAAAAAAA
          Frag. #2:                    BBBBBBBBBBB
          Frag. #3:                           CCCCCCCCCCC
          Frag. #4:            DDDDDDDD
</pre>

  </dd>
  <dt>
    
<pre>
   For each of the aforementioned tests, the tool reports which
   copy of the data is used by the target host. If there is no
   response from the host, the tool informs whether the host
   silently dropped the fragments, or sent an ICMPv6 Time
   Exceeded error message.
</pre>

  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>-W\|</strong>,<strong>--frag-id-policy</strong></p>
  </dt>
  <dd>
    <p>This option instructs the tool to determine the fragment "Identification" generation policy. The tool sends a number of probe packets to the target node, and samples the "Identification" values of the corresponding response packets. Based on the sampled values, it tries to infer the fragment Identification generation policy of the target.</p><p>The tool will first send a number of fragments from single IPv6 address, such that the per-destination policy is determined. The tool will then send a number of fragments from random IPv6 addresses (from the same prefix as the first fragments) such that the "global" fragment Identification generation policy can be inferred.</p><p>The tool computes the expected value and the standard deviation of the difference between consecutive-sampled Identification values (IDn â€“ IDn-1), with the intent of inferring the fragment Identification algorithm at the target node.</p><p>For small values of the standard deviation, the fragment Identification is assumed to be a monotonically-increasing function with increments of the "expected value". For large values of the standard deviation, the fragment Identification is assumed to be randomized, and the expected value and standard deviation are informed to the user, as indicators of the "quality" of the fragment Identification generation algorithm.</p>
  </dd>
  <dt>
    <p><strong>-X\|</strong>,<strong>--pod-attack</strong></p>
  </dt>
  <dd>
    <p>This option instructs the tool to perform a "Ping of Death" attack against the specified target.</p>
  </dd>
  <dt>
    <p><strong>-F</strong><em>FRAG_NUMBER</em><strong>,</strong><em>--flood-frags</em><strong>FRAG_NUMBER</strong></p>
  </dt>
  <dd>
    <p>This option instructs the tool to send the specified number of fragments back-to-back to the target node. This option is likely to be used in conjunction with the "-l" option, such that the process is repeated in a loop.</p>
  </dd>
  <dt>
    <p><strong>-l\|</strong>,<strong>--loop</strong></p>
  </dt>
  <dd>
    <p>This option instructs the frag6 tool to periodically send IPv6 fragments to the target node. The amount of time to pause between sending a batch of fragments can be specified by means of the "-z" option, and defaults to 1 second.</p>
  </dd>
  <dt>
    <p><strong>-z</strong><em>SECONDS</em><strong>,</strong><em>--sleep</em><strong>SECONDS</strong></p>
  </dt>
  <dd>
    <p>This option specifies the amount of time that the tool should pause between sending btaches of IPv6 fragments (when the "--loop" option is set). If left unspecified, it defaults to 1 second.</p>
  </dd>
  <dt>
    <p><strong>-v\|</strong>,<strong>--verbose</strong></p>
  </dt>
  <dd>
    <p>This option instructs the frag6 tool to be verbose.  If this option is set twice and the -W option was set, the tool outputs the sampled Fragment Identification values (in addition to other information).</p>
  </dd>
  <dt>
    <p><strong>-h\|</strong>,<strong>--help</strong></p>
  </dt>
  <dd>
    <p>Print help information for the <strong>frag6</strong> tool.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>The following sections illustrate typical use cases of the <strong>frag6</strong> tool.</p><p><strong>Example #1</strong></p><p># frag6 --frag-id-policy -d fc00:1::1 -v</p><p>Assess the fragment Identification generation policy of the host "fc00:1::1". Be verbose.</p><p><strong>Example #2</strong></p><p># frag6 --frag-reass-policy -d fc00:1::1 -v</p><p>Assess the fragment reassembly policy of the host "fc00:1::1". Be verbose.</p><p><strong>Example #3</strong></p><p># frag6 --frag-type atomic -d fc00:1::1 -v</p><p>Send an IPv6 atomic fragment to the host "fc00:1::1". Be verbose.</p><p><strong>Example #4</strong></p><p># frag6 -s ::/0 --flood-frags 100 -l -z 5 -d fc00:1::1 -v</p><p>Send 100 fragments (every 5 seconds) to the host fc00:1::1, using a forged IPv6 Source Address from the prefix ::/0. The aforementioned fragments should have an offset of 0, and the M bit set (i.e., be first-fragments). Be verbose.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>The <strong>frag6</strong> tool and the corresponding manual pages were produced by Fernando Gont &lt;fgont@si6networks.com&gt; for SI6 Networks &lt;http://www.si6networks.com&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (c) 2011-2013 Fernando Gont.</p><p>Permission is granted to copy, distribute and/or modify this document under the terms of the GNU Free Documentation License, Version 1.3 or any later version published by the Free Software Foundation; with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A copy of the license is available at <em>&lt;http://www.gnu.org/licenses/fdl.html&gt;</em>.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="fractalnow.1.html"><span aria-hidden="true">&larr;</span> fractalnow.1: Generate fractal images.</a></li>
   <li class="next"><a href="frama-c.1.html">frama-c.1: A static analyzer for c programs  frama-c-gui[.byte] - the graphical interface of frama-c <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
