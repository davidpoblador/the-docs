<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>spamprobe: A bayesian spam filter</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A bayesian spam filter">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="spamprobe (1) manual">
  <meta name="twitter:description" content="A bayesian spam filter">
  <meta name="twitter:image" content="https://www.carta.tech/images/spamprobe-spamprobe-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/spamprobe.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="spamprobe (1) manual" />
  <meta property="og:description" content="A bayesian spam filter" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/spamprobe-spamprobe-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">spamprobe<small> (1)</small></h1>
        <p class="lead">A bayesian spam filter</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/spamprobe.1.html">
      <span itemprop="name">spamprobe: A bayesian spam filter</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/spamprobe/">
      <span itemprop="name">spamprobe</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/spamprobe.1.html">
      <span itemprop="name">spamprobe: A bayesian spam filter</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>spamprobe</strong> [<em>options</em>] <em>&nbsp;command&nbsp;</em> [<em>files</em>&nbsp;...]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>SpamProbe is a spam filter relying on a Bayesian analysis of the frequency of words used in spam and non-spam emails received by an individual person. The process is completely automatic and tailors itself to the kinds of emails that each person receives.</p><p>SpamProbe recognizes and decodes MIME attachments in quoted-printable and base64 encoding. Image attachments are considered as words that can signal a spam. By default, it ignores HTML tags for scoring purpose.</p><p>SpamProbe supports MBOX, MBX and Maildir mailbox formats. These formats are automatically detected for mailboxes used as parameters of SpamProbe commands.</p><p><strong>spamprobe</strong> is designed to be used in mail delivery agents (MDAs) like <strong>procmail</strong>(1) or <a href="../man1/maildrop.1.html"><strong>maildrop</strong>(1)</a> to help in identifying spam.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>The recognized options are:</p><p><strong>-a </strong><strong></strong><em>char</em></p><p>By default SpamProbe converts non-ascii characters (characters with the most significant bit set to 1) into the letter &apos;z&apos;. This is useful for lumping all Asian characters into a single word for easy recognition. The -a option allows you to change the character to something else if you don&apos;t like the letter &apos;z&apos; for some reason.</p><p><strong>-c</strong></p><p>Tells SpamProbe to create the database directory if it does not already exist. Normally SpamProbe exits with a usage error if the database directory does not already exist.</p><p><strong>-C </strong><strong></strong><em>number</em></p><p>Tells SpamProbe to assign a default, somewhat neutral, probability to any term that does not have a weighted (good count doubled) count of at least <em>number </em>in the database. This prevents terms which have been seen only a few times from having an unreasonable influence on the score of an email containing them.</p><p>The default value is 5. For example if <em>number </em>is 5 then in order for a term to use its calculated probability it must have been seen 3 times in good mails, or 2 times in good mails and once in spam, or 5 times in spam, or some other combination adding up to at least 5.</p><p><strong>-d </strong><strong></strong><em>[type:]directory</em><strong> </strong></p><p>By default SpamProbe stores its database in a directory named .spamprobe under your home directory. The <strong>-d</strong> option allows you to specify a different directory to use. This is necessary if your home directory is NFS mounted for example.</p><p>The directory name can be prefixed with a special code to force SpamProbe to use a particular type of data file format. Defined types include:</p><p><strong>-d bdb:path</strong></p><p>Forces the use of Berkeley DB data file.</p><p><strong>-d hash:path</strong></p><p>Forces the use of an mmapped hash file.</p><p><strong>-d split:path</strong></p><p>Forces the use of a hash file and ISAM file (may provide better precision than plain hash in some cases).</p><p>The <em>hash:</em> option can also specify a desired file size in megabytes before the path. For example <strong>-d hash:19:path</strong> would cause SpamProbe to use a 19 MB hash file. The size must be in the range of 1-100. The default hash file size is 16 MB. Because hash files have a fixed size and capacity they should be cleaned relatively often using the <strong>cleanup</strong> command (see below) to prevent them from becoming full or being slowed by too many hash key collisions.</p><p>Hash files provide better performance than Berkeley DB. However hash files do not store the original terms. Only a 32 bit hash key is stored with each term. This prevents a user from exploring the terms in the database using the dump command to see what words are particularly spammy or hammy. The default data file format is Berkeley BD (bdb).</p><p><strong>-D </strong><strong></strong><em>directory</em></p><p>Tells SpamProbe to use the database in the specified directory (must be different than the one specified with the <strong>-d </strong>option) as a shared database from which to draw terms that are not defined in the user&apos;s own database. This can be used to provide a baseline database shared by all users on a system (in the <strong>-D </strong> directory) and a private database unique to each user of the system ($HOME/.spamprobe or <strong>-d</strong> directory).</p><p><strong>-g </strong><strong></strong><em>fieldname</em></p><p>Tells SpamProbe what header to look for previous score and message digest in. Default is X-SpamProbe. Field name is not case sensitive. Used by all commands except <strong>receive</strong>.</p><p><strong>-h</strong></p><p>By default SpamProbe removes HTML markup from the text in emails to help avoid false positives. The <strong>-h</strong> option allows you to override this behavior and force SpamProbe to include words from within HTML tags in its word counts. Note that SpamProbe always counts any URLs in hrefs within tags whether <strong>-h</strong> is used or not. Use of this option is discouraged. It can increase the rate of spam detection slightly but unless the user receives a significant amount of HTML emails it also tends to increase the number of false positives.</p><p><strong>-H </strong><strong></strong><em>option</em></p><p>By default SpamProbe only scans a meaningful subset of headers from the email message when searching for words to score. The <strong>-H</strong> option allows the user to specify additional headers to scan. Legal values are <strong>all</strong>, <strong>nox</strong>, <strong>none</strong>, or <strong>normal</strong>. <strong>all</strong> scans all headers, <strong>nox </strong>scans all headers except those starting with X-, <strong>none </strong>does not scan headers, and <strong>normal </strong>scans the normal set of headers.</p><p>In addition to those values you can also explicitly add a header to the list of headers to process by adding the header name in lower case preceded by a plus sign. Multiple headers can be specified by using multiple <strong>-H </strong>options. For example, to include only the <strong>From</strong> and <strong>Received</strong> headers in your <strong>train</strong> command you could run SpamProbe as follows:</p>
<pre>
spamprobe -Hnone -H+from -H+received train
</pre>
<p>To process the normal set of headers but also add the SpamAssassin header X-SpamStatus you could run SpamProbe as follows:</p>
<pre>
spamprobe -H+x-spam-status train
</pre>
<p><strong>-l </strong><strong></strong><em>number</em></p><p>Changes the spam probability threshold for emails from the default (<strong>0.7</strong>) to <em>number</em>. The number must be a value between 0 and 1. Generally the value should be above 0.5 to avoid a high false positive rate. Lower numbers tend to produce more false positives while higher numbers tend to reduce accuracy.</p><p><strong>-m</strong></p><p>Forces SpamProbe to use mbox format for reading emails in <strong>receive</strong> mode. Normally SpamProbe assumes that the input to <strong>receive</strong> mode contains a single message so it doesn&apos;t look for message breaks.</p><p><strong>-M</strong></p><p>Forces SpamProbe to treat the entire input as a single message. This ignores <strong>From</strong> lines and <strong>Content-Length</strong> headers in the input.</p><p><strong>-o </strong><strong></strong><em>option</em></p><p>Enables special options by name. Currently the only special options are:</p><p><strong>-o graham</strong></p><p>Causes SpamProbe to emulate the filtering algorithm originally outlined in [A Plan For Spam].</p><p><strong>-o honor-status-header</strong></p><p>Causes SpamProbe to ignore messages if they have a Status: header containing a capital D. Some mail servers use this status to indicate a message that has been flagged for deletion but has not yet been purged from the file.</p><p>DO NOT use this option with the receive or train command in your procmailrc file! Doing so could allow spammers to bypass the filter. This option is meant to be used with the <strong>train-spam</strong> and <strong>train-good</strong> commands in scripts that periodically update the database.</p><p><strong>-o orig-score</strong></p><p>Causes SpamProbe to use its original scoring algorithm that produces excellent results but tends to generate scores of either 0 or 1 for all messages.</p><p><strong>-o suspicious-tags</strong></p><p>Causes SpamProbe to scan the contents of &ldquo;suspicious&rdquo; tags for tokens rather than simply throwing them out. Currently only font tags are scanned but other tags may be added to this list in later versions.</p><p><strong>-o tokenized</strong></p><p>Causes SpamProbe to read tokens one per line rather than processing the input as mail format. This allows users to completely replace the standard SpamProbe tokenizer if they wish and instead use some external program as a tokenizer.</p><p>In this mode SpamProbe considers a blank line to indicate the end of one message&apos;s tokens and the start of a new message&apos;s tokens. SpamProbe computes a message digest based on the lines of text containing the tokens.</p><p>The <strong>-o</strong> option can be used multiple times and all requested options will be applied. Note that some options might conflict with each other in which case the last option would take precedence.</p><p><strong>-p </strong><strong></strong><em>number</em></p><p>Changes the maximum number of words per phrase. Default value is two. Increasing the limit improves accuracy somewhat but increases database size. Experiments indicate that increasing beyond two is not worth the extra cost in space.</p><p><strong>-P </strong><strong></strong><em>number</em></p><p>Causes SpamProbe to perform a purge of all terms with junk count less than or equal 2 after every number messages are processed. Using this option when classifying a large collection of spam can prevent the database from growing overly large at the cost of more processing time and possible loss of precision.</p><p><strong>-r </strong><strong></strong><em>number</em></p><p>Changes the number of times that a single word/phrase can occur in the top words array used to calculate the score for each message. Allowing repeats reduces the number of words overall (since a single word occupies more than one slot) but allows words which occur frequently in the message to have a higher weight. Generally this is changed only for optimization purposes.</p><p><strong>-R</strong></p><p>Causes SpamProbe to treat the input as a single message and to base its exit code on whether or not that message was spam. The exit code will be 0 if the message was spam or 1 if the message was good.</p><p><strong>-s </strong><strong></strong><em>number</em></p><p>SpamProbe maintains an in memory cache of the words it has seen in previous messages to reduce disk I/O and improve performance. By default the cache will contain the most recently accessed 2,500 terms. This number can be changed using the <strong>-s</strong> option. Using a larger the cache size will cause SpamProbe to use more memory and, potentially, to perform less database I/O. A value of zero causes SpamProbe to use 100,000 as the limit which effectively means that the cache will only be flushed at program exit (unless you have really enormous mailbox files). The cache doesn&apos;t affect receive, dump, or export but has a significant impact on the others.</p><p><strong>-T</strong></p><p>Causes SpamProbe to write out the top terms associated with each message in addition to its normal output. Works with <strong>find-good</strong>, <strong>find-spam</strong>, and <strong>score</strong>.</p><p><strong>-v</strong></p><p>When it appears once on the command line this option tells SpamProbe to write verbose information during processing. When it appears twice on the command line this option tells SpamProbe to write debugging information to stderr. This can be useful for debugging or for seeing which terms SpamProbe used to score each email.</p><p><strong>-V</strong></p><p>Prints version and copyright information and then exits.</p><p><strong>-w </strong><strong></strong><em>number</em></p><p>Changes the number of most significant words/phrases used by SpamProbe to calculate the score for each message. Generally this is changed only for optimization purposes.</p><p><strong>-x</strong></p><p>Normally SpamProbe uses only a fixed number of top terms (as set by the <strong>-w</strong> command line option) when scoring emails. The <strong>-x</strong> option can be used to allow the array to be extended past the max size if more terms are available with probabilities &lt;= 0.1 or &gt;= 0.9.</p><p><strong>-X</strong></p><p>An interesting variation on the scoring settings. Equivalent to using <strong>-w5 -r5 -x</strong> so that generally only words with probabilites &lt;= 0.1 or &gt;= 0.9 are used and word frequencies in the email count heavily towards the score. Tests have shown that this setting tends to be safer (fewer false positives) and have higher recall (proper classification of spams previously scored as spam) although its predictive power isn&apos;t quite as good as the default settings. WARNING: This setting might work best with a fairly large corpus, it has not been tested with a small corpus so it might be very inaccurate with fewer than 1000 total messages.</p><p><strong>-Y</strong></p><p>Assume traditional Berkeley mailbox format, ignoring any Content-Length: fields.</p><p><strong>-7</strong></p><p>Tells SpamProbe to ignore any characters with the most significant bit set to 1 instead of mapping them to the letter &apos;z&apos;.</p><p><strong>-8</strong></p><p>Tells SpamProbe to store all characters even if their most significant bit is set to 1.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMMANDS</h2>
        <div class="sectioncontent">
<p>SpamProbe recognizes the following commands:</p><p><strong>spamprobe help</strong> [ <em>command</em> ]</p><p>With no arguments SpamProbe lists all of the valid commands. If one or more commands are specified after the word help, SpamProbe will print a more verbose description of each command.</p><p><strong>spamprobe create-db</strong></p><p>If no database currently exists SpamProbe will attempt to create one and then exit. This can be used to bootstrap a new installation. Strictly speaking this command is not necessary since the <strong>train-spam</strong>, <strong>train-good</strong>, and <strong>auto-train</strong> commands will also create a database if none already exists but some users like to create a database as a separate installation step.</p><p><strong>spamprobe create-config</strong></p><p>Writes a new configuration file named spamprobe.hdl into the database directory (normally $HOME/.spamprobe). Any existing configuration file will be overwritten so be sure to make a copy before invoking this command.</p><p><strong>spamprobe receive</strong> [ <em>filename</em>... ]</p><p>Tells SpamProbe to read its standard input (or a file specified after the receive command) and score it using the current databases. Once the message has been scored the message is classified as either spam or non-spam and its word counts are written to the appropriate database. The message&apos;s score is written to stdout along with a single word. For example:</p>
<pre>
SPAM 0.9999999 595f0150587edd7b395691964069d7af
GOOD 0.0200000 595f0150587edd7b395691964069d7af

</pre>
<p>The string of hex digits after the score is the message&apos;s &ldquo;MD5-digest&rdquo;, a 128 bit number which uniquely identifies the message. The digest is used by SpamProbe to recognize messages that it has processed previously so that it can keep its word counts consistent if the message is reclassified.</p><p>Using the <strong>-T</strong> option additionally lists the terms used to produce the score along with their counts (number of times they were found in the message).</p><p><strong>spamprobe train</strong> [ <em>filename</em>... ]</p><p>Functionally identical to <strong>receive</strong> except that the database is only modified if the message was &ldquo;difficult&rdquo; to classify. In practice this can reduce the number of database updates to as little as 10% of messages received.</p><p><strong>spamprobe score</strong> [ <em>filename</em>... ]</p><p>Similar to receive except that the database is not modified in any way.</p><p><strong>spamprobe summarize</strong> [ <em>filename</em>... ]</p><p>Similar to <strong>score</strong> except that it prints a short summary and score for each message. This can be useful when testing. Using the <strong>-T</strong> option additionally lists the terms used to produce the score along with their counts (number of times they were found in the message).</p><p><strong>spamprobe find-spam</strong> [ <em>filename</em>... ]</p><p>Similar to <strong>score</strong> except that it prints a short summary and score for each message that is determined to be spam. This can be useful when testing. Using the <strong>-T</strong> option additionally lists the terms used to produce the score along with their counts (number of times they were found in the message).</p><p><strong>spamprobe find-good</strong> [ <em>filename</em>... ]</p><p>Similar to <strong>score</strong> except that it prints a short summary and score for each message that is determined to be good. This can be useful when testing. Using the <strong>-T</strong> option additionally lists the terms used to produce the score along with their counts (number of times they were found in the message).</p><p><strong>spamprobe auto-train</strong> { SPAM|GOOD <em>filename</em> ... } ...</p><p>Attempts to efficiently build a database from all of the named files. You may specify one or more file of each type. Prior to each set of file names you must include the word <strong>SPAM</strong> or <strong>GOOD</strong> to indicate what type of mail is contained in the files which follow on the command line.</p><p>The case of the <strong>SPAM</strong> and <strong>GOOD</strong> keywords is important. Any number of file names can be specified between the keywords. The command line format is very flexible. You can even use a find command in backticks to process whole directory trees of files. For example:</p>
<pre>
spamprobe auto-train SPAM spams/* GOOD `find  hams -type f`
</pre>
<p>SpamProbe pre-scans the files to determine how many emails of each type exist and then trains on hams and spams in a random sequence that balances the inflow of each type so that the train command can work most effectively. For example if you had 400 hams and 400 spams, auto-train will generally process one spam, then one ham, etc. If you had 4000 spams and 400 hams then auto-train will generally process 10 spams, then one ham, etc.</p><p>Since this command will likely take a long time to run it is often desireable to use it with the -v option to see progress information as the messages are processed.</p>
<pre>
spamprobe -v auto-train SPAM spams/* GOOD hams/*
</pre>
<p><strong>spamprobe good</strong> [ <em>filename</em>... ]</p><p>Scans each file (or stdin if no file is specified) and reclassifies every email in the file as non-spam. The databases are updated appropriately. Messages previously classified as good (recognized using their MD5 digest) are ignored. Messages previously classified as spam are reclassified as good.</p><p><strong>spamprobe train-good</strong> [ <em>filename</em>... ]</p><p>Functionally identical to <strong>good</strong> command except that it only updates the database for messages that are either incorrectly classified (i.e. classified as spam) or are &ldquo;difficult&rdquo; to classify. In practice this can reduce amount of database updates to as little as 10% of messages.</p><p><strong>spamprobe spam</strong> [ <em>filename</em>... ]</p><p>Scans each file (or stdin if no file is specified) and reclassifies every email in the file as spam. The databases are updated appropriately. Messages previously classified as spam (recognized using their MD5 digest of message ids) are ignored. Messages previously classified as good are reclassified as spam.</p><p><strong>spamprobe train-spam</strong> [ <em>filename</em>... ]</p><p>Functionally identical to <strong>spam</strong> command except that it only updates the database for messages that are either incorrectly classified (i.e. classified as good) or are &ldquo;difficult&rdquo; to classify. In practice this can reduce amount of database updates to as little as 10% of messages.</p><p><strong>spamprobe remove</strong> [ <em>filename</em>... ]</p><p>Scans each file (or stdin if no file is specified) and removes its term counts from the database. Messages which are not in the database (recognized using their MD5 digest of message ids) are ignored.</p><p><strong>spamprobe cleanup</strong> [ <em>junk_count</em> [ <em>max_age</em> ] ]</p><p>Scans the database and removes all terms with <em>junk_count</em> or less (default 2) which have not had their counts modified in at least <em>max_age</em> days (default 7). You can specify multiple count/age pairs on a single command line but must specify both a count and an age for all but the last count. This should be run periodically to keep the database from growing endlessly.</p><p><strong>spamprobe purge</strong> [ <em>junk_count</em> ]</p><p>Similar to cleanup but forces the immediate deletion of all terms with total count less than <em>junk_count </em> (default is 2) no matter how long it has been since they were modified (i.e. even if they were just added today). This could be handy immediately after classifying a large mailbox of historical spam or good email to make room for the next batch.</p><p><strong>spamprobe purge-terms</strong> <em>regex</em></p><p>Similar to purge except that it removes from the database all terms which match the specified regular expression. Be careful with this command because it could remove many more terms than you expect. Use <strong>dump</strong> with the same <em>regex</em> before running this command to see exactly what will be deleted.</p><p><strong>spamprobe edit-term</strong> <em>term</em> <em>good_count</em> <em>spam_count</em></p><p>Can be used to specifically set the good and spam counts of a term. Whether this is truly useful is doubtful but it is provided for completeness sake.</p><p><strong>spamprobe dump</strong> [ <em>regex</em> ]</p><p>Prints the contents of the word counts database one word per line in human readable format with spam probability, good count, spam count, flags, and word in columns separated by whitespace. When given, the <em>regex</em> argument limits output to matching tokens.</p><p><strong>spamprobe tokenize</strong> [ <em>filename</em> ]</p><p>Prints the tokens found in the file one word per line in human readable format with spam probability, good count, spam count, message count, and word in columns separated by whitespace. Terms are listed in the order in which they were encountered in the message. The standard unix sort command can be used to sort the terms as desired.</p><p><strong>spamprobe export</strong></p><p>Similar to the <strong>dump</strong> command but prints the counts and words in a comma separated format with the words surrounded by double quotes. This can be more useful for importing into some databases.</p><p><strong>spamprobe import</strong></p><p>Reads the specified files which must contain export data written by the <strong>export</strong> command. The terms and counts from this file are added to the database. This can be used to convert a database from a prior version.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<h3>External Tokenizers</h3>
<p>Assuming you have a tokenizer tokenize.pl, in your procmailrc file you could use:</p>
<pre>
SCORE=| tokenize.pl | /usr/bin/spamprobe -o tokenized train

</pre>

<h3>Querying Mailboxes</h3>
<p>To list all words from &ldquo;most good&rdquo; to &ldquo;least good&rdquo; use this command:</p>
<pre>
spamprobe tokenize <em>filename</em> | sort -k 1n -k 2nr

</pre>
<p>To list all words from &ldquo;most spammy&rdquo; to &ldquo;least spammy&rdquo; use this command:</p>
<pre>
spamprobe tokenize <em>filename</em> | sort -k 1nr -k 3nr

</pre>

<h3>Querying The Database</h3>
<p>Use <strong>spamprobe dump</strong> to get a human readable list of tokens in SpamProbe&apos;s database. Berkeley DB sorts terms alphabetically; piping output into the standard unix <a href="../man1/sort.1.html"><strong>sort</strong>(1)</a> command can be used to sort the terms as desired.</p><p>To list all words in SpamProbe&apos;s database from &ldquo;most good&rdquo; to &ldquo;least good&rdquo; use this command:</p>
<pre>
spamprobe dump | sort -k 1n -k 2nr

</pre>
<p>To list all words from &ldquo;most spammy&rdquo; to &ldquo;least spammy&rdquo; use this command:</p>
<pre>
spamprobe dump | sort -k 1nr -k 3nr

</pre>
<p>Optionally you can specify a regular expression. If specified SpamProbe will only dump terms matching the regular expression. For example:</p>
<pre>
spamprobe dump &apos;finance&apos;
spamprobe dump &apos;&#92;&#92;bfinance&#92;&#92;b&apos;
spamprobe dump &apos;HSubject_.*finance&apos;
</pre>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DATABASE MAINTAINANCE</h2>
        <div class="sectioncontent">
<p>When no provision is taken, SpamProbe&apos;s databases will constantly grow while classifying messages. In order to remove old unused entries, you should run <strong>cleanup</strong> on a regular basis, most easily from <strong>cron</strong>(1).</p>
<pre>
# daily at 00:03
#    remove entries with count &lt;= 2 that haven&apos;t
#    been touched during the last 2 weeks from
#    spamprobe&apos;s database
3 0 * * * /usr/bin/spamprobe cleanup 2 14
</pre>
<p>Alternatively you might want to use a much higher count (1000 in this example) for terms that have not been seen in roughly six months:</p>
<pre>
3 0 * * * /home/brian/bin/spamprobe cleanup 1000 180 2 14
</pre>
<p>Because of the way that Berkeley DB works the database file will not actually shrink, but newly added terms will be able to use the space previously occupied by any removed terms so that the file&apos;s growth should be significantly slower if this command is used.</p><p>To actually shrink the database you can build a new one using the Berkeley DB utility programs <strong>db_dump</strong>(1) and <strong>db_load</strong>(1) or the SpamProbe<strong>import</strong> and <strong>export</strong> commands. For example:</p>
<pre>
cd ~
mkdir new.spamprobe
spamprobe export | spamprobe -d ~/new.spamprobe import
mv .spamprobe old.spamprobe
mv new.spamprobe .spamprobe

</pre>
<p>The <strong>-P</strong> option can also be used to limit the rate of growth of the database when importing a large number of emails. For example if you want to classify 1000 emails and want SpamProbe to purge rare terms every 100 messages use a command such as:</p>
<pre>
spamprobe -P 100 good goodmailboxname

</pre>
<p>Using <strong>-P</strong> slows down the classification but can avoid the need to use the <strong>export</strong>/<strong>import</strong> trick. Note that <strong>-P</strong> only makes sense when classifying a large number of messages.</p><p>You may want to force a particular word to be very spammy or extremely good:</p>
<pre>
spamprobe edit-term xanax 0 1000000
spamprobe edit-term debian 10000000 0

</pre>
<p>At least pinning good terms tends to help spammers.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>This manual page is still work in progress. In particular it&apos;s lacking a description of which headers are processed with <strong>-H normal</strong> and how terms are generated from headers as well as a reference to the regex syntax applicable to <strong>dump</strong> and <strong>purge-term</strong> commands.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>~/.spamprobe</p><p>When not otherwise specified with the <strong>-d </strong><strong></strong><em>directory</em> option, SpamProbe stores its database files in this directory. <em>It does not automatically create database directories except when explicitly asked to by the </em><em></em><strong>-c</strong><em> command line flag or the </em><em></em><strong>create-db</strong><em> command</em>. If your home directory is NFS mounted, use a different directory on a local disk, since Berkeley DB performance suffers badly over NFS.</p><p>~/.spamprobe/spamprobe.hdl</p><p>Configuration file for <strong>spamprobe</strong>. This file is optional. It can be initialized with all the default values by the <strong>create-config</strong> command.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO spamprobe&hellip;</h2>
        <div class="sectioncontent">
<p><strong>procmail</strong>(1) , <a href="../man1/maildrop.1.html"><strong>maildrop</strong>(1)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>SpamProbe has been written by Brian Burton &lt;bburton@users.sourceforge.net&gt; and is published under the QPL (Qt Public License).</p><p>This manual page was compiled by Siggy Brentrup &lt;bsb@debian.org&gt; from the distributed one for the Debian GNU/Linux system but may be used by others. Permission is granted to copy, distribute and/or modify this document under the terms of the GPL version 2.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="spamoracle.1.html"><span aria-hidden="true">&larr;</span> spamoracle.1: A spam classification tool</a></li>
   <li class="next"><a href="spamtrap.1.html">spamtrap.1: Read mail from stdin and test <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
