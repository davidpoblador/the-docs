<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>yarn: Scenario testing of unix command line tools</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Scenario testing of unix command line tools">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="yarn (1) manual">
  <meta name="twitter:description" content="Scenario testing of unix command line tools">
  <meta name="twitter:image" content="https://www.carta.tech/images/cmdtest-yarn-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/yarn.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="yarn (1) manual" />
  <meta property="og:description" content="Scenario testing of unix command line tools" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/cmdtest-yarn-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">yarn<small> (1)</small></h1>
        <p class="lead">Scenario testing of unix command line tools</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/yarn.1.html">
      <span itemprop="name">yarn: Scenario testing of unix command line tools</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/cmdtest/">
      <span itemprop="name">cmdtest</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/yarn.1.html">
      <span itemprop="name">yarn: Scenario testing of unix command line tools</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>yarn</strong> [<strong>--allow-missing-steps</strong>] [<strong>--config</strong>=<em>FILE</em>] [<strong>--dump-config</strong>] [<strong>--dump-memory-profile</strong>=<em>METHOD</em>] [<strong>--dump-setting-names</strong>] [<strong>--env</strong>=<em>NAME=VALUE</em>] [<strong>--generate-manpage</strong>=<em>TEMPLATE</em>] [<strong>-h</strong>] [<strong>--help</strong>] [<strong>--help-all</strong>] [<strong>--list-config-files</strong>] [<strong>--log</strong>=<em>FILE</em>] [<strong>--log-keep</strong>=<em>N</em>] [<strong>--log-level</strong>=<em>LEVEL</em>] [<strong>--log-max</strong>=<em>SIZE</em>] [<strong>--log-mode</strong>=<em>MODE</em>] [<strong>--memory-dump-interval</strong>=<em>SECONDS</em>] [<strong>-n</strong>] [<strong>--no-act</strong>] [<strong>--dry-run</strong>] [<strong>--pretend</strong>] [<strong>--no-allow-missing-steps</strong>] [<strong>--no-default-configs</strong>] [<strong>--no-no-act</strong>] [<strong>--no-dry-run</strong>] [<strong>--no-pretend</strong>] [<strong>--no-quiet</strong>] [<strong>--no-snapshot</strong>] [<strong>--no-timings</strong>] [<strong>--no-verbose</strong>] [<strong>--output</strong>=<em>FILE</em>] [<strong>-q</strong>] [<strong>--quiet</strong>] [<strong>-r</strong>=<em>SCENARIO</em>] [<strong>--run</strong>=<em>SCENARIO</em>] [<strong>-s</strong>=<em>SHELL-LIBRARY</em>] [<strong>--shell-library</strong>=<em>SHELL-LIBRARY</em>] [<strong>--snapshot</strong>] [<strong>--tempdir</strong>=<em>DIR</em>] [<strong>--timings</strong>] [<strong>-v</strong>] [<strong>--verbose</strong>] [<strong>--version</strong>] [<em>FILE</em>]...<em></em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>yarn</strong> is a scenario testing tool: you write a scenario describing how a user uses your software and what should happen, and express, using very lightweight syntax, the scenario in such a way that it can be tested automatically. The scenario has a simple, but strict structure:</p><ul>
<li>
<pre>
GIVEN some setup for the test
WHEN thing that is to be tested happens
THEN the post-conditions must be true
</pre>
</li>
</ul><p>As an example, consider a very short test scenario for verifying that a backup program works, at least for one simple case.</p><ul>
<li>
<pre>
SCENARIO backups can be restored
GIVEN some live data in a directory
AND an empty backup repository
WHEN a backup is made
THEN the data case be restored
FINALLY cleanup
</pre>
</li>
</ul><p>Note the addition of AND: you can have multiple GIVEN, WHEN, and THEN statements. The AND keyword makes the text be more readable. SCENARIO is also necessary, and gives the title.</p><p>FINALLY is for cleanups. The FINALLY steps will be run regardless of whether the scenario succeeds or not.</p><p>Scenarios are meant to be written in somewhat human readable language. However, they are not free form text. In addition to the GIVEN/WHEN/THEN structure, the text for each of the steps needs a computer-executable implementation. This is done by using IMPLEMENTS. The backup scenario from above might be implemented as follows:</p><ul>
<li>
<pre>
IMPLEMENTS GIVEN some live data in a directory
rm -rf "$TESTDIR/data"
mkdir "$TESTDIR/data"
echo foo &gt; "$TESTDIR/data/foo"
IMPLEMENTS GIVEN an empty backup repository
rm -rf "$TESTDIR/repo"
mkdir "$TESTDIR/repo"
IMPLEMENTS WHEN a backup is made
backup-program -r "$TESTDIR/repo" "$TESTDIR/data"
IMPLEMENTS THEN the data can be restored
mkdir "$TESTDIR/restored"
restore-program -r "$TESTDIR/repo" "$TESTDIR/restored"
diff -rq "$TESTDIR/data" "$TESTDIR/restored"
IMPLEMENTS FINALLY cleanup
echo nothing to do, actually
</pre>
</li>
</ul><p>Each "IMPLEMENTS GIVEN" (or WHEN, THEN, FINALLY) is followed by a regular expression on the same line, and then a shell script that gets executed to implement any step that matches the regular expression. The implementation can extract data from the match as well: for example, the regular expression might allow a file size to be specified.</p><p>The above example is a bit silly, of course: why go to the effort to obfuscate the various steps? The answer is that the various steps, implemented using IMPLEMENTS, can be combined in many ways, to test different aspects of the program being tested.</p><p>Moreover, by making the step descriptions be human language text, matched by regular expressions, most of the test can hopefully be written, and understood, by non-programmers. Someone who understands what a program should do, could write tests to verify its behaviour. The implementations of the various steps need to be implemented by a programmer, but given a well-designed set of steps, with enough flexibility in their implementation, that quite a good test suite can be written.</p><p>The shell commands in an IMPLEMENTS section are run in the directory in which the user ran <strong>yarn</strong>. The environment variable <strong>SRCDIR</strong> is set to the fully qualified path to that directory.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>--allow-missing-steps</strong></p>
  </dt>
  <dd>
    <p>allow scenarios to reference steps that do not exist, by warning about them, but otherwise ignoring the scenarios</p>
  </dd>
  <dt>
    <p><strong>--env</strong>=<em>NAME=VALUE</em></p>
  </dt>
  <dd>
    <p>add NAME=VALUE to the environment when tests are run</p>
  </dd>
  <dt>
    <p><strong>--generate-manpage</strong>=<em>TEMPLATE</em></p>
  </dt>
  <dd>
    <p>SUPPRESSHELP</p>
  </dd>
  <dt>
    <p><strong>-h</strong>, <strong>--help</strong></p>
  </dt>
  <dd>
    <p>show this help message and exit</p>
  </dd>
  <dt>
    <p><strong>-n</strong>, <strong>--no-act</strong>, <strong>--dry-run</strong>, <strong>--pretend</strong></p>
  </dt>
  <dd>
    <p>do not actually run any tests, merely print what would be run</p>
  </dd>
  <dt>
    <p><strong>--no-allow-missing-steps</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>--no-no-act</strong>, <strong>--no-dry-run</strong>, <strong>--no-pretend</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>--no-quiet</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>--no-snapshot</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>--no-timings</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>--no-verbose</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>--output</strong>=<em>FILE</em></p>
  </dt>
  <dd>
    <p>write output to FILE, instead of standard output</p>
  </dd>
  <dt>
    <p><strong>-q</strong>, <strong>--quiet</strong></p>
  </dt>
  <dd>
    <p>be quiet, avoid progress reporting, only show errors</p>
  </dd>
  <dt>
    <p><strong>-r</strong>, <strong>--run</strong>=<em>SCENARIO</em></p>
  </dt>
  <dd>
    <p>run only SCENARIO (this option can be repeated)</p>
  </dd>
  <dt>
    <p><strong>-s</strong>, <strong>--shell-library</strong>=<em>SHELL-LIBRARY</em></p>
  </dt>
  <dd>
    <p>include a shell library for the IMPLEMENTS sections to use</p>
  </dd>
  <dt>
    <p><strong>--snapshot</strong></p>
  </dt>
  <dd>
    <p>make snapshots of test working directory after each scenario step; you probably want to use this with --tempdir</p>
  </dd>
  <dt>
    <p><strong>--tempdir</strong>=<em>DIR</em></p>
  </dt>
  <dd>
    <p>use DIR as the temporary directory for tests; it should be empty or not exist</p>
  </dd>
  <dt>
    <p><strong>--timings</strong></p>
  </dt>
  <dd>
    <p>report wall clock time for each scenario and step</p>
  </dd>
  <dt>
    <p><strong>-v</strong>, <strong>--verbose</strong></p>
  </dt>
  <dd>
    <p>make progress reporting be more verbose ("wall of text"), instead of a one-line status info; this is turned automatically if there is not terminal</p>
  </dd>
  <dt>
    <p><strong>--version</strong></p>
  </dt>
  <dd>
    <p>show program's version number and exit</p>
  </dd>

</dl>
<h3>Configuration files and settings</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>--config</strong>=<em>FILE</em></p>
  </dt>
  <dd>
    <p>add FILE to config files</p>
  </dd>
  <dt>
    <p><strong>--dump-config</strong></p>
  </dt>
  <dd>
    <p>write out the entire current configuration</p>
  </dd>
  <dt>
    <p><strong>--dump-setting-names</strong></p>
  </dt>
  <dd>
    <p>SUPPRESSHELP</p>
  </dd>
  <dt>
    <p><strong>--help-all</strong></p>
  </dt>
  <dd>
    <p>show all options</p>
  </dd>
  <dt>
    <p><strong>--list-config-files</strong></p>
  </dt>
  <dd>
    <p>SUPPRESSHELP</p>
  </dd>
  <dt>
    <p><strong>--no-default-configs</strong></p>
  </dt>
  <dd>
    <p>clear list of configuration files to read</p>
  </dd>

</dl>

<h3>Logging</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>--log</strong>=<em>FILE</em></p>
  </dt>
  <dd>
    <p>write log entries to FILE (default is to not write log files at all); use "syslog" to log to system log, or "none" to disable logging</p>
  </dd>
  <dt>
    <p><strong>--log-keep</strong>=<em>N</em></p>
  </dt>
  <dd>
    <p>keep last N logs (10)</p>
  </dd>
  <dt>
    <p><strong>--log-level</strong>=<em>LEVEL</em></p>
  </dt>
  <dd>
    <p>log at LEVEL, one of debug, info, warning, error, critical, fatal (default: debug)</p>
  </dd>
  <dt>
    <p><strong>--log-max</strong>=<em>SIZE</em></p>
  </dt>
  <dd>
    <p>rotate logs larger than SIZE, zero for never (default: 0)</p>
  </dd>
  <dt>
    <p><strong>--log-mode</strong>=<em>MODE</em></p>
  </dt>
  <dd>
    <p>set permissions of new log files to MODE (octal; default 0600)</p>
  </dd>

</dl>

<h3>Peformance</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>--dump-memory-profile</strong>=<em>METHOD</em></p>
  </dt>
  <dd>
    <p>make memory profiling dumps using METHOD, which is one of: none, simple, meliae, or heapy (default: simple)</p>
  </dd>
  <dt>
    <p><strong>--memory-dump-interval</strong>=<em>SECONDS</em></p>
  </dt>
  <dd>
    <p>make memory profiling dumps at least SECONDS apart</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>DATADIR</strong></p>
  </dt>
  <dd>
    <p>Fully qualified pathname to a temporary directory, in which the tests can use files. The temporary directory is removed at the end of the test execution, unless the user specifies otherwise with --snapshot.</p>
  </dd>
  <dt>
    <p><strong>SRCDIR</strong></p>
  </dt>
  <dd>
    <p>Fully qualitifed pathname to the directory in which the user ran <strong>yarn</strong>. This is useful when the tests want to change the directory.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>To run <strong>yarn</strong> on all the scenarios in your current directory:</p><ul>
<li>
<pre>
yarn *.scenario
</pre>
</li>
</ul><p>All the files will be treated together as if they had been one file.</p><p>To add a shell library to be included when running any IMPLEMENTS section:</p><ul>
<li>
<pre>
yarn --shell-library mylib.sh *.scenario
</pre>
</li>
</ul><p>You can repeat <strong>--shell-library</strong> as many times as necessary.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO yarn&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/cmdtest.1.html"><strong>cmdtest</strong>(1)</a>, <a href="../man5/cliapp.5.html"><strong>cliapp</strong>(5)</a>.</p><p>The README.yarn file has more details on the scenario testing language.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="yaret.1.html"><span aria-hidden="true">&larr;</span> yaret.1: Yet another ripper encoder tagger</a></li>
   <li class="next"><a href="yarssr.1.html">yarssr.1: Get rss feeds in your gnome notification area <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
