<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>bup-index: Print and/or update the bup filesystem index</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Print and/or update the bup filesystem index">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="bup-index (1) manual">
  <meta name="twitter:description" content="Print and/or update the bup filesystem index">
  <meta name="twitter:image" content="https://www.carta.tech/images/bup-doc-bup-index-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/bup-index.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="bup-index (1) manual" />
  <meta property="og:description" content="Print and/or update the bup filesystem index" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/bup-doc-bup-index-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">bup-index<small> (1)</small></h1>
        <p class="lead">Print and/or update the bup filesystem index</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/bup-index.1.html">
      <span itemprop="name">bup-index: Print and/or update the bup filesystem index</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/bup-doc/">
      <span itemprop="name">bup-doc</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/bup-index.1.html">
      <span itemprop="name">bup-index: Print and/or update the bup filesystem index</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>bup index &lt;-p|-m|-s|-u&gt; [-H][-l] [-x][&#92;--fake-valid] [--no-check-device][&#92;--fake-invalid] [--check][&#92;--clear] [-f <em>indexfile</em>][&#92;--exclude *path*] [--exclude-from <em>filename</em>][&#92;--exclude-rx *pattern*] [-v] &lt;filenames...&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>bup&nbsp;index prints and/or updates the bup filesystem index, which is a cache of the filenames, attributes, and sha-1 hashes of each file and directory in the filesystem. The bup index is similar in function to the <a href="../man1/git.1.html"><strong>git</strong>(1)</a> index, and can be found in $BUP_DIR/bupindex.</p><p>Creating a backup in bup consists of two steps: updating the index with bup&nbsp;index, then actually backing up the files (or a subset of the files) with bup&nbsp;save. The separation exists for these reasons:</p>
<dl class='dl-vertical'>
  <dt>
    1.
  </dt>
  <dd>
    <p>There is more than one way to generate a list of files that need to be backed up. For example, you might want to use <a href="../man7/inotify.7.html"><strong>inotify</strong>(7)</a> or <strong>dnotify</strong>(7).</p>
  </dd>
  <dt>
    2.
  </dt>
  <dd>
    <p>Even if you back up files to multiple destinations (for added redundancy), the file names, attributes, and hashes will be the same each time. Thus, you can save the trouble of repeatedly re-generating the list of files for each backup set.</p>
  </dd>
  <dt>
    3.
  </dt>
  <dd>
    <p>You may want to use the data tracked by bup index for other purposes (such as speeding up other programs that need the same information).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>bup makes accommodations for the expected "worst-case" filesystem timestamp resolution -- currently one second; examples include VFAT, ext2, ext3, small ext4, etc. Since bup cannot know the filesystem timestamp resolution, and could be traversing multiple filesystems during any given run, it always assumes that the resolution may be no better than one second.</p><p>As a practical matter, this means that index updates are a bit imprecise, and so bup&nbsp;save may occasionally record filesystem changes that you didn\[aq]t expect. That\[aq]s because, during an index update, if bup encounters a path whose actual timestamps are more recent than one second before the update started, bup will set the index timestamps for that path (mtime and ctime) to exactly one second before the run, -- effectively capping those values.</p><p>This ensures that no subsequent changes to those paths can result in timestamps that are identical to those in the index. If that were possible, bup could overlook the modifications.</p><p>You can see the effect of this behavior in this example (assume that less than one second elapses between the initial file creation and first index run):</p><ul>
<li>
<pre>
$&nbsp;touch&nbsp;src/1&nbsp;src/2
#&nbsp;A&nbsp;"sleep&nbsp;1"&nbsp;here&nbsp;would&nbsp;avoid&nbsp;the&nbsp;unexpected&nbsp;save.
$&nbsp;bup&nbsp;index&nbsp;src
$&nbsp;bup&nbsp;save&nbsp;-n&nbsp;src&nbsp;src&nbsp;&nbsp;#&nbsp;Saves&nbsp;1&nbsp;and&nbsp;2.
$&nbsp;date&nbsp;&gt;&nbsp;src/1
$&nbsp;bup&nbsp;index&nbsp;src
$&nbsp;date&nbsp;&gt;&nbsp;src/2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Not&nbsp;indexed.
$&nbsp;bup&nbsp;save&nbsp;-n&nbsp;src&nbsp;src&nbsp;&nbsp;#&nbsp;But&nbsp;src/2&nbsp;is&nbsp;saved&nbsp;anyway.

</pre>
</li>
</ul><p>Strictly speaking, bup should not notice the change to src/2, but it does, due to the accommodations described above.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MODES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-u, --update</strong></p>
  </dt>
  <dd>
    <p>recursively update the index for the given filenames and their descendants. One or more filenames must be given. If no mode option is given, this is the default.</p>
  </dd>
  <dt>
    <p><strong>-p, --print</strong></p>
  </dt>
  <dd>
    <p>print the contents of the index. If filenames are given, shows the given entries and their descendants. If no filenames are given, shows the entries starting at the current working directory (.).</p>
  </dd>
  <dt>
    <p><strong>-m, --modified</strong></p>
  </dt>
  <dd>
    <p>prints only files which are marked as modified (ie. changed since the most recent backup) in the index. Implies -p.</p>
  </dd>
  <dt>
    <p><strong>-s, --status</strong></p>
  </dt>
  <dd>
    <p>prepend a status code (A, M, D, or space) before each filename. Implies -p. The codes mean, respectively, that a file is marked in the index as added, modified, deleted, or unchanged since the last backup.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-H, --hash</strong></p>
  </dt>
  <dd>
    <p>for each file printed, prepend the most recently recorded hash code. The hash code is normally generated by bup&nbsp;save. For objects which have not yet been backed up, the hash code will be 0000000000000000000000000000000000000000. Note that the hash code is printed even if the file is known to be modified or deleted in the index (ie. the file on the filesystem no longer matches the recorded hash). If this is a problem for you, use --status.</p>
  </dd>
  <dt>
    <p><strong>-l, --long</strong></p>
  </dt>
  <dd>
    <p>print more information about each file, in a similar format to the -l option to ls(1).</p>
  </dd>
  <dt>
    <p><strong>-x, --xdev, --one-file-system</strong></p>
  </dt>
  <dd>
    <p>don\[aq]t cross filesystem boundaries when recursing through the filesystem. Only applicable if you\[aq]re using -u.</p>
  </dd>
  <dt>
    <p><strong>--fake-valid</strong></p>
  </dt>
  <dd>
    <p>mark specified filenames as up-to-date even if they aren\[aq]t. This can be useful for testing, or to avoid unnecessarily backing up files that you know are boring.</p>
  </dd>
  <dt>
    <p><strong>--fake-invalid</strong></p>
  </dt>
  <dd>
    <p>mark specified filenames as not up-to-date, forcing the next "bup save" run to re-check their contents.</p>
  </dd>
  <dt>
    <p><strong>--check</strong></p>
  </dt>
  <dd>
    <p>carefully check index file integrity before and after updating. Mostly useful for automated tests.</p>
  </dd>
  <dt>
    <p><strong>--clear</strong></p>
  </dt>
  <dd>
    <p>clear the default index.</p>
  </dd>
  <dt>
    <p><strong>-f, --indexfile=</strong><em>indexfile</em></p>
  </dt>
  <dd>
    <p>use a different index filename instead of $BUP_DIR/bupindex.</p>
  </dd>
  <dt>
    <p><strong>--exclude=</strong><em>path</em></p>
  </dt>
  <dd>
    <p>exclude <em>path</em> from the backup; bup will not expand <em>path</em> in any way (can be used more than once).</p>
  </dd>
  <dt>
    <p><strong>--exclude-from=</strong><em>filename</em></p>
  </dt>
  <dd>
    <p>read --exclude paths from <em>filename</em>, one path per-line (can be used more than once).</p>
  </dd>
  <dt>
    <p><strong>--exclude-rx=</strong><em>pattern</em></p>
  </dt>
  <dd>
    <p>exclude any path matching <em>pattern</em>, which must be a Python regular expression (http://docs.python.org/library/re.html). The pattern will be compared against the full path, without anchoring, so "x/y" will match "ox/yard" or "box/yards". To exclude the contents of /tmp, but not the directory itself, use "^/tmp/.". (can be specified more than once)</p><p>Examples:</p>
<dl class='dl-vertical'>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>\[aq]/foo$\[aq] - exclude any file named foo</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>\[aq]/foo/$\[aq] - exclude any directory named foo</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>\[aq]/foo/.\[aq] - exclude the content of any directory named foo</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>\[aq]^/tmp/.\[aq] - exclude root-level /tmp\[aq]s content, but not /tmp itself</p>
  </dd>

</dl>

  </dd>
  <dt>
    <p><strong>--no-check-device</strong></p>
  </dt>
  <dd>
    <p>don\[aq]t mark a an entry invalid if the device number (<a href="../man2/stat.2.html"><strong>stat</strong>(2)</a> st_dev) changes. This can be useful when indexing remote, automounted, or (LVM) snapshot filesystems.</p>
  </dd>
  <dt>
    <p><strong>-v, --verbose</strong></p>
  </dt>
  <dd>
    <p>increase log output during update (can be used more than once). With one -v, print each directory as it is updated; with two -v, print each file too.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<ul>
<li>
<pre>
bup&nbsp;index&nbsp;-vux&nbsp;/etc&nbsp;/var&nbsp;/usr

</pre>
</li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO bup-index&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/bup-save.1.html"><strong>bup-save</strong>(1)</a>, <a href="../man1/bup-drecurse.1.html"><strong>bup-drecurse</strong>(1)</a>, <a href="../man1/bup-on.1.html"><strong>bup-on</strong>(1)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUP</h2>
        <div class="sectioncontent">
<p>Part of the <a href="../man1/bup.1.html"><strong>bup</strong>(1)</a> suite.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Avery Pennarun &lt;apenwarr@gmail.com&gt;.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="bup-import-rsnapshot.1.html"><span aria-hidden="true">&larr;</span> bup-import-rsnapshot.1: Import a rsnapshot archive</a></li>
   <li class="next"><a href="bup-init.1.html">bup-init.1: Initialize a bup repository <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
