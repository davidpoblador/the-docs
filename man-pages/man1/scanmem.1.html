<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>scanmem: Locate and modify a variable in an executing process.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Locate and modify a variable in an executing process.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="scanmem (1) manual">
  <meta name="twitter:description" content="Locate and modify a variable in an executing process.">
  <meta name="twitter:image" content="https://www.carta.tech/images/scanmem-scanmem-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/scanmem.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="scanmem (1) manual" />
  <meta property="og:description" content="Locate and modify a variable in an executing process." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/scanmem-scanmem-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">scanmem<small> (1)</small></h1>
        <p class="lead">Locate and modify a variable in an executing process.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/scanmem.1.html">
      <span itemprop="name">scanmem: Locate and modify a variable in an executing process.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/scanmem/">
      <span itemprop="name">scanmem</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/scanmem.1.html">
      <span itemprop="name">scanmem: Locate and modify a variable in an executing process.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>scanmem</strong> [--version] [--help] [--debug] [--backend] <em>target-program-pid</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>scanmem</strong> is an interactive debugging utility that can be used to isolate the address of a variable in an executing process by successively scanning the process' address space looking for matching values. By informing <strong>scanmem</strong> how the value of the variable changes over time, it can determine the actual location (or locations) of the variable by successively eliminating non-matches. <strong>scanmem</strong> determines where to look by searching for mappings with <em>read</em> / <em>write</em> permission, these are referred to as regions. Users can eliminate regions they believe are likely unrelated to the target variable (for example, located in a shared library unrelated to the variable in question), this will improve the speed of the scan, which can initially be quite slow in large programs.</p><p>Once a variable has been found, <strong>scanmem</strong> can monitor the variable, or change it to a user specified value, either once, or continually over a period of time.</p><p><strong>scanmem</strong> works similarly to the " <em>pokefinders</em> " once commonly used to cheat at video games, this function is a good demonstration of how to use <strong>scanmem</strong> , and is used in the documentation.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE</h2>
        <div class="sectioncontent">
<p><strong>scanmem</strong> should be invoked with the process id of the program you wish to debug as an argument. Once started, scanmem accepts interactive commands. These are described below, however entering <em>help</em> at the <strong>&gt;</strong> prompt will allow you to access <strong>scanmem's</strong> online documentation.</p><p>The <em>target-program-pid</em> can be specified in decimal, hexadecimal, or octal using the standard C language notation (leading 0x for hexadecimal, leading 0 for octal, anything else is assumed to be decimal).</p><p><strong>--version</strong></p><p>Print version and exit.</p><p><strong>--help</strong></p><p>Print a short description of command line options then exit.</p><p><strong>--debug</strong></p><p>Run in debug mode, more information will be outputted.</p><p><strong>--backend</strong></p><p>Work as backend, normal users should not use this paratmeter.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMMANDS</h2>
        <div class="sectioncontent">
<p>While in interactive mode, <strong>scanmem</strong> prints a decimal number followed by <strong>&gt;</strong> , the number is the current number of possible candidates for the target variable that are known. 0 indicates that no possible variables have been eliminated yet.</p><p><strong>n</strong></p><p>Where <strong>n</strong> represents any number in decimal, octal or hexadecimal, this command tells <strong>scanmem</strong> that the current value of the target variable is exactly <strong>n.</strong> <strong>scanmem</strong> will begin a search of the entire address space, or the existsing known matches (if any), eliminating any variable that does not have this value.</p><p><strong>set</strong> <em>[match-id][,match-id,...]=]value[/delay] [...]</em></p><p>Set the value <em>value</em> into the match numbers <em>match-id</em> , or if just <em>value</em> is specified, all known matches. <em>value</em> can be specified in standard C language notation. All known matches, along with their match-id's can be displayed using the <strong>list</strong> command. Multiple <em>match-id's</em> can be specified, separated with commas and terminated with an <em>=</em> sign. To set a value continually,  suffix the command with <em>/</em> followed by the number of seconds to wait between sets. You can interrupt the set command with ^C to return to the <strong>scanmem</strong> prompt. This can be used to sustain the value of a variable which decreases overtime, for example a timer that is decremented every second can be set to 100 every 10 seconds to prevent some property from ever changing.</p><p>This command is used to change the value of the variable(s) once found by elimination. Please note, some applications will store values in multiple locations.</p><p><strong>dump</strong> <em>&lt;address&gt; &lt;length&gt; [&lt;filename&gt;]</em></p><p>Dump the memory region starting from <em>&lt;address&gt;</em> of length <em>&lt;length&gt;</em> into a human-readable format.</p><p>If <em>&lt;filename&gt;</em> is given, data will be saved into the file, otherwise data will be displayed into stdout in a human readable format</p><p><strong>write</strong> <em>&lt;value_type&gt; &lt;address&gt; &lt;value&gt;</em></p><p>Manually set the value of the variable at the speicified address.</p><p>Names of value_type are subject to change in different versions of scanmem, see more info using the `help write' command.</p><p><strong>&gt;</strong></p><p>Tells <strong>scanmem</strong> that it should eliminate all matched variables that have not increased since the last search. For example, if the value of a variable is known to be zero when a program is executed, but increases over time, this command can be used several times to eliminate variables that have decreased or not changed.</p><p><strong>&lt;</strong></p><p>As for <strong>&gt;</strong> but indicates that the target variable has decreased since the last scan.</p><p><strong>=</strong></p><p>As for <strong>&gt;</strong> but indicates that the target variable has not changed since last scan.</p><p><strong>snapshot</strong></p><p>Save a snapshot of existing program state, for use with <strong>&gt;</strong> , <strong>&lt;</strong> , and <strong>=</strong> , although other commands can still be used.</p><p><strong>list</strong></p><p>List all the possible candidates currently known, including their address, last known value and possible types. The value in the first column is the match id, and can be used in conjunction with the <strong>delete</strong> command to eliminate matches.</p><p><strong>delete</strong> <em>[match-id]</em></p><p>Delete match <em>match-id</em> , which can be found from the output of the <strong>list</strong> command. To delete all matches, see the <strong>reset</strong> command, or to delete all matches associated with a particular library, see the <strong>dregion</strong> command, which also removes any associated matches. Pleae note that match-ids may be recalculated after matches are removed or added.</p><p><strong>watch</strong> <em>[match-id]</em></p><p>Monitor the value of <em>match-id</em> , and print its value as it changes. Every change is printed along with a timestamp, you can interrupt this command with ^C to stop monitoring.</p><p><strong>pid</strong> <em>[new-pid]</em></p><p>Print out the process id of the current target program, or change the target to <em>new-pid</em> , which will reset existing regions and matches.</p><p><strong>lregions</strong></p><p>List all the known regions, this can be used in combination with the <strong>dregion</strong> command to eliminate regions that the user believes are not related to the variable in question, thus reducing the address space required to search. The value in the first column is the <em>region-id</em> which must be passed to the <strong>dregion</strong> command. The size and path (if applicable) is also printed. This can be used to eliminate regions located in shared libraries that are unlikely to be relevant to the variable required.</p><p><strong>dregion</strong> <em>[!][region-id][,region-id][,...]</em></p><p>Delete the region <em>region-id</em> , along with any matches from the match list. The <em>region-id</em> can be found in the output of the <strong>lregions</strong> command. A leading <em>!</em> indicates the list should be inverted.</p><p><strong>reset</strong></p><p>Forget all known matches and start again.</p><p><strong>shell</strong> <em>[shell-command]</em></p><p>Execute <em>shell-command</em> using /bin/sh, then return.</p><p><strong>option &lt;name&gt; &lt;value&gt;</strong></p><p>Change options in runtime. See `help option` for all possible names/values.</p><p><strong>version</strong></p><p>Print the version of <strong>scanmem</strong> in use.</p><p><strong>help</strong></p><p>Print a short summary of available commands.</p><p><strong>exit</strong></p><p>Detach from the target program and exit immediately.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Cheat at nethack, on systems where nethack is not installed sgid.</p>
<pre>
$ scanmem `pidof nethack`
info: attaching to pid 13070.
info: maps file located at /proc/13070/maps opened.
info: 17 suitable regions found.
Please enter current value, or "help" for other commands.
0&gt;
</pre>
<p>The 0 in the <strong>scanmem</strong> prompt indicates we currently have no candidates, so I enter how much gold I currently have (91 pieces) and let scanmem find the potential candidates.</p>
<pre>
0&gt; 91
info: searching 0xbfffa000 - 0xc0000000...........ok
info: searching 0x401c2000 - 0x401e3000...........ok
info: searching 0x401c1000 - 0x401c2000...........ok
info: searching 0x401b6000 - 0x401b8000...........ok
info: searching 0x401b5000 - 0x401b6000...........ok
info: searching 0x40189000 - 0x4018a000...........ok
info: searching 0x40188000 - 0x40189000...........ok
info: searching 0x40181000 - 0x40183000...........ok
info: searching 0x4017f000 - 0x40181000...........ok
info: searching 0x40070000 - 0x40071000...........ok
info: searching 0x40068000 - 0x40070000...........ok
info: searching 0x40030000 - 0x40031000...........ok
info: searching 0x40029000 - 0x4002a000...........ok
info: searching 0x4001f000 - 0x40020000...........ok
info: searching 0x40016000 - 0x40017000...........ok
info: searching 0x081d4000 - 0x0820a000...........ok
info: searching 0x081b7000 - 0x081d4000...........ok
info: we currently have 16 matches.
16&gt; list
[ 0] 0x081c1f34 {        91} (/usr/share/games/nethack/nethack)
[ 1] 0x081c1780 {        91} (/usr/share/games/nethack/nethack)
[ 2] 0x081be436 {        91} (/usr/share/games/nethack/nethack)
[ 3] 0x081eeffc {        91} (unassociated, typically .bss)
[ 4] 0x081ee0c0 {        91} (unassociated, typically .bss)
[ 5] 0x081eddb8 {        91} (unassociated, typically .bss)
[ 6] 0x081d6d88 {        91} (unassociated, typically .bss)
[ 7] 0x4001fcd3 {        91} (/lib/libnss_compat-2.3.5.so)
[ 8] 0x40029fe3 {        91} (/lib/libnss_nis-2.3.5.so)
[ 9] 0x40029f8b {        91} (/lib/libnss_nis-2.3.5.so)
[10] 0x40029efb {        91} (/lib/libnss_nis-2.3.5.so)
[11] 0x40029bff {        91} (/lib/libnss_nis-2.3.5.so)
[12] 0x401d18d3 {        91} (unassociated, typically .bss)
[13] 0x401d156f {        91} (unassociated, typically .bss)
[14] 0x401d120b {        91} (unassociated, typically .bss)
[15] 0xbfffd76c {        91} (unassociated, typically .bss)
16&gt;
</pre>
<p>16 potential matches were found, many of them are clearly unrelated, as they're part of unrelated libraries (libnss_nis.so). We could make <strong>scanmem</strong> eliminate these manually using the <strong>delete</strong> command, however just waiting until the amount of gold changes and telling scanmem the new value should be enough. I find some more gold, and tell <strong>scanmem</strong> the new value, 112.</p>
<pre>
16&gt; 112
info: we currently have 1 matches.
info: match identified, use "set" to modify value.
info: enter "help" for other commands.
1&gt; list
[ 0] 0x081d6d88 {       112} (unassociated, typically .bss)
</pre>
<p>Only one of the 16 original candidates now have the value 112, so this must be where the amount of gold is stored. I'll try setting it to 10,000 pieces.</p>
<pre>
1&gt; set 10000
info: setting *0x081d6d88 to 10000...
1&gt;
</pre>
<p>The resulting nethack status:</p>
<pre>
Dlvl:1  $:10000 HP:15(15) Pw:2(2) AC:7  Exp:1
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p><strong>scanmem</strong> has been tested on multiple large programs, including the 3d shoot-em-up quake3 linux.</p><p>Obviously, <strong>scanmem</strong> can crash your program if used incorrectly.</p><p>Some programs store values in multiple locations, this is why <strong>set</strong> will change all known matches.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>The first scan can be very slow on large programs, this is not a problem for subsequent scans as huge portions of the address space are usually eliminated. This could be improved in future, perhaps by assuming all integers are aligned by default. Suggestions welcome.</p><p>The <strong>snapshot</strong> command uses memory inefficiently, and should probably not be used on large programs. In future this will use a more intelligent format.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HOMEPAGE</h2>
        <div class="sectioncontent">
<p>http://code.google.com/p/scanmem/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Tavis Ormandy &lt;taviso(a)sdf.lonestar.org&gt; http://taviso.decsystem.org/</p><p>Eli   Dupree  &lt;elidupree(a)charter.net&gt;</p><p>WANG  Lu      &lt;coolwanglu(a)gmail.com&gt;</p><p>All bug reports, suggestions or feedback welcome.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO scanmem&hellip;</h2>
        <div class="sectioncontent">
<p><strong>gdb</strong>(1) <a href="../man2/ptrace.2.html"><strong>ptrace</strong>(2)</a> <a href="../man6/nethack.6.html"><strong>nethack</strong>(6)</a> <a href="../man8/pidof.8.html"><strong>pidof</strong>(8)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="scanmacho.1.html"><span aria-hidden="true">&larr;</span> scanmacho.1: User-space utility to scan mach-o files</a></li>
   <li class="next"><a href="scanpci.gatos.1.html">scanpci.gatos.1: Pci bus utility from the gatos package. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
