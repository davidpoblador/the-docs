<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>getsockname: Get information about this or that end of the socket's connection  netpipes 4.2</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Get information about this or that end of the socket's connection  netpipes 4.2">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="getsockname (1) manual">
  <meta name="twitter:description" content="Get information about this or that end of the socket's connection  netpipes 4.2">
  <meta name="twitter:image" content="https://www.carta.tech/images/netpipes-getsockname-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/getsockname.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="getsockname (1) manual" />
  <meta property="og:description" content="Get information about this or that end of the socket's connection  netpipes 4.2" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/netpipes-getsockname-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">getsockname<small> (1)</small></h1>
        <p class="lead">Get information about this or that end of the socket's connection  netpipes 4.2</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/getsockname.1.html">
      <span itemprop="name">getsockname: Get information about this or that end of the socket's connection  netpipes 4.2</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/netpipes/">
      <span itemprop="name">netpipes</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/getsockname.1.html">
      <span itemprop="name">getsockname: Get information about this or that end of the socket's connection  netpipes 4.2</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>getpeername</strong> [ <strong>-verbose</strong> ] [ <strong>-sock</strong> ] [ <em>fd</em> ]</p><p><strong>getsockname</strong> [ <strong>-verbose</strong> ] [ <strong>-peer</strong> ] [ <em>fd</em> ]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This is <strong>not</strong> the manual page for the getpeername system call. That manual page is in section 2.  You can access it using a command like "man 2 getpeername" or "man -s 2 getpeername".  I apologize for the confusion.</p><p><strong>getpeername</strong> performs a <a href="../man2/getpeername.2.html"><strong>getpeername</strong>(2)</a> system call on one of its file descriptors specified by <em>fd</em> and prints out the results.  The default <em>fd</em> is 0 (stdin).  You may cause <strong>getpeername</strong> to behave like <strong>getsockname</strong> by providing the -sock argument.</p><p><strong>getsockname</strong> performs a <a href="../man2/getsockname.2.html"><strong>getsockname</strong>(2)</a> system call on one of its file descriptors specified by <em>fd</em> and prints out the results. The default <em>fd</em> is 0 (stdin).  You may cause <strong>getsockname</strong> to behave like <strong>getpeername</strong> by providing the -peer argument.</p><p>There is a severe limitation of <strong>getpeername</strong>.  If the remote process has closed the connection, <strong>getpeername</strong> will fail with a `Socket is not connected' error.  This will happen with dismaying frequency when the remote process is not dependent upon the local process for input and it is only sending small amounts of output before closing the connection.  Hopefully the practical uses of <strong>getpeername</strong> (if there are any) will not exercise this problem.</p><p>You can use <strong>getpeername</strong> to find out the address of the opposite end of a socket.  You can use <strong>getsockname</strong> to find out the address of the local end of a socket.  They are in fact the same program with different names.  We will refer to both of them by the name <strong>getpeername</strong> in the following description.</p><p><strong>getpeername</strong> knows how to display peer information about UNIX and Internet sockets. If you try to use it on another type of socket, it will fail with an "unknown address family" error.  If you regularly deal with strange sockets and wish <strong>getpeername</strong> to work with them, send me email.</p><p>If the socket is a UNIX domain socket, then <strong>getpeername</strong> prints the name of the file (which is the port) on a single line.  If <strong>-verbose</strong> was specified, <strong>getpeername</strong> prints a more detailed report consisting of the word `Unix' on the first line, the word `Port' on the second line, and the name of the file on the third line.</p><p>If the socket is an Internet socket, then <strong>getpeername</strong> prints the port number on the first line and the numeric address on the second line.  If <strong>-verbose</strong> was specified, <strong>getpeername</strong> prints a more detailed report consisting of the word `Internet' on the first line, the word `Port' on the second line, the port numer on the third line, the word `Host' on the fourth line.  Starting on the fifth line it prints all the numeric internet addresses returned by the <a href="../man3/gethostbyaddr.3.html"><strong>gethostbyaddr</strong>(3)</a> library routine.  On the rest of the lines it prints all the host names.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EASTER EGG</h2>
        <div class="sectioncontent">
<p>If you specify <strong>-verbose</strong> twice, the program will print a copyright notice.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>I originally designed <strong>getpeername</strong> so that a faucet-spawned shell script could find out who was talking to it (and maybe perform access control).  I added getsockname for completeness.  Now I realize that getsockname is useful for multi-homing services.  However, most software that you want to understand multi-homing (httpd, ftpd) is already capable of doing it, and much more efficiently than a script wrapper.  Still, it might come in handy some day.</p>
<pre>
client$ hose mail.cise.ufl.edu smtp --in ./getpeername
25
128.227.205.210
</pre>
<p>You connected to mail.cis.ufl.edu on the SMTP port (port 25).  For a verbose report:</p>
<pre>
client$ hose mail.cise.ufl.edu smtp --in ./getpeername -v
Internet
Port
25
Host
128.227.205.210
fireant.cise.ufl.edu
</pre>
<p>Now let's give an example of a race condition which will cause <strong>getpeername</strong> to fail:</p>
<pre>
client$ hose web.cise.ufl.edu 80 -in ./getpeername
./getpeername: getpeername failed on descriptor 0: Socket is not connected
</pre>
<p>The HTTP daemon tries to read a request, finds that half of the full duplex connection closed (by the special behavior of the -in option on <a href="../man1/hose.1.html"><strong>hose</strong>(1)</a>) and drops the connection before <strong>getpeername</strong> can query the file descriptor.  We can cause the HTTP daemon to wait for us by leaving both halves of the duplex connection open.</p>
<pre>
client$ hose web.cise.ufl.edu 80 -fd0 ./getpeername -v
Internet
Port
80
Host
128.227.205.206
flood.cise.ufl.edu
</pre>
<p>And, finally, let's extract some useful information from our socket.</p>
<pre>
client$ hose web.cise.ufl.edu 80 -fd0 sh -c " ./getpeername -v | &#92;
	tail +5 | egrep -v '^[0-9.]*$' | head -1"
flood.cise.ufl.edu
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">
<p><strong>Socket operation on non-socket</strong> The <em>fd</em> you specified does not refer to a socket, or refers to a socket that has been closed.  This happens when you run <strong>getpeername</strong> by itself (it is unlikely that any of the file descriptors attached to an interactive shell are actually sockets), or if you goof up your faucet/hose command and forgot to <a href="../man2/dup.2.html"><strong>dup</strong>(2)</a> one of your descriptors, or if the remote machine manages to close the connection before <strong>getpeername</strong> could run.</p><p><strong>Bad file number</strong> You gave it a bad file number for <em>fd</em>.  If you have enough skill to actually generate this error, you probably know what is wrong.</p><p>If you encounter any other errors, clue me in.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO getsockname&hellip;</h2>
        <div class="sectioncontent">
<p>netpipes (1), faucet (1), hose (1), sockdown (1), socket (2), shutdown (2),</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>These programs are vulnerable to reverse DNS lookup spoofing.  You probably want to add ``nospoof on'' to your /etc/host.conf.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>Just avoid doing anything funky like passing <strong>getpeername</strong> strings and it should serve you well.</p><p>DOH!  3.0 didn't use the ntohs macro on the port numbers so the output was bogus on machines with non-network-order port numbers (like Linux-i386).  3.1 fixed this.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CREDITS</h2>
        <div class="sectioncontent">
<p>"Hi Mom! Hi Dad!"</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (C) 1995-98 Robert Forsman</p><p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p><p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.</p><p>You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Robert Forsman  thoth@purplefrog.com  Purple Frog Software  http://web.purplefrog.com/~thoth/</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="getpub.1.html"><span aria-hidden="true">&larr;</span> getpub.1: Look up medline entries by uid</a></li>
   <li class="next"><a href="gettab.1.html">gettab.1: Ame <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
