<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>sieve-filter: Pigeonholes sieve mailbox filter tool   warning: this tool is still experimental. read this manual carefully, and backup any important mail before using this tool. also note that some of the features documented here are not actually implemented yet; this is clearly indicated where applicable.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Pigeonholes sieve mailbox filter tool   warning: this tool is still experimental. read this manual carefully, and backup any important mail before using this tool. also note that some of the features documented here are not actually implemented yet; this is clearly indicated where applicable.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="sieve-filter (1) manual">
  <meta name="twitter:description" content="Pigeonholes sieve mailbox filter tool   warning: this tool is still experimental. read this manual carefully, and backup any important mail before using this tool. also note that some of the features documented here are not actually implemented yet; this is clearly indicated where applicable.">
  <meta name="twitter:image" content="https://www.carta.tech/images/dovecot-sieve-sieve-filter-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/sieve-filter.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="sieve-filter (1) manual" />
  <meta property="og:description" content="Pigeonholes sieve mailbox filter tool   warning: this tool is still experimental. read this manual carefully, and backup any important mail before using this tool. also note that some of the features documented here are not actually implemented yet; this is clearly indicated where applicable." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/dovecot-sieve-sieve-filter-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">sieve-filter<small> (1)</small></h1>
        <p class="lead">Pigeonholes sieve mailbox filter tool   warning: this tool is still experimental. read this manual carefully, and backup any important mail before using this tool. also note that some of the features documented here are not actually implemented yet; this is clearly indicated where applicable.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/sieve-filter.1.html">
      <span itemprop="name">sieve-filter: Pigeonholes sieve mailbox filter tool   warning: this tool is still experimental. read this manual carefully, and backup any important mail before using this tool. also note that some of the features documented here are not actually implemented yet; this is clearly indicated where applicable.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/dovecot-sieve/">
      <span itemprop="name">dovecot-sieve</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/sieve-filter.1.html">
      <span itemprop="name">sieve-filter: Pigeonholes sieve mailbox filter tool   warning: this tool is still experimental. read this manual carefully, and backup any important mail before using this tool. also note that some of the features documented here are not actually implemented yet; this is clearly indicated where applicable.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>sieve-filter</strong> [<em>options</em>] <em>script-file</em> <em>source-mailbox</em> [<em>discard-action</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <strong>sieve-filter</strong> command is part of the Pigeonhole Project (<a href="../man7/pigeonhole.7.html"><strong>pigeonhole</strong>(7)</a>), which adds Sieve (RFC 5228) support to the Dovecot secure IMAP and POP3 server (<a href="../man1/dovecot.1.html"><strong>dovecot</strong>(1)</a>).</p><p>The Sieve language was originally meant for filtering messages upon delivery. However, there are occasions when it is desirable to filter messages that are already stored in a mailbox, for instance when a bug in a Sieve script caused many messages to be delivered incorrectly. Using the sieve-filter tool it is possible to apply a Sieve script on all messages in a particular <em>source-mailbox</em>, making it possible to delete messages, to store them in a different mailbox, to change their content, and to change the assigned IMAP flags and keywords. Attempts to send messages to the outside world are ignored by default for obvious reasons, but, using the proper command line options, it is possible to capture and handle outgoing mail as well.</p><p>If no options are specified, the sieve-filter command runs in a simulation mode in which it only prints what would be performed, without actually doing anything. Use the <strong>-e</strong> option to activate true script execution. Also, the <em>source-mailbox</em> is opened read-only by default, meaning that it normally always remains unchanged. Use the <strong>-W</strong> option to allow changes in the <em>source-mailbox</em>.</p><p>Even with the <strong>-W</strong> option enabled, messages in the <em>source-mailbox</em> are only potentially modified or moved to a different folder. Messages are never lost unless a <em>discard-action</em> argument other than <strong>keep</strong> (the default) is specified. If the Sieve filter decides to store the message in the <em>source-mailbox</em>, where it obviously already exists, it is never duplicated there. In that case, the IMAP flags of the original message can be modified by the Sieve interpreter using the <em>imap4flags</em> extension, provided that <strong>-W</strong> is specified. If the message itself is modified by the Sieve interpreter (e.g. using the <em>editheader</em> extension), a new message is stored and the old one is expunged. However, if <strong>-W</strong> is omitted, the original message is left untouched and the modifications are discarded.</p><h3>CAUTION</h3>
<p>Although this is a very useful tool, it can also be very destructive when used improperly. A small bug in your Sieve script in combination with the wrong command line options could cause it to discard the wrong e-mails. And, even if the <em>source-mailbox</em> is opened in read-only mode to prevent such mishaps, it can still litter other mailboxes with spurious copies of your e-mails if your Sieve script decides to do so. Therefore, users are advised to read this manual carefully and to use the simulation mode first to check what the script will do. And, of course:</p><p><strong>MAKING A BACKUP IS IMPERATIVE FOR ANY IMPORTANT MAIL!</strong></p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-c</strong><em>config-file</em></p>
  </dt>
  <dd>
    <p>Alternative Dovecot configuration file path.</p>
  </dd>
  <dt>
    <p><strong>-C</strong></p>
  </dt>
  <dd>
    <p>Force compilation. By default, the compiled binary is stored on disk. When this binary is found during the next execution of <strong>sieve-filter</strong> and its modification time is more recent than the script file, it is used and the script is not compiled again. This option forces the script to be compiled, thus ignoring any present binary. Refer to <a href="../man1/sievec.1.html"><strong>sievec</strong>(1)</a> for more information about Sieve compilation.</p>
  </dd>
  <dt>
    <p><strong>-D</strong></p>
  </dt>
  <dd>
    <p>Enable Sieve debugging.</p>
  </dd>
  <dt>
    <p><strong>-e</strong></p>
  </dt>
  <dd>
    <p>Turns on execution mode. By default, the sieve-filter command runs in simulation mode in which it changes nothing, meaning that no mailbox is altered in any way and no actions are performed. It only prints what would be done. Using this option, the sieve-filter command becomes active and performs the requested actions.</p>
  </dd>
  <dt>
    <p><strong>-m</strong><em>default-mailbox</em></p>
  </dt>
  <dd>
    <p>The mailbox where the (implicit) <strong>keep</strong> Sieve action stores messages. This is equal to the <em>source-mailbox</em> by default. Specifying a different folder will have the effect of moving (or copying if <strong>-W</strong> is omitted) all kept messages to the indicated folder, instead of just leaving them in the <em>source-mailbox</em>. Refer to the explanation of the <em>source-mailbox</em> argument for more information on mailbox naming.</p>
  </dd>
  <dt>
    <p><strong>-q</strong><em>output-mailbox</em><strong></strong><strong>[not</strong><em>implemented</em><strong>yet]</strong></p>
  </dt>
  <dd>
    <p>Store outgoing e-mail into the indicated <em>output-mailbox</em>. By default, the sieve-filter command ignores Sieve actions such as redirect, reject, vacation and notify, but using this option outgoing messages can be appended to the indicated mailbox. This option has no effect in simulation mode. Flags of redirected messages are not preserved.</p>
  </dd>
  <dt>
    <p><strong>-Q</strong><em>mail-command</em><strong></strong><strong>[not</strong><em>implemented</em><strong>yet]</strong></p>
  </dt>
  <dd>
    <p>Send outgoing e-mail (e.g. as produced by redirect, reject and vacation) through the specified program. By default, the sieve-filter command ignores Sieve actions such as redirect, reject, vacation and notify, but using this option outgoing messages can be fed to the <strong>stdin</strong> of an external shell command. This option has no effect in simulation mode. Unless you really know what you are doing, <strong>DO NOT USE THIS TO FEED MAIL TO SENDMAIL!</strong>.</p>
  </dd>
  <dt>
    <p><strong>-s</strong><em>script-file</em><strong></strong><strong>[not</strong><em>implemented</em><strong>yet]</strong></p>
  </dt>
  <dd>
    <p>Specify additional scripts to be executed before the main script. Multiple <strong>-s</strong> arguments are allowed and the specified scripts are executed sequentially in the order specified at the command line.</p>
  </dd>
  <dt>
    <p><strong>-u</strong><em>user</em></p>
  </dt>
  <dd>
    <p>Run the Sieve script for the given <em>user</em>.</p>
  </dd>
  <dt>
    <p><strong>-v</strong></p>
  </dt>
  <dd>
    <p>Produce verbose output during filtering.</p>
  </dd>
  <dt>
    <p><strong>-W</strong></p>
  </dt>
  <dd>
    <p>Enables write access to the <em>source-mailbox</em>. This allows (re)moving the messages from the <em>source-mailbox</em>, changing their contents, and changing the assigned IMAP flags and keywords.</p>
  </dd>
  <dt>
    <p><strong>-x</strong><em>extensions</em></p>
  </dt>
  <dd>
    <p>Set the available extensions. The parameter is a space-separated list of the active extensions. By prepending the extension identifiers with <strong>+</strong> or <strong>-</strong>, extensions can be included or excluded relative to the configured set of active extensions. If no extensions have a <strong>+</strong> or <strong>-</strong> prefix, only those extensions that are explicitly listed will be enabled. Unknown extensions are ignored and a warning is produced.</p><p>For example <strong>-x</strong> &quot;+imapflags -enotify&quot; will enable the deprecated imapflags extension and disable the enotify extension. The rest of the active extensions depends on the <em>sieve_extensions</em> and <em>sieve_global_extensions</em> settings. By default, i.e. when <em>sieve_extensions</em> and <em>sieve_global_extensions</em> remain unconfigured, all supported extensions are available, except for deprecated extensions or those that are still under development.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ARGUMENTS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>script-file</em></p>
  </dt>
  <dd>
    <p>Specifies the Sieve script to (compile and) execute.</p><p>Note that this tool looks for a pre-compiled binary file with a <em>.svbin</em> extension and with basename and path identical to the specified script. Use the <strong>-C</strong> option to disable this behavior by forcing the script to be compiled into a new binary.</p>
  </dd>
  <dt>
    <p><em>source-mailbox</em></p>
  </dt>
  <dd>
    <p>Specifies the source mailbox containing the messages that the Sieve filter will act upon.</p><p>This is the name of a mailbox, as visible to IMAP clients, except in UTF-8 format. The hierarchy separator between a parent and child mailbox is commonly &apos;<strong>/</strong>&apos; or &apos;<strong>.</strong>&apos;, but this depends on your selected mailbox storage format and namespace configuration. The mailbox names may also require a namespace prefix.</p><p>This mailbox is not modified unless the <strong>-W</strong> option is specified.</p>
  </dd>
  <dt>
    <p><em>discard-action</em></p>
  </dt>
  <dd>
    <p>Specifies what is done with messages in the <em>source-mailbox</em> that where not kept or otherwise stored by the Sieve script; i.e. those messages that would normally be discarded if the Sieve script were executed at delivery. The <em>discard-action</em> parameter accepts one of the following values:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>keep</strong>(default)</p>
  </dt>
  <dd>
    <p>Keep discarded messages in source mailbox.</p>
  </dd>
  <dt>
    <p><strong>move</strong><em>mailbox</em></p>
  </dt>
  <dd>
    <p>Move discarded messages to the indicated <em>mailbox</em>. This is for instance useful to move messages to a Trash mailbox. Refer to the explanation of the <em>source-mailbox</em> argument for more information on mailbox naming.</p>
  </dd>
  <dt>
    <p><strong>delete</strong></p>
  </dt>
  <dd>
    <p>Flag discarded messages as &#92;DELETED.</p>
  </dd>
  <dt>
    <p><strong>expunge</strong></p>
  </dt>
  <dd>
    <p>Expunge discarded messages, meaning that these are removed irreversibly when the tool finishes filtering.</p>
  </dd>

</dl>
<ul>
<li><p>When the <strong>-W</strong> option is not specified, the <em>source-mailbox</em> is immutable and the specified <em>discard-action</em> has no effect. This means that messages are at most <em>copied</em> to a new location. In contrast, when the <strong>-W</strong> is specified, messages that are successfully stored somewhere else by the Sieve script are <strong>always</strong> expunged from the <em>source-mailbox</em>, with the effect that these are thus <em>moved</em> to the new location. This happens irrespective of the specified <em>discard-action</em>. Remember: only discarded messages are affected by the specified <em>discard-action</em>.</p></li>
</ul>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>[...]</p>
  </dt>
  <dd>
    
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">
<p><strong>sieve-filter</strong> will exit with one of the following values:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>0</strong></p>
  </dt>
  <dd>
    <p>Sieve filter applied successfully. (EX_OK, EXIT_SUCCESS)</p>
  </dd>
  <dt>
    <p><strong>1</strong></p>
  </dt>
  <dd>
    <p>Operation failed. This is returned for almost all failures. (EXIT_FAILURE)</p>
  </dd>
  <dt>
    <p><strong>64</strong></p>
  </dt>
  <dd>
    <p>Invalid parameter given. (EX_USAGE)</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>/etc/dovecot/dovecot.conf</em></p>
  </dt>
  <dd>
    <p>Dovecot&apos;s main configuration file.</p>
  </dd>
  <dt>
    <p><em>/etc/dovecot/conf.d/90-sieve.conf</em></p>
  </dt>
  <dd>
    <p>Sieve interpreter settings (included from Dovecot&apos;s main configuration file)</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">
<p>Report bugs, including <em>doveconf -n</em> output, to the Dovecot Mailing List &lt;dovecot@dovecot.org&gt;. Information about reporting Dovecot and Pigeonhole bugs is available at: http://dovecot.org/bugreport.html</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO sieve-filter&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/dovecot.1.html"><strong>dovecot</strong>(1)</a>, <a href="../man1/dovecot-lda.1.html"><strong>dovecot-lda</strong>(1)</a>, <a href="../man1/sieve-dump.1.html"><strong>sieve-dump</strong>(1)</a>, <a href="../man1/sieve-test.1.html"><strong>sieve-test</strong>(1)</a>, <a href="../man1/sievec.1.html"><strong>sievec</strong>(1)</a>, <a href="../man7/pigeonhole.7.html"><strong>pigeonhole</strong>(7)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="sieve-dump.1.html"><span aria-hidden="true">&larr;</span> sieve-dump.1: Pigeonholes sieve script binary dump tool</a></li>
   <li class="next"><a href="sieve-test.1.html">sieve-test.1: Pigeonholes sieve script tester <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
