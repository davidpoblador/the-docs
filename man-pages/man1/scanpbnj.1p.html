<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>scanpbnj: </title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="scanpbnj (1p) manual">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="https://www.carta.tech/images/pbnj-scanpbnj-1p.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1p/scanpbnj.1p.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="scanpbnj (1p) manual" />
  <meta property="og:description" content="" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/pbnj-scanpbnj-1p.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">scanpbnj<small> (1p)</small></h1>
        <p class="lead"></p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1p/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1p/scanpbnj.1p.html">
      <span itemprop="name">scanpbnj: </span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/pbnj/">
      <span itemprop="name">pbnj</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1p/scanpbnj.1p.html">
      <span itemprop="name">scanpbnj: </span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p> scanpbnj [Options] {target specification}</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p> ScanPBNJ performs an Nmap scan and then stores the results in  a database. The ScanPBNJ stores information about the machine that has  been scanned. ScanPBNJ stores the IP Address, Operating System,  Hostname and a localhost bit. The localhost bit, is simply a single  bit which is 1 when the target machine is localhost, otherwise it is  0. It also stores two timestamps for the machine table. The first is  a human readable version and the second is the unix time. Both of  these timestamp correspond to the first time that the machine was  scanned.</p><p> ScanPBNJ stores information about the services that are found to be  running on the target machine. ScanPBNJ stores typical information  about the service, by storing the port and protocol. Also, ScanPBNJ  stores version, product and service state information about each  service. The service state can either be up or down. Two timestamps  are also inserted for each instance of every service. The first is a  human readable version and the second is the unix time. Both of  these timestamp correspond to the time that the service was scanned.</p><p> This tool can give an admin a clear network layout with of  all the machines with all the services they are running.</p><p> Apart of PBNJ 2.0 suite of tools to monitor changes on a network.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p> Usage: scanpbnj [Options] {target specification}</p><p> Target Specification:    Can be a IP Address, hostname, network etc.    Ex: microsoft.com, 10.0.0.0/24, 192.168.1.1, 10.0.0.0-100    -i  --iplist &lt;iplist&gt;    Scan using a list of IPs from a file    -x  --xml &lt;xml-file&gt;     Parse scan/info from Nmap XML file</p><p> Scan Options:    -a  --args &lt;args&gt;        Execute Nmap with args (needs quotes)    -e  --extraargs &lt;args&gt;   Add args to the default args (needs quotes)        --inter &lt;interface&gt;  Perform scan with non default interface    -m  --moreports &lt;ports&gt;  Add ports to scan ex: 8080 or 3306,5900-5910    -n  --nmap &lt;path&gt;        Path to Nmap executable    -p  --pingscan           Ping Target then scan the alive host(s)        --udp                Add UDP to the scan arguments        --rpc                Add RPC to the scan arguments    -r  --range &lt;range&gt;      Ports for scan [def 1-1025]</p><p>        --diffbanner        Parse changes of the banner</p><p> Config Options:   -d    --dbconfig &lt;config&gt; Config for results database [def config.yaml]         --configdir &lt;dir&gt;   Directory for the database config file</p><p>        --data &lt;file&gt;       SQLite Database override [def data.dbl]         --dir &lt;dir&gt;         Directory for SQLite or CSV files [def .]</p><p> General Options:        --nocolors           Don't Print Colors        --test &lt;level&gt;       Testing information        --debug &lt;level&gt;      Debug information    -v  --version            Display version    -h  --help               Display this information</p><p> Send Comments to Joshua D. Abraham ( jabra@ccs.neu.edu )</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THINGS TO NOTE</h2>
        <div class="sectioncontent">
<p> * ScanPBNJ requires root privileges to perform a scan.</p><p> * If you do not pass a specific ports range, 1-1025 is used.</p><p> * If there are configs in the current directory, they are used  instead of those in the user's config directory.</p><p> * ScanPBNJ does not modify previous database entries. It simply  inserts new information when a change is found.</p><p> * One thing that should be done when performing scans is to make  sure to use the same ports or you will get false positives.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE SINGLE SCAN</h2>
        <div class="sectioncontent">
<p> 1) Scan a class B network on ports 1-9000</p><p>     sudo ./scanpbnj -r 1-9000 10.0.0.0/16</p><p> 2) Scan an IP Address on ports 1-9000</p><p>     sudo ./scanpbnj -r 1-9000 10.0.0.100</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE AUTOMATED SCANS</h2>
        <div class="sectioncontent">
<p> The following examples can be added to /etc/crontab</p><p> 1) Scan a Class C network every 2 hours</p><p> 30 */2 * * *   root scanpbnj 10.0.0.&#92;*</p><p> 2) Scan a Class C network everyday at 2:30</p><p> 30 2 * * *     root scanpbnj 10.0.0.&#92;*</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TARGET SPECIFICATION</h2>
        <div class="sectioncontent">
<p> The target specified is a typical method of probing the network.  Therefore, any of the following can be used:  (e.g. 10.0.0.1, 10.0.0.1-254, 10.0.0.0/24 or 10.0.0.&#92;* ).  The first example is simply an IP address. The second example is  the scanning of a range. The third is a range in CIDR notation.  The fourth example is the IP with the star which specifies to scan  255 hosts. This is the same format that Nmap uses with the only  exception being the &#92;* on the last octet. This is needed because it  needs to not interpret the star when it is being executed.</p><p> Another option, is to use a hostname or domain name. ScanPBNJ will  then resolve the name to the correct IP address. If you pass a  debug flag with level 1 or greater, ScanPBNJ will display what IP  address, the hostname resolved too.</p><p><strong>&#92;$1</strong></p><p> The iplist option is useful when you have a specific list of IPs to  scan. This will perform a full scan of the IPs that are specified.  This option is similar to using -sL with Nmap. The results of  the scan are inserted into the database.  This option is useful when you can't perform the scan yourself or  you don't want ScanPBNJ to perform the scan. Another situation where  this is useful, is if you have an XML file that was done in the past  and you want to extract information from it, possibly to compare  with what is currently being run on the target. ScanPBNJ parses the  Nmap XML file and extracts the information about the host(s) and  service(s) then inserts the results into the database.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SCAN OPTIONS</h2>
        <div class="sectioncontent">
<p> ** NOTE ** This option needs quotes around the passed arguments</p><p> This option will bypass the default arguments that are used in  scanning with Nmap. This can be used to do a particular type of scan  that is not possible by simply adding extra arguments. For example,  if you want to only scan UDP ports and still do version  identification and OS detection, you would do so using the following  notation:</p><p>  sudo scapbnj -a "-A -O -sU"  localhost  ** NOTE ** This option needs quotes around the passed arguments</p><p> This option will add additional arguments onto the default scan  arguments. This is most useful in doing scans where time optimization  is needed. Therefore, these arguments will be added and then used in  the scan.  This option sets an alternative interface for performing the scan.  This is useful when you have multiple interfaces on a machine  with restrictions on which devices can access certain IP or IP ranges.  This options adds additional ports to the range of ports to scan.  Individual port numbers are OK, as are ranges separated by a  hyphen (e.g. 1-1023,5800,5900,8080).</p><p> For example:</p><p>  sudo scanpbnj -m 7000-7500,8080  localhost</p><p> This scan would scan the default range as well 7000-7500 and 8080.  Use an alternative Nmap rather than Nmap located in the your path.  This is useful if you have multiple version of Nmap installed on  a system or if you are testing a new version of Nmap. Remember that if  you are using a newly compiled version of Nmap that you need to  export NMAPDIR to the location that Nmap was compiled in. Thus, if  you have compiled Nmap in your homedir, use the following notation:</p><p>  export NMAPDIR=$HOME/nmap-VERSION/</p><p>  sudo scanpbnj -n $HOME/nmap-VERISON/ localhost  The ping scan is a useful method of only scanning the host that are  responding to ICMP echo requests. This scan basically takes the host  that respond to ICMP echo requests and then performs a scan only on  those hosts. Therefore, no time is wasted in scanning hosts that do  not respond. The results of the scan are then inserted into the  database.  Perform a UDP scan, in addition to the default scan.</p><p>  sudo scanpbnj --udp localhost</p><p> If you want to only perform a UDP scan you need to set the specific  arguments for the scan.</p><p>  sudo scanpbnj -a "-vv -O -P0 1-1025 -sVU" localhost  Perform a RPC scan in addition to the default scan.</p><p>  sudo scanpbnj --udp localhost</p><p> If you want to only perform a RPC scan you need to set the specific  arguments for the scan.</p><p>  sudo scanpbnj -a "-vv -O -P0 1-1025 -sVR" localhost  Ports for scan [default 1-1025]</p><p> This option specifies which ports you want to scan and overrides the  default. Individual port numbers are OK, as are ranges separated by a  hyphen (e.g. 1-1023,5800,5900,8080 ).</p><p> Thus, a scan like this is ok.</p><p>  sudo scanpbnj -r 22,25,80,100-200  localhost</p><p> Also, if you have leave off the number after the hyphen it will scan  all from the start port to 65535.</p><p> For example:</p><p>  sudo scanpbnj -r 22,25- localhost  Parse changes of the banner</p><p> This options enables ScanPBNJ to do comparisons on the banner. The  reason this is not on by default is that it could show changes in  services that are not are important to the user. However, this option  is useful to a security professional who is looking for any changes  that occur so that they can be verified.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DATABASE OPTIONS</h2>
        <div class="sectioncontent">
<p> Config for results database [default config.yaml]</p><p> This option is used to specify an alternative config.yaml file.  Directory for Config file [default . ]</p><p> This option is used to specify an alternative directory for the  config.yaml file.  SQLite Database override [default data.dbl ]</p><p> This option is used when you want to change the name of the SQLite  database file that is generated.  Directory for SQLite or CSV files [default . ]</p><p> This option is used when you want the database to be generated in a  different directory.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">GENERAL OPTIONS</h2>
        <div class="sectioncontent">
<p> The default results from ScanPBNJ print the useful changes with colors  This options will simply not print the colors.  Increases the Test level, causing ScanPBNJ to print testing information  about the scan in progress. Using the Test level is mostly only using  for testing. This will also print the debugging information so it can  get rather lengthy. The greater the Test level the more output will be  given.</p><p> This option is also used for reporting bugs. All bug reports should  be submitted using --test 1 and an additional report may be needed  depending on the issue.  Increases the Debug level, causing ScanPBNJ to print more information  about the scan in progress. Nmap scanning arguments are shown as well  as the ip address if you are scanning a domain name. This option is  used to give the user more information about what the scanner is doing.  The higher the debug level the more output the user will receive.  Prints the ScanPBNJ version number and exits.  Prints a short help screen with the command flags.  Running ScanPBNJ  without any arguments does the same thing.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DEFAULT SCAN</h2>
        <div class="sectioncontent">
<p> Here are the default arguments that are used during a default scan:</p><p> -vv -O -P0 -sSV -p 1-1025</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p> PBNJ's data files are stored in ScanPBNJ and OutputPBNJ. When either  of these programs is run the configuration files will be generated  for the user if they don't already exists and placed in the  $HOME/.pbnj-2.0 directory. Again, if there is a configuration file  in the current directory it is used instead of the version in the  configuration directory.</p><p> $HOME/.pbnj-2.0/config.yaml - holds settings for connecting to  the database which store the information from PBNJ scans.</p><p> $HOME/.pbnj-2.0/query.yaml - lists all queries that can be used to  retrieve information from the database. Also, includes the name and  description for each query. This is only generated when you executed  OutputPBNJ.</p><p> For Windows, the pbnj-2.0 config directory is in the APPDATA  directory, which contains both config.yaml and query.yaml. Depending  on your environment, the APPDATA directory may be a different location  from other environments. Therefore, when the configs are executed for  the first time they will display the path where the configs were  generated.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FEATURE REQUESTS</h2>
        <div class="sectioncontent">
<p> Any feature requests should be reported to the online  feature-request-tracking system available on the web at :  http://sourceforge.net/tracker/?func=add&group_id=149390&atid=774489  Before requesting a feature, please check to see if the features has  already been requested.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUG REPORTS</h2>
        <div class="sectioncontent">
<p> Any bugs found should be reported to the online bug-tracking system  available on the web at :  http://sourceforge.net/tracker/?func=add&group_id=149390&atid=774488.  Before reporting a bug, please check to see if the bug has already been  reported.</p><p> When reporting PBNJ bugs, it is important to include a reliable way to  reproduce the bug, version number of PBNJ and Nmap, OS  name and version, and any relevant hardware specs. And of course,  patches to rectify the bug are even better.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SUPPORTED DATABASES</h2>
        <div class="sectioncontent">
<p> The following databases are supported:</p><p> * SQLite [default]  * MySQL  * Postgres  * CSV</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DATABASE SCHEMA</h2>
        <div class="sectioncontent">
<p> The following is the SQLite version of the database schema:</p><p> CREATE TABLE machines (             mid INTEGER PRIMARY KEY AUTOINCREMENT,             ip TEXT,             host TEXT,             localh INTEGER,             os TEXT,             machine_created TEXT,             created_on TEXT);  CREATE TABLE services (             mid INTEGER,             service TEXT,             state TEXT,             port INTEGER,             protocol TEXT,             version TEXT,             banner TEXT,             machine_updated TEXT,             updated_on TEXT);</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO scanpbnj&hellip;</h2>
        <div class="sectioncontent">
<p> <strong>outputpbnj</strong>(1), <strong>genlist</strong>(1), <a href="../man1/nmap.1.html"><strong>nmap</strong>(1)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p> Joshua D. Abraham ( jabra@ccs.neu.edu )</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LEGAL NOTICES</h2>
        <div class="sectioncontent">
<p> This program is distributed in the hope that it will be useful, but  WITHOUT ANY WARRANTY; without even the implied warranty of  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU  General Public License for more details at  http://www.gnu.org/copyleft/gpl.html, or in the COPYING file included  with PBNJ.</p><p> It should also be noted that PBNJ has occasionally been known to  crash poorly written applications, TCP/IP stacks, and even operating  systems.  While this is extremely rare, it is important to keep in  mind.  PBNJ should never be run against mission critical systems  unless you are prepared to suffer downtime. We acknowledge here that  PBNJ may crash your systems or networks and we disclaim all liability  for any damage or problems PBNJ could cause.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="save_binary_logs.1p.html"><span aria-hidden="true">&larr;</span> save_binary_logs.1p: Concatenating binary or relay logs from the specified file/position to the end of the log. this command is automatically executed from mha manager on failover, and manual execution should not be needed normally.</a></li>
   <li class="next"><a href="scriptor.1p.html">scriptor.1p: Perl script to send commands to a smart card <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
