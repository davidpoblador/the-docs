<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pgbouncer: Lightweight connection pooler for postgresql.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Lightweight connection pooler for postgresql.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="pgbouncer (1) manual">
  <meta name="twitter:description" content="Lightweight connection pooler for postgresql.">
  <meta name="twitter:image" content="https://www.carta.tech/images/pgbouncer-pgbouncer-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/pgbouncer.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="pgbouncer (1) manual" />
  <meta property="og:description" content="Lightweight connection pooler for postgresql." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/pgbouncer-pgbouncer-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pgbouncer<small> (1)</small></h1>
        <p class="lead">Lightweight connection pooler for postgresql.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/pgbouncer.1.html">
      <span itemprop="name">pgbouncer: Lightweight connection pooler for postgresql.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/pgbouncer/">
      <span itemprop="name">pgbouncer</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/pgbouncer.1.html">
      <span itemprop="name">pgbouncer: Lightweight connection pooler for postgresql.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
pgbouncer [-d][-R][-v][-u user] &lt;pgbouncer.ini&gt;
pgbouncer -V|-h
</pre>
<p>On Windows computers, the options are:</p>
<pre>
pgbouncer.exe [-v][-u user] &lt;pgbouncer.ini&gt;
pgbouncer.exe -V|-h
</pre>
<p>Additional options for setting up a Windows service:</p>
<pre>
pgbouncer.exe -regservice   &lt;pgbouncer.ini&gt;
pgbouncer.exe -unregservice &lt;pgbouncer.ini&gt;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>pgbouncer is a PostgreSQL connection pooler. Any target application can be connected to pgbouncer as if it were a PostgreSQL server, and pgbouncer will create a connection to the actual server, or it will reuse one of its existing connections.</p><p>The aim of pgbouncer is to lower the performance impact of opening new connections to PostgreSQL.</p><p>In order not to compromise transaction semantics for connection pooling, pgbouncer supports several types of pooling when rotating connections:</p><p>Session pooling</p><p>Most polite method. When client connects, a server connection will be assigned to it for the whole duration the client stays connected. When the client disconnects, the server connection will be put back into the pool. This is the default method.</p><p>Transaction pooling</p><p>A server connection is assigned to client only during a transaction. When PgBouncer notices that transaction is over, the server connection will be put back into the pool.</p><p>Statement pooling</p><p>Most aggressive method. The server connection will be put back into pool immediately after a query completes. Multi-statement transactions are disallowed in this mode as they would break.</p><p>The administration interface of pgbouncer consists of some new SHOW commands available when connected to a special <em>virtual</em> database pgbouncer.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">QUICK-START</h2>
        <div class="sectioncontent">
<p>Basic setup and usage as following.</p><p>Create a pgbouncer.ini file. Details in <a href="../man5/pgbouncer.5.html"><strong>pgbouncer</strong>(5)</a>. Simple example:</p>
<pre>
[databases]
template1 = host=127.0.0.1 port=5432 dbname=template1
</pre>

<pre>
[pgbouncer]
listen_port = 6543
listen_addr = 127.0.0.1
auth_type = md5
auth_file = users.txt
logfile = pgbouncer.log
pidfile = pgbouncer.pid
admin_users = someuser
</pre>
<p>Create a users.txt file:</p>
<pre>
"someuser" "same_password_as_in_server"
</pre>
<p>Launch pgbouncer:</p>
<pre>
$ pgbouncer -d pgbouncer.ini
</pre>
<p>Have your application (or the psql client) connect to pgbouncer instead of directly to PostgreSQL server.</p>
<pre>
$ psql -p 6543 -U someuser template1
</pre>
<p>Manage pgbouncer by connecting to the special administration database pgbouncer and issuing show help; to begin:</p>
<pre>
$ psql -p 6543 -U someuser pgbouncer
pgbouncer=# show help;
NOTICE:  Console usage
DETAIL:
  SHOW [HELP|CONFIG|DATABASES|FDS|POOLS|CLIENTS|SERVERS|SOCKETS|LISTS|VERSION]
  SET key = arg
  RELOAD
  PAUSE
  SUSPEND
  RESUME
  SHUTDOWN
</pre>
<p>If you made changes to the pgbouncer.ini file, you can reload it with:</p>
<pre>
pgbouncer=# RELOAD;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMMAND LINE SWITCHES</h2>
        <div class="sectioncontent">
<p>-d</p><p>Run in background. Without it the process will run in foreground. Note: Does not work on Windows, pgbouncer need to run as service there.</p><p>-R</p><p>Do an online restart. That means connecting to the running process, loading the open sockets from it, and then using them. If there is no active process, boot normally. Note: Works only if OS supports Unix sockets and the unix_socket_dir is not disabled in config. Does not work on Windows machines.</p><p>-u user</p><p>Switch to the given user on startup.</p><p>-v</p><p>Increase verbosity. Can be used multiple times.</p><p>-q</p><p>Be quiet - do not log to stdout. Note this does not affect logging verbosity, only that stdout is not to be used. For use in init.d scripts.</p><p>-V</p><p>Show version.</p><p>-h</p><p>Show short help.</p><p>-regservice</p><p>Win32: Register pgbouncer to run as Windows service. The service_name config parameter value is used as name to register under.</p><p>-unregservice</p><p>Win32: Unregister Windows service.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ADMIN CONSOLE</h2>
        <div class="sectioncontent">
<p>The console is available by connecting as normal to the database pgbouncer</p>
<pre>
$ psql -p 6543 pgbouncer
</pre>
<p>Only users listed in configuration parameters admin_users or stats_users are allowed to login to the console. (Except when auth_mode=any, then any user is allowed in as an admin.)</p><p>Additionally, the username pgbouncer is allowed to log in without password, if the login comes via Unix socket and the client has same Unix user uid as the running process.</p><h3>SHOW COMMANDS</h3>
<p>The SHOW commands output information. Each command is described below.</p><p><strong>SHOW STATS;</strong></p><p>Shows statistics.</p><p>database</p><p>Statistics are presented per database.</p><p>total_requests</p><p>Total number of SQL requests pooled by pgbouncer.</p><p>total_received</p><p>Total volume in bytes of network traffic received by pgbouncer.</p><p>total_sent</p><p>Total volume in bytes of network traffic sent by pgbouncer.</p><p>total_query_time</p><p>Total number of microseconds spent by pgbouncer when actively connected to PostgreSQL.</p><p>avg_req</p><p>Average requests per second in last stat period.</p><p>avg_recv</p><p>Average received (from clients) bytes per second.</p><p>avg_sent</p><p>Average sent (to clients) bytes per second.</p><p>avg_query</p><p>Average query duration in microseconds.</p><p><strong>SHOW SERVERS;</strong></p><p>type</p><p>S, for server.</p><p>user</p><p>Username pgbouncer uses to connect to server.</p><p>database</p><p>Database name.</p><p>state</p><p>State of the pgbouncer server connection, one of active, used or idle.</p><p>addr</p><p>IP address of PostgreSQL server.</p><p>port</p><p>Port of PostgreSQL server.</p><p>local_addr</p><p>Connection start address on local machine.</p><p>local_port</p><p>Connection start port on local machine.</p><p>connect_time</p><p>When the connection was made.</p><p>request_time</p><p>When last request was issued.</p><p>ptr</p><p>Address of internal object for this connection. Used as unique ID.</p><p>link</p><p>Address of client connection the server is paired with.</p><p><strong>SHOW CLIENTS;</strong></p><p>type</p><p>C, for client.</p><p>user</p><p>Client connected user.</p><p>database</p><p>Database name.</p><p>state</p><p>State of the client connection, one of active, used, waiting or idle.</p><p>addr</p><p>IP address of client.</p><p>port</p><p>Port client is connected to.</p><p>local_addr</p><p>Connection end address on local machine.</p><p>local_port</p><p>Connection end port on local machine.</p><p>connect_time</p><p>Timestamp of connect time.</p><p>request_time</p><p>Timestamp of latest client request.</p><p>ptr</p><p>Address of internal object for this connection. Used as unique ID.</p><p>link</p><p>Address of server connection the client is paired with.</p><p><strong>SHOW POOLS;</strong></p><p>A new pool entry is made for each couple of (database, user).</p><p>database</p><p>Database name.</p><p>user</p><p>User name.</p><p>cl_active</p><p>Client connections that are linked to server connection and can process queries.</p><p>cl_waiting</p><p>Client connections have sent queries but have not yet got a server connection.</p><p>sv_active</p><p>Server connections that linked to client.</p><p>sv_idle</p><p>Server connections that unused and immediately usable for client queries.</p><p>sv_used</p><p>Server connections that have been idle more than server_check_delay, so they needs server_check_query to run on it before it can be used.</p><p>sv_tested</p><p>Server connections that are currently running either server_reset_query or server_check_query.</p><p>sv_login</p><p>Server connections currently in logging in process.</p><p>maxwait</p><p>How long the first (oldest) client in queue has waited, in seconds. If this starts increasing, then the current pool of servers does not handle requests quick enough. Reason may be either overloaded server or just too small of a pool_size setting.</p><p><strong>SHOW LISTS;</strong></p><p>Show following internal information, in columns (not rows):</p><p>databases</p><p>Count of databases.</p><p>users</p><p>Count of users.</p><p>pools</p><p>Count of pools.</p><p>free_clients</p><p>Count of free clients.</p><p>used_clients</p><p>Count of used clients.</p><p>login_clients</p><p>Count of clients in login state.</p><p>free_servers</p><p>Count of free servers.</p><p>used_servers</p><p>Count of used servers.</p><p><strong>SHOW USERS;</strong></p><p>Shows one line per user, under the name column name.</p><p><strong>SHOW DATABASES;</strong></p><p>name</p><p>Name of configured database entry.</p><p>host</p><p>Host pgbouncer connects to.</p><p>port</p><p>Port pgbouncer connects to.</p><p>database</p><p>Actual database name pgbouncer connects to.</p><p>force_user</p><p>When user is part of the connection string, the connection between pgbouncer and PostgreSQL is forced to the given user, whatever the client user.</p><p>pool_size</p><p>Maximum number of server connections.</p><p><strong>SHOW FDS;</strong></p><p>Shows list of fds in use. When the connected user has username "pgbouncer", connects through Unix socket and has same UID as running process, the actual fds are passed over the connection. This mechanism is used to do an online restart. Note: This does not work on Windows machines.</p><p>fd</p><p>File descriptor numeric value.</p><p>task</p><p>One of pooler, client or server.</p><p>user</p><p>User of the connection using the FD.</p><p>database</p><p>Database of the connection using the FD.</p><p>addr</p><p>IP address of the connection using the FD, unix if a unix socket is used.</p><p>port</p><p>Port used by the connection using the FD.</p><p>cancel</p><p>Cancel key for this connection.</p><p>link</p><p>fd for corresponding server/client. NULL if idle.</p><p><strong>SHOW CONFIG;</strong></p><p>Show the current configuration settings, one per row, with following columns:</p><p>key</p><p>Configuration variable name</p><p>value</p><p>Configuration value</p><p>changeable</p><p>Either yes or no, shows if the variable can be changed while running. If no, the variable can be changed only boot-time.</p><p><strong>SHOW DNS_HOSTS</strong></p><p>Show hostnames in DNS cache.</p><p>hostname</p><p>Host name.</p><p>ttl</p><p>How meny seconds until next lookup.</p><p>addrs</p><p>Comma separated list of addresses.</p><p><strong>SHOW DNS_ZONES</strong></p><p>Show DNS zones in cache.</p><p>zonename</p><p>Zone name.</p><p>serial</p><p>Current serial.</p><p>count</p><p>Hostnames belonging to this zone.</p>
<h3>PROCESS CONTROLLING COMMANDS</h3>
<p><strong>PAUSE [db];</strong></p><p>PgBouncer tries to disconnect from all servers, first waiting for all queries to complete. The command will not return before all queries are finished. To be used at the time of database restart.</p><p>If database name is given, only that database will be paused.</p><p><strong>KILL db;</strong></p><p>Immediately drop all client and server connections on given database.</p><p><strong>SUSPEND;</strong></p><p>All socket buffers are flushed and PgBouncer stops listening for data on them. The command will not return before all buffers are empty. To be used at the time of PgBouncer online reboot.</p><p><strong>RESUME [db];</strong></p><p>Resume work from previous PAUSE or SUSPEND command.</p><p><strong>SHUTDOWN;</strong></p><p>The PgBouncer process will exit.</p><p><strong>RELOAD;</strong></p><p>The PgBouncer process will reload its configuration file and update changeable settings.</p>
<h3>SIGNALS</h3>
<p>SIGHUP</p><p>Reload config. Same as issuing command RELOAD; on console.</p><p>SIGINT</p><p>Safe shutdown. Same as issuing PAUSE; and SHUTDOWN; on console.</p><p>SIGTERM</p><p>Immediate shutdown. Same as issuing SHUTDOWN; on console.</p>
<h3>LIBEVENT SETTINGS</h3>
<p>From libevent docs:</p>
<pre>
It is possible to disable support for epoll, kqueue, devpoll, poll
or select by setting the environment variable EVENT_NOEPOLL,
EVENT_NOKQUEUE, EVENT_NODEVPOLL, EVENT_NOPOLL or EVENT_NOSELECT,
respectively.
</pre>

<pre>
By setting the environment variable EVENT_SHOW_METHOD, libevent
displays the kernel notification method that it uses.
</pre>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO pgbouncer&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/pgbouncer.5.html"><strong>pgbouncer</strong>(5)</a> - manpage of configuration settings descriptions.</p><p>\m[blue]<strong>http://wiki.postgresql.org/wiki/PgBouncer</strong>\m[]</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pgagent.1.html"><span aria-hidden="true">&larr;</span> pgagent.1: A job scheduler for postgresql.</a></li>
   <li class="next"><a href="pgdbf.1.html">pgdbf.1: Convert xbase / foxpro tables to postgresql <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
