<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>lamshrink: Shrink a lam universe.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Shrink a lam universe.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="lamshrink (1) manual">
  <meta name="twitter:description" content="Shrink a lam universe.">
  <meta name="twitter:image" content="https://www.carta.tech/images/lam-runtime-lamshrink-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/lamshrink.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="lamshrink (1) manual" />
  <meta property="og:description" content="Shrink a lam universe." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/lam-runtime-lamshrink-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">lamshrink<small> (1)</small></h1>
        <p class="lead">Shrink a lam universe.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/lamshrink.1.html">
      <span itemprop="name">lamshrink: Shrink a lam universe.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/lam-runtime/">
      <span itemprop="name">lam-runtime</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/lamshrink.1.html">
      <span itemprop="name">lamshrink: Shrink a lam universe.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>lamshrink [-dhv] [-w delay] nodeid</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-d</strong></p>
  </dt>
  <dd>
    <p>Print detailed debugging information.</p>
  </dd>
  <dt>
    <p><strong>-h</strong></p>
  </dt>
  <dd>
    <p>Print useful information on this command.</p>
  </dd>
  <dt>
    <p><strong>-v</strong></p>
  </dt>
  <dd>
    <p>Be verbose.</p>
  </dd>
  <dt>
    <p><strong>-w delay</strong></p>
  </dt>
  <dd>
    <p>Notify processes on the doomed node and pause for delay seconds before proceeding.</p>
  </dd>
  <dt>
    <p><strong>nodeid</strong></p>
  </dt>
  <dd>
    <p>Remove the LAM node with this ID.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>An existing LAM session, initiated by <a href="../man1/lamboot.1.html"><strong>lamboot</strong>(1)</a>, can be shrunk to include less nodes with <em>lamshrink</em>. One node is removed for each invocation.  At a minimum, the node ID is given on the command line.  Once <em>lamshrink</em> completes, the node ID is invalid across the remaining nodes (as can be seen by running <a href="../man1/lamnodes.1.html"><strong>lamnodes</strong>(1)</a>).</p><p>Existing application processes on the target node can be warned of impending shutdown with the -w option.  A LAM signal (SIGFUSE) will be sent to these processes and <em>lamshrink</em> will then pause for the given number of seconds before proceeding with removing the node.  By default, SIGFUSE is ignored.  A different handler can be installed with <strong>ksignal</strong>(2).</p><p>All application processes on all remaining nodes are always informed of the death of a node.  This is also done with a signal (SIGSHRINK), which by default causes a process's runtime route cache to be flushed (to remove any cached information on the dead node).  If this signal is re-vectored for the purpose of fault tolerance, the old handler should be called at the beginning of the new handler.  The signal does not, by itself, give the process information on which node has been removed.  One technique for getting this information is to query the router for information on all relevant nodes using <strong>getroute</strong>(2).  The dead node will cause this routine to return an error.</p><h3>FAULT TOLERANCE</h3>
<p>If enabled with <a href="../man1/lamboot.1.html"><strong>lamboot</strong>(1)</a>, LAM will watch for nodes that fail.  The procedure for removing a node that has failed is the same as <em>lamshrink</em> after the warning step.  In particular, the SIGSHRINK signal is delivered.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>lamshrink -v n1 Remove LAM on n1.  Report about important steps as</p>
  </dt>
  <dd>
    <p>they are done.</p>
  </dd>
  <dt>
    <p>lamshrink n30 -w 10</p>
  </dt>
  <dd>
    <p>Inform all processes on LAM node 30, that the node will be dead in 10 seconds.  Wait 10 seconds and remove the node.  Operate silently.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO lamshrink&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/lamboot.1.html"><strong>lamboot</strong>(1)</a>, <a href="../man1/lamnodes.1.html"><strong>lamnodes</strong>(1)</a>, <strong>ksignal</strong>(2), <strong>getroute</strong>(2)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="lamnodes.1.html"><span aria-hidden="true">&larr;</span> lamnodes.1: Resolve lam node/cpu notation to unix hostnames.</a></li>
   <li class="next"><a href="lamson.1.html">lamson.1: Lamson is a modern pythonic mail server built like a web application server. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
