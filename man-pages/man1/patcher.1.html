<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>patcher: A patch maintenance tool</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A patch maintenance tool">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="patcher (1) manual">
  <meta name="twitter:description" content="A patch maintenance tool">
  <meta name="twitter:image" content="https://www.carta.tech/images/patcher-patcher-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/patcher.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="patcher (1) manual" />
  <meta property="og:description" content="A patch maintenance tool" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/patcher-patcher-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">patcher<small> (1)</small></h1>
        <p class="lead">A patch maintenance tool</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/patcher.1.html">
      <span itemprop="name">patcher: A patch maintenance tool</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/patcher/">
      <span itemprop="name">patcher</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/patcher.1.html">
      <span itemprop="name">patcher: A patch maintenance tool</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    patcher [-n &lt;patchname&gt;] [&lt;file ...&gt;]
  </dt>
  <dd>
    <p>Edit &lt;file&gt; as part of the patch &lt;patchname&gt;.</p>
  </dd>
  <dt>
    patcher -r
  </dt>
  <dd>
    <p>Refresh current patch.</p>
  </dd>
  <dt>
    patcher [-f] -b
  </dt>
  <dd>
    <p>Move back one patch to the previous one.</p>
  </dd>
  <dt>
    patcher [-f] -b &lt;patch&gt;
  </dt>
  <dd>
    <p>Move back in series until we're at &lt;patch&gt;.</p>
  </dd>
  <dt>
    patcher [-f] -b &lt;num&gt;
  </dt>
  <dd>
    <p>Move back &lt;num&gt; patches in series.</p>
  </dd>
  <dt>
    patcher -a
  </dt>
  <dd>
    <p>Apply the next patch in the series.</p>
  </dd>
  <dt>
    patcher -a &lt;patch&gt;
  </dt>
  <dd>
    <p>Apply all patches from the series until we've reached at &lt;patch&gt;.</p>
  </dd>
  <dt>
    patcher -a &lt;num&gt;
  </dt>
  <dd>
    <p>Apply next &lt;num&gt; patches from series.</p>
  </dd>
  <dt>
    patcher -n &lt;patchname&gt; [-p &lt;n&gt;] -i &lt;diff&gt;
  </dt>
  <dd>
    <p>Import an external diff file into patch &lt;patchname&gt;. Strip &lt;n&gt; levels from the directory names. Please note that patch allows '-p1', but we only '-p 1'.</p>
  </dd>
  <dt>
    patcher [-f] [-n &lt;patchname&gt;] [-p &lt;n&gt;] -i &lt;patch ...&gt;
  </dt>
  <dd>
    <p>Import an external diff file into patch &lt;patchname&gt;. Strip &lt;n&gt; levels from the directory names. Please note that patch allows '-p1', but we only '-p 1'.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONCEPT</h2>
        <div class="sectioncontent">
<p>Patcher is a perl script which I use for managing patches.  It's quite powerful, easy to use, and fast.</p><p>Patcher keeps track of which files you change. It then can generate patches from your changes, no need for you to handle the diff tool manually.</p><p>You can have more than one record of file changes, we call this a patch. A patch is something that the <em>patch</em>\|(1) command can apply.</p><p>The patches can be stacked in series, they define the order they have to applied. Patcher keeps series information as well as information which patches have been applied and which not.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Later we will have a walkthrought, but let me first explain the basic operation modes of patcher:</p><p><strong>&#92;$1</strong></p><p>When you call patcher with a filename, patch will make a backup of this file (if the file exists).  Now you can create or change the file. Later you can ask patcher to create a unified diff with all your changes. Just call \*(L"patcher -r\*(R" and you will get a unified diff of all your additions, modification and deletions. The diff will be stored in .patches/&lt;patchname&gt;.patch. It is in a form that allows direct application via <em>patch</em>\|(1) or, of course, via \*(L"patcher -i\*(R".</p><p>Whenever you do \*(L"patcher -r\*(R" your .patches/&lt;patchname&gt;.patch file get's refreshed. To revoke your changes and go to the previous version, just enter \*(L"patcher -b\*(R". Patcher will make sure that you don't loose your changes by asking you to create a diff if something has changed since the last refresh. You may use -f (or --force) patcher to go back anyway.</p><p>You can back out more than one patch by either specifying a number a patch name after -b. With \*(L"patcher -n &lt;patchname&gt; -a\*(R" one can apply an already existing managed patch. A managed patch is a patch that already is stored in the .patches directory and is mentioned in the .patches/series file. Patcher tests if the patch would apply without problem and applies it. If the patch would be rejected, you can use -f (or --force) to apply the patch anyway.</p><p>You can apply more than one patch by either specifying a number a patch name after -a. Sometimes you have an external patch. That's the opposite of a managed patch, the patch is not stored in the .patches directory. By importing it, it will become a managed patch.</p><p>Import the patch simply with -i &lt;filename&gt;. You can use -p &lt;num&gt; to specify the directory level, similar to the -p&lt;num&gt; option of <em>patch</em>\|(1). But please keep in mind that we need a space between -p and the number.</p><p>Normally only clean patches will be imported. To import a patch that creates rejects use -f (or --force). You'll see a list of files where the patch did not apply cleanly, fix the problems manually.</p><p>Later you can use \*(L"patcher -r\*(R" to create a clean patch.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INSTALLATION</h2>
        <div class="sectioncontent">
<p>Just place patcher somewhere in your path. That's all.</p><p>For each project Patcher requires one  special directory called \*(L".patches\*(R". It will search for this directory. If it does not exist, patcher creates it automatically.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INTERNALS</h2>
        <div class="sectioncontent">
<p>All work occurs with a single directory tree. All commands are invoked within the root of that tree (\s-1TODO:\s0 this can and should change). Patcher manages a \*(L"stack\*(R" of patches.</p><p>Each patch is a changeset against the base tree plus the preceding patches.</p><p>All patches are listed, in order, in the file \*(L".patches/series\*(R". Patcher adds patches into this file, but never deletes entries. You can edit this file with a text editor, but please do only so if the patch you delete is currently not applied.</p><p>Any currently applied patches is listed in the file \*(L".patches/applied\*(R". The patcher manage this file, there is no need for you to ever edit this file manually.</p><p>Each patch affects a number of files in the tree. These files are listed in a file list named \*(L".patches/*.files\*(R". Patcher manages them. When you back out a patch, this file will deleted. Or, in other words, this file exists only for applied patches. It's only used by \*(L"patcher -r\*(R".</p><p>Patches are placed into \*(L".patches/*.patch\*(R" files. They are always unified diffs with -p1 as patchlevel. You can copy then anywhere, the <em>patch</em>\|(1) utility will read them without problems.</p><p>Optionally you can put descriptions for the patches in files named \*(L".patches/*.txt\*(R".</p><p>So for a particular patch \*(L"my-first-patch\*(R" the following will exist:</p><ul>
<li><p>An entry \*(L"my-first-patch.patch\*(R" in \*(L".patches/series\*(R".</p></li><li><p>An entry \*(L"my-first-patch\*(R" in \*(L".patches/applied\*(R" (if it's currently applied)</p></li><li><p>A file \*(L".patches/my-first-patch.files\*(R" which contains the names of the files which my-first-patch modifies, adds or removes</p></li><li><p>A file \*(L".patches/my-first-patch.patch\*(R", which is the context diff, basically the main output of patcher.</p></li><li><p>Optionally a file \*(L".patches/my-first-patch.txt\*(R" which contains the patch's changelog, description or whatever you put in there.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">WALKTHROUGHT</h2>
        <div class="sectioncontent">
<p>Let's start.</p><p>Go into /usr/src/linux (or wherever).</p><p>Now let's start with changing some source files:</p>
<pre>
        patcher -n my-patch kernel/sched.c
</pre>
<p>\s-1OK\s0, patcher copied kernel/sched.c to kernel/sched.c~my-patch for you, the program has also done some magic in the .patches directory, which won't be of interest to us now.</p><p>        Now edit kernel/sched.c a bit.</p><p>Now we're ready to document the patch:</p><p>        Create .patches/my-patch.txt</p><p>Now generate a patch:</p><p>        patcher -r</p><p>This will generate \*(L".patches/my-patch.patch\*(R". Take a look at this file.</p><p>Now we remove our change to sched.c by going backwards:</p><p>        patcher -b</p><p>Look at where we're now:</p><p>        patcher -s</p><p>Now let's add another file to my-patch. First we re-apply the patch:</p><p>        patcher -a</p><p>Now edit a second file:</p><p>        patcher kernel/printk.c</p><p>Note that here we gave patcher a single argument, without command line options. This always tells patcher to add another file to the current patch.</p><p>        Edit kernel/printk.c</p><p>Refresh my-patch:</p><p>        patcher -r</p><p>Now start a second patch:</p><p>        patcher -n my-second-patch kernel/sched.c</p><p>Here we have a filename in the command line for patcher, so we edit a file. But now we specified a patch name with -n. This told patcher to create a new patch. Now patcher manages two patches, \*(L"my-patch\*(R" and \*(L"my-second-patch\*(R".</p><p>        Edit kernel/sched.c, to make some changes for my-second-patch</p><p>Generate my-second-patch:</p><p>        patcher -r</p><p>Take a look in \*(L".patches/my-second-patch.patch\*(R".</p><p>Also note that \*(L"my-second-patch.patch\*(R" has been added to the series file. Whenever you manually begin a patch, it will automatically be put into the series file.</p><p>In this way, the whole thing is stackable. If you have four patches applied, say \*(L"patch-1\*(R", \*(L"patch-2\*(R", \*(L"patch-3\*(R" and \*(L"patch-4\*(R", and if patch-2 and patch-4 both touch kernel/sched.c then you will have:</p>
<dl class='dl-vertical'>
  <dt>
    kernel/sched.c~patch-2
  </dt>
  <dd>
    <p>Original copy, before patch-2</p>
  </dd>
  <dt>
    kernel/sched.c~patch-4
  </dt>
  <dd>
    <p>Copy before patch-4. Contains changes from patch-2</p>
  </dd>
  <dt>
    kernel/sched.c
  </dt>
  <dd>
    <p>Current working copy. Contains changes from patch-4.</p>
  </dd>

</dl>
<p>This means that your diff headers contain \*(L"~patch-name\*(R" in them, which is convenient documentation.</p><p>To end our tour, we remove both patches:</p><p>        patcher -b         patcher -b</p><p>That's pretty much it, really.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO patcher&hellip;</h2>
        <div class="sectioncontent">
<p>Andrew Morton's patch scripts at http://www.zip.com.au/~akpm/linux/patches/</p><p>I stole the idea from him and even most of this documentation.</p><p>At http://savannah.nongnu.org/projects/quilt/ you'll find Quilt. That's the successor of Andrew's original scripts. They do the same as patcher (and slightly more), but with tenthousand shell scripts.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Holger Schurig &lt;holgerschurig usingthedomain gmx.de&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="patchelf.1.html"><span aria-hidden="true">&larr;</span> patchelf.1: Modify elf files</a></li>
   <li class="next"><a href="patchwork.1.html">patchwork.1: Filter for drawing clustered graphs as treemaps <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
