<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>mz: A fast versatile packet generator</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A fast versatile packet generator">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="mz (1) manual">
  <meta name="twitter:description" content="A fast versatile packet generator">
  <meta name="twitter:image" content="https://www.carta.tech/images/mz-mz-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/mz.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="mz (1) manual" />
  <meta property="og:description" content="A fast versatile packet generator" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/mz-mz-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">mz<small> (1)</small></h1>
        <p class="lead">A fast versatile packet generator</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/mz.1.html">
      <span itemprop="name">mz: A fast versatile packet generator</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/mz/">
      <span itemprop="name">mz</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/mz.1.html">
      <span itemprop="name">mz: A fast versatile packet generator</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>mz</strong> [<em>options</em>]<em>&lt;arg_string&gt; | &lt;hex_string&gt;</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>Mausezahn</strong> is a free fast traffic generator written in C which allows you to send nearly every possible and impossible packet.</p><p>Mausezahn can also be used for example as didactical tool in network labs or for security audits including penetration and DoS testing. As traffic generator Mausezahn is for example used test IP multicast or VoIP networks. Speeds close to the Ethernet limit are reachable (depending on the hardware platform, especially the quality of the network interface card).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE</h2>
        <div class="sectioncontent">
<p>Mausezahn supports two modes, <strong>direct mode</strong> and a multi-threaded <strong>interactive mode</strong>.</p><p>The <strong>direct mode</strong> allows you to create a packet directly on the Linux/UN*X shell and every packet parameter is specified in the argument list when calling Mausezahn.</p><p>The <strong>interactive mode</strong> is an advanced multi-threaded configuration mode with its own command line interface (CLI). This mode allows you to create an arbitrary number of packet types and streams in parallel, each with different parameters. The interactive mode utilizes a completely redesigned and more flexible protocol framework called MOPS (Mausezahn's Own Packet System). The look and feel of the CLI is very similar to the Cisco IOS(tm) command line. You can start the interactive mode by executing Mausezahn with the <em>-x</em> argument (an optional port number may follow, otherwise it is 25542). Then use Telnet to connect to this Mausezahn instance (the default login expects the user 'mz' with password 'mz', and enable password 'mops'; you can change this in /etc/mausezahn/mz.cfg). More information about the interactive mode and MOPS is provided on the Mausezahn website.</p><p>The <strong>direct mode</strong> supports two specification schemes: The <strong>raw-layer-2</strong> scheme, where every single byte to be sent can be specified, and <strong>higher-layer</strong> scheme, where packet builder interfaces are used (using the <em>-t</em> option).</p><p>To use the <strong>raw-layer-2</strong> scheme, simply specify the desired frame as hexadecimal sequence (the <em>hex_string</em>), such as</p><p>mz eth0 "00:ab:cd:ef:00 00:00:00:00:00:01 08:00 ca:fe:ba:be"</p><p>In this example, the spaces within the byte string are optional and separate the Ethernet fields (destination and source address, type field, and a short payload). The only additional options supported are <em>-a</em>, <em>-b</em>, <em>-c</em>, and <em>-p</em>. The frame length MUST be greater or equal 15 bytes.</p><p>The <strong>higher-layer</strong> scheme is enabled using the <em>-t &lt;packet_type&gt;</em> option. This option activates a packet builder and besides the <em>packet_type</em> an optional <em>arg_string</em> can be specified. The <em>arg_string</em> contains packet-specific parameters, such as TCP flags, port numbers, etc; see the EXAMPLES below.</p><p>Note that Mausezahn requires root privileges. Please see the Mausezahn User's Guide for more details or use Mausezahn's command line help.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>Mausezahn provides a built-in context-specific help. Simply append the keyword <strong>help</strong> to the configuration options.</p><p>The most important options are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-v</strong></p>
  </dt>
  <dd>
    <p>Verbose mode. Capital -V is even more verbose.</p>
  </dd>
  <dt>
    <p><strong>-S</strong></p>
  </dt>
  <dd>
    <p>Simulation mode, i. e. don't put anything on the wire. This is typically combined with the verbose mode.</p>
  </dd>
  <dt>
    <p><strong>-q</strong></p>
  </dt>
  <dd>
    <p>Quiet mode (only warnings and errors are displayed).</p>
  </dd>
  <dt>
    <p><strong>-c &lt;count&gt;</strong></p>
  </dt>
  <dd>
    <p>Send the packet count times (default: 1, infinite: 0).</p>
  </dd>
  <dt>
    <p><strong>-d &lt;delay&gt;</strong></p>
  </dt>
  <dd>
    <p>Apply delay between transmissions. The delay value can be specified in usec (default, no additional unit needed), or in msec (e. g. 100m or 100msec), or in seconds (e. g. 100s or 100sec). Note: MOPS also supports nanosecond delay granulation if you need it (see: interactive mode).</p>
  </dd>
  <dt>
    <p><strong>-p &lt;lenght&gt;</strong></p>
  </dt>
  <dd>
    <p>Pad the raw frame to specified length (using zero bytes). Note that for raw layer 2 frames the specified length defines the whole frame length, while for higher layer packets the number of additional padding bytes are specified.</p>
  </dd>
  <dt>
    <p><strong>-a &lt;Src_MAC|keyword&gt;</strong></p>
  </dt>
  <dd>
    <p>Use specified source mac address (use hex notation such as 00:00:aa:bb:cc:dd). By default the interface MAC address will be used. The keywords <em>rand</em> and <em>own</em> refer to a random MAC address (only unicast addresses are created) and the own address, respectively. You can also use the keywords mentioned below (although broadcast-type source addresses are officially invalid).</p>
  </dd>
  <dt>
    <p><strong>-b &lt;Dst_MAC|keyword&gt;</strong></p>
  </dt>
  <dd>
    <p>Use specified destination mac address.  By default a broadcast is sent in raw layer 2 mode or the destination hosts/gateways interface MAC address in normal (IP) mode. You can use the same keywords as mentioned above as well as <em>bc</em> (or <em>bcast</em>), <em>cisco</em>, and <em>stp</em>. Please note that for the destination MAC address the <em>rand</em> keyword is supported but creates a random address only once, even when you send multiple packets.</p>
  </dd>
  <dt>
    <p><strong>-A &lt;Src_IP|range|rand&gt;</strong></p>
  </dt>
  <dd>
    <p>Use specified source IP address (default is own interface IP). Optionally the keyword <em>rand</em> can again be used for a random source IP address or a range can be specified, such as 192.168.1.1-192.168.1.100 or 10.1.0.0/16. Also a DNS name can be specified for which Mausezahn tries to determine the corresponding IP address automatically.</p>
  </dd>
  <dt>
    <p><strong>-B &lt;Dst_IP|range&gt;</strong></p>
  </dt>
  <dd>
    <p>Use specified destination IP address (default is broadcast i. e. 255.255.255.255). As with the source address (see above) you can also specify a range or a DNS name.</p>
  </dd>
  <dt>
    <p><strong>-t &lt;packet_type&gt;</strong></p>
  </dt>
  <dd>
    <p>Create the specified packet type using the built-in packet builder. Currently supported packet types are: <em>arp</em>, <em>bpdu</em>, <em>ip</em>, <em>udp</em>, <em>tcp</em>, <em>rtp</em>, and <em>dns</em>. There is currently also a limited support for ICMP. Enter <em>-t help</em> to verify which packet builders your actual Mausezahn version supports. Also, for any particular packet type, for example <em>tcp</em> enter <em>mz -t tcp help</em> to receive a context specific help.</p>
  </dd>
  <dt>
    <p><strong>-T &lt;packet_type&gt;</strong></p>
  </dt>
  <dd>
    <p>Make this Mausezahn instance the receiving station. Currently (version 0.30) only <em>rtp</em> is an option here and provides precise jitter measurements. For this purpose start another Mausezahn instance on the sending station and the local receiving station will output jitter statistics. See <em>mz -T rtp</em> help for a detailed help.</p>
  </dd>
  <dt>
    <p><strong>-Q &lt;[CoS:]vlan&gt; [, &lt;[CoS:]vlan&gt;, ...]</strong></p>
  </dt>
  <dd>
    <p>Specify 802.1Q VLAN tag and optional Class of Service. An arbitrary number of VLAN tags can be specified (that is you can simulate QinQ or even QinQinQinQ...). Multiple tags must be separated via a comma or a period (e. g. "5:10,20,2:30"). VLAN tags are not supported for ARP and BPDU packets (in which case you could specify the whole frame in hex using the raw layer 2 interface of Mausezahn).</p>
  </dd>
  <dt>
    <p><strong>-M &lt;label[:cos[:ttl]][bos]&gt; [, &lt;label...&gt;]</strong></p>
  </dt>
  <dd>
    <p>Specify a MPLS label or even a MPLS label stack. Optionally for each label the experimental bits (usually the Class of Service, CoS) and the Time To Live (TTL) can be specified. And if you are really crazy you can set/unset the Bottom of Stack (BoS) bit at each label using the <em>S</em> (set) and <em>s</em> (unset) option. By default the BoS is set automatically and correctly. Any other setting will lead to invalid frames. Enter <em>-M help</em> for detailed instructions and examples.</p>
  </dd>
  <dt>
    <p><strong>-P &lt;ASCII_payload&gt;</strong></p>
  </dt>
  <dd>
    <p>Specify a cleartext payload. Alternatively each packet type supports a hexadecimal specification of the payload (see for example <em>-t udp help</em>).</p>
  </dd>
  <dt>
    <p><strong>-f &lt;filename&gt;</strong></p>
  </dt>
  <dd>
    <p>Read the ASCII payload from the specified file.</p>
  </dd>
  <dt>
    <p><strong>-F &lt;filename&gt;</strong></p>
  </dt>
  <dd>
    <p>Read the HEX payload from the specified file. Actually this file must be also an ASCII file (text file) but must contain hexadecimal digits, e. g. "aa:bb:cc:0f:e6...". You can use also spaces as separation characters.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMBINATION OF RANGES</h2>
        <div class="sectioncontent">
<p>When multiple ranges are specified, e. g. destination port ranges AND destination address ranges, then <strong>all</strong> possible combinations of ports and addresses are used for packet generation. Furthermore, this can be mixed with other ranges e. g. a TCP sequence number range. Note that combining ranges can lead to a very huge number of frames to be sent. As a rule of thumb you can assume that about 100,000 frames are sent in a fraction of one second, depending on your network interface.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DISCLAIMER AND WARNING</h2>
        <div class="sectioncontent">
<p>Mausezahn has been designed as fast traffic generator so you can easily overwhelm a LAN segment with myriads of packets. And because Mausezahn should also support security audits it is also possible to create malicious or &ldquo;invalid&rdquo; packets, SYN floods, port and address sweeps, DNS and ARP poisoning, etc.</p><p>Therefore, don't use this tool when you are not aware of possible consequences or have only little knowledge about networks and data communication.  If you abuse Mausezahn for 'unallowed' attacks and get caught, or damage something of your own, then this is completely your fault. So the safest solution is to try it out in a lab environment.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Send BPDU frames for VLAN 5 as used with Cisco's PVST+ type of STP. Per default Mausezahn assumes that you want to become the root bridge:</p><p># mz eth0 -c 0 -d 2s -t bpdu vlan=5</p><p>Perform a CAM table overflow attack:</p><p># mz eth0 -c 128000 -a rand -p 64</p><p>Perform a SYN flood attack to another VLAN using VLAN hopping. This only works if you are connected to the same VLAN which is configured as native VLAN on the trunk.  We assume that the victim VLAN is VLAN 100 and the native VLAN is VLAN 5. Lets attack every host in VLAN 100 which use a IP prefix of 10.100.100.0/24, also try out all ports between 1 and 1023 and use a random source IP address:</p><p># mz eth0 -c 0 -Q 5,100 -t tcp "flags=syn,dp=1-1023" -p 20 -A rand -B 10.100.100.0/24</p><p>Send IP multicast packets to the multicast group 230.1.1.1 using a UDP header with destination port 32000 and set the IP DSCP field to EF (46). Send one frame every 10 msec:</p><p># mz eth0 -c 0 -d 10msec -B 230.1.1.1 -t udp "dp=32000,dscp=46" -P "Multicast test packet"</p><p>Send UDP packets to the destination host target.anynetwork.foo using all possible destination ports and send every packet with all possible source addresses of the range 172.30.0.0/16; additionally use a source port of 666 and three MPLS labels, 100, 200, and 300, the outer (300) with QoS field 5. Send the frame with a VLAN tag 420 and CoS 6; eventually pad with 1000 bytes and repeat the whole thing 10 times:</p><p># mz eth0 -Q 6:420 -M 100,200,300:5 -A 172.30.0.0/16 -B target.anynetwork.foo -t udp "sp=666,dp=1-65535" -p 1000 -c 10</p><p>Send six forged Syslog messages with severity 3 to a Syslog server 10.1.1.9; use a forged source IP address 192.168.33.42 and let Mausezahn decide which local interface to use. Use an inter-packet delay of 10 seconds:</p><p># mz -t syslog sev=3 -P "Main reactor reached critical temperature." -A 192.168.33.42 -B 10.1.1.9 -c 6 -d 10s</p><p>Send an invalid TCP packet with only a 5 byte payload as layer-2 broadcast and also use the broadcast MAC address as source address. The target should be 10.1.1.6 but use a broadcast source address. The source and destination port shall be 145 and the window size 0. Set the TCP flags SYN, URG, and RST simultaneously and sweep through the whole TCP sequence number space with an increment of 1500. Finally set the urgent pointer to 666, i. e. pointing to nowhere:</p><p># mz -t tcp "flags=syn|urg|rst, sp=145, dp=145, win=0, s=0-4294967295, ds=1500, urg=666" -a bcast -b bcast -A bcast -B 10.1.1.6 -p 5</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO mz&hellip;</h2>
        <div class="sectioncontent">
<p> <a href="../man1/mz.cfg.1.html"><strong>mz.cfg</strong>(1)</a></strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Herbert Haas</p><p>Visit www.perihel.at/sec/mz/ for Mausezahn news and additional information.</p><p>This manual page was written by Herbert Haas &lt;herbert AT perihel DOT at&gt;, for the Debian project.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="mytool.1.html"><span aria-hidden="true">&larr;</span> mytool.1: Manipulate map files for yudit, uniconv and uniprint</a></li>
   <li class="next"><a href="mz.cfg.1.html">mz.cfg.1: A fast versatile packet generator <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
