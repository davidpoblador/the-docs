<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>scanmacho: User-space utility to scan mach-o files</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="User-space utility to scan mach-o files">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="scanmacho (1) manual">
  <meta name="twitter:description" content="User-space utility to scan mach-o files">
  <meta name="twitter:image" content="https://www.carta.tech/images/pax-utils-scanmacho-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/scanmacho.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="scanmacho (1) manual" />
  <meta property="og:description" content="User-space utility to scan mach-o files" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/pax-utils-scanmacho-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">scanmacho<small> (1)</small></h1>
        <p class="lead">User-space utility to scan mach-o files</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/scanmacho.1.html">
      <span itemprop="name">scanmacho: User-space utility to scan mach-o files</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/pax-utils/">
      <span itemprop="name">pax-utils</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/scanmacho.1.html">
      <span itemprop="name">scanmacho: User-space utility to scan mach-o files</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>scanmacho</strong> [<em>options</em>] <em>Mach-Os</em>&nbsp;or&nbsp;<em>directories</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>scanmacho</strong> is a user-space utility to quickly scan given Mach-Os, directories, or common system paths for different information. This may include Mach-O types, their install_names, etc...</p><p>Because Mach-O files can be "fat", it is possible for a single file to return multiple lines. Each line represents a single architecture, contained in the fat (universal) file. While there are no real restrictions, in practice, the entries can be distinguished by their arch type, e.g. ppc, ppc64, i386, x86_64, arm, ...</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p><strong>-A</strong>, <strong>--archives</strong></p><p>Scan archives (.a files)</p><p><strong>-a</strong>, <strong>--all</strong></p><p>Print all useful/simple info</p><p><strong>-B</strong>, <strong>--nobanner</strong></p><p>Don&apos;t display the header</p><p><strong>-b</strong>, <strong>--bind</strong></p><p>Print flags from mach_header</p><p><strong>-D</strong>, <strong>--endian</strong></p><p>Print Mach-O endianness</p><p><strong>-E</strong>, <strong>--etype</strong> <em>filetype</em></p><p>Print only Mach-O files matching specified etype (like MH_EXECUTABLE, MH_DYLIB, etc...)</p><p><strong>-F</strong>, <strong>--format</strong> <em>FORMAT</em></p><p>Use specified format for output; see the <strong>FORMAT</strong> section for more information.</p><p><strong>-f</strong>, <strong>--from</strong> <em>FILE</em></p><p>Read input stream from specified filename</p><p><strong>-g</strong>, <strong>--gmatch</strong></p><p>Use strncmp to match libraries (use with <strong>-N</strong>). Or regexp with symbol matching</p><p><strong>-h</strong>, <strong>--help</strong></p><p>Show condensed usage and exit</p><p><strong>-i</strong>, <strong>--interp</strong></p><p>Print the interpreter information (LC_LOAD_DYLINKER)</p><p><strong>-M</strong>, <strong>--bits</strong> <em>BITS</em></p><p>Print only Mach-O files matching specified numeric bits (like 32/64)</p><p><strong>-m</strong>, <strong>--mount</strong></p><p>Don&apos;t recursively cross mount points</p><p><strong>-N</strong>, <strong>--lib</strong> <em>INSTALLNAME</em></p><p>Find Mach-Os that need the specified INSTALL_NAME</p><p><strong>-n</strong>, <strong>--needed</strong></p><p>Print libraries the Mach-O is linked against (LC_LOAD_DYLIB).</p><p><strong>-O</strong>, <strong>--perms</strong> <em>PERMS</em></p><p>Print only Mach-O files with matching specified octal bits (like 755).</p><p><strong>-o</strong>, <strong>--file</strong> <em>FILE</em></p><p>Write output stream to specified filename.</p><p><strong>-p</strong>, <strong>--path</strong></p><p>Scan all directories in PATH environment.</p><p><strong>-q</strong>, <strong>--quiet</strong></p><p>Only output &apos;bad&apos; things.</p><p><strong>-R</strong>, <strong>--recursive</strong></p><p>Scan directories recursively</p><p><strong>-r</strong>, <strong>--rpath</strong></p><p>Print RPATH encoded in the Mach-O (LC_RPATH)</p><p><strong>-S</strong>, <strong>--soname</strong></p><p>Print the Mach-O&apos;s shared library name (install_name).</p><p><strong>-V</strong>, <strong>--version</strong></p><p>Print version and exit</p><p><strong>-v</strong>, <strong>--verbose</strong></p><p>Be verbose (can be used more than once)</p><p><strong>-y</strong>, <strong>--symlink</strong></p><p>Don&apos;t scan symlinks</p><p><strong>-Z</strong>, <strong>--size</strong> <em>SIZE</em></p><p>Print Mach-O file size</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FORMAT</h2>
        <div class="sectioncontent">
<p>The format string is much like a printf string in that it is a literal string with flags requesting different information. For example, you could use a format string and expect the following results.</p>
<pre>
  # <strong>scanmacho</strong> <strong>-BF</strong> "file %f needs %n; funky time" /bin/bash
  file bash needs /usr/lib/libncurses.5.4.dylib,/usr/lib/libSystem.B.dylib; funky time

</pre>
<p>Note that when you use a format string, generally information related flags should be omitted. In other words, you do not want to try and request NEEDED output (<strong>-n</strong>) and try to specify a format output at the sametime as these operations are mutually exclusive. Each information related flag has an equivalent conversion specifier, so use those instead. You can of course continue to use non-information related flags (such as <strong>--verbose</strong>).</p><p>There are three characters that introduce conversion specifiers.</p><p>&bull; <strong>%</strong> - replace with info</p>
<dl class='dl-vertical'>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>#</strong> - silent boolean match</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>+</strong> - verbose match</p>
  </dd>

</dl>
<p>And there are a number of conversion specifiers. We try to match up the specifier with corresponding option.</p><p>&bull; <strong>a</strong> - arch type</p>
<dl class='dl-vertical'>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>b</strong> - mach_header flags</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>D</strong> - endian</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>F</strong> - long filename</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>f</strong> - short filename</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>i</strong> - dyld</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>M</strong> - CPU_TYPE class</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>N</strong> - specified needed</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>n</strong> - needed libraries</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>p</strong> - filename (minus search)</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>o</strong> - mh_type</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>O</strong> - perms</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>r</strong> - rpaths</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>S</strong> - install_name</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MACH-O FILETYPES</h2>
        <div class="sectioncontent">
<p>You can narrow your search by specifying the Mach-O object file type. The commandline option takes the symbolic type name. Multiple values can be passed comma separated. Example -E MH_EXECUTE,MH_DYLIB</p><p>Here is the normal list available for your pleasure.</p><p>&bull; <strong>MH_OBJECT</strong> - intermediate object file (.o)</p>
<dl class='dl-vertical'>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>MH_EXECUTE</strong> - standard executable program</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>MH_BUNDLE</strong> - dlopen plugin (.bundle)</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>MH_DYLIB</strong> - dynamic shared library (.dylib)</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>MH_PRELOAD</strong> - executable not loaded by Mac OS X kernel (ROM)</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>MH_CORE</strong> - program crash core file</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>MH_DYLINKER</strong> - dynamic linker shared library (dyld)</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>MH_DYLIB_STUB</strong> - shared library stub for static only, no sections</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>MH_DSYM</strong> - debug symbols file (in .dSYM dir)</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MACH-O BITS</h2>
        <div class="sectioncontent">
<p>You can also narrow your search by specifying the Mach-O bitsize. Specify the numeric value.</p><p>&bull; <strong>32</strong> - 32bit mach_header</p>
<dl class='dl-vertical'>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p><strong>64</strong> - 64bit mach_header_64</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HOMEPAGE</h2>
        <div class="sectioncontent">
<p>\m[blue]<strong>http://hardened.gentoo.org/pax-utils.xml</strong>\m[]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">
<p>Please include as much information as possible (using any available debugging options) and send bug reports to the maintainers (see the <strong>AUTHORS</strong> section). Please use the Gentoo bugzilla at \m[blue]<strong>http://bugs.gentoo.org/</strong>\m[] if possible.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO scanmacho&hellip;</h2>
        <div class="sectioncontent">
<p><strong>chpax</strong>(1), <a href="../man1/dumpelf.1.html"><strong>dumpelf</strong>(1)</a>, <a href="../man1/paxctl.1.html"><strong>paxctl</strong>(1)</a>, <a href="../man1/pspax.1.html"><strong>pspax</strong>(1)</a>, <strong>readelf</strong>(1), <a href="../man1/scanelf.1.html"><strong>scanelf</strong>(1)</a>, <a href="../man5/elf.5.html"><strong>elf</strong>(5)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p><strong>Ned Ludd</strong> &lt;solar@gentoo.org&gt;</p><p>Maintainer</p><p><strong>Mike Frysinger</strong> &lt;vapier@gentoo.org&gt;</p><p>Maintainer</p><p><strong>Fabian Groffen</strong> &lt;grobian@gentoo.org&gt;</p><p>Mach-O Maintainer</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
     1.
  </dt>
  <dd>
    <p>http://hardened.gentoo.org/pax-utils.xml</p>
  </dd>
  <dt>
     2.
  </dt>
  <dd>
    <p>http://bugs.gentoo.org/</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="scanin.1.html"><span aria-hidden="true">&larr;</span> scanin.1: Scanin.</a></li>
   <li class="next"><a href="scanmem.1.html">scanmem.1: Locate and modify a variable in an executing process. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
