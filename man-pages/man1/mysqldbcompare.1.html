<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>mysqldbcompare: Compare two databases and identify differences</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Compare two databases and identify differences">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="mysqldbcompare (1) manual">
  <meta name="twitter:description" content="Compare two databases and identify differences">
  <meta name="twitter:image" content="https://www.carta.tech/images/mysql-utilities-mysqldbcompare-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/mysqldbcompare.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="mysqldbcompare (1) manual" />
  <meta property="og:description" content="Compare two databases and identify differences" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/mysql-utilities-mysqldbcompare-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">mysqldbcompare<small> (1)</small></h1>
        <p class="lead">Compare two databases and identify differences</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/mysqldbcompare.1.html">
      <span itemprop="name">mysqldbcompare: Compare two databases and identify differences</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/mysql-utilities/">
      <span itemprop="name">mysql-utilities</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/mysqldbcompare.1.html">
      <span itemprop="name">mysqldbcompare: Compare two databases and identify differences</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>mysqldbcompare [</strong><strong></strong><em>options</em><strong>] </strong><strong></strong><em>db1</em><strong> [</strong><strong></strong><em>:db2</em><strong>] ...</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This utility compares the objects and data from two databases to find differences. It identifies objects having different definitions in the two databases and presents them in a diff-style format of choice. Differences in the data are shown using a similar diff-style format. Changed or missing rows are shown in a standard format of GRID, CSV, TAB, or VERTICAL.</p><p>Use the notation db1:db2 to name two databases to compare, or, alternatively just db1 to compare two databases with the same name. The latter case is a convenience notation for comparing same-named databases on different servers.</p><p>The comparison may be run against two databases of different names on a single server by specifying only the <strong>--server1</strong> option. The user can also connect to another server by specifying the <strong>--server2</strong> option. In this case, db1 is taken from server1 and db2 from server2.</p><p>Those objects considered in the database include tables, views, triggers, procedures, functions, and events. A count for each object type can be shown with the <strong>-vv</strong> option.</p><p>The check is performed using a series of steps called tests. By default, the utility stops on the first failed test, but you can specify the <strong>--run-all-tests</strong> option to cause the utility to run all tests regardless of their end state.</p><p>Note: Using <strong>--run-all-tests</strong> may produce expected cascade failures. For example, if the row counts differ among two tables being compared, the data consistency will also fail.</p><p>The tests include the following:</p><p>Check database definitions</p><p>A database existence precondition check ensures that both databases exist. If they do not, no further processing is possible and the <strong>--run-all-tests</strong> option is ignored.</p><p>Check existence of objects in both databases</p><p>The test for objects in both databases identifies those objects missing from one or another database. The remaining tests apply only to those objects that appear in both databases. To skip this test, use the <strong>--skip-object-compare</strong> option. That can be useful when there are known missing objects among the databases.</p><p>Compare object definitions</p><p>The definitions (the <strong>CREATE</strong> statements) are compared and differences are presented. To skip this test, use the <strong>--skip-diff</strong> option. That can be useful when there are object name differences only that you want to ignore.</p><p>Check table row counts</p><p>This check ensures that both tables have the same number of rows. This does not ensure that the table data is consistent. It is merely a cursory check to indicate possible missing rows in one table or the other. The data consistency check identifies the missing rows. To skip this test, use the <strong>--skip-row-count</strong> option.</p><p>Check table data consistency</p><p>This check identifies both changed rows as well as missing rows from one or another of the tables in the databases. Changed rows are displayed as a diff-style report with the format chosen (<strong>GRID</strong> by default) and missing rows are also displayed using the format chosen. To skip this test, use the <strong>--skip-data-check</strong> option.</p><p>You may want to use the --skip-xxx options to run only one of the tests. This might be helpful when working to bring two databases into synchronization, to avoid running all of the tests repeatedly during the process.</p><p>Each test completes with one of the following states:</p><p><strong>pass</strong></p><p>The test succeeded.</p><p><strong>FAIL</strong></p><p>The test failed. Errors are displayed following the test state line.</p><p><strong>SKIP</strong></p><p>The test was skipped due to a missing prerequisite or a skip option.</p><p><strong>WARN</strong></p><p>The test encountered an unusual but not fatal error.</p><p><strong>-</strong></p><p>The test is not applicable to this object.</p><p>To specify how to display diff-style output, use one of the following values with the <strong>--difftype</strong> option:</p><p><strong>unified</strong> (default)</p><p>Display unified format output.</p><p><strong>context</strong></p><p>Display context format output.</p><p><strong>differ</strong></p><p>Display differ-style format output.</p><p><strong>sql</strong></p><p>Display SQL transformation statement output.</p><p>To specify how to display output for changed or missing rows, use one of the following values with the <strong>--format</strong> option:</p><p><strong>grid</strong> (default)</p><p>Display output in grid or table format like that of the <strong>mysql</strong> monitor.</p><p><strong>csv</strong></p><p>Display output in comma-separated values format.</p><p><strong>tab</strong></p><p>Display output in tab-separated format.</p><p><strong>vertical</strong></p><p>Display output in single-column format like that of the &#92;G command for the <strong>mysql</strong> monitor.</p><p>The <strong>--changes-for</strong> option controls the direction of the difference (by specifying the object to be transformed) in either the difference report (default) or the transformation report (designated with the <strong>--difftype=sql</strong> option). Consider the following command:</p>
<pre>
mysqldbcompare --server1=root@host1 --server2=root@host2 --difftype=sql &#92;
  db1:dbx
</pre>
<p>The leftmost database (db1) exists on the server designated by the <strong>--server1</strong> option (host1). The rightmost database (dbx) exists on the server designated by the <strong>--server2</strong> option (host2).</p><p><strong>--changes-for=server1</strong>: Produce output that shows how to make the definitions of objects on server1 like the definitions of the corresponding objects on server2.</p><p><strong>--changes-for=server2</strong>: Produce output that shows how to make the definitions of objects on server2 like the definitions of the corresponding objects on server1.</p><p>The default direction is server1.</p><p>You must provide connection parameters (user, host, password, and so forth) for an account that has the appropriate privileges to access all objects in the operation.</p><p>If the utility is to be run on a server that has binary logging enabled, and you do not want the comparison steps logged, use the <strong>--disable-binary-logging</strong> option.</p>
<pre>
      OPTIONS
</pre>
<p><strong>mysqldbcompare</strong> accepts the following command-line options:</p><p>--help</p><p>Display a help message and exit.</p><p>--changes-for=&lt;direction&gt;</p><p>Specify the server to show transformations to match the other server. For example, to see the transformation for transforming object definitions on server1 to match the corresponding definitions on server2, use <strong>--changes-for=server1</strong>. Permitted values are <strong>server1</strong> and <strong>server2</strong>. The default is <strong>server1</strong>.</p><p>--difftype=&lt;difftype&gt;, -d&lt;difftype&gt;</p><p>Specify the difference display format. Permitted format values are <strong>unified</strong>, <strong>context</strong>, <strong>differ</strong>, and <strong>sql</strong>. The default is <strong>unified</strong>.</p><p>--disable-binary-logging</p><p>If binary logging is enabled, disable it during the operation to prevent comparison operations from being written to the binary log. Note: Disabling binary logging requires the <strong>SUPER</strong> privilege.</p><p>--format=&lt;format&gt;, -f&lt;format&gt;</p><p>Specify the display format for changed or missing rows. Permitted format values are <strong>grid</strong>, <strong>csv</strong>, <strong>tab</strong>, and <strong>vertical</strong>. The default is <strong>grid</strong>.</p><p>--quiet, -q</p><p>Do not print anything. Return only an exit code of success or failure.</p><p>--run-all-tests, -a</p><p>Do not halt at the first difference found. Process all objects.</p><p>--server1=&lt;source&gt;</p><p>Connection information for the first server in the format: &lt;<em>user</em>&gt;[:&lt;<em>passwd</em>&gt;]@&lt;<em>host</em>&gt;[:&lt;<em>port</em>&gt;][:&lt;<em>socket</em>&gt;] or &lt;<em>login-path</em>&gt;[:&lt;<em>port</em>&gt;][:&lt;<em>socket</em>&gt;].</p><p>--server2=&lt;source&gt;</p><p>Connection information for the second server in the format: &lt;<em>user</em>&gt;[:&lt;<em>passwd</em>&gt;]@&lt;<em>host</em>&gt;[:&lt;<em>port</em>&gt;][:&lt;<em>socket</em>&gt;] or &lt;<em>login-path</em>&gt;[::&lt;<em>port</em>&gt;][::&lt;<em>socket</em>&gt;].</p><p>--show-reverse</p><p>Produce a transformation report containing the SQL statements to conform the object definitions specified in reverse. For example, if --changes-for is set to server1, also generate the transformation for server2. Note: The reverse changes are annotated and marked as comments.</p><p>--skip-data-check</p><p>Skip the data consistency check.</p><p>--skip-diff</p><p>Skip the object definition difference check.</p><p>--skip-object-compare</p><p>Skip the object comparison check.</p><p>--skip-row-count</p><p>Skip the row count check.</p><p>--span-key-size=&lt;number of bytes to use for key&gt;</p><p>Change the size of the key used for compare table contents. A higher value can help to get more accurate results comparing large databases, but may slow the algorithm.</p><p>Default value is 8.</p><p>--verbose, -v</p><p>Specify how much information to display. Use this option multiple times to increase the amount of information. For example, <strong>-v</strong> = verbose, <strong>-vv</strong> = more verbose, <strong>-vvv</strong> = debug.</p><p>--version</p><p>Display version information and exit.</p><p>--width=&lt;number&gt;</p><p>Change the display width of the test report. The default is 75 characters.</p>
<pre>
      NOTES
</pre>
<p>The login user must have the appropriate permissions to read all databases and tables listed.</p><p>For the <strong>--difftype</strong> option, the permitted values are not case sensitive. In addition, values may be specified as any unambiguous prefix of a valid value. For example, <strong>--difftype=d</strong> specifies the differ type. An error occurs if a prefix matches more than one valid value.</p><p>The path to the MySQL client tools should be included in the PATH environment variable in order to use the authentication mechanism with login-paths. This will allow the utility to use the my_print_defaults tools which is required to read the login-path values from the login configuration file (.mylogin.cnf).</p><p>If any database identifier specified as an argument contains special characters or is a reserved word, then it must be appropriately quoted with backticks (<strong>`</strong>). In turn, names quoted with backticks must also be quoted with single or double quotes depending on the operating system, i.e. (<strong>"</strong>) in Windows or (<strong>&apos;</strong>) in non-Windows systems, in order for the utilities to read backtick quoted identifiers as a single argument. For example, to compare a database with the name <strong>weird`db.name</strong> with <strong>other:weird`db.name</strong>, the database pair must be specified using the following syntax (in non-Windows): <strong>&apos;`weird``db.name`:`other:weird``db.name`&apos;</strong>.</p>
<pre>
      EXAMPLES
</pre>
<p>Use the following command to compare the emp1 and emp2 databases on the local server, and run all tests even if earlier tests fail:</p>
<pre>
$ mysqldbcompare --server1=root@localhost emp1:emp2 --run-all-tests
# server1 on localhost: ... connected.
# Checking databases emp1 on server1 and emp2 on server2
WARNING: Objects in server2:emp2 but not in server1:emp1:
  TRIGGER: trg
PROCEDURE: p1
    TABLE: t1
     VIEW: v1
                                                    Defn    Row     Data
Type      Object Name                               Diff    Count   Check
---------------------------------------------------------------------------
FUNCTION  f1                                        pass    -       -
TABLE     departments                               pass    pass    FAIL
Data differences found among rows:
--- emp1.departments
+++ emp2.departments
@@ -1,4 +1,4 @@
 *************************       1. row *************************
    dept_no: d002
- dept_name: dunno
+ dept_name: Finance
 1 rows.
Rows in emp1.departments not in emp2.departments
*************************       1. row *************************
   dept_no: d008
 dept_name: Research
1 rows.
Rows in emp2.departments not in emp1.departments
*************************       1. row *************************
   dept_no: d100
 dept_name: stupid
1 rows.
TABLE     dept_manager                              pass    pass    pass
Database consistency check failed.
# ...done
</pre>
<p>Given: two databases with the same table layout. Data for each table contains:</p>
<pre>
mysql&gt; select * from db1.t1;
+---+---------------+
| a | b             |
+---+---------------+
| 1 | Test 789      |
| 2 | Test 456      |
| 3 | Test 123      |
| 4 | New row - db1 |
+---+---------------+
4 rows in set (0.00 sec)
mysql&gt; select * from db2.t1;
+---+---------------+
| a | b             |
+---+---------------+
| 1 | Test 123      |
| 2 | Test 456      |
| 3 | Test 789      |
| 5 | New row - db2 |
+---+---------------+
4 rows in set (0.00 sec)
</pre>
<p>To generate the SQL statements for data transformations to make db1.t1 the same as db2.t1, use the <strong>--changes-for=server1</strong> option. We must also include the <strong>-a</strong> option to ensure that the data consistency test is run. The following command illustrates the options used and an excerpt from the results generated:</p>
<pre>
$ mysqldbcompare --server1=root:root@localhost &#92;
    --server2=root:root@localhost db1:db2 --changes-for=server1 -a &#92;
    --difftype=sql
[...]
#                                                   Defn    Row     Data
# Type      Object Name                             Diff    Count
Check #
-------------------------------------------------------------------------
# TABLE     t1                                      pass    pass    FAIL
# # Data transformations for direction = server1:
# Data differences found among rows: UPDATE db1.t1 SET b = &apos;Test 123&apos;
WHERE a = &apos;1&apos;; UPDATE db1.t1 SET b = &apos;Test 789&apos; WHERE a = &apos;3&apos;; DELETE
FROM db1.t1 WHERE a = &apos;4&apos;; INSERT INTO db1.t1 (a, b) VALUES(&apos;5&apos;, &apos;New
row - db2&apos;);
# Database consistency check failed.  # # ...done
</pre>
<p>Similarly, when the same command is run with <strong>--changes-for=server2</strong> and <strong>--difftype=sql</strong>, the following report is generated:</p>
<pre>
$ mysqldbcompare --server1=root:root@localhost &#92;
    --server2=root:root@localhost db1:db2 --changes-for=server2 -a &#92;
    --difftype=sql
[...]
#                                                   Defn    Row     Data
# Type      Object Name                             Diff    Count
Check #
-------------------------------------------------------------------------
# TABLE     t1                                      pass    pass    FAIL
# # Data transformations for direction = server2:
# Data differences found among rows: UPDATE db2.t1 SET b = &apos;Test 789&apos;
WHERE a = &apos;1&apos;; UPDATE db2.t1 SET b = &apos;Test 123&apos; WHERE a = &apos;3&apos;; DELETE
FROM db2.t1 WHERE a = &apos;5&apos;; INSERT INTO db2.t1 (a, b) VALUES(&apos;4&apos;, &apos;New
row - db1&apos;);
</pre>
<p>With the <strong>--difftype=sql</strong> SQL generation option set, <strong>--show-reverse</strong> shows the object transformations in both directions. Here is an excerpt of the results:</p>
<pre>
$ mysqldbcompare --server1=root:root@localhost &#92;
--server2=root:root@localhost db1:db2 --changes-for=server1 &#92;
--show-reverse -a --difftype=sql
[...]
#                                                   Defn    Row     Data
# Type      Object Name                             Diff    Count
Check #
-------------------------------------------------------------------------
# TABLE     t1                                      pass    pass    FAIL
# # Data transformations for direction = server1:
# Data differences found among rows: UPDATE db1.t1 SET b = &apos;Test 123&apos;
WHERE a = &apos;1&apos;; UPDATE db1.t1 SET b = &apos;Test 789&apos; WHERE a = &apos;3&apos;; DELETE
FROM db1.t1 WHERE a = &apos;4&apos;; INSERT INTO db1.t1 (a, b) VALUES(&apos;5&apos;, &apos;New
row - db2&apos;);
# Data transformations for direction = server2:
# Data differences found among rows: UPDATE db2.t1 SET b = &apos;Test 789&apos;
WHERE a = &apos;1&apos;; UPDATE db2.t1 SET b = &apos;Test 123&apos; WHERE a = &apos;3&apos;; DELETE
FROM db2.t1 WHERE a = &apos;5&apos;; INSERT INTO db2.t1 (a, b) VALUES(&apos;4&apos;, &apos;New
row - db1&apos;);
# Database consistency check failed.  # # ...done
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO mysqldbcompare&hellip;</h2>
        <div class="sectioncontent">
<p>For more information, please refer to the MySQL Utilities section of the MySQL Workbench Reference Manual, which is available online at http://dev.mysql.com/doc/workbench/en/.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Oracle Corporation (http://dev.mysql.com/).</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="mysql-server-5.5-mysqld_safe.1.html"><span aria-hidden="true">&larr;</span> mysqld_safe.1: Mysql server startup script</a></li>
   <li class="next"><a href="mysqldbcopy.1.html">mysqldbcopy.1: Copy database objects between servers <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
