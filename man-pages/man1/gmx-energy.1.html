<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>gmx-energy: Writes energies to xvg files and display averages</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Writes energies to xvg files and display averages">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="gmx-energy (1) manual">
  <meta name="twitter:description" content="Writes energies to xvg files and display averages">
  <meta name="twitter:image" content="https://www.carta.tech/images/gromacs-data-gmx-energy-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/gmx-energy.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="gmx-energy (1) manual" />
  <meta property="og:description" content="Writes energies to xvg files and display averages" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/gromacs-data-gmx-energy-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">gmx-energy<small> (1)</small></h1>
        <p class="lead">Writes energies to xvg files and display averages</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/gmx-energy.1.html">
      <span itemprop="name">gmx-energy: Writes energies to xvg files and display averages</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/gromacs-data/">
      <span itemprop="name">gromacs-data</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/gmx-energy.1.html">
      <span itemprop="name">gmx-energy: Writes energies to xvg files and display averages</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>gmx energy [-f [&lt;.edr&gt;]] [-f2 [&lt;.edr&gt;]] [-s [&lt;.tpr/.tpb/...&gt;]]</p>
<pre>
           [-o [&lt;.xvg&gt;]] [-viol [&lt;.xvg&gt;]] [-pairs [&lt;.xvg&gt;]]
           [-ora [&lt;.xvg&gt;]] [-ort [&lt;.xvg&gt;]] [-oda [&lt;.xvg&gt;]]
           [-odr [&lt;.xvg&gt;]] [-odt [&lt;.xvg&gt;]] [-oten [&lt;.xvg&gt;]]
           [-corr [&lt;.xvg&gt;]] [-vis [&lt;.xvg&gt;]] [-ravg [&lt;.xvg&gt;]]
           [-odh [&lt;.xvg&gt;]] [-nice &lt;int&gt;] [-b &lt;time&gt;] [-e &lt;time&gt;]
           [-[no]w] [-xvg &lt;enum&gt;] [-[no]fee] [-fetemp &lt;real&gt;]
           [-zero &lt;real&gt;] [-[no]sum] [-[no]dp] [-nbmin &lt;int&gt;]
           [-nbmax &lt;int&gt;] [-[no]mutot] [-skip &lt;int&gt;] [-[no]aver]
           [-nmol &lt;int&gt;] [-[no]fluct_props] [-[no]driftcorr]
           [-[no]fluc] [-[no]orinst] [-[no]ovec] [-acflen &lt;int&gt;]
           [-[no]normalize] [-P &lt;enum&gt;] [-fitfn &lt;enum&gt;]
           [-beginfit &lt;real&gt;] [-endfit &lt;real&gt;]
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>gmx energy</strong> extracts energy components or distance restraint data from an energy file. The user is prompted to interactively select the desired energy terms.</p><p>Average, RMSD, and drift are calculated with full precision from the simulation (see printed manual). Drift is calculated by performing a least-squares fit of the data to a straight line. The reported total drift is the difference of the fit at the first and last point. An error estimate of the average is given based on a block averages over 5 blocks using the full-precision averages. The error estimate can be performed over multiple block lengths with the options <strong>-nbmin</strong> and <strong>-nbmax</strong>. <strong>Note</strong> that in most cases the energy files contains averages over all MD steps, or over many more points than the number of frames in energy file. This makes the <strong>gmx energy</strong> statistics output more accurate than the <strong>.xvg</strong> output. When exact averages are not present in the energy file, the statistics mentioned above are simply over the single, per-frame energy values.</p><p>The term fluctuation gives the RMSD around the least-squares fit.</p><p>Some fluctuation-dependent properties can be calculated provided the correct energy terms are selected, and that the command line option <strong>-fluct_props</strong> is given. The following properties will be computed: Property                        Energy terms needed --------------------------------------------------- Heat capacity C_p (NPT sims):    Enthalpy, Temp Heat capacity C_v (NVT sims):    Etot, Temp Thermal expansion coeff. (NPT): Enthalpy, Vol, Temp Isothermal compressibility:     Vol, Temp Adiabatic bulk modulus:         Vol, Temp --------------------------------------------------- You always need to set the number of molecules <strong>-nmol</strong>. The C_p/C_v computations do <strong>not</strong> include any corrections for quantum effects. Use the <strong>gmx dos</strong> program if you need that (and you do).</p><p>When the <strong>-viol</strong> option is set, the time averaged violations are plotted and the running time-averaged and instantaneous sum of violations are recalculated. Additionally running time-averaged and instantaneous distances between selected pairs can be plotted with the <strong>-pairs</strong> option.</p><p>Options <strong>-ora</strong>, <strong>-ort</strong>, <strong>-oda</strong>, <strong>-odr</strong> and <strong>-odt</strong> are used for analyzing orientation restraint data. The first two options plot the orientation, the last three the deviations of the orientations from the experimental values. The options that end on an 'a' plot the average over time as a function of restraint. The options that end on a 't' prompt the user for restraint label numbers and plot the data as a function of time. Option <strong>-odr</strong> plots the RMS deviation as a function of restraint. When the run used time or ensemble averaged orientation restraints, option <strong>-orinst</strong> can be used to analyse the instantaneous, not ensemble-averaged orientations and deviations instead of the time and ensemble averages.</p><p>Option <strong>-oten</strong> plots the eigenvalues of the molecular order tensor for each orientation restraint experiment. With option <strong>-ovec</strong> also the eigenvectors are plotted.</p><p>Option <strong>-odh</strong> extracts and plots the free energy data (Hamiltoian differences and/or the Hamiltonian derivative dhdl) from the <strong>ener.edr</strong> file.</p><p>With <strong>-fee</strong> an estimate is calculated for the free-energy difference with an ideal gas state: Delta A = A(N,V,T) - A_idealgas(N,V,T) = kT ln(exp(U_pot/kT)) Delta G = G(N,p,T) - G_idealgas(N,p,T) = kT ln(exp(U_pot/kT)) where k is Boltzmann's constant, T is set by <strong>-fetemp</strong> and the average is over the ensemble (or time in a trajectory). Note that this is in principle only correct when averaging over the whole (Boltzmann) ensemble and using the potential energy. This also allows for an entropy estimate using: Delta S(N,V,T) = S(N,V,T) - S_idealgas(N,V,T) = (U_pot - Delta A)/T Delta S(N,p,T) = S(N,p,T) - S_idealgas(N,p,T) = (U_pot + pV - Delta G)/T</p><p>When a second energy file is specified (<strong>-f2</strong>), a free energy difference is calculated dF = -kT ln(exp(-(E_B-E_A)/kT)_A) , where E_A and E_B are the energies from the first and second energy files, and the average is over the ensemble A. The running average of the free energy difference is printed to a file specified by <strong>-ravg</strong>. <strong>Note</strong> that the energies must both be calculated from the same trajectory.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>Options to specify input and output files:</p><p><strong>-f</strong><em> [&lt;.edr&gt;] (ener.edr) (Input)</em></p>
<pre>
    Energy file
</pre>
<p><strong>-f2</strong><em> [&lt;.edr&gt;] (ener.edr) (Input, Optional)</em></p>
<pre>
    Energy file
</pre>
<p><strong>-s</strong><em> [&lt;.tpr/.tpb/...&gt;] (topol.tpr) (Input, Optional)</em></p>
<pre>
    Run input file: tpr tpb tpa
</pre>
<p><strong>-o</strong><em> [&lt;.xvg&gt;] (energy.xvg) (Output)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-viol</strong><em> [&lt;.xvg&gt;] (violaver.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-pairs</strong><em> [&lt;.xvg&gt;] (pairs.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-ora</strong><em> [&lt;.xvg&gt;] (orienta.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-ort</strong><em> [&lt;.xvg&gt;] (orientt.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-oda</strong><em> [&lt;.xvg&gt;] (orideva.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-odr</strong><em> [&lt;.xvg&gt;] (oridevr.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-odt</strong><em> [&lt;.xvg&gt;] (oridevt.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-oten</strong><em> [&lt;.xvg&gt;] (oriten.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-corr</strong><em> [&lt;.xvg&gt;] (enecorr.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-vis</strong><em> [&lt;.xvg&gt;] (visco.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-ravg</strong><em> [&lt;.xvg&gt;] (runavgdf.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-odh</strong><em> [&lt;.xvg&gt;] (dhdl.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p>Other options:</p><p><strong>-nice</strong><em> &lt;int&gt; (19)</em></p>
<pre>
    Set the nicelevel
</pre>
<p><strong>-b</strong><em> &lt;time&gt; (0)</em></p>
<pre>
    First frame (ps) to read from trajectory
</pre>
<p><strong>-e</strong><em> &lt;time&gt; (0)</em></p>
<pre>
    Last frame (ps) to read from trajectory
</pre>
<p><strong>-[no]w</strong><em>  (no)</em></p>
<pre>
    View output <strong>.xvg</strong>, <strong>.xpm</strong>, <strong>.eps</strong> and <strong>.pdb</strong> files
</pre>
<p><strong>-xvg</strong><em> &lt;enum&gt; (xmgrace)</em></p>
<pre>
    xvg plot formatting: xmgrace, xmgr, none
</pre>
<p><strong>-[no]fee</strong><em>  (no)</em></p>
<pre>
    Do a free energy estimate
</pre>
<p><strong>-fetemp</strong><em> &lt;real&gt; (300)</em></p>
<pre>
    Reference temperature for free energy calculation
</pre>
<p><strong>-zero</strong><em> &lt;real&gt; (0)</em></p>
<pre>
    Subtract a zero-point energy
</pre>
<p><strong>-[no]sum</strong><em>  (no)</em></p>
<pre>
    Sum the energy terms selected rather than display them all
</pre>
<p><strong>-[no]dp</strong><em>  (no)</em></p>
<pre>
    Print energies in high precision
</pre>
<p><strong>-nbmin</strong><em> &lt;int&gt; (5)</em></p>
<pre>
    Minimum number of blocks for error estimate
</pre>
<p><strong>-nbmax</strong><em> &lt;int&gt; (5)</em></p>
<pre>
    Maximum number of blocks for error estimate
</pre>
<p><strong>-[no]mutot</strong><em>  (no)</em></p>
<pre>
    Compute the total dipole moment from the components
</pre>
<p><strong>-skip</strong><em> &lt;int&gt; (0)</em></p>
<pre>
    Skip number of frames between data points
</pre>
<p><strong>-[no]aver</strong><em>  (no)</em></p>
<pre>
    Also print the exact average and rmsd stored in the energy frames (only when 1 term is requested)
</pre>
<p><strong>-nmol</strong><em> &lt;int&gt; (1)</em></p>
<pre>
    Number of molecules in your sample: the energies are divided by this number
</pre>
<p><strong>-[no]fluct_props</strong><em>  (no)</em></p>
<pre>
    Compute properties based on energy fluctuations, like heat capacity
</pre>
<p><strong>-[no]driftcorr</strong><em>  (no)</em></p>
<pre>
    Useful only for calculations of fluctuation properties. The drift in the observables will be subtracted before computing the fluctuation properties.
</pre>
<p><strong>-[no]fluc</strong><em>  (no)</em></p>
<pre>
    Calculate autocorrelation of energy fluctuations rather than energy itself
</pre>
<p><strong>-[no]orinst</strong><em>  (no)</em></p>
<pre>
    Analyse instantaneous orientation data
</pre>
<p><strong>-[no]ovec</strong><em>  (no)</em></p>
<pre>
    Also plot the eigenvectors with <strong>-oten</strong>
</pre>
<p><strong>-acflen</strong><em> &lt;int&gt; (-1)</em></p>
<pre>
    Length of the ACF, default is half the number of frames
</pre>
<p><strong>-[no]normalize</strong><em>  (yes)</em></p>
<pre>
    Normalize ACF
</pre>
<p><strong>-P</strong><em> &lt;enum&gt; (0)</em></p>
<pre>
    Order of Legendre polynomial for ACF (0 indicates none): 0, 1, 2, 3
</pre>
<p><strong>-fitfn</strong><em> &lt;enum&gt; (none)</em></p>
<pre>
    Fit function: none, exp, aexp, exp_exp, vac, exp5, exp7, exp9, erffit
</pre>
<p><strong>-beginfit</strong><em> &lt;real&gt; (0)</em></p>
<pre>
    Time where to begin the exponential fit of the correlation function
</pre>
<p><strong>-endfit</strong><em> &lt;real&gt; (-1)</em></p>
<pre>
    Time where to end the exponential fit of the correlation function, -1 is until the end
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO gmx-energy&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man7/gromacs.7.html"><strong>gromacs</strong>(7)</a></strong></p><p>More information about <strong>GROMACS</strong> is available at &lt;<em>http://www.gromacs.org/</em>&gt;.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="gmx-enemat.1.html"><span aria-hidden="true">&larr;</span> gmx-enemat.1: Extract an energy matrix from an energy file</a></li>
   <li class="next"><a href="gmx-filter.1.html">gmx-filter.1: Frequency filter trajectories, useful for making smooth movies <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
