<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>mp3info2: Get/set mp3 tags; uses mp3::tag to get default values.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Get/set mp3 tags; uses mp3::tag to get default values.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="mp3info2 (1p) manual">
  <meta name="twitter:description" content="Get/set mp3 tags; uses mp3::tag to get default values.">
  <meta name="twitter:image" content="https://www.carta.tech/images/libmp3-tag-perl-mp3info2-1p.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1p/mp3info2.1p.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="mp3info2 (1p) manual" />
  <meta property="og:description" content="Get/set mp3 tags; uses mp3::tag to get default values." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libmp3-tag-perl-mp3info2-1p.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">mp3info2<small> (1p)</small></h1>
        <p class="lead">Get/set mp3 tags; uses mp3::tag to get default values.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1p/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1p/mp3info2.1p.html">
      <span itemprop="name">mp3info2: Get/set mp3 tags; uses mp3::tag to get default values.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libmp3-tag-perl/">
      <span itemprop="name">libmp3-tag-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1p/mp3info2.1p.html">
      <span itemprop="name">mp3info2: Get/set mp3 tags; uses mp3::tag to get default values.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  # Print the information in tags and autodeduced info
  mp3info2 *.mp3

  # In addition, set the year field to 1981
  mp3info2 -y 1981 *.mp3

  # Same without printout of info, recursively in the current directory
  mp3info2 -R -p "" -y 1981 .

  # Do not deduce any field, print (normalized) info from the tags only
  mp3info2 -C autoinfo=ID3v2,ID3v1 *.mp3

  # As above, but without normalization/autofill, the raw information in tags
  mp3info2 -N *.mp3

  # As above, but only with ID2v1 tag read
  mp3info2 -NC autoinfo=ID3v1 *.mp3

  # Get artist from CDDB_File, autodeduce other info, write it to tags
  mp3info2 -C artist=CDDB_File -u *.mp3

  # For title, prefer information from .inf file; autodeduce rest, update
  mp3info2 -C title=Inf,ID3v2,ID3v1,filename -u *.mp3

  # Same, and get the artist from CDDB file
  mp3info2 -C title=Inf,ID3v2,ID3v1,filename -C artist=CDDB_File -u *.mp3

  # Write a script for conversion of .wav to .mp3, autodeducing tags
  mp3info2 -p "lame -h --vbr-new --tt &apos;%t&apos; --tn %n --ta &apos;%a&apos; --tc &apos;%c&apos; --tl &apos;%l&apos; --ty &apos;%y&apos; &apos;%f&apos;&#92;n" *.wav &gt;xxx.sh
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The program prints a message summarizing tag info (obtained via MP3::Tag module) for specified files.</p><p>It may also update the information in \s-1ID3\s0 tags.  This happens in three different cases.</p><ul>
<li><p>If the information supplied in command-line options \*(C`t a l y g c n\*(C' differs from the content of the corresponding \s-1ID3\s0 tags (or there is no corresponding \s-1ID3\s0 tags).</p></li><li><p>If options \*(C`-d\*(C' or \*(C`-F\*(C' were given.</p></li><li><p>if \*(C`MP3::Tag\*(C' obtains the info from other means than \s-1MP3\s0 tags, and \*(C`-u\*(C' forces the update of the \s-1ID3\s0 tags.</p></li>
</ul><p>(All these ways are disabled by \*(C`-D\*(C' option.)  ID3v2 tag is written if needed, or if \*(C`-2\*(C' option is given.  (Automatic fill-in of deduceable fields (via the method <em>id3v2_frames_autofill()</em>) is performed unless \*(C`-d\*(C' or \*(C`-N\*(C' options are given.)</p><p>The option \*(C`-u\*(C' writes (\*(C`u\*(C'pdates) the fetched information to the \s-1MP3\s0 \s-1ID3\s0 tags.  This option is assumed if there are command-line options which explicitly set tag elements (\*(C`-a\*(C', \*(C`-t\*(C' etc., and \*(C`-F\*(C', \*(C`-d\*(C'). (Effects of this option may be overridden by giving \*(C`-D\*(C' option.)  If \*(C`-2\*(C' option is also given, forces write of ID3v2 tag even if the info fits the ID3v1 tag (in addition, this option enables auto-update of \*(L"personal name\*(R" fields, and corresponding titles according to values of \*(C`translate_person\*(C', \*(C`person_frames\*(C' etc. configuration settings; see \*(L"Normalization of fields\*(R").  This option is ignored if no change to tags is detected; however, one can force an update by repeating this option (useful if you expect the change the \*(L"format\*(R" of the tag, as opposed to its \*(L"content\*(R").</p><p>The option \*(C`-p\*(C' prints a message using the next argument as format (by default \*(C`&#92;&#92;\*(C', \*(C`&#92;t\*(C', \*(C`&#92;n\*(C' are replaced by backslash, tab and newline; governed by the value of \*(C`-E\*(C' option); see \*(L"interpolate\*(R" in MP3::Tag for details of the format of <em>sprintf()</em>-like escapes.  If no option \*(C`-p\*(C' is given, message in default format will be emitted.  The value of option \*(C`-e\*(C' is the encoding used for the output; if the value is a number, system-specific encoding is guessed (and used for the output if bit 0x1 is set); if bit 0x2 is set, then, command line options are assumed to be in the guessed encoding; if bit 0x4 is set, then, command line arguments are assumed to be in the guessed encoding.  Use the value \*(C`binary\*(C' to do binary output.</p><p>With option \*(C`-D\*(C' (dry run) no update is performed, no matter what the other options are.  With this option, no parsing of tags is performed unless needed.</p><p>Use options</p><p>  t a l y g c n</p><p>to overwrite the information (title artist album year genre comment track-number) obtained via \*(C`MP3::Tag\*(C' heuristics (\*(C`-u\*(C' switch is implied if any one of these arguments differs from what would be found otherwise; use \*(C`-D\*(C' switch to disable auto-update).  By default, the values of these options are not \*(C`%\*(C'-interpolated; this may be changed by \*(C`-E\*(C' option.</p><p>The option \*(C`-d\*(C' should contain the comma-separated list of ID3v2 frames to delete.  A frame specification is the same as what might be given to "%{...}" frame interpolation command, e.g., \*(C`TIT3\*(C', \*(C`COMM03\*(C', \*(C`COMM(fra)[short title]\*(C'; the difference with modify-access is that <strong>\s-1ALL\s0</strong> (and not the <strong>first</strong> of) matching frames are deleted. (Option -d may be repeated.)</p><p>For example, \*(C`-d APIC\*(C' would remove all picture frames.  In addition, if the list contains \*(C`ID3v1\*(C' or \*(C`ID3v2\*(C', whole tags will be deleted.</p><p>Likewise, the option \*(C`-F\*(C' allows setting of arbitrary \*(C`ID3v2\*(C' frames: if one needs to set one frame, use the directive \*(C`FRAME_spec=VALUE\*(C':</p><p>  -F TIT2=The_new_Title</p><p>Again, on modify, <strong>\s-1ALL\s0</strong> matching frames are deleted first, so be carefull with</p><p>  -F COMM=MyComment</p><p>Option \*(C`-F\*(C' may be repeated to set more than one frame.  If configuration variable \*(C`empty-F-deletes\*(C' is \s-1TRUE\s0 (default), empty arguments will delete the frame.</p><p>One can replace \*(C`FRAME_spec=VALUE\*(C' by \*(C`FRAME_spec &lt; FILE\*(C'; in this case the value to set is read from the file named <em>\s-1FILE\s0</em>; if the frame is text-only (meaning: at most \*(C`[encoded]Text URL Language Description\*(C' fields are present), the file is read in text mode (and with starting/trailing whitespace stripped), otherwise it is read in binary mode.  (Whitespace is required about the \*(C`&lt;\*(C' signs.)  If \*(C`&lt;\*(C' is replaced by \*(C`?&lt;\*(C', the value is set only if frame is not yet present, and if the file exists; if replaced by \*(C`&gt;\*(C', the value (if present) is written to <em>\s-1FILE\s0</em> (creation of intermediate directories is controlled by configuration option \*(C`frames_write_creates_dirs\*(C', the default is \s-1FALSE\s0).</p><p>Additionally, \*(C`FRAME_spec\*(C' may be one of \*(C`ID3v1\*(C' or \*(C`ID3v2\*(C' or \*(C`TAGS\*(C'; in this case, whole tags are written or read.  For example, for \*(C`TAGS &lt; FILE\*(C', \*(C`title artist album year genre comment track\*(C' info is calculated from <em>\s-1FILE\s0</em>, which may be raw tags, as produced with \*(C`&gt;\*(C', or a valid \s-1MP3\s0 file; if Image::ExifTool is present, the data may be read from arbitrary multimedia file.  (Likewise,  for \*(C`ID3v1 &lt; FILE\*(C', the same info is extracted from \*(C`ID3v1\*(C' tag only.) After this, in case of \*(C`ID3v2\*(C' or \*(C`TAGS\*(C', \*(C`ID3v2\*(C' frames are copied from the \*(C`ID3v2\*(C' tag one-by-one.  (With suitable modifications for \*(C`?&lt;\*(C'.)</p><p>By default, the \*(L"\s-1VALUE\s0\*(R" for \*(C`-F\*(C' is \*(C`%\*(C'-interpolated; this can be changed by option \*(C`-E\*(C'.  For user convenience, human-friendlier forms \*(C`composer, text_by, orchestra, conductor, disk_n\*(C' can be used instead of \*(C`TCOM, TEXT, TPE2, TPE3, TPOS\*(C'.</p><p>The option \*(C`-P RECIPE\*(C' is a very powerful generalization of what can be done by options \*(C`-F\*(C', \*(C`-d\*(C', and \*(C`-t -a -l -y -g -c -n\*(C'.  It may be repeated; the values should contain the parse recipes.  They become the configuration item \*(C`parse_data\*(C' of \*(C`MP3::Tag\*(C'; eventually this information is processed by MP3::Tag::ParseData module (if the latter is present in the chain of heuristics; see option \*(C`-C\*(C').  The \*(C`RECIPE\*(C' is split into \*(C`$flags, $string, @patterns\*(C' on its first non-alphanumeric character; the first of @patterns which matches $string is going to be executed (for side effects).  (See examples: \*(L"\s-1EXAMPLES:\s0 parse rules\*(R".)</p><p>If option \*(C`-G\*(C' is specified, the file names on the command line are considered as glob patterns.  This may be useful if the maximal command-line length is too low.  With the option \*(C`-R\*(C' arguments can be directories, which are searched recursively for audio (default <em>*.mp3</em>) files to process; use option \*(C`-r\*(C' to reset the regular expression to look for (the default is \*(C`(?i:&#92;.mp3$)\*(C').</p><p>The option \*(C`-E\*(C' controls expansion of escape characters.  It should contain the letters of the command-line options where \*(C`&#92;&#92;, &#92;n, &#92;t\*(C' are interpolated; one can append the letters of \*(C`t a l y g c n F\*(C' options requiring \*(C`%\*(C'-interpolation after the separator \*(C`/i:\*(C' (for \*(C`-F\*(C', only the values are interpolated).  The default value is \*(C`p/i:Fp\*(C': only \*(C`-p\*(C' is \*(C`&#92;\*(C'-interpolated, and only \*(C`-F\*(C' and \*(C`-p\*(C' are subject to \*(C`%\*(C'-interpolation.  If all one wants is to <em>add</em> to the defaults, preceed the value of \*(C`-E\*(C' (containing added options) by "+".  (Some parts of the value of option \*(C`-P\*(C' are interpolated, but this should be governed by flags, not \*(C`-E\*(C'; do <em>\s-1NOT\s0</em> put \*(C`P\*(C' into the \*(C`%\*(C'-interpolated part of \*(C`-E\*(C'.)</p><p>If the option \*(C`-@\*(C' is given, all characters \*(C`@\*(C' in the options are replaced by \*(C`%\*(C'.  This may be convenient if the shell treats \*(C`%\*(C' specially (e.g., \s-1DOSISH\s0 shells).</p><p>If option \*(C`-I\*(C' is given, no guessworking for <em>artist</em> field is performed on typeout.</p><p>The option \*(C`-C CONFIG_OPT=VALUE1,VALUE2...\*(C' sets \*(C`MP3::Tag\*(C' configuration data the same way as \*(C`MP3::Tag-\*(C'<em>config()</em>&gt; would do (recall that the value is an array; separate elements by commas if more than one).  The option may be repeated to set more than one value.  Note that since \*(C`ParseData\*(C' is used to process \*(C`-P\*(C' parse recipes, it should be better be kept in the \*(C`autoinfo\*(C' configuration (and related fields \*(C`author\*(C' etc) in presence of \*(C`-P\*(C'.</p><p>If the option \*(C`-x\*(C' is given, the technical information about the audio file is printed (\s-1MP3\s0 level, duration, number of frames, padding, copyright, and the list of ID3v2 frame names in format suitable to \*(C`%{...}\*(C' escapes). If \*(C`-x\*(C' is repeated, content of frames is also printed out (may output non-printable chars, if it is repeated more than twice).</p><p>If option \*(C`-N\*(C' is given, all the \*(L"smarts\*(R" are disabled - no normalization of fields happens, and (by default) no attempt to deduce the values of fields from non-ID3 information is done.  This option is (currently) equivalent to having \*(C`-C autoinfo=ParseData,ID3v2,ID3v1\*(C' as the first directive, to having no <em>Normalize::Text::Music_Fields.pm</em> present on @INC path, and not calling <em>autofill()</em> method.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Normalization of fields</h2>
        <div class="sectioncontent">
<p>(The loading of normalization module and all subsequent operations may be disabled by the option \*(C`-N\*(C', or by setting the environment variable \*(C`MP3TAG_NORMALIZE_FIELDS\*(C' to be \s-1FALSE\s0.  If not prohibited, the module is attempted to be loaded if directory <em>~/.music_fields</em> is present, or \*(C`MP3TAG_NORMALIZE_FIELDS\*(C' is set and \s-1TRUE\s0.)</p><p>If loading of the module \*(C`Normalize::Text::Music_Fields\*(C' is successful, the following is applicable:</p><p>If the value of \*(C`MP3TAG_NORMALIZE_FIELDS\*(C' is defined and not 1, this value is broken into directories as a \s-1PATH\s0, and load path of \*(C`Normalize::Text::Music_Fields\*(C' is set to be this list of directories. Then MP3::Tag is instructed (via corresponding configuration settings) to use \*(C`normalize_artist\*(C' (etc.) methods defined by this module.  These methods may normalize certain tag data.  The current version defines methods for \*(L"normalization\*(R" of personal names, and titles (based on the composer).  This normalization is driven through user-editable configuration tables.</p><p>In addition to automatical normalization of \s-1MP3\s0 tag data, one can use \*(L"fake \s-1MP3\s0 files\*(R" to manually access some features of this module. For this, use an empty file name, and \*(C`-D\*(C' option.  E.g,</p><p>  mp3info2 -D -a beethoven                       -p "%a&#92;n"         ""   mp3info2 -D -a beethoven                       -p "%{shP[%a]}&#92;n" ""   mp3info2 -D -a beethoven -t "sonata #28"       -p "%t&#92;n"         ""   mp3info2 -D -a beethoven -t "allegretto, Bes" -@p "@t&#92;n"         ""   mp3info2 -D -a beethoven -t "op93"            -@p "@t&#92;n"         ""</p><p>will print the normalized person-name for \*(C`beethoven\*(C', the corresponding normalized short person-name, and the normalized title for \*(C`sonata #28\*(C' of composer \*(C`beethoven\*(C'.  E.g., with the shipped normalization tables, it will print</p><p>  Ludwig van Beethoven (1770-1827)   L. van Beethoven   Piano Sonata No. 28 in A major; Op. 101 (1816)   Allegretto for Piano Trio in B flat major; WoO 39 (1812)   Symphony No. 8 in F major; Op. 93 (comp. 1812, f.p. Vienna, 1814-02-27, cond. Beethoven; pubd. 1816)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">The order of operation</h2>
        <div class="sectioncontent">
<p>Currently, the operations are done in the following order</p><ul>
<li><p>Deletion of ID3v1 or ID3v2 as a whole via \*(C`-d\*(C' option;</p></li><li><p>Recipies of \*(C`-P\*(C' option are set up (to be triggered by interpolation);</p></li><li><p>The setting done via \*(C`-a/-t/-l/-y/-g/-c/-n\*(C' options;</p></li><li><p>The settings done via \*(C`-F\*(C' option;</p></li><li><p>Deletion of individual frames via \*(C`-d\*(C' option;</p></li><li><p>autofill of ID3v2 (id) frames;</p></li><li><p>Emit info based on \*(C`-p\*(C' and \*(C`-x\*(C' options;</p></li><li><p>Trigger recipies of \*(C`-P\*(C' (if not triggered by interpolation);</p></li><li><p>Update tags if needed.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Usage strategy: escalation of complexity</h2>
        <div class="sectioncontent">
<p>The purpose of this script is to to make handling of \s-1ID3\s0 tags as simple <em>as possible</em>.</p><p>On one end of the scale, one can perform arbitrarily complex manipulations with tags using \*(C`MP3::Tag\*(C' Perl module.</p><p>On the other end, it is much more convenient to handle simplest manipulations with tags using this script's options \*(C`-t -a -l -y -g -c -n\*(C' and \*(C`-p -F -d\*(C'.  For slightly more complicated tasks, one may need to use the more elaborate method of <em>parse rules</em>, provided to this script by the option \*(C`-P\*(C'; the rules depend heavily on <em>interpolation</em>, see \*(L"interpolate\*(R" in MP3::Tag, \*(L"interpolate_with_flags\*(R" in MP3::Tag.</p><p>To simplify upgrade from \*(L"simplest manipulations\*(R" to \*(L"more elaborate ones\*(R", here we provide \*(L"parse rule\*(R" <em>synonyms</em> to the simplest options.  So if you start with \*(C`-t -a -l -y -g -c -n\*(C' and \*(C`-p -F -d\*(C' options which \*(L"almost work\*(R" for you, you have a good chance to be able to fully achieve your aim by modifying the synonyms described below.</p><p>(Below we assume that \*(C`-E\*(C' option is set to its default value, so \*(C`-F -p\*(C' are \*(C`%\*(C'-interpolated, other options are not.  Note also that if your \s-1TTY\s0's encoding is recognized by Perl, it is highly recommended to set \*(C`-e 3\*(C' option; on \s-1DOSISH\s0 shells, better use \*(C`-@\*(C', and replace \*(C`%\*(C''s by \*(C`@\*(C''s below.)   -P "mz/VALUE/%t" Likewise.   -P "mzi/VALUE/%{TIT2}"   -F "APIC[myDescr]=%{I(fimbB)FILE}" or   -P "mzi/%{I(fimbB)FILE}/%{APIC[myDescr]}" (remove \*(C`bB\*(C' for text-only frames).   -P "bOi,%{APIC[myDescr]},FILE" (remove \*(C`b\*(C' for text-only frames); or use \*(C`-e binary -p "%{APIC[myDescr]}"\*(C' with redirection, see \*(L"\s-1EXAMPLES:\s0 parse rules\*(R".   -P "m//%{TIT2}" Very tricky.  This won't set distinguish empty file and non-existing one:   -P "mzi/%{TIT2:1}0%{I(fFim)FILE}/10/10%{TIT2}/0%{U1}" (add \*(C`bB\*(C' to \*(C`fFim\*(C' for non-text-only frames); the last part may be omitted if one omits the flag \*(C`m\*(C' - it is present to catch misprints only.</p><p>For details on \*(L"parse rules\*(R", see \*(L"\s-1EXAMPLES:\s0 parse rules\*(R" and \*(L"\s-1DESCRIPTION\s0\*(R" in MP3::Tag::ParseData.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES: parse rules</h2>
        <div class="sectioncontent">
<p>Only the \*(C`-P\*(C' option is complicated enough to deserve comments... For full details on <em>parse rules</em>, see \*(L"\s-1DESCRIPTION\s0\*(R" in MP3::Tag::ParseData; for full details on interpolation, see \*(L"interpolate\*(R" in MP3::Tag, \*(L"interpolate_with_flags\*(R" in MP3::Tag.</p><p>For a (silly) example, one can replace \*(C`-a Homer -t Iliad\*(C' by</p><p>  -P mz=Homer=%a -P mz=Iliad=%t</p><p>A less silly example is forcing a particular way of parsing a file name via</p><p>  -P "im=%{d0}/%f=%a/%n %t.%e"</p><p>It is broken into</p><p> flags          string          pattern1  "im"           "%{d0}/%f"      "%a/%n %t.%e"</p><p>The flag letters stand for <em>interpolate</em>, <em>must_match</em>.  This interpolates the string "%{d0}/%f" and parses the result (which is the file name with one level of the directory part preserved) using the given pattern; thus the directory name becomes the artist, the leading numeric part - the track number, and the rest of the file name (without extension) - the title.  Note that since multiple patterns are allowed, one can similarly allow for multiple formats of the names, e.g.</p><p>  -P "im=%{d0}/%f=%a/%n %t.%e=%a/%t (%y).%e"</p><p>allows for the file basename to be also of the form \*(L"\s-1TITLE\s0 (\s-1YEAR\s0)\*(R".  An alternative way to obtain the same results is</p><p>  -P "im=%{d0}=%a" -P "im=%f=%n %t.%e=%t (%y).%e"</p><p>which corresponds to two recipies:</p><p> flags          string          pattern1        pattern2  "im"           "%{d0}"         "%a"  "im"           "%f"            "%n %t.%e"      "%t (%y).%e"</p><p>Of course, one could use</p><p> "im"           "%B"            "%n %t"         "%t (%y)"</p><p>as a replacement for the second one.</p><p>Note that it may be more readable to set <em>artist</em> to \*(C`%{d0}\*(C' by an explicit asignment, with arguments similar to</p><p>  -E "p/i:Fpa" -a "%{d0}"</p><p>(this value of \*(C`-E\*(C' requests \*(C`%\*(C'-interpolation of the option \*(C`-a\*(C' in addition to the default \*(C`&#92;\*(C'-interpolation of \*(C`-p\*(C', and \*(C`%\*(C'-interpolation of \*(C`-F\*(C' and \*(C`-p\*(C'; one can shortcut it with \*(C`-E +/i:a\*(C').</p><p>To give more examples,</p><p>  -P "if=%D/.comment=%c"</p><p>will read comment from the file <em>.comment</em> in the directory of the audio file;</p><p>  -P "ifn=%D/.comment=%c"</p><p>has similar effect if the file <em>.comment</em> has one-line comments, one per track (this assumes the the track number can be found by other means).</p><p>Suppose that a file <em>Parts</em> in a directory of \s-1MP3\s0 files has the following format: it has a preamble, then has a short paragraph of information per audio file, preceded by the track number and dot:</p><p>   ...</p><p>   12. Rezitativ.    (Pizarro, Rocco)</p><p>   13. Duett: jetzt, Alter, jetzt hat es Eile, (Pizarro, Rocco)</p><p>   ...</p><p>The following command puts this info into the title of the \s-1ID3\s0 tag (provided the audio file names are informative enough so that MP3::Tag can deduce the track number):</p><p> mp3info2 -u -C parse_split=&apos;&#92;n(?=&#92;d+&#92;.)&apos; -P &apos;fl;Parts;%=n. %t&apos;</p><p>If this paragraph of information has the form \*(C`TITLE (COMMENT)\*(C' with the \*(C`COMMENT\*(C' part being optional, then use</p><p> mp3info2 -u -C parse_split=&apos;&#92;n(?=&#92;d+&#92;.)&apos; -P &apos;fl;Parts;%=n. %t (%c);%=n. %t&apos;</p><p>If you want to remove a dot or a comma got into the end of the title, use</p><p> mp3info2 -u -C parse_split=&apos;&#92;n(?=&#92;d+&#92;.)&apos; &#92;    -P &apos;fl;Parts;%=n. %t (%c);%=n. %t&apos; -P &apos;iR;%t;%t[.,]$&apos;</p><p>The second pattern of this invocation is converted to</p><p>  [&apos;iR&apos;, &apos;%t&apos; =&gt; &apos;%t[.,]$&apos;]</p><p>which essentially applies the substitution \*(C`s/(.*)[.,]$/$1/s\*(C' to the title.</p><p>Now suppose that in addition to <em>Parts</em>, we have a text file <em>Comment</em> with additional info; we want to put this info into the comment field <em>after</em> what is extracted from \*(C`TITLE (COMMENT)\*(C'; separate these two parts of the comment by an empty line:</p><p> mp3info2 -E C -C &apos;parse_split=&#92;n(?=&#92;d+&#92;.)&apos; -C &apos;parse_join=&#92;n&#92;n&apos; &#92;   -P &apos;f;Comment;%c&apos;           -P &apos;fl;Parts;%=n. %t&apos;              &#92;   -P &apos;i;%t///%c;%t (%c)///%c&apos; -P &apos;iR;%t;%t[.,]$&apos;</p><p>This assumes that the title and the comment do not contain &apos;///&apos; as a substring.  Explanation: the first pattern of \*(C`-P\*(C',</p><p>  [&apos;f&apos;, &apos;Comment&apos; =&gt; &apos;%c&apos;],</p><p>reads comment from the file \*(C`Comment\*(C' into the comment field; the second,</p><p>  [&apos;fl&apos;, &apos;Parts&apos;  =&gt; &apos;%=n. %t&apos;],</p><p>reads a chunk of \*(C`Parts\*(C' into the title field.  The third one</p><p>  [&apos;i&apos;, &apos;%t///%c&apos; =&gt; &apos;%t (%c)///%c&apos;]</p><p>rearranges the title and comment <em>provided</em> the title is of the form \*(C`TITLE (COMMENT)\*(C'.  (The configuration option \*(C`parse_join\*(C' takes care of separating two chunks of comment corresponding to two occurences of %c on the right hand side.)</p><p>Finally, the fourth pattern is the same as in the preceding example; it removes spurious punctuation at the end of the title.</p><p>More examples: removing string \*(L"with violin\*(R" from the start of the comment field (removing comment altogether if nothing remains):</p><p>  mp3info2 -u -P &apos;iz;%c;with violin%c&apos; *.mp3</p><p>setting the artist field without letting auto-update feature deduce other fields from other sources;</p><p>  mp3info2 -C autoinfo=ParseData -a "A. U. Thor" *.mp3</p><p>setting a comment field unless it it already present:</p><p>  mp3info2 -u -P &apos;i;%c///with piano;///%c&apos; *.mp3</p><p>The last example shows how to actually write \*(L"programs\*(R" in the language of the \*(C`-P\*(C' option: the example gives a conditional assignment.  With user variables (as in \*(C`%{U8}\*(C') for temporaries, and a possibility to use regular expressions, one could provide arbitrary programmatic logic.  Of course, at some level of complexity one should better switch to direct interfacing with \*(C`MP3::Tag\*(C' Perl module (use the code of this Perl script as an example!).</p><p>Here is a typical task setting \*(L"advanced\*(R" id3v2 frames: composer (\*(C`TCOM\*(C'), orchestra (\*(C`TPE2\*(C'), conductor (\*(C`TPE3\*(C').  We assume a directory tree which contains \s-1MP3\s0 files tagged with the following conventions: \*(C`artist\*(C' is actually a composer; \*(C`comment\*(C' is of one of two forms:</p><p>  Performers; Orchestra; Conductor   Orchestra; Conductor</p><p>To set the specific \s-1MP3\s0 frames via \*(C`-P\*(C' rules, use</p><p>  mp3info2 -@P "mi/@a/@{TCOM}" &#92;     -P "mi/@c/@{U1}; @{TPE2}; @{TPE3}/@{TPE2}; @{TPE3}" -R .</p><p>With \*(C`-F\*(C' options, this can be simplified as</p><p>  mp3info2 -@F "TCOM=@a" -P "mi/@c/@{U1}; @{TPE2}; @{TPE3}/@{TPE2}; @{TPE3}" -R .</p><p>or</p><p>  mp3info2 -@F "composer=@a" -P "mi/@c/@{U1}; @{TPE2}; @{TPE3}/@{TPE2}; @{TPE3}" -R .</p><p>To copy \s-1ID3\s0 tags of \s-1MP3\s0 files in the current directory to files in directory <em>/tmp/mp3</em> with the extension <em>.tag</em> (and print \*(L"progress report\*(R"), use</p><p>  mp3info2 -p "@N@E&#92;n" -@P "bODi,@{ID3v2}@{ID3v1},/tmp/mp3/@N.tag" -DNR .</p><p>Since we did not use \*(C`z\*(C' flag, \s-1MP3\s0 files without tags are skipped.</p><p>Now suppose that there are two parallel file hierarchies of audio files, and of lyrics: audio files are in <em>audio/dir_name/audio_name.mp3</em> with corresponding lyrics file in <em>text/dir_name/audio_name.mp3</em>.  To attach lyrics to \s-1MP3\s0 files (in \*(C`COMM\*(C' frame with description \*(C`lyrics\*(C' in language \*(C`eng\*(C' - <em>this is a non-standard location, see below!</em>), call</p><p>  mp3info2 -@P "fim;../text/@{d0}/@B.txt;@{COMM(eng)[lyrics]}" -Ru .</p><p>inside the directory <em>audio</em>.  (Change \*(C`fim\*(C' to \*(C`Ffim\*(C' to ignore the audio files for which the corresponding text file does not exist.) (Of course, to follow the specifications, one should have used the field "%{USLT(eng)[]}" instead of "%{COMM(eng)[lyrics]}"; see below for variations).</p><p>Finish by a very simple example: all what the pattern</p><p>  -P &apos;i;%t;%t&apos;</p><p>does is removal of trailing and leading blanks from the title (which is deduced by other means).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">More examples</h2>
        <div class="sectioncontent">
<p>With \*(C`-F\*(C' option, one could set the \*(C`USLT\*(C' frame as</p><p>  mp3info2 -@F "USLT(eng)[] &lt; ../text/@{d0}/@B.txt" -Ru .</p><p>Print out such a frame (in any language) with</p><p>  mp3info2 -@p "@{USLT[]}&#92;n" file.mp3</p><p>Similarly, to print out the \s-1APIC\s0 frame with empty description, use</p><p>  mp3info2 -e binary -@p "@{APIC[]}" file.mp3 &gt; output_picture_file</p><p>or (with description \*(L"cover\*(R")</p><p>  mp3info2 -@P "bOi,@{APIC[cover]},output_picture_file.jpg" audio_07.mp3</p><p>To set such a frame from file <em>xxx.gif</em> (with the default \*(C`Picture Type\*(C', "Cover (front)", and empty description), do one of</p><p>  mp3info2 -F  "APIC  &lt;          xxx.gif"  file.mp3   mp3info2 -@F "APIC[]=@{I(fimbB)xxx.gif}" file.mp3</p><p>The difference of \*(C`APIC\*(C' and \*(C`APIC[]\*(C' is that the first removes all \*(C`APIC\*(C' frames first, and the second removes only all \*(C`APIC\*(C' frames with empty description - but arbitrary image type.  So it may be more suitable to use the full specification, as in \*(C`APIC(Cover (front))[]\*(C'.</p><p>To remove \*(C`APIC\*(C' frames with empty descriptions, arbitrary \*(C`Picture Type\*(C's (and \*(C`MIME type\*(C's which may be correctly calculated by <em>mp3info2</em>, e.g., \*(C`TIFF/JPEG/GIF/PNG\*(C'), use</p><p>  mp3info2 -d "APIC[]" file.mp3</p><p>(note that this wouldn't free disk space, unless \*(L"shrink\*(R" is forced by configuration variables).  To do the same with the \*(L"Conductor\*(R" picture type only, do</p><p>  mp3info2 -d "APIC(Conductor)[]" file.mp3</p><p>To scan through subdirectories, and add file <em>cover.jpg</em> from the directory of the file as a \*(L"default\*(R" \*(C`APIC\*(C' frame, but only if there is no \*(C`APIC\*(C' frame, and a file exists, do</p><p>  mp3info2 -@F "APIC ?&lt; @D/cover.jpg" -R .</p><p>This deletes empty frames for date, \*(C`TCOP, TENC, WXXX[], COMM(eng)[]\*(C', and removes the leading 0 from track number from \s-1MP3\s0 file in current directory:</p><p>  mp3info2 -@ -E +/i:y -F "TCOP=@{TCOP}" -F "TENC=@{TENC}"     -F "WXXX[]=@{WXXX[]}" -F "COMM(eng)[]=@{COMM(eng)[]}"     -y "@y" -P "mi/@n/0@n/@n" *.mp3</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Examples on dealing with broken encodings</h2>
        <div class="sectioncontent">
<p>One of principal weaknesses of \s-1ID3\s0 specification was that it required that data is provided in \*(C`latin-1\*(C' encoding.  Since most languages in the world are not expressible in \*(C`latin-1\*(C', this lead to (majority?) of \s-1ID3\s0 tags being not standard-conforming.  Newer versions of the specs fixed this shortcoming, but the damage was already done.  Fortunately, this script can use abilities of \*(C`MP3::Tag\*(C' to convert from non-conforming content to a conforming one.</p><p>The following example converts ID3v2 tags which were written in (non-standard-conforming) encoding \*(C`cp1251\*(C' to be in standard-conforming encoding.  For the purpose of this example, assume that ID3v1 tags are in the same encoding (and that one wants to leave them in the encoding \*(C`cp1251\*(C'); the files to process are found in the current directory and (recursively) in its subdirectories (\*(C`set\*(C' syntax for \s-1DOSISH\s0 shells):</p><p>  set MP3TAG_DECODE_V1_DEFAULT=cp1251   set MP3TAG_DECODE_V2_DEFAULT=cp1251   mp3info2 -C id3v2_fix_encoding_on_write=1 -u2R .</p><p>For more information, see \*(L"\s-1ENVIRONMENT\s0\*(R" in MP3::Tag, \*(L"config\*(R" in MP3::Tag, and \*(L"\s-1CUSTOMIZATION\s0\*(R" in MP3::Tag.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INCOMPATIBILITIES with \fImp3info\fP</h2>
        <div class="sectioncontent">
<p>This tool is loosely modeled on the program <em>mp3info</em>; it is \*(L"mostly\*(R" backward compatible (especially when in \*(L"naive\*(R" mode via \*(C`-N\*(C'), and allows a very significant superset of functionality.  Known backward incompatibilities are:</p><p>  -G -h -r -d -x</p><p>Missing functionality:</p><p>  -f -F -i</p><p>Incompatible \*(C`%\*(C'-<em>escapes</em>:</p><p>  %e %E         - absolutely different semantic   %v            - has no trailing 0s   %q            - has fractional part   %r            - is a number, not a word "Variable" for VBR   %u            - is one less (in presence of descriptor frame only?)</p><p>Missing \*(C`%\*(C'-<em>escapes</em>:</p><p>  %b %G</p><p>Backslash escapes: only \*(C`&#92;&#92;\*(C', \*(C`&#92;n\*(C', \*(C`&#92;t\*(C' supported.</p><p>\*(C`-x\*(C' prints data in a different format, not all fields are present, and ID3v2 tag names are output.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">
<p>With \*(C`-e\*(C' 1, 2 or 3, this script may consult environment variables \*(C`LC_CTYPE, LC_ALL, LANG\*(C' to deduce the current encoding.  No other environment variables are directly read by this script.</p><p>Note however, that MP3::Tag module has a rich set of defaults for encoding settings settable by environment variables; see \*(L"\s-1ENVIRONMENT\s0\*(R" in MP3::Tag.  So these variables affect (indirectly) how this script works.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OBSOLETE INTERFACE</h2>
        <div class="sectioncontent">
<p>If you do not understand what it is about, it is safe to ignore this announcement:</p><p>The old, pre-version=1.05 way (by triplication of a separator, without repetition of options) to provide multiple commands to \*(C`-F\*(C' and &lt;-P&gt; options is still supported, but is strongly discouraged.  (It does not conflict with the current interface.)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Ilya Zakharevich &lt;cpan@ilyaz.org&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Utilities to create CDDB file</h2>
        <div class="sectioncontent">
<p>Good \s-1CD\s0 reapers (e.g., <em>cdda2wav</em> with option \*(C`cddb=0\*(C') create a \s-1CDDB\s0 file with fetched information - as far as an Internet connection is present.  However, if not available, other options exist.</p><p>The scripts (supplied with the distribution in <em>./examples</em>) can create a \*(L"stub\*(R" \s-1CDDB\s0 file basing on:</p>
<dl class='dl-vertical'>
  <dt>
    <em>fulltoc2fake_cddb.pl</em>
  </dt>
  <dd>
    <p>a dump of a full \s-1TOC\s0 of a \s-1CD\s0; create one, e.g., by   readcd -fulltoc dev=0,1,0 -f=audiocd</p>
  </dd>
  <dt>
    <em>inf2fake_cddb.pl</em>
  </dt>
  <dd>
    <p>directory of <em>*.inf</em> files (e.g., created by <em>cdda2wav</em> without Internet connection);</p>
  </dd>
  <dt>
    <em>dir_mp3_2fake_cddb.pl</em>
  </dt>
  <dd>
    <p>a directory of \s-1MP3\s0 files ripped from a \s-1CD\s0 (via some guesswork).</p>
  </dd>

</dl>
<p>Passing this stub to the script <em>cddb2cddb.pl</em>, it can be transformed to a \*(L"filled\*(R" \s-1CDDB\s0 file via a connection to some online database.  Use \*(C`-r\*(C' option if multiple records in the database match the \s-1CD\s0 signature.</p><p>  fulltoc2fake_cddb audiocd.toc | cddb2cddb     &gt; audio.cddb   inf_2fake_cddb                | cddb2cddb     &gt; audio.cddb   dir_mp3_2fake_cddb            | cddb2cddb -r3 &gt; audio.cddb # 3rd record</p><p>When such a \s-1CDDB\s0 file is present, it will be used by MP3::Tag module to deduce the information about an audio file.  This information is (by default, transparently) used by this script.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO mp3info2&hellip;</h2>
        <div class="sectioncontent">
<p>MP3::Tag, MP3::Tag::ParseData, audio_rename, typeset_audio_dir</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="mp3cd.1p.html"><span aria-hidden="true">&larr;</span> mp3cd.1p: Burns normalized audio cds from lists of mp3s/wavs/oggs/flacs</a></li>
   <li class="next"><a href="msguntypot.1p.html">msguntypot.1p: Update po files when a typo is fixed in pot file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
