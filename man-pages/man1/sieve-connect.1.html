<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>sieve-connect: Managesieve command-line client</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Managesieve command-line client">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="sieve-connect (1) manual">
  <meta name="twitter:description" content="Managesieve command-line client">
  <meta name="twitter:image" content="https://www.carta.tech/images/sieve-connect-sieve-connect-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/sieve-connect.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="sieve-connect (1) manual" />
  <meta property="og:description" content="Managesieve command-line client" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/sieve-connect-sieve-connect-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">sieve-connect<small> (1)</small></h1>
        <p class="lead">Managesieve command-line client</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/sieve-connect.1.html">
      <span itemprop="name">sieve-connect: Managesieve command-line client</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/sieve-connect/">
      <span itemprop="name">sieve-connect</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/sieve-connect.1.html">
      <span itemprop="name">sieve-connect: Managesieve command-line client</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
 sieve-connect [-s &lt;hostname&gt;] [-p &lt;portspec&gt;] [-u &lt;user&gt;] [a &lt;authzid&gt;]
               [-m &lt;authmech&gt;] [-r realm] [-e execscript]
               [... longopts ...]
 sieve-connect [--localsieve &lt;script&gt;] [--remotesieve &lt;script&gt;]
               [--debug] [--dumptlsinfo]
               [--server &lt;hostname&gt;] [--port &lt;portspec&gt;] [--4|--6]
               [--user &lt;authentication_id&gt;] [--authzid &lt;authzid&gt;]
               [--realm &lt;realm&gt;] [--passwordfd &lt;n&gt;]
               [--clientkey &lt;file&gt; --clientcert &lt;file&gt;]|[--clientkeycert &lt;file&gt;]
               [--notlsverify|--nosslverify]
               [--tlscertfingerprint|--sslcertfingerprint &lt;dgsttype:digest&gt;]
               [--tlscapath &lt;ca_directory&gt;]|[--tlscafile &lt;ca_file&gt;]
               [--noclearauth] [--noclearchan]
               [--authmech &lt;mechanism&gt;]
               [--ignoreserverversion]
               [--upload|--download|--list|--delete|--checkscript|--edit|
                --activate|--deactivate]|[--exec &lt;script&gt;]
               [--help|--man]
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>sieve-connect</strong> is a client for the \*(C`MANAGESIEVE\*(C' protocol, which is an RFC-specified protocol for manipulation of \*(C`Sieve\*(C' scripts in a repository. More simply, <strong>sieve-connect</strong> lets you control your mail-filtering rule files on a mail server.</p><p><strong>sieve-connect</strong> can be invoked with an action from the command-line to make it easy to script one-shot actions, it can be provided with a script file or it can be left to enter an interactive command-loop, where it supports tab-completion (if the supporting Perl module is available) and basic navigation of the local file-system in the style of \*(C`FTP\*(C' clients.</p><p><strong>sieve-connect</strong> supports the use of \*(C`TLS\*(C' via the \*(C`STARTTLS\*(C' command, including authentication via client certificates. \*(C`sieve-connect\*(C' also supports whichever \*(C`SASL\*(C' mechanisms your <em>Authen::SASL::Perl</em> library provides, as long as they do not require \s-1SASL\s0 protection layers.</p><p>In Interactive mode, a \*(C`help\*(C' command is available.  Command parameters with a \*(C`%\*(C' in them are examined to see if they match %KEYWORD, where \*(C`KEYWORD\*(C' is always in upper-case.  The list of keywords may be retrieved with the \*(C`keywords\*(C' command and includes items such as %DATE, %USER, etc.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>Option names may be given as the shortest unique prefix.</p><p>The remote sieve script name defaults to the same as the local sieve script name, so just specify the local one if only one is needed; it was a deliberate decision to have the defaults this way around, to make people think about names in the local filesystem.  There is no default script name.</p><p>The <strong>--debug</strong> option turns on diagnostic traces. The <strong>--debugsasl</strong> option asks the \s-1SASL\s0 library for debugging. The <strong>--dumptlsinfo</strong> shows the \s-1TLS\s0 (\s-1SSL\s0) peer information; if specified together with <strong>--debug</strong> then the server's \s-1PEM\s0 certificate will be provided as debug trace.</p><p>The <strong>--version</strong> option shows version information. When combined with <strong>--debug</strong> it will show implementation dependency versions. The <strong>--help</strong> and <strong>--man</strong> options provide usage information.</p><p>The server can be a host or \s-1IP\s0 address, IPv4 or IPv6.</p><p>If a server is provided by <strong>--server</strong> then that takes precedence. If that option is not present, then $IMAP_SERVER from the environment is checked and, if it's not a unix-domain socket path, is used with any port specification stripped off.</p><p>Next, unless <strong>--nosrv</strong> is given, checks are made for \s-1SRV\s0 records so as to search for a default server; if the <em>Mozilla::PublicSuffix</em> Perl module is available, these checks are done for every level of the hostname upto (but not including) the public suffix. If that module is not available, a crude heuristic is used: as long as there are three dots in the hostname, \s-1SRV\s0 records for the part of the hostname after the first dot are tried. If this is inappropriate, install <em>Mozilla::PublicSuffix</em>.</p><p>If no \s-1SRV\s0 records are found which point to a 'sieve', 'imaps' or 'imap' protocol service, of if a record is found which says \*(L"no such service in this domain\*(R" (by having a target of \*(L".\*(R"), then the final default server is <em>localhost</em>.</p><p>The port can be any Perl port specification, default is <em>sieve(4190)</em>. A port from an \s-1SRV\s0 record will take precedence.  The Perl specification provides a name to look up in the system services database (<em>/etc/services</em>) followed in parentheses by a default value to use if the name is not found. Thus this default will honour a value of 2000 from <em>/etc/services</em>.</p><p>The <strong>--4</strong> or <strong>--6</strong> options may be used to coerce IPv4 or IPv6.</p><p>By default, the server is taken to be a domain, for which \s-1SRV\s0 records are looked up; use <strong>--nosrv</strong> to inhibit \s-1SRV\s0 record lookup.</p><p>The <strong>--user</strong> option will be required unless you're on a Unix system with <em>getpwuid()</em> available and your Cyrus account name matches your system account name.  <strong>--authmech</strong> can be used to force a particular authentication mechanism.  <strong>--authzid</strong> can be used to request authorisation to act as the specified id. <strong>--realm</strong> can be used to try to pass realm information to the authentication mechanism. If you want to provide a password programmatically, use <strong>--passwordfd</strong> to state which file descriptor (typically <em>0</em>) the password can be read from. Everything until the newline before \s-1EOF\s0 is the password, so it can contain embedded newlines.  Do not provide passwords on a command-line or in a process environment.</p><p>Unless modified at install/packaging time, by default \s-1SSL\s0 certificate authority certificates are searched for. The first attempt is to try, in turn, for environment variables $SSL_CERT_DIR & $SSL_CERT_FILE which are the names supported by the OpenSSL library and so often supported by client commands. Next, if the OpenSSL command \*(C`version\*(C' is available and the output \*(C`OPENSSLDIR\*(C' can be parsed and the \*(C`certs\*(C' directory exists within that directory, then that location will be used. Finally, a fixed list of common locations are searched and the first one to exist is used.  Invoking with <strong>--debug</strong> will show more details during the \*(C`setup:\*(C' phase.</p><p>Precedence above these defaults is given to the <strong>--tlscafile</strong> option if given, else the <strong>--tlscapath</strong> option if that is given. The former is one file containing certificates, the latter is a directory.</p><p>Alternatively, if you are willing to accept the risk of man-in-the-middle active attacks and you are unable to arrange for the relevant Certificate Authority certificate to be available, then you can lower your safety with the <strong>--notlsverify</strong> option, also spelt <strong>--nosslverify</strong>.</p><p>If you don't want to (only) rely on \s-1CA\s0 systems you can explicitly set an expected server certificate fingerprint using the <strong>--tlscertfingerprint</strong> option, also spelt <strong>--sslcertfingerprint</strong>.  If you wish to ignore \s-1CA\s0 validation, you still need to disable that explicitly (see above), as the default is to add an extra constraint (pinning, within valid \s-1CA\s0 certificates). This option specifies the X.509 certificate fingerprint (not a public key fingerprint), as given by OpenSSL.  The first part of the value should be an algorithm name, such as \*(C`sha256\*(C' or \*(C`sha1\*(C'.  That is followed by a colon, and then the fingerprint data in its usual colon-delimited hexadecimal notation. Eg: \*(C`--tlscertfingerprint sha256:24:B4:..28-more-fields..:A8:58\*(C'</p><p>For \s-1SSL\s0 client certificate authentication, either <strong>--clientkeycert</strong> may be used to refer to a file with both the key and cert present or both <strong>--clientkey</strong> and <strong>--clientcert</strong> should point to the relevant files. The data should be in \s-1PEM\s0 file-format.</p><p>The <strong>--noclearauth</strong> option will prevent use of cleartext authentication mechanisms unless protected by \s-1TLS\s0.  The <strong>--noclearchan</strong> option will mandate use of some confidentiality layer; at this time only \s-1TLS\s0 is supported.</p><p>By default, the server's \*(L"\s-1VERSION\s0\*(R" capability will be used to filter the commands available.  Use <strong>--ignoreserverversion</strong> to prevent this.</p><p>The remaining options denote actions.  One, and only one, action may be present.  If no action is present, the interactive mode is entered. If the exec action is present, commands are read from the script instead.</p>
<dl class='dl-vertical'>
  <dt>
    <strong>--upload</strong> will upload a script to the server.
  </dt>
  <dd>
    
  </dd>
  <dt>
    <strong>--download</strong> will download a script from the server.
  </dt>
  <dd>
    
  </dd>
  <dt>
    <strong>--list</strong> will list the scripts which exist on the server. One of those scripts might be marked \s-1ACTIVE\s0.
  </dt>
  <dd>
    
  </dd>
  <dt>
    <strong>--delete</strong> will delete a script from the server.
  </dt>
  <dd>
    
  </dd>
  <dt>
    <strong>--checkscript</strong> will ask the server to validate the local file provided.
  </dt>
  <dd>
    
  </dd>
  <dt>
    <strong>--edit</strong> will download a script, invoke an editor upon it, ask the server to check the results (and offer to re-edit if the server rejects it) and finally upload the result.
  </dt>
  <dd>
    
  </dd>
  <dt>
    <strong>--activate</strong> will mark the specified remote script as the active one.
  </dt>
  <dd>
    
  </dd>
  <dt>
    <strong>--deactivate</strong> will remove the active mark from the specified remote script without activating a replacement.
  </dt>
  <dd>
    
  </dd>
  <dt>
    <strong>--exec</strong> will take a file-name containing commands as though given in the normal read-eval-print loop.
  </dt>
  <dd>
    
  </dd>

</dl>
<p>Note that <strong>--check</strong> and <strong>--edit</strong> require a server which advertises a \*(L"\s-1VERSION\s0\*(R" capability, see <strong>--ignoreserverversion</strong> to override.</p><p>(If <strong>--server</strong> is not explicitly stated, it may be provided at the end of the command-line for compatibility with sieveshell.)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">
<p>$IMAP_SERVER for a default \s-1IMAP\s0 server.</p><p>$USERNAME and $LOGNAME where the \*(C`getpwuid()\*(C' function is not available.</p><p>$SSL_CERT_DIR and $SSL_CERT_FILE for locating default Certificate Authority trust anchors.</p><p>$VISUAL, else $EDITOR, for the edit action.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>If the authentication protocol negotiates a protection layer then things will rapidly Go Bad.  A mitigating factor is that no protection layer should be negotiated whilst under \s-1STARTTLS\s0 protection.  Just use \s-1TLS\s0!</p><p>When listing scripts, the format is based upon the raw server output, assuming that the server uses quoted-strings for the script names.  The output is just passed back on the basis that it's a fairly good interface to pass to a program.  But a server could choose to use literal strings, even though the results are defined as line-break separated \*(-- that would mean that some linebreaks are special.  Hopefully no server will do this.</p><p>If <strong>sieve-connect</strong> fails to connect to an IPv4 server without the <strong>-4</strong> option being explicitly passed, then you've encountered a portability issue in the <em>IO::Socket::INET6</em> Perl library and need to upgrade that.</p><p>Most historical implementations used port 2000 for ManageSieve.  \s-1RFC5804\s0 allocates port 4190.  This tool uses a port-spec of \*(L"sieve(4190)\*(R" as the default port, which means that an <em>/etc/services</em> (or substitute) entry for \*(L"sieve\*(R" as a \s-1TCP\s0 service takes precedence, but if that is not present, will assume 4190 as the default.  This change means that if you're still using port 2000 and do not have an <em>/etc/services</em> entry, updating to/beyond release 0.75 of this tool will break invocations which do not specify a port.  The specification of the default port was moved to the user-configurable section at the top of the script and administrators may wish to override the shipped default.  You can bypass all of this mess by publishing \s-1SRV\s0 records, per \s-1RFC5804\s0.</p><p>The Net::DNS Perl module does not (at time of writing) provide full support for weighted prioritised \s-1SRV\s0 records and I have not made any effort to fix this; whatever the default sort algorithm provides for \s-1SRV\s0 is what is used for ordering.</p><p>If you don't specify a server and don't export $IMAP_SERVER in the environment then the search mechanism is safer and more thorough if the <em>Mozilla::PublicSuffix</em> Perl module is installed. In particular, if your hostname is also your domain name and the parent domain is administered by someone you don't trust, then you'll regret not installing that module.</p><p>Probably need to sit down and work through the final \s-1RFC\s0 and see if any functionality is still missing.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NON-BUGS</h2>
        <div class="sectioncontent">
<p>Actually uses \s-1STARTTLS\s0.  Can handle script names with embedded whitespace. Author needs access to a server which handles embedded quote characters properly to complete testing of that.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">
<p><strong>sieve-connect</strong> was written as a demonstration for the \*(C`info-cyrus\*(C' mailing-list, 2006-11-14.  It was a single-action-and-quit script for scripting purposes.  The command-loop code was written (two days) later and deliberately designed to be compatible with sieveshell.</p><p>Versions prior to 0.85 did not actually verify the peer certificate identity, although this author stupidly believed that it did. API/expectations mismatch.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Phil Pennock &lt;phil-perl@spodhuis.org&gt; is guilty, m'Lud.</p><p>There is a low-volume announcement list for new releases; the web interface is at http://mail.globnix.net/mailman/listinfo/sieve-connect-announce &lt;http://mail.globnix.net/mailman/listinfo/sieve-connect-announce&gt; or you can send mail, mailto:sieve-connect-announce-request@spodhuis.org?subject=subscribe &lt;mailto:sieve-connect-announce-request@spodhuis.org?subject=subscribe&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PREREQUISITES</h2>
        <div class="sectioncontent">
<p>Perl.  <em>Authen::SASL</em>.  <em>IO::Socket::INET6</em>. <em>IO::Socket::SSL</em> (at least version 1.14).  <em>Pod::Usage</em>. <em>Net::DNS</em> for \s-1SRV\s0 lookup. <em>Pod::Simple::Text</em> for built-in man command (optional). <em>Term::ReadKey</em> to get passwords without echo. Various other Perl modules which are believed to be standard. <em>Term::ReadLine</em> will significantly improve interactive mode. <em>Term::ReadLine::Gnu</em> will improve it further by allowing tab-completion. <em>Mozilla::PublicSuffix</em> is highly recommended and will improve security.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INTEROPERABILITY</h2>
        <div class="sectioncontent">
<p><strong>sieve-connect</strong> is regularly tested with the <strong>timsieved</strong> server distributed with the Cyrus \s-1IMAP\s0 server.  Further interoperability testing is underway, more is desired (test accounts appreciated!).</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="sieve.1.html"><span aria-hidden="true">&larr;</span> sieve.1: A mail filtering tool.</a></li>
   <li class="next"><a href="sieve-dump.1.html">sieve-dump.1: Pigeonholes sieve script binary dump tool <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
