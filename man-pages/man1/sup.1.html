<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>sup: Software upgrade protocol</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Software upgrade protocol">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="sup (1) manual">
  <meta name="twitter:description" content="Software upgrade protocol">
  <meta name="twitter:image" content="https://www.carta.tech/images/sup-sup-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/sup.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="sup (1) manual" />
  <meta property="og:description" content="Software upgrade protocol" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/sup-sup-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">sup<small> (1)</small></h1>
        <p class="lead">Software upgrade protocol</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/sup.1.html">
      <span itemprop="name">sup: Software upgrade protocol</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/sup/">
      <span itemprop="name">sup</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/sup.1.html">
      <span itemprop="name">sup: Software upgrade protocol</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>sup</strong> [ <em>flags</em> ] [ <em>supfile</em> ] [ <em>collection</em> ...]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><em>Sup</em> is a program used for upgrading collections of files from other machines to your machine.  You execute <em>sup</em>, the <em>client</em> program, which talks over the network using IP/TCP to a <em>file server</em> process. The file server process cooperates with <em>sup</em> to determine which files of the collection need to be upgraded on your machine.</p><p>Sup collections can have multiple releases. One use for such releases is to provide different versions of the same files. At CMU, for example, system binaries have alpha, beta and default release corresponding to different staging levels of the software. We also use release names default and minimal to provide complete releases or subset releases. In both of these cases, it only makes sense to sup one release of the collections. Releases have also been used in private or external sups to provide subsets of collections where it makes sense to pick up several of the releases. For example the Mach 3.0 kernel sources has a default release of machine independent sources and separate releases of machine dependent sources for each supported platform.</p><p>In performing an upgrade, the file server constructs a list of files included in the specified release of the collection.  The list is sent to your machine, which determines which files are needed.  Those files are then sent from the file server. It will be most useful to run <em>sup</em> as a daemon each night so you will continually have the latest version of the files in the needed collections.</p><p>The only required argument to <em>sup</em> is the name of a supfile.  It must either be given explicitly on the command line, or the <strong>-s</strong> flag must be specified.  If the <strong>-s</strong> flag is given, the system supfile will be used and a supfile command argument should not be specified.  The list of collections is optional and if specified will be the only collections upgraded.  The following flags affect all collections specified:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-s</strong></p>
  </dt>
  <dd>
    <p>As described above.</p>
  </dd>
  <dt>
    <p><strong>-t</strong></p>
  </dt>
  <dd>
    <p>When this flag is given, <em>sup</em> will print the time that each collection was last upgraded, rather than performing actual upgrades.</p>
  </dd>
  <dt>
    <p><strong>-u</strong></p>
  </dt>
  <dd>
    <p>When this flag is given, <em>sup</em> will not try to restore the user access and modified times of files in the collections from the server.</p>
  </dd>
  <dt>
    <p><strong>-S</strong></p>
  </dt>
  <dd>
    <p>Operate silently printing messages only on errors.</p>
  </dd>
  <dt>
    <p><strong>-N</strong></p>
  </dt>
  <dd>
    <p><em>Sup</em> will trace network messages sent and received that implement the <em>sup</em> network protocol.</p>
  </dd>
  <dt>
    <p><strong>-P</strong></p>
  </dt>
  <dd>
    <p>Sup will use a set of non-privileged network ports reserved for debugging purposes.</p>
  </dd>

</dl>
<p>The remaining flags affect all collections unless an explicit list of collections are given with the flags.  Multiple flags may be specified together that affect the same collections.  For the sake of convenience, any flags that always affect all collections can be specified with flags that affect only some collections.  For example, <strong>sup -sde=coll1,coll2</strong> would perform a system upgrade, and the first two collections would allow both file deletions and command executions.  Note that this is not the same command as <strong>sup -sde=coll1 coll2,</strong> which would perform a system upgrade of just the coll2 collection and would ignore the flags given for the coll1 collection.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-a</strong></p>
  </dt>
  <dd>
    <p>All files in the collection will be copied from the repository, regardless of their status on the current machine.  Because of this, it is a very expensive operation and should only be done for small collections if data corruption is suspected and been confirmed.  In most cases, the <strong>-o</strong> flag should be sufficient.</p>
  </dd>
  <dt>
    <p><strong>-b</strong></p>
  </dt>
  <dd>
    <p>If the <strong>-b</strong> flag if given, or the <strong>backup</strong> supfile option is specified, the contents of regular files on the local system will be saved before they are overwritten with new data.  The file collection maintainer can designate specific files to be worthy of backing up whenever they are upgraded. However, such backup will only take place if you specify this flag or the <strong>backup</strong> option to allow backups for a file collection on your machine. The backup mechanism will create a copy of the current version of a file immediately before a new copy is received from the file server; the copy is given the same name as the original file but is put into a directory called <strong></strong> BACKUP within the directory containing the original file. For example, <strong></strong> /usr/sas/src/foo.c would have a backup copy called <strong></strong> /usr/sas/src/BACKUP/foo.c. There is no provision for automatically maintaining multiple old versions of files; you would have to do this yourself.</p>
  </dd>
  <dt>
    <p><strong>-B</strong></p>
  </dt>
  <dd>
    <p>The <strong>-B</strong> flag overrides and disables the <strong>-b</strong> flag and the <strong>backup</strong> supfile option.</p>
  </dd>
  <dt>
    <p><strong>-d</strong></p>
  </dt>
  <dd>
    <p>Files that are no longer in the collection on the repository will be deleted if present on the local machine and were put there by a previous sup. This may also be specified in a supfile with the <strong>delete</strong> option.</p>
  </dd>
  <dt>
    <p><strong>-D</strong></p>
  </dt>
  <dd>
    <p>The <strong>-D</strong> flag overrides and disables the <strong>-d</strong> flag and the <strong>delete</strong> supfile option.</p>
  </dd>
  <dt>
    <p><strong>-e</strong></p>
  </dt>
  <dd>
    <p>Sup will execute commands sent from the repository that should be run when a file is upgraded.  If the <strong>-e</strong> flag is omitted, Sup will print a message that specifies the command to execute.  This may also be specified in a supfile with the <strong>execute</strong> option.</p>
  </dd>
  <dt>
    <p><strong>-E</strong></p>
  </dt>
  <dd>
    <p>The <strong>-E</strong> flag overrides and disables the <strong>-e</strong> flag and the <strong>execute</strong> supfile option.</p>
  </dd>
  <dt>
    <p><strong>-f</strong></p>
  </dt>
  <dd>
    <p>A <em>list-only</em> upgrade will be performed.  Messages will be printed that indicate what would happen if an actual upgrade were done.</p>
  </dd>
  <dt>
    <p><strong>-k</strong></p>
  </dt>
  <dd>
    <p><em>Sup</em> will check the modification times of files on the local disk before updating them.  Only files which are newer on the repository than on the local disk will be updated; files that are newer on the local disk will be kept as they are. This may also be specified in a supfile with the <strong>keep</strong> option.</p>
  </dd>
  <dt>
    <p><strong>-K</strong></p>
  </dt>
  <dd>
    <p>The <strong>-K</strong> flag overrides and disables the <strong>-k</strong> flag and the <strong>keep</strong> supfile option.</p>
  </dd>
  <dt>
    <p><strong>-l</strong></p>
  </dt>
  <dd>
    <p>Normally, <em>sup</em> will not upgrade a collection if the repository is on the same machine.  This allows users to run upgrades on all machines without having to make special checks for the repository machine.  If the <strong>-l</strong> flag is specified, collections will be upgraded even if the repository is local.</p>
  </dd>
  <dt>
    <p><strong>-m</strong></p>
  </dt>
  <dd>
    <p>Normally, <em>sup</em> used standard output for messages. If the <strong>-m</strong> flag if given, <em>sup</em> will send mail to the user running <em>sup</em>, or a user specified with the <strong>notify</strong> supfile option, that contains messages printed by <em>sup</em>.</p>
  </dd>
  <dt>
    <p><strong>-M &lt;user&gt;</strong></p>
  </dt>
  <dd>
    <p>like <strong>-m</strong> but send mail to the specified user.</p>
  </dd>
  <dt>
    <p><strong>-o</strong></p>
  </dt>
  <dd>
    <p><em>Sup</em> will normally only upgrade files that have changed on the repository since the last time an upgrade was performed. That is, if the file in the repository is newer than the date stored in the <em>when</em> file on the client.  The <strong>-o</strong> flag, or the <strong>old</strong> supfile option, will cause <em>sup</em> to check all files in the collection for changes instead of just the new ones.</p>
  </dd>
  <dt>
    <p><strong>-O</strong></p>
  </dt>
  <dd>
    <p>The <strong>-O</strong> flag overrides and disables the <strong>-o</strong> flag and the <strong>old</strong> supfile option.</p>
  </dd>
  <dt>
    <p><strong>-z</strong></p>
  </dt>
  <dd>
    <p>Normally sup transfers files directly without any other processing, but with the <strong>-z</strong> flag, or the <strong>compress</strong> supfile option, sup will compress the file before sending it across the network and uncompress it and restore all the correct file attributes at the receiving end.</p>
  </dd>
  <dt>
    <p><strong>-Z</strong></p>
  </dt>
  <dd>
    <p>The <strong>-Z</strong> flag overrides and disables the <strong>-z</strong> flag and the <strong>compress</strong> supfile option.</p>
  </dd>
  <dt>
    <p><strong>-v</strong></p>
  </dt>
  <dd>
    <p>Normally, <em>sup</em> will only print messages if there are problems.  This flag causes <em>sup</em> to also print messages during normal progress showing what <em>sup</em> is doing.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SETTING UP UPGRADES</h2>
        <div class="sectioncontent">
<p>Each file collection to be upgraded must have a <em>base directory</em> which contains a subdirectory called <strong>sup</strong> that will be used by the <em>sup</em> program; it will be created automatically if you do not create it. <em>Sup</em> will put subdirectories and files into this directory as needed.</p><p><em>Sup</em> will look for a subdirectory with the same name as the collection within the <strong>sup</strong> subdirectory of the <em>base directory.</em> If it exists it may contain any of the following files:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>when.&lt;rel-suffix&gt;</strong></p>
  </dt>
  <dd>
    <p>This file is automatically updated by <em>sup</em> when a collection is successfully upgraded and contains the time that the file server, or possibly <em>supscan</em>, created the list of files in the upgrade list. <em>Sup</em> will send this time to the file server for generating the list of files that have been changed on the repository machine.</p>
  </dd>
  <dt>
    <p><strong>refuse</strong></p>
  </dt>
  <dd>
    <p>This file contains a list of files and directories, one per line, that the client is not interested in that should not be upgraded.</p>
  </dd>
  <dt>
    <p><strong>lock</strong></p>
  </dt>
  <dd>
    <p>This file is used by <em>sup</em> to lock a collection while it is being upgraded. <em>Sup</em> will get exclusive access to the lock file using <a href="../man2/flock.2.html"><strong>flock</strong>(2)</a>, preventing more than one <em>sup</em> from upgrading the same collection at the same time.</p>
  </dd>
  <dt>
    <p><strong>last.&lt;rel-suffix&gt;</strong></p>
  </dt>
  <dd>
    <p>This file contains a list of files and directories, one per line, that have been upgraded by <em>sup</em> in the past.  This information is used when the <strong>delete</strong> option, or the <strong>-d</strong> flag is used to locate files previously upgraded that are no longer in the collection that should be deleted.</p>
  </dd>

</dl>
<p>Each file collection must also be described in one or more supfiles. When <em>sup</em> is executed, it reads the specified supfile to determine what file collections  and releases to upgrade. Each collection-release set is described by a single line of text in the supfile; this line must contain the name of the collection, and possibly one or more options separated by spaces. The options are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>release=</strong><em>releasename</em></p>
  </dt>
  <dd>
    <p>If a collection contains multiple releases, you need to specify which release you want. You can only specify one release per line, so if you want multiple releases from the same collections, you will need to specify the collection more than once. In this case, you should use the <em>use-rel-suffix</em> option in the supfile to keep the last and when files for the two releases separate.</p>
  </dd>
  <dt>
    <p><strong>base=</strong><em>directory</em></p>
  </dt>
  <dd>
    <p>The usual default name of the base directory for a collection is described below (see FILES); if you want to specify another directory name, use this option specifying the desired directory.</p>
  </dd>
  <dt>
    <p><strong>prefix=</strong><em>directory</em></p>
  </dt>
  <dd>
    <p>Each collection may also have an associated <em>prefix directory</em> which is used instead of the base directory to specify in what directory files within the collection will be placed.</p>
  </dd>
  <dt>
    <p><strong>host=</strong><em>hostname</em></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>hostbase=</strong><em>directory</em></p>
  </dt>
  <dd>
    <p><em>System</em> collections are supported by the system maintainers, and <em>sup</em> will automatically find out the name of the host machine and base directory on that machine. However, you can also upgrade <em>private</em> collections; you simply specify with these options the <em>hostname</em> of the machine containing the files and the <em>directory</em> used as a base directory for the file server on that machine. Details of setting up a file collection are given in the section below.</p>
  </dd>
  <dt>
    <p><strong>login=</strong><em>accountid</em></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>password=</strong><em>password</em></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>crypt=</strong><em>key</em></p>
  </dt>
  <dd>
    <p>Files on the file server may be protected, and network transmissions may be encrypted. This prevents unauthorized access to files via <em>sup</em>. When files are not accessible to the default account (e.g. the <strong>anon</strong> anonymous account), you can specify an alternative <em>accountid</em> and <em>password</em> for the file server to use on the repository host. Network transmission of the password will be always be encrypted. You can also have the actual file data encrypted by specifying a <em>key</em>; the file collection on the repository must specify the same key or else <em>sup</em> will not be able to upgrade files from that collection. In this case, the default account used by the file server on the repository machine will be the owner of the encryption key file (see FILES) rather than the <strong>anon</strong> anonymous account.</p>
  </dd>
  <dt>
    <p><strong>notify=</strong><em>address</em></p>
  </dt>
  <dd>
    <p>If you use the <strong></strong> -m option to receive log messages by mail, you can have the mail sent to different user, possibly on another host, than the user running the sup program. Messages will be sent to the specified <em>address</em>, which can be any legal netmail address. In particular, a project maintainer can be designated to receive mail for that project's file collection from all users running <em>sup</em> to upgrade that collection.</p>
  </dd>
  <dt>
    <p><strong>backup</strong></p>
  </dt>
  <dd>
    <p>As described above under the <strong>-b</strong> flag.</p>
  </dd>
  <dt>
    <p><strong>delete</strong></p>
  </dt>
  <dd>
    <p>As described above under the <strong>-d</strong> flag.</p>
  </dd>
  <dt>
    <p><strong>execute</strong></p>
  </dt>
  <dd>
    <p>As described above under the <strong>-e</strong> flag.</p>
  </dd>
  <dt>
    <p><strong>keep</strong></p>
  </dt>
  <dd>
    <p>As described above under the <strong>-k</strong> flag.</p>
  </dd>
  <dt>
    <p><strong>old</strong></p>
  </dt>
  <dd>
    <p>As described above under the <strong>-o</strong> flag.</p>
  </dd>
  <dt>
    <p><strong>use-rel-suffix</strong></p>
  </dt>
  <dd>
    <p>Causes the release name to be used as a suffix to the <em>last</em> and <em>when</em> files. This is necessary whenever you are supping more than one release in the same collection.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PREPARING A FILE COLLECTION REPOSITORY</h2>
        <div class="sectioncontent">
<p>A set of files residing on a repository must be prepared before <em>sup</em> client processes can upgrade those files. The collection must be given a <em>name</em> and a <em>base directory.</em> If it is a private collection, client users must be told the name of the collection, repository host, and base directory; these will be specified in the supfile via the <strong>host</strong> and <strong>hostbase</strong> options. For a system-maintained file collection, entries must be placed into the host list file and directory list file as described in <strong>supservers</strong>(8).</p><p>Within the base directory, a subdirectory must be created called <strong>sup .</strong> Within this directory there must be a subdirectory for each collection using that base directory, whose name is the name of the collection; within each of these directories will be a list file and possibly a prefix file, a host file, an encryption key file, a log file and a scan file. The filenames are listed under FILES below.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>prefix</strong></p>
  </dt>
  <dd>
    <p>Normally, all files in the collection are relative to the base directory. This file contains a single line which is the name of a directory to be used in place of the base directory for file references.</p>
  </dd>
  <dt>
    <p><strong>host</strong></p>
  </dt>
  <dd>
    <p>Normally, all remote host machines are allowed access to a file collection. If you wish to restrict access to specific remote hosts for this collection, put each allowed hostname on a separate line of text in this file. If a host has more than one name, only one of its names needs to be listed. The name <strong>LOCAL</strong> can be used to grant access to all hosts on the local network. The host name may be a  numeric network address or a network name. If a crypt appears on the same line as the host name, that crypt will be used for that host. Otherwise, the crypt appearing in the <em>crypt</em> file, if any will be used.</p>
  </dd>
  <dt>
    <p><strong>crypt</strong></p>
  </dt>
  <dd>
    <p>If you wish to use the <em>sup</em> data encryption mechanism, create an encryption file containing, on a single line of text, the desired encryption key. Client processes must then specify the same key with the <strong>crypt</strong> option in the supfile or they will be denied access to the files. In addition, actual network transmission of file contents and filenames will be encrypted.</p>
  </dd>
  <dt>
    <p><strong>list</strong></p>
  </dt>
  <dd>
    <p>This file describes the actual list of files to be included in this file collection, in a format described below.</p>
  </dd>
  <dt>
    <p><strong>releases</strong></p>
  </dt>
  <dd>
    <p>This file describes any releases that the collection may have. Each line starts with the release name and then may specify any of the following files: <em>prefix=&lt;dirname&gt;</em> to use a different parent directory for the files in this release. <em>list=&lt;listname&gt;</em> to specify the list of files in the release. <em>scan=&lt;scanfile&gt;</em> must be used in multi-release collections that are scanned to keep the scan files for the different releases separate. <em>host=&lt;hostfile&gt;</em> to allow different host restrictions for this release. <em>next=&lt;release&gt;</em> used to chain releases together. This has the effect of making one release be a combination of several other releases. If the same file appears in more than one chained release, the first one found will be used. If these files are not specified for a release the default names: prefix,list,scan and host will be used.</p>
  </dd>
  <dt>
    <p><strong>scan</strong></p>
  </dt>
  <dd>
    <p>This file, created by <em>supscan</em>, is the list of filenames that correspond to the instructions in the list file.  The scan file is only used for frequently updated file collections; it makes the file server run much faster.  See <strong>supservers</strong>(8) for more information.</p>
  </dd>
  <dt>
    <p><strong>lock</strong></p>
  </dt>
  <dd>
    <p>As previously mentioned, this file is used to indicate that the collection should be locked while upgrades are in progress.  All file servers will try to get shared access to the lock file with <a href="../man2/flock.2.html"><strong>flock</strong>(2)</a>.</p>
  </dd>
  <dt>
    <p><strong>logfile</strong></p>
  </dt>
  <dd>
    <p>If a log file exists in the collection directory, the file server will append the last time an upgrade was successfully completed, the time the last upgrade started and finished, and the name of the host requesting the upgrade.</p>
  </dd>

</dl>
<p>It should be noted that <em>sup</em> allows several different named collections to use the same base directory.  Separate encryption, remote host access, and file lists are used for each collection, since these files reside in subdirectories <em>&lt;basedir&gt;/sup/&lt;coll.name&gt;.</em></p><p>The list file is a text file with one command on each line. Each command contains a keyword and a number of operands separated by spaces. All filenames in the list file are evaluated on the repository machine relative to the host's base directory, or prefix directory if one is specified, and on your machine with respect to the base, or prefix, directory for the client. The <em>filenames</em> below (except <em>exec-command</em>) may all include wild-cards and meta-characters as used by <strong>csh</strong>(1) including *, ?, [...], and {...}.  The commands are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>upgrade</strong> <em>filename</em> ...</p>
  </dt>
  <dd>
    <p>The specified file(s) (or directories) will be included in the list of files to be upgraded. If a directory name is given, it recursively includes all subdirectories and files within that directory.</p>
  </dd>
  <dt>
    <p><strong>always</strong> <em>filename</em> ...</p>
  </dt>
  <dd>
    <p>The always command is identical to upgrade, except that omit and omitany commands do not affect filenames specified with the always command.</p>
  </dd>
  <dt>
    <p><strong>omit</strong> <em>filename</em> ...</p>
  </dt>
  <dd>
    <p>The specified file(s) (or directories) will be excluded from the list of files to be upgraded. For example, by specifying <strong>upgrade /usr/vision</strong> and <strong>omit /usr/vision/exp,</strong> the generated list of files would include all subdirectories and files of /usr/vision except /usr/vision/exp (and its subdirectories and files).</p>
  </dd>
  <dt>
    <p><strong>omitany</strong> <em>pattern</em> ...</p>
  </dt>
  <dd>
    <p>The specified patterns are compared against the files in the upgrade list.  If a pattern matches, the file is omitted.  The omitany command currently supports all wild-card patterns except {...}.  Also, the pattern must match the entire filename, so a leading */, or a trailing /*, may be necessary in the pattern.</p>
  </dd>
  <dt>
    <p><strong>backup</strong> <em>filename</em> ...</p>
  </dt>
  <dd>
    <p>The specified file(s) are marked for backup; if they are upgraded and the client has specified the <strong>backup</strong> option in the corresponding line of the supfile, then backup copies will be created as described above. Directories may not be specified, and no recursive filename construction is performed; you must specify the names of the specific files to be backed up before upgrading.</p>
  </dd>
  <dt>
    <p><strong>noaccount</strong> <em>filename</em> ...</p>
  </dt>
  <dd>
    <p>The accounting information of the specified file(s) will not be preserved by <em>sup</em>. Accounting information consists of the owner, group, mode and modified time of a file.</p>
  </dd>
  <dt>
    <p><strong>symlink</strong> <em>filename</em> ...</p>
  </dt>
  <dd>
    <p>The specified file(s) are to be treated as symbolic links and will be transferred as such and not followed.  By default, <em>sup</em> will follow symbolic links.</p>
  </dd>
  <dt>
    <p><strong>rsymlink</strong> <em>dirname</em> ...</p>
  </dt>
  <dd>
    <p>All symbolic links in the specified directory and its subdirectories are to be treated as symbolic links. That is the links will be transferred and not the files to which they point.</p>
  </dd>
  <dt>
    <p><strong>execute</strong> <em>exec-command</em> (<em>filename</em> ...)</p>
  </dt>
  <dd>
    <p>The <em>exec-command</em> you specified will be executed on the client process whenever any of the files listed in parentheses are upgraded. A special token, <strong>%s,</strong> may be specified in the <em>exec-command</em> and will be replaced by the name of the file that was upgraded. For example, if you say <strong>execute ranlib %s (libc.a)</strong>, then whenever libc.a is upgraded, the client machine will execute <strong></strong> ranlib libc.a. As described above, the client must invoke <em>sup</em> with the <strong>-e</strong> flag to allow the automatic execution of command files.</p>
  </dd>
  <dt>
    <p><strong>include</strong> <em>listfile</em> ...</p>
  </dt>
  <dd>
    <p>The specified <em>listfiles</em> will be read at this point.  This is useful when one collection subsumes other collections; the larger collection can simply specify the listfiles for the smaller collections contained within it.</p>
  </dd>

</dl>
<p>The order in which the command lines appear in the list file does not matter.  Blank lines may appear freely in the list file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>Files on the client machine for <em>sup</em>:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>/etc/supfiles/coll.list</strong></p>
  </dt>
  <dd>
    <p>supfile used for -s flag</p>
  </dd>
  <dt>
    <p><strong>/etc/supfiles/coll.what</strong></p>
  </dt>
  <dd>
    <p>supfile used for -s flag when -t flag is also specified</p>
  </dd>
  <dt>
    <p><strong>/etc/supfiles/coll.host</strong></p>
  </dt>
  <dd>
    <p>host name list for system collections</p>
  </dd>
  <dt>
    <p>&lt;<em>base-directory</em>&gt;<strong>/sup/</strong>&lt;<em>collection</em>&gt;<strong>/last</strong>&lt;<em>.release</em>&gt;</p>
  </dt>
  <dd>
    <p>recorded list of files in collection as of last upgrade</p>
  </dd>
  <dt>
    <p>&lt;<em>base-directory</em>&gt;<strong>/sup/</strong>&lt;<em>collection</em>&gt;<strong>/lock</strong></p>
  </dt>
  <dd>
    <p>file used to lock collection</p>
  </dd>
  <dt>
    <p>&lt;<em>base-directory</em>&gt;<strong>/sup/</strong>&lt;<em>collection</em>&gt;<strong>/refuse</strong></p>
  </dt>
  <dd>
    <p>list of files to refuse in collection</p>
  </dd>
  <dt>
    <p>&lt;<em>base-directory</em>&gt;<strong>/sup/</strong>&lt;<em>collection</em>&gt;<strong>/when</strong>&lt;<em>.release</em>&gt;</p>
  </dt>
  <dd>
    <p>recorded time of last upgrade</p>
  </dd>
  <dt>
    <p><strong>/usr/sup/</strong>&lt;<em>collection</em>&gt;</p>
  </dt>
  <dd>
    <p>default base directory for file collection</p>
  </dd>

</dl>
<p>Files needed on each repository machine for the file server:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>/etc/supfiles/coll.dir</strong></p>
  </dt>
  <dd>
    <p>base directory list for system collections</p>
  </dd>
  <dt>
    <p>&lt;<em>base-directory</em>&gt;<strong>/sup/</strong>&lt;<em>collection</em>&gt;<strong>/crypt</strong></p>
  </dt>
  <dd>
    <p>data encryption key for a collection. the owner of this file is the default account used when data encryption is specified</p>
  </dd>
  <dt>
    <p>&lt;<em>base-directory</em>&gt;<strong>/sup/</strong>&lt;<em>collection</em>&gt;<strong>/host</strong></p>
  </dt>
  <dd>
    <p>list of remote hosts allowed to upgrade a collection</p>
  </dd>
  <dt>
    <p>&lt;<em>base-directory</em>&gt;<strong>/sup/</strong>&lt;<em>collection</em>&gt;<strong>/list</strong></p>
  </dt>
  <dd>
    <p>list file for a collection</p>
  </dd>
  <dt>
    <p>&lt;<em>base-directory</em>&gt;<strong>/sup/</strong>&lt;<em>collection</em>&gt;<strong>/lock</strong></p>
  </dt>
  <dd>
    <p>lock file for a collection</p>
  </dd>
  <dt>
    <p>&lt;<em>base-directory</em>&gt;<strong>/sup/</strong>&lt;<em>collection</em>&gt;<strong>/logfile</strong></p>
  </dt>
  <dd>
    <p>log file for a collection</p>
  </dd>
  <dt>
    <p>&lt;<em>base-directory</em>&gt;<strong>/sup/</strong>&lt;<em>collection</em>&gt;<strong>/prefix</strong></p>
  </dt>
  <dd>
    <p>file containing the name of the prefix directory for a collection</p>
  </dd>
  <dt>
    <p>&lt;<em>base-directory</em>&gt;<strong>/sup/</strong>&lt;<em>collection</em>&gt;<strong>/scan</strong></p>
  </dt>
  <dd>
    <p>scan file for a collection</p>
  </dd>
  <dt>
    <p><strong>/usr/</strong>&lt;<em>collection</em>&gt;</p>
  </dt>
  <dd>
    <p>default base directory for a file collection</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO sup&hellip;</h2>
        <div class="sectioncontent">
<p><strong>supservers</strong>(8)</p><p><em>The SUP Software Upgrade Protocol</em>, S. A. Shafer, CMU Computer Science Department, 1985.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>&lt;example&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>The encryption mechanism should be strengthened, although it's not trivial.</p><p><em>sup</em> can delete files it should not with the delete option. This is because in the delete pass, it tries to delete all files in the old list that don't exist in the new list. This is a problem when a directory becomes a symlink to a hierarchy that contains the same names. Then sup will cross the symlink and start deleting files and directories from the destination. This is not easily fixed. Don't use sup with symlink/rsymlink and the delete option at the same time or *be careful*!</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="sundials-config.1.html"><span aria-hidden="true">&larr;</span> sundials-config.1: Returns required flags for linking to sundials libraries</a></li>
   <li class="next"><a href="sup-add.1.html">sup-add.1: Add a source to the sup source list <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
