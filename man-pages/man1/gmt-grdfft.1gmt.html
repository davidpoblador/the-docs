<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>grdfft: Perform mathematical operations on grdfiles in the frequency domain</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Perform mathematical operations on grdfiles in the frequency domain">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="grdfft (1gmt) manual">
  <meta name="twitter:description" content="Perform mathematical operations on grdfiles in the frequency domain">
  <meta name="twitter:image" content="https://www.carta.tech/images/gmt-grdfft-1gmt.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1gmt/gmt-grdfft.1gmt.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="grdfft (1gmt) manual" />
  <meta property="og:description" content="Perform mathematical operations on grdfiles in the frequency domain" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/gmt-grdfft-1gmt.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">grdfft<small> (1gmt)</small></h1>
        <p class="lead">Perform mathematical operations on grdfiles in the frequency domain</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1gmt/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1gmt/grdfft.1gmt.html">
      <span itemprop="name">grdfft: Perform mathematical operations on grdfiles in the frequency domain</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/gmt/">
      <span itemprop="name">gmt</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1gmt/grdfft.1gmt.html">
      <span itemprop="name">grdfft: Perform mathematical operations on grdfiles in the frequency domain</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>grdfft</strong> <em>in_grdfile</em> <strong>-G</strong><em>out_grdfile</em> [ <strong>-A</strong><em>azimuth</em> ] [ <strong>-C</strong><em>zlevel</em> ] [ <strong>-D</strong>[<em>scale</em><strong>|g</strong>] ] [ <strong>-E</strong>[<strong>x|y</strong>][<strong>w</strong>] ] [ <strong>-F</strong>[<em>x|y</em>]<em>lc/lp/hp/hc</em> ] [ <strong>-I</strong>[<em>scale</em><strong>|g</strong>] ] [ <strong>-L</strong> ] [ <strong>-M</strong> ] [ <strong>-N</strong><em>stuff</em> ] [ <strong>-S</strong><em>scale</em> ] [ <strong>-T</strong><em>te/rl/rm/rw/ri</em> ] [ <strong>-V</strong> ]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>grdfft</strong> will take the 2-D forward Fast Fourier Transform and perform one or more mathematical operations in the frequency domain before transforming back to the space domain. An option is provided to scale the data before writing the new values to an output file. The horizontal dimensions of the grdfiles are assumed to be in meters. Geographical grids may be used by specifying the <strong>-M</strong> option that scales degrees to meters. If you have grdfiles with dimensions in km, you could change this to meters using <strong>grdedit</strong> or scale the output with <strong>grdmath</strong>.</p>
<pre>
        No space between the option flag and the associated arguments. Use upper case for the
</pre>
<p>option flags and lower case for modifiers.</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>in_grdfile</em></p>
  </dt>
  <dd>
    <p>2-D binary grd file to be operated on.</p>
  </dd>
  <dt>
    <p><strong>-G</strong></p>
  </dt>
  <dd>
    <p>Specify the name of the output grd file.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-A</strong></p>
  </dt>
  <dd>
    <p>Take the directional derivative in the <em>azimuth</em> direction measured in degrees CW from north.</p>
  </dd>
  <dt>
    <p><strong>-C</strong></p>
  </dt>
  <dd>
    <p>Upward (for <em>zlevel</em> &gt; 0) or downward (for <em>zlevel</em> &lt; 0) continue the field <em>zlevel</em> meters.</p>
  </dd>
  <dt>
    <p><strong>-D</strong></p>
  </dt>
  <dd>
    <p>Differentiate the field, i.e., take d(field)/dz. This is equivalent to multiplying by kr in the frequency domain (kr is radial wave number). Append a scale to multiply by (kr * <em>scale</em>) instead. Alternatively, append <strong>g</strong> to indicate that your data are geoid heights in meters and output should be gravity anomalies in mGal. [Default is no scale].</p>
  </dd>
  <dt>
    <p><strong>-E</strong></p>
  </dt>
  <dd>
    <p>Estimate power spectrum in the radial direction. Place <strong>x</strong> or <strong>y</strong> immediately after <strong>-E</strong> to compute the spectrum in the x or y direction instead. No grdfile is created; f (i.e., frequency or wave number), power[f], and 1 standard deviation in power[f] are written to stdout. Append <strong>w</strong> to write wavelength instead of frequency.</p>
  </dd>
  <dt>
    <p><strong>-F</strong></p>
  </dt>
  <dd>
    <p>Filter the data. Place x or y immediately after <strong>-F</strong> to filter x or y direction only; default is isotropic. Specify four wavelengths in correct units (see <strong>-M</strong>) to design a bandpass filter; wavelengths greater than <em>lc</em> or less than <em>hc</em> will be cut, wavelengths greater than <em>lp</em> and less than <em>hp</em> will be passed, and wavelengths in between will be cosine-tapered. E.g., <strong>-F</strong>1000000/250000/50000/10000 <strong>-M</strong> will bandpass, cutting wavelengths &gt; 1000 km and &lt; 10 km, passing wavelengths between 250 km and 50 km. To make a highpass or lowpass filter, give hyphens (-) for <em>hp</em>/<em>hc</em> or <em>lc</em>/<em>lp</em>. E.g., <strong>-F</strong>x-/-/50/10 will lowpass X, passing wavelengths &gt; 50 and rejecting wavelengths &lt; 10. <strong>-F</strong>y1000/250/-/- will highpass Y, passing wavelengths &lt; 250 and rejecting wavelengths &gt; 1000.</p>
  </dd>
  <dt>
    <p><strong>-I</strong></p>
  </dt>
  <dd>
    <p>Integrate the field, i.e., compute integral_over_z (field * dz). This is equivalent to divide by kr in the frequency domain (kr is radial wave number). Append a scale to divide by (kr * <em>scale</em>) instead. Alternatively, append <strong>g</strong> to indicate that your data set is gravity anomalies in mGal and output should be geoid heights in meters. [Default is no scale].</p>
  </dd>
  <dt>
    <p><strong>-L</strong></p>
  </dt>
  <dd>
    <p>Leave trend alone. By default, a linear trend will be removed prior to the transform.</p>
  </dd>
  <dt>
    <p><strong>-M</strong></p>
  </dt>
  <dd>
    <p>Map units. Choose this option if your grdfile is a geographical grid and you want to convert degrees into meters. If the data are close to either pole, you should consider projecting the grdfile onto a rectangular coordinate system using <strong>grdproject</strong>.</p>
  </dd>
  <dt>
    <p><strong>-N</strong></p>
  </dt>
  <dd>
    <p>Choose or inquire about suitable grid dimensions for FFT. <strong>-Nf</strong> will force the FFT to use the dimensions of the data. <strong>-Nq will inQuire about more suitable dimensions.</strong> <strong>-N</strong><em>nx/ny</em> will do FFT on array size <em>nx/ny</em> (Must be &gt;= grdfile size). Default chooses dimensions &gt;= data which optimize speed, accuracy of FFT. If FFT dimensions &gt; grdfile dimensions, data are extended and tapered to zero.</p>
  </dd>
  <dt>
    <p><strong>-S</strong></p>
  </dt>
  <dd>
    <p>Multiply each element by <em>scale</em> in the space domain (after the frequency domain operations). [Default is 1.0].</p>
  </dd>
  <dt>
    <p><strong>-T</strong></p>
  </dt>
  <dd>
    <p>Compute the isostatic compensation from the topography load (input grdfile) on an elastic plate of thickness <em>te</em>. Also append densities for load, mantle, water, and infill in SI units. If <em>te</em> == 0 then the Airy response is returned. <strong>-T</strong> implicitly sets <strong>-L</strong>.</p>
  </dd>
  <dt>
    <p><strong>-V</strong></p>
  </dt>
  <dd>
    <p>Selects verbose mode, which will send progress reports to stderr [Default runs "silently"].</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>To upward continue the sea-level magnetic anomalies in the file mag_0.grd to a level 800 m above sealevel, try</p><p>grdfft mag_0.grd <strong>-C</strong>800 <strong>-V</strong> <strong>-G</strong>mag_800.grd</p><p>To transform geoid heights in m (geoid.grd) on a geographical grid to free-air gravity anomalies in mGal, do</p><p>grdfft geoid.grd <strong>-Dg -M</strong> <strong>-V</strong> <strong>-G</strong>grav.grd</p><p>To transform gravity anomalies in mGal (faa.grd) to deflections of the vertical (in micro-radians) in the 038 direction, we must first integrate gravity to get geoid, then take the directional derivative, and finally scale radians to micro-radians:</p><p>grdfft faa.grd <strong>-Ig -A</strong>38 <strong>-S</strong>1e6 <strong>-V</strong> <strong>-G</strong>defl_38.grd</p><p>Second vertical derivatives of gravity anomalies are related to the curvature of the field. We can compute these as mGal/m^2 by differentiating twice:</p><p>grdfft gravity.grd <strong>-D</strong> <strong>-D</strong> <strong>-V</strong> <strong>-G</strong>grav_2nd_derivative.grd</p><p>The first order gravity anomaly (in mGal) due to the compensating surface caused by the topography load topo.grd (in m) on a 20 km thick elastic plate, assumed to be 4 km beneath the observation level can be computed as</p><p>grdfft topo.grd <strong>-T</strong>20000/2800/3330/1030/2300 <strong>-S</strong>0.022 <strong>-C</strong>4000 <strong>-G</strong>comp_faa.grd</p><p>where 0.022 is the scale needed for the first term in Parker's expansion for ' computing gravity from topography (= 2 * PI * G * (rhom - rhol)).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO grdfft&hellip;</h2>
        <div class="sectioncontent">
<p><em>gmt</em>(1gmt), <em>grdedit</em>(1gmt), <em>grdmath</em>(1gmt), <em>grdproject</em>(1gmt)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="gmt-manpages-grdedit.1gmt.html"><span aria-hidden="true">&larr;</span> grdedit.1gmt: Modifying the header in a 2-d grdfile</a></li>
   <li class="next"><a href="gmt-manpages-grdfft.1gmt.html">grdfft.1gmt: Perform mathematical operations on grdfiles in the frequency domain <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
