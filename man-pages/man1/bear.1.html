<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>bear: Build ear</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Build ear">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="bear (1) manual">
  <meta name="twitter:description" content="Build ear">
  <meta name="twitter:image" content="https://www.carta.tech/images/bear-bear-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/bear.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="bear (1) manual" />
  <meta property="og:description" content="Build ear" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/bear-bear-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">bear<small> (1)</small></h1>
        <p class="lead">Build ear</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/bear.1.html">
      <span itemprop="name">bear: Build ear</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/bear/">
      <span itemprop="name">bear</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/bear.1.html">
      <span itemprop="name">bear: Build ear</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>bear [<em>options</em>] -- [<em>build commands</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Bear is a tool to generate compilation database for clang tooling.</p><p>The JSON compilation database (http://clang.llvm.org/docs/JSONCompilationDatabase.html) is used in clang project to provide information how a single compilation unit was processed. When that is available then it is easy to re-run the compilation with different programs.</p><p>Bear execs the original build command and intercept the exec calls. To achive that Bear uses the LD_PRELOAD or DYLD_INSERT_LIBRARIES mechanisms provided by the dynamic linker. There is a library which defines the exec methods and used in every child processes of the build command. The executable itself sets the environment up to child processes and writes the output file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-c </strong><em>config</em></p>
  </dt>
  <dd>
    <p>Specify config file. Default value provided.</p>
  </dd>
  <dt>
    <p><strong>-o </strong><em>output</em></p>
  </dt>
  <dd>
    <p>Specify output file. Default value provided. (This option mainly for development purposes.)</p>
  </dd>
  <dt>
    <p><strong>-l </strong><em>library</em></p>
  </dt>
  <dd>
    <p>Specify the preloaded library location. Default value provided. (This option mainly for development purposes.)</p>
  </dd>
  <dt>
    <p><strong>-s </strong><em>socket</em></p>
  </dt>
  <dd>
    <p>Specify UNIX socket file. Default value provided. (This option mainly for development purposes.)</p>
  </dd>
  <dt>
    <p><strong>-n</strong></p>
  </dt>
  <dd>
    <p>Disable filter. The output is also a <em>JSON</em> formated file. But the result is not a compilation database. It contains all available information of the exec calls. (This option mainly for development purposes.)</p>
  </dd>
  <dt>
    <p><strong>-x</strong></p>
  </dt>
  <dd>
    <p>Verbose filter dump at the end. This option dump a short statistic about the filtering. Might give some insight when the output is not what it expected or when config file were changed.</p>
  </dd>
  <dt>
    <p><strong>-v</strong></p>
  </dt>
  <dd>
    <p>Print out Bear version and exit.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OUTPUT</h2>
        <div class="sectioncontent">
<p>There are two version of output formats. One is defined by the clang tooling. This goes like this:</p><ul>
<li>
<pre>
[
&nbsp;&nbsp;{&nbsp;"directory":&nbsp;"/home/user/llvm/build",
&nbsp;&nbsp;&nbsp;&nbsp;"command":&nbsp;"clang++&nbsp;-Irelative&nbsp;-c&nbsp;-o&nbsp;file.o&nbsp;file.cc",
&nbsp;&nbsp;&nbsp;&nbsp;"file":&nbsp;"file.cc"&nbsp;},
&nbsp;&nbsp;...
]

</pre>
</li>
</ul><p>To achive this bear has to run some filtering and formating. Build tools exec many commands during the build process. Bear has to find was that a compiler call, and what was the source file?</p><p>Filtering has three steps. It checks the executable name agains the known compiler names. It checks any of the arguments to match as source file. (Usually done by extension match.) And checks that there is no parameter which might considered as non compilation. (Like dependency file generation, which migth cause duplicates in the output.)</p><p>Filters are specified in the config file. The syntax of the file defined by libconfig (http://www.hyperrealm.com/libconfig/). The filter values are extended POSIX regular expressions (http://en.wikipedia.org/wiki/Regular_expression).</p><p>Since the post process might be buggy, there is a way to see all exec calls. This gives opportunity to write custom post processing. The format of the non filtered output looks like this:</p><ul>
<li>
<pre>
[
&nbsp;&nbsp;{&nbsp;"pid":&nbsp;"1234",
&nbsp;&nbsp;&nbsp;&nbsp;"ppid":&nbsp;"100",
&nbsp;&nbsp;&nbsp;&nbsp;"function":&nbsp;"execve",
&nbsp;&nbsp;&nbsp;&nbsp;"directory":&nbsp;"/home/user/llvm/build",
&nbsp;&nbsp;&nbsp;&nbsp;"command":&nbsp;"clang++&nbsp;-Irelative&nbsp;-c&nbsp;-o&nbsp;file.o&nbsp;file.cc"&nbsp;},
&nbsp;&nbsp;...
]

</pre>
</li>
</ul><p>Both output is JSON format, which means that <em>command</em> field is escaped if one of the argument had space, slash or quote character. All the other fields are as it was captured.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">
<p>Bear exit status is the exit status of the build command. Except when bear crashes, then it sets to non zero.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>BEAR_OUTPUT</strong></p>
  </dt>
  <dd>
    <p>The place of the socket file where client shall report exec calls. Value set by bear, overrides previous value for child processes.</p>
  </dd>
  <dt>
    <p><strong>LD_PRELOAD</strong></p>
  </dt>
  <dd>
    <p>Used by the dynamic loader on Linux, FreeBSD and other UNIX OS. Value set by bear, overrides previous value for child processes.</p>
  </dd>
  <dt>
    <p><strong>DYLD_INSERT_LIBRARIES</strong></p>
  </dt>
  <dd>
    <p>Used by the dynamic loader on OS X. Value set by bear, overrides previous value for child processes.</p>
  </dd>
  <dt>
    <p><strong>DYLD_FORCE_FLAT_NAMESPACE</strong></p>
  </dt>
  <dd>
    <p>Used by the dynamic loader on OS X. Value set by bear, overrides previous value for child processes.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>/etc/bear.conf</strong></p>
  </dt>
  <dd>
    <p>bear configuration file for post processing.</p>
  </dd>
  <dt>
    <p><strong>/usr/lib/i386-linux-gnu/bear/libear.so</strong></p>
  </dt>
  <dd>
    <p>bear library to implement exec calls.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO bear&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/ld.so.8.html"><strong>ld.so</strong>(8)</a>, <a href="../man3/exec.3.html"><strong>exec</strong>(3)</a>, <a href="../man8/ld.so.8.html"><strong>ld.so</strong>(8)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Compiler wrappers like ccache (http://ccache.samba.org/) and distcc (http://code.google.com/p/distcc/) could cause duplicates or missing items in the compilation database. Make sure you have been disabled before you run Bear.</p><p>In case of duplicate entries, you might consider to edit the config file to filter out wrapper calls (by path, or by file name) or filter out the compiler calls (and collect the wrapper calls only).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (C) 2012-2014 by László Nagy &lt;https://github.com/rizsotto/Bear&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>László Nagy.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="beanstalkd.1.html"><span aria-hidden="true">&larr;</span> beanstalkd.1: Simple, fast work queue</a></li>
   <li class="next"><a href="beav.1.html">beav.1: Binary file editor and viewer <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
