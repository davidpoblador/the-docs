<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>clamdtop: Monitor the clam antivirus daemon</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Monitor the clam antivirus daemon">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="clamdtop (1) manual">
  <meta name="twitter:description" content="Monitor the clam antivirus daemon">
  <meta name="twitter:image" content="https://www.carta.tech/images/clamav-daemon-clamdtop-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/clamdtop.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="clamdtop (1) manual" />
  <meta property="og:description" content="Monitor the clam antivirus daemon" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/clamav-daemon-clamdtop-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">clamdtop<small> (1)</small></h1>
        <p class="lead">Monitor the clam antivirus daemon</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/clamdtop.1.html">
      <span itemprop="name">clamdtop: Monitor the clam antivirus daemon</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/clamav-daemon/">
      <span itemprop="name">clamav-daemon</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/clamdtop.1.html">
      <span itemprop="name">clamdtop: Monitor the clam antivirus daemon</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>clamdtop [options] [clamdspec ...]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>clamdtop is a tool to monitor one or multiple clamd(s). It has a (color) ncurses interface, that shows the jobs in clamd's queue, memory usage, and information about the loaded signature database. You can specify on the command-line to which clamd(s) it should connect to. By default it will attempt to connect to the local clamd as defined in clamd.conf.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-h, --help</strong></p>
  </dt>
  <dd>
    <p>Display help information and exit.</p>
  </dd>
  <dt>
    <p><strong>-V, --version</strong></p>
  </dt>
  <dd>
    <p>Print version number and exit.</p>
  </dd>
  <dt>
    <p><strong>--config-file=FILE</strong></p>
  </dt>
  <dd>
    <p>Read clamd settings from FILE, to determine how to connect to it.</p>
  </dd>
  <dt>
    <p><strong>clamdspec</strong></p>
  </dt>
  <dd>
    <p>Specifies the clamd to connect to: either a path to the local (unix domain) socket of clamd, or an IP address and an port number (that defaults to 3310) to connect to a local or remote clamd using TCP/IP.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OVERVIEW</h2>
        <div class="sectioncontent">
<h3>KEYS:</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>H</strong></p>
  </dt>
  <dd>
    <p>Displays a short helpscreen, describing the meaning of various elements on the display.</p>
  </dd>
  <dt>
    <p><strong>Q</strong></p>
  </dt>
  <dd>
    <p>Quits clamdtop</p>
  </dd>
  <dt>
    <p><strong>R</strong></p>
  </dt>
  <dd>
    <p>Resets the maximum values.</p>
  </dd>
  <dt>
    <p><strong>up arrow, down arrow</strong></p>
  </dt>
  <dd>
    <p>If you are monitoring multiple clamds then clamdtop will show an overview screen by default. You can use the <strong>up arrow</strong> and <strong> down arrow</strong> keys to cycle through each clamd individually, and the overview screen. A blue bar will highlight the clamd that is currently shown in detail. On the overview screen none of the clamds is selected (hence no blue bar), and you can see the items from the queue of all clamds.</p>
  </dd>

</dl>

<h3>The top bar</h3>
<p>Shows the version of clamdtop and the current time. Clamdtop updates the display once every 2 seconds.</p>
<h3>The list of clamds</h3>
<p>Shows the clamds that clamdtop is connected to, and statistics about them.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>NO</strong></p>
  </dt>
  <dd>
    <p>Unique clamd number</p>
  </dd>
  <dt>
    <p><strong>CONNTIME</strong></p>
  </dt>
  <dd>
    <p>How long clamdtop has been connected (reset upon a reconnect)</p>
  </dd>
  <dt>
    <p><strong>LIV</strong></p>
  </dt>
  <dd>
    <p>Total number of live threads</p>
  </dd>
  <dt>
    <p><strong>IDL</strong></p>
  </dt>
  <dd>
    <p>Total number of idle threads</p>
  </dd>
  <dt>
    <p><strong>QUEUE</strong></p>
  </dt>
  <dd>
    <p>Number of items in queue</p>
  </dd>
  <dt>
    <p><strong>MAXQ</strong></p>
  </dt>
  <dd>
    <p>Maximum number of items observed in the queue</p>
  </dd>
  <dt>
    <p><strong>MEM</strong></p>
  </dt>
  <dd>
    <p>Total memory usage (if available)</p>
  </dd>
  <dt>
    <p><strong>HOST</strong></p>
  </dt>
  <dd>
    <p>Which clamd, local means unix socket</p>
  </dd>
  <dt>
    <p><strong>ENGINE</strong></p>
  </dt>
  <dd>
    <p>Engine version</p>
  </dd>
  <dt>
    <p><strong>DBVER</strong></p>
  </dt>
  <dd>
    <p>Database version</p>
  </dd>
  <dt>
    <p><strong>DBTIME</strong></p>
  </dt>
  <dd>
    <p>Database publish time</p>
  </dd>

</dl>

<h3>Clamd detailed view</h3>

<dl class='dl-vertical'>
  <dt>
    <p>Primary threads <strong>live</strong></p>
  </dt>
  <dd>
    <p>The number of threads that are executing commands or scanning.</p>
  </dd>
  <dt>
    <p>Primary threads <strong>idle</strong></p>
  </dt>
  <dd>
    <p>The number of threads that are idle, waiting for commands. They will exit after IdleTimeout (30 seconds).</p>
  </dd>
  <dt>
    <p>Primary threads <strong>max</strong></p>
  </dt>
  <dd>
    <p>The maximum number of threads configured.</p>
  </dd>
  <dt>
    <p>Queue <strong>items</strong></p>
  </dt>
  <dd>
    <p>The number of items (scanjobs) in clamd's queue that are waiting for a free thread to be processed.</p>
  </dd>
  <dt>
    <p>Queue <strong>max</strong></p>
  </dt>
  <dd>
    <p>The maximum number of items observed in clamd's queue.</p>
  </dd>

</dl>

<h3>The memory usage view</h3>
<p>If available, it will show details on clamd's memory usage:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>Mem heap</strong></p>
  </dt>
  <dd>
    <p>The amount of memory used by libc from the heap in MegaBytes.</p>
  </dd>
  <dt>
    <p><strong>Mem mmap</strong></p>
  </dt>
  <dd>
    <p>The amount of memory used by libc from mmap-allocated memory in MegaBytes.</p>
  </dd>
  <dt>
    <p><strong>Mem unused</strong></p>
  </dt>
  <dd>
    <p>The amount of memory that can be reclaimed by libc.</p>
  </dd>
  <dt>
    <p><strong>Libc used</strong></p>
  </dt>
  <dd>
    <p>The amount of useful memory allocated by libc.</p>
  </dd>
  <dt>
    <p><strong>Libc free</strong></p>
  </dt>
  <dd>
    <p>The amount of memory allocated by libc, that can't be freed due to fragmentation.</p>
  </dd>
  <dt>
    <p><strong>Libc total</strong></p>
  </dt>
  <dd>
    <p>The amount of memory allocated by libc from the system in total.</p>
  </dd>
  <dt>
    <p><strong>Pool count</strong></p>
  </dt>
  <dd>
    <p>The number of mmap regions allocated by clamd' memory pool allocator (for the signature database).</p>
  </dd>
  <dt>
    <p><strong>Pool used</strong></p>
  </dt>
  <dd>
    <p>The amount of memory used by clamd's memory pool allocator (for the signature database).</p>
  </dd>
  <dt>
    <p><strong>Total</strong></p>
  </dt>
  <dd>
    <p>The total amount of memory allocated by clamd's memory pool allocator.</p>
  </dd>

</dl>

<h3>The clamd job queue</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>COMMAND</strong></p>
  </dt>
  <dd>
    <p>Kind of command being executed, STATS is clamdtop, SCAN/CONTSCAN/FILDES/MULTISCAN is scan of a file/directory, MULTISCANFILE is scan of one item by a MULTISCAN job.</p>
  </dd>
  <dt>
    <p><strong>QUEUEDSINCE</strong></p>
  </dt>
  <dd>
    <p>The time since the command got queued, until now.</p>
  </dd>
  <dt>
    <p><strong>FILE</strong></p>
  </dt>
  <dd>
    <p>The name of the file being processed (if applicable).</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>(1) To connect to the clamd configured in the default clamd.conf:</p>
  </dt>
  <dd>
    <p><strong>clamdtop</strong></p>
  </dd>
  <dt>
    <p>(2) To connect to the clamd configured in another clamd.conf:</p>
  </dt>
  <dd>
    <p><strong>clamdtop --config-file=/path/to/clamd.conf</strong></p>
  </dd>
  <dt>
    <p>(3) To connect to a clamd running on another machine (192.168.0.3) on the LAN:</p>
  </dt>
  <dd>
    <p><strong>clamdtop 192.168.0.3</strong></p>
  </dd>
  <dt>
    <p>(4) To connect to a clamd running on another machine (192.168.0.3) on a non-default port (3410):</p>
  </dt>
  <dd>
    <p><strong>clamdtop 192.168.0.3:3410</strong></p>
  </dd>
  <dt>
    <p>(5) To monitor the local clamd and 2 other remote clamds over TCP/IP:</p>
  </dt>
  <dd>
    <p><strong>clamdtop localhost 192.168.0.3 192.168.0.4</strong></p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>clamdtop uses colors if the terminal is capable of colors. If you know your terminal is capable of colors, yet you aren't seeing any, then check that your <strong>TERM</strong> environment variable is set correctly. For example try setting it to TERM=xterm-color if you are in an xterm-like environment. IPv6 support has been added. If specifying an IPv6 address, please use the normal IPv6 addressing rules. If specifying both an IPv6 address and a port combination, encapsulate the IPv6 address in square brakets (e.g. [::1]:3410).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN CODES</h2>
        <div class="sectioncontent">
<p>0 : Normal terminator</p>
<dl class='dl-vertical'>
  <dt>
    <p>&gt;0: Error occured.</p>
  </dt>
  <dd>
    
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CREDITS</h2>
        <div class="sectioncontent">
<p>Please check the full documentation for credits.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Török Edvin &lt;edwin@clamav.net&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO clamdtop&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/clamd.8.html"><strong>clamd</strong>(8)</a>, <a href="../man5/clamd.conf.5.html"><strong>clamd.conf</strong>(5)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="clamdscan.1.html"><span aria-hidden="true">&larr;</span> clamdscan.1: Scan files and directories for viruses using clam antivirus daemon</a></li>
   <li class="next"><a href="clamfs.1.html">clamfs.1: An anti-virus protected file system <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
