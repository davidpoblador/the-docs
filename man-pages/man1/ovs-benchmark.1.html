<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ovs-benchmark: Flow setup benchmark utility for open vswitch</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Flow setup benchmark utility for open vswitch">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="ovs-benchmark (1) manual">
  <meta name="twitter:description" content="Flow setup benchmark utility for open vswitch">
  <meta name="twitter:image" content="https://www.carta.tech/images/openvswitch-common-ovs-benchmark-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/ovs-benchmark.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ovs-benchmark (1) manual" />
  <meta property="og:description" content="Flow setup benchmark utility for open vswitch" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/openvswitch-common-ovs-benchmark-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">ovs-benchmark<small> (1)</small></h1>
        <p class="lead">Flow setup benchmark utility for open vswitch</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/ovs-benchmark.1.html">
      <span itemprop="name">ovs-benchmark: Flow setup benchmark utility for open vswitch</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/openvswitch-common/">
      <span itemprop="name">openvswitch-common</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/ovs-benchmark.1.html">
      <span itemprop="name">ovs-benchmark: Flow setup benchmark utility for open vswitch</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>&#92;$1</strong> <strong>--remote </strong><em>ip</em>[<strong>:</strong><em>ports</em>] <strong>--remote </strong><em>ip</em>[<strong>:</strong><em>ports</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>ovs-benchmark</strong> tests the performance of Open vSwitch flow setup by setting up a number of TCP connections and measuring the time required.  It can also be used with the Linux bridge or without any bridging software, which allows one to measure the bandwidth and latency cost of bridging.</p><p>Each <strong>ovs-benchmark</strong> command is described separately below.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">The ``latency'' command</h2>
        <div class="sectioncontent">
<p>This command initiates <em>nsocks</em> TCP connections (by default, 100) as quickly as possible, waits for each one to complete with success or failure, and prints a bar chart of completion times on standard output, followed by a summary line.  Each line in the bar chart lists a time to connection completion in milliseconds followed by a number of <strong>.</strong> or <strong>!</strong> symbols, one for each TCP connection that completed in that many milliseconds.  A successful connection prints a <strong>.</strong>, and an unsuccessful connection (e.g. to a port on which no process is listening) prints a <strong>!</strong>.</p><p>If <em>nbatches</em> is given, the entire procedure is repeated the specified number of times.  Only a single summary line is printed at the end.</p><p>Results vary widely based on the number of sockets and whether the remote host is listening for connections on the specified ports.  With a small number of sockets, all connection times typically remain within a handful of milliseconds.  As the number of sockets increases, the distribution of connection times clusters around the sending TCP stack's SYN retransmission interval.  (This pattern occurs with or without Open vSwitch on the network path.)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">The ``rate'' command</h2>
        <div class="sectioncontent">
<p>This command initiates <em>nsocks</em> TCP connections (by default, 100) as quickly as possible (limited by <em>maxrate</em>, if <strong>--max-rate</strong> is specified).  Each time a connection completes with success or failure, it closes that connection and initiates a new one.  It continues to do so either forever or, if <strong>--timeout</strong> is specified, until <em>maxsecs</em> seconds have elapsed.  During the test, it prints statistics about time elapsed, successful and unsuccessful connections, and the average number of completed (succeeded or failed) connections per second over the run.</p><p>Without <strong>--max-rate</strong>, the <strong>rate</strong> command measures the maximum sustained flow setup rate for an Open vSwitch instance.  This naturally tends to drive <strong>ovs-vswitchd</strong> CPU usage to 100% on the host receiving the traffic.</p><p>When <strong>--max-rate</strong> is specified with a value below the maximum rate that an Open vSwitch instance can handle, then <strong>rate</strong> can also be used to measure the kernel and userspace CPU cost of flow setups at specific flow rates.</p><p>Results tend to fluctuate greatly for the first few seconds of a run, then settle down.  The displayed average is calculated over the entire run and so tends to converge asymptotically on the ``correct'' value. To converge more quickly, try running for 5 to 10 seconds, then killing and restarting the run.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">The ``listen'' command</h2>
        <div class="sectioncontent">
<p>This command listens on one or more TCP ports for incoming connections.  It accepts connections and immediately closes them.  It can be paired with the <strong>rate</strong> or <strong>latency</strong> commands for observing effects of successful vs. unsuccessful TCP connections.</p><p>It is easier to reproduce and interpret <strong>ovs-benchmark</strong> results when there is no listener (see <strong>NOTES</strong> below).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">The ``help'' command</h2>
        <div class="sectioncontent">
<p>Prints a usage message and exits successfully.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <strong>-r </strong><em>ip</em>[<strong>:</strong><em>ports</em>]
  </dt>
  <dd>
    
  </dd>
  <dt>
    &#92;$1
  </dt>
  <dd>
    <p>This option, required on <strong>latency</strong> and <strong>rate</strong> commands, minimally specifies the remote host to connect to (as an IP address or DNS name) as <em>ip</em>.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>A TCP port or range of ports (separated by <strong>-</strong>) may also be specified.  If a range is specified then each port in the range is used in round-robin order.  The default port is 6630 if none is specified.</p>
  </dd>
  <dt>
    <strong>-l </strong>[<em>ip</em>][<strong>:</strong><em>ports</em>]
  </dt>
  <dd>
    <p>On the <strong>latency</strong> and <strong>rate</strong>, without this option, outgoing connections will not bind a specific TCP port.  The local TCP stack will pick a local TCP port to bind.  When this option is specified, the specified port or range of ports will be used in turn.  (If a port range is specified on both <strong>--local</strong> and <strong>--remote</strong>, then each local port in its range will be used before the remote port is incremented to the next port in its range.)</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>On the <strong>listen</strong> command, this option specifies the local port or ports and IP addresses on which to listen.  If it is omitted, port 6630 on any IP address is used.</p>
  </dd>
  <dt>
    <strong>-s </strong><em>nsocks</em>
  </dt>
  <dd>
    <p>For <strong>latency</strong>, sets the number of connections to initiate per batch.  For <strong>rate</strong>, sets the number of outstanding connections attempts to maintain at any given time.  The default is 100.</p>
  </dd>
  <dt>
    <strong>-b </strong><em>nbatches</em>
  </dt>
  <dd>
    <p>For <strong>latency</strong>, sets the number of times to initiate and wait for all of the connections to complete.  The default is 1.</p>
  </dd>
  <dt>
    <strong>-c </strong><em>maxrate</em>
  </dt>
  <dd>
    <p>For <strong>rate</strong>, caps the maximum rate at which connections will be attempted to <em>maxrate</em> connections per second.  By default there is no limit.</p>
  </dd>
  <dt>
    <strong>-T </strong><em>maxsecs</em>
  </dt>
  <dd>
    <p>For <strong>rate</strong>, stops the benchmark after <em>maxsecs</em> seconds have elapsed.  By default, the benchmark continues until interrupted by a signal.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p><strong>ovs-benchmark</strong> uses standard POSIX socket calls for network access, so it shares the strengths and limitations of TCP/IP and its implementations in the local and remote TCP/IP stacks.  Particularly, TCP and its implementations limit the number of successfully completed and then closed TCP connections.  This means that <strong>ovs-benchmark</strong> tests tend to slow down if run for long intervals or with large numbers of sockets or batches, if the remote system is listening on the port or ports being contacted.  The problem does not occur when the remote system is not listening.  <strong>ovs-benchmark</strong> results are therefore much more reliable and repeatable when the remote system is not listening on the port or ports being contacted.  Even a single listening socket (e.g. range of ports 8000 to 9000 with one listener on port 8080) can cause anomalies in results.</p><p>Be sure that the remote TCP/IP stack's firewall allows the benchmark's traffic to be processed.  For Open vSwitch benchmarking purposes, you might want to disable the firewall with, e.g., <strong>iptables -F</strong>.</p><p><strong>ovs-benchmark</strong> is single-threaded.  A multithreaded process might be able to initiate connections more quickly.</p><p>A TCP connection consists of two flows (one in each direction), so multiply the TCP connection statistics that <strong>ovs-benchmark</strong> reports by 2 to get flow statistics.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="ovito.1.html"><span aria-hidden="true">&larr;</span> ovito.1: (the open visualization tool) is a scientific visualization and analysis software for atomistic simulation data.</a></li>
   <li class="next"><a href="ovs-l3ping.1.html">ovs-l3ping.1: Check network deployment for l3 tunneling problems <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
