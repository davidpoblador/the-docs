<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>hatari_profile: Post-processor for hatari profiler data</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Post-processor for hatari profiler data">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="hatari_profile (1) manual">
  <meta name="twitter:description" content="Post-processor for hatari profiler data">
  <meta name="twitter:image" content="https://www.carta.tech/images/hatari-hatari_profile-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/hatari_profile.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="hatari_profile (1) manual" />
  <meta property="og:description" content="Post-processor for hatari profiler data" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/hatari-hatari_profile-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">hatari_profile<small> (1)</small></h1>
        <p class="lead">Post-processor for hatari profiler data</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/hatari_profile.1.html">
      <span itemprop="name">hatari_profile: Post-processor for hatari profiler data</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/hatari/">
      <span itemprop="name">hatari</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/hatari_profile.1.html">
      <span itemprop="name">hatari_profile: Post-processor for hatari profiler data</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>hatari_profile.py</strong> <em>[options]</em> <em>&lt;datafiles&gt;</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>A Python script to post-process data produced by Hatari profiler "save" commands, both for CPU and DSP:</p>
<pre>
	profile save &lt;filename&gt;
	dspprofile save &lt;filename&gt;
</pre>
<p>It can provide function level (CPU and DSP) processor usage information for anything Hatari profiler records: instruction counts, processor cycles and depending on processor, also instruction cache misses or cycle differences.</p><p>This information can be provided as ASCII list of heaviest functions, as callgraphs (if profile data includes caller information), or as callgrind format export which can be viewed in (Linux) Kcachegrind GUI.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>Invoking <em>hatari_profile</em> without arguments lists all of its options.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE EXAMPLES</h2>
        <div class="sectioncontent">
<p>Regardless of whether profile data contains some symbol information, you should always give script all relevant debug symbols, otherwise costs might not get correctly assigned to symbols preceding those costs.</p><p>This post-processes profile data for EmuTOS (ROM), with symbol file having fixed/absolute addresses (-a), shows statistics (-s) and top lists (-t), but limits list output to anything taking over 2% (-l 2) and includes "propagated" subroutine call costs (-p):</p>
<pre>
-------------------------------------------------------------
$ hatari_profile.py -a etos512k.sym -st -l 2 -p etos-boot.txt

Hatari profile data processor

Parsing absolute symbol address information from etos512k.sym...
1538 lines with 1236 code symbols/addresses parsed, 0 unknown.

Parsing profile information from etos-boot.txt...
16993 lines processed with 465 functions.

CPU profile information from 'etos-boot.txt':
- Hatari v1.6.2+ (Apr 15 2013), OldUAE CPU core

Time spent in profile = 4.60740s.

Calls:
- max = 1800, in ___mulsi3 at 0xe60790, on line 16477
- 16659 in total
Executed instructions:
- max = 315254, in _timeout_gpip+38 at 0xe06fd8, on line 3237
- 3074165 in total
Used cycles:
- max = 6311628, in _timeout_gpip+38 at 0xe06fd8, on line 3237
- 36957124 in total

Calls:
 10.80%   10.88%      1800  ___mulsi3
  8.04%    8.16%      1339  _memcpy
  5.20%    0.26%       866  _int_timerc
  4.61%                768  _call_user_wheel
  3.86%    3.86%       643  _min
  3.76%    3.82%       627  _sti
  3.76%    3.76%       627  _cli
  3.30%    3.30%       550  _bcostat4

Executed instructions:
 61.58%   61.79%   1892940  _timeout_gpip
  8.62%    9.33%    264918  _draw_rect
  4.96%    4.98%    152582  _run_calibration
  4.06%    4.09%    124944  _blank_out
  3.22%              99134  meminit

Used cycles:
 61.58%   62.01%  22759756  _timeout_gpip
  5.69%    6.85%   2104464  _draw_rect
  4.29%            1586108  meminit
  4.19%    4.22%   1547768  _run_calibration
  3.04%    3.07%   1122816  _blank_out
  2.88%    2.98%   1065272  _stop_until_interrupt
-------------------------------------------------------------
</pre>
<p>This creates GraphViz callgraph files (-g) and Kcachegrind callgrind data file (-k) from Bad Mood (Doom BSP viewer) profile.  Symbols for the program are TEXT section relative (-r), calls to some interrupt routines in the program are ignored as they aren't real calls, callgraph nodes using over 2% are highlighted, and there are some options to limit and simplify the graph:</p>
<pre>
-------------------------------------------------------------
$ hatari_profile.py -r bmsym.sym &#92;
  -k -g -p --emph-limit 2.0 --limit 0.5 &#92;
  --ignore-to framecounter,new_vbi,stabilizer_b &#92;
  --compact --no-leafs --no-intermediate &#92;
  badmood-profile.txt

Hatari profile data processor

Parsing TEXT relative symbol address information from bmsym.sym...
1023 lines with 392 code symbols/addresses parsed, 0 unknown.

Parsing profile information from badmood-profile.txt...
1420 lines processed with 63 functions.
Ignoring 29 switches to framecounter
Ignoring 9 switches to stabilizer_b
Ignoring 8 switches to new_vbi
Of all 1562 switches, ignored 56 for type(s) ['r', 'u', 'x'].

Generating callgrind file 'badmood-profile.cg'...

Generating 'badmood-profile-0.dot' DOT callgraph file...

Generating 'badmood-profile-1.dot' DOT callgraph file...

Generating 'badmood-profile-2.dot' DOT callgraph file...

Generating 'badmood-profile-3.dot' DOT callgraph file...

CPU profile information from 'badmood-profile.txt':
- Hatari v1.6.2+ (Apr 10 2013), WinUAE CPU core
-------------------------------------------------------------
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO hatari_profile&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/hatari.1.html"><strong>hatari</strong>(1)</a>, <a href="../man1/gst2ascii.1.html"><strong>gst2ascii</strong>(1)</a>, <a href="../man1/hconsole.1.html"><strong>hconsole</strong>(1)</a> <a href="../man1/hatariui.1.html"><strong>hatariui</strong>(1)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Written by Eero Tamminen &lt;oak at helsinkinet fi&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE</h2>
        <div class="sectioncontent">
<p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NO WARRANTY</h2>
        <div class="sectioncontent">
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="hatari-winuae.1.html"><span aria-hidden="true">&larr;</span> hatari-winuae.1: Atari st/ste/tt/falcon emulator</a></li>
   <li class="next"><a href="hatariui.1.html">hatariui.1: Python/gtk ui for hatari <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
