<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>msktutil: Fetches and manages kerberos keytabs in an active directory environment</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Fetches and manages kerberos keytabs in an active directory environment">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="msktutil (1) manual">
  <meta name="twitter:description" content="Fetches and manages kerberos keytabs in an active directory environment">
  <meta name="twitter:image" content="https://www.carta.tech/images/msktutil-msktutil-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/msktutil.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="msktutil (1) manual" />
  <meta property="og:description" content="Fetches and manages kerberos keytabs in an active directory environment" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/msktutil-msktutil-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">msktutil<small> (1)</small></h1>
        <p class="lead">Fetches and manages kerberos keytabs in an active directory environment</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/msktutil.1.html">
      <span itemprop="name">msktutil: Fetches and manages kerberos keytabs in an active directory environment</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/msktutil/">
      <span itemprop="name">msktutil</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/msktutil.1.html">
      <span itemprop="name">msktutil: Fetches and manages kerberos keytabs in an active directory environment</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>msktutil</strong> [command 1] [command 2] [command 3] ...</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>msktutil is a Unix/Linux keytab client for Microsoft Active Directory environments.  This program is capable of creating accounts in Active Directory, adding service principals to those accounts, and creating local keytab files so that kerberizied services can utilize Active directory as a Kerberos realm. msktutil will create and manage machine accounts by default.  The --use-service-account option lets msktutil operate on service accounts.  msktutil requires that the Kerberos client libraries are properly installed and configured to use Active Directory as a realm.</p><p>Whenever a principal is added or a keytab is updated, the secret password for the corresponding account is changed.  By default, the password is not stored, so it needs to be reset each time msktutil is executed.  All entries in the keytab will be automatically updated whenever the password is reset.  The previous entries will be left in the keytab, so sessions using the older key versions will not break.  This behavior is similar to the way Windows hosts handle machine password changes.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CREDENTIALS</h2>
        <div class="sectioncontent">
<p>There are two common methods of using this program.  The first is to "kinit" with Administrator-like credentials which have permission to create computer objects in your Active Directory server.  If you invoke the program with such credentials, you can create a new computer account or service account from scratch.</p><p>The second is to pre-create the accounts with such credentials, and then invoke msktutil on a machine without any special permissions.  When the computer account or service account exists already, msktutil will attempt to authenticate as that account using either the existing keytab, or if that fails, a default password.  When that default password is not specified with the option --old-account-password, msktutil will use the default machine password.  It will then change the password and update the keytab appropriately.  This is usually the more convenient option when joining many computers to the domain.</p><p>To pre-create a computer account, you may use the Active Directory Users and Computers GUI, select "new computer" from the right click menu, and type the short DNS name, then right click on the newly created object and select "Reset account" to set the password to the default value.  Another alternative is to invoke msktutil with the --precreate argument.  Both methods accomplish the same thing.</p><p>To pre-create a service account, you may use the Active Directory Users and Computers GUI, select "new user" from the right click menu, fill in all required data, set the password to a specific value and use setspn.exe to set the desired servicePrincipalName(s).  You may also select "must change password at next logon".</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PASSWORD EXPIRY</h2>
        <div class="sectioncontent">
<p>Be aware that Windows machines will, by default, automatically change their account password every 30 days, and thus many domains have a 90-day password expiry window, after which your keytab will stop working.  There are two ways to deal with this:</p><p>a) (Preferred): Make sure you're running a daily cron job to run msktutil --auto-update, which will change the password automatically 30 days after it was last changed and update the keytab.</p><p>b) (Not preferred): disable password expiry for the account via the --dont-expire-password option (or otherwise setting DONT_EXPIRE_PASSWORD flag in userAccountControl in AD).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PASSWORD POLICY ISSUES</h2>
        <div class="sectioncontent">
<p>This section only applies to msktutil --use-service-account.</p><p>While machine account passwords may be changed at any time, service accounts are user accounts and your Active Directory domain may have special password policies for those user accounts.  E.g., "minimum password age" is typically set to 1 day, which means that you will have to wait for that time to pass until you may invoke msktutil --update --use-service-account.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OTHER NOTES</h2>
        <div class="sectioncontent">
<p>Unlike other kerberos implementations, Active Directory has only a single key for all of the principals associated with an account.  So, if you create a HTTP/hostname service principal, it will share the same key as the host/hostname principal.  If you want to isolate (security-wise) different service principals, you may want to create a dedicated service account for them (with --use-service-account) and a separate keytab file (with --keytab).</p><p>Also note: kinit -k 'host/computername' *will not work*, by default, even when that is a valid service principal existing in your keytab.  Active Directory does not allow you to authenticate as a service principal, so do not use that as a test of whether the service principal is working.  If you actually want to authenticate as the computer account user, kinit -k 'computername$' instead.</p><p>If you really need to be able to authenticate as 'host/computername', you can also use the --upn argument to set the userPrincipalName attribute (generally requires administrator credentials, not computer account credentials).  Both 'computername$' and the value of userPrincipalName are treated as valid account names to kinit as.</p><p>msktutil will use kerberized LDAP operations to talk to domain controllers.  To obtain a LDAP service ticket, the DNS service will be used to construct the domain controllers LDAP principal name.  If DNS is mis-configured, this construction may fail.  To work around this issue,  you may specify the fully qualified DNS name of your domain controller with the --server option and additionally use the --no-reverse-lookups option.</p><p>Samba (www.samba.org) provides the net command that can be used to manage kerberos keytabs as well.  Using msktutil and commands like "net ads join" or "net ads keytab" together can lead to trouble.  With the --set-samba-secret option, msktutil can be used as a replacement for net.</p><p>Active Directory includes authorization data (e.g. information about group memberships) in Kerberos tickets. This information is called PAC and may lead to very large ticket sizes.  Especially HTTP services are known to produce failures if that size exceeds the HTTP header size.  If your service does not make use of that PAC information (which is true for most Unix/Linux-services) you may just disable it with the --no-pac option.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MODES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>-v, --version</p>
  </dt>
  <dd>
    <p>Displays version information</p>
  </dd>
  <dt>
    <p>--help</p>
  </dt>
  <dd>
    <p>Displays a help message</p>
  </dd>
  <dt>
    <p>-c, --create</p>
  </dt>
  <dd>
    <p>Creates a keytab for the current host or a given service account.  Equivalent to --update --service host.</p>
  </dd>
  <dt>
    <p>-f, --flush</p>
  </dt>
  <dd>
    <p>Flushes out all principals for the current accountname from the keytab, and makes corresponding changes to the machine or service account.</p>
  </dd>
  <dt>
    <p>-u, --update</p>
  </dt>
  <dd>
    <p>Forces a password change and updates all related service principal entries from the servicePrincipalName and userPrincipalName attributes.  Updates dNSDomainName for machine accounts and always updates msDS-supportedEncryptionTypes attributes with current values, and applies other changes as specified.</p>
  </dd>
  <dt>
    <p>--auto-update</p>
  </dt>
  <dd>
    <p>Checks if the password is at least 30 days old (from pwdLastSet attribute), and that the account does not have password expiry disabled.  If those conditions are met, acts just like --update.  Will also update if the keytab failed to authenticate but the default password did work (e.g. after resetting the account in AD).  Otherwise, exits without doing anything (even if attribute modifying options are given).  This option is intended for use from a daily crontab to ensure that the password is rotated regularly.</p>
  </dd>
  <dt>
    <p>--precreate</p>
  </dt>
  <dd>
    <p>Pre-create (or update) an account for the given host with default password.  Does not use or update local keytab.  Requires -h or --computer-name argument.  Implies --user-creds-only.  Generally requires administrator credentials.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONNECTION/SETUP OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>-b, --base &lt;base&gt;</p>
  </dt>
  <dd>
    <p>Specifies a relative LDAP base when creating a new account.  For example, specifying '-b OU=Unix' for a computer named SERVER in an Active Directory domain example.com would create a computer account in the LDAP path: CN=SERVER,OU=Unix,DC=EXAMPLE,DC=COM.  This option can also be specified by setting the MSKTUTIL_LDAP_BASE environment variable to the desired value.</p><p>If not specified, the default value is read from AD (and the default there, unless modified by an admin, is CN=Computers for machine accounts and CN=Users for service accounts).</p>
  </dd>
  <dt>
    <p>--computer-name &lt;name&gt;</p>
  </dt>
  <dd>
    <p>Specifies that the new account should use &lt;name&gt; for the computer account name and the SAM Account Name.  Note that a '$' will be automatically appended to the SAM Account Name.  Defaults to the machine's hostname, excluding the realm, with dots replaced with dashes.</p><p>That is: if the realm is EXAMPLE.COM, and the hostname is FOO.EXAMPLE.COM, the default computer name is FOO.  If the hostname is FOO.BAR.EXAMPLE.COM, the default computer name is FOO-BAR.</p>
  </dd>
  <dt>
    <p>--account-name &lt;name&gt;</p>
  </dt>
  <dd>
    <p>An alias for --computer-name that can be used when operating on service accounts.  Note that a '$' will not be automatically appended to the SAM Account Name when using service accounts.</p>
  </dd>
  <dt>
    <p>--old-account-password &lt;password&gt;</p>
  </dt>
  <dd>
    <p>Use supplied account password for authentication.  This is useful if the keytab does not yet exist but the password of the computer account is known.  This password will be changed by msktutil in order to create or update the keytab</p>
  </dd>
  <dt>
    <p>-h, --hostname &lt;name&gt;</p>
  </dt>
  <dd>
    <p>Overrides the current hostname to be used to be &lt;name&gt;.  If this is not specified, the local host name will be used.  Note that the local name lookup service will be to qualify and resolve names into fully-qualified names, including a domain extension.  This affects the default hostname for other arguments, and the default computer-name.  The hostname is also used to set the dNSDomainName attribute.</p>
  </dd>
  <dt>
    <p>-k, --keytab &lt;file&gt;</p>
  </dt>
  <dd>
    <p>Specifies to use &lt;file&gt; for the keytab.  This option can also be specified by setting the MSKTUTIL_KEYTAB environment variable to the name of the desired keytab file.  This keytab is both read from, in order to authenticate as the given account, and written to, after updating the account password.  Default: /etc/krb5.keytab --keytab-auth-as &lt;name&gt; Specifies which principal name we should try to use, when we authenticate from a keytab. Normally, msktutil will try to use the account name or the host principal for the current host. If this option is specified, instead msktutil will try to use the given principal name first, and only fall back to the default behavior if we fail to authenticate with the given name. This option can be useful if you do not know the current password for the relevant account, do not have a keytab with the account principal, but you do have a keytab with a service principal associated with that account.</p>
  </dd>
  <dt>
    <p>--server &lt;server&gt;</p>
  </dt>
  <dd>
    <p>Specifies to use &lt;server&gt; as the domain controller.  This affects both kerberos and ldap operations. The server can also be specified by setting the MSKTUTIL_SERVER environment variable.  Default: looked up in DNS from the realm name.</p>
  </dd>
  <dt>
    <p>--server-behind-nat</p>
  </dt>
  <dd>
    <p>When the server is behind a firewall that performs Network Address Translation, KRB-PRIV messages fail validation.  This is because the IP adddress in the encrypted part of the message cannot be rewritten in the NAT process.  This option ignores the resulting error for the password change process, allowing systems outside the NAT firewall to join the domain managed by servers inside the NAT firewall.</p>
  </dd>
  <dt>
    <p>--realm &lt;realm&gt;</p>
  </dt>
  <dd>
    <p>Specifies to use &lt;realm&gt; as kerberos realm.  Default: use the default_realm from [libdefaults] section of krb5.conf.</p>
  </dd>
  <dt>
    <p>--site &lt;site&gt;</p>
  </dt>
  <dd>
    <p>Find and use domain controller in specific AD site. This option is ignored if option --server is used.</p>
  </dd>
  <dt>
    <p>-N, --no-reverse-lookup</p>
  </dt>
  <dd>
    <p>Do not attempt to canonicalize the name of the domain controller via DNS reverse lookups.  You may need to do this if your client cannot resolve the PTR records for a domain controller or your DNS servers store incorrect PTR records.  Default: Use DNS reverse lookups to canonicalize DC names.</p>
  </dd>
  <dt>
    <p>--user-creds-only</p>
  </dt>
  <dd>
    <p>Don't attempt to authenticate with a keytab: only use user's credentials (from e.g. kinit).  You may need to do this to modify certain attributes that require Administrator credentials (description, userAccountControl, userPrincipalName, in a default AD setup).</p>
  </dd>
  <dt>
    <p>--verbose</p>
  </dt>
  <dd>
    <p>Enables verbose status messages.  May be specified more then once to get LDAP debugging.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OBJECT TYPE/ATTRIBUTE-SETTING OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>--use-service-account</p>
  </dt>
  <dd>
    <p>Create and maintain service accounts instead of machine accounts.</p>
  </dd>
  <dt>
    <p>--delegation</p>
  </dt>
  <dd>
    <p>Enables the account to be trusted for delegation.  This option can also be enabled by setting the MSKTUTIL_DELEGATION environment variable.  This modifies the userAccountControl attribute.  Generally requires administrator credentials.</p>
  </dd>
  <dt>
    <p>--description &lt;text&gt;</p>
  </dt>
  <dd>
    <p>Sets the account's description attribute to the given text (or removes if text is '').  Generally requires administrator credentials.</p>
  </dd>
  <dt>
    <p>--disable-delegation</p>
  </dt>
  <dd>
    <p>Disables the account from being trusted for delegation.  This modifies the userAccountControl attribute.  Generally requires administrator credentials.</p>
  </dd>
  <dt>
    <p>--disable-no-pac</p>
  </dt>
  <dd>
    <p>Unsets the flag that disables the KDC's including of a PAC in the machine's service tickets.  This modifies the userAccountControl attribute.  Generally requires administrator credentials.</p>
  </dd>
  <dt>
    <p>--dont-expire-password</p>
  </dt>
  <dd>
    <p>Sets the DONT_EXPIRE_PASSSWORD bit in the userAccountControl attribute, which disables password expiry for this account.  If you don't run a cron job to periodically rotate the keytab, you will want to set this flag.  Generally requires administrator credentials.</p>
  </dd>
  <dt>
    <p>--do-expire-password</p>
  </dt>
  <dd>
    <p>Unsets the DONT_EXPIRE_PASSWORD flag in the userAccountControl attribute.  Generally requires administrator credentials.</p>
  </dd>
  <dt>
    <p>--enctypes &lt;integer&gt;</p>
  </dt>
  <dd>
    <p>Sets the supported encryption types in the msDs-supportedEncryptionTypes field.</p><p>You may OR together the following values:</p>
<pre>
  0x1=des-cbc-crc
  0x2=des-cbc-md5
  0x4=rc4-hmac-md5
  0x8=aes128-cts-hmac-sha1
  0x10=aes256-cts-hmac-sha1
</pre>
<p>This value is used to determine which encryption types AD will offer to use, and which encryption types to put in the keytab.</p><p>If the value is set to 0x3 (that is: only the two DES types), it also attempts to set the DES-only flag in userAccountControl.</p><p>Note: Windows 2008R2 refuses to use DES by default; you thus cannot use DES-only keys unless you have enabled DES encryption for your domain first.  Recent versions of MIT kerberos clients similarly refuse to use DES by default.</p><p>Default: sets the value to 0x1C: that is, use anything but DES.</p>
  </dd>
  <dt>
    <p>--allow-weak-crypto</p>
  </dt>
  <dd>
    <p>Enables the usage of DES keys for authentication. This is equivalent to MIT's krb5.conf parameter allow_weak_crypto.</p>
  </dd>
  <dt>
    <p>--no-pac</p>
  </dt>
  <dd>
    <p>Specifies that service tickets for this account should not contain a PAC.  This modifies the userAccountControl attribute.  See Microsoft Knowledge Base article #832575 for details.  This option can also be specified by setting the MSKTUTIL_NO_PAC environment variable.  Generally requires administrator credentials.</p>
  </dd>
  <dt>
    <p>-s, --service &lt;principal&gt;</p>
  </dt>
  <dd>
    <p>Specifies a service principal to add to the account (and thus keytab, if appropriate).  The service is of the form &lt;service&gt;/&lt;hostname&gt;.  If the hostname is omitted, assumes current hostname.  May be specified multiple times.</p>
  </dd>
  <dt>
    <p>--remove-service &lt;principal&gt;</p>
  </dt>
  <dd>
    <p>Specifies a service principal to remove from the account (and keytab if appropriate).</p>
  </dd>
  <dt>
    <p>--upn &lt;principal&gt;</p>
  </dt>
  <dd>
    <p>Sets the userPrincipalName on the computer account or service account to be &lt;principal&gt;.  Note that the realm will automatically be appended to the value given.  The userPrincipalName is an additional name which can be used to kinit.  This is generally unnecessary, since you can always authenticate as the name given by --accountname (i.e. computername$ for computer accounts) whether or not userPrincipalName is set.  Generally requires administrator credentials.</p>
  </dd>
  <dt>
    <p>--set-samba-secret</p>
  </dt>
  <dd>
    <p>Use Samba's net changesecretpw command to locally set the machine account password in Samba's secrets.tdb. $PATH need to include Samba's net command.  Samba needs to be configured appropriately.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>For unprivileged users the most common invocations are:</p>
<pre>
msktutil --update --service host --service HTTP
</pre>
<p>This will update a computer account in Active Directory with a new password, write out a new keytab, and ensure that it has both "host" and "HTTP" service principals are on it for the hostname.</p>
<pre>
msktutil --auto-update
</pre>
<p>This is useful in a daily cron job to check and rotate the password automatically when it's 30 days old.</p><p>For users with admin privileges in AD, some common uses:</p>
<pre>
msktutil --create --service host --service HTTP
</pre>
<p>This will create a computer account in Active Directory with a new password, write out a new keytab, and ensure that it has both "host" and "HTTP" service principals are on it for the hostname.</p>
<pre>
msktutil --precreate --host computer1.example.com
</pre>
<p>This will pre-create an account for computer1 with the default password using your credentials.  This can be done on a central host, e.g. to script the addition of many hosts.  You can then use msktutil --create on the hosts themselves (without special credentials) to join them to the domain.</p>
<pre>
msktutil --host afs --service afs --enctypes 0x03
</pre>
<p>This will create an afs/cell.name@REALM principal, and associate that principal with a computer account called 'afs'.  The principal will be marked as DES-only, which is required for AFS.</p>
<pre>
msktutil --create --use-service-account --service HTTP/hostname.example.com --keytab /etc/apache/krb5.keytab --accountname srv-http --no-pac
</pre>
<p>This will create an HTTP/hostname.example.com@REALM principal, and associate that principal with a service account called 'srv-http'.  Corresponding Kerberos keys will be written to the keytab file /etc/apache/krb5.keytab. The size of Kerberos tickets for that service will stay small because no PAC information will be included.</p>
<pre>
msktutil --create --service host/hostname --service host/hostname.example.com --set-samba-secret --enctypes 0x4
</pre>
<p>This will create a computer account in Active Directory that is compatible with Samba.  The command creates a new password, write out a new keytab, and ensure that it includes both "host/hostname" and "host/hostname.example.com" as service principals (which is equivalent to what setspn.exe -R would do on windows).  The new computer password will be stored in Samba's secrets.tdb database to provide interoperability with Samba. As Samba (version 3) only supports arcfour-encrypted Kerberos tickets the --enctypes option must be used to select only that encryption type.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p> (C) 2004-2006 Dan Perry &lt;dperry@pppl.gov&gt;  (C) 2006 Brian Elliott Finley (finley@anl.gov)  (C) 2009-2010 Doug Engert (deengert@anl.gov)  (C) 2010 James Knight &lt;foom@fuhm.net&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="mshowfat.1.html"><span aria-hidden="true">&larr;</span> mshowfat.1: None</a></li>
   <li class="next"><a href="msmtp.1.html">msmtp.1: An smtp client <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
