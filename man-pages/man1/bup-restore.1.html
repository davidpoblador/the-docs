<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>bup-restore: Extract files from a backup set</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Extract files from a backup set">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="bup-restore (1) manual">
  <meta name="twitter:description" content="Extract files from a backup set">
  <meta name="twitter:image" content="https://www.carta.tech/images/bup-doc-bup-restore-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/bup-restore.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="bup-restore (1) manual" />
  <meta property="og:description" content="Extract files from a backup set" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/bup-doc-bup-restore-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">bup-restore<small> (1)</small></h1>
        <p class="lead">Extract files from a backup set</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/bup-restore.1.html">
      <span itemprop="name">bup-restore: Extract files from a backup set</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/bup-doc/">
      <span itemprop="name">bup-doc</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/bup-restore.1.html">
      <span itemprop="name">bup-restore: Extract files from a backup set</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>bup restore [--outdir=<em>outdir</em>][&#92;--exclude-rx *pattern*] [-v][-q] &lt;paths...&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>bup&nbsp;restore extracts files from a backup set (created with <a href="../man1/bup-save.1.html"><strong>bup-save</strong>(1)</a>) to the local filesystem.</p><p>The specified <em>paths</em> are of the form /<em>branch</em>/<em>revision</em>/<em>some/where</em>. The components of the path are as follows:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>branch</strong></p>
  </dt>
  <dd>
    <p>the name of the backup set to restore from; this corresponds to the --name (-n) option to bup&nbsp;save.</p>
  </dd>
  <dt>
    <p><strong>revision</strong></p>
  </dt>
  <dd>
    <p>the revision of the backup set to restore. The revision <em>latest</em> is always the most recent backup on the given branch. You can discover other revisions using bup&nbsp;ls&nbsp;/branch.</p>
  </dd>
  <dt>
    <p><strong>some/where</strong></p>
  </dt>
  <dd>
    <p>the previously saved path (after any stripping/grafting) that you want to restore. For example, etc/passwd.</p>
  </dd>

</dl>
<p>If <em>some/where</em> names a directory, bup&nbsp;restore will restore that directory and then recursively restore its contents.</p><p>If <em>some/where</em> names a directory and ends with a slash (ie. path/to/dir/), bup&nbsp;restore will restore the children of that directory directly to the current directory (or the --outdir). If <em>some/where</em> does not end in a slash, the children will be restored to a subdirectory of the current directory.</p><p>If <em>some/where</em> names a directory and ends in \[aq]/.\[aq] (ie. path/to/dir/.), bup&nbsp;restore will do exactly what it would have done for path/to/dir, and then restore <em>dir</em>\[aq]s metadata to the current directory (or the --outdir). See the EXAMPLES section.</p><p>Whenever path metadata is available, bup&nbsp;restore will attempt to restore it. When restoring ownership, bup implements tar/rsync-like semantics. It will normally prefer user and group names to uids and gids when they\[aq]re available, but it will not try to restore the user unless running as root, and it will fall back to the numeric uid or gid whenever the metadata contains a user or group name that doesn\[aq]t exist on the current system. The use of user and group names can be disabled via --numeric-ids (which can be important when restoring a chroot, for example), and as a special case, a uid or gid of 0 will never be remapped by name. Additionally, some systems don\[aq]t allow setting a uid/gid that doesn\[aq]t correspond with a known user/group. On those systems, bup will log an error for each relevant path.</p><p>The --map-user, --map-group, --map-uid, --map-gid options may be used to adjust the available ownership information before any of the rules above are applied, but note that due to those rules, --map-uid and --map-gid will have no effect whenever a path has a valid user or group. In those cases, either --numeric-ids must be specified, or the user or group must be cleared by a suitable --map-user&nbsp;foo= or --map-group&nbsp;foo=.</p><p>Hardlinks will also be restored when possible, but at least currently, no links will be made to targets outside the restore tree, and if the restore tree spans a different arrangement of filesystems from the save tree, some hardlink sets may not be completely restored.</p><p>Also note that changing hardlink sets on disk between index and save may produce unexpected results. With the current implementation, bup will attempt to recreate any given hardlink set as it existed at index time, even if all of the files in the set weren\[aq]t still hardlinked (but were otherwise identical) at save time.</p><p>Note that during the restoration process, access to data within the restore tree may be more permissive than it was in the original source. Unless security is irrelevant, you must restore to a private subdirectory, and then move the resulting tree to its final position. See the EXAMPLES section for a demonstration.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-C, --outdir=</strong><em>outdir</em></p>
  </dt>
  <dd>
    <p>create and change to directory <em>outdir</em> before extracting the files.</p>
  </dd>
  <dt>
    <p><strong>--numeric-ids</strong></p>
  </dt>
  <dd>
    <p>restore numeric IDs (user, group, etc.) rather than names.</p>
  </dd>
  <dt>
    <p><strong>--exclude-rx=</strong><em>pattern</em></p>
  </dt>
  <dd>
    <p>exclude any path matching <em>pattern</em>, which must be a Python regular expression (http://docs.python.org/library/re.html). The pattern will be compared against the full path rooted at the top of the restore tree, without anchoring, so "x/y" will match "ox/yard" or "box/yards". To exclude the contents of /tmp, but not the directory itself, use "^/tmp/.". (can be specified more than once)</p><p>Note that the root of the restore tree (which matches \[aq]^/\[aq]) is the top of the archive tree being restored, and has nothing to do with the filesystem destination. Given "restore ... /foo/latest/etc/", the pattern \[aq]^/passwd$\[aq] would match if a file named passwd had been saved as \[aq]/foo/latest/etc/passwd\[aq].</p><p>Examples:</p>
<dl class='dl-vertical'>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>\[aq]/foo$\[aq] - exclude any file named foo</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>\[aq]/foo/$\[aq] - exclude any directory named foo</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>\[aq]/foo/.\[aq] - exclude the content of any directory named foo</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>\[aq]^/tmp/.\[aq] - exclude root-level /tmp\[aq]s content, but not /tmp itself</p>
  </dd>

</dl>

  </dd>
  <dt>
    <p><strong>--map-user </strong><em>old</em>=<em>new</em></p>
  </dt>
  <dd>
    <p>for every path, restore the <em>old</em> (saved) user name as <em>new</em>. Specifying "" for <em>new</em> will clear the user. For example "--map-user foo=" will allow the uid to take effect for any path that originally had a user of "foo", unless countermanded by a subsequent "--map-user foo=..." specification. See DESCRIPTION above for further information.</p>
  </dd>
  <dt>
    <p><strong>--map-group </strong><em>old</em>=<em>new</em></p>
  </dt>
  <dd>
    <p>for every path, restore the <em>old</em> (saved) group name as <em>new</em>. Specifying "" for <em>new</em> will clear the group. For example "--map-group foo=" will allow the gid to take effect for any path that originally had a group of "foo", unless countermanded by a subsequent "--map-group foo=..." specification. See DESCRIPTION above for further information.</p>
  </dd>
  <dt>
    <p><strong>--map-uid </strong><em>old</em>=<em>new</em></p>
  </dt>
  <dd>
    <p>for every path, restore the <em>old</em> (saved) uid as <em>new</em>, unless countermanded by a subsequent "--map-uid <em>old</em>=..." option. Note that the uid will only be relevant for paths with no user. See DESCRIPTION above for further information.</p>
  </dd>
  <dt>
    <p><strong>--map-gid </strong><em>old</em>=<em>new</em></p>
  </dt>
  <dd>
    <p>for every path, restore the <em>old</em> (saved) gid as <em>new</em>, unless countermanded by a subsequent "--map-gid <em>old</em>=..." option. Note that the gid will only be relevant for paths with no user. See DESCRIPTION above for further information.</p>
  </dd>
  <dt>
    <p><strong>-v, --verbose</strong></p>
  </dt>
  <dd>
    <p>increase log output. Given once, prints every directory as it is restored; given twice, prints every file and directory.</p>
  </dd>
  <dt>
    <p><strong>-q, --quiet</strong></p>
  </dt>
  <dd>
    <p>don\[aq]t show the progress meter. Normally, is stderr is a tty, a progress display is printed that shows the total number of files restored.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>Create a simple test backup set:</p><ul>
<li>
<pre>
$&nbsp;bup&nbsp;index&nbsp;-u&nbsp;/etc
$&nbsp;bup&nbsp;save&nbsp;-n&nbsp;mybackup&nbsp;/etc/passwd&nbsp;/etc/profile

</pre>
</li>
</ul><p>Restore just one file:</p><ul>
<li>
<pre>
$&nbsp;bup&nbsp;restore&nbsp;/mybackup/latest/etc/passwd
Restoring:&nbsp;1,&nbsp;done.

$&nbsp;ls&nbsp;-l&nbsp;passwd
-rw-r--r--&nbsp;1&nbsp;apenwarr&nbsp;apenwarr&nbsp;1478&nbsp;2010-09-08&nbsp;03:06&nbsp;passwd

</pre>
</li>
</ul><p>Restore etc to test (no trailing slash):</p><ul>
<li>
<pre>
$&nbsp;bup&nbsp;restore&nbsp;-C&nbsp;test&nbsp;/mybackup/latest/etc
Restoring:&nbsp;3,&nbsp;done.

$&nbsp;find&nbsp;test
test
test/etc
test/etc/passwd
test/etc/profile

</pre>
</li>
</ul><p>Restore the contents of etc to test (trailing slash):</p><ul>
<li>
<pre>
$&nbsp;bup&nbsp;restore&nbsp;-C&nbsp;test&nbsp;/mybackup/latest/etc/
Restoring:&nbsp;2,&nbsp;done.

$&nbsp;find&nbsp;test
test
test/passwd
test/profile

</pre>
</li>
</ul><p>Restore the contents of etc and etc\[aq]s metadata to test (trailing "/."):</p><ul>
<li>
<pre>
$&nbsp;bup&nbsp;restore&nbsp;-C&nbsp;test&nbsp;/mybackup/latest/etc/.
Restoring:&nbsp;2,&nbsp;done.

#&nbsp;At&nbsp;this&nbsp;point&nbsp;test&nbsp;and&nbsp;etc\[aq]s&nbsp;metadata&nbsp;will&nbsp;match.
$&nbsp;find&nbsp;test
test
test/passwd
test/profile

</pre>
</li>
</ul><p>Restore a tree without risk of unauthorized access:</p><ul>
<li>
<pre>
#&nbsp;mkdir&nbsp;--mode&nbsp;0700&nbsp;restore-tmp

#&nbsp;bup&nbsp;restore&nbsp;-C&nbsp;restore-tmp&nbsp;/somebackup/latest/foo
Restoring:&nbsp;42,&nbsp;done.

#&nbsp;mv&nbsp;restore-tmp/foo&nbsp;somewhere

#&nbsp;rmdir&nbsp;restore-tmp

</pre>
</li>
</ul><p>Restore a tree, remapping an old user and group to a new user and group:</p><ul>
<li>
<pre>
#&nbsp;ls&nbsp;-l&nbsp;/original/y
-rw-r-----&nbsp;1&nbsp;foo&nbsp;baz&nbsp;&nbsp;3610&nbsp;Nov&nbsp;&nbsp;4&nbsp;11:31&nbsp;y
#&nbsp;bup&nbsp;restore&nbsp;-C&nbsp;dest&nbsp;--map-user&nbsp;foo=bar&nbsp;--map-group&nbsp;baz=bax&nbsp;/x/latest/y
Restoring:&nbsp;42,&nbsp;done.
#&nbsp;ls&nbsp;-l&nbsp;dest/y
-rw-r-----&nbsp;1&nbsp;bar&nbsp;bax&nbsp;&nbsp;3610&nbsp;Nov&nbsp;&nbsp;4&nbsp;11:31&nbsp;y

</pre>
</li>
</ul><p>Restore a tree, remapping an old uid to a new uid. Note that the old user must be erased so that bup won\[aq]t prefer it over the uid:</p><ul>
<li>
<pre>
#&nbsp;ls&nbsp;-l&nbsp;/original/y
-rw-r-----&nbsp;1&nbsp;foo&nbsp;baz&nbsp;&nbsp;3610&nbsp;Nov&nbsp;&nbsp;4&nbsp;11:31&nbsp;y
#&nbsp;ls&nbsp;-ln&nbsp;/original/y
-rw-r-----&nbsp;1&nbsp;1000&nbsp;1007&nbsp;&nbsp;3610&nbsp;Nov&nbsp;&nbsp;4&nbsp;11:31&nbsp;y
#&nbsp;bup&nbsp;restore&nbsp;-C&nbsp;dest&nbsp;--map-user&nbsp;foo=&nbsp;--map-uid&nbsp;1000=1042&nbsp;/x/latest/y
Restoring:&nbsp;97,&nbsp;done.
#&nbsp;ls&nbsp;-ln&nbsp;dest/y
-rw-r-----&nbsp;1&nbsp;1042&nbsp;1007&nbsp;&nbsp;3610&nbsp;Nov&nbsp;&nbsp;4&nbsp;11:31&nbsp;y

</pre>
</li>
</ul><p>An alternate way to do the same by quashing users/groups universally with --numeric-ids:</p><ul>
<li>
<pre>
#&nbsp;bup&nbsp;restore&nbsp;-C&nbsp;dest&nbsp;--numeric-ids&nbsp;--map-uid&nbsp;1000=1042&nbsp;/x/latest/y
Restoring:&nbsp;97,&nbsp;done.

</pre>
</li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO bup-restore&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/bup-save.1.html"><strong>bup-save</strong>(1)</a>, <a href="../man1/bup-ftp.1.html"><strong>bup-ftp</strong>(1)</a>, <a href="../man1/bup-fuse.1.html"><strong>bup-fuse</strong>(1)</a>, <a href="../man1/bup-web.1.html"><strong>bup-web</strong>(1)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUP</h2>
        <div class="sectioncontent">
<p>Part of the <a href="../man1/bup.1.html"><strong>bup</strong>(1)</a> suite.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Avery Pennarun &lt;apenwarr@gmail.com&gt;.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="bup-random.1.html"><span aria-hidden="true">&larr;</span> bup-random.1: Generate a stream of random output</a></li>
   <li class="next"><a href="bup-save.1.html">bup-save.1: Create a new bup backup set <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
