<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>oathtool: Oath one-time password tool</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Oath one-time password tool">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="oathtool (1) manual">
  <meta name="twitter:description" content="Oath one-time password tool">
  <meta name="twitter:image" content="https://www.carta.tech/images/oathtool-oathtool-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/oathtool.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="oathtool (1) manual" />
  <meta property="og:description" content="Oath one-time password tool" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/oathtool-oathtool-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">oathtool<small> (1)</small></h1>
        <p class="lead">Oath one-time password tool</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/oathtool.1.html">
      <span itemprop="name">oathtool: Oath one-time password tool</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/oathtool/">
      <span itemprop="name">oathtool</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/oathtool.1.html">
      <span itemprop="name">oathtool: Oath one-time password tool</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>oathtool</strong> [<em>OPTIONS</em>]... [<em>KEY </em>[<em>OTP</em>]]...</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>oathtool 2.4.1</p><p>Generate and validate OATH one-time passwords.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-h</strong>, <strong>--help</strong></p>
  </dt>
  <dd>
    <p>Print help and exit</p>
  </dd>
  <dt>
    <p><strong>-V</strong>, <strong>--version</strong></p>
  </dt>
  <dd>
    <p>Print version and exit</p>
  </dd>
  <dt>
    <p><strong>--hotp</strong></p>
  </dt>
  <dd>
    <p>use event-based HOTP mode  (default=on)</p>
  </dd>
  <dt>
    <p><strong>--totp</strong></p>
  </dt>
  <dd>
    <p>use time-variant TOTP mode  (default=off)</p>
  </dd>
  <dt>
    <p><strong>-b</strong>, <strong>--base32</strong></p>
  </dt>
  <dd>
    <p>use base32 encoding of KEY instead of hex (default=off)</p>
  </dd>
  <dt>
    <p><strong>-c</strong>, <strong>--counter</strong>=<em>COUNTER</em></p>
  </dt>
  <dd>
    <p>HOTP counter value</p>
  </dd>
  <dt>
    <p><strong>-s</strong>, <strong>--time-step-size</strong>=<em>DURATION</em> TOTP time-step duration</p>
  </dt>
  <dd>
    <p>(default=`30s')</p>
  </dd>
  <dt>
    <p><strong>-S</strong>, <strong>--start-time</strong>=<em>TIME</em></p>
  </dt>
  <dd>
    <p>when to start counting time steps for TOTP (default=`1970-01-01 00:00:00 UTC')</p>
  </dd>
  <dt>
    <p><strong>-N</strong>, <strong>--now</strong>=<em>TIME</em></p>
  </dt>
  <dd>
    <p>use this time as current time for TOTP (default=`now')</p>
  </dd>
  <dt>
    <p><strong>-d</strong>, <strong>--digits</strong>=<em>DIGITS</em></p>
  </dt>
  <dd>
    <p>number of digits in one-time password</p>
  </dd>
  <dt>
    <p><strong>-w</strong>, <strong>--window</strong>=<em>WIDTH</em></p>
  </dt>
  <dd>
    <p>window of counter values to test when validating OTPs</p>
  </dd>
  <dt>
    <p><strong>-v</strong>, <strong>--verbose</strong></p>
  </dt>
  <dd>
    <p>explain what is being done  (default=off)</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>To generate the first event-based (HOTP) one-time password for an all-zero key:</p>
<pre>
   $ oathtool 00
   328482
   $
</pre>
<p>Sometime you want to generate more than a single OTP.  To generate 10 additional event-based one-time passwords, with the secret key used in the examples of RFC 4226, use the -w (--window) parameter:</p>
<pre>
   $ oathtool -w 10 3132333435363738393031323334353637383930
   755224
   287082
   359152
   969429
   338314
   254676
   287922
   162583
   399871
   520489
   403154
   $
</pre>
<p>In the last output, the counter for the first OTP was 0, the second OTP had a counter of 1, and so on up to 10.</p><p>In order to use keys encoded in Base32 instead of hex, you may provide the -b (--base32) parameter:</p>
<pre>
   $ oathtool --base32 -w 3 GEZDGNBVGY3TQOJQGEZDGNBVGY3TQOJQ
   755224
   287082
   359152
   969429
   $
</pre>
<p>The tool ignore whitespace in base32 data and re-add padding if necessary, thus you may supply keys formatted like the one below.</p>
<pre>
   $ oathtool --base32 --totp "gr6d 5br7 25s6 vnck v4vl hlao re"
   977872
   $
</pre>
<p>To generate a particular OTP, use the -c (--counter) parameter to give the exact position directly:</p>
<pre>
   $ oathtool -c 5 3132333435363738393031323334353637383930
   254676
   $
</pre>
<p>To validate a HOTP one-time password supply the OTP last on the command line:</p>
<pre>
   $ oathtool -w 10 3132333435363738393031323334353637383930 969429
   3
   $
</pre>
<p>The output indicates the counter that was used.  It works by starting with counter 0 and increment until it founds a match (or not), within the supplied window of 10 OTPs.</p><p>The tool supports time-variant one-time passwords, in so called TOTP mode.  Usage is similar, but --totp needs to be provided:</p>
<pre>
   $ oathtool --totp 00
   943388
   $
</pre>
<p>Don't be alarmed if you do not get the same output, this is because the output is time variant.  To generate a TOTP for a particular fixed time use the -N (--now) parameter:</p>
<pre>
   $ oathtool --totp --now "2008-04-23 17:42:17 UTC" 00
   974945
   $
</pre>
<p>The format is a mostly free format human readable date string such as "Sun, 29 Feb 2004 16:21:42 -0800" or "2004-02-29 16:21:42" or even "next Thursday".  It is the same used as the --date parameter of the <a href="../man1/date.1.html"><strong>date</strong>(1)</a> tool.</p><p>You may generate several TOTPs by specifying the --window parameter, similar to how it works for HOTP.  The OTPs generated here will be for the initial time (normally current time) and then each following time step (e.g., 30 second window).</p>
<pre>
   $ oathtool --totp 00 -w5
   815120
   003818
   814756
   184042
   582326
   733842
   $
</pre>
<p>You can validate a TOTP one-time password by supplying the secret and a window parameter (number of time steps before or after current time):</p>
<pre>
   $ oathtool --totp -w 5 00 `oathtool --totp 00`
   0
   $
</pre>
<p>Similar when generating TOTPs, you can use a -N (--now) parameter to specify the time to use instead of the current time:</p>
<pre>
  $ oathtool --totp --now="2005-03-18 01:58:29 UTC" -w 10000000 3132333435363738393031323334353637383930 89005924
  4115227
  $
</pre>
<p>The previous test uses values from the TOTP specification and will stress test the tool because the expected window is around 4 million time-steps.</p><p>There are two system parameters for TOTP: the time-step size and the time start.</p><p>By default the time-step size is 30 seconds, which means you get a new OTP every 30 seconds.  You may modify this with the -s (--time-step-size) parameter:</p>
<pre>
   $ oathtool --totp --time-step-size=45s 00
   109841
   $
</pre>
<p>The values are valid ISO-8601 durations, see: http://en.wikipedia.org/wiki/ISO_8601#Durations</p><p>The time start is normally 1970-01-01 00:00:00 UTC but you may change it using the -S (--start-time):</p>
<pre>
   $ oathtool --totp --start-time "1980-01-01 00:00:00 UTC" 00
   273884
   $
</pre>
<p>To get more information about what the tool is using use the -v (--verbose) parameter.  Finally, to generate the last TOTP (for SHA-1) in the test vector table of draft-mraihi-totp-timebased-07 you can invoke the tool like this:</p>
<pre>
   $ oathtool --totp -v -N "2033-05-18 03:33:20 UTC" -d8 3132333435363738393031323334353637383930
   Hex secret: 3132333435363738393031323334353637383930
   Base32 secret: GEZDGNBVGY3TQOJQGEZDGNBVGY3TQOJQ
   Digits: 8
   Window size: 0
   Step size (seconds): 30
   Start time: 1970-01-01 00:00:00 UTC (0)
   Time now: 2033-05-18 03:33:20 UTC (2000000000)
   Counter: 0x3F940AA (66666666)
</pre>

<pre>
   69279037
   $
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Written by Simon Josefsson.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">
<p>Report bugs to: oath-toolkit-help@nongnu.org oathtool home page: &lt;http://www.nongnu.org/oath-toolkit/&gt;</p><p>General help using GNU software: &lt;http://www.gnu.org/gethelp/&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2013 Simon Josefsson. License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;.</p><p>This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="oasis.1.html"><span aria-hidden="true">&larr;</span> oasis.1: Generates a complete build system for ocaml libraries and applications.</a></li>
   <li class="next"><a href="oauth.1.html">oauth.1: Oauth command-line client <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
