<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ibdm-ibnl-file: A generic ib netlist format</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A generic ib netlist format">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="ibdm-ibnl-file (1) manual">
  <meta name="twitter:description" content="A generic ib netlist format">
  <meta name="twitter:image" content="https://www.carta.tech/images/ibutils-ibdm-ibnl-file-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/ibdm-ibnl-file.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ibdm-ibnl-file (1) manual" />
  <meta property="og:description" content="A generic ib netlist format" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/ibutils-ibdm-ibnl-file-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">ibdm-ibnl-file<small> (1)</small></h1>
        <p class="lead">A generic ib netlist format</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/ibdm-ibnl-file.1.html">
      <span itemprop="name">ibdm-ibnl-file: A generic ib netlist format</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/ibutils/">
      <span itemprop="name">ibutils</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/ibdm-ibnl-file.1.html">
      <span itemprop="name">ibdm-ibnl-file: A generic ib netlist format</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>\s-1IBDM\s0 topology file <strong>ibdm-topo-file</strong> provide means to describe the \s-1IB\s0 fabric using a set of predefined systems. A system definition is provided in a single file in \s-1IBNL\s0 format that describes the internal InfiniBand connectivity of the system in terms of boards and devices. When \s-1IBDM\s0 starts it parses all the available system definition files before it handles the topology file. The files are located in the following directory relative to the installation prefix: &lt;prefix&gt;/lib/ibdm1.0/ibnl.</p><p>This man page describes the \s-1IBNL\s0 file format used to define an arbitrary \s-1IB\s0 system internal \s-1IB\s0 connectivity. It outlines the main concepts used by the file, provides details for how to write such a file and provides a formal definition of the file syntax in \s-1BNF\s0 like format (YACC/Bison readable).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">1. Main Concepts</h2>
        <div class="sectioncontent">
<p>The described file format for defining generic system \s-1IB\s0 connectivity uses the following terminology:</p>
<dl class='dl-vertical'>
  <dt>
    \s-1NODE\s0
  </dt>
  <dd>
    <p>The instantiation of an \s-1IB\s0 device may it be a switch or a channel adapter</p>
  </dd>
  <dt>
    SUB-SYSTEM
  </dt>
  <dd>
    <p>The instantiation of a board or module in a system</p>
  </dd>
  <dt>
    \s-1SYSTEM\s0
  </dt>
  <dd>
    <p>A definition of a board or a module</p>
  </dd>
  <dt>
    \s-1TOPSYSTEM\s0
  </dt>
  <dd>
    <p>The top most system defined in the given file</p>
  </dd>
  <dt>
    SUB-SYSTEM \s-1MODIFIER\s0
  </dt>
  <dd>
    <p>Many systems allow multiple variations of their subsystem such as a 12X version of a leaf board in a \s-1MTS9600\s0. The modifier is a suffix to the board name. The \s-1IBNL\s0 format supports assigning multiple names to the same board.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">2. File Format</h2>
        <div class="sectioncontent">
<p>The exact file format is provided in section 4. This section only provides extra information regarding the specific semantics of various sections.</p><p>The \s-1IBNL\s0 file is line sensitive as it requires different sections to start on a new line. The file is broken into several \s-1SYSTEM\s0 (optional) and one \s-1TOPSYSTEM\s0 sections. Each has one or more names.</p><p>Connections are defined inside the \s-1SYSTEM/TOPSYSTEM\s0 section only and thus might be of two types:</p>
<dl class='dl-vertical'>
  <dt>
    1. Between any node or sub-system to other node or sub-system
  </dt>
  <dd>
    
  </dd>
  <dt>
    2. From any node or sub-system to a connector of the system.
  </dt>
  <dd>
    
  </dd>

</dl>
<p>\s-1NOTE-1:\s0 The top system can define ports that might be redundant and not connected to any lower level board connector. In these cases the ports are simply omitted from the resulting system. This feature enables defining the front panel ports of a 12X/4X such that if a 12X leaf is selected only the 12X front panel ports are used.</p><p>\s-1NOTE-2:\s0  Port width and speed provided at the lowest level have precedence over definitions provided at upper levels of the hierarchy.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">3. Guidelines for writing a System IBNL File</h2>
        <div class="sectioncontent">
<p>The following procedure should be followed in order to provide a new system \s-1IBNL:\s0</p>
<dl class='dl-vertical'>
  <dt>
    a)
  </dt>
  <dd>
    <p>Name the file after the system name: &lt;any sys name (no spaces)&gt;.ibnl</p>
  </dd>
  <dt>
    b)
  </dt>
  <dd>
    <p>Define a \s-1SYSTEM\s0 section for each board included in the system</p>
  </dd>
  <dt>
    c)
  </dt>
  <dd>
    <p>The port names of the boards are just strings, we use the simple format of Pn where N is just a serial number but you can pick any name you want. Just make sure it is unique.</p>
  </dd>
  <dt>
    d)
  </dt>
  <dd>
    <p>When different flavors of the boards exists like when you have a 4x and 12x option for a board name the optional boards with a modifier postfix. An example for such system that supports a \s-1LEAF\s0 board of 12x and 4x types would be to define two \s-1SYSTEMS:\s0</p><p>\s-1SYSTEM\s0 \s-1LEAF\s0,LEAF:4x,LEAF:4X ... \s-1SYSTEM\s0 LEAF:12x,LEAF:12X ... \s-1NOTE-3:\s0 The instantiations of the \s-1LEAF\s0 boards in another board or the top system need not specify the postfix and are being decided upon only when the topology file is being parsed. The \*(L"\s-1SYSTEM\s0 \s-1LEAF\s0\*(R" with no postfix will be used by default. To continue the example here is how the LEAFs are instantiated in the top system:</p><p>\s-1TOPSYSTEM\s0 MyIbSystem \s-1LEAF\s0 leaf1 ... \s-1LEAF\s0 leaf2 ...</p><p>The actual 4x or 12x version of the \s-1LEAF\s0 board can then be specified in the topology file \s-1CFG\s0 section to select the right combination of optional boards in the system. An example will be:</p><p>MyIbSystem N001 \s-1CFG:\s0 leaf2=12x In this case leaf1 will be 4x as no special modifier is defined for it (and \s-1LEAF\s0 is by default a 4x leaf). Leaf2 will be 12x as defined in the \s-1CFG\s0 section.</p>
<dl class='dl-vertical'>
  <dt>
    e)
  </dt>
  <dd>
    <p>Special considerations should be made to design the top system section when several optional board types exist. Top system section might include multiple definitions for front panel plugs like P1-4x and P1-12x (yes these are just names that should follow the writing on the front or back panels). As the different flavors of the boards are not required to define the same names for their ports including a 12x port might leave some of the top level connections dangling (not connected) and thus the front panel ports of the other flavor will be removed from the final system definition. As an example let us consider a simple board \s-1LEAF\s0 with 3 4x port flavor and one 12x port flavors. We recommend connecting it in the top level using the following scheme:</p><p>\s-1SYSTEM\s0 LEAF:4x \s-1NODE\s0 U1 1 -4x-&gt; 4XP1 2 -4x-&gt; 4XP2 3 -4x-&gt; 4XP3 ... \s-1SYSTEM\s0 LEAF:12x \s-1NODE\s0 U1 1 -12x-&gt; 12XP1 ... \s-1TOPSYSTEM\s0 myIbSystem \s-1SUBSYSTEM\s0 \s-1LEAF\s0 leaf1 4XP1 -&gt; L1/P1 4XP2 -&gt; L1/P2 4XP3 -&gt; L1/P3 12XP1 -&gt; L1/P1-12x</p>
<dl class='dl-vertical'>
  <dt>
    f)
  </dt>
  <dd>
    <p>Place the file in the &lt;prefix&gt;/lib/IBDM/ibdm1.0/ibnl directory</p>
  </dd>
  <dt>
    g)
  </dt>
  <dd>
    <p>Check the new file syntax by placing it in the ibnl directory as described above, creating a simple topology (<strong>ibdm-topo-file</strong> file with one such system and running <strong>ibdmtr</strong> utility to parse it tracing a simple path through it.</p>
  </dd>

</dl>

  </dd>

</dl>

  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">4. Formal definition in YACC Syntax:</h2>
        <div class="sectioncontent">
<p>\s-1INT\s0 ::= ([1-9][0-9]*|0) ; \s-1WIDTH\s0 ::= (4x|8x|12x) ; \s-1SPEED\s0 ::= (2.5G|5G|10G) ; \s-1NODETYPE\s0 ::= (SW|CA|HCA) ; \s-1NAME\s0 ::= ([&#92;[&#92;]&#92;&#92;&#92;*/A-Za-z0-9_.:%@~]+) ; \s-1NL:\s0 \s-1LINE\s0 | \s-1NL\s0 \s-1LINE\s0; \s-1ONL:\s0 | \s-1NL\s0; ibnl: \s-1ONL\s0 systems topsystem; systems: | systems system ; sub_inst_attributes: | sub_inst_attributes sub_inst_attribute \s-1NL\s0; sub_inst_attribute: \s-1NAME\s0 '=' \s-1NAME\s0 '=' \s-1NAME\s0 | \s-1NAME\s0 '=' \s-1NAME\s0 '=' \s-1INT\s0 | \s-1NAME\s0 '=' \s-1NAME\s0 ; topsystem: \s-1TOPSYSTEM\s0 system_names \s-1NL\s0 sub_inst_attributes insts ; system: \s-1SYSTEM\s0 system_names \s-1NL\s0 insts ; system_names: system_name | system_names ',' system_name ; system_name: \s-1NAME\s0 ; insts: | insts node | insts subsystem ; node: node_header \s-1NL\s0 node_connections ; node_header: \s-1NODE\s0 \s-1NODETYPE\s0 \s-1INT\s0 \s-1NAME\s0 \s-1NAME\s0 ; node_connections: | node_connections node_connection \s-1NL\s0 ; node_connection: node_to_node_link | node_to_port_link ; node_to_node_link: \s-1INT\s0 '-' \s-1WIDTH\s0 '-' \s-1SPEED\s0 '-' '&gt;' \s-1NAME\s0 | \s-1INT\s0 '-' \s-1WIDTH\s0 '-' '&gt;' \s-1NAME\s0 \s-1INT\s0 | \s-1INT\s0 '-' \s-1SPEED\s0 '-' '&gt;' \s-1NAME\s0 \s-1INT\s0 | \s-1INT\s0 '-' '&gt;' \s-1NAME\s0 \s-1INT\s0 ; node_to_port_link: \s-1INT\s0 '-' \s-1WIDTH\s0 '-' \s-1SPEED\s0 '-' '&gt;' \s-1NAME\s0 | \s-1INT\s0 '-' \s-1WIDTH\s0 '-' '&gt;' \s-1NAME\s0 | \s-1INT\s0 '-' \s-1SPEED\s0 '-' '&gt;' \s-1NAME\s0 | \s-1INT\s0 '-' '&gt;' \s-1NAME\s0 ; subsystem: subsystem_header \s-1NL\s0 subsystem_connections ; subsystem_header: \s-1SUBSYSTEM\s0 \s-1NAME\s0 \s-1NAME\s0 ; subsystem_connections: | subsystem_connections subsystem_connection \s-1NL\s0 ; subsystem_connection: subsystem_to_subsystem_link | subsystem_to_port_link ; subsystem_to_subsystem_link: \s-1NAME\s0 '-' \s-1WIDTH\s0 '-' \s-1SPEED\s0 '-' '&gt;' \s-1NAME\s0 \s-1NAME\s0 | \s-1NAME\s0 '-' \s-1WIDTH\s0 '-' '&gt;' \s-1NAME\s0 \s-1NAME\s0 | \s-1NAME\s0 '-' \s-1SPEED\s0 '-' '&gt;' \s-1NAME\s0 \s-1NAME\s0 | \s-1NAME\s0 '-' '&gt;' \s-1NAME\s0 \s-1NAME\s0 ; subsystem_to_port_link: \s-1NAME\s0 '-' \s-1WIDTH\s0 '-' \s-1SPEED\s0 '-' '&gt;' \s-1NAME\s0 | \s-1NAME\s0 '-' \s-1WIDTH\s0 '-' '&gt;' \s-1NAME\s0 | \s-1NAME\s0 '-' \s-1SPEED\s0 '-' '&gt;' \s-1NAME\s0 | \s-1NAME\s0 '-' '&gt;' \s-1NAME\s0 ;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Eitan Zahavi, Mellanox Technologies \s-1LTD\s0, eitan@mellanox.co.il</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="ibam.1.html"><span aria-hidden="true">&larr;</span> ibam.1: The intelligent battery monitor</a></li>
   <li class="next"><a href="ibdm-topo-file.1.html">ibdm-topo-file.1: Ibdm topology file  the topology file describes the ib connectivity and systems included in the network. it serves two purposes:  the topology file is composed "system" sections. each such section describes the connectivity of one system to other systems in the network. the first line of each section is a declaration of the system composed of a system-type, its system-name section, and optional configuration details. the lines to follow until the next empty line describe the connections between this system ports to the other systems. the following is a formal definition of a system section syntax.  an example is listed afterwards.  system-type system-name [cfg: b1=modifier, [b2=modifier]...] <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
