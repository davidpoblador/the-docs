<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>fakeroot-ng: Run a command while making it believe it is running as root</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Run a command while making it believe it is running as root">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="fakeroot-ng (1) manual">
  <meta name="twitter:description" content="Run a command while making it believe it is running as root">
  <meta name="twitter:image" content="https://www.carta.tech/images/fakeroot-ng-fakeroot-ng-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/fakeroot-ng.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="fakeroot-ng (1) manual" />
  <meta property="og:description" content="Run a command while making it believe it is running as root" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/fakeroot-ng-fakeroot-ng-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">fakeroot-ng<small> (1)</small></h1>
        <p class="lead">Run a command while making it believe it is running as root</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/fakeroot-ng.1.html">
      <span itemprop="name">fakeroot-ng: Run a command while making it believe it is running as root</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/fakeroot-ng/">
      <span itemprop="name">fakeroot-ng</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/fakeroot-ng.1.html">
      <span itemprop="name">fakeroot-ng: Run a command while making it believe it is running as root</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>fakeroot-ng</strong> [ <strong>-l</strong><em>logfile</em><strong> [</strong><strong>-f</strong><strong>] ] [ </strong><strong>-p</strong><em>persist_file</em><strong> ] [-d] </strong><em>command line</em><strong></strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This manual page documents the <strong>fakeroot-ng</strong> command.</p><p>Fakeroot-ng allows running a process without any change to the permissions, but fooling the process into thinking that it is running with root permissions. This typically involves intercepting certain system calls the process performs and manipulating their results. In order for the effect to be complete enough, previous manipulations have to be remembered, and consistent results returned.</p><p>The idea behind fakroot-ng was first implemented by a tool called <strong>fakeroot</strong>(1). This tool used LD_PRELOAD of the dynamic linking to glibc in order to intercept the system calls. While this approach is very rebust and very platform independent, it does suffer in scope. In particular, certain operations (mostly the <a href="../man2/open.2.html"><strong>open</strong>(2)</a> system call) could not be intercepted, which caused emulating other operations (mainly the <a href="../man2/chroot.2.html"><strong>chroot</strong>(2)</a> system call) to not be supported.</p><p>Fakeroot-ng strives to fill those gaps by using a totally different technology for system call interception. Instead of using LD_PRELOAD, <a href="../man2/ptrace.2.html"><strong>ptrace</strong>(2)</a> is being used.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PARAMETERS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-p</strong><em>state_file</em><strong></strong></p>
  </dt>
  <dd>
    <p>Before the first process is being run, loads from <em>state_file</em> the information needed in order to maintain a consistent view of file permissions and owners across fakeroot-ng runs. This image is also automatically saved when the last process exists. If more then one instance of fakeroot-ng is loaded simultaneously, both with the same <em>state_file</em>, then the two instances will share state and their processes will see the same picture at runtime.</p>
  </dd>
  <dt>
    <p><strong>-l</strong><em>log_file</em><strong></strong></p>
  </dt>
  <dd>
    <p>Causes fakeroot-ng to dump to <em>log_file</em> internal state and processing information. This is mostly useful for cases where fakeroot-ng fails to act as expected.</p>
  </dd>
  <dt>
    <p><strong>-f</strong></p>
  </dt>
  <dd>
    <p>Causes the log file to be flushed after every print. Guarantees that the important hint as to why the crash happened will be in the actual file, but has non-negligent performance effect. Only has effect if <strong>-l</strong> is specified.</p>
  </dd>
  <dt>
    <p><strong>-d</strong></p>
  </dt>
  <dd>
    <p>Tells fakeroot-ng not to completely daemonize itself. This is mostly useful in case of crashes that cause a core dump, as the debugger would normally change directory to root, which would prevent a core file from being created.</p>
  </dd>
  <dt>
    <p><strong>-v</strong></p>
  </dt>
  <dd>
    <p>Print out the version number and copyright info and exit without doing anything.</p>
  </dd>
  <dt>
    <p><strong>-h</strong></p>
  </dt>
  <dd>
    <p>Print out a short help screen and exit.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SIGNALS</h2>
        <div class="sectioncontent">
<p>Sending the ALRM signal to the fakeroot-ng master process makes it dump to the log a complete list of all tracked processes, along with their parent and current state. This is, mostly, a debugging feature. The signal does nothing if <strong>-l</strong> is not active. Please note that no process executes any system calls while this takes place, so this feature essentially freezes all of the debugged processes for a few seconds.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT VARIABLES AND SHARED MEMORY</h2>
        <div class="sectioncontent">
<p>Some of the communication between fakeroot-ng and the program being fooled is done through a shared memory mechanism. In order to create it, fakeroot-ng creates a temporary file and maps it into memory as executable segment. Some systems have their /tmp folder mounted with the <strong>noexec</strong> flag. On those system, the mmap will fail and fakeroot-ng will not run.</p><p>There are two environment variables that allow fakeroot-ng to find a folder in which the shared memory files can be created. The first is <strong>TMPDIR</strong>. If it exists, fakeroot-ng will use it to create the temporary files, rather than /tmp. The problem with using <strong>TMPDIR</strong> for creating temporary files is that fakeroot-ng is not the only one to use it. For that reason, if the environment has a variable called <strong>FAEKROOT_TMPDIR</strong>, its value will override that of either <strong>TMPDIR</strong> or the default /tmp directory.</p><p>On Linux, it is usually entirely safe to point <strong>FAKEROOT_TMPDIR</strong> to <strong>/dev/shm</strong>, which usually lives up to expectations regarding mount mode and writability.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SECURITY CONSIDERATIONS</h2>
        <div class="sectioncontent">
<p>Fakeroot-ng is a non-SUID executable, and does not modify any sensitive data. It, therefor, does not affect the overall security of the system. One may be tempted, however, to use fakeroot-ng as a security tool, for running processes with reduced privileges or inside a chroot jail. In addition to all the warnings that usually apply to using chroot jails as a security tool (in a nutshell - don't), the following should be understood.</p><p>Unlike previous implementations, fakeroot-ng uses a technology that leaves the traced process no choice regarding whether it will use fakeroot-ng's "services" or not. Compiling a program statically, directly calling the kernel and manipulating ones own address space are all techniques that can be trivially used to bypass LD_PRELOAD based control over a process, and do not apply to fakeroot-ng. It is, theoretically, possible to mold fakeroot-ng in such a way as to have total control over the traced process.</p><p>While it is theoretically possible, it has not been done. Fakeroot-ng does assume certain "nicely behaved" assumptions about the process being traced, and a process that break those assumptions may be able to, if not totally escape then at least circumvent some of the "fake" environment imposed on it by fakeroot-ng. As such, you are strongly warned against using fakeroot-ng as a security tool. Bug reports that claim that a process can deliberatly (as opposed to inadvertly) escape fakeroot-ng's control will either be closed as "not a bug" or marked as low priority.</p><p>It is possible that this policy be rethought in the future. For the time being, however, you have been warned.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Plenty of those. See the "README" file for a list of known ones.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO fakeroot-ng&hellip;</h2>
        <div class="sectioncontent">
<p><strong>fakeroot</strong>(1), <strong>fakechroot</strong>(1), <a href="../man2/ptrace.2.html"><strong>ptrace</strong>(2)</a>, <a href="../man8/ld.so.8.html"><strong>ld.so</strong>(8)</a>, <strong>chroot</strong>(1)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Fakeroot-ng was written by Shachar Shemesh.</p><p>This manual page was written by Shachar Shemesh &lt;shachar@debian.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PROJECT HOMEPAGE AND SUPPORT</h2>
        <div class="sectioncontent">
<p>http://fakeroot-ng.lingnu.com</p><p>Community support is available exclusively through the project's mailing list, at https://lists.sourceforge.net/lists/listinfo/fakerootng-devel.</p><p>Commercial support is available through Shachar's company, Lingnu Open Source Consulting Ltd., at http://www.lingnu.com</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="fakeread.1.html"><span aria-hidden="true">&larr;</span> fakeread.1: Fake test chart reader - lookup values in icc/mpp profile.</a></li>
   <li class="next"><a href="fakeroot-sysv.1.html">fakeroot-sysv.1: Run a command in an environment faking root privileges for file manipulation <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
