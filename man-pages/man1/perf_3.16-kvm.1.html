<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>perf_3.16-kvm: Tool to trace/measure kvm guest os</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Tool to trace/measure kvm guest os">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="perf_3.16-kvm (1) manual">
  <meta name="twitter:description" content="Tool to trace/measure kvm guest os">
  <meta name="twitter:image" content="https://www.carta.tech/images/linux-tools-3.16-perf_3.16-kvm-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/perf_3.16-kvm.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="perf_3.16-kvm (1) manual" />
  <meta property="og:description" content="Tool to trace/measure kvm guest os" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/linux-tools-3.16-perf_3.16-kvm-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">perf_3.16-kvm<small> (1)</small></h1>
        <p class="lead">Tool to trace/measure kvm guest os</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/perf_3.16-kvm.1.html">
      <span itemprop="name">perf_3.16-kvm: Tool to trace/measure kvm guest os</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/linux-tools-3.16/">
      <span itemprop="name">linux-tools-3.16</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/perf_3.16-kvm.1.html">
      <span itemprop="name">perf_3.16-kvm: Tool to trace/measure kvm guest os</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<em>perf kvm</em> [--host] [--guest] [--guestmount=&lt;path&gt;
        [--guestkallsyms=&lt;path&gt; --guestmodules=&lt;path&gt; | --guestvmlinux=&lt;path&gt;]]
        {top|record|report|diff|buildid-list} [&lt;options&gt;]
<em>perf kvm</em> [--host] [--guest] [--guestkallsyms=&lt;path&gt; --guestmodules=&lt;path&gt;
        | --guestvmlinux=&lt;path&gt;] {top|record|report|diff|buildid-list|stat} [&lt;options&gt;]
&apos;perf kvm stat [record|report|live] [&lt;options&gt;]
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>There are a couple of variants of perf kvm:</p>
<pre>
&apos;perf kvm [options] top &lt;command&gt;&apos; to generates and displays
a performance counter profile of guest os in realtime
of an arbitrary workload.
</pre>

<pre>
&apos;perf kvm record &lt;command&gt;&apos; to record the performance counter profile
of an arbitrary workload and save it into a perf data file. We set the
default behavior of perf kvm as --guest, so if neither --host nor --guest
is input, the perf data file name is perf.data.guest. If --host is input,
the perf data file name is perf.data.kvm. If you want to record data into
perf.data.host, please input --host --no-guest. The behaviors are shown as
following:
  Default(&apos;&apos;)         -&gt;  perf.data.guest
  --host              -&gt;  perf.data.kvm
  --guest             -&gt;  perf.data.guest
  --host --guest      -&gt;  perf.data.kvm
  --host --no-guest   -&gt;  perf.data.host
</pre>

<pre>
&apos;perf kvm report&apos; to display the performance counter profile information
recorded via perf kvm record.
</pre>

<pre>
&apos;perf kvm diff&apos; to displays the performance difference amongst two perf.data
files captured via perf record.
</pre>

<pre>
&apos;perf kvm buildid-list&apos; to  display the buildids found in a perf data file,
so that other tools can be used to fetch packages with matching symbol tables
for use by perf report. As buildid is read from /sys/kernel/notes in os, then
if you want to list the buildid for guest, please make sure your perf data file
was captured with --guestmount in perf kvm record.
</pre>

<pre>
&apos;perf kvm stat &lt;command&gt;&apos; to run a command and gather performance counter
statistics.
Especially, perf &apos;kvm stat record/report&apos; generates a statistical analysis
of KVM events. Currently, vmexit, mmio and ioport events are supported.
&apos;perf kvm stat record &lt;command&gt;&apos; records kvm events and the events between
start and end &lt;command&gt;.
And this command produces a file which contains tracing results of kvm
events.
</pre>

<pre>
&apos;perf kvm stat report&apos; reports statistical data which includes events
handled time, samples, and so on.
</pre>

<pre>
&apos;perf kvm stat live&apos; reports statistical data in a live mode (similar to
record + report but with statistical data updated live at a given display
rate).
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>-i, --input=&lt;path&gt;</p><p>Input file name.</p><p>-o, --output=&lt;path&gt;</p><p>Output file name.</p><p>--host</p><p>Collect host side performance profile.</p><p>--guest</p><p>Collect guest side performance profile.</p><p>--guestmount=&lt;path&gt;</p><p>Guest os root file system mount directory. Users mounts guest os root directories under &lt;path&gt; by a specific filesystem access method, typically, sshfs. For example, start 2 guest os. The one\(cqs pid is 8888 and the other\(cqs is 9999. #mkdir /guestmount; cd/guestmount #sshfs -o allow_other,direct_io -p 5551 localhost:/ 8888/ #sshfs -o allow_other,direct_io -p 5552 localhost:/ 9999/ #perf kvm --host --guest --guestmount=~/guestmount top</p><p>--guestkallsyms=&lt;path&gt;</p><p>Guest os /proc/kallsyms file copy. <em>perf</em> kvm&apos; reads it to get guest kernel symbols. Users copy it out from guest os.</p><p>--guestmodules=&lt;path&gt;</p><p>Guest os /proc/modules file copy. <em>perf</em> kvm&apos; reads it to get guest kernel module information. Users copy it out from guest os.</p><p>--guestvmlinux=&lt;path&gt;</p><p>Guest os kernel vmlinux.</p><p>-v, --verbose</p><p>Be more verbose (show counter open errors, etc).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">STAT REPORT OPTIONS</h2>
        <div class="sectioncontent">
<p>--vcpu=&lt;value&gt;</p><p>analyze events which occures on this vcpu. (default: all vcpus)</p><p>--event=&lt;value&gt;</p><p>event to be analyzed. Possible values: vmexit, mmio, ioport. (default: vmexit)</p><p>-k, --key=&lt;value&gt;</p><p>Sorting key. Possible values: sample (default, sort by samples number), time (sort by average time).</p><p>-p, --pid=</p><p>Analyze events only for given process ID(s) (comma separated list).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">STAT LIVE OPTIONS</h2>
        <div class="sectioncontent">
<p>-d, --display</p><p>Time in seconds between display updates</p><p>-m, --mmap-pages=</p><p>Number of mmap data pages (must be a power of two) or size specification with appended unit character - B/K/M/G. The size is rounded up to have nearest pages power of two value.</p><p>-a, --all-cpus</p><p>System-wide collection from all CPUs.</p><p>-p, --pid=</p><p>Analyze events only for given process ID(s) (comma separated list).</p><p>--vcpu=&lt;value&gt;</p><p>analyze events which occures on this vcpu. (default: all vcpus)</p><p>--event=&lt;value&gt;</p><p>event to be analyzed. Possible values: vmexit, mmio, ioport. (default: vmexit)</p><p>-k, --key=&lt;value&gt;</p><p>Sorting key. Possible values: sample (default, sort by samples number), time (sort by average time).</p><p>--duration=&lt;value&gt;</p><p>Show events other than HLT that take longer than duration usecs.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO perf_3.16-kvm&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/perf_3.16-top.1.html"><strong>perf_3.16-top</strong>(1)</a>, <a href="../man1/perf_3.16-record.1.html"><strong>perf_3.16-record</strong>(1)</a>, <a href="../man1/perf_3.16-report.1.html"><strong>perf_3.16-report</strong>(1)</a>, <a href="../man1/perf_3.16-diff.1.html"><strong>perf_3.16-diff</strong>(1)</a>, <a href="../man1/perf_3.16-buildid-list.1.html"><strong>perf_3.16-buildid-list</strong>(1)</a>, <a href="../man1/perf_3.16-stat.1.html"><strong>perf_3.16-stat</strong>(1)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="perf_3.16-kmem.1.html"><span aria-hidden="true">&larr;</span> perf_3.16-kmem.1: Tool to trace/measure kernel memory(slab) properties</a></li>
   <li class="next"><a href="perf_3.16-list.1.html">perf_3.16-list.1: List all symbolic event types <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
