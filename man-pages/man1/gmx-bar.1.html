<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>gmx-bar: Calculate free energy difference estimates through bennett's acceptance ratio</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Calculate free energy difference estimates through bennett's acceptance ratio">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="gmx-bar (1) manual">
  <meta name="twitter:description" content="Calculate free energy difference estimates through bennett's acceptance ratio">
  <meta name="twitter:image" content="https://www.carta.tech/images/gromacs-data-gmx-bar-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/gmx-bar.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="gmx-bar (1) manual" />
  <meta property="og:description" content="Calculate free energy difference estimates through bennett's acceptance ratio" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/gromacs-data-gmx-bar-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">gmx-bar<small> (1)</small></h1>
        <p class="lead">Calculate free energy difference estimates through bennett's acceptance ratio</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/gmx-bar.1.html">
      <span itemprop="name">gmx-bar: Calculate free energy difference estimates through bennett's acceptance ratio</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/gromacs-data/">
      <span itemprop="name">gromacs-data</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/gmx-bar.1.html">
      <span itemprop="name">gmx-bar: Calculate free energy difference estimates through bennett's acceptance ratio</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>gmx bar [-f [&lt;.xvg&gt; [...]]] [-g [&lt;.edr&gt; [...]]] [-o [&lt;.xvg&gt;]]</p>
<pre>
        [-oi [&lt;.xvg&gt;]] [-oh [&lt;.xvg&gt;]] [-nice &lt;int&gt;] [-[no]w]
        [-xvg &lt;enum&gt;] [-b &lt;real&gt;] [-e &lt;real&gt;] [-temp &lt;real&gt;]
        [-prec &lt;int&gt;] [-nbmin &lt;int&gt;] [-nbmax &lt;int&gt;] [-nbin &lt;int&gt;]
        [-[no]extp]
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>gmx bar</strong> calculates free energy difference estimates through Bennett's acceptance ratio method (BAR). It also automatically adds series of individual free energies obtained with BAR into a combined free energy estimate.</p><p>Every individual BAR free energy difference relies on two simulations at different states: say state A and state B, as controlled by a parameter, lambda (see the <strong>.mdp</strong> parameter <strong>init_lambda</strong>). The BAR method calculates a ratio of weighted average of the Hamiltonian difference of state B given state A and vice versa. The energy differences to the other state must be calculated explicitly during the simulation. This can be done with the <strong>.mdp</strong> option <strong>foreign_lambda</strong>.</p><p>Input option <strong>-f</strong> expects multiple <strong>dhdl.xvg</strong> files. Two types of input files are supported: <strong>*</strong>  Files with more than one <em>y</em>-value. The files should have columns with dH/dlambda and Deltalambda. The lambda values are inferred from the legends: lambda of the simulation from the legend of dH/dlambda and the foreign lambda values from the legends of Delta H <strong>*</strong>  Files with only one <em>y</em>-value. Using the <strong>-extp</strong> option for these files, it is assumed that the <em>y</em>-value is dH/dlambda and that the Hamiltonian depends linearly on lambda. The lambda value of the simulation is inferred from the subtitle (if present), otherwise from a number in the subdirectory in the file name.</p><p>The lambda of the simulation is parsed from <strong>dhdl.xvg</strong> file's legend containing the string 'dH', the foreign lambda values from the legend containing the capitalized letters 'D' and 'H'. The temperature is parsed from the legend line containing 'T ='.</p><p>The input option <strong>-g</strong> expects multiple <strong>.edr</strong> files. These can contain either lists of energy differences (see the <strong>.mdp</strong> option <strong>separate_dhdl_file</strong>), or a series of histograms (see the <strong>.mdp</strong> options <strong>dh_hist_size</strong> and <strong>dh_hist_spacing</strong>). The temperature and lambda values are automatically deduced from the <strong>ener.edr</strong> file.</p><p>In addition to the <strong>.mdp</strong> option <strong>foreign_lambda</strong>, the energy difference can also be extrapolated from the dH/dlambda values. This is done with the<strong>-extp</strong> option, which assumes that the system's Hamiltonian depends linearly on lambda, which is not normally the case.</p><p>The free energy estimates are determined using BAR with bisection, with the precision of the output set with <strong>-prec</strong>. An error estimate taking into account time correlations is made by splitting the data into blocks and determining the free energy differences over those blocks and assuming the blocks are independent. The final error estimate is determined from the average variance over 5 blocks. A range of block numbers for error estimation can be provided with the options <strong>-nbmin</strong> and <strong>-nbmax</strong>.</p><p><strong>gmx bar</strong> tries to aggregate samples with the same 'native' and 'foreign' lambda values, but always assumes independent samples. <strong>Note</strong> that when aggregating energy differences/derivatives with different sampling intervals, this is almost certainly not correct. Usually subsequent energies are correlated and different time intervals mean different degrees of correlation between samples.</p><p>The results are split in two parts: the last part contains the final results in kJ/mol, together with the error estimate for each part and the total. The first part contains detailed free energy difference estimates and phase space overlap measures in units of kT (together with their computed error estimate). The printed values are: <strong>*</strong>  lam_A: the lambda values for point A. <strong>*</strong>  lam_B: the lambda values for point B. <strong>*</strong>     DG: the free energy estimate. <strong>*</strong>    s_A: an estimate of the relative entropy of B in A. <strong>*</strong>    s_B: an estimate of the relative entropy of A in B. <strong>*</strong>  stdev: an estimate expected per-sample standard deviation.</p><p>The relative entropy of both states in each other's ensemble can be interpreted as a measure of phase space overlap: the relative entropy s_A of the work samples of lambda_B in the ensemble of lambda_A (and vice versa for s_B), is a measure of the 'distance' between Boltzmann distributions of the two states, that goes to zero for identical distributions. See Wu & Kofke, J. Chem. Phys. 123 084109 (2005) for more information.</p><p>The estimate of the expected per-sample standard deviation, as given in Bennett's original BAR paper: Bennett, J. Comp. Phys. 22, p 245 (1976). Eq. 10 therein gives an estimate of the quality of sampling (not directly of the actual statistical error, because it assumes independent samples).</p><p>To get a visual estimate of the phase space overlap, use the <strong>-oh</strong> option to write series of histograms, together with the <strong>-nbin</strong> option.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>Options to specify input and output files:</p><p><strong>-f</strong><em> [&lt;.xvg&gt; [...]] (dhdl.xvg) (Input, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-g</strong><em> [&lt;.edr&gt; [...]] (ener.edr) (Input, Optional)</em></p>
<pre>
    Energy file
</pre>
<p><strong>-o</strong><em> [&lt;.xvg&gt;] (bar.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-oi</strong><em> [&lt;.xvg&gt;] (barint.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-oh</strong><em> [&lt;.xvg&gt;] (histogram.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p>Other options:</p><p><strong>-nice</strong><em> &lt;int&gt; (0)</em></p>
<pre>
    Set the nicelevel
</pre>
<p><strong>-[no]w</strong><em>  (no)</em></p>
<pre>
    View output <strong>.xvg</strong>, <strong>.xpm</strong>, <strong>.eps</strong> and <strong>.pdb</strong> files
</pre>
<p><strong>-xvg</strong><em> &lt;enum&gt; (xmgrace)</em></p>
<pre>
    xvg plot formatting: xmgrace, xmgr, none
</pre>
<p><strong>-b</strong><em> &lt;real&gt; (0)</em></p>
<pre>
    Begin time for BAR
</pre>
<p><strong>-e</strong><em> &lt;real&gt; (-1)</em></p>
<pre>
    End time for BAR
</pre>
<p><strong>-temp</strong><em> &lt;real&gt; (-1)</em></p>
<pre>
    Temperature (K)
</pre>
<p><strong>-prec</strong><em> &lt;int&gt; (2)</em></p>
<pre>
    The number of digits after the decimal point
</pre>
<p><strong>-nbmin</strong><em> &lt;int&gt; (5)</em></p>
<pre>
    Minimum number of blocks for error estimation
</pre>
<p><strong>-nbmax</strong><em> &lt;int&gt; (5)</em></p>
<pre>
    Maximum number of blocks for error estimation
</pre>
<p><strong>-nbin</strong><em> &lt;int&gt; (100)</em></p>
<pre>
    Number of bins for histogram output
</pre>
<p><strong>-[no]extp</strong><em>  (no)</em></p>
<pre>
    Whether to linearly extrapolate dH/dl values to use as energies
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO gmx-bar&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man7/gromacs.7.html"><strong>gromacs</strong>(7)</a></strong></p><p>More information about <strong>GROMACS</strong> is available at &lt;<em>http://www.gromacs.org/</em>&gt;.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="gmx-angle.1.html"><span aria-hidden="true">&larr;</span> gmx-angle.1: Calculate distributions and correlations for angles and dihedrals</a></li>
   <li class="next"><a href="gmx-bundle.1.html">gmx-bundle.1: Analyze bundles of axes, e.g., helices <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
