<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>dpm-drain: Drain a component of the light weight disk pool manager</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Drain a component of the light weight disk pool manager">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="dpm-drain (1) manual">
  <meta name="twitter:description" content="Drain a component of the light weight disk pool manager">
  <meta name="twitter:image" content="https://www.carta.tech/images/dpm-dpm-drain-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/dpm-drain.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="dpm-drain (1) manual" />
  <meta property="og:description" content="Drain a component of the light weight disk pool manager" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/dpm-dpm-drain-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">dpm-drain<small> (1)</small></h1>
        <p class="lead">Drain a component of the light weight disk pool manager</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/dpm-drain.1.html">
      <span itemprop="name">dpm-drain: Drain a component of the light weight disk pool manager</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/dpm/">
      <span itemprop="name">dpm</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/dpm-drain.1.html">
      <span itemprop="name">dpm-drain: Drain a component of the light weight disk pool manager</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>dpm-drain</strong> <strong>--poolname</strong><em> pool_name</em> [ <strong>--server</strong><em> fs_server</em> ] [ <strong>--gid</strong><em> gids</em> ] [ <strong>--group</strong><em> groups</em> ] [ <strong>--size</strong><em> amount_to_drain</em> ]</p><p><strong>dpm-drain</strong> <strong>--server</strong><em> fs_server</em> [ <strong>--gid</strong><em> gids</em> ] [ <strong>--group</strong><em> groups</em> ] [ <strong>--size</strong><em> amount_to_drain</em> ]</p><p><strong>dpm-drain</strong> <strong>--server</strong><em> fs_server</em> <strong>--fs</strong><em> fs_name</em> [ <strong>--gid</strong><em> gids</em> ] [ <strong>--group</strong><em> groups</em> ] [ <strong>--size</strong><em> amount_to_drain</em> ]</p><p><strong>dpm-drain</strong> <strong>--help</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>dpm-drain</strong> drains a component of the Light Weight Disk Pool Manager: a filesystem, a disk server or a pool, optionally filtered by a list of gids/groups. It replicates files which belong to the given list of gids/groups (if specified) to another filesystem and removes the original file. It gives an error message for files still pinned. The pool name, the disk server name or the filesystem name can be specified.</p><p><strong>Volatile</strong> files which have expired will not be copied and will be <strong>deleted</strong> during the draining process.</p><p>If no specfic file server and file system is specified, or no limit is placed on the files to drain, then the involved active file system(s) will have their status changed to <strong>RDONLY.</strong> If any of the involved file systems are marked as <strong>DISABLED</strong> they will not have their status changed, however an attempt will still be made to replicate the files from them and, if successful, delete the original.</p><p>Files which are to be moved and belong to a space will be moved to a different location (e.g. file system or disk server) but remain in the same space. If there is no alternate location within the same space an error will be reported for the file and it will not be drained.</p><p>Replicas of files with a lifetime will also have lifetime at least as long as the original. If this is not possible (for example available pools have a maximum lifetime too short) then an error is given and the file will not be drained.</p><p>This command requires ADMIN privilege.</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>pool_name</em></p>
  </dt>
  <dd>
    <p>specifies the disk pool name previously defined using <strong>dpm-addpool</strong>.</p>
  </dd>
  <dt>
    <p><em>server</em></p>
  </dt>
  <dd>
    <p>specifies the host name of the disk server to be drained.</p>
  </dd>
  <dt>
    <p><em>fs</em></p>
  </dt>
  <dd>
    <p>specifies the mount point of the dedicated filesystem.</p>
  </dd>
  <dt>
    <p><em>gid</em></p>
  </dt>
  <dd>
    <p>specifies the comma separated list of gids to which the files must belong.</p>
  </dd>
  <dt>
    <p><em>group</em></p>
  </dt>
  <dd>
    <p>specifies the comma separated list of groups to which the files must belong.</p>
  </dd>
  <dt>
    <p><em>size</em></p>
  </dt>
  <dd>
    <p>specifies the minimum number of bytes to drain. The number may be post-fixed with 'k', 'M', 'G' or 'T' for kilobyte, Megabyte, Gigabyte and Terabyte respectively. Draining is halted once the desired target has been reached or passed. If size is not specified or is given as zero dpm-drain will drain all eligible files.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<pre>
	setenv DPM_HOST dpmhost
	setenv DPNS_HOST dpnshost

	dpm-drain --poolname Permanent

	dpm-drain --server lxb1921.cern.ch

	dpm-drain --server lxb1921.cern.ch --fs /storage


	dpm-drain --poolname Permanent --gid 105

	dpm-drain --server lxb1921.cern.ch --group dteam

	dpm-drain --server lxb1921.cern.ch --gid 105,104
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">
<p>This program returns 0 if the operation was successful or &gt;0 if the operation failed.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO dpm-drain&hellip;</h2>
        <div class="sectioncontent">
<p><strong>dpm</strong>(1)</strong>, <a href="../man1/dpm-qryconf.1.html"><strong>dpm-qryconf</strong>(1)</a></strong></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="dpm-addpool.1.html"><span aria-hidden="true">&larr;</span> dpm-addpool.1: Define a new disk pool</a></li>
   <li class="next"><a href="dpm-getspacemd.1.html">dpm-getspacemd.1: Get space metadata <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
