<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>osmfilter: The experimental osm filters data</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="The experimental osm filters data">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="osmfilter (1) manual">
  <meta name="twitter:description" content="The experimental osm filters data">
  <meta name="twitter:image" content="https://www.carta.tech/images/osmctools-osmfilter-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/osmfilter.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="osmfilter (1) manual" />
  <meta property="og:description" content="The experimental osm filters data" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/osmctools-osmfilter-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">osmfilter<small> (1)</small></h1>
        <p class="lead">The experimental osm filters data</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/osmfilter.1.html">
      <span itemprop="name">osmfilter: The experimental osm filters data</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/osmctools/">
      <span itemprop="name">osmctools</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/osmfilter.1.html">
      <span itemprop="name">osmfilter: The experimental osm filters data</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>osmfilter</strong> <em>options</em> [<em>inputÂ file</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>THIS PROGRAM IS FOR EXPERIMENTAL USE ONLY. PLEASE EXPECT MALFUNCTION AND DATA LOSS. SAVE YOUR DATA BEFORE STARTING THIS PROGRAM.</p><p>This program filters OpenStreetMap data.</p><p>The input file name must be supplied as command line argument. The file must not be a stream. Redirections from standard input will not work because the program needs random access to the file. You do not need to specify the input format, osmfilter will recognize these formats: .osm (XML), .osc (OSM Change File), .osh (OSM Full History), .o5m (speed-optimized) and .o5c (speed-optimized Change File).</p><p>The output format is .osm by default. If you want a different format, please specify it using the appropriate command line parameter.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p><strong>--keep</strong>=<em>OBJECT_FILTER</em></p><ul>
<li><p>All object types (nodes, ways and relations) will be kept if they meet the filter criteria. Same applies to dependent objects, e.g. nodes in ways, ways in relations, relations in other relations. Please look below for a syntax description of OBJECT_FILTER.</p></li>
</ul><p>--keep-nodes=<em>OBJECT_FILTER</em></p><p>--keep-ways=<em>OBJECT_FILTER</em></p><p>--keep-relations=<em>OBJECT_FILTER</em></p><p>--keep-nodes-ways=<em>OBJECT_FILTER</em></p><p>--keep-nodes-relations=<em>OBJECT_FILTER</em></p><p>--keep-ways-relations=<em>OBJECT_FILTER</em></p><ul>
<li><p>Same as above, but just for the specified object types.</p></li>
</ul><p><strong>--drop</strong>=<em>OBJECT_FILTER</em></p><ul>
<li><p>All object types (nodes, ways and relations) which meet the supplied filter criteria will be dropped, regardless of meeting the criteria of a keep filter (see above). Please look below for a syntax description of OBJECT_FILTER.</p></li>
</ul><p>--drop-nodes=<em>OBJECT_FILTER</em></p><p>--drop-ways=<em>OBJECT_FILTER</em></p><p>--drop-relations=<em>OBJECT_FILTER</em></p><p>--drop-nodes-ways=<em>OBJECT_FILTER</em></p><p>--drop-nodes-relations=<em>OBJECT_FILTER</em></p><p>--drop-ways-relations=<em>OBJECT_FILTER</em></p><ul>
<li><p>Same as above, but just for the specified object types.</p></li>
</ul><p><strong>--keep-tags</strong>=<em>TAG_FILTER</em></p><ul>
<li><p>The in TAG_FILTER specified tags will be allowed on output. Please look below for a syntax description of TAG_FILTER.</p></li>
</ul><p>--keep-node-tags=<em>TAG_FILTER</em></p><p>--keep-way-tags=<em>TAG_FILTER</em></p><p>--keep-relation-tags=<em>TAG_FILTER</em></p><p>--keep-node-way-tags=<em>TAG_FILTER</em></p><p>--keep-node-relation-tags=<em>TAG_FILTER</em></p><p>--keep-way-relation-tags=<em>TAG_FILTER</em></p><ul>
<li><p>Same as above, but just for the specified object types.</p></li>
</ul><p><strong>--drop-tags</strong>=<em>TAG_FILTER</em></p><ul>
<li><p>The specified tags will be dropped. This overrules the previously described parameter <strong>--keep-tags</strong>. Please look below for a syntax description of TAG_FILTER.</p></li>
</ul><p>--drop-node-tags=<em>TAG_FILTER</em></p><p>--drop-way-tags=<em>TAG_FILTER</em></p><p>--drop-relation-tags=<em>TAG_FILTER</em></p><p>--drop-node-way-tags=<em>TAG_FILTER</em></p><p>--drop-node-relation-tags=<em>TAG_FILTER</em></p><p>--drop-way-relation-tags=<em>TAG_FILTER</em></p><ul>
<li><p>Same as above, but just for the specified object types.</p></li>
</ul><p><strong>--drop-author</strong></p><ul>
<li><p>For most applications the author tags are not needed. If you specify this option, no author information will be written: no changeset, user or timestamp.</p></li>
</ul><p><strong>--drop-version</strong></p><ul>
<li><p>If you want to exclude not only the author information but also the version number, specify this option.</p></li>
</ul><p>--drop-nodes</p><p>--drop-ways</p><p>--drop-relations</p><ul>
<li><p>According to the combination of these parameters, no members of the referred section will be written.</p></li>
</ul><p>--emulate-osmosis</p><p>--emulate-pbf2osm</p><ul>
<li><p>In case of .osm output format, the program will try to use the same data syntax as Osmosis, resp. pbf2osm.</p></li>
</ul><p><strong>--fake-author</strong></p><ul>
<li><p>If you have dropped author information (<strong>--drop-author</strong>) that data will be lost, of course. Some programs however require author information on input although they do not need that data. For this purpose, you can fake the author information. o5mfiler will write changeset 1, timestamp 1970.</p></li>
</ul><p><strong>--fake-version</strong></p><ul>
<li><p>Same as <strong>--fake-author</strong>, but - if .osm xml is used as output format - only the version number will be written (version 1). This is useful if you want to inspect the data with JOSM.</p></li>
</ul><p><strong>--fake-lonlat</strong></p><ul>
<li><p>Some programs depend on getting longitude/latitude values, even when the object in question shall be deleted. With this option you can have osmfilter to fake these values:</p><p>... lat="0" lon="0" ...</p><p>Note that this is for XML files only (.osc and .osh).</p></li>
</ul><p><strong>-h</strong></p><ul>
<li><p>Display a short parameter overview.</p></li>
</ul><p><strong>--help</strong></p><ul>
<li><p>Display this help.</p></li>
</ul><p><strong>--ignore-dependencies</strong></p><ul>
<li><p>Usually, all member nodes of a way which meets the filter criteria will be included as well. Same applies to members of included relations. If you activate this option, all these dependencies between OSM objects will be ignored.</p></li>
</ul><p><strong>--out-key</strong>=<em>KEYNAME</em></p><ul>
<li><p>The output will contain no regular OSM data but only statistics: a list of all used keys is assembled. Left to each key, the number of occurrences is printed. If KEYNAME is given, the program will list all values which are used in connections with this key. You may use wildcard characters for KEYNAME, but only at the beginning and/or at the end. For example:  <strong>--out-key</strong>=<em>addr</em>:*</p></li>
</ul><p><strong>--out-count</strong>=<em>KEYNAME</em></p><ul>
<li><p>Same as <strong>--out-key=</strong>, but the list is sorted by the number of occurrences of the keys resp. values.</p></li>
</ul><p><strong>--out-osm</strong></p><ul>
<li><p>Data will be written in .osm format. This is the default output format.</p></li>
</ul><p><strong>--out-osc</strong></p><ul>
<li><p>The OSM Change format will be used for output. Please note that OSM objects which are to be deleted are represented by their ids only.</p></li>
</ul><p><strong>--out-osh</strong></p><ul>
<li><p>For every OSM object, the appropriate 'visible' tag will be added to meet 'full planet history' specification.</p></li>
</ul><p><strong>--out-o5m</strong></p><ul>
<li><p>The .o5m format will be used. This format has the same structure as the conventional .osm format, but the data are stored as binary numbers and are therefore much more compact than in .osm format. No packing is used, so you can pack .o5m files using every file packer you want, e.g. lzo, bz2, etc.</p></li>
</ul><p><strong>--out-o5c</strong></p><ul>
<li><p>This is the change file format of .o5m data format. All &lt;delete&gt; tags will not be performed as delete actions but converted into .o5c data format.</p></li>
</ul><p><strong>-o=</strong>&lt;outfile&gt;</p><ul>
<li><p>Standard output will be rerouted to the specified file. If no output format has been specified, the program will proceed according to the file name extension.</p></li>
</ul><p><strong>-t=</strong>&lt;tempfile&gt;</p><ul>
<li><p>osmfilter uses a temporary file to process interrelational dependencies. This parameter defines the name prefix. The default value is "osmfilter_tempfile".</p></li>
</ul><p><strong>--parameter-file</strong>=<em>FILE</em></p><ul>
<li><p>If you want to supply one ore more command line arguments by a parameter file, please use this option and specify the file name. Within the parameter file, parameters must be separated by empty lines. Line feeds inside a parameter will be converted to spaces. Lines starting with "// " will be treated as comments.</p></li>
</ul><p><strong>-v</strong> <strong>--verbose</strong></p><ul>
<li><p>With activated 'verbose' mode, some statistical data and diagnosis data will be displayed. If <strong>-v</strong> resp. <strong>--verbose</strong> is the first parameter in the line, osmfilter will display all input parameters.</p></li>
</ul><h3>OBJECT_FILTER</h3>
<p>Some of the command line arguments need a filter to be specified. This filter definition consists of key/val pairs and uses the following syntax:</p><p>"KEY1=VAL1 OP KEY2=VAL2 OP KEY3=VAL3 ..."</p><ul>
<li><p>OP is the Boolean operator, it must be either "and" or "or". As usual, "and" will be processed prior to "or". If you want to influence the sequence of processing, you may use brackets to do so. Please note that brackets always must be padded by spaces. Example: lit=yes and ( note=a or source=b ) Instead of each "=" you may enter one of these comparison operators: != (not equal), &lt;, &gt;, &lt;=, &gt;= The program will use ASCII-alphabetic comparison unless you compare against a value which is starting with a digit. If there are different possible values for the same key, you need to write the key only once. For example:</p><p>"amenity=restaurant =pub =bar"</p></li><li><p>It is allowed to omit the value. In this case, the program will accept every value for the defined key. For example:</p><p>"all highway= lit=yes"</p></li><li><p>You may use wildcard characters for key or value, but only at the beginning and/or at the end. For example:</p><p>"wikipedia:*=highway=*ary  ref_name=*central*"</p></li><li><p>Please be careful with wildcards in keys since only the first key which meets the pattern will be processed. There are three special keys which represent object id, user id and user name: @id, @uid and @user. They allow you to search for certain objects or for edits of specific users.</p></li>
</ul>
<h3>TAG_FILTER</h3>
<p>The tag filter determines which tags will be kept and which will be not. For example :</p><p><strong>--keep-tags=</strong>"highway=motorway =primary"</p><ul>
<li><p>will not accept "highway" tags other than "motorway" or "primary". Note that neither the object itself will be deleted, nor the remaining tags. If you want to drop every tag which is not mentioned in a list, use this example:</p><p>all highway= amenity= name=</p></li>
</ul>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TUNING</h2>
        <div class="sectioncontent">
<p>To speed-up the process, the program uses some main memory for a hash table. By default, it uses 480 MB for storing a flag for every possible node, 90 for the way flags, and 30 relation flags. Every byte holds the flags for 8 ID numbers, i.e., in 480 MB the program can store 3840 million flags. As there are less than 1900 million IDs for nodes at present (July 2012), 240 MB would suffice. So, for example, you can decrease the hash sizes to e.g. 240, 30 and 2 MB (for relations, 2 flags are needed each) using this option:</p><p><strong>--hash-memory</strong>=<em>240-30-2</em></p><p>But keep in mind that the OSM database is continuously expanding. For this reason the program-own default value is higher than shown in the example, and it may be appropriate to increase it in the future. If you do not want to bother with the details, you can enter the amount of memory as a sum, and the program will divide it by itself. For example:</p><p><strong>--hash-memory</strong>=<em>1000</em></p><p>These 1000 MiB will be split in three parts: 800 for nodes, 150 for ways, and 50 for relations.</p><p>Because we are taking hashes, it is not necessary to provide all the suggested memory; the program will operate with less hash memory too. But, in this case, the border filter will be less effective, i.e., some ways and some relations will be left in the output file although they should have been excluded. The maximum value the program accepts for the hash size is 4000 MiB; If you exceed the maximum amount of memory available on your system, the program will try to reduce this amount and display a warning message.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LIMITATIONS</h2>
        <div class="sectioncontent">
<p>When filtering whole OSM objects (<strong>--keep</strong>...=, <strong>--drop</strong>...=), the input file must contain the objects ordered by their type: first, all nodes nodes, next, all ways, followed by all relations.</p><p>Usual .osm, .osc, .o5m and o5c files adhere to this condition. This means that you do not have to worry about this limitation. osmfilter will display an error message if this sequence is broken.</p><p>The number of key/val pairs in each filter parameter is limited to 1000, the length of each key or val is limited to 100.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>This program is for experimental use. Expect malfunctions and data loss. Do not use the program in productive or commercial systems.</p><p>There is NO WARRANTY, to the extent permitted by law. Please send any bug reports to markus.weber@gmx.com</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>osmfilter europe.o5m --keep=amenity=bar -o=new.o5m</p><p>osmfilter a.osm --keep-nodes=lit=yes --drop-ways -o=light.osm</p><p>osmfilter a.osm --keep="place=city or ( place=town and population&gt;=10000 )" -o=b.osm</p><p>osmfilter region.o5m --keep="bridge=yes and layer&gt;=2" -o=r.o5m</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO osmfilter&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/osmconvert.1.html"><strong>osmconvert</strong>(1)</a>, <a href="../man1/osmupdate.1.html"><strong>osmupdate</strong>(1)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p><strong>osmfilter</strong> was written by Markus Weber</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="osmconvert.1.html"><span aria-hidden="true">&larr;</span> osmconvert.1: Converter of osm files</a></li>
   <li class="next"><a href="osmjs.1.html">osmjs.1: Javascript interpreter for the osmium framework <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
