<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>nstreams: A tcpdump output analyzer</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A tcpdump output analyzer">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="nstreams (1) manual">
  <meta name="twitter:description" content="A tcpdump output analyzer">
  <meta name="twitter:image" content="https://www.carta.tech/images/nstreams-nstreams-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/nstreams.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="nstreams (1) manual" />
  <meta property="og:description" content="A tcpdump output analyzer" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/nstreams-nstreams-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">nstreams<small> (1)</small></h1>
        <p class="lead">A tcpdump output analyzer</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/nstreams.1.html">
      <span itemprop="name">nstreams: A tcpdump output analyzer</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/nstreams/">
      <span itemprop="name">nstreams</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/nstreams.1.html">
      <span itemprop="name">nstreams: A tcpdump output analyzer</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>nstreams</strong> [ -v ] [ -c <em>nstreams-services</em> ] [ -n <em>nstreams-networks_file</em> ] [ -N [ -i ] [ -I ]] [ -r ] [ -O output [ -D iface ] [ -Y ]] [ -u ] [ -U ] [ -B ] [ -f <em>tcpdump_file ] [ -l &lt;iface&gt; ] [</em> <em>tcpdump output</em> ]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>nstreams</strong> is a utility designed to identify the IP streams that are occuring on a network from a non-user friendly tcpdump output of several megabytes.</p><p>This is especially useful when you plan to install a firewall but if you do not know the nstreams that the network users are generating (http, real audio, and more...). <strong>nstreams</strong> can read the tcpdump output directly from stdin, or from a file. It can even generate the configuration file of your firewall, using the  -O option.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    -c &lt;nstreams-services-file&gt;
  </dt>
  <dd>
    <p>The path to an alternate nstreams service file. This file is used to identify each protocol. See the <strong>services file</strong> section later in this manual page.</p>
  </dd>
  <dt>
    -n &lt;nstreams-networks-file&gt;
  </dt>
  <dd>
    <p>The path to an alternate nstreams network file. This file is used to identify which hosts belong to which network. See the <strong>networks file</strong> section later in this manual page.</p>
  </dd>
  <dt>
    -f &lt;tcpdump output file&gt;
  </dt>
  <dd>
    <p>The path to the file to read data from. This file must have been generated using 'tcpdump -w filename'.</p>
  </dd>
  <dt>
    -l &lt;iface&gt;
  </dt>
  <dd>
    <p>Listen directly on interface &lt;iface&gt;. This avoids the use of tcpdump.</p>
  </dd>
  <dt>
    -N
  </dt>
  <dd>
    <p>print the networks names instead of the hosts IP addresses. The intra-network traffic will not be shown. Use this option twice to show the networks IP address instead of their names.</p>
  </dd>
  <dt>
    -i
  </dt>
  <dd>
    <p>Also show the intra-network traffic (must be used with -N)</p>
  </dd>
  <dt>
    -I
  </dt>
  <dd>
    <p>Only show the intra-network traffic (must be used with -N)</p>
  </dd>
  <dt>
    -r
  </dt>
  <dd>
    <p>be redundant. That is, the same streams will be printed each time they appear in the dump.</p>
  </dd>
  <dt>
    -v
  </dt>
  <dd>
    <p>print version number and exit.</p>
  </dd>
  <dt>
    -O &lt;type&gt;
  </dt>
  <dd>
    <p>output type. You can use this option to generate your firewall startup script. Do nstreams -h to see the supported output types.</p>
  </dd>
  <dt>
    -D &lt;iface&gt;
  </dt>
  <dd>
    <p>interface to apply to output onto. Must be used with -O.</p>
  </dd>
  <dt>
    -Y
  </dt>
  <dd>
    <p>The firewall rules that will be generated will deny all packets coming from the outside trying to establish connections to the inside. If you system is not serving anything, then it's safe to turn on this option.</p>
  </dd>
  <dt>
    -u
  </dt>
  <dd>
    <p>Do not print the unknown streams</p>
  </dd>
  <dt>
    -U
  </dt>
  <dd>
    <p>Only print the unknown streams</p>
  </dd>
  <dt>
    -B
  </dt>
  <dd>
    <p>Show broadcasts and networks</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE</h2>
        <div class="sectioncontent">
<p>Let <strong>tcpdump</strong>(1) run some time on your network (like one week), and save its output in a file, by doing :</p><p>tcpdump -l -n &gt; output</p><p>or</p><p>tcpdump -w filename</p><p>Then, feed <strong>nstreams</strong> with this output file, and it will turn it into a easily-readable file which will help you to write efficient firewall filters. You may also do :</p><p>tcpdump -l -n | nstreams</p><p>or</p><p>nstreams -f filename (if you used tcpdump -w)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THE SERVICES FILE</h2>
        <div class="sectioncontent">
<p>The service file contains the description of each protocol, as well as their name. Its syntax is :</p><p>protocol_name:server_port(s)/{udp,tcp}:client_ports(s)</p><p>or :</p><p>protocol_name:type(s)/icmp:code(s)</p><p>Whereas :</p>
<dl class='dl-vertical'>
  <dt>
    protocol_name
  </dt>
  <dd>
    <p>is the name of the protocol described. This name may contain any character, including space, except ':'.</p>
  </dd>
  <dt>
    server_port(s)
  </dt>
  <dd>
    <p>is the range of ports used by the server. Usually, you will want to define one server port only, but you may enter any range you want.</p>
  </dd>
  <dt>
    ip_protocol
  </dt>
  <dd>
    <p>is the IP protocol that this protocol is lying onto. Acceptable values are <em>tcp</em> and <em>udp</em></p>
  </dd>
  <dt>
    client_port(s)
  </dt>
  <dd>
    <p>is the range of ports that the client may use. You can set this to <em>any</em> or, for more accurate results, to ports ranges, like '1-1024,2048-4096'.</p><p>The rules are : 'first match, first taken'.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SERVICE FILE EXAMPLE</h2>
        <div class="sectioncontent">
<p>Using this syntax, you would declare the ssh protocol by :</p><p>ssh-unix:22/tcp:1000-1023</p><p>Because the Unix version of the ssh client uses a privileged port to connect onto the ssh server which listens on port 22.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THE NETWORKS FILE</h2>
        <div class="sectioncontent">
<p>The networks file is used to define sets and subsets of hosts (also known as networks). This avoids redundancy in the output file. The syntax format for this file is :</p><p>network name:ip/mask</p><p>Whereas the network name is whatever you want, the IP is the ip of the network, and the mask is the CIDR netmask of the network. The rule is 'first match, first taken'.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NETWORKS FILE EXAMPLE</h2>
        <div class="sectioncontent">
<p>admin:192.168.19.0/29</p><p>whole_subnet:192.168.0.0/16</p><p>internet:0.0.0.0/0</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LIMITS</h2>
        <div class="sectioncontent">
<p>&bull; nstreams can only parse the output of 'tcpdump -n'</p><p>&bull; Even though the output of nstreams is easier to read than the one of tcpdump, it is still not easily readable. Use <a href="../man1/sort.1.html"><strong>sort</strong>(1)</a> on the nstream output to get a more readable file.</p><p>&bull; This program could have been written in perl</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/etc/nstreams-services</p><p>/etc/nstreams-networks</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO nstreams&hellip;</h2>
        <div class="sectioncontent">
<p><strong>tcpdump</strong>(1)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Concept : Herve Schauer Consultants - http://www.hsc.fr</p><p>Coding : Renaud Deraison &lt;deraison@cvs.nessus.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUG REPORTS</h2>
        <div class="sectioncontent">
<p>Please send all your bug reports with the detail of your configuration to Renaud Deraison &lt;deraison@cvs.nessus.org&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="nstk.1.html"><span aria-hidden="true">&larr;</span> nstk.1: Ns with tk support</a></li>
   <li class="next"><a href="dnsutils-nsupdate.1.html">nsupdate.1: Dynamic dns update utility <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
