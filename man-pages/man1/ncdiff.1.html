<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ncdiff: Netcdf differencer</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Netcdf differencer">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="ncdiff (1) manual">
  <meta name="twitter:description" content="Netcdf differencer">
  <meta name="twitter:image" content="https://www.carta.tech/images/nco-ncdiff-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/ncdiff.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ncdiff (1) manual" />
  <meta property="og:description" content="Netcdf differencer" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/nco-ncdiff-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">ncdiff<small> (1)</small></h1>
        <p class="lead">Netcdf differencer</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/ncdiff.1.html">
      <span itemprop="name">ncdiff: Netcdf differencer</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/nco/">
      <span itemprop="name">nco</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/ncdiff.1.html">
      <span itemprop="name">ncdiff: Netcdf differencer</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNTAX</h2>
        <div class="sectioncontent">
<p>ncdiff [-3] [-4] [-6] [-A] [-C] [-c] [-D dbg_lvl ] [-d <em>dim</em>,[ <em>min</em>][,[ <em>max</em>]]] [-F] [-h] [--hdr_pad <em>sz</em>] [-L <em>dfl_lvl</em>] [-l <em>path</em>] [-O] [-p <em>path</em>] [-R] [-r] [-v <em>var</em>[,...]] [-x] <em>file_1</em> <em>file_2</em> <em>file_3</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>ncdiff</strong> subtracts variables in <em>file_2</em> from the corresponding variables (those with the same name) in <em>file_1</em> and stores the results in <em>file_3</em>. Variables in <em>file_2</em> are <em>broadcast</em> to conform to the corresponding variable in <em>file_1</em> if necessary. Broadcasting a variable means creating data in non-existing dimensions from the data in existing dimensions. For example, a two dimensional variable in <em>file_2</em> can be subtracted from a four, three, or two (but not one or zero) dimensional variable (of the same name) in <strong>file_1</strong>. This functionality allows the user to compute anomalies from the mean. Note that variables in <em>file_1</em> are <em>not</em> broadcast to conform to the dimensions in <em>file_2</em>. Thus, <strong>ncdiff</strong>, the number of dimensions, or <em>rank</em>, of any processed variable in <em>file_1</em> must be greater than or equal to the rank of the same variable in <em>file_2</em>. Furthermore, the size of all dimensions common to both <em>file_1</em> and <em>file_2</em> must be equal.</p><p>When computing anomalies from the mean it is often the case that <em>file_2</em> was created by applying an averaging operator to a file with the same dimensions as <em>file_1</em>, if not <em>file_1</em> itself. In these cases, creating <em>file_2</em> with <strong>ncra</strong> rather than <strong>ncwa</strong> will cause the <strong>ncdiff</strong> operation to fail. For concreteness say the record dimension in <strong>file_1</strong> is <strong>time</strong>. If <em>file_2</em> were created by averaging <em>file_1</em> over the <strong>time</strong> dimension with the <strong>ncra</strong> operator rather than with the <strong>ncwa</strong> operator, then <em>file_2</em> will have a <strong>time</strong> dimension of size 1 rather than having no <strong>time</strong> dimension at all In this case the input files to <strong>ncdiff</strong>, <em>file_1</em> and <em>file_2</em>, will have unequally sized <strong>time</strong> dimensions which causes <strong>ncdiff</strong> to fail. To prevent this from occuring, use <strong>ncwa</strong> to remove the <strong>time</strong> dimension from <em>file_2</em>. An example is given below.</p><p><strong>ncdiff</strong> will never difference coordinate variables or variables of type <strong>NC_CHAR</strong> or <strong>NC_BYTE</strong>. This ensures that coordinates like (e.g., latitude and longitude) are physically meaningful in the output file, <em>file_3</em>. This behavior is hardcoded. <strong>ncdiff</strong> applies special rules to some NCAR CSM fields (e.g., <strong>ORO</strong>). See <em>NCAR CSM Conventions</em> for a complete description. Finally, we note that <strong>ncflint</strong> (ncflint netCDF File Interpolator) can be also perform file subtraction (as well as addition, multiplication and interpolation).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Say files <strong>85_0112.nc</strong> and <strong>86_0112.nc</strong> each contain 12 months of data. Compute the change in the monthly averages from 1985 to 1986:</p><p>ncdiff 86_0112.nc 85_0112.nc 86m85_0112.nc</p><p>The following examples demonstrate the broadcasting feature of <strong>ncdiff</strong>. Say we wish to compute the monthly anomalies of <strong>T</strong> from the yearly average of <strong>T</strong> for the year 1985. First we create the 1985 average from the monthly data, which is stored with the record dimension <strong>time</strong>.</p><p>ncra 85_0112.nc 85.nc</p><p>ncwa -O -a time 85.nc 85.nc</p><p>The second command, <strong>ncwa</strong>, gets rid of the <strong>time</strong> dimension of size 1 that <strong>ncra</strong> left in <strong>85.nc</strong>. Now none of the variables in <strong>85.nc</strong> has a <strong>time</strong> dimension. A quicker way to accomplish this is to use <strong>ncwa</strong> from the beginning:</p><p>ncwa -a time 85_0112.nc 85.nc</p><p>We are now ready to use <strong>ncdiff</strong> to compute the anomalies for 1985:</p><p>ncdiff -v T 85_0112.nc 85.nc t_anm_85_0112.nc</p><p>Each of the 12 records in <strong>t_anm_85_0112.nc</strong> now contains the monthly deviation of <strong>T</strong> from the annual mean of <strong>T</strong> for each gridpoint.</p><p>Say we wish to compute the monthly gridpoint anomalies from the zonal annual mean. A <em>zonal mean</em> is a quantity that has been averaged over the longitudinal (or <em>x</em>) direction. First we use <strong>ncwa</strong> to average over longitudinal direction <strong>lon</strong>, creating <strong>xavg_85.nc</strong>, the zonal mean of <strong>85.nc</strong>. Then we use <strong>ncdiff</strong> to subtract the zonal annual means from the monthly gridpoint data:</p><p>ncwa -a lon 85.nc xavg_85.nc</p><p>ncdiff 85_0112.nc xavg_85.nc tx_anm_85_0112.nc</p><p>Assuming <strong>85_0112.nc</strong> has dimensions <strong>time</strong> and <strong>lon</strong>, this example only works if <strong>xavg_85.nc</strong> has no <strong>time</strong> or <strong>lon</strong> dimension.</p><p>As a final example, say we have five years of monthly data (i.e., 60 months) stored in <strong>8501_8912.nc</strong> and we wish to create a file which contains the twelve month seasonal cycle of the average monthly anomaly from the five-year mean of this data. The following method is just one permutation of many which will accomplish the same result. First use <strong>ncwa</strong> to create the file containing the five-year mean:</p><p>ncwa -a time 8501_8912.nc 8589.nc</p><p>Next use <strong>ncdiff</strong> to create a file containing the difference of each month's data from the five-year mean:</p><p>ncdiff 8501_8912.nc 8589.nc t_anm_8501_8912.nc</p><p>Now use <strong>ncks</strong> to group the five January anomalies together in one file, and use <strong>ncra</strong> to create the average anomaly for all five Januarys. These commands are embedded in a shell loop so they are repeated for all twelve months:</p><p>foreach idx (01 02 03 04 05 06 07 08 09 10 11 12)</p><p>ncks -F -d time,,,12 t_anm_8501_8912.nc foo.</p><p>ncra foo. t_anm_8589_.nc</p><p>end</p><p>Note that <strong>ncra</strong> understands the <strong>stride</strong> argument so the two commands inside the loop may be combined into the single command</p><p>ncra -F -d time,,,12 t_anm_8501_8912.nc foo.</p><p>Finally, use <strong>ncrcat</strong> to concatenate the 12 average monthly anomaly files into one twelve-record file which contains the entire seasonal cycle of the monthly anomalies:</p><p>ncrcat t_anm_8589_??.nc t_anm_8589_0112.nc</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p><strong>NCO</strong> manual pages written by Charlie Zender and originally formatted by Brian Mays.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">
<p>Report bugs to &lt;http://sf.net/bugs/?group_id=3331&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 1995-2012 Charlie Zender</p><p>This is free software; see the source for copying conditions.  There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO ncdiff&hellip;</h2>
        <div class="sectioncontent">
<p>The full documentation for <strong>NCO</strong> is maintained as a Texinfo manual called the <strong>NCO User's Guide.</strong> Because <strong>NCO</strong> is mathematical in nature, the documentation includes TeX-intensive portions not viewable on character-based displays. Hence the only complete and authoritative versions of the <strong>NCO User's Guide</strong> are the PDF (recommended), DVI, and Postscript versions at &lt;http://nco.sf.net/nco.pdf&gt;, &lt;http://nco.sf.net/nco.dvi&gt;, and &lt;http://nco.sf.net/nco.ps&gt;, respectively. HTML and XML versions are available at &lt;http://nco.sf.net/nco.html&gt; and &lt;http://nco.sf.net/nco.xml&gt;, respectively.</p><p>If the <strong>info</strong> and <strong>NCO</strong> programs are properly installed at your site, the command</p><ul>
<li><p><strong>info nco</strong></p></li>
</ul><p>should give you access to the complete manual, except for the TeX-intensive portions.</p><p><a href="../man1/ncap.1.html"><strong>ncap</strong>(1)</a>, <a href="../man1/ncap2.1.html"><strong>ncap2</strong>(1)</a>, <a href="../man1/ncatted.1.html"><strong>ncatted</strong>(1)</a>, <a href="../man1/ncbo.1.html"><strong>ncbo</strong>(1)</a>, <a href="../man1/nces.1.html"><strong>nces</strong>(1)</a>, <a href="../man1/ncecat.1.html"><strong>ncecat</strong>(1)</a>, <a href="../man1/ncflint.1.html"><strong>ncflint</strong>(1)</a>, <a href="../man1/ncks.1.html"><strong>ncks</strong>(1)</a>, <a href="../man1/nco.1.html"><strong>nco</strong>(1)</a>, <a href="../man1/ncpdq.1.html"><strong>ncpdq</strong>(1)</a>, <a href="../man1/ncra.1.html"><strong>ncra</strong>(1)</a>, <a href="../man1/ncrcat.1.html"><strong>ncrcat</strong>(1)</a>, <a href="../man1/ncrename.1.html"><strong>ncrename</strong>(1)</a>, <a href="../man1/ncwa.1.html"><strong>ncwa</strong>(1)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HOMEPAGE</h2>
        <div class="sectioncontent">
<p>The <strong>NCO</strong> homepage at &lt;http://nco.sf.net&gt; contains more information.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="nccnavi.1.html"><span aria-hidden="true">&larr;</span> nccnavi.1: Explore the output of nccgen on a text-mode console</a></li>
   <li class="next"><a href="ncdt.1.html">ncdt.1: Directory tree printer with extended capabilities <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
