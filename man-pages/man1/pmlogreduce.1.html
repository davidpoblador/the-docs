<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pmlogreduce - temporal reduction of Performance Co-Pilot archives</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Temporal reduction of performance co-pilot archives">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pmlogreduce<small> (1)</small></h1>
        <p class="lead">Temporal reduction of performance co-pilot archives</p>
      </div>

    <ol class="breadcrumb">
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="/"><span itemprop="title">Carta.tech</span></a>
	</li>
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="https://www.carta.tech/man-pages/"><span itemprop="title">man-pages</span></a>
	</li>
	<li id="breadcrumb_section" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_page" itemprop="child">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man1/"><span itemprop="title">Executable programs or shell commands</span></a>
	</li>
	<li id="breadcrumb_page" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="active">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man1/pmlogreduce.1.html"><span itemprop="title">pmlogreduce</span></a>
	</li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p>\f3$PCP_BINADM_DIR/pmlogreduce\f1 [\f3-z\f1] [\f3-A\f1 \f2align\f1] [\f3-S\f1 \f2starttime\f1] [\f3-s\f1 \f2samples\f1] [\f3-T\f1 \f2endtime\f1] [\f3-t\f1 \f2interval\f1] [\f3-v\f1 \f2volsamples\f1] [\f3-Z\f1 \f2timezone\f1] \f2input\f1 \f2output\f1</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p><strong>pmlogreduce</strong> reads one set of Performance Co-Pilot (PCP) archives identified by <em>input</em> and creates a temporally reduced PCP archive in <em>output</em>. <em>input</em> is a comma-separated list of names, each of which may be the base name of an archive or the name of a directory containing one or more archives. The data reduction involves statistical and temporal reduction of samples with an output sampling interval defined by the <strong>-t</strong> option in the <em>output</em> archive (independent of the sampling intervals in the <em>input</em> archives), and is further controlled by other command line arguments.</p>
<p class='spacer'>

<p>For some metrics, temporal data reduction is not going to be helpful, so for metrics with types <strong>PM_TYPE_AGGREGATE</strong> or <strong>PM_TYPE_EVENT</strong>, a warning is issued if these metrics are found in <em>input</em> and they will be skipped and not appear in the <em>output</em> archive.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMMAND LINE OPTIONS</h2>
        <div class="sectioncontent">

<p>The command line options for <strong>pmlogreduce</strong> are as follows:</p>
<p class='spacer'>

  <dl class='dl-vertical'>
    <dt><strong>-A</strong><em> align</em></dt>
    <dd>
  <p>Specify a ``natural'' alignment of the output sample times; refer to <strong>PCPIntro</strong>(1).</p>
    </dd>
  </dl>
<p class='spacer'>

  <dl class='dl-vertical'>
    <dt><strong>-S</strong><em> starttime</em></dt>
    <dd>
  <p>Define the start of a time window to restrict the samples retrieved from the <em>input</em> archives; refer to <strong>PCPIntro</strong>(1).</p>
    </dd>
  </dl>
<p class='spacer'>

  <dl class='dl-vertical'>
    <dt><strong>-s</strong><em> samples</em></dt>
    <dd>
  <p>The argument <em>samples</em> defines the number of samples to be written to <em>output</em>. If <em>samples</em> is 0 or <strong>-s</strong> is not specified, <strong>pmlogreduce</strong> will sample until the end of the set of PCP archives, or the end of the time window as specified by <strong>-T</strong>, whichever comes first.  The <strong>-s</strong> option will override the <strong>-T</strong> option if it occurs sooner.</p>
    </dd>
  </dl>
<p class='spacer'>

  <dl class='dl-vertical'>
    <dt><strong>-T</strong><em> endtime</em></dt>
    <dd>
  <p>Define the termination of a time window to restrict the samples retrieved from the <em>input</em> archives; refer to <strong>PCPIntro</strong>(1).</p>
    </dd>
  </dl>
<p class='spacer'>

  <dl class='dl-vertical'>
    <dt><strong>-v</strong><em> volsamples</em></dt>
    <dd>
    <p>The <em>output</em> archive is potentially a multi-volume data set, and the <strong>-v</strong> option causes <strong>pmlogreduce</strong> to start a new volume after <em>volsamples</em> log records have been written to the <em>output</em> archive.</p>
<p class='spacer'>

  <p>Independent of any <strong>-v</strong> option, each volume of an archive is limited to no more than 2^31 bytes, so <em>pmlogreduce</em> will automatically create a new volume for the archive before this limit is reached.</p>
    </dd>
  </dl>
<p class='spacer'>

  <dl class='dl-vertical'>
    <dt><strong>-t</strong><em> interval</em></dt>
    <dd>
  <p>Consecutive samples in the <em>output</em> archive will appear with a time delta defined by <em>interval</em>; refer to <strong>PCPIntro</strong>(1). Note the default value is 600 (seconds, i.e. 10 minutes).</p>
    </dd>
  </dl>
<p class='spacer'>

  <dl class='dl-vertical'>
    <dt><strong>-Z</strong><em> timezone</em></dt>
    <dd>
  <p>Use <em>timezone</em> when displaying the date and time, or interpreting the <strong>-S</strong> and <strong>-T</strong> options. <em>Timezone</em> is in the format of the environment variable <strong>TZ</strong> as described in <a href="../man7/environ.7.html"><strong>environ</strong>(7)</a>.</p>
    </dd>
  </dl>
<p class='spacer'>

  <dl class='dl-vertical'>
    <dt><strong>-z</strong></dt>
    <dd>
  <p>Use the local timezone of the host from the <em>input</em> archives when displaying the date and time, or interpreting the <strong>-S</strong> and <strong>-T</strong> options. The default is to initially use the timezone of the local host.</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DATA REDUCTION</h2>
        <div class="sectioncontent">

<p class='spacer'>

  <p>The statistical and temporal reduction follows the following rules:</p>
  <dl class='dl-horizontal'>
    <dt>1.</dt>
    <dd>
  <p>Consecutive records from <em>input</em> are read without interpolation, and at most one output record is written for each <em>interval</em>, summarizing the performance data over that period.</p>
    </dd>
    <dt>2.</dt>
    <dd>
  <p>If the semantics of a metric indicates it is <strong>instantaneous</strong> or <strong>discrete</strong> then <em>output</em> value is computed as the arithmetic mean of the observations (if any) over each <em>interval</em>.</p>
    </dd>
    <dt>3.</dt>
    <dd>
      <p>If the semantics of a metric indicates it is a <strong>counter</strong> then the following transformations are applied:</p>
      <dl class='dl-horizontal'>
        <dt>a)</dt>
        <dd>
      <p>Metrics with 32-bit precision are promoted to 64-bit precision.</p>
        </dd>
        <dt>b)</dt>
        <dd>
      <p>Any counter wrap (overflow) is noted, and appropriate adjustment made in the value of the metric over each <em>interval</em>. This will be correct in the case of a single counter wrap, but will silently <strong>underestimate</strong> in the case where more than one counter wrap occurs between consecutive observations in the <em>input</em> archives, and silently <strong>overestimate</strong> in the case where a counter is reset occurs between consecutive observations in the <em>input</em> archives; unfortunately these situations cannot be detected, but are believed to be rare events for the sort of production monitoring environments where <strong>pmlogreduce</strong> is most likely to be deployed.</p>
        </dd>
      </dl>
    </dd>
    <dt>4.</dt>
    <dd>
  <p>Any changes in instance domains, and indeed all metadata, is preserved.</p>
    </dd>
    <dt>5.</dt>
    <dd>
  <p>Any ``mark'' records in the <em>input</em> archives (as created by <a href="../man1/pmlogextract.1.html"><strong>pmlogextract</strong>(1)</a>) will be preserved in the <em>output</em> archive, so periods where no data is available are maintained, and data interpolation will <strong>not</strong> occur across these periods when the <em>output</em> archive is subsequently processed with PCP applications.</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

  <p>For each of the <em>input</em> and <em>output</em> archives, several physical files are used.</p>
  <dl class='dl-vertical'>
    <dt>\f2archive\f3.meta</dt>
    <dd>
  <p>metadata (metric descriptions, instance domains, etc.) for the archive log</p>
    </dd>
    <dt>\f2archive\f3.0</dt>
    <dd>
  <p>initial volume of metrics values (subsequent volumes have suffixes <strong>1</strong>, <strong>2</strong>, ...) - for <em>input</em> these files may have been previously compressed with <strong>bzip2</strong>(1) or <a href="../man1/gzip.1.html"><strong>gzip</strong>(1)</a> and thus may have an additional <strong>.bz2</strong> or <strong>.gz</strong> suffix.</p>
    </dd>
    <dt>\f2archive\f3.index</dt>
    <dd>
  <p>temporal index to support rapid random access to the other files in the archive log.</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PCP ENVIRONMENT</h2>
        <div class="sectioncontent">

<p>Environment variables with the prefix <strong>PCP_</strong> are used to parameterize the file and directory names used by PCP. On each installation, the file <em>/etc/pcp.conf</em> contains the local values for these variables. The <strong>$PCP_CONF</strong> variable may be used to specify an alternative configuration file, as described in <strong>pcp.conf</strong>(5).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<p><strong>PCPIntro</strong>(1), <a href="../man1/pmdumplog.1.html"><strong>pmdumplog</strong>(1)</a>, <a href="../man1/pmlc.1.html"><strong>pmlc</strong>(1)</a>, <a href="../man1/pmlogextract.1.html"><strong>pmlogextract</strong>(1)</a>, <a href="../man1/pmlogger.1.html"><strong>pmlogger</strong>(1)</a>, <strong>pcp.conf</strong>(5) and <a href="../man5/pcp.env.5.html"><strong>pcp.env</strong>(5)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">

<p>All error conditions detected by <strong>pmlogreduce</strong> are reported on <em>stderr</em> with textual (if sometimes terse) explanation.</p>
<p class='spacer'>

<p>Should the <em>input</em> archives be corrupted (this can happen if the <strong>pmlogger</strong> instance writing the archive suddenly dies), then <strong>pmlogreduce</strong> will detect and report the position of the corruption in the file, and any subsequent information from the <em>input</em> archives will not be processed.</p>
<p class='spacer'>

<p>If any error is detected, <strong>pmlogreduce</strong> will exit with a non-zero status.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CAVEATS</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>The preamble metrics (pmcd.pmlogger.archive, pmcd.pmlogger.host, and pmcd.pmlogger.port), which are automatically recorded by <strong>pmlogger</strong> at the start of the archive, may not be present in the archive output by <strong>pmlogreduce</strong>. These metrics are only relevant while the archive is being created, and have no significance once recording has finished.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pmlogmv.1.html"><span aria-hidden="true">&larr;</span> pmlogmv.1: move (rename) Performance Co-Pilot archive files</a></li>
   <li class="next"><a href="pmlogsummary.1.html">pmlogsummary.1: calculate averages of metrics stored in a set of PCP archives <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
