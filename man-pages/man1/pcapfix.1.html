<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pcapfix: Repair pcap and pcapng files</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Repair pcap and pcapng files">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="pcapfix (1) manual">
  <meta name="twitter:description" content="Repair pcap and pcapng files">
  <meta name="twitter:image" content="https://www.carta.tech/images/pcapfix-pcapfix-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/pcapfix.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="pcapfix (1) manual" />
  <meta property="og:description" content="Repair pcap and pcapng files" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/pcapfix-pcapfix-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pcapfix<small> (1)</small></h1>
        <p class="lead">Repair pcap and pcapng files</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/pcapfix.1.html">
      <span itemprop="name">pcapfix: Repair pcap and pcapng files</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/pcapfix/">
      <span itemprop="name">pcapfix</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/pcapfix.1.html">
      <span itemprop="name">pcapfix: Repair pcap and pcapng files</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>pcapfix</strong> [-d] [-n] [-o filename] [-t DATA_LINK_TYPE] [-v] filename</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Pcapfix is a tool to repair your damaged or corrupted pcap and pcapng files. It is written in C and released under the GNU General Public License.</p><p>To fix your pcap files the tool first checks for an intact pcap global header and repairs it if there are some corrupted bytes. It there seems to be no global header at all, pcapfix adds a self-created one at the beginning of the file. In a second step the tool tries to find pcap packet headers inside the file, below the global header. It checks if the values are correct (or seem to be correct) and tries to repair a packet if there is something wrong.</p><p>To fix your pcapng files the tool loops through all packet headers that can be found in the file. It checks for mandatory Section Header and Interface Description Block and creates them if missing. Pcapfix checks for correct block sizes and valid option fields. If something is wrong, invalid fields are repaired (if possible) or skipped and adjusted to finally get a proper pcapng file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>-d, --deep-scan</p>
  </dt>
  <dd>
    <p>Force deep scan (default = 0)</p><p>This option will force pcapfix to scan for any packet inside the whole file (instead of the first 65535 bytes only).</p>
  </dd>
  <dt>
    <p>-n, --pcapng</p>
  </dt>
  <dd>
    <p>Force File Format to PCAPNG (default = 0)</p><p>This option will force pcapfix to repair the input file as it were in pcapng format (useful for destroyed file headers).</p>
  </dd>
  <dt>
    <p>-o, --outfile &lt;filename&gt;</p>
  </dt>
  <dd>
    <p>Set the output file name. Default will be input file prepended by "fixed_".</p>
  </dd>
  <dt>
    <p>-t, --data-link-type &lt;nr&gt;</p>
  </dt>
  <dd>
    <p>Data Link Type (default = 1)</p><p>(See NOTES section below.)</p>
  </dd>
  <dt>
    <p>-v, --verbose</p>
  </dt>
  <dd>
    <p>Enable verbose output (default = 0)</p><p>You can use multiple -v options to increase verbosity.</p><p>An verbosity of 2 will result in very much output data during package search.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>Repair the pcap file using deep scan mode, because large blocks of the file are corrupted.</p>
  </dt>
  <dd>
    <p>pcapfix -d file.pcap</p>
  </dd>
  <dt>
    <p>Repair the file damaged_file.pcapng using verbose output.</p>
  </dt>
  <dd>
    <p>pcapfix -v damaged_file.pcapng</p>
  </dd>
  <dt>
    <p>Repair the file wlan_traffic.pcap and force the data link type to be 119 (PRISM HEADER).</p>
  </dt>
  <dd>
    <p>pcapfix -t 119 wlan_traffic.pcap</p>
  </dd>
  <dt>
    <p>Repair the file damaged.pcapng which file header is corrupted and force its format to be pcapng.</p>
  </dt>
  <dd>
    <p>pcapfix -n damaged.pcapng</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>Deep scan</em></p>
  </dt>
  <dd>
    <p>In classic pcap files, pcapfix will only scan the first 65536 bytes (maximum packet length) for a proper first packet. If you want to force packet detection even above this limit (e.g. because your file has been heavily destroyed) you can use the deep scan option (-d).</p><p>This option is not necessary for pcapng files because the whole file is arranged in blocks that are 'unlimited' by default. In result pcapfix will always scan the whole pcapng file for further blocks.</p>
  </dd>
  <dt>
    <p><em>PCAPNG Format</em></p>
  </dt>
  <dd>
    <p>Pcapfix will try to identify the file format to repair (pcap / pcapng) before doing any further checks. If the header itself is corrupted, it will assume the format to be classic pcap. To change this behaviour you can force the tool to do a pcapng-repair by supplying -n (--pcapng) option.</p>
  </dd>
  <dt>
    <p><em>Verbosity</em></p>
  </dt>
  <dd>
    <p>You can use multiple -v options to increase verbosity. An verbosity of 2 will result in very much output data during package search.</p>
  </dd>
  <dt>
    <p><em>ASCII-mode transferred Files (FTP)</em></p>
  </dt>
  <dd>
    <p>Pcapfix is able to repair pcap files that have been transferred in ascii-mode via FTP. In those files a proper pcap structure will be created only to make them readable by wireshark etc. The data inside the packets (and some pcap headers) might still be corrupted. To repair those packets a deeper look inside the packet structure (e.g. checksum) will be necessary.</p>
  </dd>
  <dt>
    <p><em>Data Link Types</em></p>
  </dt>
  <dd>
    <p>You can make pcapfix change / select your data link type by supplying -t option. Although you may select a data link type number between 0 and 255, only the following types are assigned: If the data link type field is corrupt, pcapfix will selct LINKTYPE_ETHERNET by default.</p><p>See http://www.tcpdump.org/linktypes.html for futher information.</p><p>NUMBER	LINK_TYPE</p><p>0	LINKTYPE_NULL</p><p>1	LINKTYPE_ETHERNET</p><p>6	LINKTYPE_TOKEN_RING</p><p>7	LINKTYPE_ARCNET_BSD</p><p>8	LINKTYPE_SLIP</p><p>9	LINKTYPE_PPP</p><p>10	LINKTYPE_FDDI</p><p>50	LINKTYPE_PPP_HDLC</p><p>51	LINKTYPE_PPP_ETHER</p><p>100	LINKTYPE_ATM_RFC1483</p><p>101	LINKTYPE_RAW</p><p>104	LINKTYPE_C_HDLC</p><p>105	LINKTYPE_IEEE802_11</p><p>107	LINKTYPE_FRELAY</p><p>108	LINKTYPE_LOOP</p><p>113	LINKTYPE_LINUX_SLL</p><p>114	LINKTYPE_LTALK</p><p>117	LINKTYPE_PFLOG</p><p>119	LINKTYPE_PRISM_HEADER</p><p>122	LINKTYPE_IP_OVER_FC</p><p>123	LINKTYPE_SUNATM</p><p>127	LINKTYPE_IEEE802_11_RADIO</p><p>129	LINKTYPE_ARCNET_LINUX</p><p>138	LINKTYPE_APPLE_IP_OVER_IEEE1394</p><p>139	LINKTYPE_MTP2_WITH_PHDR</p><p>140	LINKTYPE_MTP2</p><p>141	LINKTYPE_MTP3</p><p>142	LINKTYPE_SCCP</p><p>143	LINKTYPE_DOCSIS</p><p>144	LINKTYPE_LINUX_IRDA</p><p>147-162	LINKTYPE_USER0-LINKTYPE-USER15</p><p>163	LINKTYPE_IEEE802_11_RADIO_AVS</p><p>166	LINKTYPE_PPP_PPPD</p><p>169	LINKTYPE_GPRS_LLC</p><p>177	LINKTYPE_LINUX_LAPD</p><p>187	LINKTYPE_BLUETOOTH_HCI_H4</p><p>189	LINKTYPE_USB_LINUX</p><p>192	LINKTYPE_PPI</p><p>195	LINKTYPE_IEEE802_15_4</p><p>196	LINKTYPE_SITA</p><p>197	LINKTYPE_ERF</p><p>201	LINKTYPE_BLUETOOTH_HCI_H4_WITH_PHDR</p><p>202	LINKTYPE_AX25_KISS</p><p>203	LINKTYPE_LAPD</p><p>204	LINKTYPE_PPP_WITH_DIR</p><p>205	LINKTYPE_C_HDLC_WITH_DIR</p><p>206	LINKTYPE_FRELAY_WITH_DIR</p><p>209	LINKTYPE_IPMB_LINUX</p><p>215	LINKTYPE_IEEE802_15_4_NONASK_PHY</p><p>220	LINKTYPE_USB_LINUX_MMAPPED</p><p>224	LINKTYPE_FC_2</p><p>225	LINKTYPE_FC_2_WITH_FRAME_DELIMS</p><p>226	LINKTYPE_IPNET</p><p>227	LINKTYPE_CAN_SOCKETCAN</p><p>228	LINKTYPE_IPV4</p><p>229	LINKTYPE_IPV6</p><p>230	LINKTYPE_IEEE802_15_4_NOFCS</p><p>231	LINKTYPE_DBUS</p><p>235	LINKTYPE_DVB_CI</p><p>236	LINKTYPE_MUX27010</p><p>237	LINKTYPE_STANAG_5066_D_PDU</p><p>239	LINKTYPE_NFLOG</p><p>240	LINKTYPE_NETANALYZER</p><p>241	LINKTYPE_NETANALYZER_TRANSPARENT</p><p>242	LINKTYPE_IPOIB</p><p>243	LINKTYPE_MPEG_2_TS</p><p>244	LINKTYPE_NG40</p><p>245	LINKTYPE_NFC_LLCP</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DEVELOPMENT</h2>
        <div class="sectioncontent">
<p>This tool is still under development! Please send any further wishes, feature requests or problems in compiling and execution to ruport@f00l.de. Additionally You may send me pcap/pcapng files that could not be repaired too in order to improve pcapfix and get your file repaired.</p><p>For further information visit the pcapfix homepage at http://f00l.de/pcapfix/.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MESSAGES AND EXIT CODES</h2>
        <div class="sectioncontent">
<p> 1	, file was corrupted and has been repaired</p><p> 0	, file is proper; nothing to repair</p><p>-1	, invalid options / parameters given</p><p>-2	, cannot open input file for reading</p><p>-3	, cannot open output file for writing</p><p>-4	, input file is empty</p><p>-5	, input file is too small</p><p>-6	, file type not supported</p><p>-11	, not a pcap/pcapng file</p><p>-12	, unable to repair the file</p><p>-13	, EOF while reading input file</p><p>-255	, unknown error</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>1.1.0 - 31.08.2013</p>
  </dt>
  <dd>
    <p>* added checks for valid pcapng format (epb)</p><p>* added --outfile parameter to chose fixed file name</p><p>* improved pcapng packet alignment (pb, spb, nrb)</p><p>* improved pcapng option fields handling</p><p>* improved status and verbosity outputs</p><p>* fixed reparation bugs with swapped pcap files</p><p>* fixed MacOS compile problem</p><p>* fixed windows output file name extension missing</p><p>* fixed many minor bugs</p>
  </dd>
  <dt>
    <p>1.0.2 - 18.02.2013</p>
  </dt>
  <dd>
    <p>* added support for files larger than 2GB on 32bit systems</p>
  </dd>
  <dt>
    <p>1.0.1 - 03.11.2013</p>
  </dt>
  <dd>
    <p>* added reparation block type id zero (pcapng)</p><p>* added reparation of capture length inside EPB (pcapng)</p><p>* set data link type to ethernet on missing header (pcap)</p><p>* changed missing pcap header threshold</p><p>* fixed minor bugs</p>
  </dd>
  <dt>
    <p>1.0.0 - 12.10.2013</p>
  </dt>
  <dd>
    <p>* added pcapng support</p><p>* added nanoseconds support (Issue #1)</p><p>* improved console output</p><p>* minor bugs fixed</p>
  </dd>
  <dt>
    <p>0.7.3 - 16.06.2013</p>
  </dt>
  <dd>
    <p>* added snoop file detection</p><p>* added large file support on 32bit architectures</p><p>* improved missing header detection</p><p>* fixed compiling errors on hurd and kfreebsd architectures</p><p>* fixed minor bugs</p>
  </dd>
  <dt>
    <p>0.7.2 - 30.03.2013</p>
  </dt>
  <dd>
    <p>* compiles on Apple systems properly now</p><p>* fixed problems installing man-pages (on some systems)</p>
  </dd>
  <dt>
    <p>0.7.1 - 03.01.2013</p>
  </dt>
  <dd>
    <p>* REALLY fixed file pointer exception on windows64 systems</p><p>* updated man-page</p>
  </dd>
  <dt>
    <p>0.7 - 18.10.2012</p>
  </dt>
  <dd>
    <p>* added support for swapped (big endian) pcap files</p><p>* compiles on OpenBSD properly now</p><p>* fixed file pointer exception on windows64 systems</p><p>* fixed detection bug when corrupted packet is larger than 65536 bytes</p><p>* fixed minimal packet limit to cope with wlan traffic</p>
  </dd>
  <dt>
    <p>0.6 - 20.05.2012</p>
  </dt>
  <dd>
    <p>* added deep scan option (-d) to force packet detection inside the whole file</p><p>* detects ascii-corruption in pcap header (unix-&gt;win)</p><p>* improved global header and packet checks (0 &lt;= usec &lt;= 1000000)</p><p>* repair files that first packet is entirely corrupted</p><p>* repair oversized packets</p><p>* improved last packet mismatch correction</p><p>* fixed reading packets over EOF</p>
  </dd>
  <dt>
    <p>0.5 - 05.05.2012</p>
  </dt>
  <dd>
    <p>* repair files that packets were not saved chronologically</p><p>* detect and repair overlapping packets</p><p>* detect and repair cut-off pcap files</p><p>* detect and repair ascii-mode transferred pcap files (pcap headers only!)</p><p>* added progress bar</p><p>* added man-page</p>
  </dd>
  <dt>
    <p>0.4 - 27.04.2012</p>
  </dt>
  <dd>
    <p>* completely redesigned packet detection algorithm (replaced bottom-up-recovery with brute-force-packet-guessing)</p><p>* improved detection rate by additional plausability checks</p><p>* increased speed when repairing large pcap files</p>
  </dd>
  <dt>
    <p>0.3 - 31.03.2012</p>
  </dt>
  <dd>
    <p>* when recovering packets size will be checked to be smaller than 65536</p><p>* added recognition when a file does not seem to be a pcap file at all</p><p>* compiles on windows systems properly now (tested with dev-cpp)</p><p>* added option to manually select data link type</p>
  </dd>
  <dt>
    <p>0.2 - 11.03.2012</p>
  </dt>
  <dd>
    <p>* pcapfix compiles on 64bit systems correctly now</p><p>* fixed segfault when no filename was given</p><p>* fixed (input) file not found bug on directory differ</p><p>* added recognition of other data link types beside ethernet in global header</p><p>* added source code documentation</p>
  </dd>
  <dt>
    <p>0.1 - 01.03.2012</p>
  </dt>
  <dd>
    <p>* this is the first version, everything has changed thou :-)</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (c) 2012-2014 Robert Krause</p><p>Pcapfix is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or any later version.</p><p>Pcapfix is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Written by Robert Krause &lt;ruport@f00l.de&gt;.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pcapdump.1.html"><span aria-hidden="true">&larr;</span> pcapdump.1: Dedicated packet capture utility</a></li>
   <li class="next"><a href="pcapip.1.html">pcapip.1: Filter a pcap for ip addresses <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
