<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>fmttest: Test tool for the mh-format(5) language</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Test tool for the mh-format(5) language">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="fmttest (1mh) manual">
  <meta name="twitter:description" content="Test tool for the mh-format(5) language">
  <meta name="twitter:image" content="https://www.carta.tech/images/nmh-fmttest-1mh.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1mh/fmttest.1mh.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="fmttest (1mh) manual" />
  <meta property="og:description" content="Test tool for the mh-format(5) language" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/nmh-fmttest-1mh.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">fmttest<small> (1mh)</small></h1>
        <p class="lead">Test tool for the mh-format(5) language</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1mh/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1mh/fmttest.1mh.html">
      <span itemprop="name">fmttest: Test tool for the mh-format(5) language</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/nmh/">
      <span itemprop="name">nmh</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1mh/fmttest.1mh.html">
      <span itemprop="name">fmttest: Test tool for the mh-format(5) language</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>fmttest</strong> [<strong>-form</strong> <em>formatfile</em>] [<strong>-format</strong> <em>formatstring</em>] [<strong>-address</strong> | <strong>-raw</strong> | <strong>-date</strong> | <strong>-message</strong>] [<strong>-file</strong> | <strong>-nofile</strong>] [<strong>-\|-component</strong> <em>component-text</em>] [<strong>-dupaddrs</strong> | <strong>-nodupaddrs</strong>] [<strong>-ccme</strong> | <strong>-noccme</strong>] [<strong>-outsize</strong> <em>size-in-characters</em>] [<strong>-bufsize</strong> <em>size-in-bytes</em>] [<strong>-width</strong> <em>column-width</em>] [<strong>-msgnum</strong> <em>number</em>] [<strong>-msgcur</strong> <em>flag</em>] [<strong>-msgsize</strong> <em>size</em>] [<strong>-unseen</strong> <em>flag</em>] [<strong>-dump</strong> | <strong>-nodump</strong>] [<strong>-trace</strong> | <strong>-notrace</strong>] [<em>+folder</em>] [<em>msgs</em> | <em>strings</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>Fmttest</strong> is used to test programs written for the <strong>nmh</strong> format language as specified by <strong>mh-format</strong>(5). It is also intended to replace the <strong>ap</strong>, <strong>dp</strong>, and <strong>fmtdump</strong> programs.</p><h3>FORMAT PROGRAM SELECTION</h3>
<p>The <strong>-format</strong> <em>string</em> and <strong>-form</strong> <em>formatfile</em> switches may be used to specify a format string or a format file to read. If given a format string, it must be specified as a single argument to the <strong>-format</strong> switch.  If given a format file name with <strong>-form</strong>, the file is searched for using the normal <strong>nmh</strong> rules: absolute pathnames are accessed directly, tilde expansion is done on usernames, and files are searched for in the user's <em>Mail</em> directory as specified in their profile.  If not found there, the directory &ldquo;<em>/etc/nmh</em>&rdquo; is checked.</p>
<h3>MODE SELECTION AND COMPONENT SPECIFICATION</h3>
<p><strong>Fmttest</strong> has four operating modes: address mode, raw mode, date mode, and message mode.  These modes are selected by the <strong>-address</strong>, <strong>-raw</strong>, <strong>-date</strong>, and <strong>-message</strong> switches respectively.</p><p>Address mode treats every argument as an email address and processes it with nmh's email parser.  Each argument is processed with the specified format program with the parsed email address available as a special %{<em>text</em>} component escape, and the output from the program is printed on standard output. If there was an error parsing the email address the error message is stored in the %{<em>error</em>} component escape.  If no format program is given on the command line, the following default program is used:</p>
<pre>
%&lt;{error}%{error}: %{text}%|%(putstr(proper{text}))%&gt;
</pre>
<p>In this mode <strong>fmttest</strong> is equivalent to <em>ap</em>(8).</p><p>In raw mode, no processing of the specified arguments is done.  Each argument is run against the specified format program with the argument text available in the %{<em>text</em>} component.  You must specify a format with <strong>-form</strong> or <strong>-format</strong> when using raw mode.</p><p>Date mode is identical to raw mode, with one exception: if no format is specified, the following format string is used:</p>
<pre>
%&lt;(nodate{text})error: %{text}%|%(putstr(pretty{text}))%&gt;
</pre>
<p>Date mode is equivalent to <em>dp</em>(8).</p><p>In message mode the arguments to <strong>fmttest</strong> are interpreted as an optional folder and messages. <strong>Fmttest</strong> will read each specified message and make all of the components in the message available to the format program.  Also, the appropriate information for the %(<em>msg</em>), %(<em>cur</em>), %(<em>unseen</em>), and %(<em>size</em>) function escapes will be made available for each message.  If the <strong>-file</strong> switch is given, the arguments are interpreted as filenames instead of message numbers, but otherwise the behavior is the same (except that the %(<em>msg</em>), %(<em>cur</em>), and %(<em>unseen</em>) function escapes will not provide any useful information).</p><p>The default format used in address mode is the default format used by <strong>scan</strong>. The following command can replicate the functionality of the <strong>repl</strong> command.</p>
<pre>
fmttest -nodupaddrs -form replcomps -outsize max [+folder] message
</pre>
<p>Regardless of the mode, other components can be provided to the format program by the use of the <strong>-\|-component</strong> switch.  For example, the following program will test out the use of the &ldquo;<strong>encrypted</strong>&rdquo; component:</p>
<pre>
fmttest -\|-encrypted yes -message cur
</pre>
<p>In message mode components supplied on the command line will override components from messages.</p>
<h3>ADDITIONAL SWITCHES</h3>
<p>The <strong>-dupaddrs</strong> and <strong>-nodupaddrs</strong> switches control whether duplicate addresses are allowed or suppressed by the <strong>FORMATADDR</strong> instruction, which is used by the `%(<em>formataddr</em>)' function escape.  In normal operation duplicate addresses are only suppressed by <strong>repl</strong>.</p><p>The <strong>-ccme</strong> and <strong>-noccme</strong> switches control whether or not to count the user's local mailbox as a duplicate address.  This replicates the behavior of the <strong>-cc</strong> <em>me</em> switch to <strong>repl</strong>, and only applies if <strong>-nodupaddrs</strong> is in effect.</p><p>The <strong>-outsize</strong> switch controls the maximum number of printable characters that the format engine will produce.  Characters marked as non-printing by the format engine with `%(<em>zputlit</em>)', characters with zero width, and extra bytes that are part of a multibyte character are not counted against this total. Two special values are supported: &ldquo;<em>max</em>&rdquo;, which will set the value to the size of the output buffer, and &ldquo;<em>width</em>&rdquo;, which will set the value to the width of the terminal.  In message mode it defaults to the terminal width, otherwise the default is the output buffer size.</p><p>The <strong>-bufsize</strong> switch controls the size of the output buffer.  By default it is set to the size of the <strong>BUFSIZ</strong> C preprocessor symbol, which is system-dependent.</p><p>The <strong>-width</strong> switch controls the column width which is used by the `%(<em>width</em>)' function escape.  By default is set to the terminal width.</p><p>The <strong>-msgnum</strong>, <strong>-msgcur</strong>, <strong>-msgsize</strong>, and the <strong>-unseen</strong> switches all control the values used, respectively, by the following function escapes: `%(<em>num</em>)', `%(<em>cur</em>)', `%(<em>size</em>)', and `%(<em>unseen</em>)'. If none are supplied these values are taken from the message in message mode; in all other modes the default values are 0.</p>
<h3>COMPILING AND TRACING FORMAT PROGRAMS</h3>
<p>The <strong>-dump</strong> switch outputs the complete set of format instructions for the specified format program.  The <strong>-trace</strong> switch will output each format instruction as it is being executed, and show the values of the <em>num</em> and <em>str</em> registers if they have changed from the previous instruction. The output buffer is also printed if it has changed from the previous instruction.</p>
<h3>FORMAT INSTRUCTIONS</h3>
<p>It should be noted that there is not a one-to-one correspondence between format escapes and format instructions; many instructions have side effects.  Instructions prefixed with &ldquo;<em>LV</em>&rdquo; generally return a integer into the <em>num</em> (value) register; instructions prefixed with a &ldquo;<em>LS</em>&rdquo; return a string into the <em>str</em> register.</p>
<pre>
<em>Instruction	Description</em>
COMP	Output component
COMPF	Formatted output component
LIT	Output literal text
LITF	Formatted literal text output
CHAR	Output single character
NUM	Output the <em>num</em> register
NUMF	Formatted output of the <em>num</em> register
STR	Output the <em>str</em> register
STRF	Formatted output of the <em>str</em> register
STRFW	Not used
PUTADDR	Output address list in <em>str</em> register
STRLIT	Output <em>str</em>, no space compression
STRLITZ	Like <strong>STRLIT</strong>, but not counted against width
LS_COMP	Write component to <em>str</em> register
LS_LIT	Write literal to <em>str</em> register
LS_GETENV	Write environment var to <em>str</em> register
LS_DECODECOMP	Decode RFC 2047 encoded component to <em>str</em> register
LS_DECODE	Decode RFC 2047 encoded string to <em>str</em> register
LS_TRIM		Trim trailing whitespace from <em>str</em> register
LV_COMP		Convert component to integer, store in <em>num</em> register
LV_COMPFLAG	Set <em>num</em> to 1 if <strong>TRUE</strong> set in component
LV_LIT	Load literal value into <em>num</em> register
LV_DAT	Load value from <em>dat</em> array into <em>num</em> register (see note)
LV_STRLEN	Set <em>num</em> to the length of <em>str</em>
LV_PLUS_L	Add value to <em>num</em> register
LV_MINUS_L	Substract value from <em>num</em> register
LV_DIVIDE_L	Divide <em>num</em> register by value
LV_MODULO_L	<em>num</em> modulo value
LV_CHAR_LEFT	Store remaining number of printable chars in <em>num</em>
LS_MONTH	Write short name of month to <em>str</em> from date component
LS_LMONTH	Write long name of month to <em>str</em> from date component
LS_ZONE		Write time zone offset to <em>str</em> from date component
LS_DAY		Write short name of day of week to <em>str</em> from date component
LS_WEEKDAY	Write long name of day of week to <em>str</em> from date component
LS_822DATE	Write RFC 822 compatible date to <em>str</em> from date component
LS_PRETTY	Write date with &ldquo;pretty&rdquo; timezone to <em>str</em>
LV_SEC	Write date component seconds to <em>num</em>
LV_MIN	Write date component minutes to <em>num</em>
LV_HOUR	Write date component hour to <em>num</em>
LV_MON	Write date component numeric month to <em>num</em> (start at 1)
LV_YEAR	Write date component year to <em>num</em>
LV_YDAY	Write date component Julian day to <em>num</em>
LV_WDAY	Write date component day of week to <em>num</em> (0 == Sunday)
LV_ZONE	Write date component time zone offset to <em>num</em>
LV_CLOCK	Write date component in Unix epoch time to <em>num</em>
LV_RCLOCK	Write offset of date component from current time to <em>num</em>
LV_DAYF	Write 1 to <em>num</em> if day of week is explicit
LV_DST	Write 1 to <em>num</em> if DST is in effect for date component
LV_ZONEF	Write 1 to <em>num</em> if timezone is explicit
LS_ADDR	Write email address of addr component to <em>str</em>
LS_PERS	Write personal name of addr component to <em>str</em>
LS_MBOX	Write mailbox (username) of addr component to <em>str</em>
LS_HOST	Write host of addr component to <em>str</em>
LS_PATH	Write host route of addr component to <em>str</em>
LS_GNAME	Write group name of addr component to <em>str</em>
LS_NOTE	Write note portion of addr component to <em>str</em>
LS_822ADDR	Write &ldquo;proper&rdquo; RFC 822 version of addr component to <em>str</em>
LS_FRIENDLY	Write friendly (name or note) of address component to <em>str</em>
LS_UNQUOTE	Remove RFC 2822 quotes from string
LV_HOSTTYPE	Set <em>num</em> to type of host (0=local, 1=network)
LV_INGRPF	Set <em>num</em> to 1 if address was inside of group
LV_NOHOSTF	Set <em>num</em> to 1 of no host was present in address component
LOCALDATE	Convert date component to local timezone
GMTDATE	Convert date component to GMT
PARSEDATE	Parse date component
PARSEADDR	Parse address component
FORMATADDR	Add address component to list in <em>str</em>
CONCATADDR	Like <strong>FORMATADDR</strong>, but will not suppress duplicates
MYMBOX	Set <em>num</em> if address component is a local address
SAVESTR		Save <em>str</em> register temporarily
DONE	End program
NOP	No operation
GOTO	Jump to new instruction
IF_S_NULL	Branch if <em>str</em> is <strong>NULL</strong>
IF_S	Branch if <em>str</em> is not <strong>NULL</strong>
IF_V_EQ	Branch if <em>num</em> is equal to value
IF_V_NE	Branch if <em>num</em> is not equal to value
IF_V_GT	Branch if <em>num</em> is greater than value
IF_MATCH	Branch if <em>str</em> contains string
IF_AMATCH	Branch if <em>str</em> starts with string
S_NULL	Set <em>num</em> to 1 if <em>str</em> is <strong>NULL</strong>
S_NONNULL	Set <em>num</em> to 1 if <em>str</em> is not <strong>NULL</strong>
V_EQ	Set <em>num</em> to 1 if <em>num</em> equals value
V_NE	Set <em>num</em> to 1 if <em>num</em> does not equal value
V_GT	Set <em>num</em> to 1 if <em>num</em> is greater than value
V_MATCH	Set <em>num</em> to 1 if <em>str</em> contains string
V_AMATCH	Set <em>num</em> to 1 if <em>str</em> starts with string
</pre>
<p>The <strong>LV_DAT</strong> instruction is a bit special.  Callers of the format library pass in an array of integers that are used by certain format escapes.  The current list of format escapes and the indexes they use are:</p>
<pre>
dat[0]	%(<em>num</em>)
dat[1]	%(<em>cur</em>)
dat[2]	%(<em>size</em>)
dat[3]	%(<em>width</em>)
dat[4]	%(<em>unseen</em>)
</pre>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO fmttest&hellip;</h2>
        <div class="sectioncontent">
<p><strong>mh-format</strong>(5), <strong>repl</strong>(1), <em>ap</em>(8), <em>dp</em>(8),</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DEFAULTS</h2>
        <div class="sectioncontent">

<pre>
`<strong>-message</strong>'
`<strong>-nofile</strong>'
`<strong>-dupaddrs</strong>'
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>It shouldn't require as much code from other programs as it does.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="flist.1mh.html"><span aria-hidden="true">&larr;</span> flist.1mh: List the number of messages in given sequence(s)</a></li>
   <li class="next"><a href="folder.1mh.html">folder.1mh: Set/list current folder/message <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
