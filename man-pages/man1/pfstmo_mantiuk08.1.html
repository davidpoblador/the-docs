<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pfstmo_mantiuk08: Display adaptive tone mapping</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Display adaptive tone mapping">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="pfstmo_mantiuk08 (1) manual">
  <meta name="twitter:description" content="Display adaptive tone mapping">
  <meta name="twitter:image" content="https://www.carta.tech/images/pfstmo-pfstmo_mantiuk08-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/pfstmo_mantiuk08.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="pfstmo_mantiuk08 (1) manual" />
  <meta property="og:description" content="Display adaptive tone mapping" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/pfstmo-pfstmo_mantiuk08-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pfstmo_mantiuk08<small> (1)</small></h1>
        <p class="lead">Display adaptive tone mapping</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/pfstmo_mantiuk08.1.html">
      <span itemprop="name">pfstmo_mantiuk08: Display adaptive tone mapping</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/pfstmo/">
      <span itemprop="name">pfstmo</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/pfstmo_mantiuk08.1.html">
      <span itemprop="name">pfstmo_mantiuk08: Display adaptive tone mapping</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>pfstmo_mantiuk08</strong> [<strong>--display-function</strong> &lt;<em>df-spec</em>&gt;] [<strong>--display-size</strong>=&lt;<em>size-spec</em>&gt;] [<strong>--color-saturation</strong> &lt;<em>float</em>&gt;] [<strong>--contrast-enhancement</strong> &lt;<em>float</em>&gt;] [<strong>--white-y</strong>=&lt;<em>float</em>&gt;] [<strong>--temporal</strong>=&lt;<em>pass</em>&gt;] [<strong>--output-tone-curve</strong>=&lt;<em>file name</em>&gt;] [<strong>--verbose</strong>] [<strong>--help</strong>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This command applies the display adaptive tone mapping, which attempts to preserve contrast of an input (HDR) image as close as possible given the characteristic of an output display. Use this tone mapping operator if you want to preserve original image appearance, or slightly enhance contrast (-<strong>e</strong> option) while maintaining the natural look of images. The operator can also compensate for ambient light reflections on a screen, and for varying dynamic range and brightness of a display. More details can be found in:</p><ul>
<li><p>Rafal Mantiuk, Scott Daly and Louis Kerofsky.</p></li><li><p>Display Adaptive Tone Mapping.</p></li><li><p>In: ACM Transactions on Graphics 27 (3), 2008.</p></li><li><p>http://www.mpi-inf.mpg.de/resources/hdr/datmo/</p></li>
</ul><p>If you find this TMO useful in your research project, please cite the paper above. This operator also employs color correction mechanism from:</p><ul>
<li><p>Radoslaw Mantiuk, Rafal Mantiuk, Anna Tomaszewska, Wolfgang Heidrich.</p></li><li><p>Color Correction for Tone Mapping.</p></li><li><p>In: Computer Graphics Forum (Proc. of EUROGRAPHICS'09), 28(2), 2009.</p></li><li><p>http://zgk.wi.ps.pl/color_correction/</p></li>
</ul><p>The result of this TMO does not require gamma correction.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>--display-function</strong> &lt;<em>df-spec</em>&gt;, <strong>-d</strong> &lt;<em>df-spec</em>&gt;</p>
  </dt>
  <dd>
    <p>To adapt tone-mapping to different displays, this operator must be provided a display function. The display function describes how output luminance of a display changes with pixel values. If no parameter is given, the command assumes <strong>-df&nbsp;pd=lcd</strong> (see <em>Pre-defined</em> display below). There are several ways to specify the display function:</p>
  </dd>
  <dt>
    <p><em>Gamma-gain-black-ambient display model</em></p>
  </dt>
  <dd>
    <ul>
<li><p>g=&lt;float&gt;:l=&lt;float&gt;:b=&lt;float&gt;:k=&lt;float&gt;:a=&lt;float&gt;[:n=&lt;float&gt;]</p></li><li><p>Gamma-gain-black-ambient model can approximate a range of displays and is a compact way to specify a display function. It assumes that a display function has the following form:</p></li><li><p>L_d(I) = (l-b)*I^gamma + b + k/pi*a</p></li><li><p>The parameters are as follows:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>g</strong> -</p>
  </dt>
  <dd>
    <p>gamma or exponent of a display function (default 2.2, usually from 1.8 to 2.8)</p>
  </dd>
  <dt>
    <p><strong>l</strong> -</p>
  </dt>
  <dd>
    <p>peak luminance of a display in cd/m^2  (default 100, from 80 for CRTs to 500 or more for newer displays)</p>
  </dd>
  <dt>
    <p><strong>b</strong> -</p>
  </dt>
  <dd>
    <p>black level, which is luminance of a black pixel when the display is on (default 1, usually from 0.3 to 1 cd/m^2)</p>
  </dd>
  <dt>
    <p><strong>k</strong> -</p>
  </dt>
  <dd>
    <p>reflectivity of a screen (assuming that it is diffuse) (default 0.01, usually about 0.01 (1%) for LCD displays, more for CRTs)</p>
  </dd>
  <dt>
    <p><strong>a</strong> -</p>
  </dt>
  <dd>
    <p>ambient illumination in lux. Typical values are:</p>
<dl class='dl-vertical'>
  <dt>
    50
  </dt>
  <dd>
    <p>Family living room (dim, <strong>default</strong>)</p>
  </dd>
  <dt>
    400
  </dt>
  <dd>
    <p>A brightly lit office</p>
  </dd>
  <dt>
    32000
  </dt>
  <dd>
    <p>Sunlight on an average day (min.)</p>
  </dd>
  <dt>
    100000
  </dt>
  <dd>
    <p>Sunlight on an average day (max.)</p>
  </dd>

</dl>

  </dd>

</dl>
</li>
</ul>
  </dd>
  <dt>
    <p><em>Pre-defined display</em></p>
  </dt>
  <dd>
    <ul>
<li><p><strong>pd</strong>=<em>&lt;display_type&gt;</em><em></em></p></li><li><p>Use pre-defined display type. This options are for convenience only and they do not mean to accurately model the response of a particular display.  The following <em>display type</em>s are recognized:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>lcd_office</strong> (g=2.2, l=100, b=0.8, k=0.01, a=400 )</p>
  </dt>
  <dd>
    <p>lcd set to "office" mode seen in bright environment</p>
  </dd>
  <dt>
    <p><strong>lcd</strong>        (g=2.2, l=200, b=0.8, k=0.01, a=60  )</p>
  </dt>
  <dd>
    <p>typical lcd seen in dim environment (<strong>default</strong>)</p>
  </dd>
  <dt>
    <p><strong>lcd_bright</strong> (g=2.6, l=500, b=0.5, k=0.01, a=10  )</p>
  </dt>
  <dd>
    <p>newer LCD TV seen in dark environment</p>
  </dd>
  <dt>
    <p><strong>crt</strong>        (g=2.2, l=80,  b=1,   k=0.02, a=60  )</p>
  </dt>
  <dd>
    <p>CRT monitor seen in dim environment</p>
  </dd>

</dl>
</li><li><p>The parameters in the parenthesis are the same as for the gamma-gain-black-ambient model explained above.</p></li>
</ul>
  </dd>
  <dt>
    <p><em>Lookup-table</em></p>
  </dt>
  <dd>
    <ul>
<li><p><strong>lut</strong>=<em>&lt;file&gt;</em><em></em></p></li><li><p>This is the most accurate specification of the display response function, but requires measuring it with a luminance meter. The lookup table should account also for ambient light, so that it is recommended to use the luminance meter that can measure screen luminance from a distance, such as Minolta LS-100 (as opposed to those that use rubber tube touching a display that eliminates the influence of ambient light). The &lt;file&gt; must be a comma-separated text file in a format (CSV) with two columns: first column represents pixel values (from 0.0 to 1.0) and the second physical luminance in cd/m^2. Both the pixel value and the luminance should increase in each raw.</p></li>
</ul>
  </dd>
  <dt>
    <p><strong>--display-size</strong>=&lt;<em>size-spec</em>&gt;, <strong>-s</strong>=&lt;<em>size_spec</em>&gt;</p>
  </dt>
  <dd>
    <p>Specifies how large the image appears to a viewer and what is the viewing distance.  If no parameter is given, <strong>-s&nbsp;ppd=30</strong> is assumed. Since this tone-mapper is global, display size has moderate effect on the resulting images and thus skipping this parameter should not do much harm. There are two ways to specify image size:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>vres</strong>=&lt;lines&gt;:<strong>vd</strong>=&lt;screen_heights&gt;[:<strong>d</strong>=&lt;<em>meters</em>&gt;]</p>
  </dt>
  <dd>
    
<dl class='dl-vertical'>
  <dt>
    <strong>vres</strong>
  </dt>
  <dd>
    <p>- screen's vertical resolution in lines, for example 1024.</p>
  </dd>
  <dt>
    <strong>vd</strong>
  </dt>
  <dd>
    <p>- viewing distance specified as multiplies of screen height. For example if the display is seen from 0.5m and the height of its screen is 25cm, <strong>vd</strong>=2.</p>
  </dd>
  <dt>
    <strong>d</strong>
  </dt>
  <dd>
    <p>- (optional) viewing distance in meters. This is to account for lower eye's sensitivity for larger viewing distances (although the effect is negligible). By default <strong>-d</strong>=0.5 is assumed.</p>
  </dd>

</dl>

  </dd>
  <dt>
    <p><strong>ppd</strong>=&lt;<em>pixels_per_visual_degree</em>&gt;[:<strong>d</strong>=&lt;<em>meters</em>&gt;]</p>
  </dt>
  <dd>
    
<dl class='dl-vertical'>
  <dt>
    <strong>ppd</strong>
  </dt>
  <dd>
    <p>- how many pixels spans one visual degree.</p>
  </dd>
  <dt>
    <strong>d</strong>
  </dt>
  <dd>
    <p>- (optional) viewing distance in meters. This is to account for lower eye's sensitivity for larger viewing distances (although the effect is negligible). By default <strong>-d</strong>=0.5 is assumed.</p>
  </dd>

</dl>

  </dd>

</dl>

  </dd>
  <dt>
    <p><strong>--color-saturation</strong> &lt;<em>float</em>&gt;, <strong>-c</strong> &lt;<em>float</em>&gt;</p>
  </dt>
  <dd>
    <p>Decrease or increase color saturation after tone mapping. Default value <strong>-c=1</strong> attempts to preserve color appearance of the original image. Use values &gt;1 to increase and &lt;1 to decrease color saturation.</p>
  </dd>
  <dt>
    <p><strong>--contrast-enhancement</strong> &lt;<em>float</em>&gt;, <strong>-e</strong> &lt;<em>float</em>&gt;</p>
  </dt>
  <dd>
    <p>By default this tone-mapper attempts to preserve contrast of an input image (<strong>-e=1</strong>). This parameter controls whether the contrast of an input image should be enhanced before tone-mapping. For example <strong>-e=1.15</strong> boosts contrast by 15%. Note that if a target display does not offer sufficient dynamic range, contrast may be enhanced only for selected tone-values (those that dominate in an image) or not enhanced at all.</p>
  </dd>
  <dt>
    <p><strong>--white-y</strong>=&lt;<em>float</em>&gt;, <strong>-y</strong>=&lt;<em>float</em>&gt;</p>
  </dt>
  <dd>
    <p>Tells the tone-mapper what luminance level in the input image should be mapped to the maximum luminance of a display. Since HDR images contain only relative luminance information, tone-mapper does not know how bright should be the scene. This option is meant to fix this problem by providing tone-mapper with the information what luminance level in an input image should be perceived as a diffuse white surface. Default is <em>none</em>, which means that no such mapping will be enforced and tone-mapper is free to find an optimal brightness for a given image. This is a recommended setting for HDR images. Setting <strong>--white-y</strong> could be necessary for dark scenes, which could be made too bright by the tone-mapper. The value of this parameter can be also passed in pfsstream as a tag <em>WHITE_Y</em>. pfstools 1.7 and newer sets set this tag automatically for LDR images. The command line option overrides the value of the pfstream tag.</p>
  </dd>
  <dt>
    <p><strong>--temporal</strong>=&lt;<em>pass</em>&gt;, <strong>-t</strong>=&lt;<em>pass</em>&gt;</p>
  </dt>
  <dd>
    <p>Use temporal filtering of the tone-curve to tone-map video sequence. This option should be used for video sequences to avoid flickering. Since the temporal filter requires knowledge of at least 25 frames in advance, the filtering must be performed in two passes, similar to MPEG video encoding. In the first pass (<em>pass</em>=1) tone-curves are calculated for each frame and stored in a temporary file (datmo_tone_curves.tmp in the current directory). In the second pass (<em>pass</em>=2) the tone-curves are read from that file, filtered and used to tone-map video sequence. The tone-mapper does not produce any output (frames) in the first pass. See below an example how to use two-pass filtering. Note that the same set of tone mapping options must be provided for both passes.</p>
  </dd>
  <dt>
    <p><strong>--output-tone-curve</strong>=&lt;<em>file name</em>&gt;, <strong>-o</strong>=&lt;<em>file name</em>&gt;</p>
  </dt>
  <dd>
    <p>Write tone-curves to a text file. This option is mainly for debugging purposes, but can be used to visualize computed tone-curves. The tone-curve data is stored in a comma separated text file (CSV), consisting of three columns: frame number, log10 of input luminance factor, log10 of the resulting display luminance, and the pixel value (0-1).</p>
  </dd>
  <dt>
    <p><strong>--verbose</strong>, <strong>-v</strong></p>
  </dt>
  <dd>
    <p>Print additional information during program execution.</p>
  </dd>
  <dt>
    <p><strong>--quiet</strong>, <strong>-q</strong></p>
  </dt>
  <dd>
    <p>Do not display progress report.</p>
  </dd>
  <dt>
    <p><strong>--help</strong>, <strong>-h</strong></p>
  </dt>
  <dd>
    <p>Print list of commandline options.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>pfsin memorial.hdr | pfstmo_mantiuk08 -d pd=crt | pfsout memorial.png</p>
  </dt>
  <dd>
    <ul>
<li><p>Tone map memorial image for a CRT display and store the result in the PNG format.</p></li>
</ul>
  </dd>
  <dt>
    <p>pfsin memorial.hdr | pfstmo_mantiuk08 -d g=2.6:l=500:b=0.5:k=0.01:a=10 | pfsview</p>
  </dt>
  <dd>
    <ul>
<li><p>Tone map memorial image for a display that has a 2.2 gamma, the peak luminance of 500 cd/m^2, the black level of 0.5 cd/m^2, the panel reflectivity of 1% (0.01) and is seen under the illumination of 10 lux.</p></li>
</ul>
  </dd>
  <dt>
    <p>pfsin bridge.jpg --linear | pfsclamp --min 0.007 | pfstmo_mantiuk08 -v | pfsview</p>
  </dt>
  <dd>
    <ul>
<li><p>Enhance the low-dynamic range image 'bridge' and view the result. pfsclamp command reduces noise for low code values. pfsin frame%05d.exr | pfstmo_mantiuk08 -d pd=lcd_bright -t 1 pfsin frame%05d.exr | pfstmo_mantiuk08 -d pd=lcd_bright -t 2 | pfsout out_frame%04d.png</p></li><li><p>Tone-map video sequence using 2-pass temporal filtering to avoid flicker.</p></li>
</ul>
  </dd>
  <dt>
    <p>pfsin *.exr | pfstmo_mantiuk08 | pfsview</p>
  </dt>
  <dd>
    <ul>
<li><p>Tone-map and display *.exr HDR images in the current directory.</p></li>
</ul>
  </dd>
  <dt>
    <p>pfsin *.exr | pfstmo_mantiuk06 | pfsgamma -g 0.8 | pfstmo_mantiuk08 | pfsview</p>
  </dt>
  <dd>
    <ul>
<li><p>It is possible to stack a TMO that sharpens images (pfstmo_mantiuk06) with the contrast preserving TMO (pfstmo_mantiuk08) to get new interesting results.</p></li>
</ul>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO pfstmo_mantiuk08&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/pfsin.1.html"><strong>pfsin</strong>(1)</a> <a href="../man1/pfsout.1.html"><strong>pfsout</strong>(1)</a> <a href="../man1/pfsview.1.html"><strong>pfsview</strong>(1)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Please report bugs and comments to the pfstools discussion group (http://groups.google.com/group/pfstools).</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pfstmo_mantiuk06.1.html"><span aria-hidden="true">&larr;</span> pfstmo_mantiuk06.1: Tone mapping in the contrast domain</a></li>
   <li class="next"><a href="pfstmo_pattanaik00.1.html">pfstmo_pattanaik00.1: Time-dependent visual adaptation model <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
