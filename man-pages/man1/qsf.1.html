<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>qsf: Quick spam filter</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Quick spam filter">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="qsf (1) manual">
  <meta name="twitter:description" content="Quick spam filter">
  <meta name="twitter:image" content="https://www.carta.tech/images/qsf-qsf-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/qsf.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="qsf (1) manual" />
  <meta property="og:description" content="Quick spam filter" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/qsf-qsf-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">qsf<small> (1)</small></h1>
        <p class="lead">Quick spam filter</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/qsf.1.html">
      <span itemprop="name">qsf: Quick spam filter</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/qsf/">
      <span itemprop="name">qsf</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/qsf.1.html">
      <span itemprop="name">qsf: Quick spam filter</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>Filtering:       <strong>qsf</strong> [<em>-snrAtav</em>] [<em>-d DB</em>] [<em>-g DB</em>]</p>
<pre>
                     [<em>-L LVL</em>] [<em>-S SUBJ</em>] [<em>-H MARK</em>] [<em>-Q NUM</em>]
</pre>

<pre>
                     [<em>-X NUM</em>]
</pre>
<p>Training:        <strong>qsf</strong> <em>-T SPAM NONSPAM</em> [<em>MAXROUNDS</em>] [<em>-d DB</em>]</p><p>Retraining:      <strong>qsf</strong> <em>-</em>[<em>m|M</em>] [<em>-d DB</em>] [<em>-w WEIGHT</em>] [<em>-ayN</em>]</p><p>Database:        <strong>qsf</strong> <em>-</em>[<em>p|D|R|O</em>] [<em>-d DB</em>]</p><p>Database merge:  <strong>qsf</strong> <em>-E OTHERDB</em> [<em>-d DB</em>]</p><p>Allowlist query: <strong>qsf</strong> <em>-e EMAIL</em> [<em>-m|-M|-t</em>] [<em>-d DB</em>] [<em>-g DB</em>]</p><p>Denylist query:  <strong>qsf</strong> <em>-y</em> <em>-e EMAIL</em> [<em>-m -m|-M -M|-t</em>] [<em>-d DB</em>] [<em>-g DB</em>]</p><p>Help:            <strong>qsf</strong> <em>-</em>[<em>h|V</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>qsf</strong> reads a single email on standard input, and by default outputs it on standard output.  If the email is determined to be spam, an additional header ("X-Spam: YES") will be added, and optionally the subject line can have "[SPAM]" prepended to it.</p><p><strong>qsf</strong> is intended to be used in a <strong>procmail</strong>(1) recipe, in a ruleset such as this:</p><p> :0 wf  | qsf -ra</p><p> :0 H:  * X-Spam: YES  $HOME/mail/spam</p><p>For more examples, including sample <strong>procmail</strong>(1) recipes, see the <strong>EXAMPLES</strong> section below.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TRAINING</h2>
        <div class="sectioncontent">
<p>Before <strong>qsf</strong> can be used properly, it needs to be trained.  A good way to train <strong>qsf</strong> is to collect a copy of all your email into two folders - one for spam, and one for non-spam.  Once you have done this, you can use the training function, like this:</p><p> qsf -aT spam-folder non-spam-folder</p><p>This will generate a database that can be used by <strong>qsf</strong> to guess whether email received in the future is spam or not. Note that this initial training run may take a long time, but you should only need to do it once.</p><p>To mark a <strong>single message</strong> as <strong>spam</strong>, pipe it to <strong>qsf</strong> with the <strong>--mark-spam</strong> or <strong>-m</strong> ("mark as spam") option.  This will update the database accordingly and discard the email.</p><p>To mark a <strong>single message</strong> as <strong>non-spam</strong>, pipe it to <strong>qsf</strong> with the <strong>--mark-nonspam</strong> or <strong>-M</strong> ("mark as non-spam") option.  Again, this will discard the email.</p><p>If a message has been mis-tagged, simply send it to <strong>qsf</strong> as the opposite type, i.e. if it has been mistakenly tagged as spam, pipe it into <strong>qsf --mark-nonspam --weight=2</strong> to add it to the non-spam side of the database with double the usual weighting.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>The <strong>qsf</strong> options are listed below.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-d, --database </strong><em>[TYPE:]FILE</em></p>
  </dt>
  <dd>
    <p>Use <em>FILE</em> as the spam/non-spam database.  The default is to use <strong>/var/lib/qsfdb</strong> and, if that is not available or is read-only, <strong>$HOME/.qsfdb</strong>. This option can also be useful if there is a system-wide database but you do not want to use it - specifying your own here will override the default.</p><p>If you prefix the filename with a <strong>TYPE</strong>, of the form <strong>btree:$HOME/.qsfdb</strong>, then this will specify what kind of database <strong>FILE</strong> is, such as <strong>list</strong>, <strong>btree</strong>, <strong>gdbm</strong>, <strong>sqlite</strong> and so on.  Check the output of <strong>qsf -V</strong> to see which database backends are available.  The default is to auto-detect the type, or, if the file does not already exist, use <strong>list</strong>. Note that <strong>TYPE</strong> is not case-sensitive.</p>
  </dd>
  <dt>
    <p><strong>-g, --global </strong><em>[TYPE:]FILE</em></p>
  </dt>
  <dd>
    <p>Use <em>FILE</em> as the default global database, instead of <strong>/var/lib/qsfdb</strong>. If you also specify a database with <strong>-d</strong>, then this "global" database will be used in read-only mode in conjunction with the read-write database specified with <strong>-d</strong>. The <strong>-g</strong> option can be used a second time to specify a third database, which will also be used in read-only mode. Again, the filename can optionally be prefixed with a <strong>TYPE</strong> which specifies the database type.</p>
  </dd>
  <dt>
    <p><strong>-P, --plain-map </strong>FILE</p>
  </dt>
  <dd>
    <p>Maintain a mapping of all database tokens to their non-hashed counterparts in <em>FILE</em>, one token per line.  This can be useful if you want to be able to list the contents of your database at a later date, for instance to get a list of email addresses in your allow-list.  Note that using this option may slow <strong>qsf</strong> down, and only entries written to the database while this option is active will be stored in <em>FILE</em>.</p>
  </dd>
  <dt>
    <p><strong>-s, --subject</strong></p>
  </dt>
  <dd>
    <p>Rewrite the Subject line of any email that turns out to be spam, adding "[SPAM]" to the start of the line.</p>
  </dd>
  <dt>
    <p><strong>-S, --subject-marker </strong><em>SUBJECT</em></p>
  </dt>
  <dd>
    <p>Instead of adding "[SPAM]", add <strong>SUBJECT</strong> to the Subject line of any email that turns out to be spam.  Implies <strong>-s</strong>.</p>
  </dd>
  <dt>
    <p><strong>-H, --header-marker </strong><em>MARK</em></p>
  </dt>
  <dd>
    <p>Instead of setting the X-Spam header to "YES", set it to <strong>MARK</strong> if email turns out to be spam.  This can be useful if your email client can only search all headers for a string, rather than one particular header (so searching for "YES" might match more than just the output of <strong>qsf</strong>).</p>
  </dd>
  <dt>
    <p><strong>-n, --no-header</strong></p>
  </dt>
  <dd>
    <p>Do not add an X-Spam header to messages.</p>
  </dd>
  <dt>
    <p><strong>-r, --add-rating</strong></p>
  </dt>
  <dd>
    <p>Insert an additional header X-Spam-Rating which is a rating of the "spamminess" of a message from 0 to 100; 90 and above are counted as spam, anything under 90 is not considered spam. If combined with <strong>-t</strong>, then the rating (0-100) will be output, on its own, on standard output.</p>
  </dd>
  <dt>
    <p><strong>-A, --asterisk</strong></p>
  </dt>
  <dd>
    <p>Insert an additional header X-Spam-Level which will contain between 0 and 20 asterisks (*), depending on the spam rating.</p>
  </dd>
  <dt>
    <p><strong>-t, --test</strong></p>
  </dt>
  <dd>
    <p>Instead of passing the message out on standard output, output nothing, and exit 0 if the message is not spam, or exit 1 if the message is spam. If combined with <strong>-r</strong>, then the spam rating will be output on standard output.</p>
  </dd>
  <dt>
    <p><strong>-a, --allowlist</strong></p>
  </dt>
  <dd>
    <p>Enable the allow-list.  This causes the email addresses given in the message's "From:" and "Return-Path:" headers to be checked against a list; if either one matches, then the message is always treated as non-spam, regardless of what the token database says. When specified with a retraining flag, <strong>-a -m</strong> (mark as spam) will remove that address from the allow-list as well as marking the message as spam, and <strong>-a -M</strong> (mark as non-spam) will add that address to the allow-list as well as marking the message as non-spam.  The idea is that you add all of your friends to the allow-list, and then none of their messages ever get marked as spam.</p>
  </dd>
  <dt>
    <p><strong>-y, --denylist</strong></p>
  </dt>
  <dd>
    <p>Enable the deny-list.  This causes the email addresses given in the message's "From:" and "Return-Path:" headers to be checked against a second list; if either one matches, then theh message is always treated as spam. Training works in the same way as with <strong>-a</strong>, except that you must specify <strong>-m</strong> or <strong>-M</strong> twice to modify the deny-list instead of the allow-list, and with the reverse syntax: <strong>-y -m -m</strong> (mark as spam) will add that address to the deny-list, whereas <strong>-y -M -M</strong> (mark as non-spam) will remove that address from the deny-list. This double specification is so that the usual retraining process never touches the deny-list; the deny-list should be carefully maintained rather than automatically generated.</p><p>Normally you would not need to use the deny-list.</p>
  </dd>
  <dt>
    <p><strong>-L, --level, --threshold </strong><em>LEVEL</em></p>
  </dt>
  <dd>
    <p>Change the spam scoring threshold level which must be reached before an email is classified as spam.  The default is 90.</p>
  </dd>
  <dt>
    <p><strong>-Q, --min-tokens </strong><em>NUM</em></p>
  </dt>
  <dd>
    <p>Only give a score if more than <strong>NUM</strong> tokens are found in the message - otherwise the message is assumed to be non-spam, and it is not modified in any way.  The default is 0.  This option might be useful if you find that very short messages are being frequently miscategorised.</p>
  </dd>
  <dt>
    <p><strong>-e, --email, --email-only </strong><em>EMAIL</em></p>
  </dt>
  <dd>
    <p>Query or update the allow-list entry for the email address <strong>EMAIL</strong>. With no other options, this will simply output "YES" if <strong>EMAIL</strong> is in the allow-list, or "NO" if it is not. With <strong>-t</strong>, it will not output anything, but will exit 0 (success) if <strong>EMAIL</strong> is in the allow-list, or 1 (failure) if it is not. With the <strong>-m</strong> (mark-spam) option, any previous allow-list entry for <strong>EMAIL</strong> will be removed. Finally, with the <strong>-M</strong> (mark-nonspam) option, <strong>EMAIL</strong> will be added to the allow-list if it is not already on it.</p><p>If <strong>EMAIL</strong> is just the word <strong>MSG</strong> on its own, then an email will be read from standard input, and the email addresses given in the "From:" and "Return-Path:" headers will be used.</p><p>Using <strong>-e</strong> automatically switches on <strong>-a</strong>.</p><p>If you also specify <strong>-y</strong>, then the deny-list will be operated on. Remember that <strong>-m</strong> and <strong>-M</strong> are reversed with the deny-list.</p><p>If you specify an email address of the form <strong>@domain</strong> (nothing before the @), then the whole <em>domain</em> will be allow or deny listed.</p>
  </dd>
  <dt>
    <p><strong>-v, --verbose</strong></p>
  </dt>
  <dd>
    <p>Add extra <strong>X-QSF-Info</strong> headers to any filtered email, containing error messages and so on if applicable.  Specify <strong>-v</strong> more than once to increase verbosity.</p>
  </dd>
  <dt>
    <p><strong>-T, --train </strong><em>SPAM NONSPAM [MAXROUNDS]</em></p>
  </dt>
  <dd>
    <p>Train the database using the two mbox folders <strong>SPAM</strong> and <strong>NONSPAM</strong>, by testing each message in each folder and updating the database each time a message is miscategorised.  This is done several times, and may take a while to run.  Specify the <strong>-a</strong> (allow-list) flag to add every sender in the <strong>NONSPAM</strong> folder to your allow-list as a side-effect of the training process. If <strong>MAXROUNDS</strong> is specified, training will end after this number of rounds if the results are still not good enough. The default is a maximum of 200 rounds.</p>
  </dd>
  <dt>
    <p><strong>-m, --mark-spam</strong></p>
  </dt>
  <dd>
    <p>Instead of passing the message out on standard output, mark its contents as spam and update the database accordingly.  If the allow-list <strong></strong>(<strong>-a</strong>) is enabled, the message's "From:" and "Return-Path:" addresses are removed from the allow-list. If the deny-list <strong></strong>(<strong>-y</strong>) is enabled and you specify <strong>-m</strong> twice, the message's addresses are added to the deny-list instead.</p>
  </dd>
  <dt>
    <p><strong>-M, --mark-nonspam</strong></p>
  </dt>
  <dd>
    <p>Instead of passing the message out on standard output, mark its contents as non-spam and update the database accordingly.  If the allow-list <strong></strong>(<strong>-a</strong>) is enabled, the message's "From:" and "Return-Path:" addresses are added to the allow-list (see the <strong>-a</strong> option above). If the deny-list <strong></strong>(<strong>-y</strong>) is enabled and you specify <strong>-M</strong> twice, the message's addresses are removed from the deny-list instead.</p>
  </dd>
  <dt>
    <p><strong>-w, --weight </strong><em>WEIGHT</em></p>
  </dt>
  <dd>
    <p>When marking as spam or non-spam, update the database with a weighting of <strong>WEIGHT</strong> per token instead of the default of 1.  Useful when correcting mistakes, eg a message that has been mistakenly detected as spam should be marked as non-spam using a weighting of 2, i.e. double the usual weighting, to counteract the error.</p>
  </dd>
  <dt>
    <p><strong>-D, --dump </strong><em>[FILE]</em></p>
  </dt>
  <dd>
    <p>Dump the contents of the database as a platform-independent text file, suitable for archival, transfer to another machine, and so on.  The data is output on stdout or into the given <strong>FILE</strong>.</p>
  </dd>
  <dt>
    <p><strong>-R, --restore </strong><em>[FILE]</em></p>
  </dt>
  <dd>
    <p>Rebuild the database from scratch from the text file on stdin.  If a <strong>FILE</strong> is given, data is read from there instead of from stdin.</p>
  </dd>
  <dt>
    <p><strong>-O, --tokens</strong></p>
  </dt>
  <dd>
    <p>Instead of filtering, output a list of the tokens found in the message read from standard input, along with the number of times each token was found. This is only useful if you want to use <strong>qsf</strong> as a general tokeniser for use with another filtering package.</p>
  </dd>
  <dt>
    <p><strong>-E, --merge </strong><em>OTHERDB</em></p>
  </dt>
  <dd>
    <p>Merge the <strong>OTHERDB</strong> database into the current database.  This can be useful if you want to take one user's mailbox and merge it into the system-wide one, for instance (this would be done by, as root, doing <strong>qsf -d /var/lib/qsfdb -E /home/user/.qsfdb</strong> and then removing <strong>/home/user/.qsfdb</strong>).</p>
  </dd>
  <dt>
    <p><strong>-B, --benchmark </strong><em>SPAM NONSPAM [MAXROUNDS]</em></p>
  </dt>
  <dd>
    <p>Benchmark the training process using the two mbox folders <strong>SPAM</strong> and <strong>NONSPAM</strong>. A temporary database is created and trained using the first 75% of the messages in each folder, and then the entire contents of each folder is tested to see how many false positives and false negatives occur. Some timing information is also displayed.</p><p>This can be used to decide which backend is best on your system.  Use <strong>-d</strong> to select a backend, eg <strong>qsf -B spam nonspam -d GDBM</strong> - this will create a temporary database which is removed afterwards.</p><p>The exception to this is the MySQL backend, where a full database specification must be given <strong></strong>(<strong>-d MySQL:database=db;host=localhost;...</strong>) and the database table given will not be wiped beforehand or dropped afterwards.</p><p>As with <strong>-T</strong>, if <strong>MAXROUNDS</strong> is specified, training will never be done for more than this number of rounds; the default is 200.</p>
  </dd>
  <dt>
    <p><strong>-h, --help</strong></p>
  </dt>
  <dd>
    <p>Print a usage message on standard output and exit successfully.</p>
  </dd>
  <dt>
    <p><strong>-V, --version</strong></p>
  </dt>
  <dd>
    <p>Print version information, including a list of available database backends, on standard output and exit successfully.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DEPRECATED OPTIONS</h2>
        <div class="sectioncontent">
<p>The following options are only for use with the old binary tree database backend or old databases that haven't been upgraded to the new format that came in with version 1.1.0.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-N, --no-autoprune</strong></p>
  </dt>
  <dd>
    <p>When marking as spam or nonspam, never automatically prune the database. Usually the database is pruned after every 500 marks; if you would rather <strong>--prune</strong> manually, use <strong>-N</strong> to disable automatic pruning.</p>
  </dd>
  <dt>
    <p><strong>-p, --prune</strong></p>
  </dt>
  <dd>
    <p>Remove redundant entries from the database and clean it up a little.  This is automatically done after several calls to <strong>--mark-spam</strong> or <strong>--mark-nonspam</strong>, and during training with <strong>--train</strong> if the training takes a large number of rounds, so it should rarely be necessary to use <strong>--prune</strong> manually unless you are using <strong>-N</strong> / <strong>--no-autoprune</strong>.</p>
  </dd>
  <dt>
    <p><strong>-X, --prune-max </strong><em>NUM</em></p>
  </dt>
  <dd>
    <p>When the database is being pruned, no more than <strong>NUM</strong> entries will be considered for removal.  This is to prevent CPU and memory resources being taken over.  The default is 100,000 but in some circumstances (if you find that pruning takes too long) this option may be used to reduce it to a more manageable number.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>/var/lib/qsfdb</strong></p>
  </dt>
  <dd>
    <p>The default (system-wide) spam database.  If you wish to install <strong>qsf</strong> system-wide, this should be read-only to everyone; there should be one user with write access who can update the spam database with <strong>qsf --mark-spam</strong> and <strong>qsf --mark-non-spam</strong> when necessary.</p>
  </dd>
  <dt>
    <p><strong>/var/lib/qsfdb2</strong></p>
  </dt>
  <dd>
    <p>A second, read-only, system-wide database. This can be useful when installing <strong>qsf</strong> system-wide and using third-party spam databases; the first global database can be updated with system-specific changes, and this second database can be periodically updated when the third-party spam database is updated.</p>
  </dd>
  <dt>
    <p><strong>$HOME/.qsfdb</strong></p>
  </dt>
  <dd>
    <p>The default spam database for per-user data.  Users without write access to the system-wide database will have their data written here, and the two databases will be read together.  The per-user database will be given a weighting equivalent to 10 times the weighting of the global database.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>Currently, you cannot use <strong>qsf</strong> to check for spam while the database is being updated.  This means that while an update is in progress, all email is passed through as non-spam.</p><p>There is an upper size limit of 512Kb on incoming email; anything larger than this is just passed through as non-spam, to avoid tying up machine resources.</p><p>The plaintext token mapping maintained by <strong>--plain-map</strong> will never shrink, only grow.  It is intended for use by housekeeping and user interface scripts that, for instance, the user can use to list all email addresses on their allow-list.  These scripts should take care of weeding out entries for tokens that are no longer in the database.  If you have no such scripts, there is probably no point in using <strong>--plain-map</strong> anyway.</p><p>Avoid using the deny-list <strong></strong>(<strong>-y</strong>) in any automated retraining, as it can be cause the filter to reject mail unnecessarily.  In general the deny-list is probably best left unused unless explicitly required by your particular setup.</p><p>If both the allow-list and the deny-list are enabled, then email addresses will first be checked against the deny-list, then the allow-list, then the domain of the email address will be checked for matching "@domain" entries in the deny-list and then in the allow-list.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>To filter all of your mail through <strong>qsf</strong>, with the allow-list enabled and the "spam rating" header being added, add this to your <strong>.procmailrc</strong> file:</p><p> :0 wf  | qsf -ra</p><p>If you want <strong>qsf</strong> to add "[SPAM]" to the subject line of any messages it thinks are spam, do this instead:</p><p> :0 wf  | qsf -sra</p><p>To automatically mark any email sent to <strong>spambox@yourdomain.com</strong> as spam (this is the "naive" version):</p><p> :0 H  * ^To:.*spambox@yourdomain.com  | qsf -am</p><p>To do the same, but cleverly, so that only email to <strong>spambox@yourdomain.com</strong> which <strong>qsf</strong> does NOT already classify as spam gets marked as spam in the database (this stops the database getting too heavily weighted):</p><p> # If sent to spambox@yourdomain.com:  :0  * ^To:.*spambox@yourdomain.com  {</p>
<pre>
    :0 wf
    | qsf -a
</pre>

<pre>
    # The above two lines can be skipped if you've
    # already piped the message through qsf.
</pre>

<pre>
    # If the qsf database says it's not spam,
    # mark it as spam!
    :0 H
    * ^X-Spam: NO
    | qsf -am
</pre>
<p> }</p><p>Remove the <strong>-a</strong> option in the above examples if you don't want to use the allow-list.</p><p>A more complicated filtering example - this will only run <strong>qsf</strong> on messages which don't have a subject line saying "your &lt;something&gt; is on fire" and which don't have a sender address ending in "@foobar.com", meaning that messages with that subject line OR that sender address will NEVER be marked as spam, no matter what:</p><p> :0 wf  * ! ^Subject: Your .* is on fire  * ! ^From: .*@foobar.com  | qsf -ra</p><p>For more on <strong>procmail</strong>(1) recipes, see the <strong>procmailrc</strong>(5) and <strong>procmailex</strong>(5) manual pages.</p><p>A couple of macros to add to your <strong>.muttrc</strong> file, if you use <strong>mutt</strong>(1) as a mail user agent:</p><p> # Press F5 to mark a message as spam and delete it  macro index &lt;f5&gt; "&lt;pipe-message&gt;qsf -am&#92;n&lt;delete-message&gt;"  macro pager &lt;f5&gt; "&lt;pipe-message&gt;qsf -am&#92;n&lt;delete-message&gt;"</p><p> # Press F9 to mark a message as non-spam  macro index &lt;f9&gt; "&lt;pipe-message&gt;qsf -aM&#92;n"  macro pager &lt;f9&gt; "&lt;pipe-message&gt;qsf -aM&#92;n"</p><p>Again, remove the <strong>-a</strong> option in the above examples if you don't want to use the allow-list.</p><p>Note, however, that the above macros won't work when operating on multiple tagged messages. For that, you'd need something like this:</p><p> macro index &lt;f5&gt; ":set pipe_split&#92;n&lt;tag-prefix&gt;&lt;pipe-message&gt;qsf -am&#92;n&lt;tag-prefix&gt;&lt;delete-message&gt;&#92;n:unset pipe_split&#92;n"</p><p>If you use <a href="../man7/qmail.7.html"><strong>qmail</strong>(7)</a>, then to get <strong>procmail</strong> working with it you will need to put a line containing just <strong>DEFAULT=./Maildir/</strong> at the top of your <strong>~/.procmailrc</strong> file, so that <strong>procmail</strong> delivers to your Maildir folder instead of trying to deliver to /var/spool/mail/$USER, and you will need to put this in your <strong>~/.qmail</strong> file:</p><p> | preline procmail</p><p>This will cause all your mail to be delivered via <strong>procmail</strong> instead of being delivered directly into your mail directory.</p><p>See the <a href="../man7/qmail.7.html"><strong>qmail</strong>(7)</a> documentation for more about mail delivery with qmail.</p><p>If you use <strong>postfix</strong>(1), you can set up a system-wide mail filter by creating a user account for the purpose of filtering mail, populating that account's <strong>.qsfdb</strong>, and then creating a shell script, to run as that user, which runs <strong>qsf</strong> on stdin and passes stdout to <a href="../man8/sendmail.8.html"><strong>sendmail</strong>(8)</a>.</p><p>Doing this requires some knowledge of <strong>postfix</strong> configuration and care needs to be taken to avoid mail loops. One <strong>qsf</strong> user's full HOWTO is included in the <strong>doc/</strong> directory with this package.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THE ALLOW-LIST</h2>
        <div class="sectioncontent">
<p>A feature called the "allow-list" can be switched on by specifying the <strong>--allowlist</strong> or <strong>-a</strong> option.  This causes messages' "From:" and "Return-Path:" addresses to be checked against a list of people you have said to allow all messages from, and if a message's "From:" or "Return-Path:" address is in the list, it is never marked as spam.  This means you can add all your friends to an "allow-list" and <strong>qsf</strong> will then never mis-file their messages - a quick way to do this is to use <strong>-a</strong> with <strong>-T</strong> (train); everyone in your non-spam folder who has sent you an email will be added to the allow-list automatically during training.</p><p>You can manually add and remove addresses to and from the allow-list using the <strong>-e</strong> (email) option. For instance, to add <strong>foo@bar.com</strong> to the allow-list, do this:</p><p> qsf -e foo@bar.com -M</p><p>To remove <strong>bad@nasty.com</strong> from the allow-list, do this:</p><p> qsf -e bad@nasty.com -m</p><p>And to see whether <strong>someone@somewhere.com</strong> is in the allow-list or not, just do this:</p><p> qsf -e someone@somewhere.com</p><p>In general, you probably always want to enable the allow-list, so always specify the <strong>-a</strong> option when using <strong>qsf</strong>. This will automatically maintain the allow-list based on what you classify as spam or non-spam.</p><p>The only times you might want to turn it off are when people on your allow-list are prone to getting viruses or if a virus is causing email to be sent to you that is pretending to be from someone on your allow-list.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BACKUP AND RESTORE</h2>
        <div class="sectioncontent">
<p>Because the database format is platform-specific, it is a good idea to periodically dump the database to a text file using <strong>qsf -D</strong> so that, if necessary, it can be transferred to another machine and restored with <strong>qsf -R</strong> later on.</p><p>Also note that since the actual contents of email messages are never stored in the database (see <strong>TECHNICAL DETAILS</strong>), you can safely share your <strong>qsf</strong> database with friends - simply dump your database to a file, like this:</p><p> qsf -D &gt; your-database-dump.txt</p><p>Once you have sent <strong>your-database-dump.txt</strong> to another person, they can do this:</p><p> qsf -R &lt; your-database-dump.txt</p><p>They will then have an identical database to yours.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TECHNICAL DETAILS</h2>
        <div class="sectioncontent">
<p>When a message is passed to <strong>qsf</strong>, any attachments are decoded, all HTML elements are removed, and the message text is then broken up into "tokens", where a "token" is a single word or URL.  Each token is hashed using the MD5 algorithm (see below for why), and that hash is then used to look up each token in the <strong>qsf</strong> database.</p><p>For full details of which parts of an email (headers, body, attachments, etc) are used to calculate the spam rating, see the <strong>TOKENISATION</strong> section below.</p><p>Within the database, each token has two numbers associated with it: the number of times that token has been seen in spam, and the number of times it has been seen in non-spam.  These two numbers, along with the total number of spam and non-spam messages seen, are then used to give a "spamminess" value for that particular token.  This "spamminess" value ranges from "definitely not spammy" at one end of the scale, through "neutral" in the middle, up to "definitely spammy" at the other end.</p><p>Once a "spamminess" value has been calculated for all of the tokens in the message, a summary calculation is made to give an overall "is this spam?" probability rating for the message.  If the overall probability is 0.9 or above, the message is flagged as spam.</p><p>In addition to the probability test is the "allow-list".  If enabled (with the <strong>-a</strong> option), the whole probability check is skipped if the sender of the message is listed in the allow-list, and the message is not marked as spam.</p><p>When training the database, a message is split up into tokens as described above, and then the numbers in the database for each token are simply added to: if you tell <strong>qsf</strong> that a message is spam, it adds one to the "number of times seen in spam" counter for each token, and if you tell it a message is not spam, it adds one to the "number of times seen in non-spam" counter for each token.  If you specify a weight, with <strong>-w</strong>, then the number you specify is added instead of one.</p><p>To stop the database growing uncontrollably, the database keeps track of when a token was last used.  Underused tokens are automatically removed from the database.  (The old method was to "prune" every 500 updates).</p><p>Finally, the reason MD5 hashes were used is privacy.  If the actual tokens from the messages, and the actual email addresses in the allow-list, were stored, you could not share a single <strong>qsf</strong> database between multiple users because bits of everyone's messages would be in the database - things like emailed passwords, keywords relating to personal gossip, and so on.  So a hash is stored instead.  A hash is a "one-way" function; it is easy to turn a token into a hash but very hard (some might say impossible) to turn a hash back into the token that created it.  This means that you end up with a database with no personal information in it.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TOKENISATION</h2>
        <div class="sectioncontent">
<p>When a message is broken up into tokens, various parts of the message are treated in different ways.</p><p>First, all header fields are discarded, except for the important ones: <strong>From</strong>, <strong>Return-Path</strong>, <strong>Sender</strong>, <strong>To</strong>, <strong>Reply-To</strong>, and <strong>Subject</strong>.</p><p>Next, any MIME-encoded attachments are decoded.  Any attachments whose MIME type starts with "text/" (i.e. HTML and text) are tokenised, after having any HTML tags stripped.  Any non-textual attachments are replaced with their MD5 hash (such that two identical attachments will have the same hash), and that hash is then used as a token.</p><p>In addition to single-word tokens from textual message parts, <strong>qsf</strong> adds doubled-up tokens so that word pairs get added to the database.  This makes the database a bit bigger (although the automatic pruning tends to take care of that) but makes matching more exact.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SPECIAL FILTERS</h2>
        <div class="sectioncontent">
<p>As well as using the textual content of email to detect spam, <strong>qsf</strong> also uses special filters which create "pseudo-tokens" based on various rules.  This means that specific patterns, not just individual words, can be used to determine whether a message is spam or not.</p><p>For example, if a message contains lots of words with multiple consonants, like "ashjkbnxcsdjh", then each time a word like that is seen the special token ".GIBBERISH-CONSONANTS." is added to the list of tokens found in the message.  If it turns out that most messages with words that trigger this filter rule are spam, then other messages with gibberish consonant strings will be more likely to be flagged as spam.</p><p>Currently the special filters are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>GTUBE</strong></p>
  </dt>
  <dd>
    <p>Flags any message containing the string <strong>XJS*C4JDBQADN1.NSBN3*2IDNEN*GTUBE-STANDARD-ANTI-UBE-TEST-EMAIL*C.34X</strong> as spam - useful for testing that your <strong>qsf</strong> installation is working.</p>
  </dd>
  <dt>
    <p><strong>ATTACH-SCR</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>ATTACH-PIF</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>ATTACH-EXE</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>ATTACH-VBS</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>ATTACH-VBA</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>ATTACH-LNK</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>ATTACH-COM</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>ATTACH-BAT</strong></p>
  </dt>
  <dd>
    <p>Adds a token for every attachment whose filename ends in ".scr", ".pif", ".exe", ".vbs", ".vba", ".lnk", ".com", and ".bat" respectively (these are often viruses).</p>
  </dd>
  <dt>
    <p><strong>ATTACH-GIF</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>ATTACH-JPG</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>ATTACH-PNG</strong></p>
  </dt>
  <dd>
    <p>Adds a token for every attachment whose filename ends in ".gif", ".jpg" or ".jpeg", and ".png" respectively.</p>
  </dd>
  <dt>
    <p><strong>ATTACH-DOC</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>ATTACH-XLS</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>ATTACH-PDF</strong></p>
  </dt>
  <dd>
    <p>Adds a token for every attachment whose filename ends in ".doc", ".xls", or ".pdf" respectively (these tend to indicate a non-spam email).</p>
  </dd>
  <dt>
    <p><strong>SINGLE-IMAGE</strong></p>
  </dt>
  <dd>
    <p>Adds a token if the message contains exactly one attached image.</p>
  </dd>
  <dt>
    <p><strong>MULTIPLE-IMAGES</strong></p>
  </dt>
  <dd>
    <p>Adds a token if the message contains more than one attached image.</p>
  </dd>
  <dt>
    <p><strong>GIBBERISH-CONSONANTS</strong></p>
  </dt>
  <dd>
    <p>Adds a token for every word found that has multiple consonants in a row, as described above.  Spam often contains strings of gibberish.</p>
  </dd>
  <dt>
    <p><strong>GIBBERISH-VOWELS</strong></p>
  </dt>
  <dd>
    <p>Adds a token for every word found that has multiple vowels in a row, eg "aeaiaiaeeio".</p>
  </dd>
  <dt>
    <p><strong>GIBBERISH-FROMCONS</strong></p>
  </dt>
  <dd>
    <p>Like <strong>GIBBERISH-CONSONANTS</strong>, but only for the "From:" and "Return-Path:" addresses on their own.</p>
  </dd>
  <dt>
    <p><strong>GIBBERISH-FROMVOWL</strong></p>
  </dt>
  <dd>
    <p>Like <strong>GIBBERISH-VOWELS</strong>, but only for the "From:" and "Return-Path:" addresses on their own.</p>
  </dd>
  <dt>
    <p><strong>GIBBERISH-BADSTART</strong></p>
  </dt>
  <dd>
    <p>Adds a token for every word that starts with a bad character such as %.</p>
  </dd>
  <dt>
    <p><strong>GIBBERISH-HYPHENS</strong></p>
  </dt>
  <dd>
    <p>Adds a token for every word with more than three hyphens or underscores in it.</p>
  </dd>
  <dt>
    <p><strong>GIBBERISH-LONGWORDS</strong></p>
  </dt>
  <dd>
    <p>Adds a token for every word with over 30 characters in it (but less than 60).</p>
  </dd>
  <dt>
    <p><strong>HTML-COMMENTS-IN-WORDS</strong></p>
  </dt>
  <dd>
    <p>Adds a token for every HTML comment found in the middle of a word.  Spam often contains HTML inside words, like this: w&lt;!--dsgfhsdgjgh--&gt;ord</p>
  </dd>
  <dt>
    <p><strong>HTML-EXTERNAL-IMG</strong></p>
  </dt>
  <dd>
    <p>Adds a token for every HTML &lt;img&gt; (image) tag found that contains :// (i.e. it refers to an external image).</p>
  </dd>
  <dt>
    <p><strong>HTML-FONT</strong></p>
  </dt>
  <dd>
    <p>Adds a token for every HTML &lt;font&gt; tag found.</p>
  </dd>
  <dt>
    <p><strong>HTML-IP-IN-URLS</strong></p>
  </dt>
  <dd>
    <p>Adds a token for every URL found containing an IP address.</p>
  </dd>
  <dt>
    <p><strong>HTML-INT-IN-URL</strong></p>
  </dt>
  <dd>
    <p>Adds a token for every URL found containing an integer in its hostname.</p>
  </dd>
  <dt>
    <p><strong>HTML-URLENCODED-URL</strong></p>
  </dt>
  <dd>
    <p>Adds a token for every URL found containing a % sign in its hostname.</p>
  </dd>

</dl>
<p>Normally, filters will just cause a token to be added, and these tokens are processed by the normal weighting algorithm.  However the <strong>GTUBE</strong> filter will immediately flag any matching message as spam, bypassing the token matching.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DATABASE BACKENDS</h2>
        <div class="sectioncontent">
<p>The inbuilt "list" database backend will not necessarily provide the best performance, but is provided because using it requires no external libraries.</p><p>If, when <strong>qsf</strong> was compiled, the correct libraries were available, then it will be possible to use <strong>qsf</strong> with alternative database backends.  To find out which backends you have available, run <strong>qsf -V</strong> (capital V) and read the second line of output.  To see how well a backend performs, collect some spam and non-spam and use <strong>qsf -d BACKEND -B SPAM NONSPAM</strong> (see the entry for <strong>-B</strong> above).</p><p>Some people find that they get the best performance out of the <strong>gdbm</strong> backend; this is a library that is widely available on many systems.</p><p>To efficiently share a <strong>qsf</strong> database across multiple machines, you may find the MySQL backend useful. However, using it is a little more complicated.</p><p>To use the MySQL backend you will need to create a table with the fields <em>key1</em>, <em>key2</em>, <em>token</em>, <em>value1</em>, <em>value2</em> and <em>value3</em>. The <em>token</em>, <em>value1</em>, <em>value2</em>, and <em>value3</em> fields must be <strong>VARCHAR(64)</strong>, <strong>BIGINT</strong> or <strong>INT</strong>, and <strong>BIGINT</strong> or <strong>INT</strong> respectively, and indexing on the <em>token</em> field is a good idea. The <em>key1</em> and <em>key2</em> fields can be anything, but they must be present.</p><p>For example:</p>
<pre>
  USE mydatabase;
  CREATE TABLE qsfdb (
    key1      BIGINT UNSIGNED NOT NULL,
    key2      BIGINT UNSIGNED NOT NULL,
    token     VARCHAR(64) DEFAULT '' NOT NULL,
    value1    INT UNSIGNED NOT NULL,
    value2    INT UNSIGNED NOT NULL,
    value3    INT UNSIGNED NOT NULL,
    PRIMARY KEY (key1,key2,token),
    KEY (key1),
    KEY (key2),
    KEY (token)
  );
</pre>
<p>The <em>key1</em> and <em>key2</em> fields allow you to have multiple <strong>qsf</strong> databases in one table, by specifying different <em>key1</em> and <em>key2</em> values on invocation.</p><p>Instead of specifying a database file with the <strong>--database</strong> / <strong>-d</strong> option, you must specify either a specification string as described below, or the name of a file containing such a string on its first line.</p><p>The specification string is as follows:</p>
<pre>
  database=DATABASE;host=HOST;port=PORT;
  user=USER;pass=PASS;table=TABLE;
  key1=KEY1;key2=KEY2
</pre>
<p>This string must be all on one line, with no spaces.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>DATABASE</strong></p>
  </dt>
  <dd>
    <p>is the name of the MySQL database.</p>
  </dd>
  <dt>
    <p><strong>HOST</strong></p>
  </dt>
  <dd>
    <p>is the hostname of the database server (eg "localhost").</p>
  </dd>
  <dt>
    <p><strong>PORT</strong></p>
  </dt>
  <dd>
    <p>is the TCP port to connect on (eg 3306).</p>
  </dd>
  <dt>
    <p><strong>USER</strong></p>
  </dt>
  <dd>
    <p>is the username to connect with.</p>
  </dd>
  <dt>
    <p><strong>PASS</strong></p>
  </dt>
  <dd>
    <p>is the password to connect with.</p>
  </dd>
  <dt>
    <p><strong>TABLE</strong></p>
  </dt>
  <dd>
    <p>is the database table to use.  If a table with this name does not exist when <strong>qsf</strong> is called in update or training mode, then it will be created if permissions allow this to be done.</p>
  </dd>
  <dt>
    <p><strong>KEY1</strong></p>
  </dt>
  <dd>
    <p>is the value to use for the <em>key1</em> field.</p>
  </dd>
  <dt>
    <p><strong>KEY2</strong></p>
  </dt>
  <dd>
    <p>is the value to use for the <em>key2</em> field.</p>
  </dd>

</dl>
<p>Since command lines can be seen in the process list, it is probably best to specify a filename (eg <strong>qsf -d mysql:qsfdb.spec</strong>) and put the specification string inside that file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TROUBLESHOOTING</h2>
        <div class="sectioncontent">
<p>If you have problems with <strong>qsf</strong>, please check the list below; if this does not help, go to the <strong>qsf</strong> home page and investigate the mailing lists, or email the author.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>Nothing is being marked as spam.</strong></p>
  </dt>
  <dd>
    <p>First, use the <strong>-r</strong> option to switch on the <strong>X-Spam-Rating</strong> header, and check that this header appears in email passed through <strong>qsf</strong>. If it does not, then it is likely that <strong>qsf</strong> is not being run at all - check your configuration of <strong>procmail</strong>(1) or its equivalent.</p>
  </dd>
  <dt>
    <p><strong> </strong></p>
  </dt>
  <dd>
    <p>If you are seeing <strong>X-Spam-Rating</strong> headers, and different emails have different scores, then you may simply need to retrain your database a little more.  Take more spam email and pass it to <strong>qsf -m</strong>.</p>
  </dd>
  <dt>
    <p><strong> </strong></p>
  </dt>
  <dd>
    <p>If you are seeing <strong>X-Spam-Rating</strong> headers but they all give the same spam rating, then the most likely reason is that <strong>qsf</strong> is not reading any database.  Make sure that whatever is processing the email has read permissions on <strong>/var/lib/qsfdb</strong> and/or <strong>~/.qsfdb</strong> - and make sure that, if you are using <strong>~/.qsfdb</strong>, what your database creator thought was <strong>~</strong> (<strong>$HOME</strong>) is the same as it is for whatever is processing the email.</p>
  </dd>
  <dt>
    <p><strong>Retraining sometimes takes a very long time.</strong></p>
  </dt>
  <dd>
    <p>With the <strong>obtree</strong> backend or 2-column MySQL or SQLite tables, every 500th retrain <strong></strong>(<strong>-m</strong> or <strong>-M</strong>), the database is pruned.  On some systems this may take some time, and during this time the database is locked (except when using the MySQL or SQLite backends). If you constantly do a lot of retraining and want to avoid this, then use the <strong>-N</strong> option to suppress auto-pruning, and then have a <a href="../man8/cron.8.html"><strong>cron</strong>(8)</a> job or something run a manual prune <strong></strong>(<strong>qsf -p</strong>) every now and again.</p>
  </dd>
  <dt>
    <p><strong>Running qsf from procmail fails with an error.</strong></p>
  </dt>
  <dd>
    <p>If you can run <strong>qsf</strong> from the command line, but in your <strong>procmail</strong> log file you get errors about "qsf: cannot execute binary file", then contact your system administrator for help. It may be that incoming email is handled by a different server to the one you normally shell into, and either they are of a different architecture or operating system, or the mail server is not permitted to execute user-owned binaries.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ACKNOWLEDGEMENTS</h2>
        <div class="sectioncontent">
<p>The following people have contributed suggestions, comments, patches, and testing:</p><p>Tom Parker <em></em>&lt;<em>http://www.bits.bris.ac.uk/palfrey/</em>&gt;</p><p>Dr Kelly A. Parker</p><p>Vesselin Mladenov <em></em>&lt;<em>http://www.antipodes.bg/</em>&gt;</p><p>Glyn Faulkner</p><p>Mark Reynolds</p><p>Sam Roberts</p><p>Scott Allen</p><p>Karsten Kankowski</p><p>M. Kolbl</p><p>Micha Holzmann</p><p>Jef Poskanzer <em></em>&lt;<em>http://www.acme.com/jef/</em>&gt;</p><p>Clemens Fischer <em></em>&lt;<em>http://ino-waiting.gmxhome.de/</em>&gt;</p><p>Nelson A. de Oliveira</p><p>Michal Vitecek</p><p>Tommy Pettersson <em></em>&lt;<em>http://www.lysator.liu.se/~ptp/</em>&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>The author:</p><p>Andrew Wood &lt;andrew.wood@ivarch.com&gt;</p><p><em>http://www.ivarch.com/</em></p><p>Project home page:</p><p><em>http://www.ivarch.com/programs/qsf/</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>If you find any bugs, please contact the author, either by email or by using the contact form on the web site.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO qsf&hellip;</h2>
        <div class="sectioncontent">
<p><strong>procmail</strong>(1), <strong>procmailrc</strong>(5), <strong>procmailex</strong>(5)</p><p>Someone has written a guide to using <strong>qsf</strong> with KMail that can be found at:</p><p>http://www.softwaredesign.co.uk/Information.SpamFilters.html</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE</h2>
        <div class="sectioncontent">
<p>This is free software, distributed under the ARTISTIC 2.0 license.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="qsexec.1.html"><span aria-hidden="true">&larr;</span> qsexec.1: Parses the data received via stdin and executes the defined command on a pattern match.</a></li>
   <li class="next"><a href="qsfilter2.1.html">qsfilter2.1: An utility to generate mod_qos request line rules out from existing access/audit log data. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
