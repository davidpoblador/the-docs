<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pmmgr: Pcp daemon manager</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Pcp daemon manager">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="pmmgr (1) manual">
  <meta name="twitter:description" content="Pcp daemon manager">
  <meta name="twitter:image" content="https://www.carta.tech/images/pcp-manager-pmmgr-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/pmmgr.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="pmmgr (1) manual" />
  <meta property="og:description" content="Pcp daemon manager" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/pcp-manager-pmmgr-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pmmgr<small> (1)</small></h1>
        <p class="lead">Pcp daemon manager</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/pmmgr.1.html">
      <span itemprop="name">pmmgr: Pcp daemon manager</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/pcp-manager/">
      <span itemprop="name">pcp-manager</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/pmmgr.1.html">
      <span itemprop="name">pmmgr: Pcp daemon manager</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>pmmgr</strong> [<strong>-v</strong>] [<strong>-c</strong> <em>config-directory</em>] [<strong>-p</strong> <em>polling-interval</em>] [<strong>-l</strong> <em>log-file</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>pmmgr</strong> manages a collection of PCP daemons for a set of discovered local and remote hosts running the Performance Metrics Collection Daemon (PMCD), according to zero or more configuration directories.  It keeps a matching set of <strong>pmlogger</strong> and/or <strong>pmie</strong> daemons running, and their archives/logs merged/rotated.  It supplants the older <strong>pmlogger_*</strong> and <strong>pmie_*</strong> check/daily management shell scripts.</p><p>pmmgr is largely self-configuring and perseveres despite most run-time errors.  pmmgr runs in the foreground until interrupted.  When signaled, it will stop its running daemons before exiting.</p><p>A description of the command line options specific to <strong>pmmgr</strong> follows:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-c</strong></p>
  </dt>
  <dd>
    <p><em>directory</em> adds a given configuration directory to pmmgr.  pmmgr can supervise multiple different configurations at the same time.  Errors in the configuration may be noted to standard error, but pmmgr will fill in missing information with built-in defaults.  The default directory is <em>$PCP_SYSCONF_DIR/pmmgr</em></p>
  </dd>
  <dt>
    <p><strong>-p</strong></p>
  </dt>
  <dd>
    <p><em>polling-interval</em> sets the host-discovery polling interval to the given number of seconds. The default is 60.  Daemons for a particular target host will be restarted no more frequently than this interval.</p>
  </dd>
  <dt>
    <p><strong>-l</strong></p>
  </dt>
  <dd>
    <p><em>log-file</em> redirects standard output & error to the given log file, which is created anew</p>
  </dd>
  <dt>
    <p><strong>-v</strong></p>
  </dt>
  <dd>
    <p>adds more verbose tracing to standard output.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION</h2>
        <div class="sectioncontent">
<p>A <strong>pmmgr</strong> configuration identifies which hosts should be monitored, which daemons should be maintained for them, and what options those daemons should be run with.  pmmgr uses a small number of files in a configuration directory, instead of lines in a text file.  The individual files carry zero or more lines of 100% pure configuration text, and no comments.  (If desired, a configuration may be commented upon with any other file, such as a free-form README.)</p><h3>TARGET SELECTION</h3>
<p>This set of configuration files identifies where pmmgr should search for pmcd instances, how to uniquely identify them, and where state such as log files should be kept for each.  Ideally, a persistent & unique host-id string is computed for each potential target pmcd from specified metric values.  This host-id is also used as a subdirectory name for locating daemon data.</p>
<dl class='dl-vertical'>
  <dt>
    <p>hostid-metrics</p>
  </dt>
  <dd>
    <p>This file contains one or more lines of metric specifications in the format accepted by <em>pmParseMetricSpec</em>. Metrics without instance specifiers mean all instances of that metric. These are used to generate the <em>unique</em> host-id string for each pmcd server that pmmgr discovers.  Upon discovery, all the metrics/instances named are queried, string values fetched, and normalized/concatenated into a single hyphenated printable string. The default is the single metric <strong>pmcd.hostname</strong>, which is sufficient if all the hosts discovered have unique <strong>hostname</strong>(2).  If they don't, you should add other pcp metric specifications to set them apart at your site.  The more you add, the longer the host-id string, but the more likely that accidental duplication is prevented.</p><p>However, it may be desirable for a host-id to also be <em>persistent</em>, so that if the target host goes offline and later returns, the new host-id matches the previous one, because then old and new histories can be joined. This argues against using metrics whose values vary from boot to boot.</p><p>Some candidate metrics to consider: <em>network.interface.hw_addr</em>, <em>network.interface.inet_addr["eth0"]</em>,  <em>network.interface.ipv6_addr</em>, <em>kernel.uname.nodename</em></p>
  </dd>
  <dt>
    <p>log-directory</p>
  </dt>
  <dd>
    <p>This file contains the path of a directory beneath which the per-host-id subdirectories are to be created by pmmgr.  If it is not a full path, it is implicitly relative to the configuration directory itself.  The default is <strong>$PCP_LOG_DIR/pmmgr/</strong>.</p>
  </dd>
  <dt>
    <p>target-host</p>
  </dt>
  <dd>
    <p>This file contains one or more lines containing pmcd host specifications, as described on the <strong>PCPintro</strong>(1) man page.  Each poll interval, pmmgr will attempt to make a brief <em>pmNewContext</em> connection to the host to check liveness.  It is not a problem if more than one specification for the same host is listed, because the host-id processing eliminates duplicates, and chooses an arbitrary specification among them. The default is to target pmcd at <strong>local:</strong>.</p>
  </dd>
  <dt>
    <p>target-discovery</p>
  </dt>
  <dd>
    <p>This file contains one or more lines containing specifications for the <em>pmDiscoverServices</em> PMAPI call, each of which may map onto a fluctuating set of local or remote pmcd servers.  Each poll interval, pmmgr will attempt to rerun discovery with all of the given specifications.  Again it is not a problem if more than one specification matches the same actual pmcd: one confirmed access path is arbitrarily selected.  The default is to do <strong>no discovery</strong>. Consider including <em>avahi,timeout=5</em> to rely in pmcd self-announcements on the local network (searching for up to five seconds each time).</p>
  </dd>
  <dt>
    <p>log-subdirectory-gc</p>
  </dt>
  <dd>
    <p>This file may contain a time interval specification as per the <em>PCPintro</em> man page.  All subdirectories of the log-directory are presumed to contain data for pmmgr-monitored servers.  Those that have not been touched (in the <strong>stat/mtime</strong> sense) in at least that long, and not associated with a currently monitored target, are deleted entirely.  This value should be longer than the longest interval that pmmgr normally recreates archives (such as due to pmmgr restarts, and <strong>pmlogmerge</strong> intervals).  The default value is <strong>90days</strong>.</p>
  </dd>

</dl>

<h3>PMLOGGER CONFIGURATION</h3>
<p>This group of configuration options controls a <strong>pmlogger</strong> daemon for each host.  This may include generating its configuration, and managing its archives.</p>
<dl class='dl-vertical'>
  <dt>
    <p>pmlogger</p>
  </dt>
  <dd>
    <p>If and only if this file exists, pmmgr will maintain a <strong>pmlogger</strong> daemon for each targeted host.  This file contains one line of additional space-separated options for the pmie daemon.  (pmmgr already adds -h, -f, -r, -l, and perhaps -c.)  The default is to maintain <strong>no pmlogger</strong> (and no other configuration in this section is processed).</p>
  </dd>
  <dt>
    <p>pmlogconf</p>
  </dt>
  <dd>
    <p>If and only if this file exists, pmmgr will run <strong>pmlogconf</strong> to generate a configuration file for each target pmcd.  The file contains one line of space-separated additional options for the pmlogconf program.  pmlogconf's generated output file will be stored under the log-directory/hostid subdirectory.  (pmmgr already adds -c, -r, and -h.)  The default is <strong>no pmlogconf</strong>, so instead, the pmlogger file above should probably contain a -c option, to specify a fixed pmlogger configuration.</p>
  </dd>

</dl>

<h3>ARCHIVE LOG MANAGEMENT</h3>
<p>Default pmlogger configurations can collect tens of megabytes of data per day (possibly split into multiple archives), per target host.  If your disk space is less than infinite, or archive-splitting unwieldy, this should be managed.  In the default, unmanaged case, the system administrator is responsible for managing the individual <em>archive-*</em> files from the per-host logging subdirectories.  pmmgr offers several other options, each representing different performance / usability tradeoffs.</p>
<h3>ARCHIVE LOG MANAGEMENT - pmlogmerge</h3>
<p>This style of archive log management regularly creates a single merged archive from prior archives for each target host, in effect lopping off old data and appending the new.  A single merged archive can be relatively large (defaults to approximately 100-400 MB per host), and puts a corresponding I/O load on storage, but is most convenient for a detailed long-timeframe analysis.  Once pmlogger is restarted, it always creates a new archive, so in the steady state, there will be one merged archive of recent history, and one current archive being written-to by pmlogger.</p>
<dl class='dl-vertical'>
  <dt>
    <p>pmlogmerge</p>
  </dt>
  <dd>
    <p>If this file exists, pmmgr will run <strong>pmlogextract</strong> to periodically merge together preexisting log archives for each target pmcd into a single large one.  Then, the preexisting log archives are deleted (including any prior merged ones). This configuration file may contain a time interval specification as per the <em>PCPintro</em> man page, representing the period after which pmlogger should be temporarily stopped, and archives merged.  It represents the maximum amount of time that the merged archive <em>lags</em> the present time. The default is <strong>24hours</strong>.</p>
  </dd>
  <dt>
    <p>pmlogmerge-granular</p>
  </dt>
  <dd>
    <p>If this file exists, pmmgr will merge only a subset of preexisting log archives into the new one, instead of all of them, so as to approximate a granular, aligned set of merged archives.  The subset chosen corresponds to the previous time interval specified by the <em>pmlogmerge</em> control file. The default is <strong>no granularity</strong>.</p>
  </dd>
  <dt>
    <p>pmlogmerge-retain</p>
  </dt>
  <dd>
    <p>If this file exists, pmmgr will set the relative starting time for retaining old archived data.  It will be passed to pmlogextract as a negative parameter to -S.  It is interpreted as a request that data older than the given interval should be thrown away.  In addition, unmerged archive files left around, that are older than this, are deleted.  (This can happen if those archive files had errors that prevented their merging.)  The default is <strong>14days</strong>.</p>
  </dd>
  <dt>
    <p>pmlogmerge-rewrite</p>
  </dt>
  <dd>
    <p>If this file exists, pmmgr will run <strong>pmlogrewrite -i</strong> (plus any other options listed in this file) on each input archive before merging it.  This will naturally require more disk I/O.  The default is <strong>no rewriting</strong>.</p>
  </dd>

</dl>

<h3>PMIE CONFIGURATION</h3>
<p>This group of configuration options controls a <strong>pmie</strong> daemon for each host.  This may include generating a custom configuration.</p>
<dl class='dl-vertical'>
  <dt>
    <p>pmie</p>
  </dt>
  <dd>
    <p>If and only if this file exists, pmmgr will maintain a <strong>pmie</strong> daemon for each targeted pmcd.  This file contains one line of additional space-separated options for the pmie daemon.  (pmmgr already adds -h, -f, -l, and perhaps -c.)  The default is to maintain <strong>no pmie</strong> (and no other configuration in this section is processed).</p>
  </dd>
  <dt>
    <p>pmieconf</p>
  </dt>
  <dd>
    <p>If and only if this file exists, pmmgr will run <strong>pmieconf</strong> to generate a configuration file for each target pmcd.  The file  contains one line of space-separated additional options for the pmieconf program.  pmieconf's generated output file will be stored under the log-directory/hostid subdirectory.  (pmmgr already adds -F, -c, and -f.)  The default is <strong>no pmieconf</strong>, so instead, the pmie file above should probably contain a -c option, to specify a fixed pmie configuration.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>$PCP_SYSCONFIG_DIR/pmmgr/</strong></p>
  </dt>
  <dd>
    <p>default configuration directory</p>
  </dd>
  <dt>
    <p><strong>$PCP_LOG_DIR/pmmgr/</strong></p>
  </dt>
  <dd>
    <p>default logging directory</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PCP ENVIRONMENT</h2>
        <div class="sectioncontent">
<p>Environment variables with the prefix <strong>PCP_</strong> are used to parametrize the file and directory names used by PCP. On each installation, the file <em>/etc/pcp.conf</em> contains the local values for these variables. The <strong>$PCP_CONF</strong> variable may be used to specify an alternative configuration file, as described in <a href="../man5/pcp.conf.5.html"><strong>pcp.conf</strong>(5)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO pmmgr&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/PCPIntro.1.html"><strong>PCPIntro</strong>(1)</a>, <a href="../man1/pmcd.1.html"><strong>pmcd</strong>(1)</a>, <a href="../man1/pmlogconf.1.html"><strong>pmlogconf</strong>(1)</a>, <a href="../man1/pmlogger.1.html"><strong>pmlogger</strong>(1)</a>, <strong>pmieconf</strong>(1), <a href="../man1/pmie.1.html"><strong>pmie</strong>(1)</a>, <a href="../man1/pmlogreduce.1.html"><strong>pmlogreduce</strong>(1)</a>, <a href="../man5/pcp.conf.5.html"><strong>pcp.conf</strong>(5)</a> and <a href="../man5/pcp.env.5.html"><strong>pcp.env</strong>(5)</a>.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pmmessage.1.html"><span aria-hidden="true">&larr;</span> pmmessage.1: General purpose dialog box</a></li>
   <li class="next"><a href="pmnewlog.1.html">pmnewlog.1: Stop and restart archive logging for pcp performance metrics <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
