<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>mrtglib: Library for mrtg and support scripts</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Library for mrtg and support scripts">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="mrtglib (1) manual">
  <meta name="twitter:description" content="Library for mrtg and support scripts">
  <meta name="twitter:image" content="https://www.carta.tech/images/mrtg-mrtglib-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/mrtglib.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="mrtglib (1) manual" />
  <meta property="og:description" content="Library for mrtg and support scripts" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/mrtg-mrtglib-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">mrtglib<small> (1)</small></h1>
        <p class="lead">Library for mrtg and support scripts</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/mrtglib.1.html">
      <span itemprop="name">mrtglib: Library for mrtg and support scripts</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/mrtg/">
      <span itemprop="name">mrtg</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/mrtglib.1.html">
      <span itemprop="name">mrtglib: Library for mrtg and support scripts</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
 use MRTG_lib;
 my ($configfile, @target_names, %globalcfg, %targetcfg);
 readcfg($configfile, &#92;@target_names, &#92;%globalcfg, &#92;%targetcfg);
 my (@parsed_targets);
 cfgcheck(&#92;@target_names, &#92;%globalcfg, &#92;%targetcfg, &#92;@parsed_targets);
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>MRTG_lib is part of \s-1MRTG\s0, the Multi Router Traffic Grapher. It was separated from \s-1MRTG\s0 to allow other programs to easily use the same config files. The main part of MRTG_lib is the config file parser but some other funcions are there too. Type of \s-1OS:\s0 \s-1WIN\s0, \s-1UNIX\s0, \s-1VMS\s0 <em>Slash</em> in the current \s-1OS\s0. Path separator in \s-1PATH\s0 variable \*(C`readcfg($file, &#92;@targets, &#92;%globalcfg, &#92;%targetcfg [, $prefix, &#92;%extrules])\*(C' Reads a config file, parses it and fills some arrays and hashes. The mandatory arguments are: the name of the config file, a ref to an array which will be filled with a list of the target names, a hashref for the global configuration, a hashref for the target configuration. The configuration file syntax is:  globaloption: value  targetoption[targetname]: value  aprefix*extglobal: value  aprefix*exttarget[target2]: value E.g.  workdir: /var/stat/mrtg  target[router1]: 2:public@router1.local.net  14all*columns: 2 The global config hash has the structure  $globalcfg{configoption} = &apos;value&apos; The target config hash has the structure  $targetcfg{configoption}{targetname} = &apos;value&apos; See mrtg-reference for more information about the \s-1MRTG\s0 configuration syntax. \*(C`readcfg\*(C' can take two additional arguments to extend the config file syntax. This allows programs to put their configuration into the mrtg config file. The fifth argument is the prefix of the extension, the sixth argument is a hash with the checkrules for these extension settings. E.g. if the prefix is \*(L"14all\*(R" \*(C`readcfg\*(C' will check config lines that begin with \*(L"14all*\*(R", i.e. all lines like  14all*columns: 2  14all*graphsize[target3]: 500 200 against the rules in %extrules. The format of this hash is:  $extrules{option} = [sub{$_[0] =~ m/^&#92;d+$/}, sub{"Error message for $_[0]"}]      i.e.  $extrules{option}[0] -&gt; a test expression  $extrules{option}[1] -&gt; error message if test fails The first part of the array is a perl expression to test the value of the option. The test can access this value in the variable \*(L"$arg\*(R". The second part of the array is an error message to display when the test fails. The failed value can be integrated by using the variable \*(L"$arg\*(R". Config settings with an different prefix than the one given in the \*(C`readcfg\*(C' call are not checked but inserted into <em></em><strong>%globalcfg</strong><em></em> and <em></em><strong>%targetcfg</strong><em></em>. Prefixed settings keep their prefix in the config hashes:  $targetcfg{&apos;14all*graphsize&apos;}{&apos;target3&apos;} = &apos;500 200&apos; \*(C`cfgcheck(&#92;@target_names, &#92;%globalcfg, &#92;%targetcfg, &#92;@parsed_targets)\*(C' Checks the configuration read by \*(C`readcfg\*(C'. Checks the values in the config for syntactical and/or semantical errors. Sets defaults for some options. Parses the \*(L"target[...]\*(R" options and filles the array @parsed_targets ready for mrtg functions. The first three arguments are the same as for \*(C`readcfg\*(C'. The fourth argument is an arrayref which will be filled with the parsed target defs. \*(C`cfgcheck\*(C' converts the values of target settings <em>options</em>, e.g.  options[router1]: bits, growright to a hash:  $targetcfg{&apos;option&apos;}{&apos;bits&apos;}{&apos;router1&apos;} = 1  $targetcfg{&apos;option&apos;}{&apos;growright&apos;}{&apos;router1&apos;} = 1 This is not done by \*(C`readcfg\*(C' so if you don't use \*(C`cfgcheck\*(C' you have to check the scalar variable <em></em><strong>$targetcfg</strong><em>{'option'}{'router1'}</em> (\s-1MRTG\s0 allows options to be separated by space or ','). \*(C`ensureSL(&#92;$pathname)\*(C' Checks that the <em>pathname</em> does not contain double path separators and ends with a path separator. It uses $MRTG_lib::SL as path separator which will be / or &#92; depending on the \s-1OS\s0. \*(C`log2rrd ($router,&#92;%globalcfg,&#92;%targetcfg)\*(C' Convert log file to rrd format. Needs rrdtool. \*(C`datestr(time)\*(C' Returns the time given in the argument as a nicely formated date string. The argument has to be in \s-1UNIX\s0 time format (seconds since 1970-1-1). \*(C`timestamp()\*(C' Return a string representing the current time. \*(C`setup_loghandlers(filename)\*(C' Install signalhandlers for _\|_DIE_\|_ and _\|_WARN_\|_ making the errors go the the specified destination. If filename is 'eventlog' mrtg will log to the windows event logger. \*(C`expistr(time)\*(C' Returns the time given in the argument formatted suitable for \s-1HTTP\s0 Expire-Headers. \*(C`create_pid()\*(C' Creates a pid file for the mrtg daemon \*(C`demonize_me()\*(C' Puts the running program into background, detaching it from the terminal. \*(C`populatecache(&#92;%confcache, $host, $reread, $snmpoptshash)\*(C' Reads the \s-1SNMP\s0 variables <em>ifDescr</em>, <em>ipAdEntIfIndex</em>, <em>ifPhysAddress</em>, <em>ifName</em> from the <em>host</em> and stores the values in <em></em><strong>%confcache</strong><em></em> as follows:  $confcache{$host}{&apos;Descr&apos;}{ifDescr}{oid} = (ifDescr or &apos;Dup&apos;)  $confcache{$host}{&apos;IP&apos;}{ipAdEntIfIndex}{oid} = (ipAdEntIfIndex or &apos;Dup&apos;)  $confcache{$host}{&apos;Eth&apos;}{ifPhysAddress}{oid} = (ifPhysAddress or &apos;Dup&apos;)  $confcache{$host}{&apos;Name&apos;}{ifName}{oid} = (ifName or &apos;Dup&apos;)  $confcache{$host}{&apos;Type&apos;}{ifType}{oid} = (ifType or &apos;Dup&apos;) The value (at the right side of =) is 'Dup' if a value was retrieved muliple times, the retrieved value else. \*(C`my $confcache = readconfcache($file)\*(C' Preload the confcache from a file. \*(C`writeconfcache($confcache,$file)\*(C' Store the current confcache into a file. \*(C`writeconfcache($confcache,$file)\*(C' Store the current confcache into a file. \*(C`storeincache($confcache,$host,$method,$key,$value)\*(C' \*(C`readfromcache($confcache,$host,$method,$key)\*(C' \*(C`clearfromcache($confcache,$host)\*(C' \*(C`debug($type, $message)\*(C' Prints the <em>message</em> on \s-1STDERR\s0 if debugging is enabled for type <em>type</em>. A debug type is enabled if <em>type</em> is in array @main::DEBUG.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Rainer Bawidamann &lt;Rainer.Bawidamann@rz.uni-ulm.de&gt;</p><p>(This Manpage)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="mrtg-webserver.1.html"><span aria-hidden="true">&larr;</span> mrtg-webserver.1: Hints for web server configuration</a></li>
   <li class="next"><a href="mrtrix.1.html">mrtrix.1: Diffusion-weighted mri white matter tractography <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
