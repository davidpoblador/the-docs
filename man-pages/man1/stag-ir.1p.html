<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>stag-ir: Information retrieval using a simple relational index</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Information retrieval using a simple relational index">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="stag-ir (1p) manual">
  <meta name="twitter:description" content="Information retrieval using a simple relational index">
  <meta name="twitter:image" content="https://www.carta.tech/images/libdbix-dbstag-perl-stag-ir-1p.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1p/stag-ir.1p.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="stag-ir (1p) manual" />
  <meta property="og:description" content="Information retrieval using a simple relational index" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libdbix-dbstag-perl-stag-ir-1p.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">stag-ir<small> (1p)</small></h1>
        <p class="lead">Information retrieval using a simple relational index</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1p/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1p/stag-ir.1p.html">
      <span itemprop="name">stag-ir: Information retrieval using a simple relational index</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libdbix-dbstag-perl/">
      <span itemprop="name">libdbix-dbstag-perl</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1p/stag-ir.1p.html">
      <span itemprop="name">stag-ir: Information retrieval using a simple relational index</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  stag-ir.pl -r person -k social_security_no -d Pg:mydb myrecords.xml
  stag-ir.pl -d Pg:mydb -q 999-9999-9999 -q 888-8888-8888
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Indexes stag nodes (\s-1XML\s0 Elements) in a simple relational db structure - keyed by \s-1ID\s0 with an \s-1XML\s0 Blob as a value</p><p>Imagine you have a very large file of data, in a stag compatible format such as \s-1XML\s0. You want to index all the elements of type <strong>person</strong>; each person can be uniquely identified by <strong>social_security_no</strong>, which is a direct subnode of <strong>person</strong></p><p>The first thing to do is to build the index file, which will be stored in the database mydb</p><p>  stag-ir.pl -r person -k social_security_no -d Pg:mydb myrecords.xml</p><p>You can then use the index \*(L"person-idx\*(R" to retrieve <strong>person</strong> nodes by their social security number</p><p>  stag-ir.pl -d Pg:mydb -q 999-9999-9999 &gt; some-person.xml</p><p>You can export using different stag formats</p><p>  stag-ir.pl -d Pg:mydb -q 999-9999-9999 -w sxpr &gt; some-person.xml</p><p>You can retrieve multiple nodes (although these need to be rooted to make a valid file)</p><p>  stag-ir.pl -d Pg:mydb -q 999-9999-9999 -q 888-8888-8888 -top personset</p><p>Or you can use a list of IDs from a file (newline delimited)</p><p>  stag-ir.pl -d Pg:mydb -qf my_ss_nmbrs.txt -top personset</p><h3>\s-1ARGUMENTS\s0</h3>
<p><em>-d \s-1DB_NAME\s0</em></p><p>This database will be used for storing the stag nodes</p><p>The name can be a logical name or \s-1DBI\s0 locator or DBStag shorthand - see DBIx::DBStag</p><p>The database must already exist</p><p><em>-clear</em></p><p>Deletes all data from the relation type (specified with <strong>-r</strong>) before loading</p><p><em>-insertonly</em></p><p>Does not check if the \s-1ID\s0 in the file exists in the db - will always attempt an \s-1INSERT\s0 (and will fail if \s-1ID\s0 already exists)</p><p>This is the fastest way to load data (only one \s-1SQL\s0 operation per node rather than two) but is only safe if there is no existing data</p><p>(Default is clobber mode - existing data with same \s-1ID\s0 will be replaced)</p><p><em>-newonly</em></p><p>If there is already data in the specified relation in the db, and the \s-1XML\s0 being loaded specifies an \s-1ID\s0 that is already in the db, then this node will be ignored</p><p>(Default is clobber mode - existing data with same \s-1ID\s0 will be replaced)</p><p><em>-transaction_size</em></p><p>A commit will be performed every n UPDATEs/COMMITs (and at the end)</p><p>Default is autocommit</p><p>note that if you are using -insertonly, and you are using transactions, and the input file contains an \s-1ID\s0 already in the database, then the transaction will fail because this script will try and insert a duplicate \s-1ID\s0</p><p><em>-r RELATION-NAME</em></p><p>This is the name of the stag node (\s-1XML\s0 element) that will be stored in the index; for example, with the \s-1XML\s0 below you may want to use the node name <strong>person</strong> and the unique key <strong>id</strong></p><p>  &lt;person_set&gt;     &lt;person&gt;       &lt;id&gt;...&lt;/id&gt;     &lt;/person&gt;     &lt;person&gt;       &lt;id&gt;...&lt;/id&gt;     &lt;/person&gt;     ...   &lt;/person_set&gt;</p><p>This flag should only be used when you want to store data</p><p><em>-k UNIQUE-KEY</em></p><p>This node will be used as the unique/primary key for the data</p><p>This node should be nested directly below the node that is being stored in the index - if it is more that one below, specify a path</p><p>This flag should only be used when you want to store data</p><p><em>-u UNIQUE-KEY</em></p><p>Synonym for <strong>-k</strong></p><p><em>-create</em></p><p>If specified, this will create a table for the relation name specified below; you should use this the first time you index a relation</p><p><em>-idtype \s-1TYPE\s0</em></p><p>(optional)</p><p>This is the \s-1SQL\s0 datatype for the unique key; it defaults to \s-1VARCHAR\s0(255)</p><p>If you know that your id is an integer, you can specify \s-1INTEGER\s0 here</p><p>If your id is always a 8-character field you can do this</p><p>  -idtype &apos;<strong>CHAR</strong>(8)&apos;</p><p>This option only makes sense when combined with the <strong>-c</strong> option</p><p><em>-p \s-1PARSER\s0</em></p><p>This can be the name of a stag supported format (xml, sxpr, itext) - \s-1XML\s0 is assumed by default</p><p>It can also be a module name - this module is used to parse the input file into a stag stream; see Data::Stag::BaseGenerator for details on writing your own parsers/event generators</p><p>This flag should only be used when you want to store data</p><p><em>-q QUERY-ID</em></p><p>Fetches the relation/node with unique key value equal to query-id</p><p>Multiple arguments can be passed by specifying -q multple times</p><p>This flag should only be used when you want to query data</p><p><em>-top NODE-NAME</em></p><p>If this is specified in conjunction with <strong>-q</strong> or <strong>-qf</strong> then all the query result nodes will be nested inside a node with this name (ie this provides a root for the resulting document tree)</p><p><em>-qf QUERY-FILE</em></p><p>This is a file of newline-seperated IDs; this is useful for querying the index in batch</p><p><em>-keys</em></p><p>This will write a list of all primary keys in the index</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO stag-ir&hellip;</h2>
        <div class="sectioncontent">
<p>Data::Stag</p><p>For more complex stag to database mapping, see DBIx::DBStag and the scripts</p><p>stag-db.pl use file \s-1DBM\s0 indexes</p><p>stag-storenode.pl is for storing fully normalised stag trees</p><p>selectall_xml</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="stag-autotemplate.1p.html"><span aria-hidden="true">&larr;</span> stag-autotemplate.1p: Generates stag sql templates files</a></li>
   <li class="next"><a href="stag-qsh.1p.html">stag-qsh.1p: Dbstag query shell <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
