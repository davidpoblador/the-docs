<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>keychain: Re-use ssh-agent and/or gpg-agent between logins</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Re-use ssh-agent and/or gpg-agent between logins">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="keychain (1) manual">
  <meta name="twitter:description" content="Re-use ssh-agent and/or gpg-agent between logins">
  <meta name="twitter:image" content="https://www.carta.tech/images/keychain-keychain-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/keychain.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="keychain (1) manual" />
  <meta property="og:description" content="Re-use ssh-agent and/or gpg-agent between logins" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/keychain-keychain-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">keychain<small> (1)</small></h1>
        <p class="lead">Re-use ssh-agent and/or gpg-agent between logins</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/keychain.1.html">
      <span itemprop="name">keychain: Re-use ssh-agent and/or gpg-agent between logins</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/keychain/">
      <span itemprop="name">keychain</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/keychain.1.html">
      <span itemprop="name">keychain: Re-use ssh-agent and/or gpg-agent between logins</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>keychain&nbsp;[&nbsp;-hkQqV&nbsp;]&nbsp;[&nbsp;--clear&nbsp;--help&nbsp;--ignore-missing&nbsp;--noask --nocolor&nbsp;--nogui&nbsp;--nolock&nbsp;--quick&nbsp;--quiet&nbsp;--version&nbsp;] [&nbsp;--agents&nbsp;<em>list</em>&nbsp;]&nbsp;[&nbsp;--attempts&nbsp;<em>num</em>&nbsp;]&nbsp;[&nbsp;--dir&nbsp;<em>dirname</em>&nbsp;] [&nbsp;--host&nbsp;<em>name</em>&nbsp;]&nbsp;[&nbsp;--lockwait&nbsp;<em>seconds</em>&nbsp;] [&nbsp;--stop&nbsp;<em>which</em>&nbsp;]&nbsp;[&nbsp;--timeout&nbsp;<em>minutes</em>&nbsp;]&nbsp;[&nbsp;keys...&nbsp;]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>keychain is a manager for ssh-agent, typically run from ~/.bash_profile.  It allows your shells and cron jobs to share a single ssh-agent process.  By default, the ssh-agent started by keychain is long-running and will continue to run, even after you have logged out from the system.  If you want to change this behavior, take a look at the --clear and --timeout options, described below.</p><p>When keychain is run, it checks for a running ssh-agent, otherwise it starts one.  It saves the ssh-agent environment variables to ~/.keychain/${\s-1HOSTNAME\s0}-sh, so that subsequent logins and non-interactive shells such as cron jobs can source the file and make passwordless ssh connections.  In addition, when keychain runs, it verifies that the key files specified on the command-line are known to ssh-agent, otherwise it loads them, prompting you for a password if necessary.</p><p>Keychain also supports gpg-agent in the same ways that ssh-agent is supported.  By default keychain attempts to start all available agents but will fall back to only gpg-agent or only ssh-agent if either is unavailable.  You can specifically limit keychain using the --agents option.</p><p>keychain supports most UNIX-like operating systems, including Cygwin. It works with Bourne-compatible, csh-compatible and fish shells.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <strong>--agents</strong> <em>list</em>
  </dt>
  <dd>
    <p>Start the agents listed.  By default keychain will build the list automatically based on the existence of ssh-agent and/or gpg-agent on the system.  The list should be comma-separated, for example \*(L"gpg,ssh\*(R"</p>
  </dd>
  <dt>
    <strong>--attempts</strong> <em>num</em>
  </dt>
  <dd>
    <p>Try num times to add keys before giving up.  The default is 1.</p>
  </dd>
  <dt>
    <strong>--clear</strong>
  </dt>
  <dd>
    <p>Delete all of ssh-agent's keys.  Typically this is used in .bash_profile.  The theory behind this is that keychain should assume that you are an intruder until proven otherwise.  However, while this option increases security, it still allows your cron jobs to use your ssh keys when you're logged out.</p>
  </dd>
  <dt>
    <strong>--confirm</strong>
  </dt>
  <dd>
    <p>Keys are subject to interactive confirmation by the \s-1SSH_ASKPASS\s0 program before being used for authentication.  See the -c option for <em>ssh-add</em>\|(1).</p>
  </dd>
  <dt>
    <strong>--dir</strong> <em>dirname</em>
  </dt>
  <dd>
    <p>Keychain will use dirname rather than $HOME/.keychain</p>
  </dd>
  <dt>
    <strong>--eval</strong>
  </dt>
  <dd>
    <p>Keychain will print lines to be evaluated in the shell on stdout.  It respects the \s-1SHELL\s0 environment variable to determine if Bourne shell or C shell output is expected.</p>
  </dd>
  <dt>
    <strong>--env</strong> <em>filename</em>
  </dt>
  <dd>
    <p>After parsing options, keychain will load additional environment settings from \*(L"filename\*(R".  By default, if \*(L"--env\*(R" is not given, then keychain will attempt to load from ~/.keychain/[hostname]-env or alternatively ~/.keychain/env.  The purpose of this file is to override settings such as \s-1PATH\s0, in case ssh is stored in a non-standard place.</p>
  </dd>
  <dt>
    <strong>-h --help</strong>
  </dt>
  <dd>
    <p>Show help that looks remarkably like this man-page. As of 2.6.10, help is sent to stdout so it can be easily piped to a pager.</p>
  </dd>
  <dt>
    <strong>--host</strong> <em>name</em>
  </dt>
  <dd>
    <p>Set alternate hostname for creation of pidfiles</p>
  </dd>
  <dt>
    <strong>--ignore-missing</strong>
  </dt>
  <dd>
    <p>Don't warn if some keys on the command-line can't be found.  This is useful for situations where you have a shared .bash_profile, but your keys might not be available on every machine where keychain is run.</p>
  </dd>
  <dt>
    <strong>--inherit</strong> <em>which</em>
  </dt>
  <dd>
    <p>Attempt to inherit agent variables from the environment.  This can be useful in a variety of circumstances, for example when ssh-agent is started by gdm.  The following values are valid for \*(L"which\*(R":</p>
<dl class='dl-vertical'>
  <dt>
    <strong>local</strong>
  </dt>
  <dd>
    <p>Inherit when a pid (e.g. \s-1SSH_AGENT_PID\s0) is set in the environment. This disallows inheriting a forwarded agent.</p>
  </dd>
  <dt>
    <strong>any</strong>
  </dt>
  <dd>
    <p>Inherit when a sock (e.g. \s-1SSH_AUTH_SOCK\s0) is set in the environment. This allows inheriting a forwarded agent.</p>
  </dd>
  <dt>
    <strong>local-once</strong>
  </dt>
  <dd>
    <p>Same as \*(L"local\*(R", but only inherit if keychain isn't already providing an agent.</p>
  </dd>
  <dt>
    <strong>any-once</strong>
  </dt>
  <dd>
    <p>Same as \*(L"any\*(R", but only inherit if keychain isn't already providing an agent.</p>
  </dd>

</dl>
<p>By default, keychain-2.5.0 and later will behave as if \*(L"--inherit local-once\*(R" is specified.  You should specify \*(L"--noinherit\*(R" if you want the older behavior.</p>
  </dd>
  <dt>
    <strong>--lockwait</strong> <em>seconds</em>
  </dt>
  <dd>
    <p>How long to wait for the lock to become available.  Defaults to 5 seconds. Specify a value of zero or more. If the lock cannot be acquired within the specified number of seconds, then this keychain process will forcefully acquire the lock.</p>
  </dd>
  <dt>
    <strong>--noask</strong>
  </dt>
  <dd>
    <p>This option tells keychain do everything it normally does (ensure ssh-agent is running, set up the ~/.keychain/[hostname]-{c}sh files) except that it will not prompt you to add any of the keys you specified if they haven't yet been added to ssh-agent.</p>
  </dd>
  <dt>
    <strong>--nocolor</strong>
  </dt>
  <dd>
    <p>Disable color hilighting for non ANSI-compatible terms.</p>
  </dd>
  <dt>
    <strong>--nogui</strong>
  </dt>
  <dd>
    <p>Don't honor \s-1SSH_ASKPASS\s0, if it is set.  This will cause ssh-add to prompt on the terminal instead of using a graphical program.</p>
  </dd>
  <dt>
    <strong>--noinherit</strong>
  </dt>
  <dd>
    <p>Don't inherit any agent processes, overriding the default \*(L"--inherit local-once\*(R"</p>
  </dd>
  <dt>
    <strong>--nolock</strong>
  </dt>
  <dd>
    <p>Don't attempt to use a lockfile while manipulating files, pids and keys.</p>
  </dd>
  <dt>
    <strong>-k --stop</strong> <em>which</em>
  </dt>
  <dd>
    <p>Kill currently running agent processes.  The following values are valid for \*(L"which\*(R":</p>
<dl class='dl-vertical'>
  <dt>
    all
  </dt>
  <dd>
    <p>Kill all agent processes and quit keychain immediately.  Prior to keychain-2.5.0, this was the behavior of the bare \*(L"--stop\*(R" option.</p>
  </dd>
  <dt>
    others
  </dt>
  <dd>
    <p>Kill agent processes other than the one keychain is providing.  Prior to keychain-2.5.0, keychain would do this automatically.  The new behavior requires that you specify it explicitly if you want it.</p>
  </dd>
  <dt>
    mine
  </dt>
  <dd>
    <p>Kill keychain's agent processes, leaving other agents alone.</p>
  </dd>

</dl>

  </dd>
  <dt>
    <strong>-Q --quick</strong>
  </dt>
  <dd>
    <p>If an ssh-agent process is running then use it.  Don't verify the list of keys, other than making sure it's non-empty.  This option avoids locking when possible so that multiple terminals can be opened simultaneously without waiting on each other.</p>
  </dd>
  <dt>
    <strong>-q --quiet</strong>
  </dt>
  <dd>
    <p>Only print messages in case of warning, error or required interactivity. As of version 2.6.10, this also suppresses \*(L"Identities added\*(R" messages for ssh-agent.</p>
  </dd>
  <dt>
    <strong>--timeout</strong> <em>minutes</em>
  </dt>
  <dd>
    <p>Set a timeout in minutes on your keys.  This is conveyed to ssh-agent which does the actual timing out of keys since keychain doesn't run continuously.</p>
  </dd>
  <dt>
    <strong>-V --version</strong>
  </dt>
  <dd>
    <p>Show version information.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>This snippet should work in any shell to load two ssh keys and one gpg key:</p>
<pre>
    eval &#96;keychain --eval id_rsa id_dsa 0123ABCD&#96;
</pre>
<p>If you have trouble with that in csh:</p><p>    setenv SHELL /bin/csh     eval &#96;keychain --eval id_rsa id_dsa 0123ABCD&#96;</p><p>This is equivalent for Bourne shells (including bash and zsh) but doesn't use keychain's --eval feature:</p><p>    keychain id_rsa id_dsa 0123ABCD     [ -z "$HOSTNAME" ] && HOSTNAME=&#96;uname -n&#96;     [ -f $HOME/.keychain/$HOSTNAME-sh ] && &#92;             . $HOME/.keychain/$HOSTNAME-sh     [ -f $HOME/.keychain/$HOSTNAME-sh-gpg ] && &#92;             . $HOME/.keychain/$HOSTNAME-sh-gpg</p><p>This is equivalent for C shell (including tcsh):</p><p>    keychain id_rsa id_dsa 0123ABCD     host=&#96;uname -n&#96;     if (-f $HOME/.keychain/$host-csh) then             source $HOME/.keychain/$host-csh     endif     if (-f $HOME/.keychain/$host-csh-gpg) then             source $HOME/.keychain/$host-csh-gpg     endif</p><p>To load keychain variables from a script (for example from cron) and abort unless id_dsa is available:</p><p>    # Load keychain variables and check for id_dsa     [ -z "$HOSTNAME" ] && HOSTNAME=&#96;uname -n&#96;     . $HOME/.keychain/$HOSTNAME-sh 2&gt;/dev/null     ssh-add -l 2&gt;/dev/null | grep -q id_dsa || exit 1</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO keychain&hellip;</h2>
        <div class="sectioncontent">
<p><em>ssh-agent</em>\|(1)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>Keychain was created and is currently maintained by Daniel Robbins. If you need to report a bug or request an enhancement, please post to the funtoo-dev mailing list &lt;http://groups.google.com/group/funtoo-dev&gt;. For more information about keychain, please visit &lt;http://www.funtoo.org&gt;.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="keyart.1.html"><span aria-hidden="true">&larr;</span> keyart.1: Create ascii art of an openpgp key.</a></li>
   <li class="next"><a href="keyctl.1.html">keyctl.1: Key management facility control <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
