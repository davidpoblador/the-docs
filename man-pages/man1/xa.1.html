<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>xa: 6502/r65c02/65816 cross-assembler</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="6502/r65c02/65816 cross-assembler">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="xa (1) manual">
  <meta name="twitter:description" content="6502/r65c02/65816 cross-assembler">
  <meta name="twitter:image" content="https://www.carta.tech/images/xa65-xa-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/xa.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="xa (1) manual" />
  <meta property="og:description" content="6502/r65c02/65816 cross-assembler" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/xa65-xa-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">xa<small> (1)</small></h1>
        <p class="lead">6502/r65c02/65816 cross-assembler</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/xa.1.html">
      <span itemprop="name">xa: 6502/r65c02/65816 cross-assembler</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/xa65/">
      <span itemprop="name">xa65</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/xa.1.html">
      <span itemprop="name">xa: 6502/r65c02/65816 cross-assembler</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>xa</strong> [<em>OPTION</em>]... <em>FILE</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>xa</strong> is a multi-pass cross-assembler for the 8-bit processors in the 6502 series (such as the 6502, 65C02, 6504, 6507, 6510, 7501, 8500, 8501 and 8502), the Rockwell R65C02, and the 16-bit 65816 processor. For a description of syntax, see <strong>ASSEMBLER SYNTAX</strong> further in this manual page.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-v</strong></p>
  </dt>
  <dd>
    <p>Verbose output.</p>
  </dd>
  <dt>
    <p><strong>-x</strong></p>
  </dt>
  <dd>
    <p>Use old filename behaviour (overrides <strong>-o</strong>, <strong>-e</strong> and <strong>-l</strong>). This option is now deprecated.</p>
  </dd>
  <dt>
    <p><strong>-C</strong></p>
  </dt>
  <dd>
    <p>No CMOS opcodes (default is to allow R65C02 opcodes)</p>
  </dd>
  <dt>
    <p><strong>-W</strong></p>
  </dt>
  <dd>
    <p>No 65816 opcodes (default).</p>
  </dd>
  <dt>
    <p><strong>-w</strong></p>
  </dt>
  <dd>
    <p>Allow 65816 opcodes.</p>
  </dd>
  <dt>
    <p><strong>-B</strong></p>
  </dt>
  <dd>
    <p>Show lines with block open/close (see <strong>PSEUDO-OPS</strong>).</p>
  </dd>
  <dt>
    <p><strong>-c</strong></p>
  </dt>
  <dd>
    <p>Produce o65 object files instead of executable files (no linking performed); files may contain undefined references.</p>
  </dd>
  <dt>
    <p><strong>-o filename</strong></p>
  </dt>
  <dd>
    <p>Set output filename. The default is <strong>a.o65</strong>; use the special filename <strong>-</strong> to output to standard output.</p>
  </dd>
  <dt>
    <p><strong>-e filename</strong></p>
  </dt>
  <dd>
    <p>Set errorlog filename, default is none.</p>
  </dd>
  <dt>
    <p><strong>-l filename</strong></p>
  </dt>
  <dd>
    <p>Set labellist filename, default is none. This is the symbol table and can be used by disassemblers such as <strong>dxa</strong>(1) to reconstruct source.</p>
  </dd>
  <dt>
    <p><strong>-r</strong></p>
  </dt>
  <dd>
    <p>Add cross-reference list to labellist (requires <strong>-l</strong>).</p>
  </dd>
  <dt>
    <p><strong>-M</strong></p>
  </dt>
  <dd>
    <p>Allow colons to appear in comments; for MASM compatibility. This does not affect colon interpretation elsewhere.</p>
  </dd>
  <dt>
    <p><strong>-R</strong></p>
  </dt>
  <dd>
    <p>Start assembler in relocating mode.</p>
  </dd>
  <dt>
    <p><strong>-Llabel</strong></p>
  </dt>
  <dd>
    <p>Defines <strong>label</strong> as an absolute (but undefined) label even when linking.</p>
  </dd>
  <dt>
    <p><strong>-b? addr</strong></p>
  </dt>
  <dd>
    <p>Set segment base for segment <strong>?</strong> to address <strong>addr</strong>. <strong>?</strong> should be t, d, b or z for text, data, bss or zero segments, respectively.</p>
  </dd>
  <dt>
    <p><strong>-A addr</strong></p>
  </dt>
  <dd>
    <p>Make text segment start at an address such that when the file starts at address <strong>addr</strong>, relocation is not necessary. Overrides <strong>-bt</strong>; other segments still have to be taken care of with <strong>-b</strong>.</p>
  </dd>
  <dt>
    <p><strong>-G</strong></p>
  </dt>
  <dd>
    <p>Suppress list of exported globals.</p>
  </dd>
  <dt>
    <p><strong>-DDEF=TEXT</strong></p>
  </dt>
  <dd>
    <p>Define a preprocessor macro on the command line (see <strong>PREPROCESSOR</strong>).</p>
  </dd>
  <dt>
    <p><strong>-I dir</strong></p>
  </dt>
  <dd>
    <p>Add directory <strong>dir</strong> to the include path (before <strong>XAINPUT</strong>; see <strong>ENVIRONMENT</strong>).</p>
  </dd>
  <dt>
    <p><strong>-O charset</strong></p>
  </dt>
  <dd>
    <p>Define the output charset for character strings. Currently supported are ASCII (default), PETSCII (Commodore ASCII), PETSCREEN (Commodore screen codes) and HIGH (set high bit on all characters).</p>
  </dd>
  <dt>
    <p><strong>-p?</strong></p>
  </dt>
  <dd>
    <p>Set the alternative preprocessor character to <strong>?</strong>. This is useful when you wish to use <strong>cpp</strong>(1) and the built-in preprocessor at the same time (see <strong>PREPROCESSOR</strong>). Characters may need to be quoted for your shell (example: <strong>-p'~'</strong> ).</p>
  </dd>
  <dt>
    <p><strong>--help</strong></p>
  </dt>
  <dd>
    <p>Show summary of options.</p>
  </dd>
  <dt>
    <p><strong>--version</strong></p>
  </dt>
  <dd>
    <p>Show version of program.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ASSEMBLER SYNTAX</h2>
        <div class="sectioncontent">
<p>An introduction to 6502 assembly language programming and mnemonics is beyond the scope of this manual page. We invite you to investigate any number of the excellent books on the subject; one useful title is "Machine Language For Beginners" by Richard Mansfield (COMPUTE!), covering the Atari, Commodore and Apple 8-bit systems, and is widely available on the used market.</p><p><strong>xa</strong> supports both the standard NMOS 6502 opcodes as well as the Rockwell CMOS opcodes used in the 65C02 (R65C02). With the <strong>-w</strong> option, <strong>xa</strong> will also accept opcodes for the 65816. NMOS 6502 undocumented opcodes are intentionally not supported, and should be entered manually using the <strong>.byte</strong> pseudo-op (see <strong>PSEUDO-OPS</strong>). Due to conflicts between the R65C02 and 65816 instruction sets and undocumented instructions on the NMOS 6502, their use is discouraged.</p><p>In general, <strong>xa</strong> accepts the more-or-less standard 6502 assembler format as popularised by MASM and TurboAssembler. Values and addresses can be expressed either as literals, or as expressions; to wit,</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>123</strong></p>
  </dt>
  <dd>
    <p>decimal value</p>
  </dd>
  <dt>
    <p><strong>$234</strong></p>
  </dt>
  <dd>
    <p>hexadecimal value</p>
  </dd>
  <dt>
    <p><strong>&123</strong></p>
  </dt>
  <dd>
    <p>octal</p>
  </dd>
  <dt>
    <p><strong>%010110</strong></p>
  </dt>
  <dd>
    <p>binary</p>
  </dd>
  <dt>
    <p><strong>*</strong></p>
  </dt>
  <dd>
    <p>current value of the program counter</p>
  </dd>

</dl>
<p>The ASCII value of any quoted character is inserted directly into the program text (example: <strong> A </strong> inserts the byte "A" into the output stream); see also the <strong>PSEUDO-OPS</strong> section. This is affected by the currently selected character set, if any.</p><p><strong>Labels</strong> define locations within the program text, just as in other multi-pass assemblers. A label is defined by anything that is not an opcode; for example, a line such as</p><ul>
<li><p><strong>label1 lda #0</strong></p></li>
</ul><p>defines <strong>label1</strong> to be the current location of the program counter (thus the address of the <strong>LDA</strong> opcode). A label can be explicitly defined by assigning it the value of an expression, such as</p><ul>
<li><p><strong>label2 = $d000</strong></p></li>
</ul><p>which defines <strong>label2</strong> to be the address $d000, namely, the start of the VIC-II register block on Commodore 64 computers. The program counter <strong>*</strong> is considered to be a special kind of label, and can be assigned to with statements such as</p><ul>
<li><p><strong>* = $c000</strong></p></li>
</ul><p>which sets the program counter to decimal location 49152. With the exception of the program counter, labels cannot be assigned multiple times. To explicitly declare redefinition of a label, place a - (dash) before it, e.g.,</p><ul>
<li><p><strong>-label2 = $d020</strong></p></li>
</ul><p>which sets <strong>label2</strong> to the Commodore 64 border colour register. The scope of a label is affected by the block it resides within (see <strong>PSEUDO-OPS</strong> for block instructions). A label may also be hard-specified with the <strong>-L</strong> command line option.</p><p>For those instructions where the accumulator is the implied argument (such as <strong>asl</strong> and <strong>lsr</strong>; <strong>inc</strong> and <strong>dec</strong> on R65C02; etc.), the idiom of explicitly specifying the accumulator with <strong>a</strong> is unnecessary as the proper form will be selected if there is no explicit argument. In fact, for consistency with label handing, if there is a label named <strong>a</strong>, this will actually generate code referencing that label as a memory location and not the accumulator. Otherwise, the assembler will complain.</p><p>Labels and opcodes may take <strong>expressions</strong> as their arguments to allow computed values, and may themselves reference other labels and/or the program counter. An expression such as <strong>lab1+1</strong> (which operates on the current value of label <strong>lab1</strong> and increments it by one) may use the following operands, given from highest to lowest priority:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>*</strong></p>
  </dt>
  <dd>
    <p>multiplication (priority 10)</p>
  </dd>
  <dt>
    <p><strong>/</strong></p>
  </dt>
  <dd>
    <p>integer division (priority 10)</p>
  </dd>
  <dt>
    <p><strong>+</strong></p>
  </dt>
  <dd>
    <p>addition (priority 9)</p>
  </dd>
  <dt>
    <p><strong>-</strong></p>
  </dt>
  <dd>
    <p>subtraction (9)</p>
  </dd>
  <dt>
    <p><strong>&lt;&lt;</strong></p>
  </dt>
  <dd>
    <p>shift left (8)</p>
  </dd>
  <dt>
    <p><strong>&gt;&gt;</strong></p>
  </dt>
  <dd>
    <p>shift right (8)</p>
  </dd>
  <dt>
    <p><strong>&gt;= =&gt;</strong></p>
  </dt>
  <dd>
    <p>greater than or equal to (7)</p>
  </dd>
  <dt>
    <p><strong>&lt;</strong></p>
  </dt>
  <dd>
    <p>greater than (7)</p>
  </dd>
  <dt>
    <p><strong>&lt;= =&lt;</strong></p>
  </dt>
  <dd>
    <p>less than or equal to (7)</p>
  </dd>
  <dt>
    <p><strong>&lt;</strong></p>
  </dt>
  <dd>
    <p>less than (7)</p>
  </dd>
  <dt>
    <p><strong>=</strong></p>
  </dt>
  <dd>
    <p>equal to (6)</p>
  </dd>
  <dt>
    <p><strong>&lt;&gt; &gt;&lt;</strong></p>
  </dt>
  <dd>
    <p>does not equal (6)</p>
  </dd>
  <dt>
    <p><strong>&</strong></p>
  </dt>
  <dd>
    <p>bitwise AND (5)</p>
  </dd>
  <dt>
    <p><strong>^</strong></p>
  </dt>
  <dd>
    <p>bitwise XOR (4)</p>
  </dd>
  <dt>
    <p><strong>|</strong></p>
  </dt>
  <dd>
    <p>bitwise OR (3)</p>
  </dd>
  <dt>
    <p><strong>&&</strong></p>
  </dt>
  <dd>
    <p>logical AND (2)</p>
  </dd>
  <dt>
    <p><strong>||</strong></p>
  </dt>
  <dd>
    <p>logical OR (1)</p>
  </dd>

</dl>
<p>Parentheses are valid. When redefining a label, combining arithmetic or bitwise operators with the = (equals) operator such as <strong>+=</strong> and so on are valid, e.g.,</p><ul>
<li><p><strong>-redeflabel += (label12/4)</strong></p></li>
</ul><p>Normally, <strong>xa</strong> attempts to ascertain the value of the operand and (when referring to a memory location) use zero page, 16-bit or (for 65816) 24-bit addressing where appropriate and where supported by the particular opcode. This generates smaller and faster code, and is almost always preferable.</p><p>Nevertheless, you can use these prefix operators to force a particular rendering of the operand. Those that generate an eight bit result can also be used in 8-bit addressing modes, such as immediate and zero page.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>&lt;</strong></p>
  </dt>
  <dd>
    <p>low byte of expression, e.g., <strong>lda #&lt;vector</strong></p>
  </dd>
  <dt>
    <p><strong>&gt;</strong></p>
  </dt>
  <dd>
    <p>high byte of expression</p>
  </dd>
  <dt>
    <p><strong>!</strong></p>
  </dt>
  <dd>
    <p>in situations where the expression could be understood as either an absolute or zero page value, do not attempt to optimize to a zero page argument for those opcodes that support it (i.e., keep as 16 bit word)</p>
  </dd>
  <dt>
    <p><strong>@</strong></p>
  </dt>
  <dd>
    <p>render as 24-bit quantity for 65816 (must specify <strong>-w</strong> command-line option). <strong>This is required to specify any</strong> <strong>24-bit quantity!</strong></p>
  </dd>
  <dt>
    <p><strong>`</strong></p>
  </dt>
  <dd>
    <p>force further optimization, even if the length of the instruction cannot be reliably determined (see <strong>NOTES'N'BUGS</strong>)</p>
  </dd>

</dl>
<p>Expressions can occur as arguments to opcodes or within the preprocessor (see <strong>PREPROCESSOR</strong> for syntax). For example,</p><ul>
<li><p><strong>lda label2+1</strong></p></li>
</ul><p>takes the value at <strong>label2+1</strong> (using our previous label's value, this would be $d021), and will be assembled as <strong>$ad $21 $d0</strong> to disk. Similarly,</p><ul>
<li><p><strong>lda #&lt;label2</strong></p></li>
</ul><p>will take the lowest 8 bits of <strong>label2</strong> (i.e., $20), and assign them to the accumulator (assembling the instruction as <strong>$a9 $20</strong> to disk).</p><p>Comments are specified with a semicolon (;), such as</p><ul>
<li><p><strong>;this is a comment</strong></p></li>
</ul><p>They can also be specified in the C language style, using <strong>/* */</strong> and <strong>//</strong> which are understood at the <strong>PREPROCESSOR</strong> level (q.v.).</p><p>Normally, the colon (:) separates statements, such as</p><ul>
<li><p><strong>label4 lda #0:sta $d020</strong></p></li>
</ul><p>or</p><ul>
<li><p><strong>label2: lda #2</strong></p></li>
</ul><p>(note the use of a colon for specifying a label, similar to some other assemblers, which <strong>xa</strong> also understands with or without the colon). This also applies to semicolon comments, such that</p><ul>
<li><p><strong>; a comment:lda #0</strong></p></li>
</ul><p>is understood as a comment followed by an opcode. To defeat this, use the <strong>-M</strong> command line option to allow colons within comments. This does not apply to <strong>/* */</strong> and <strong>//</strong> comments, which are dealt with at the preprocessor level (q.v.).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PSEUDO-OPS</h2>
        <div class="sectioncontent">
<p><strong>Pseudo-ops</strong> are false opcodes used by the assembler to denote meta- or inlined commands. Like most assemblers, <strong>xa</strong> has a rich set.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>.byt value1,value2,value3,...</strong></p>
  </dt>
  <dd>
    <p>Specifies a string of bytes to be directly placed into the assembled object. The arguments may be expressions. Any number of bytes can be specified.</p>
  </dd>
  <dt>
    <p><strong>.asc  text1  ,"text2",...</strong></p>
  </dt>
  <dd>
    <p>Specifies a character string which will be inserted into the assembled object. Strings are understood according to the currently specified character set; for example, if ASCII is specified, they will be rendered as ASCII, and if PETSCII is specified, they will be translated into the equivalent Commodore ASCII equivalent. Other non-standard ASCIIs such as ATASCII for Atari computers should use the ASCII equivalent characters; graphic and control characters should be specified explicitly using <strong>.byt</strong> for the precise character you want. Note that when specifying the argument of an opcode, <strong>.asc</strong> is not necessary; the quoted character can simply be inserted (e.g., <strong>lda #"A"</strong> ), and is also affected by the current character set. Any number of character strings can be specified.</p>
  </dd>

</dl>
<p><strong>.byt</strong> and <strong>.asc</strong> are synonymous, so you can mix things such as <strong>.byt $43, 22,  a character string </strong> and get the expected result. The string is subject to the current character set, but the remaining bytes are inserted wtihout modification.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>.aasc  text1  ,"text2",...</strong></p>
  </dt>
  <dd>
    <p>Specifies a character string that is <strong>always</strong> rendered in true ASCII regardless of the current character set. Like <strong>.asc</strong>, it is synonymous with <strong>.byt</strong>.</p>
  </dd>
  <dt>
    <p><strong>.word value1,value2,value3...</strong></p>
  </dt>
  <dd>
    <p>Specifies a string of 16-bit words to be placed into the assembled object in 6502 little-endian format (that is, low-byte/high-byte). The arguments may be expressions. Any number of words can be specified.</p>
  </dd>
  <dt>
    <p><strong>.dsb length,fillbyte</strong></p>
  </dt>
  <dd>
    <p>Specifies a data block; a total of <strong>length</strong> repetitions of <strong>fillbyte</strong> will be inserted into the assembled object. For example, <strong>.dsb 5,$10</strong> will insert five bytes, each being 16 decimal, into the object. The arguments may be expressions.</p>
  </dd>
  <dt>
    <p><strong>.bin offset,length,"filename"</strong></p>
  </dt>
  <dd>
    <p>Inlines a binary file without further interpretation specified by <strong>filename</strong> from offset <strong>offset</strong> to length <strong>length</strong>. This allows you to insert data such as a previously assembled object file or an image or other binary data structure, inlined directly into this file's object. If <strong>length</strong> is zero, then the length of <strong>filename</strong>, minus the offset, is used instead. The arguments may be expressions.</p>
  </dd>
  <dt>
    <p><strong>.(</strong></p>
  </dt>
  <dd>
    <p>Opens a new block for scoping. Within a block, all labels defined are local to that block and any sub-blocks, and go out of scope as soon as the enclosing block is closed (i.e., lexically scoped). All labels defined outside of the block are still visible within it. To explicitly declare a global label within a block, precede the label with <strong>+</strong> or precede it with <strong>&</strong> to declare it within the previous level only (or globally if you are only one level deep). Sixteen levels of scoping are permitted.</p>
  </dd>
  <dt>
    <p><strong>.)</strong></p>
  </dt>
  <dd>
    <p>Closes a block.</p>
  </dd>
  <dt>
    <p><strong>.as .al .xs .xl</strong></p>
  </dt>
  <dd>
    <p>Only relevant in 65816 mode (with the <strong>-w</strong> option specified). These pseudo-ops set what size accumulator and X/Y-register should be used for future instructions; <strong>.as</strong> and <strong>.xs</strong> set 8-bit operands for the accumulator and index registers, respectively, and <strong>.al</strong> and <strong>.xl</strong> set 16-bit operands. These pseudo-ops on purpose do not automatically issue <strong>sep</strong> and <strong>rep</strong> instructions to set the specified width in the CPU; set the processor bits as you need, or consider constructing a macro. <strong>.al</strong> and <strong>.xl</strong> generate errors if <strong>-w</strong> is not specified.</p>
  </dd>

</dl>
<p>The following pseudo-ops apply primarily to relocatable .o65 objects. A full discussion of the relocatable format is beyond the scope of this manpage, as it is currently a format in flux. Documentation on the proposed v1.2 format is in <strong>doc/fileformat.txt</strong> within the <strong>xa</strong> installation directory.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>.text .data .bss .zero</strong></p>
  </dt>
  <dd>
    <p>These pseudo-ops switch between the different segments, .text being the actual code section, .data being the data segment, .bss being uninitialized label space for allocation and .zero being uninitialized zero page space for allocation. In .bss and .zero, only labels are evaluated. These pseudo-ops are valid in relative and absolute modes.</p>
  </dd>
  <dt>
    <p><strong>.align value</strong></p>
  </dt>
  <dd>
    <p>Aligns the current segment to a byte boundary (2, 4 or 256) as specified by <strong></strong> value (and places it in the header when relative mode is enabled). Other values generate an error.</p>
  </dd>
  <dt>
    <p><strong>.fopt type,value1,value2,value3,...</strong></p>
  </dt>
  <dd>
    <p>Acts like <strong>.byt/.asc</strong> except that the values are embedded into the object file as file options. The argument <strong>type</strong> is used to specify the file option being referenced. A table of these options is in the relocatable o65 file format description. The remainder of the options are interpreted as values to insert. Any number of values may be specified, and may also be strings.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PREPROCESSOR</h2>
        <div class="sectioncontent">
<p><strong>xa</strong> implements a preprocessor very similar to that of the C-language preprocessor <strong>cpp</strong>(1) and many oddiments apply to both. For example, as in C, the use of <strong>/* */</strong> for comment delimiters is also supported in <strong>xa</strong>, and so are comments using the double slash <strong>//</strong>. The preprocessor also supports continuation lines, i.e., lines ending with a backslash (&#92;); the following line is then appended to it as if there were no dividing newline. This too is handled at the preprocessor level.</p><p>For reasons of memory and complexity, the full breadth of the <strong>cpp</strong>(1) syntax is not fully supported. In particular, macro definitions may not be forward-defined (i.e., a macro definition can only reference a previously defined macro definition), except for macro functions, where recursive evaluation is supported; e.g., to <strong>#define WW AA</strong> , <strong>AA</strong> must have already been defined. Certain other directives are not supported, nor are most standard pre-defined macros, and there are other limits on evaluation and line length. Because the maintainers of <strong>xa</strong> recognize that some files will require more complicated preparsing than the built-in preprocessor can supply, the preprocessor will accept <strong>cpp</strong>(1)-style line/filename/flags output. When these lines are seen in the input file, <strong>xa</strong> will treat them as <strong>cc</strong> would, except that flags are ignored. <strong>xa</strong> does not accept files on standard input for parsing reasons, so you should dump your <strong>cpp</strong>(1) output to an intermediate temporary file, such as</p><ul>
<li><p><strong>cc -E test.s &gt; test.xa</strong></p><p><strong>xa test.xa</strong></p></li>
</ul><p>No special arguments need to be passed to <strong>xa</strong>; the presence of <strong>cpp</strong>(1) output is detected automatically.</p><p>Note that passing your file through <strong>cpp</strong>(1) may interfere with <strong>xa</strong>'s own preprocessor directives. In this case, to mask directives from <strong>cpp</strong>(1), use the <strong>-p</strong> option to specify an alternative character instead of <strong>#</strong>, such as the tilde (e.g., <strong>-p'~'</strong> ). With this option and argument specified, then instead of <strong>#include</strong>, for example, you can also use <strong>~include</strong>, in addition to <strong>#include</strong> (which will also still be accepted by the <strong>xa</strong> preprocessor, assuming any survive <strong>cpp</strong>(1)). Any character can be used, although frankly pathologic choices may lead to amusing and frustrating glitches during parsing. You can also use this option to defer preprocessor directives that <strong>cpp</strong>(1) may interpret too early until the file actually gets to <strong>xa</strong> itself for processing.</p><p>The following preprocessor directives are supported.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>#include  filename </strong></p>
  </dt>
  <dd>
    <p>Inserts the contents of file <strong>filename</strong> at this position. If the file is not found, it is searched using paths specified by the <strong>-I</strong> command line option or the environment variable <strong>XAINPUT</strong> (q.v.). When inserted, the file will also be parsed for preprocessor directives.</p>
  </dd>
  <dt>
    <p><strong>#echo comment</strong></p>
  </dt>
  <dd>
    <p>Inserts comment <strong>comment</strong> into the errorlog file, specified with the <strong>-e</strong> command line option.</p>
  </dd>
  <dt>
    <p><strong>#print expression</strong></p>
  </dt>
  <dd>
    <p>Computes the value of expression <strong>expression</strong> and prints it into the errorlog file.</p>
  </dd>
  <dt>
    <p><strong>#define DEFINE text</strong></p>
  </dt>
  <dd>
    <p>Equates macro <strong>DEFINE</strong> with text <strong>text</strong> such that wherever <strong>DEFINE</strong> appears in the assembly source, <strong>text</strong> is substituted in its place (just like <strong>cpp</strong>(1) would do). In addition, <strong>#define</strong> can specify macro functions like <strong>cpp</strong>(1) such that a directive like <strong>#define mult(a,b) ((a)*(b))</strong> would generate the expected result wherever an expression of the form <strong>mult(a,b)</strong> appears in the source. This can also be specified on the command line with the <strong>-D</strong> option. The arguments of a macro function may be recursively evaluated, unlike other <strong>#define</strong>s; the preprocessor will attempt to re-evaluate any argument refencing another preprocessor definition up to ten times before complaining.</p>
  </dd>

</dl>
<p>The following directives are conditionals. If the conditional is not satisfied, then the source code between the directive and its terminating <strong>#endif</strong> are expunged and not assembled. Up to fifteen levels of nesting are supported.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>#endif</strong></p>
  </dt>
  <dd>
    <p>Closes a conditional block.</p>
  </dd>
  <dt>
    <p><strong>#else</strong></p>
  </dt>
  <dd>
    <p>Implements alternate path for a conditional block.</p>
  </dd>
  <dt>
    <p><strong>#ifdef DEFINE</strong></p>
  </dt>
  <dd>
    <p>True only if macro <strong>DEFINE</strong> is defined.</p>
  </dd>
  <dt>
    <p><strong>#ifndef DEFINE</strong></p>
  </dt>
  <dd>
    <p>The opposite; true only if macro <strong>DEFINE</strong> has not been previously defined.</p>
  </dd>
  <dt>
    <p><strong>#if expression</strong></p>
  </dt>
  <dd>
    <p>True if expression <strong>expression</strong> evaluates to non-zero. <strong>expression</strong> may reference other macros.</p>
  </dd>
  <dt>
    <p><strong>#iflused label</strong></p>
  </dt>
  <dd>
    <p>True if label <strong>label</strong> has been used (but not necessarily instantiated with a value). <em>This works on labels, not macros!</em></p>
  </dd>
  <dt>
    <p><strong>#ifldef label</strong></p>
  </dt>
  <dd>
    <p>True if label <strong>label</strong> is defined <em>and</em> assigned with a value. <em>This works on labels, not macros!</em></p>
  </dd>

</dl>
<p>Unclosed conditional blocks at the end of included files generate warnings; unclosed conditional blocks at the end of assembly generate an error.</p><p><strong>#iflused</strong> and <strong>#ifldef</strong> are useful for building up a library based on labels. For example, you might use something like this in your library's code:</p><ul>
<li><p><strong>#iflused label</strong></p><p><strong>#ifldef label</strong></p><p><strong>#echo label already defined, library function label cannot be inserted</strong></p><p><strong>#else</strong></p><p><strong>label /* your code */</strong></p><p><strong>#endif</strong></p><p><strong>#endif</strong></p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">
<p><strong>xa</strong> utilises the following environment variables, if they exist:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>XAINPUT</strong></p>
  </dt>
  <dd>
    <p>Include file path; components should be separated by `,'.</p>
  </dd>
  <dt>
    <p><strong>XAOUTPUT</strong></p>
  </dt>
  <dd>
    <p>Output file path.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES'N'BUGS</h2>
        <div class="sectioncontent">
<p>The R65C02 instructions <strong>ina</strong> (often rendered <strong>inc</strong> <strong>a</strong>) and <strong>dea</strong> (<strong>dec</strong> <strong>a</strong>) must be rendered as bare <strong>inc</strong> and <strong>dec</strong> instructions respectively.</p><p>Forward-defined labels -- that is, labels that are defined after the current instruction is processed -- cannot be optimized into zero page instructions even if the label does end up being defined as a zero page location, because the assembler does not know the value of the label in advance during the first pass when the length of an instruction is computed. On the second pass, a warning will be issued when an instruction that could have been optimized can't be because of this limitation. (Obviously, this does not apply to branching or jumping instructions because they're not optimizable anyhow, and those instructions that can <em>only</em> take an 8-bit parameter will always be casted to an 8-bit quantity.) If the label cannot otherwise be defined ahead of the instruction, the backtick prefix <strong>`</strong> may be used to force further optimization no matter where the label is defined as long as the instruction supports it. Indiscriminately forcing the issue can be fraught with peril, however, and is not recommended; to discourage this, the assembler will complain about its use in addressing mode situations where no ambiguity exists, such as indirect indexed, branching and so on.</p><p>Also, as a further consequence of the way optimization is managed, we repeat that <strong>all</strong> 24-bit quantities and labels that reference a 24-bit quantity in 65816 mode, anteriorly declared or otherwise, <strong>MUST</strong> be prepended with the <strong>@</strong> prefix. Otherwise, the assembler will attempt to optimize to 16 bits, which may be undesirable.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO xa&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/file65.1.html"><strong>file65</strong>(1)</a>, <a href="../man1/ldo65.1.html"><strong>ldo65</strong>(1)</a>, <a href="../man1/printcbm.1.html"><strong>printcbm</strong>(1)</a>, <a href="../man1/reloc65.1.html"><strong>reloc65</strong>(1)</a>, <a href="../man1/uncpk.1.html"><strong>uncpk</strong>(1)</a>, <strong>dxa</strong>(1)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>This manual page was written by David Weinehall &lt;tao@acc.umu.se&gt;, Andre Fachat &lt;fachat@web.de&gt; and Cameron Kaiser &lt;ckaiser@floodgap.com&gt;. Original xa package (C)1989-1997 Andre Fachat. Additional changes (C)1989-2009 Andre Fachat, Jolse Maginnis, David Weinehall, Cameron Kaiser. The official maintainer is Cameron Kaiser.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">WEBSITE</h2>
        <div class="sectioncontent">
<p>http://www.floodgap.com/retrotech/xa/</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="x86dis.1.html"><span aria-hidden="true">&larr;</span> x86dis.1: Disassemble a bytestream of intel x86 instructions</a></li>
   <li class="next"><a href="xalan.1.html">xalan.1: Process xml documents with xslt stylesheets <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
