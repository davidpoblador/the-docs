<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>capsh - capability shell wrapper</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Capability shell wrapper">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">capsh<small> (1)</small></h1>
        <p class="lead">Capability shell wrapper</p>
      </div>

    <ol class="breadcrumb">
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="https://www.carta.tech/man-pages/"><span itemprop="title">Linux Man Pages</span></a>
	</li>
	<li id="breadcrumb_section" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_page" itemprop="child">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man1/"><span itemprop="title">Executable programs or shell commands</span></a>
	</li>
	<li id="breadcrumb_page" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="active">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man1/capsh.1.html"><span itemprop="title">capsh</span></a>
	</li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p><strong>capsh</strong> [<em>OPTION</em>]...</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p>Linux capability support and use can be explored and constrained with this tool. This tool provides a handy wrapper for certain types of capability testing and environment creation. It also provides some debugging features useful for summarizing capability state.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

  <p>The tool takes a number of optional arguments, acting on them in the order they are provided. They are as follows:</p>
  <dl class='dl-vertical'>
    <dt><strong>--print</strong></dt>
    <dd>
  <p>Display prevailing capability and related state.</p>
    </dd>
    <dt><strong>--</strong><em> [args]</em></dt>
    <dd>
  <p>Execute <strong>/bin/bash</strong> with trailing arguments. Note, you can use <strong>-c 'command to execute'</strong> for specific commands.</p>
    </dd>
    <dt><strong>==</strong></dt>
    <dd>
  <p>Execute <strong>capsh</strong> again with remaining arguments. Useful for testing <strong>exec</strong>() behavior.</p>
    </dd>
    <dt><strong>--caps=</strong><em>cap-set</em></dt>
    <dd>
  <p>Set the prevailing process capabilities to those specified by <em>cap-set</em>. Where <em>cap-set</em> is a text-representation of capability state as per <a href="../man3/cap_from_text.3.html"><strong>cap_from_text</strong>(3)</a>.</p>
    </dd>
    <dt><strong>--drop=</strong><em>cap-list</em></dt>
    <dd>
  <p>Remove the listed capabilities from the prevailing bounding set. The capabilites are a comma separated list of capabilities as recognized by the <a href="../man3/cap_from_name.3.html"><strong>cap_from_name</strong>(3)</a> function. Use of this feature requires that the capsh program is operating with <strong>CAP_SETPCAP</strong> in its effective set.</p>
    </dd>
    <dt><strong>--inh=</strong><em>cap-list</em></dt>
    <dd>
  <p>Set the inheritable set of capabilities for the current process to equal those provided in the comma separated list. For this action to succeed, the prevailing process should already have each of these capabilities in the union of the current inheritable and permitted capability sets, or the capsh program is operating with <strong>CAP_SETPCAP</strong> in its effective set.</p>
    </dd>
    <dt><strong>--user=</strong><em>username</em></dt>
    <dd>
  <p>Assume the identity of the named user. That is, look up the user's <em>uid</em> and <em>gid</em> with <a href="../man3/getpwuid.3.html"><strong>getpwuid</strong>(3)</a> and their group memberships with <a href="../man3/getgrouplist.3.html"><strong>getgrouplist</strong>(3)</a> and set them all.</p>
    </dd>
    <dt><strong>--uid=</strong><em>id</em></dt>
    <dd>
  <p>Force all <strong>uid</strong> values to equal <em>id</em> using the <a href="../man2/setuid.2.html"><strong>setuid</strong>(2)</a> system call.</p>
    </dd>
    <dt><strong>--gid=</strong><em>&lt;id&gt;</em></dt>
    <dd>
  <p>Force all <strong>gid</strong> values to equal <em>id</em> using the <a href="../man2/setgid.2.html"><strong>setgid</strong>(2)</a> system call.</p>
    </dd>
    <dt><strong>--groups=</strong><em>&lt;id-list&gt;</em></dt>
    <dd>
  <p>Set the supplementary groups to the numerical list provided. The groups are set with the <a href="../man2/setgroups.2.html"><strong>setgroups</strong>(2)</a> system call.</p>
    </dd>
    <dt><strong>--keep=</strong><em>&lt;0|1&gt;</em></dt>
    <dd>
  <p>In a non-pure capability mode, the kernel provides liberal privilege to the super-user. However, it is normally the case that when the super-user changes <em>uid</em> to some lesser user, then capabilities are dropped. For these situations, the kernel can permit the process to retain its capabilities after a <a href="../man2/setuid.2.html"><strong>setuid</strong>(2)</a> system call. This feature is known as <em>keep-caps</em> support. The way to activate it using this script is with this argument. Setting the value to 1 will cause <em>keep-caps</em> to be active. Setting it to 0 will cause keep-caps to deactivate for the current process. In all cases, <em>keep-caps</em> is deactivated when an <strong>exec</strong>() is performed. See <strong>--secbits</strong> for ways to disable this feature.</p>
    </dd>
    <dt><strong>--secbits=</strong><em>N</em></dt>
    <dd>
  <p>XXX - need to document this feature.</p>
    </dd>
    <dt><strong>--chroot=</strong><em>path</em></dt>
    <dd>
  <p>Execute the <a href="../man2/chroot.2.html"><strong>chroot</strong>(2)</a> system call with the new root-directory (/) equal to <em>path</em>. This operation requires <strong>CAP_SYS_CHROOT</strong> to be in effect.</p>
    </dd>
    <dt><strong>--forkfor=</strong><em>sec</em></dt>
    <dd>
    </dd>
    <dt><strong>--killit=</strong><em>sig</em></dt>
    <dd>
    </dd>
    <dt><strong>--decode=</strong><em>N</em></dt>
    <dd>
  <p>This is a convenience feature. If you look at <strong>/proc/1/status</strong> there are some capability related fields of the following form:</p>
<p class='spacer'>

<pre> CapInh:	0000000000000000
 CapPrm:	ffffffffffffffff
 CapEff:	fffffffffffffeff
 CapBnd:	ffffffffffffffff</pre>

<p class='spacer'>

  <p>This option provides a quick way to decode a capability vector represented in this form. For example, the missing capability from this effective set is 0x0100. By running:</p>
<p class='spacer'>

<pre> capsh --decode=0x0100</pre>

<p class='spacer'>

  <p>we observe that the missing capability is: <strong>cap_setpcap</strong>.</p>
    </dd>
    <dt><strong>--supports=</strong><em>xxx</em></dt>
    <dd>
  <p>As the kernel evolves, more capabilities are added. This option can be used to verify the existence of a capability on the system. For example, <strong>--supports=</strong><em>cap_syslog</em> will cause capsh to promptly exit with a status of 1 when run on kernel 2.6.27.  However, when run on kernel 2.6.38 it will silently succeed.</p>
    </dd>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">

  <dl class='dl-vertical'>
    <dt>Following successful execution the tool exits with status 0. Following</dt>
    <dd>
  <p>an error, the tool immediately exits with status 1.</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">

<p>Written by Andrew G. Morgan &lt;morgan@kernel.org&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">

<p>Please report bugs to the author.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<p><a href="../man3/libcap.3.html"><strong>libcap</strong>(3)</a>, <a href="../man8/getcap.8.html"><strong>getcap</strong>(8)</a>,<a href="../man8/setcap.8.html"><strong>setcap</strong>(8)</a> and <a href="../man7/capabilities.7.html"><strong>capabilities</strong>(7)</a>.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="cal.1.html"><span aria-hidden="true">&larr;</span> cal.1: display a calendar</a></li>
   <li class="next"><a href="captoinfo.1.html">captoinfo.1: convert a <em>termcap</em> description into a <em>terminfo</em> description <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
