<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>mrtg-unix-guide: The mrtg 2.17.4 linux/unix installation guide</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="The mrtg 2.17.4 linux/unix installation guide">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="mrtg-unix-guide (1) manual">
  <meta name="twitter:description" content="The mrtg 2.17.4 linux/unix installation guide">
  <meta name="twitter:image" content="https://www.carta.tech/images/mrtg-mrtg-unix-guide-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/mrtg-unix-guide.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="mrtg-unix-guide (1) manual" />
  <meta property="og:description" content="The mrtg 2.17.4 linux/unix installation guide" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/mrtg-mrtg-unix-guide-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">mrtg-unix-guide<small> (1)</small></h1>
        <p class="lead">The mrtg 2.17.4 linux/unix installation guide</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/mrtg-unix-guide.1.html">
      <span itemprop="name">mrtg-unix-guide: The mrtg 2.17.4 linux/unix installation guide</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/mrtg/">
      <span itemprop="name">mrtg</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/mrtg-unix-guide.1.html">
      <span itemprop="name">mrtg-unix-guide: The mrtg 2.17.4 linux/unix installation guide</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>\s-1MRTG\s0 comes to you in Source Code. This means that you have to compile parts of it before you can use it on a Unix machine. These instructions help you to do so.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PREPARATION</h2>
        <div class="sectioncontent">
<p>In order to compile and use mrtg you need a C compiler and a copy of perl installed on your machine. In most cases this will already be available. In case it is not, here are some starting points. Below I'll give you a detailed run through the whole compilation process.</p>
<dl class='dl-vertical'>
  <dt>
    \s-1GCC\s0
  </dt>
  <dd>
    <p>The \s-1GNU\s0 C compiler comes preinstalled on most of the free Unicies out there.  For commercial derivatives you may have to download and compile it first. If you have no compiler at all there is a chicken and egg problem, but there are also precompiled versions of gcc available for most operating systems.</p>
<pre>
 http://gcc.gnu.org/
</pre>

  </dd>
  <dt>
    Perl
  </dt>
  <dd>
    <p>Large parts of the \s-1MRTG\s0 system are written in the Perl scripting language. Make sure there is a recent copy of perl on your machine (try perl -v). At least version 5.005 is required for mrtg to work well. If you use \s-1SNMPV3\s0 and other new features you should use at least 5.8. You can get the latest perl from  http://www.perl.com/</p>
  </dd>

</dl>
<p>\s-1MRTG\s0 generates traffic graphs in the \s-1PNG\s0 format. To be able to do this it needs several 3rd party libraries. When compiling these libraries I urge you to make sure you compile them as <strong>static</strong> libraries. There is just much less trouble ahead if you are doing it like this. See the Instructions in the next section for inspiration. Note that many free unices have all the required libraries already in place so there is no need to install another copy. To check it is best to skip all the library instructions below and go straight into the mrtg compile.</p><p>If the first attempt fails and you do not get a working version of mrtg, try compiling new copies of all libraries as explained below. Do this <strong>\s-1BEFORE\s0</strong> you send email to me about problems compiling mrtg.</p>
<dl class='dl-vertical'>
  <dt>
    gd
  </dt>
  <dd>
    <p>This is a basic graph drawing library created by Thomas Boutell. Note that all releases after Version 1.3 only create \s-1PNG\s0 images. This is because a) Thomas got into trouble because the \s-1GIF\s0 format which it used to produce uses a compression technology patented by Unisys. b) \s-1PNG\s0 is more efficient and patent free. \s-1MRTG\s0 can work with old and new version of the \s-1GD\s0 library. You can get a recent copy of \s-1GD\s0 from:  http://www.boutell.com/gd/</p>
  </dd>
  <dt>
    libpng
  </dt>
  <dd>
    <p>Is required by gd in order to produce \s-1PNG\s0 graphics files. Get it from:  http://www.libpng.org/pub/png/libpng.html</p>
  </dd>
  <dt>
    zlib
  </dt>
  <dd>
    <p>Is needed by libpng to compress the graphics files you create. Get a copy from  http://www.gzip.org/zlib</p>
  </dd>

</dl>
<p>And last but not least you also need mrtg itself. In case you have not yet downloaded it, you can find a copy on my website:</p><p> http://oss.oetiker.ch/mrtg/pub</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LIBRARY COMPILATION</h2>
        <div class="sectioncontent">
<p>In this section I will give you step by step instructions on how to compile the various libraries required for the compilation of mrtg. Note that these libraries may already be installed if you have a <em>*BSD</em> or <em>Linux</em> system so you can skip recompiling them. The <strong>wget</strong> program used below is a simple web downloader. You can also enter the address into your <strong>netscape</strong> if you don't have <strong>wget</strong> available.</p><p>First let's create a directory for the compilation. Note that this may already exist on your system. No problem, just use it.</p><p> mkdir -p /usr/local/src  cd /usr/local/src</p><p>If you do not have zlib installed:</p><p> wget http://www.zlib.net/zlib-1.2.3.tar.gz  gunzip -c zlib-*.tar.gz | tar xf -  rm zlib-*.tar.gz  mv zlib-* zlib  cd zlib  ./configure  make  cd ..</p><p>If you don't have libpng installed</p><p> wget ftp://ftp.simplesystems.org/pub/libpng/png/src/libpng-1.2.40.tar.gz  gunzip -c libpng-1.2.34.tar.gz | tar xf -  mv libpng-* libpng  cd libpng  env CFLAGS="-O3 -fPIC" ./configure --prefix=$INSTALL_DIR  make  rm *.so.* *.so  cd ..</p><p>And now you can compile gd</p><p>For versions up to 1.8.4, try:</p><p> wget http://www.boutell.com/gd/http/gd-1.8.4.tar.gz  gunzip -c gd-*.tar.gz |tar xf -  rm gd-*.tar.gz  mv gd-* gd  cd gd</p><p>The &#92; characters at the end of the following lines mean that all the following material should actually be written on a single line.</p><p> perl -i~ -p -e s/gd_jpeg.o//g Makefile  make INCLUDEDIRS="-I. -I../zlib -I../libpng" &#92;       LIBDIRS="-L../zlib -L. -L../libpng" &#92;       LIBS="-lgd -lpng -lz -lm" &#92;       CFLAGS="-O -DHAVE_LIBPNG"  cd ..</p><p>For versions starting around 2.0.11, try:</p><p> wget http://www.boutell.com/gd/http/gd-2.0.33.tar.gz  gunzip -c gd-2.0.33.tar.gz |tar xf -  mv gd-2.0.33 gd  cd gd  env CPPFLAGS="-I../zlib -I../libpng" LDFLAGS="-L../zlib -L../libpng" &#92;      ./configure --disable-shared --without-freetype --without-jpeg  make  cp .libs/* .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MRTG COMPILATION</h2>
        <div class="sectioncontent">
<p>Ok, now everything is ready for the mrtg compilation.</p><p> cd /usr/local/src  gunzip -c mrtg-2.17.4.tar.gz | tar xvf -  cd mrtg-2.17.4</p><p>If all the libraries have been preinstalled on your system you can configure mrtg by doing a simple:</p><p> ./configure --prefix=/usr/local/mrtg-2</p><p>Otherwise you may have to give some hints on where to find the various libraries required to compile mrtg:</p><p> ./configure --prefix=/usr/local/mrtg-2       &#92;              --with-gd=/usr/local/src/gd      &#92;              --with-z=/usr/local/src/zlib     &#92;              --with-png=/usr/local/src/libpng</p><p>If you have RRDtool available you might want to tell mrtg about it so that you can opt to use rrdtool with mrtg. Check mrtg-rrd.</p><p>Configure will make sure your environment is fit for building mrtg. If it finds a problem, it will tell you so and it will also tell you what to do about it. If everything is \s-1OK\s0, you will end up with a custom Makefile for your system. Now type:</p><p> make</p><p>This builds the rateup binary and edits all the perl pathnames in the scripts. You can now install mrtg by typing</p><p> make install   (requires gnu install)</p><p>All the software required by \s-1MRTG\s0 is now installed under the <em>/usr/local/mrtg-2</em> subdirectory.</p><p>You can now safely delete the libraries we compiled above. Then again, you might want to keep them around so that you have them available when compiling the next version of mrtg.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION</h2>
        <div class="sectioncontent">
<p>The next step is to configure mrtg for monitoring a network device.  This is done by creating an <em>mrtg.cfg</em> file which defines what you want to monitor. Luckily, you don't have to dive straight in and start writing your own configuration file all by yourself. Together with mrtg you also got a copy of <strong>cfgmaker</strong>. This is a script you can point at a router of your choice; it will create a mrtg configuration file for you. You can find the script in the <em>bin</em> subdirectory.</p><p> cfgmaker --global &apos;WorkDir: /home/httpd/mrtg&apos;  &#92;           --global &apos;Options[_]: bits,growright&apos; &#92;           --output /home/mrtg/cfg/mrtg.cfg    &#92;            community@router.abc.xyz</p><p>This example above will create an mrtg config file in <em>/home/mrtg/cfg</em> assuming this is a directory visible on your webserver. You can read all about cfgmaker in cfgmaker. One area you might want to look at is the possibility of using <strong>--ifref=ip</strong> to prevent interface renumbering troubles from catching you.</p><p>If you want to start rolling your own mrtg configuration files, make sure you read mrtg-reference to learn all about the possible configuration options.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RUNNING MRTG</h2>
        <div class="sectioncontent">
<p>Once you have created a configuration file, try the following:</p><p> /usr/local/mrtg-2/bin/mrtg /home/mrtg/cfg/mrtg.cfg</p><p>This will query your router and also create your first mrtg trafic graphs and webpages. When you run mrtg for the first time there will be a lot of complaints about missing log files. Don't worry, this is normal for the first 2 times you start mrtg. If it keeps complaining after this time you might want to look into the problem.</p><p>Starting mrtg by hand is not ideal in the long run. So when you are satisfied with the results you can automate the process of running mrtg in regular intervals (this means every 5 minutes by default).</p><p>You can either add mrtg to your crontab with a line like this:</p><p> 0,5,10,15,20,25,30,35,40,45,50,55 * * * * &#92;        &lt;mrtg-bin&gt;/mrtg &lt;path to mrtg-cfg&gt;/mrtg.cfg &#92;                 --logging /var/log/mrtg.log</p><p>or if you live in Linux Land the line may look like this if you are using \*(C`crontab -e\*(C'</p><p> */5 * * * *  &lt;mrtg-bin&gt;/mrtg &lt;path to mrtg-cfg&gt;/mrtg.cfg &#92;                        --logging /var/log/mrtg.log</p><p>or like this if you use <em>/etc/crontab</em></p><p> */5 * * * *  mrtg-user  &lt;mrtg-bin&gt;/mrtg &lt;path to mrtg-cfg&gt;/mrtg.cfg &#92;                                  --logging /var/log/mrtg.log</p><p>You can also run mrtg as a daemon process by adding the line</p><p> RunAsDaemon: Yes</p><p>to your mrtg configuration file and then creating a startup script in your system startup sequence. Unfortunately, adding startup scripts differs widely amongst different unix systems. The modern ones normally have a directory called <em>/etc/init.d</em> or <em>/etc/rc.d/init.d</em> where you put scripts which starts the process you want to run when the system boots. Further you must create a symbolic link in <em>/etc/rc3.d</em> or <em>/etc/rc.d/rc?.d</em> called <em>S65mrtg</em> (this is just a sample name ... it is just important that it starts with S followed by a two digit number). If you are not sure about this, make sure you consult the documentation of your system to make sure you get this right.</p><p>A <strong>minimal</strong> script to put into <em>init.d</em> might look like this:</p><p> #! /bin/sh  cd /usr/local/mrtg-2.17.4/bin && ./mrtg --user=mrtg-user &#92;        /home/httpd/mrtg/mrtg.cfg  --logging /var/log/mrtg.log</p><p>Note that this will only work with <strong>RunAsDaemon: Yes</strong> in your mrtg.cfg file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Tobias Oetiker &lt;tobi@oetiker.ch&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="mrtg-squid.1.html"><span aria-hidden="true">&larr;</span> mrtg-squid.1: Using mrtg to monitor squid</a></li>
   <li class="next"><a href="mrtg-webserver.1.html">mrtg-webserver.1: Hints for web server configuration <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
