<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>rootstrap: Rootstrap  construct a root filesystem image in a file</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Rootstrap  construct a root filesystem image in a file">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="rootstrap (1) manual">
  <meta name="twitter:description" content="Rootstrap  construct a root filesystem image in a file">
  <meta name="twitter:image" content="https://www.carta.tech/images/rootstrap-rootstrap-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/rootstrap.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="rootstrap (1) manual" />
  <meta property="og:description" content="Rootstrap  construct a root filesystem image in a file" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/rootstrap-rootstrap-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">rootstrap<small> (1)</small></h1>
        <p class="lead">Rootstrap  construct a root filesystem image in a file</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/rootstrap.1.html">
      <span itemprop="name">rootstrap: Rootstrap  construct a root filesystem image in a file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/rootstrap/">
      <span itemprop="name">rootstrap</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/rootstrap.1.html">
      <span itemprop="name">rootstrap: Rootstrap  construct a root filesystem image in a file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>rootstrap</strong> [<em>options</em> ...]  <em>imagefile</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>rootstrap is a tool for creating root filesystem images.  It was written primarily for use with User-Mode Linux, but may be useful for other purposes as well.</p><p>Because it uses User-Mode Linux to bootstrap itself, rootstrap can be used without root privileges on the host system, which are normally required for this task in order to use <a href="../man2/chroot.2.html"><strong>chroot</strong>(2)</a> and mount and unmount filesystems.  Rootstrap boots UML and uses tools from the host filesystem to perform installation and configuration tasks.</p><p>Note: since roostrap needs to access the host filesystem it requires an UML kernel with hostfs built-in (CONFIG_HOSTFS=y), not as module.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    -s, --image-size
  </dt>
  <dd>
    <p>Sets the initial size of the image, in megabytes, overriding the initialsize option in rootstrap.conf.</p>
  </dd>
  <dt>
    -o <em>logfile</em>
  </dt>
  <dd>
    <p>Log the output of the creation process to <em>logfile</em> instead of to standard output.</p>
  </dd>
  <dt>
    -u <em>args</em>, --umlargs <em>args</em>
  </dt>
  <dd>
    <p>Pass additional arguments to user-mode linux when booting to create the image.  Supplements the 'umlargs' option in rootstrap.conf.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Configuration</h2>
        <div class="sectioncontent">
<p>The configuration file consists of sections, starting with a "[section]" header, followed by "option=value" entries. Long values are allowed to span multiple lines if each continued line is indented with whitespace.</p><p>With the exception of the special section "global", sections are named after a corresponding module.  When that module is executed, it receives the option/value pairs in its section as environment variables.  All modules inherit global options as environment variables, except where overridden by options within their specific section.  At least PATH must be set here, in addition to the required parameters listed below under [global].</p><p>Documentation for configurable modules distributed with rootstrap is included below.  This section is currently incomplete.</p><p>Note that the modules shipped with rootstrap have a recommended ordering due to their cooperation in building the guest OS image, equivalent modules can be used for each of these tasks:</p>
<dl class='dl-vertical'>
  <dt>
       1.
  </dt>
  <dd>
    <p>setup guest network (if you need it for OS installation)</p>
  </dd>
  <dt>
       2.
  </dt>
  <dd>
    <p>create the target filesystem</p>
  </dd>
  <dt>
       3.
  </dt>
  <dd>
    <p>mount target filesystem in the guest Linux</p>
  </dd>
  <dt>
       4.
  </dt>
  <dd>
    <p>OS installation</p>
  </dd>
  <dt>
       5.
  </dt>
  <dd>
    <p>UML basic setup (device nodes, kernel modules, etc.)</p>
  </dd>
  <dt>
       6.
  </dt>
  <dd>
    <p>Tweaking (here you should have a fully working OS to play with)</p>
  </dd>
  <dt>
       7.
  </dt>
  <dd>
    <p>unmount the target filesystem</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Modules</h2>
        <div class="sectioncontent">
<h3>[global]</h3>
<p>Contains configuration options that affect the operation of rootstrap itself, or several modules.</p>
<dl class='dl-vertical'>
  <dt>
    fstype
  </dt>
  <dd>
    <p>The type of filesystem to create (ext2, ext3, reiserfs, etc.) This parameter is mandatory.</p>
  </dd>
  <dt>
    umlargs
  </dt>
  <dd>
    <p>Additional arguments to user-mode linux passed when booting to create the image.</p>
  </dd>
  <dt>
    PATH
  </dt>
  <dd>
    <p>The PATH environment variable to pass to modules. This parameter is mandatory.</p>
  </dd>
  <dt>
    initialsize
  </dt>
  <dd>
    <p>The initial size of the filesystem image (in megabytes). This must be large enough to contain a complete installed system as produced by the selected modules. It will be created sparsely, so additional space is not entirely allocated until it is used. This parameter is mandatory.</p>
  </dd>
  <dt>
    freespace
  </dt>
  <dd>
    <p>The amount of free space to leave on the filesystem (in megabytes).  The filesystem will be resized, if possible, to adjust the amount of free space to approximately this amount. This parameter is optional.</p>
  </dd>
  <dt>
    modules
  </dt>
  <dd>
    <p>The list of modules to invoke, in order.  Each module will be searched for in several directories, listed in the FILES section below, and passed environment variables based on the options set in the corresponding section of the configuration file. This parameter is mandatory.</p>
  </dd>
  <dt>
    debug
  </dt>
  <dd>
    <p>When set to "true" make rootstrap spawn a shell when a module script fails allowing further debugging actions. The shell will have the same environment as the failing script so you could simply invoke <strong>sh -x /path/to/module</strong> 	      to see what's going wrong. Moreover the shell exit value will be used to tell rootstrap to: re-evaluate the script when 1 (with exit 1) or continue with the next one when 2 (with exit 2); all other values will make rootstrap fail with an error. This parameter is optional.</p>
  </dd>

</dl>

<h3>[network]</h3>
<p>Network configuration.  This module configures virtual networking with the user-mode Linux system used to build the filesystem image.  Its presence is not strictly necessary, if the selected modules do not require network access (for example, with a local package mirror) and the network module is not included in the global "modules" list.</p>
<dl class='dl-vertical'>
  <dt>
    interface
  </dt>
  <dd>
    <p>The name of the network interface to configure inside the UML virtual machine, typically "eth0". This parameter is mandatory.</p>
  </dd>
  <dt>
    host
  </dt>
  <dd>
    <p>The IP address of the host side of the interface (the host on which rootstrap is run), as visible to the UML virtual machine. This parameter is mandatory.</p>
  </dd>
  <dt>
    uml
  </dt>
  <dd>
    <p>The IP address of the UML side of the interface (where the system is being built). The value "dhcp" is also accepted and makes rootstrap try to configure the network interface through DHCP. This parameter is mandatory.</p>
  </dd>
  <dt>
    transport
  </dt>
  <dd>
    <p>The type of virtual networking interface to be used. Typically "tuntap". Other available transports are "slirp" and "daemon". This parameter is mandatory.</p>
  </dd>
  <dt>
    netmask
  </dt>
  <dd>
    <p>The netmask for the network interface (applies to both sides).  This parameter is mandatory.</p>
  </dd>
  <dt>
    hostname
  </dt>
  <dd>
    <p>The host name to use for the created UML virtual machine. This parameter is optional.</p>
  </dd>
  <dt>
    gateway
  </dt>
  <dd>
    <p>A default gateway to be used by the user-mode Linux system.  This parameter is optional.</p>
  </dd>
  <dt>
    domain
  </dt>
  <dd>
    <p>The local domain name.</p>
  </dd>
  <dt>
    nameserver
  </dt>
  <dd>
    <p>The DNS server to use for domain name resolution inside the UML virtual machine. This parameter is optional, but useful if you do not have a name server running on the host.</p>
  </dd>

</dl>

<h3>[mkfs]</h3>
<p>This module creates the filesystem for the rootfs. It uses the <strong>fstype</strong> global parameter.</p>
<h3>[mount]</h3>
<p>This module mounts the root filesystem where the OS image is going to be created. It uses the <strong>fstype</strong> global parameter.</p>
<h3>[umount]</h3>
<p>This module unmounts the root filesystem and /proc.</p>
<h3>[uml]</h3>
<p>Creates /etc/fstab and necessary device nodes, it eventually copies kernel modules into the target image. It uses the <strong>fstype</strong> global parameter.</p>
<dl class='dl-vertical'>
  <dt>
    kernel_modules
  </dt>
  <dd>
    <p>How to deal with kernel modules for the guest Linux. It can be one of <strong>none</strong>, <strong>hostfs</strong> or <strong>copy</strong>, defaults to the latter which copies the available modules in the target filesystem.</p>
  </dd>
  <dt>
    kernel_modules_dir
  </dt>
  <dd>
    <p>The directory where <strong>kernel_modules</strong> 	      are located on the host filesystem. It defaults to /usr/lib/uml/modules</p>
  </dd>
  <dt>
    install_modules
  </dt>
  <dd>
    <p>This parameter is superseeded by <strong>kernel_modules</strong> and <strong>kernel_modules_dir</strong>. It accepts a boolean value (true/false).</p>
  </dd>

</dl>

<h3>[debian]</h3>
<p>Debian installation.  This module installs a basic Debian system using debootstrap.</p>
<dl class='dl-vertical'>
  <dt>
    dist
  </dt>
  <dd>
    <p>The distribution to install (e.g., potato, woody, etc.)</p>
  </dd>
  <dt>
    mirror
  </dt>
  <dd>
    <p>A URL for a Debian archive containing the base packages.  This must be a URL understood by debootstrap, which as of this writing includes URLs understood by wget, and file: URLs.</p>
  </dd>
  <dt>
    exclude
  </dt>
  <dd>
    <p>A list of packages which should be excluded (never installed at all).  It is quite possible to produce a broken system, or fail to build a system at all, if this option is used improperly.  It is useful for excluding packages, such as pcmcia-cs, which are typically not necessary for UML and other applications.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>Corresponds to debootstrap's --exclude option</p>
  </dd>
  <dt>
    purge
  </dt>
  <dd>
    <p>A list of packages which should be removed after installation is complete.  Use this for packages which are required during installation, but may be removed afterward.  The same warning applies as with the exclude option.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>Packages are removed with dpkg --purge.</p>
  </dd>
  <dt>
    include
  </dt>
  <dd>
    <p>A list of packages which should be included in the initial set of packages to install.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>Corresponds to debootstrap's --include option.</p>
  </dd>
  <dt>
    install
  </dt>
  <dd>
    <p>Extra packages to install via apt after initial debootstrap install.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>See also the sources option.</p>
  </dd>
  <dt>
    debconf_preseed_file
  </dt>
  <dd>
    <p>A file containing a debconf DB to be used as default. Read debconf documentation and see your /var/cache/debconf/config.dat for examples and caveats.</p>
  </dd>
  <dt>
    sources
  </dt>
  <dd>
    <p>Sources for target's sources.list. If no value is given the default is the main section of <strong>mirror</strong>. NOTE: you can provide multiple lines if each new line is indented with blank spaces.</p>
  </dd>
  <dt>
    preferences
  </dt>
  <dd>
    <p>Preferences for target's apt preferences file (see <a href="../man5/apt_preferences.5.html"><strong>apt_preferences</strong>(5)</a>). NOTE: you can provide multiple lines if each new line is indented with blank spaces. Multiple apt_preferences stanzas are allowed provided that they are separated by a line containing only a dot (".") and obviously indented as specified above.</p>
  </dd>
  <dt>
    apt_conf
  </dt>
  <dd>
    <p>Apt configuration for target's apt.conf file (see <a href="../man5/apt.conf.5.html"><strong>apt.conf</strong>(5)</a>). The file will be created before installing additional packages so it will be already effective then. NOTE: you can provide multiple lines if each new line is indented with blank spaces.</p>
  </dd>
  <dt>
    apt_force_yes
  </dt>
  <dd>
    <p>Will make rootstrap use the --force-yes switch to install debian packages. This useful when you need to install packages from sources that don't use a Release.gpg file and thus failing apt key authentication. It can be either <strong>true</strong> 	      or <strong>false</strong> and defaults to the former.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>Be careful anyway as using this option "will cause apt to continue without prompting if it is doing something potentially harmful" (from <a href="../man8/apt-get.8.html"><strong>apt-get</strong>(8)</a>). This option is provided standalone instead of forcing its inclusion in <strong>apt_conf</strong> to avoid causing destructive actions later when using apt-get from the UML instance.</p>
  </dd>

</dl>

<h3>Custom modules</h3>
<p>Custom modules can very easily be used by rootstrap, in addition to (or in place of) the supplied modules.  See FILES below for locations that are searched for modules.</p><p>When a module is invoked, the filesystem being created is mounted on $TARGET, /dev, /etc and /tmp are tmpfs filesystems internal to the UML system, while the root filesystem is a hostfs mount of the system where rootstrap is running, to have access to the above shadowed directories the full host filesystem is available on $HOST. /lib/modules is tmpfs too and bind mounted to the host's /usr/lib/uml/modules to let scripts load necessary kernel modules. This means that most software on the host system should be available and work as expected. The working directory where rootstrap is run is available as $WORKDIR. The environment is generated from the configuration file as described above.</p><p>Be careful about modules ordering (see CONFIGURATION above), you'll mostly want to plug into the tweaking step to perform custom configurations.</p><p>To debug modules enable the <strong>debug</strong> global parameter, see its description fro more hints.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    /etc/rootstrap/rootstrap.conf
  </dt>
  <dd>
    <p>System-wide default configuration</p>
  </dd>
  <dt>
    rootstrap.conf
  </dt>
  <dd>
    <p>Local overrides</p>
  </dd>
  <dt>
    /usr/lib/rootstrap/modules
  </dt>
  <dd>
    <p>Modules distributed with rootstrap</p>
  </dd>
  <dt>
    /etc/rootstrap/modules
  </dt>
  <dd>
    <p>System-wide overrides and additional modules</p>
  </dd>
  <dt>
    modules
  </dt>
  <dd>
    <p>Local overrides and additional modules</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO rootstrap&hellip;</h2>
        <div class="sectioncontent">
<p><strong>debootstrap</strong><strong>(8)</strong>, <strong>apt_preferences</strong><strong>(5)</strong>, <strong>apt.conf</strong><strong>(5)</strong>, <strong>debconf</strong><strong>(7)</strong>, <strong>linux</strong><strong>(1)</strong>; locally installed User-Mode Linux documentation or <em>	http://user-mode-linux.sourceforge.net/</em> (link to URL http://user-mode-linux.sourceforge.net/) </p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Rootstrap was written by Matt Zimmerman mdz@debian.org</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="roots.exe.1.html"><span aria-hidden="true">&larr;</span> roots.exe.1: Remote root interpretor server</a></li>
   <li class="next"><a href="rootv.1.html">rootv.1: Display tv using the xvideo extension <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
