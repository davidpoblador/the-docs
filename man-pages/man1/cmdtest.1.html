<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>cmdtest: Blackbox testing of unix command line tools</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Blackbox testing of unix command line tools">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="cmdtest (1) manual">
  <meta name="twitter:description" content="Blackbox testing of unix command line tools">
  <meta name="twitter:image" content="https://www.carta.tech/images/cmdtest-cmdtest-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/cmdtest.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="cmdtest (1) manual" />
  <meta property="og:description" content="Blackbox testing of unix command line tools" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/cmdtest-cmdtest-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">cmdtest<small> (1)</small></h1>
        <p class="lead">Blackbox testing of unix command line tools</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/cmdtest.1.html">
      <span itemprop="name">cmdtest: Blackbox testing of unix command line tools</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/cmdtest/">
      <span itemprop="name">cmdtest</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/cmdtest.1.html">
      <span itemprop="name">cmdtest: Blackbox testing of unix command line tools</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>cmdtest</strong> [<strong>-c</strong>=<em>COMMAND</em>] [<strong>--command</strong>=<em>COMMAND</em>] [<strong>--config</strong>=<em>FILE</em>] [<strong>--dump-config</strong>] [<strong>--dump-memory-profile</strong>=<em>METHOD</em>] [<strong>--dump-setting-names</strong>] [<strong>--generate-manpage</strong>=<em>TEMPLATE</em>] [<strong>-h</strong>] [<strong>--help</strong>] [<strong>--help-all</strong>] [<strong>-k</strong>] [<strong>--keep</strong>] [<strong>--list-config-files</strong>] [<strong>--log</strong>=<em>FILE</em>] [<strong>--log-keep</strong>=<em>N</em>] [<strong>--log-level</strong>=<em>LEVEL</em>] [<strong>--log-max</strong>=<em>SIZE</em>] [<strong>--log-mode</strong>=<em>MODE</em>] [<strong>--memory-dump-interval</strong>=<em>SECONDS</em>] [<strong>--no-default-configs</strong>] [<strong>--no-keep</strong>] [<strong>--no-timings</strong>] [<strong>--output</strong>=<em>FILE</em>] [<strong>-t</strong>=<em>TEST</em>] [<strong>--test</strong>=<em>TEST</em>] [<strong>--timings</strong>] [<strong>--version</strong>] [<em>FILE</em>]...<em></em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>cmdtest</strong> black box tests Unix command line tools. Given some test scripts, their inputs, and expected outputs, it verifies that the command line produces the expected output. If not, it reports problems, and shows the differences.</p><p>Each test case <em>foo</em> consists of the following files:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>foo.script</em></p>
  </dt>
  <dd>
    <p>a script to run the test (this is required)</p>
  </dd>
  <dt>
    <p><em>foo.stdin</em></p>
  </dt>
  <dd>
    <p>the file fed to standard input</p>
  </dd>
  <dt>
    <p><em>foo.stdout</em></p>
  </dt>
  <dd>
    <p>the expected output to the standard output</p>
  </dd>
  <dt>
    <p><em>foo.stderr</em></p>
  </dt>
  <dd>
    <p>the expected output to the standard error</p>
  </dd>
  <dt>
    <p><em>foo.exit</em></p>
  </dt>
  <dd>
    <p>the expected exit code</p>
  </dd>
  <dt>
    <p><em>foo.setup</em></p>
  </dt>
  <dd>
    <p>a shell script to run before the test</p>
  </dd>
  <dt>
    <p><em>foo.teardown</em></p>
  </dt>
  <dd>
    <p>a shell script to run after test</p>
  </dd>

</dl>
<p>Usually, a single test is not enough. All tests are put into the same directory, and they may share some setup and teardown code:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>setup-once</em></p>
  </dt>
  <dd>
    <p>a shell script to run once, before any tests</p>
  </dd>
  <dt>
    <p><em>setup</em></p>
  </dt>
  <dd>
    <p>a shell script to run before each test</p>
  </dd>
  <dt>
    <p><em>teardown</em></p>
  </dt>
  <dd>
    <p>a shell script to run after each test</p>
  </dd>
  <dt>
    <p><em>teardown-once</em></p>
  </dt>
  <dd>
    <p>a shell script to run once, after all tests</p>
  </dd>

</dl>
<p><strong>cmdtest</strong> is given the name of the directory with all the tests, or several such directories, and it does the following:</p><p>&bull; execute <em>setup-once</em></p><p>&bull; for each test case (unique prefix <em>foo</em>):</p><p>&ndash; execute <em>setup</em> &ndash; execute <em>foo.setup</em> &ndash; execute the command, by running <em>foo.script</em>, and redirecting standard input to come from <em>foo.stdin</em>, and capturing standard output and error and exit codes &ndash; execute <em>foo.teardown</em> &ndash; execute <em>teardown</em> &ndash; report result of test: does exit code match <em>foo.exit</em>, standard output match <em>foo.stdout</em>, and standard error match <em>foo.stderr</em>?</p><p>&bull; execute <em>teardown-once</em></p><p>Except for <em>foo.script</em>, all of these files are optional. If a setup or teardown script is missing, it is simply not executed. If one of the standard input, output, or error files is missing, it is treated as if it were empty. If the exit code file is missing, it is treated as if it specified an exit code of zero.</p><p>The shell scripts may use the following environment variables:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>DATADIR</strong></p>
  </dt>
  <dd>
    <p>a temporary directory where files may be created by the test</p>
  </dd>
  <dt>
    <p><strong>TESTNAME</strong></p>
  </dt>
  <dd>
    <p>name of the current test (will be empty for <strong>setup-once</strong> and <strong>teardown-once</strong>)</p>
  </dd>
  <dt>
    <p><strong>SRCDIR</strong></p>
  </dt>
  <dd>
    <p>directory from which <strong>cmdtest</strong> was launched</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-c</strong>, <strong>--command</strong>=<em>COMMAND</em></p>
  </dt>
  <dd>
    <p>ignored for backwards compatibility</p>
  </dd>
  <dt>
    <p><strong>--generate-manpage</strong>=<em>TEMPLATE</em></p>
  </dt>
  <dd>
    <p>SUPPRESSHELP</p>
  </dd>
  <dt>
    <p><strong>-h</strong>, <strong>--help</strong></p>
  </dt>
  <dd>
    <p>show this help message and exit</p>
  </dd>
  <dt>
    <p><strong>-k</strong>, <strong>--keep</strong></p>
  </dt>
  <dd>
    <p>keep temporary data on failure</p>
  </dd>
  <dt>
    <p><strong>--no-keep</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>--no-timings</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>--output</strong>=<em>FILE</em></p>
  </dt>
  <dd>
    <p>write output to FILE, instead of standard output</p>
  </dd>
  <dt>
    <p><strong>-t</strong>, <strong>--test</strong>=<em>TEST</em></p>
  </dt>
  <dd>
    <p>run only TEST (can be given many times)</p>
  </dd>
  <dt>
    <p><strong>--timings</strong></p>
  </dt>
  <dd>
    <p>report how long each test takes</p>
  </dd>
  <dt>
    <p><strong>--version</strong></p>
  </dt>
  <dd>
    <p>show program's version number and exit</p>
  </dd>

</dl>
<h3>Configuration files and settings</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>--config</strong>=<em>FILE</em></p>
  </dt>
  <dd>
    <p>add FILE to config files</p>
  </dd>
  <dt>
    <p><strong>--dump-config</strong></p>
  </dt>
  <dd>
    <p>write out the entire current configuration</p>
  </dd>
  <dt>
    <p><strong>--dump-setting-names</strong></p>
  </dt>
  <dd>
    <p>SUPPRESSHELP</p>
  </dd>
  <dt>
    <p><strong>--help-all</strong></p>
  </dt>
  <dd>
    <p>show all options</p>
  </dd>
  <dt>
    <p><strong>--list-config-files</strong></p>
  </dt>
  <dd>
    <p>SUPPRESSHELP</p>
  </dd>
  <dt>
    <p><strong>--no-default-configs</strong></p>
  </dt>
  <dd>
    <p>clear list of configuration files to read</p>
  </dd>

</dl>

<h3>Logging</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>--log</strong>=<em>FILE</em></p>
  </dt>
  <dd>
    <p>write log entries to FILE (default is to not write log files at all); use "syslog" to log to system log, or "none" to disable logging</p>
  </dd>
  <dt>
    <p><strong>--log-keep</strong>=<em>N</em></p>
  </dt>
  <dd>
    <p>keep last N logs (10)</p>
  </dd>
  <dt>
    <p><strong>--log-level</strong>=<em>LEVEL</em></p>
  </dt>
  <dd>
    <p>log at LEVEL, one of debug, info, warning, error, critical, fatal (default: debug)</p>
  </dd>
  <dt>
    <p><strong>--log-max</strong>=<em>SIZE</em></p>
  </dt>
  <dd>
    <p>rotate logs larger than SIZE, zero for never (default: 0)</p>
  </dd>
  <dt>
    <p><strong>--log-mode</strong>=<em>MODE</em></p>
  </dt>
  <dd>
    <p>set permissions of new log files to MODE (octal; default 0600)</p>
  </dd>

</dl>

<h3>Peformance</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>--dump-memory-profile</strong>=<em>METHOD</em></p>
  </dt>
  <dd>
    <p>make memory profiling dumps using METHOD, which is one of: none, simple, meliae, or heapy (default: simple)</p>
  </dd>
  <dt>
    <p><strong>--memory-dump-interval</strong>=<em>SECONDS</em></p>
  </dt>
  <dd>
    <p>make memory profiling dumps at least SECONDS apart</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>To test that the <a href="../man1/echo.1.html"><strong>echo</strong>(1)</a> command outputs the expected string, create a file called <em>echo-tests/hello.script</em> containing the following content:</p><ul>
<li>
<pre>
#!/bin/sh
echo hello, world
</pre>
</li>
</ul><p>Also create the file <em>echo-tests/hello.stdout</em> containing:</p><ul>
<li><p>hello, world</p></li>
</ul><p>Then you can run the tests:</p><ul>
<li>
<pre>
$ cmdtest echo-tests
test 1/1
1/1 tests OK, 0 failures
</pre>
</li>
</ul><p>If you change the stdout file to be something else, <strong>cmdtest</strong> will report the differences:</p><ul>
<li>
<pre>
$ cmdtest echo-tests
FAIL: hello: stdout diff:
--- echo-tests/hello.stdout	2011-09-11 19:14:47 +0100
+++ echo-tests/hello.stdout-actual	2011-09-11 19:14:49 +0100
@@ -1 +1 @@
-something else
+hello, world

test 1/1
0/1 tests OK, 1 failures
</pre>
</li>
</ul><p>Furthermore, the <em>echo-tests</em> directory will contain the actual output files, and diffs from the expected files. If one of the actual output files is actually correct, you can actualy rename it to be the expected file. Actually, that's a very convenient way of creating the expected output files: you run the test, fixing things, until you've manually checked the actual output is correct, then you rename the file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO cmdtest&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/cliapp.5.html"><strong>cliapp</strong>(5)</a>.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="cmconvert.1.html"><span aria-hidden="true">&larr;</span> cmconvert.1: Convert infernal covariance model files</a></li>
   <li class="next"><a href="cmdtool.1.html">cmdtool.1: Run a shell (or other program) in an openwindows enhanced terminal window <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
