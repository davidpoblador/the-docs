<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>apt-grip: Extend emdebian grip to add debian packages on-the-fly</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Extend emdebian grip to add debian packages on-the-fly">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="apt-grip (1) manual">
  <meta name="twitter:description" content="Extend emdebian grip to add debian packages on-the-fly">
  <meta name="twitter:image" content="https://www.carta.tech/images/emdebian-grip-apt-grip-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/apt-grip.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="apt-grip (1) manual" />
  <meta property="og:description" content="Extend emdebian grip to add debian packages on-the-fly" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/emdebian-grip-apt-grip-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">apt-grip<small> (1)</small></h1>
        <p class="lead">Extend emdebian grip to add debian packages on-the-fly</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/apt-grip.1.html">
      <span itemprop="name">apt-grip: Extend emdebian grip to add debian packages on-the-fly</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/emdebian-grip/">
      <span itemprop="name">emdebian-grip</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/apt-grip.1.html">
      <span itemprop="name">apt-grip: Extend emdebian grip to add debian packages on-the-fly</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">Synopsis</h2>
        <div class="sectioncontent">

<pre>
 $ sudo apt-grip foo bar baz

 $ sudo apt-grip -M http://ftp.fr.debian.org/debian/ foo bar baz

 $ sudo apt-grip --clean-cache
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Description</h2>
        <div class="sectioncontent">
<p>Emdebian Grip has a limited number of packages in the main repository, principally to reduce the size of the apt cache data. On occassion, individual packages from standard Debian need to be added to a single machine running Emdebian Grip. <em>apt-grip</em> has been written with that purpose in mind.</p><p><em>apt-grip</em> requires \s-1DEB_VENDOR\s0 support in dpkg to determine how the package should be \*(C`gripped\*(C'. The default Vendor is \*(C`emdebian-grip\*(C' but note the next section on the limitations of apt-grip if you plan to use it on an unmodified Debian system.</p><p>The usual case is that the system has already been upgraded to Emdebian Grip before <em>apt-grip</em> is used.</p><p>Contact the debian-embedded@lists.debian.org mailing list for requests to add packages to Emdebian Grip repositories directly.</p><p>Downloading the Packages files can take a reasonable amount of time, so to grip a number of packages, either specify all packages in one command or use the \*(C`--keep-cache\*(C' option for each run and use the \*(C`--clean-cache\*(C' option at the end.</p><p>If the device running Grip has insufficient space to download and process the package(s), run apt-grip on a different machine of the using the \*(C`--build-only\*(C' and \*(C`--arch\*(C' options.</p><p>The processed archives will be in <em>/var/lib/apt-grip/output/</em> and can be copied from there onto the device directly or by including the packages into a locally accessible repository. Once installed on the Grip device use \*(C`apt-grip -c\*(C' on the build machine to clear the cache. \*(C`--keep-cache\*(C' is implied when \*(C`--build-only\*(C' is set.</p><p>Note also that, in common with the rest of Emdebian processing, Install-Recommends is always turned off, so if you need a package that is only recommended by packages in the list given to \*(C`apt-grip\*(C', that package will need to be added to the list explicitly.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Limitations</h2>
        <div class="sectioncontent">
<p>Installing any package from repositories outside the normal apt sources (especially if those packages are subsequently modified as in emgrip) will list those packages as \*(L"local or obsolete\*(R" in package managers. Converted packages cannot be upgraded without repeating the call to \*(C`apt-grip\*(C' because \*(C`apt-get\*(C' does not know about the temporary mirror that \*(C`apt-grip\*(C' used to download the packages. This can cause problems if dependencies of such packages need to be upgraded. It is possible that the main system \*(C`apt\*(C' will try to remove these local packages in order to proceed with the main system upgrade.</p><p>The best option is to seek addition of such packages to the repository you use for your main apt sources. (Use the <em>emdebian-grip-server</em> package to create your own repository.)</p><p>\*(C`Gripping\*(C' a package means making a new version (with the em1 version suffix) with less files in the new package. See emgrip (1) for detailed information on that process. Changing the version string means that some dependencies need to be changed - particularly strict dependencies. This means that <em>apt-grip</em> could fail with some combinations of packages.</p><p>\*(C`apt-grip\*(C' uses the \*(C`--reinstall\*(C' option to <em>apt-get</em> to cope with some of these situations.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Strict dependency issues</h2>
        <div class="sectioncontent">
<p>If a source package builds multiple binary packages, where at least one package has a strict dependency on one of the other binary packages and one of those binary packages is already installed from Debian, it will be necessary to install Grip versions of both the binary packages involved so that the strict dependency can be satisfied.</p><p> Source: foo</p><p> Package: foo  Depends: bar (= 0.0.1)</p><p> Package: bar</p><p> $ sudo apt-grip foo bar</p><p>In the example above, <em>foo_0.0.1_amd64.deb</em> will become <em>foo_0.0.1em1_amd64.deb</em> and will be given a strict dependency on \*(C`bar (= 0.0.1em1)\*(C' by <em>emgrip</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Default mirror</h2>
        <div class="sectioncontent">
<p><em>apt-grip</em> uses \*(C`http://ftp.uk.debian.org/debian/\*(C' as the default Debian mirror. Use the -M|--mirrror option to change it.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SecureApt</h2>
        <div class="sectioncontent">
<p>Use the \*(C`--no-auth\*(C' option to allow the use of unauthenticated repositories. Note that this disables authentication against all available repositories.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Upgrading to Grip</h2>
        <div class="sectioncontent">
<p>Change your sources list from debian mirrors to the emdebian grip mirror.</p><p>e.g. for unstable:</p><p> deb http://www.emdebian.org/grip/ unstable main</p><p>(Emdebian Grip only supports Debian suites: unstable, sid, testing, squeeze, stable, lenny, lenny-proposed-updates.)</p><p>Then update and upgrade:</p><p> $ sudo apt-get update  $ sudo apt-get clean  $ sudo apt-get upgrade  $ sudo apt-get dist-upgrade</p><p>(Note that <em>apt-get</em> will usually report the ability to free several hundred megabytes on your system when some of your Debian packages are upgraded to Emdebian Grip but you still need enough room to actually download and unpack the new packages.) Use \*(C`apt-get clean\*(C' after the upgrade to recover more free space.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Grip components</h2>
        <div class="sectioncontent">
<p>Grip divides the archive further by creating new areas of the archive for packages related to development, debugging, documentation or java, again to reduce the final size of the cached package data on the system. If you want to use \*(C`apt-grip\*(C' on your Emdebian Grip system, ensure that you add the <em>dev</em> component to your apt sources:</p><p> deb http://www.emdebian.org/grip/ unstable main dev</p><p>Similarly for <em>doc</em>, <em>debug</em> and <em>java</em>. Other components may be added from time to time, so check the Emdebian website:</p><p> http://www.emdebian.org/grip/search.php</p><p>Add more components as required:</p><p> deb http://www.emdebian.org/grip/ unstable main dev debug java</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Emdebian Baked</h2>
        <div class="sectioncontent">
<p>apt-grip has been extended to help generate packages for use with Emdebian Baked. This has meant adding foreign architecture support as well as support for ignoring the status of currently installed packages on the device running apt-grip.</p><p>The difficult part of this process is managing updated packages and changed dependencies. apt-grip can only help with Debian stable.</p><p>emdebian-grip has not been backported to Lenny, so your development machine must be running Debian Squeeze or Sid (testing or unstable) to develop a Baked root filesystem based on Lenny.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Example apt-grip command for Baked</h2>
        <div class="sectioncontent">
<p> $ sudo apt-grip -a mipsel -V emdebian-baked -S stable dash snmpd</p><p>Baked packages will then exist in /var/lib/apt-grip/output/, including all dependencies of the specified packages. These can then be included into an existing reprepro repository:</p><p> $ reprepro includedeb stable /var/lib/apt-grip/output/*.deb</p><p>If your repository is to support more than one architecture, ensure that you remove or ignore the Architecture: all packages which have already been processed by apt-grip:</p><p> $ sudo rm /var/lib/apt-grip/output*_all.deb</p><p>Then use the -A option to reprepro to only include the added architecture:</p><p> $ reprepro -A armel includedeb stable /var/lib/apt-grip/output/*_armel.deb</p><p>For more information, see the emdebian website: http://www.emdebian.org/baked/</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="apt-get-build-depends.1.html"><span aria-hidden="true">&larr;</span> apt-get-build-depends.1: Apt-get install build depends</a></li>
   <li class="next"><a href="apt-listbugs.1.html">apt-listbugs.1: Lists critical bugs before each apt installation/upgrade <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
