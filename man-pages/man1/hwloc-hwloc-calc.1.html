<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>hwloc-calc: Operate on cpu mask strings and objects</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Operate on cpu mask strings and objects">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="hwloc-calc (1) manual">
  <meta name="twitter:description" content="Operate on cpu mask strings and objects">
  <meta name="twitter:image" content="https://www.carta.tech/images/hwloc-hwloc-calc-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/hwloc-hwloc-calc.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="hwloc-calc (1) manual" />
  <meta property="og:description" content="Operate on cpu mask strings and objects" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/hwloc-hwloc-calc-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">hwloc-calc<small> (1)</small></h1>
        <p class="lead">Operate on cpu mask strings and objects</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/hwloc-calc.1.html">
      <span itemprop="name">hwloc-calc: Operate on cpu mask strings and objects</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/hwloc/">
      <span itemprop="name">hwloc</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/hwloc-calc.1.html">
      <span itemprop="name">hwloc-calc: Operate on cpu mask strings and objects</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>hwloc-calc</strong> [<em>options</em>] <em>&lt;location1&gt; [&lt;location2&gt; [...] ]</em></p><p>Note that <a href="../man7/hwloc.7.html"><strong>hwloc</strong>(7)</a> provides a detailed explanation of the hwloc system and of valid &lt;location&gt; formats; it should be read before reading this man page.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-p</strong> <strong>--physical</strong></p>
  </dt>
  <dd>
    <p>Use OS/physical indexes instead of logical indexes for both input and output.</p>
  </dd>
  <dt>
    <p><strong>-l</strong> <strong>--logical</strong></p>
  </dt>
  <dd>
    <p>Use logical indexes instead of physical/OS indexes for both input and output (default).</p>
  </dd>
  <dt>
    <p><strong>--pi</strong> <strong>--physical-input</strong></p>
  </dt>
  <dd>
    <p>Use OS/physical indexes instead of logical indexes for input.</p>
  </dd>
  <dt>
    <p><strong>--li</strong> <strong>--logical-input</strong></p>
  </dt>
  <dd>
    <p>Use logical indexes instead of physical/OS indexes for input (default).</p>
  </dd>
  <dt>
    <p><strong>--po</strong> <strong>--physical-output</strong></p>
  </dt>
  <dd>
    <p>Use OS/physical indexes instead of logical indexes for output.</p>
  </dd>
  <dt>
    <p><strong>--lo</strong> <strong>--logical-output</strong></p>
  </dt>
  <dd>
    <p>Use logical indexes instead of physical/OS indexes for output (default, except for cpusets which are always physical).</p>
  </dd>
  <dt>
    <p><strong>-N --number-of &lt;type|depth&gt;</strong></p>
  </dt>
  <dd>
    <p>Report the number of objects of the given type or depth that intersect the CPU set. This is convenient for finding how many cores, NUMA nodes or PUs are available in a machine.</p>
  </dd>
  <dt>
    <p><strong>-I --intersect &lt;type|depth&gt;</strong></p>
  </dt>
  <dd>
    <p>Find the list of objects of the given type or depth that intersect the CPU set and report the comma-separated list of their indexes instead of the cpu mask string. This may be used for determining the list of objects above or below the input objects. When combined with <strong>--physical</strong>, the list is convenient to pass to external tools such as taskset or numactl <strong>--physcpubind</strong> or <strong>--membind</strong>. This is different from --largest since the latter requires that all reported objects are strictly included inside the input objects.</p>
  </dd>
  <dt>
    <p><strong>-H --hierarchical &lt;type1&gt;.&lt;type2&gt;...</strong></p>
  </dt>
  <dd>
    <p>Find the list of objects of type &lt;type2&gt; that intersect the CPU set and report the space-separated list of their hierarchical indexes with respect to &lt;type1&gt;, &lt;type2&gt;, etc. For instance, if <em>socket.core</em> is given, the output would be <em>Socket:1.Core:2 Socket:2.Core:3</em> if the input contains the third core of the second socket and the fourth core of the third socket.</p>
  </dd>
  <dt>
    <p><strong>--largest</strong></p>
  </dt>
  <dd>
    <p>Report (in a human readable format) the list of largest objects which exactly include all input objects. None of these output objects intersect each other, and the sum of them is exactly equivalent to the input. No largest object is included in the input This is different from --intersect where reported objects may not be strictly included in the input.</p>
  </dd>
  <dt>
    <p><strong>--sep &lt;sep&gt;</strong></p>
  </dt>
  <dd>
    <p>Change the field separator in the output. By default, a space is used to separate output objects (for instance when <strong>--hierarchical</strong> or <strong>--largest</strong> is given) while a comma is used to separate indexes (for instance when <strong>--intersect</strong> is given).</p>
  </dd>
  <dt>
    <p><strong>--single</strong></p>
  </dt>
  <dd>
    <p>Singlify the output to a single CPU.</p>
  </dd>
  <dt>
    <p><strong>--taskset</strong></p>
  </dt>
  <dd>
    <p>Display CPU set strings in the format recognized by the taskset command-line program instead of hwloc-specific CPU set string format. This option has no impact on the format of input CPU set strings, both formats are always accepted.</p>
  </dd>
  <dt>
    <p><strong>--restrict</strong> &lt;cpuset&gt;</p>
  </dt>
  <dd>
    <p>Restrict the topology to the given cpuset.</p>
  </dd>
  <dt>
    <p><strong>--whole-system</strong></p>
  </dt>
  <dd>
    <p>Do not consider administration limitations.</p>
  </dd>
  <dt>
    <p><strong>-i</strong> &lt;file&gt;, <strong>--input</strong> &lt;file&gt;</p>
  </dt>
  <dd>
    <p>Read topology from XML file &lt;file&gt; (instead of discovering the topology on the local machine).  If &lt;file&gt; is "-", the standard input is used.  XML support must have been compiled in to hwloc for this option to be usable.</p>
  </dd>
  <dt>
    <p><strong>-i</strong> &lt;directory&gt;, <strong>--input</strong> &lt;directory&gt;</p>
  </dt>
  <dd>
    <p>Read topology from the chroot specified by &lt;directory&gt; (instead of discovering the topology on the local machine).  This option is generally only available on Linux.  The chroot was usually created by gathering another machine topology with hwloc-gather-topology.</p>
  </dd>
  <dt>
    <p><strong>-i</strong> &lt;specification&gt;, <strong>--input</strong> &lt;specification&gt;</p>
  </dt>
  <dd>
    <p>Simulate a fake hierarchy (instead of discovering the topology on the local machine). If &lt;specification&gt; is "node:2 pu:3", the topology will contain two NUMA nodes with 3 processing units in each of them. The &lt;specification&gt; string must end with a number of PUs.</p>
  </dd>
  <dt>
    <p><strong>--if</strong> &lt;format&gt;, <strong>--input-format</strong> &lt;format&gt;</p>
  </dt>
  <dd>
    <p>Enforce the input in the given format, among <strong>xml</strong>, <strong>fsroot</strong> and <strong>synthetic</strong>.</p>
  </dd>
  <dt>
    <p><strong>-q</strong> <strong>--quiet</strong></p>
  </dt>
  <dd>
    <p>Hide non-fatal error messages. It mostly includes locations pointing to non-existing objects.</p>
  </dd>
  <dt>
    <p><strong>-v</strong> <strong>--verbose</strong></p>
  </dt>
  <dd>
    <p>Verbose output.</p>
  </dd>
  <dt>
    <p><strong>--version</strong></p>
  </dt>
  <dd>
    <p>Report version and exit.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>hwloc-calc generates and manipulates CPU mask strings or objects. Both input and output may be either objects (with physical or logical indexes), CPU lists (with physical or logical indexes), or CPU mask strings (always physically indexed).</p><p>If objects or CPU mask strings are given on the command-line, they are combined and a single output is printed. If no object or CPU mask strings are given on the command-line, the program will read the standard input. It will combine multiple objects or CPU mask strings that are given on the same line of the standard input line with spaces as separators. Different input lines will be processed separately.</p><p>Command-line arguments and options are processed in order. For instance, it means that changing the type of input indexes with <strong>--li</strong> or changing the input topology with <strong>-i</strong> only affects the processing the following arguments.</p><p><strong>NOTE:</strong> It is highly recommended that you read the <a href="../man7/hwloc.7.html"><strong>hwloc</strong>(7)</a> overview page before reading this man page.  Most of the concepts described in <a href="../man7/hwloc.7.html"><strong>hwloc</strong>(7)</a> directly apply to the hwloc-calc utility.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>hwloc-calc's operation is best described through several examples.</p><p>To display the (physical) CPU mask corresponding to the second socket:</p>
<pre>
    $ hwloc-calc socket:1
    0x000000f0
</pre>
<p>To display the (physical) CPU mask corresponding to the third socket, excluding its even numbered logical processors:</p>
<pre>
    $ hwloc-calc socket:2 ~PU:even
    0x00000c00
</pre>
<p>To combine two (physical) CPU masks:</p>
<pre>
    $ hwloc-calc 0x0000ffff 0xff000000
    0xff00ffff
</pre>
<p>To display the list of logical numbers of processors included in the second socket:</p>
<pre>
    $ hwloc-calc --intersect PU socket:1
    4,5,6,7
</pre>
<p>To bind GNU OpenMP threads logically over the whole machine, we need to use physical number output instead:</p>
<pre>
    $ export GOMP_CPU_AFFINITY=`hwloc-calc --physical-output --intersect PU machine:0`
    $ echo $GOMP_CPU_AFFINITY
    0,4,1,5,2,6,3,7
</pre>
<p>To display the list of NUMA nodes, by physical indexes, that intersect a given (physical) CPU mask:</p>
<pre>
    $ hwloc-calc --physical --intersect NUMAnode 0xf0f0f0f0
    0,2
</pre>
<p>To display the physical index of a processor given by its logical index:</p>
<pre>
    $ hwloc-calc PU:2 --physical-output --intersect PU
    3
</pre>
<p>To display the set of CPUs near network interface eth0:</p>
<pre>
    $ hwloc-calc os=eth0
    0x00005555
</pre>
<p>To display the indexes of sockets near PCI device whose bus ID is 0000:01:02.0:</p>
<pre>
    $ hwloc-calc pci=0000:01:02.0 --intersect Socket
    1
</pre>
<p>To display the list of per-socket cores that intersect the input:</p>
<pre>
    $ hwloc-calc 0x00003c00 --hierarchical socket.core
    Socket:2.Core:1 Socket:3.Core:0
</pre>
<p>To display the (physical) CPU mask of the entire topology except the third socket:</p>
<pre>
    $ hwloc-calc all ~socket:3
    0x0000f0ff
</pre>
<p>To combine both physical and logical indexes as input:</p>
<pre>
    $ hwloc-calc PU:2 --physical-input PU:3
    0x0000000c
</pre>
<p>To synthetize a set of cores into largest objects on a 2-node 2-socket 2-core machine:</p>
<pre>
    $ hwloc-calc core:0 --largest
    Core:0
    $ hwloc-calc core:0-1 --largest
    Socket:0
    $ hwloc-calc core:4-7 --largest
    NUMANode:1
    $ hwloc-calc core:2-6 --largest
    Socket:1 Socket:2 Core:6
    $ hwloc-calc socket:2 --largest
    Socket:2
    $ hwloc-calc socket:2-3 --largest
    NUMANode:1
</pre>
<p>To get the set of first threads of all cores:</p>
<pre>
    $ hwloc-calc core:all.pu:0
</pre>
<p>This can also be very useful in order to make GNU OpenMP use exactly one thread per core, and in logical core order:</p>
<pre>
    $ export OMP_NUM_THREADS=`hwloc-calc --number-of core machine:0`
    $ echo $OMP_NUM_THREADS
    4
    $ export GOMP_CPU_AFFINITY=`hwloc-calc --physical-output --intersect PU core:all.pu:0`
    $ echo $GOMP_CPU_AFFINITY
    0,2,1,3
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>Upon successful execution, hwloc-calc displays the (physical) CPU mask string, (physical or logical) object list, or (physical or logical) object number list. The return value is 0.</p><p>hwloc-calc will return nonzero if any kind of error occurs, such as (but not limited to): failure to parse the command line.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO hwloc-calc&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man7/hwloc.7.html"><strong>hwloc</strong>(7)</a>, <a href="../man1/lstopo.1.html"><strong>lstopo</strong>(1)</a>, <a href="../man1/hwloc-info.1.html"><strong>hwloc-info</strong>(1)</a>, <a href="../man1/hwloc-gather-topology.1.html"><strong>hwloc-gather-topology</strong>(1)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="hwloc-nox-hwloc-bind.1.html"><span aria-hidden="true">&larr;</span> hwloc-bind.1: Launch a command that is bound to specific processors and/or memory, or consult the binding of an existing program</a></li>
   <li class="next"><a href="hwloc-nox-hwloc-calc.1.html">hwloc-calc.1: Operate on cpu mask strings and objects <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
