<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>cgm: Computer graphics metafile operations</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Computer graphics metafile operations">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="cgm (1NCARG) manual">
  <meta name="twitter:description" content="Computer graphics metafile operations">
  <meta name="twitter:image" content="https://www.carta.tech/images/libncarg-dev-cgm-1NCARG.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1NCARG/cgm.1NCARG.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="cgm (1NCARG) manual" />
  <meta property="og:description" content="Computer graphics metafile operations" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libncarg-dev-cgm-1NCARG.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">cgm<small> (1NCARG)</small></h1>
        <p class="lead">Computer graphics metafile operations</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1NCARG/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1NCARG/cgm.1NCARG.html">
      <span itemprop="name">cgm: Computer graphics metafile operations</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libncarg-dev/">
      <span itemprop="name">libncarg-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1NCARG/cgm.1NCARG.html">
      <span itemprop="name">cgm: Computer graphics metafile operations</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNTAX</h2>
        <div class="sectioncontent">

<pre>
<strong>#include &lt;cgm_tools.h&gt;</strong>

<strong>Cgm_fd CGM_open(metafile, size, flags, mode)</strong>
<strong>char *metafile;</strong>
<strong>unsigned size;</strong>
<strong>int flags;</strong>
<strong>int mode;</strong>

<strong>int CGM_close(cgm_fd)</strong>
<strong>Cgm_fd cgm_fd;</strong>

<strong>int CGM_lseek(cgm_fd, offset)</strong>
<strong>Cgm_fd cgm_fd;</strong>
<strong>int offset;</strong>

<strong>int CGM_read(cgm_fd, buf)</strong>
<strong>Cgm_fd cgm_fd;</strong>
<strong>unsigned char *buf;</strong>

<strong>int CGM_write(cgm_fd, buf)</strong>
<strong>Cgm_fd cgm_fd;</strong>
<strong>unsigned char *buf;</strong>

<strong>Directory *CGM_directory(cgm_fd)</strong>
<strong>Cgm_fd cgm_fd;</strong>

<strong>void CGM_freeDirectory(dir)</strong>
<strong>Directory *dir;</strong>

<strong>void CGM_printDirectory(dir)</strong>
<strong>Directory *dir;</strong>

<strong>int CGM_getInstr(cgm_fd, instr)</strong>
<strong>Cgm_fd cgm_fd;</strong>
<strong>Instr *instr;</strong>

<strong>void CGM_flushGetInstr(cgm_fd)</strong>
<strong>Cgm_fd cgm_fd;</strong>

<strong>int CGM_putInstr(cgm_fd, instr)</strong>
<strong>Cgm_fd cgm_fd;</strong>
<strong>Instr *instr;</strong>

<strong>int CGM_flushOutputInstr(cgm_fd)</strong>
<strong>Cgm_fd cgm_fd;</strong>

<strong>Directory *CGM_initMetaEdit (metafile, size)</strong>
<strong>char *metafile;</strong>
<strong>unsigned int size;</strong>

<strong>int CGM_termMetaEdit()</strong>

<strong>Directory *CGM_copyFrames(start, num, target )</strong>
<strong>unsigned int start;</strong>
<strong>int num;</strong>
<strong>unsigned int target;</strong>

<strong>Directory *CGM_deleteFrames(start, num)</strong>
<strong>unsigned int start,</strong>
<strong>num;</strong>

<strong>Directory *CGM_mergeFrames(bottom, top)</strong>
<strong>unsigned bottom, top;</strong>

<strong>Directory *CGM_moveFrames (start, num, target)</strong>
<strong>unsigned int start, num, target;</strong>

<strong>Directory *CGM_readFrames(metafile, start, num, target, size)</strong>
<strong>char *metafile;</strong>
<strong>unsigned int start;</strong>
<strong>int num;</strong>
<strong>unsigned int target, size;</strong>

<strong>int *CGM_validCGM(metafile)</strong>
<strong>char *metafile;</strong>

<strong>int CGM_writeFile(metafile)</strong>
<strong>char *metafile;</strong>

<strong>int CGM_writeFrames(metafile, start, num)</strong>
<strong>char *metafile;</strong>
<strong>unsigned start, num;</strong>

<strong>int CGM_appendFrames(metafile, start, num)</strong>
<strong>char *metafile;</strong>
<strong>unsigned start, num;</strong>
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The argument <em>cgm_fd</em> refers to a valid file descriptor created for reading or writing, as appropriate by <strong>CGM_open</strong>. <strong>CGM_read</strong>, <strong>CGM_directory</strong>,  <strong>CGM_getInstr</strong> and <strong>CGM_flushGetInstr</strong> require a file descriptor open for reading. <strong>CGM_write</strong>, <strong>CGM_getInstr</strong>,<strong>CGM_flushGetInstr</strong> and <strong>CGM_flushOutputInstr</strong> require a <em>Cgm_fd</em> open for writing. <strong>CGM_close</strong> and <strong>CGM_lseek</strong> will accept any valid <em>Cgm_fd</em>.</p><p>The <em>size</em> argument refers to the CGM record size in bytes. For an NCAR CGM this value is 1440.</p><p><em>buf</em> is a pointer to user allocated memory of size <em>size</em>. This storage will be used for buffering input and output of <strong>CGM_read</strong> and <strong>CGM_write</strong> respectively.</p><p>The <em>dir</em> argument is a pointer to a <em>Directory</em> structure created with <strong>CGM_directory</strong> or <strong>CGM_initMetaEdit</strong>. <em>dir</em> is a private resource that should <em>NOT</em> be directly modified by the user. A set of convenience macros is provided for this purpose in <em>cgm_tools.h</em>.</p><p>The <em>start</em>, <em>num</em> and <em>target</em> arguments are used to address frame numbers in a metafile being edited with one of the commands: <strong>CGM_copyFrames</strong>, <strong>CGM_deleteFrames</strong>, <strong>CGM_readFrames</strong>, <strong>CGM_moveFrames</strong>, <strong>CGM_writeFrames</strong> and <strong>CGM_mergeFrames</strong>. The <em>start</em> argument is the first frame in a sequence of <em>num</em> frame(s) to perform the editing operation on. <em>target</em> is similar to <em>start</em> and is used by commands that require two frame addresses such as <em>copy</em>. Addressing begins at zero.</p>
<dl class='dl-vertical'>
  <dt>
    CGM_open
  </dt>
  <dd>
    <p>This command is modeled after the unix <em>open</em> command. It will open a CGM for reading or writing as specified by the <em>flags</em> argument and return a <em>Cgm_fd</em> file descriptor. The <em>flags</em> and <em>open</em> parameters are passed directly on to the system <em>open</em> command. For a detailed explanation of these two arguments see <a href="../man2/open.2.html"><strong>open</strong>(2)</a>.</p>
  </dd>
  <dt>
    CGM_close
  </dt>
  <dd>
    <p>Delete a file descriptor. The inverse of <strong>CGM_open</strong>. See <a href="../man2/close.2.html"><strong>close</strong>(2)</a>.</p>
  </dd>
  <dt>
    CGM_read
  </dt>
  <dd>
    <p><strong>CGM_read</strong> attempts to read <em>size</em> bytes from the object referenced through the descriptor <em>cgm_fd</em>. <em>size</em> is set at the creation of <em>cgm_fd</em> by <strong>CGM_open</strong>. <strong>CGM_read</strong> returns the number of bytes successfully read. A zero is returned on EOF and a negative number implies an error occurred. The unix system call <em>read</em> is called by <strong>CGM_read</strong>. See <a href="../man2/read.2.html"><strong>read</strong>(2)</a>.</p>
  </dd>
  <dt>
    CGM_write
  </dt>
  <dd>
    <p>Attempts to write a single record of <em>size</em> bytes from <em>buf</em> from the object referenced by <em>cgm_edit</em> where <em>size</em> is the record size parameter provided at the creation of <em>cgm_fd</em>. <em>write</em> returns the number of bytes successfully written. A negative return number implies an error occurred. The unix system call <em>write</em> is called by <strong>CGM_write</strong>. See <a href="../man2/write.2.html"><strong>write</strong>(2)</a>.</p>
  </dd>
  <dt>
    CGM_lseek
  </dt>
  <dd>
    <p>Advance the file pointer of <em>cgm_fd</em> to <em>offset</em> bytes. Upon successful completion the current file pointer offset is returned. A negative return value is an error. The unix system call <em>lseek</em> is called by <strong>CGM_lseek</strong>. See <a href="../man2/lseek.2.html"><strong>lseek</strong>(2)</a>.</p>
  </dd>
  <dt>
    CGM_directory
  </dt>
  <dd>
    <p>Create a table of contents for the metafile referenced by <em>cgm_fd</em>. Return a pointer to this table of type <em>Directory</em>. The contents of the directory include number of metafiles, number of frames, record offset for each frame, frame length in records, optional frame description and metafile status. These fields are meant to be read only and should only be referenced by the convenience macros provided in cgm_tools.h. A NULL pointer is returned on failure.</p>
  </dd>
  <dt>
    CGM_freeDirectory
  </dt>
  <dd>
    <p>Free memory allocated to a directory created by <strong>CGM_directory</strong> or <strong>CGM_initMetaEdit</strong>.</p>
  </dd>
  <dt>
    CGM_printDirectory
  </dt>
  <dd>
    <p>Print the contents of a directory pointed to by <em>dir</em> to the standard output.</p>
  </dd>
  <dt>
    CGM_getInstr,
  </dt>
  <dd>
    <p>Fetch the next instruction in file referenced by <em>cgm_edit</em>  and convert it into a usable format pointed to by <em>instr</em>. <strong>CGM_getInstr</strong> provides an interface to the metafile for extracting CGM elements. The user need not be concerned with the binary format of the metafile. The fields of the <em>Instr</em> are as described in <em>cgm_tools.h</em>. The user should note that the maximum allowable data length returned in a single invocation is 32760 bytes. The CGM standard allows upto 32767 bytes to be stored in a single instruction. But 32767 is not a nice number to work with. Should the data length of a CGM instruction exceed 32760 bytes, indicated by the boolean <em>more</em> flag, the next invocation of <strong>CGM_getInstr</strong> will return the remaining data up to the same limit, etc. <strong>CGMgetInstr</strong> requires a valid <em>Cgm_fd</em> open for reading. For a description on CGM see the ANSI standard.</p>
  </dd>
  <dt>
    CGM_flushGetInstr
  </dt>
  <dd>
    <p>Flush the input buffer used by <strong>CGM_getInstr</strong>. <strong>CGM_getInstr</strong> buffers the contents of the CGM and only performs actual reads as necessary. If the user desires other then sequential read access to a CGM it becomes necessary to flush the input buffer before reading from a new location.</p>
  </dd>
  <dt>
    CGM_putInstr
  </dt>
  <dd>
    <p>The analog to <strong>CGM_getInstr</strong>. This function buffers CGM instructions to be written to a CGM referenced by <em>cgm_fd</em>. Again the user need not be concerned with the binary format of the file. Writes are performed sequentially in record size <em>size</em> as specified during the creation of <em>cgm_fd</em>. The same data length constraints that are placed on <strong>CGM_getInstr</strong> hold for <strong>CGM_putInstr</strong>. If the user wants to output instructions with a data length greater than 32760 bytes then the data must be broken up into blocks no greater than this size. The user must also set the boolean <em>more</em> flag in the <em>Instr</em>. <em>cgm_fd</em> must be a valid file descriptor open for writing. For a description of the fields of the <em>Instr</em> see the file <em>cgm_tools.h</em>.</p>
  </dd>
  <dt>
    CGM_flushOutputInstr
  </dt>
  <dd>
    <p>Flush the output buffer used by <strong>CGM_putInstr</strong> for the file referenced by <em>cgm_fd</em>. It is necessary to explicitly flush the output buffer used by <strong>CGM_putInstr</strong> before the file is closed or any random access is performed. Otherwise not all CGM elements will actually get written.</p>
  </dd>
  <dt>
    CGM_initMetaEdit
  </dt>
  <dd>
    <p>Initialize a metafile for editing. This is the initialization routine for the higher level editing routines contained in this package: <strong>CGM_copyFrames,</strong> <strong>CGM_deleteFrames</strong>, <strong>CGM_readFrames</strong>, <strong>CGM_moveFrames</strong>, <strong>CGM_writeFile</strong>, <strong>CGM_writeFrames</strong>, and <strong>CGM_mergeFrames</strong>. These routines only work on one metafile at a time (the one named in <strong>CGM_initMetaEdit</strong>. Invoking this routine for a second time without explicitly saving any changes will have the effect of loading a new file and discarding all changes made in the previous file. <strong>CGM_initMetaEdit</strong> and all proceeding editing functions that <strong>make</strong> changes to the file return a pointer to a <em>Directory</em> as a convenience that allows the user to examine the state of the file. The contents of the directory are private and should NOT be changed by the user. A set of macros is provided in <em>cgm_tools.h</em> to be used for retrieving the directory's contents. <strong>Note</strong>: no changes are actually made to the edit file unless it is explicitly overwritten with either <strong>CGM_writeFile</strong> or <strong>CGM_writeFrames</strong>.</p>
  </dd>
  <dt>
    CGM_termMetaEdit
  </dt>
  <dd>
    <p>Terminate the editing session started with <strong>CGM_initMetaEdit</strong>. This routine should be called after any editing changes have been saved, if desired to save them, and before exiting the editing session. <strong>CGM_termMetaEdit</strong> frees valuable resources.</p>
  </dd>
  <dt>
    CGM_copyFrames
  </dt>
  <dd>
    <p>Copy <em>num</em> frames beginning with <em>start</em> to the frame addressed by <em>target</em>. If <em>target</em> is already occupied then the source frames are inserted in its place while the target frame, and all proceeding frames, are advanced. <strong>CGM_copy</strong> operates on the file initialized by <strong>CGM_initMetaEdit</strong> (the edit file). On successful completion a pointer to the current directory is returned. On error a NULL pointer is returned.</p>
  </dd>
  <dt>
    CGM_deleteFrames
  </dt>
  <dd>
    <p>Delete <em>num</em> frames from the edit file starting with frame <em>start</em>. On successful completion a pointer to the current directory is returned. On error a NULL pointer is returned.</p>
  </dd>
  <dt>
    CGM_mergeFrames
  </dt>
  <dd>
    <p>Overwrite the contents of frame addressed <em>bottom</em> with the union of the frame at location <em>bottom</em> and the frame at location <em>top</em>. The effect of this command is equivalent to drawing the <em>top</em> frame on top of the <em>bottom</em> frame. It is not a union in the true sense of the word. On successful completion a pointer to the current directory is returned. On error a NULL pointer is returned.</p>
  </dd>
  <dt>
    CGM_moveFrames
  </dt>
  <dd>
    <p>Move a block of <em>num</em> frames from the edit file starting with with frame <em>start</em> to the position occupied by frame <em>target</em> On successful completion a pointer to the current directory is returned. On error a NULL pointer is returned.</p>
  </dd>
  <dt>
    CGM_readFrames
  </dt>
  <dd>
    <p>Read <em>num</em> frames from metafile <em>file</em> starting with frame <em>start</em>. Insert the frames at address <em>target</em> in the edit file. On successful completion a pointer to the current directory is returned. On error a NULL pointer is returned.</p>
  </dd>
  <dt>
    CGM_validCGM
  </dt>
  <dd>
    <p>Determine whether a file is a valid NCAR CGM or not. This function performs a few simple diagnostics in an effort to determine whether a given file is in the NCAR CGM format. The tests performed are not rigorous and it is conceivable that the information retrieved is incorrect.  A return of 1 indicates a valid NCAR CGM. A return of 0 indicates the file is not a NCAR CGM. A return of -1 indicates an error occurred and the global variable `errno' is set accordingly.</p>
  </dd>
  <dt>
    CGM_writeFile
  </dt>
  <dd>
    <p>Write the entire contents of the current edit file to <em>file</em>. <strong>CGM_writeFile</strong> returns the integer one on success and a negative number on failure.</p>
  </dd>
  <dt>
    CGM_writeFrames
  </dt>
  <dd>
    <p>Write a block of <em>num</em> frames starting with frame <em>start</em> to <em>file</em>. The source frames come from the edit file. Note: CGM frames are contained in a wrapper made up of CGM <em>delimiter</em> elements. The file created by <strong>CGM_writeFrames</strong> will use the <em>wrapper</em> provided by the current edit file. Thus if a file <em>foo</em> contains <em>n</em> frames that are <em>read</em> into an editing session with a file <em>goo</em> and then these same frames are written out to a file <em>zoid</em>, <em>zoid</em> may or may not be the same as the original <em>foo</em>. <strong>CGM_writeFrames</strong> returns the integer one on success and a negative number on failure.</p>
  </dd>
  <dt>
    CGM_appendFrames
  </dt>
  <dd>
    <p>Append a block of <em>num</em> frames starting with frame <em>start</em> to <em>file</em>. <em>file</em> must already exist and be a valid NCAR CGM. <strong>CGM_appendFrames</strong> returns the integer one on success and a negative number on failure.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO cgm&hellip;</h2>
        <div class="sectioncontent">
<p>ANSI X3.122 <em>Computer Graphics Metafile for the Storage and Transfer of</em> Picture Description Information.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>CGMs with more the one metafile stored in the are not guaranteed to work.</p><p>Should not have to explicitly flush the output buffer for <strong>CGM_getInstr</strong>. This should be handled automatically when the file is closed.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (C) 1987-2009</p><p>University Corporation for Atmospheric Research</p><p>The use of this Software is governed by a License Agreement.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="next"><a href="cgm2ncgm.1NCARG.html">cgm2ncgm.1NCARG: Filter ncar cgm to/from vanilla cgm ncgm2cgm - filter ncar cgm to/from vanilla cgm <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
