<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>NPtcp: Network protocol independent performance evaluator</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Network protocol independent performance evaluator">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="NPtcp (1) manual">
  <meta name="twitter:description" content="Network protocol independent performance evaluator">
  <meta name="twitter:image" content="https://www.carta.tech/images/netpipe-tcp-NPtcp-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/NPtcp.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="NPtcp (1) manual" />
  <meta property="og:description" content="Network protocol independent performance evaluator" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/netpipe-tcp-NPtcp-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">NPtcp<small> (1)</small></h1>
        <p class="lead">Network protocol independent performance evaluator</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/NPtcp.1.html">
      <span itemprop="name">NPtcp: Network protocol independent performance evaluator</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/netpipe-tcp/">
      <span itemprop="name">netpipe-tcp</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/NPtcp.1.html">
      <span itemprop="name">NPtcp: Network protocol independent performance evaluator</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>NPtcp</strong> [ .BI -h &nbsp;receiver_hostname ] [ .BI -b &nbsp;TCP_buffer_sizes ] [options]</p><p>mpirun [ .BI -machinefile &nbsp;hostlist ] -np 2 <strong>NPmpi</strong> [-a] [-S] [-z] [options]</p><p>mpirun [ .BI -machinefile &nbsp;hostlist ] -np 2 <strong>NPmpi2</strong> [-f] [-g] [options]</p><p><strong>NPpvm</strong> [options]</p><p>See the TESTING sections below for a more complete description of how to run NetPIPE in each environment. The OPTIONS section describes the general options available for all modules. See the README file from the tar-ball at http://www.scl.ameslab.gov/Projects/NetPIPE/ for documentation on the InfiniBand, GM, SHMEM, LAPI, and memcpy modules.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>NetPIPE</strong> uses a simple series of ping-pong tests over a range of message sizes to provide a complete measure of the performance of a network. It bounces messages of increasing size between two processes, whether across a network or within an SMP system. Message sizes are chosen at regular intervals, and with slight perturbations, to provide a complete evaluation of the communication system. Each data point involves many ping-pong tests to provide an accurate timing. Latencies are calculated by dividing the round trip time in half for small messages ( less than 64 Bytes ).</p><p>The communication time for small messages is dominated by the overhead in the communication layers, meaning that the transmission is latency bound. For larger messages, the communication rate becomes bandwidth limited by some component in the communication subsystem (PCI bus, network card link, network switch).</p><p>These measurements can be done at the message-passing layer (MPI, MPI-2, and PVM) or at the native communications layers that that run upon (TCP/IP, GM for Myrinet cards, InfiniBand, SHMEM for the Cray T3E systems, and LAPI for IBM SP systems). Recent work is being aimed at measuring some internal system properties such as the memcpy module that measures the internal memory copy rates, or a disk module under development that measures the performance to various I/O devices.</p><p>Some uses for NetPIPE include:</p><p>Comparing the latency and maximum throughput of various network cards.</p><p>Comparing the performance between different types of networks.</p><p>Looking for inefficiencies in the message-passing layer by comparing it to the native communication layer.</p><p>Optimizing the message-passing layer and tune OS and driver parameters for optimal performance of the communication subsystem.</p><p><strong>NetPIPE</strong> is provided with many modules allowing it to interface with a wide variety of communication layers. It is fairly easy to write new interfaces for other reliable protocols by using the existing modules as examples.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TESTING TCP</h2>
        <div class="sectioncontent">
<p>NPtcp can now be launched in two ways, by manually starting NPtcp on both systems or by using a nplaunch script.  To manually start NPtcp, the NetPIPE receiver must be started first on the remote system using the command:</p><p>NPtcp [options]</p><p>then the primary transmitter is started on the local system with the command</p><p>NPtcp -h <em>receiver_hostname</em> [options]</p><p>Any options used must be the same on both sides.</p><p>The nplaunch script uses ssh to launch the remote receiver before starting the local transmitter.  To use rsh, simply change the nplaunch script.</p><p>nplaunch NPtcp -h <em>receiver_hostname</em> [options]</p><p>The <strong>-b</strong><em></em><strong>TCP_buffer_sizes</strong><em>option</em><strong>sets</strong><em>the</em><strong>TCP</strong><em>socket</em><strong>buffer</strong><em>size,</em><strong>which</strong><em>can</em><strong>greatly</strong><em>influence</em> the maximum throughput on some systems.  A throughput graph that flattens out suddenly may be a sign of the performance being limited by the socket buffer sizes.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TESTING MPI and MPI-2</h2>
        <div class="sectioncontent">
<p>Use of the MPI interface for NetPIPE depends on the MPI implementation being used. All will require the number of processes to be specified, usually with a <em>-np 2</em> argument.  Clusters environments may require a list of the hosts being used when each job is run. Put the list of hosts in hostlist then, for OpenMPI, run NetPIPE using:</p><p>mpirun --hostfile <em>hostlist</em> -np 2 NPmpi [NetPIPE options]</p><p>For MPICH2 use instead:</p><p>mpirun -machinefile <em>hostlist</em> -np 2 NPmpi [NetPIPE options]</p><p>To test the 1-sided communications of the MPI-2 standard, compile using:</p><p><strong>make mpi2</strong></p><p>Running as described above and MPI will use 1-sided MPI_Put() calls in both directions, with each receiver blocking until the last byte has been overwritten before bouncing the message back. Use the <em>-f</em> option to force usage of a fence to block rather than an overwrite of the last byte. The <em>-g</em> option will use MP_Get() functions to transfer the data rather than MP_Put().</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TESTING PVM</h2>
        <div class="sectioncontent">
<p>Start the pvm system using:</p><p>pvm</p><p>and adding a second machine with the PVM command</p><p>add <em>receiver_hostname</em></p><p>Exit the PVM command line interface using quit, then run the PVM NetPIPE receiver on one system with the command:</p><p>NPpvm [options]</p><p>and run the TCP NetPIPE transmitter on the other system with the command:</p><p>NPpvm -h <em>receiver hostname</em> [options]</p><p>Any options used must be the same on both sides. The nplaunch script may also be used with NPpvm as described above for NPtcp.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TESTING METHODOLOGY</h2>
        <div class="sectioncontent">
<p><strong>NetPIPE</strong> tests network performance by sending a number of messages at each block size, starting from the lower bound on the message sizes.</p><p>The message size is incremented until the upper bound on the message size is reached or the time to transmit a block exceeds one second, which ever occurs first.  Message sizes are chosen at regular intervals, and for slight perturbations from them to provide a more complete evaluation of the communication subsystem.</p><p>The <strong>NetPIPE output file may be graphed using a program such as</strong> <strong>gnuplot</strong>(1).</strong> The output file contains three columns: the number of bytes in the block, the transfer rate in bits per second, and the time to transfer the block (half the round-trip time). The first two columns are normally used to graph the throughput vs block size, while the third column provides the latency. For example, the <strong>throughput versus block size</strong> graph can be created by graphing bytes versus bits per second. Sample <strong>gnuplot</strong>(1)</strong> commands for such a graph would be</p><p>set logscale x</p><p>plot "np.out"</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-a</strong></p>
  </dt>
  <dd>
    <p>asynchronous mode: prepost receives (MPI, IB modules)</p>
  </dd>
  <dt>
    <p><strong>-b</strong><em></em><strong></strong><em>TCP_buffer_sizes</em></p>
  </dt>
  <dd>
    <p>Set the send and receive TCP buffer sizes (TCP module only).</p>
  </dd>
  <dt>
    <p><strong>-B</strong></p>
  </dt>
  <dd>
    <p>Burst mode where all receives are preposted at once (MPI, IB modules).</p>
  </dd>
  <dt>
    <p><strong>-f</strong></p>
  </dt>
  <dd>
    <p>Use a fence to block for completion (MPI2 module only).</p>
  </dd>
  <dt>
    <p><strong>-g</strong></p>
  </dt>
  <dd>
    <p>Use MPI_Get() instead of MPI_Put() (MPI2 module only).</p>
  </dd>
  <dt>
    <p><strong>-h</strong><em></em><strong></strong><em>hostname</em></p>
  </dt>
  <dd>
    <p>Specify the name of the receiver host to connect to (TCP, PVM, IB, GM).</p>
  </dd>
  <dt>
    <p><strong>-I</strong></p>
  </dt>
  <dd>
    <p>Invalidate cache to measure performance without cache effects (mostly affects IB and memcpy modules).</p>
  </dd>
  <dt>
    <p><strong>-i</strong></p>
  </dt>
  <dd>
    <p>Do an integrity check instead of a performance evaluation.</p>
  </dd>
  <dt>
    <p><strong>-l</strong><em></em><strong></strong><em>starting_msg_size</em></p>
  </dt>
  <dd>
    <p>Specify the lower bound for the size of messages to be tested.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>-n</strong><em></em><strong></strong><em>nrepeats</em></p>
  </dt>
  <dd>
    <p>Set the number of repeats for each test to a constant. Otherwise, the number of repeats is chosen to provide an accurate timing for each test.  Be very careful if specifying a low number so that the time for the ping-pong test exceeds the timer accuracy.</p>
  </dd>
  <dt>
    <p><strong>-O</strong><em></em><strong></strong><em>source_offset,dest_offset</em></p>
  </dt>
  <dd>
    <p>Specify the source and destination offsets of the buffers from perfect page alignment.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p><strong>-o</strong><em></em><strong></strong><em>output_filename</em> Specify the output filename (default is np.out).</p>
  </dd>
  <dt>
    <p><strong>-p</strong><em></em><strong></strong><em>perturbation_size</em></p>
  </dt>
  <dd>
    <p>NetPIPE chooses the message sizes at regular intervals, increasing them exponentially from the lower boundary to the upper boundary. At each point, it also tests perturbations of 3 bytes above and 3 bytes below each test point to find idiosyncrasies in the system. This perturbation value can be changed using the <em>-p</em> option, or turned off using <em>-p</em> <em>0</em> <strong>.</strong></p>
  </dd>
  <dt>
    <p><strong>-r</strong></p>
  </dt>
  <dd>
    <p>This option resets the TCP sockets after every test (TCP module only). It is necessary for some streaming tests to get good measurements since the socket window size may otherwise collapse.</p>
  </dd>
  <dt>
    <p><strong>-s</strong></p>
  </dt>
  <dd>
    <p>Set streaming mode where data is only transmitted in one direction.</p>
  </dd>
  <dt>
    <p><strong>-S</strong></p>
  </dt>
  <dd>
    <p>Use synchronous sends (MPI module only).</p>
  </dd>
  <dt>
    <p><strong>-u</strong><em></em><strong></strong><em>upper_bound</em></p>
  </dt>
  <dd>
    <p>Specify the upper boundary to the size of message being tested. By default, NetPIPE will stop when the time to transmit a block exceeds one second.</p>
  </dd>
  <dt>
    <p><strong>-z</strong></p>
  </dt>
  <dd>
    <p>Receive messages using MPI_ANY_SOURCE (MPI module only)</p>
  </dd>
  <dt>
    <p><strong>-2</strong></p>
  </dt>
  <dd>
    <p>Set bi-directional mode where both sides send and receive at the same time (supported by most modules). You may need to use <em>-a</em> to choose asynchronous communications for MPI to avoid freeze-ups. For TCP, the maximum test size will be limited by the TCP buffer sizes.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>np.out</em></p>
  </dt>
  <dd>
    <p>Default output file for <strong>NetPIPE</strong>. Overridden by the <strong>-o</strong> option.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>The original NetPIPE core plus TCP and MPI modules were written by Quinn Snell, Armin Mikler, Guy Helmer, and John Gustafson. NetPIPE is currently being developed and maintained by Dave Turner with contributions from many students (Bogdan Vasiliu, Adam Oline, Xuehua Chen, and Brian Smith).</p><p>Send comments/bug-reports to: <em></em> &lt;netpipe@scl.ameslab.gov&gt;.</p><p>Additional information about <strong>NetPIPE</strong> can be found on the World Wide Web at <em>http://www.scl.ameslab.gov/Projects/NetPIPE/</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>As of version 3.6.1, there is a bug that causes NetPIPE to segfault on RedHat Enterprise systems. I will debug this as soon as I get access to a few such systems.  -Dave Turner (turner@ameslab.gov)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="NPpvm.1.html"><span aria-hidden="true">&larr;</span> NPpvm.1: Network protocol independent performance evaluator</a></li>
   <li class="next"><a href="NRRDToDicom.1.html">NRRDToDicom.1: Works with dicom files <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
