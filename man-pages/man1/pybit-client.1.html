<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pybit-client: Buildd client script to perform build jobs using pybit queues.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Buildd client script to perform build jobs using pybit queues.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="pybit-client (1) manual">
  <meta name="twitter:description" content="Buildd client script to perform build jobs using pybit queues.">
  <meta name="twitter:image" content="https://www.carta.tech/images/pybit-client-pybit-client-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/pybit-client.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="pybit-client (1) manual" />
  <meta property="og:description" content="Buildd client script to perform build jobs using pybit queues." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/pybit-client-pybit-client-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pybit-client<small> (1)</small></h1>
        <p class="lead">Buildd client script to perform build jobs using pybit queues.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/pybit-client.1.html">
      <span itemprop="name">pybit-client: Buildd client script to perform build jobs using pybit queues.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/pybit-client/">
      <span itemprop="name">pybit-client</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/pybit-client.1.html">
      <span itemprop="name">pybit-client: Buildd client script to perform build jobs using pybit queues.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>pybit-client</strong> [<em>options</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>pybit-client receives messages from the controller to create a specific package build using the specified version control system. The client feeds status messages back to the controller.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE</h2>
        <div class="sectioncontent">
<p>pybit-client runs as a single-instance daemon by default. The standard daemon control interface is supported:</p>
<pre>
invoke-rc.d pybit-client stop
invoke-rc.d pybit-client start
update-rc.d pybit-client disable
update-rc.d pybit-client enable
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DAEMON CONFIGURATION</h2>
        <div class="sectioncontent">
<p>Certain values are set using <em>debconf</em> at package installation but values can also be set in /etc/pybit/client/client.conf and the relevant debconf settings can be updated using <em>dpkg-reconfigure pybit-client</em>. The configuration file is in JSON format.</p><p><em>clientid</em> - The clientid string for this client (must not be empty and needs to be unique for each client using any one RabbitMQ server).</p><p><em>host_arch</em> - The native architecture of this client, e.g. i386.</p>
<pre>
dpkg-architecture -qDEB_BUILD_ARCH
</pre>
<p><em>use_lvm</em> - Whether lvm snapshots are in use (default is true).</p><p><em>distribution</em> - The distribution in use. e.g. Debian.</p>
<pre>
dpkg-vendor --query vendor
</pre>
<p><em>pkg_format</em> - Tag used by each build client to screen out unsupported binary build formats, e.g. Debian clients will check for deb and RPM clients would check for rpm.</p><p><em>buildroot</em> - The buildd location on the client filesystem. Default: /home/buildd/pybit</p><p><em>host</em> - The location of the RabbitMQ server which sends the build messages. This can be omitted during initial setup and testing but needs to be specified and the client restarted or no builds will be started.</p><p><em>port</em> - Override the standard port of 5672 for the RabbitMQ server.</p><p><em>suites</em> - <em>NEW in 0.4.1</em> JSON list of the suites which this client can support - names must match the Distribution: specified in the changelog of relevant packages and must also match an alias for a configured schroot chroot.</p>
<pre>
 "suites": [ "unstable" ],
</pre>

<pre>
 "suites": [ "unstable", "squeeze-backports" ],
</pre>
<p>The <em>suite</em> field used in 0.4.0 has been removed - clients will not start unless at least one suite is specified in the <em>suites</em> list. See also /usr/share/pybitclient/client.conf</p><p><em>userid</em> - If the RabbitMQ server uses authentication, override the default username of <em>guest</em>.</p><p><em>password</em> - If the RabbitMQ server uses authentication, override the default password of <em>guest</em>.</p><p><em>vhost</em> - If the RabbitMQ server uses a specific VHost, override the default of <em>/</em>.</p><p><em>dput</em> - options passed down to dput - see dput (1). The default is <em>-U</em> to stop dput writing .upload files.</p><p><em>dput_dest</em> - The codename of the location to upload the built packages (must not be empty as the default for dput is typically to upload to ftp-master.debian.org).</p><p><em>poll_time</em> - frequency with which this client checks the queues for new messages. Measured in seconds. Default: 60 seconds.</p><p><em>debsignkey</em> - keyID to be used to sign the .changes files from this buildd. If empty or omitted, changes files will never be signed. <em>The specified key MUST NOT use a passphrase.</em> The key must be usable by the user running <strong>pybit-client</strong> - check with</p>
<pre>
gpg --list-secret-keys

</pre>
<p><em>dry_run</em> - initially, clients are setup in dry run mode which means that commands are echoed to the terminal instead of being executed, to allow testing of new setups. To enable builds on the client, edit /etc/pybit/client/client.conf to change the value for dry_run to false.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SCHROOT CONFIGURATION</h2>
        <div class="sectioncontent">
<p>The detailed process of creating chroots suitable for schroot is covered in the sbuild documentation (schroot.conf (5)) and amounts to using a tool like debootstrap to create a Debian build environment in a subdirectory (which may or may not be also the mountpoint of an LVM snapshot) and then configuring that chroot to have the relevant apt sources and pre-installed packages (e.g. build-essential and dpkg-dev).</p><p>Note: when creating a chroot for schroot, remember to use the <strong>--variant=buildd</strong> option to debootstrap and install fakeroot inside the chroot.</p><h3>Install pbuilder</h3>
<p>The pybit debianclient uses /usr/lib/pbuilder/pbuilder-satisfydepends-classic for the dependency resolution test, so the pbuilder package needs to be installed inside each build chroot.</p>
<h3>Naming the chroots</h3>
<p>The pybit client will expect to be able to use a chroot (or an alias for a chroot) which matches the suite specified in the build request. If using version control hooks, this suite is likely to come from the Distribution field of the output of <em>dpkg-parsechangelog</em>. Ensure that any client has a suitable chroot listed in the output of <em>schroot -l</em>.</p><p><strong>pybit-client</strong> only listens to queues which match the listed <em>suites</em> in /etc/pybit/client/client.conf.</p><p>The syntax for the suites configuration value changed in version 0.4.1 to support multiple suites within a JSON list:</p>
<pre>
 "suites": [ "unstable", "squeeze-backports" ],
</pre>
<p>Clients running 0.4.0 need to have the configuration file updated for 0.4.1 or the client will fail to start as it will be unable to bind to the necessary queues.</p>
<h3>Testing the chroots</h3>
<p>There is a test script (/usr/share/pybitclient/buildd-test.py) which can be used alongside a test schroot to run through the buildd commands and then do the upload. (What happens to that upload is dependent on the next step, it just sits in an incoming directory initially.)</p>
<h3>Configuring the upload handler</h3>
<p>Set up dput by editing /etc/pybit/client/dput.cf to provide a usable upload configuration. The format of this file is the same as ~/.dput.cf and is passed to dput using the -c option internally. See dput.cf (5)</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p><strong>-h</strong>, <strong>--help</strong></p><p>show this help message and exit</p><p><strong>--conf_file</strong>=<em>CONF_FILE</em></p><p>Configuration file from which settings can be read. Defaults to configs/client.conf from the current working directory or falls back to /etc/pybit/client/client.conf.</p><p><strong>--arch</strong>=<em>ARCH</em></p><p>Architecture to use, defaults to i386</p><p><strong>-d</strong></p><p>Run this client as a daemon - default option used by /etc/init.d/pybit-client.</p><p><strong>--distribution</strong>=<em>PYBIT_CLIENT_DIST</em></p><p>Distribution to use, defaults to Debian</p><p><strong>--pkg_format</strong>=<em>PYBIT_CLIENT_FORMAT</em></p><p>Package type to use, defaults to deb</p><p><strong>--suite</strong>=<em>PYBIT_CLIENT_SUITE</em></p><p>Suite to use, defaults to development</p><p><strong>--host</strong>=<em>PYBIT_CLIENT_HOST</em></p><p>host to connect to, defaults to localhost.</p><p><strong>--vhost</strong>=<em>PYBIT_CLIENT_VHOST</em></p><p>vhost to connect to, defaults to localhost.</p><p><strong>--userid</strong>=<em>PYBIT_CLIENT_USERID</em></p><p>user id to use for AMQP server, defaults to guest.</p><p><strong>--port</strong>=<em>PYBIT_CLIENT_PORT</em></p><p>port to use for AMQP server, defaults to 5672</p><p><strong>--password</strong>=<em>PYBIT_CLIENT_PASSWORD</em></p><p>password to use for AMQP server, defaults to guest</p><p><strong>--insist</strong>=<em>PYBIT_CLIENT_INSIST</em></p><p>insist to use for AMQP server, defaults to 5672</p><p><strong>--clientid</strong>=<em>PYBIT_CLIENT_INSIST</em></p><p>id to use for build-client control queue, defaults to 1 but is unique per amqp server.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SETTING UP THE PYBIT SERVER TO WORK WITH CLIENTS</h2>
        <div class="sectioncontent">
<p>The clients are only one part of pybit. pybit-web provides the server which will provide jobs for the clients. See pybit-web (1).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>This manual page was written by Neil Williams &lt;codehelp@debian.org&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pybformat.1.html"><span aria-hidden="true">&larr;</span> pybformat.1: Format a bibliography from a bibliographic databases</a></li>
   <li class="next"><a href="pybit-watcher.1.html">pybit-watcher.1: Watches incoming directories for reprepro <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
