<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>labrea: Honeypot for incoming ip connection attempts</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Honeypot for incoming ip connection attempts">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="labrea (1) manual">
  <meta name="twitter:description" content="Honeypot for incoming ip connection attempts">
  <meta name="twitter:image" content="https://www.carta.tech/images/labrea-labrea-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/labrea.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="labrea (1) manual" />
  <meta property="og:description" content="Honeypot for incoming ip connection attempts" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/labrea-labrea-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">labrea<small> (1)</small></h1>
        <p class="lead">Honeypot for incoming ip connection attempts</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/labrea.1.html">
      <span itemprop="name">labrea: Honeypot for incoming ip connection attempts</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/labrea/">
      <span itemprop="name">labrea</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/labrea.1.html">
      <span itemprop="name">labrea: Honeypot for incoming ip connection attempts</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>labrea</strong> [<strong>-i --device INTERFACE</strong>] [<strong>-n --network nnn.nnn.nnn.nnn[/nn]</strong>] [<strong>-m --mask nnn.nnn.nnn.nnn</strong>] [<strong>-t --throttle-size BYTES</strong>] [<strong>-p --max-rate RATE </strong>] [<strong>-R --soft-restart</strong>] [<strong>-r --arp-timeout RATE</strong>] [<strong>-s --switch-safe</strong>] [<strong>-h --hard-capture</strong>] [<strong>-x --disable-capture</strong>] [<strong>-X --exclude-resolvable-ips</strong>] [<strong>-P --persist-mode-only</strong>] [<strong>-a --no-resp-synack</strong>] [<strong>-H --auto-hard-capture</strong>] [<strong>-f --no-resp-excluded-ports</strong>] [<strong>--no-arp-sweep</strong>] [<strong>--init-file FILE</strong>] [<strong>-F --bpf-file FILE</strong>] [<strong>-T --dry-run</strong>] [<strong>-d --foreground</strong>] [<strong>-o --log-to-stdout</strong>] [<strong>-O --log-timestamp-epoch</strong>] [<strong>-l --log-to-syslog</strong>] [<strong>-b --log-bandwidth</strong>] [<strong>-v --verbose</strong>] [<strong>-q --quiet</strong>] [<strong>-z --no-nag</strong>] [<strong>-? --usage --help </strong>] [<strong>-V --version</strong>] [<strong>-I --ip-addr nnn.nnn.nnn.nnn</strong>] [<strong>-E --my-mac-addr xx:xx:xx:xx:xx:xx</strong>] [<strong>-D --list-interfaces</strong>] [<strong>-j --winpcap-dev nn</strong>] [<strong>--syslog-server nnn.nnn.nnn.nnn</strong>] [<strong>--syslog-port nnn</strong>]</p><p>[<strong>BPF Filter</strong>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>labrea</strong> creates virtual machines for unused IP addresses in the specified block of IP addresses.  LaBrea sits and listens for ARP "who-has" requests.</p><p>When an ARP request for a particular IP goes unanswered for longer than its "rate" setting (default: 3 seconds), labrea crafts an ARP reply that routes all traffic destined for the IP to a "bogus" MAC address.  labrea sniffs for TCP/IP traffic sent to that MAC address and then responds to any SYN packet with a SYN/ACK packet that it creates.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p><strong>labrea</strong> accepts the following options:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-i --device </strong><em>interface</em></p>
  </dt>
  <dd>
    <p>By default, labrea uses the first ethernet interface. This forces labrea to use the specified interface.</p>
  </dd>
  <dt>
    <p><strong>-n --network </strong>xxx.xxx.xxx.xxx[/nn]</p>
  </dt>
  <dd>
    <p>labrea normally pulls information about the netblock from the IP information assigned to the interface.  If labrea is run on an unconfigured interface (one without an assigned IP address), then use this option to specify the subnet to be captured.</p><p><em>xxx.xxx.xxx.xxx</em> is the network address. <em>/nn</em> is the subnet mask in CIDR notation. If the subnet mask is not specified here, then you must include the -m parameter.</p>
  </dd>
  <dt>
    <p><strong>-m --mask </strong>xxx.xxx.xxx.xxx</p>
  </dt>
  <dd>
    <p>Another way to specify the network mask for the capture netblock. If this parameter is specified, then the -n parameter must also be specified.</p>
  </dd>
  <dt>
    <p><strong>-t --throttle-size </strong><em>nn</em></p>
  </dt>
  <dd>
    <p>Sets the TCP window advertisement to limit the amount of data sent to labrea. The number of data bytes to allow per packet is <em>nn</em> bytes.</p>
  </dd>
  <dt>
    <p><strong>-p --max-rate </strong><em>rate</em></p>
  </dt>
  <dd>
    <p>Connect attempts will be permanently captured by forcing the connection into a "persist" state (by closing the TCP window). In this state, the connection will not time out.  labrea will permanently capture connect attempts up to maximum bandwidth <em>rate</em> bytes.  If the specified bandwidth is exceeded, labrea will still tarpit the incoming connection (ie respond SYN/ACK to incoming SYN).</p>
  </dd>
  <dt>
    <p><strong>-R --soft-restart</strong></p>
  </dt>
  <dd>
    <p>New captures will be held off for 5 minutes to let bandwidth calculations progress. If a major scan hits just after startup, this prevents labrea from capturing too many connections.</p>
  </dd>
  <dt>
    <p><strong>-r --arp-timeout </strong><em>rate</em></p>
  </dt>
  <dd>
    <p>Wait <em>rate</em> seconds after seeing incoming arp requests before capturing an IP address.</p>
  </dd>
  <dt>
    <p><strong>-s --switch-safe</strong></p>
  </dt>
  <dd>
    <p>When there is an incoming ARP request, specifies that labrea should send out an ARP request of its own for the same IP address. This is necessary for safe operation in a switched environment where one host does not necessarily see all the traffic on the switch.</p>
  </dd>
  <dt>
    <p><strong>-h --hard-capture </strong></p>
  </dt>
  <dd>
    <p>Once an IP address has been captured, then do not wait for a "-r" timeout for the next incoming ARP request.</p>
  </dd>
  <dt>
    <p><strong>-x --disable-capture</strong></p>
  </dt>
  <dd>
    <p>Do not capture IPs.</p>
  </dd>
  <dt>
    <p><strong>-X --exclude-resolvable-ips</strong></p>
  </dt>
  <dd>
    <p>On startup, attempt DNS resolution on all IPs within the capture netblock. Automatically exclude any IP that has a corresponding entry in the DNS. Be careful because this can generate a lot of DNS lookups if the capture subnet is large.</p>
  </dd>
  <dt>
    <p><strong>-P --persist-mode-only</strong></p>
  </dt>
  <dd>
    <p>Try to limit bandwidth use by doing only persist capturing. Note: This parameter has limited usefulness since below max b/w, the same exchange that leads to persist capture also has the side effect of tarpitting.</p>
  </dd>
  <dt>
    <p><strong>-a --no-resp-synack</strong></p>
  </dt>
  <dd>
    <p>By default, the LaBrea virtual hosts respond to SYN/ACK with RST, and answer Pings. Disables this behaviour.</p>
  </dd>
  <dt>
    <p><strong>-H --auto-hard-capture</strong></p>
  </dt>
  <dd>
    <p>Mark all non-excluded and all non-hardexcluded IPs as being hard captured. See <a href="../man5/labrea.conf.5.html"><strong>labrea.conf</strong>(5)</a></strong> for more information. This parameter should be used <em>with caution.</em></p>
  </dd>
  <dt>
    <p><strong>-f --no-resp-excluded-ports</strong></p>
  </dt>
  <dd>
    <p>Drop incoming connections to excluded ports. Normal default behaviour is to return a RST. Makes nmap-style scanning go much slower.</p>
  </dd>
  <dt>
    <p><strong>--no-arp-sweep</strong></p>
  </dt>
  <dd>
    <p>On startup, labrea sweeps the capture subnet with bursts of ARP requests in an attempt to locate all live machines. This parameter disables the sweep.</p>
  </dd>
  <dt>
    <p><strong>--init-file </strong><em>file</em></p>
  </dt>
  <dd>
    <p>Read the configuration from the specified <em>file</em> instead of from the default location.</p>
  </dd>
  <dt>
    <p><strong>-F --bpf-file </strong><em>file</em></p>
  </dt>
  <dd>
    <p>Designates the name of a file containing a BPF filter pointing to machines/ports to be tarpitted.  As with the command line BPF filter, these connections MUST be firewalled to DROP inbound traffic.</p>
  </dd>
  <dt>
    <p><strong>-T --dry-run</strong></p>
  </dt>
  <dd>
    <p>Do labrea initialization, including Dns excludes, parse of the configuration file, opening the network interface etc. Print diagnostic information, then exit.</p>
  </dd>
  <dt>
    <p><strong>-d --foreground</strong></p>
  </dt>
  <dd>
    <p>Do not detach the process. (Unix systems only)</p>
  </dd>
  <dt>
    <p><strong>-o --log-to-stdout</strong></p>
  </dt>
  <dd>
    <p>Send log information to stdout rather than to syslog.  This option also implies and sets the -d option (i.e. do not detach process).</p>
  </dd>
  <dt>
    <p><strong>-O --log-timestamp-epoch</strong></p>
  </dt>
  <dd>
    <p>Same as the "-o" option, but with time output in seconds since epoch to make it easier for logfile analysis programs.</p>
  </dd>
  <dt>
    <p><strong>-l --log-to-syslog</strong></p>
  </dt>
  <dd>
    <p>Send log messages to syslog.</p>
  </dd>
  <dt>
    <p><strong>-b --log-bandwidth</strong></p>
  </dt>
  <dd>
    <p>Log a message every minute detailing the current bandwidth consumption of the -p option (persist capture).</p>
  </dd>
  <dt>
    <p><strong>-v --verbose</strong></p>
  </dt>
  <dd>
    <p>Increase the verbosity of log messages. Use twice for more effect.</p>
  </dd>
  <dt>
    <p><strong>-q --quiet</strong></p>
  </dt>
  <dd>
    <p>Do not report arp requests for IPs that are not in the capture subnet.</p>
  </dd>
  <dt>
    <p><strong>-z --no-nag</strong></p>
  </dt>
  <dd>
    <p>Turn off the nag message. Before you do this, read the basic warning in the Notes section just below.</p>
  </dd>
  <dt>
    <p><strong>-? --usage --help</strong></p>
  </dt>
  <dd>
    <p>Print a help message and then exit.</p>
  </dd>
  <dt>
    <p><strong>-V --version</strong></p>
  </dt>
  <dd>
    <p>Print version information and exit.</p>
  </dd>
  <dt>
    <p><strong>-I --ip-addr </strong><em>nnn.nnn.nnn.nnn</em></p>
  </dt>
  <dd>
    <p>Manually specify the IP address for the labrea server.</p>
  </dd>
  <dt>
    <p><strong>-E --my-mac-addr </strong><em>xx:xx:xx:xx:xx:xx</em></p>
  </dt>
  <dd>
    <p>Manually specify the MAC address of the labrea server's NIC.</p>
  </dd>
  <dt>
    <p><strong>-D --list-interfaces</strong></p>
  </dt>
  <dd>
    <p>On Windows systems, print the list of WinPcap devices, followed by the list of the libdnet interfaces. Note that each API has a different nomenclature for the underlying NIC.</p>
  </dd>
  <dt>
    <p><strong>-j --winpcap-dev </strong><em>nn</em></p>
  </dt>
  <dd>
    <p>On windows systems, select the nth winpcap device in the list.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<h3>Basic Warning about use of labrea</h3>
<p><em>You must understand this:</em> As a default, LaBrea captures IP addresses by creating a "virtual machine" that sits on any UNUSED IP address that it sees. labrea has been carefully written and tested to transparently and peacefully operate in normal production environments but ...</p><p><em>There is a potential for problems</em> if someone decides to start using one of the IP addresses that labrea has laid claim to, or if labrea erroneously decides that an IP address is free when in fact a real machine is already there.</p>
<h3>Built-in protections</h3>
<p>labrea tries very hard to NEVER capture an IP that has a live machine sitting on it.</p><p>The following automatic mechanisms are provided:</p><ul>
<li><p>If labrea sees a gratuitous ARP signalling the arrival of a new machine, it marks the corresponding IP address as excluded. ("new kids on the block" logic)</p></li><li><p>Each ARP response is noted and the corresponding IP address is marked as excluded.</p></li><li><p>At startup, a systematic sweep is done of the entire capture subnet (as long as the subnet is not too big). All IP addresses that respond are marked as excluded.</p></li>
</ul><p>Then there are ways of manually specifying the exclusion of certain addresses, and otherwise ensuring safe operation:</p><ul>
<li><p>The EXC config stmt allows specified IP addresses to be manually excluded from capture.</p></li><li><p>The IPI config stmt causes packets with the specified IP source address(es) to be ignored.</p></li><li><p>-s --switch-safe parameter causes mirroring of ARP requests in a switched environment</p></li><li><p>-X --exclude-resolvable-ips says to exclude all IPs that have a corresponding Dns entry</p></li>
</ul><p><strong>Traffic rerouting:</strong> Despite all this, if labrea somehow receives traffic whose IP destination address belongs to a live machine, labrea will reroute that traffic to the real machine.</p>
<h3>Size of the capture subnet</h3>
<p>It is best to limit the capture subnet to the <em>actual physical segment</em> (VLAN, hub) where labrea is running.</p><p>In some configurations, where proxy arp is being used to determine routing, interface subnet masks can be quite large. (i.e. the "whole" network is "directly" attached to the physical segment).</p><p>In this case, if labrea picks up the subnet mask from the interface, then labrea will inefficiently watch addresses that it has no hope of capturing. You should use the -m / -n parameters to manually limit the size of the capture subnet.</p>
<h3>Other usage notes</h3>
<p>The labrea virtual machines use a bogus MAC address of 0:0:f:ff:ff:ff On certain older Windows systems, it may be necessary to manually specify the capture subnet. On unix systems, KILL -USR1 will toggle logging off on and off. On unix systems, KILL -HUP will cause labrea to reinitialize (and thus free captured IPs). If the capture subnet is too large (greater than 1024 addresses), then labrea will not do an arp sweep.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>On some systems, if there is absolutely no traffic to sniff, pcap_dispatch will wait instead of timing out, making the program seem unresponsive. (Workaround: ping the labrea server to "wake" it up.) If --exclude-resolvable-ips is enabled, and if the capture subnet is large (say class A /8), then a LOT of traffic will be generated to the Dns server.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    1)
  </dt>
  <dd>
    <p>Run safely in a switched environment with very verbose logging. Don't respond to excluded ports. Log bandwidth usage from persist capturing. Exclude all IPs that are in the Dns. Run in the foreground, and log to stdout. Maximum capture bandwidth is 2 MB/sec. Use toto.conf as the initialisation file. Use network device "eth1" instead of the default device. Do a test run only - parse input, initialize, then exit.</p>
  </dd>

</dl>

<pre>
	  labrea --switch-safe --verbose -v  --no-resp-excluded-ports
		--log-bandwidth --exclude-resolvable-ips --foreground
		--log-to-stdout --max-rate 2000000 --init-file toto.conf
		--device eth1 -z --dry-run
		(one line)
</pre>

<dl class='dl-vertical'>
  <dt>
    2)
  </dt>
  <dd>
    <p>Same thing with the short parameter style.</p>
  </dd>

</dl>

<pre>
	  labrea -z -s -v -v -f -b -X -d -o -p 2000000
		--init-file toto.conf -i eth1 -T
		(one line)
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>/usr/local/etc/labrea.conf</em></p>
  </dt>
  <dd>
    <p>Default configuration file</p>
  </dd>
  <dt>
    <p><em>/usr/local/sbin/labrea</em></p>
  </dt>
  <dd>
    <p>Program</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO labrea&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/labrea.conf.5.html"><strong>labrea.conf</strong>(5)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Tom Liston &lt;tliston@hackbusters.net&gt; Bugs: lorgor@users.sourceforge.net or http://labrea.sourceforge.net</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="lablglut.1.html"><span aria-hidden="true">&larr;</span> lablglut.1: Ocaml toplevel with labgl support.</a></li>
   <li class="next"><a href="lacheck.1.html">lacheck.1: A consistency checker for latex documents. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
