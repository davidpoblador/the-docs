<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>shtool-rotate: \s-1gnu\s0 shtool log file rotation</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="\s-1gnu\s0 shtool log file rotation">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="shtool-rotate (1) manual">
  <meta name="twitter:description" content="\s-1gnu\s0 shtool log file rotation">
  <meta name="twitter:image" content="https://www.carta.tech/images/shtool-shtool-rotate-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/shtool-rotate.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="shtool-rotate (1) manual" />
  <meta property="og:description" content="\s-1gnu\s0 shtool log file rotation" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/shtool-shtool-rotate-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">shtool-rotate<small> (1)</small></h1>
        <p class="lead">\s-1gnu\s0 shtool log file rotation</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/shtool-rotate.1.html">
      <span itemprop="name">shtool-rotate: \s-1gnu\s0 shtool log file rotation</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/shtool/">
      <span itemprop="name">shtool</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/shtool-rotate.1.html">
      <span itemprop="name">shtool-rotate: \s-1gnu\s0 shtool log file rotation</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>shtool rotate</strong> [<strong>-v</strong>|<strong>--verbose</strong>] [<strong>-t</strong>|<strong>--trace</strong>] [<strong>-f</strong>|<strong>--force</strong>] [<strong>-n</strong>|<strong>--num-files</strong> <em>count</em>] [<strong>-s</strong>|<strong>--size</strong> <em>size</em>] [<strong>-c</strong>|<strong>--copy</strong>] [<strong>-r</strong>|<strong>--remove</strong>] [<strong>-a</strong>|<strong>--archive-dir</strong> <em>dir</em>] [<strong>-z</strong>|<strong>--compress</strong> [<em>tool</em>:]<em>level</em>] [<strong>-b</strong>|<strong>--background</strong>] [<strong>-d</strong>|<strong>--delay</strong>] [<strong>-p</strong>|<strong>--pad</strong> <em>len</em>] [<strong>-m</strong>|<strong>--mode</strong> <em>mode</em>] [<strong>-o</strong>|<strong>--owner</strong> <em>owner</em>] [<strong>-g</strong>|<strong>--group</strong> <em>group</em>] [<strong>-M</strong>|<strong>--migrate</strong> <em>cmd</em>] [<strong>-P</strong>|<strong>--prolog</strong> <em>cmd</em>] [<strong>-E</strong>|<strong>--epilog</strong> <em>cmd</em>] <em>file</em> [<em>file</em> ...]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This command rotates a logfile <em>file</em> by subsequently creating up to <em>count</em> (optionally compressed) archive files of it. Archive files are named "<em>file</em>.<em>number</em>[<em>compress-suffix]</em>" where <em>number</em> is the version number, 0 being the newest and "<em>count</em>-1" the oldest.</p><p>A rotation step consists of the following steps</p><p>1. remove last archive file 2. shift archive file numbers 3. create archive file 0 from <em>file</em> 4. truncate/recreate <em>file</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>The following command line options are available.</p>
<dl class='dl-vertical'>
  <dt>
    <strong>-v</strong>, <strong>--verbose</strong>
  </dt>
  <dd>
    <p>Display some processing information.</p>
  </dd>
  <dt>
    <strong>-t</strong>, <strong>--trace</strong>
  </dt>
  <dd>
    <p>Enable the output of the essential shell commands which are executed.</p>
  </dd>
  <dt>
    <strong>-f</strong>, <strong>--force</strong>
  </dt>
  <dd>
    <p>Force silent creation of archive directory if it does not exists. Also skip missing intermediate logfiles in the rotation step. Default is to exit with error in both cases. \s-1FIXME\s0</p>
  </dd>
  <dt>
    <strong>-n</strong>, <strong>--num-files</strong> <em>count</em>
  </dt>
  <dd>
    <p>Create <em>count</em> archive files. Default is 10.</p>
  </dd>
  <dt>
    <strong>-s</strong>, <strong>--size</strong> <em>size</em>
  </dt>
  <dd>
    <p>Only rotate if logfile exceeds <em>size</em>. The argument <em>size</em> can be specified also with the trailing units \*(C`K\*(C' (kilo), \*(C`M\*(C' (mega) or \*(C`G\*(C' (giga). The \*(L"prolog\*(R" and \*(L"epilog\*(R" are only executed if rotation actually takes place.</p>
  </dd>
  <dt>
    <strong>-c</strong>, <strong>--copy</strong>
  </dt>
  <dd>
    <p>Copy <em>file</em> to archive then truncate original. The default is to move <em>file</em> to archive. Unless an application reopens its logfile it will continue to write to the same file. In the default move case the application will write to the archive which it had previously opened as <em>file</em>. In the copy case the application will write to the original <em>file</em>. The drawback of the copy approach is that logfile entries are lost when they are written to <em>file</em> between the execution of the copy and the truncation operation. The drawback of the move approach is that the application needs to detect the move or must be triggered to reopen its log (i.e. through epilog).</p>
  </dd>
  <dt>
    <strong>-r</strong>, <strong>--remove</strong>
  </dt>
  <dd>
    <p>Removes <em>file</em> after rotation instead of providing a new empty file.</p>
  </dd>
  <dt>
    <strong>-a</strong>, <strong>--archive-dir</strong> <em>dir</em>
  </dt>
  <dd>
    <p>Specify the archive directory. Default is to create archives in the same directory as <em>file</em> is located.</p>
  </dd>
  <dt>
    <strong>-z</strong>, <strong>--compress</strong> [<em>tool</em>:]<em>level</em>
  </dt>
  <dd>
    <p>Enables compression of archive files with compression level <em>level</em> By default, the tools <em>bzip2</em>\|(1), <em>gzip</em>\|(1) and <em>compress</em>\|(1) are searched for in $PATH, but one also can override this by prefixing the compression level with one of the three particular tool names.</p>
  </dd>
  <dt>
    <strong>-b</strong>, <strong>--background</strong>
  </dt>
  <dd>
    <p>Enable background compression.</p>
  </dd>
  <dt>
    <strong>-d</strong>, <strong>--delay</strong>
  </dt>
  <dd>
    <p>Delays the compression of archive file number 0. This is useful if ``<strong>-c</strong>'' is not used, because an application might continue to write to archive file 0 through an already open file handle.</p>
  </dd>
  <dt>
    <strong>-p</strong>, <strong>--pad</strong> <em>len</em>
  </dt>
  <dd>
    <p>Enables padding with leading zeros in the <em>number</em> part of the filename "<em>file</em>.<em>number</em><em>compress-suffix</em>". The default padding <em>len</em> is 1. This is interesting if more than 10 archive files are used, because it leads to still sorted directory listings.</p>
  </dd>
  <dt>
    <strong>-m</strong>, <strong>--mode</strong> <em>mode</em>
  </dt>
  <dd>
    <p>The file mode applied to the created files, see <em>chmod</em>\|(1). Setting mode to \*(C`-\*(C' skips this step and leaves the operating system default which is usually based on <em>umask</em>\|(1). Some file modes require superuser privileges to be set. Default is 0755.</p>
  </dd>
  <dt>
    <strong>-o</strong>, <strong>--owner</strong> <em>owner</em>
  </dt>
  <dd>
    <p>The file owner name or id applied to the created files, see <em>chown</em>\|(1). This option requires superuser privileges to execute. Default is to skip this step and leave the operating system default which is usually based on the executing uid or the parent setuid directory.</p>
  </dd>
  <dt>
    <strong>-g</strong>, <strong>--group</strong> <em>group</em>
  </dt>
  <dd>
    <p>The file group name or id applied to the created files, see <em>chgrp</em>\|(1). This option requires superuser privileges to execute to the fullest extend, otherwise the choice of <em>group</em> is limited on most operating systems. Default is to skip this step and leave the operating system default which is usually based on the executing gid or the parent setgid directory.</p>
  </dd>
  <dt>
    <strong>-M</strong>, <strong>--migrate</strong> <em>cmd</em>
  </dt>
  <dd>
    <p>Execute a \*(L"migration\*(R" command just before the archive file number <em>count</em>-1 is removed from the filesystem. The specified <em>cmd</em> receives the archive filename as command line argument.</p>
  </dd>
  <dt>
    <strong>-P</strong>, <strong>--prolog</strong> <em>cmd</em>
  </dt>
  <dd>
    <p>Execute a \*(L"prolog\*(R" command before the rotation step. Useful in conjunction with <strong>-s</strong>.</p>
  </dd>
  <dt>
    <strong>-E</strong>, <strong>--epilog</strong> <em>cmd</em>
  </dt>
  <dd>
    <p>Execute a \*(L"epilog\*(R" command after the rotation step. Useful in conjunction with <strong>-s</strong>.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<pre>
 #   shell script
 shtool rotate -n10 -s1M -zbzip2:9 -d -r /var/log/ap.access.log
 shtool rotate -n5 -s128K -zbzip2:9 -d -r /var/log/ap.error.log
 apachectl graceful
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">
<p>The <strong>\s-1GNU\s0 shtool</strong> <strong>rotate</strong> command was originally written by Ralf S. Engelschall &lt;rse@engelschall.com&gt; in 2001 for <strong>\s-1GNU\s0 shtool</strong>. Its development was prompted by the need to have a flexible logfile rotation facility in the <strong>OpenPKG</strong> project.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO shtool-rotate&hellip;</h2>
        <div class="sectioncontent">
<p><em>shtool</em>\|(1), \s-1BSD\s0 <em>newsyslog</em>\|(8).</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="shtool-prop.1.html"><span aria-hidden="true">&larr;</span> shtool-prop.1: \s-1gnu\s0 shtool propeller processing indication</a></li>
   <li class="next"><a href="shtool-scpp.1.html">shtool-scpp.1: \s-1gnu\s0 shtool c source file pre-processor <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
