<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ao-dbg: Hex debugger for cc1111 processors</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Hex debugger for cc1111 processors">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="ao-dbg (1) manual">
  <meta name="twitter:description" content="Hex debugger for cc1111 processors">
  <meta name="twitter:image" content="https://www.carta.tech/images/altos-ao-dbg-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/ao-dbg.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ao-dbg (1) manual" />
  <meta property="og:description" content="Hex debugger for cc1111 processors" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/altos-ao-dbg-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">ao-dbg<small> (1)</small></h1>
        <p class="lead">Hex debugger for cc1111 processors</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/ao-dbg.1.html">
      <span itemprop="name">ao-dbg: Hex debugger for cc1111 processors</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/altos/">
      <span itemprop="name">altos</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/ao-dbg.1.html">
      <span itemprop="name">ao-dbg: Hex debugger for cc1111 processors</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>ao-dbg</strong> [-t <em>cpu-type</em>] [-X <em>frequency</em>] [-c] [-r <em>listen-port</em>] [-Z <em>listen-port</em>] [-s] [-S] [-p <em>prompt</em>] [-V] [-v] [-H] [-h] [-m] [-T <em>tty-device</em>] [--tty <em>tty-device</em>] [-D <em>altos-device</em>] [--device <em>altos-device</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><em>ao-dbg</em> connects to a cc1111 processor through either a suitable cc1111 board or a cp2103 usb to serial converter board, using the GPIO pins available on that chip. It provides an interface compatible with the 8051 emulator from sdcc called s51, but communicating with the real chip instead of an emulation. Using a modified version of the SDCC debugger (sdcdb), you can control program execution on the target machine at source-level.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>The command line options are designed to be compatible with the 8051 emulator so that it can be used with sdcdb. As such, they're all one letter long.</p>
<dl class='dl-vertical'>
  <dt>
    -t <em>cpu-type</em>
  </dt>
  <dd>
    <p>The 8051 emulator can operate as one of several different chips. Oddly, the real hardware cannot, so this option is ignored.</p>
  </dd>
  <dt>
    -X <em>frequency</em>
  </dt>
  <dd>
    <p>Similarly, the emulator can pretend to run at an arbitrary frequency which the real hardware cannot do. Ignored.</p>
  </dd>
  <dt>
    -c
  </dt>
  <dd>
    
  </dd>
  <dt>
    -s
  </dt>
  <dd>
    
  </dd>
  <dt>
    -S
  </dt>
  <dd>
    
  </dd>
  <dt>
    -v
  </dt>
  <dd>
    
  </dd>
  <dt>
    -V
  </dt>
  <dd>
    <p>All ignored.</p>
  </dd>
  <dt>
    -r <em>listen-port</em>, -Z <em>listen-port</em>
  </dt>
  <dd>
    <p>The emulator and sdcdb communicate through a network socket. This option switches the debugger from communicating through stdin/stdout to listening on a specific network port instead. Once a connection is made, the debugger continues on, using that network port for command input and output. The debugger uses port 9756, and attempts to connect before launching ao-dbg, so if ao-dbg is listening on this port before sdcdb is started, sdcdb will end up talking to the existing ao-dbg instance. That's often useful for debugging ao-dbg itself.</p>
  </dd>
  <dt>
    -p <em>prompt</em>
  </dt>
  <dd>
    <p>This sets the command prompt to the specified string.</p>
  </dd>
  <dt>
    -P
  </dt>
  <dd>
    <p>This sets the command prompt to a single NUL character. This is for use by sdcdb.</p>
  </dd>
  <dt>
    -h
  </dt>
  <dd>
    <p>This should print a usage message, but does nothing useful currently.</p>
  </dd>
  <dt>
    -m
  </dt>
  <dd>
    <p>This option is not present in the original 8051 emulator, and causes ao-dbg to dump all commands and replies that are received from and sent to sdcdb.</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    <p>-T tty-device | --tty tty-device</p>
  </dt>
  <dd>
    <p>This selects which tty device the debugger uses to communicate with the target device. The special name 'BITBANG' directs ao-dbg to use the cp2103 connection, otherwise this should be a usb serial port connected to a suitable cc1111 debug node.</p>
  </dd>
  <dt>
    <p>-D AltOS-device | --device AltOS-device</p>
  </dt>
  <dd>
    <p>Search for a connected device. This requires an argument of one of the following forms:</p><ul>
<li><p>TeleMetrum:2</p><p>TeleMetrum</p><p>2</p></li><li><p>Leaving out the product name will cause the tool to select a suitable product, leaving out the serial number will cause the tool to match one of the available devices.</p></li>
</ul>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMMANDS</h2>
        <div class="sectioncontent">
<p>Once started, ao-dbg connects to the cc1111 and then reads and executes commands, either from stdin, or the nework connection to sdcdb.</p><p>Unlike the command line, ao-dbg contains built-in help for each of these commands, via the 'help' command. Most of the commands are available in a long form and a single character short form. Below, the short form follows the long form after a comma.</p>
<dl class='dl-vertical'>
  <dt>
    help, ? {command}
  </dt>
  <dd>
    <p>Without arguments, prints a list of available commands. With an argument prints more detail about the specific command</p>
  </dd>
  <dt>
    quit, q
  </dt>
  <dd>
    <p>Terminates the application, without changing the state of the target processor.</p>
  </dd>
  <dt>
    di [start] [end]
  </dt>
  <dd>
    <p>Dumps imem (256 bytes of "internal" memory) from start to end (inclusive).</p>
  </dd>
  <dt>
    ds [start] [end]
  </dt>
  <dd>
    <p>Dumps sprs from start to end (inclusive). Note that while most sprs are visible in the global address space, some are not, so use this command instead of "dx" to read them.</p>
  </dd>
  <dt>
    dx [start] [end]
  </dt>
  <dd>
    <p>Dump external (global) memory from start to end (inclusive).</p>
  </dd>
  <dt>
    set, t &lt;prefix&gt; [start] {data ...}
  </dt>
  <dd>
    <p>Store to the memory space specified by prefix where prefix is one of "xram", "rom", "iram", or "sfr". Store bytes starting at start.</p>
  </dd>
  <dt>
    dump, d &lt;prefix&gt; [start] [end]
  </dt>
  <dd>
    <p>Dump from the memory space specified by prefix, where prefix is one of "xram", "rom", "iram" or "sfr". Dumps from start to end (inclusive).</p>
  </dd>
  <dt>
    file [filename]
  </dt>
  <dd>
    <p>Specifies an intel-format hex file (ihx) that contains the contents of the rom area loaded into the cc1111. This is used to respond to requests to dump rom memory contents without getting them from the cc1111 (which is slow).</p>
  </dd>
  <dt>
    pc, p {address}
  </dt>
  <dd>
    <p>If the address argument is given, this sets the program counter to the specified value. Otherwise, the current program counter value is displayed.</p>
  </dd>
  <dt>
    break, b [address]
  </dt>
  <dd>
    <p>Sets a breakpoint at the specified address. This uses the built-in hardware breakpoint support in the cc1111. As a result, it supports no more than four breakpoints at once. You must therefore use a modified version of sdcdb which changes how program execution is controlled to work within this limit.</p>
  </dd>
  <dt>
    clear, c [address]
  </dt>
  <dd>
    <p>Clear a breakpoint from the specified address.</p>
  </dd>
  <dt>
    run, r, go, g {start} {stop}
  </dt>
  <dd>
    <p>Resumes execution of the program. If the start argument is present, then it begins at that address, otherwise it continues running at the current pc. If a stop argument is present, then a temporary breakpoint is set at that address. This temporary breakpoint will be removed when execution hits it.</p>
  </dd>
  <dt>
    next, n
  </dt>
  <dd>
    <p>Step one instruction. In the original s51 program this would ignore subroutines, but as sdcdb doesn't require this functionality, it's not available here.</p>
  </dd>
  <dt>
    step, s
  </dt>
  <dd>
    <p>Step one instruction.</p>
  </dd>
  <dt>
    load, l [filename]
  </dt>
  <dd>
    <p>This is not implemented, but it is supposed to load a hex file into flash. Use the ccload program instead.</p>
  </dd>
  <dt>
    halt, h
  </dt>
  <dd>
    <p>Halt the processor. This is the only command which can be sent while the program is running. It is ignored at other times.</p>
  </dd>
  <dt>
    reset, res
  </dt>
  <dd>
    <p>Reset the processor. This pulls the reset pin low and re-enables debug mode. Check the cc1111 documentation to see precisely what this does.</p>
  </dd>
  <dt>
    status
  </dt>
  <dd>
    <p>This dumps the cc1111 debug status register.</p>
  </dd>
  <dt>
    info, i breakpoints, b
  </dt>
  <dd>
    <p>List the current breakpoints.</p>
  </dd>
  <dt>
    info, i help, ?
  </dt>
  <dd>
    <p>List the things you can get info on.</p>
  </dd>
  <dt>
    stop
  </dt>
  <dd>
    <p>This doesn't do anything and is present only to retain compatibility with the original 8051 emulator.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BOARD BRINGUP DEBUGGING</h2>
        <div class="sectioncontent">
<p>While the original purpose for this program was to connect the source debugger with the hardware, it can also be used as a low-level hex debugger all on its own. In particular, all of the cc1111 peripherals can be manipulated directly from the ao-dbg command line.</p>
<dl class='dl-vertical'>
  <dt>
    Starting ao-dbg
  </dt>
  <dd>
    <p>First ensure that the target cc1111 device and intermediate cp2103 or cc111 board are all hooked up correctly.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>$ ao-dbg</p><p>Welcome to the non-simulated processor</p><p>&gt; status</p><p>	CPU halted</p><p>	Halted by debug command</p><p>&gt;</p>
  </dd>
  <dt>
    Turning on LEDs
  </dt>
  <dd>
    <p>Two of the cc1111 GPIO pins, P1_0 and P1_1 are capable of driving external LEDs. To control these, set the Port 1 direction bits to make these output pins and then change the Port 1 data to set them high or low:</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>&gt; set sfr 0xfe 0x02	# set P1DIR to 0x2</p><p>&gt; set sfr 0x90 0x02	# set P1_1 to high</p><p>&gt; set sfr 0x90 0x00	# set P1_1 to low</p>
  </dd>
  <dt>
    Reading the A/D converters
  </dt>
  <dd>
    <p>The six A/D converter inputs can each be connected to any of the P0 pins, ground, the A/D voltage refernece, an internal temperature sensor or VDD/3. To read one of these values, select an A/D converter to use then start the conversion process. The cc1111 manual has the table for selecting the input on page 144.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>To configure one of the P0 pins for use by the A/D unit, we program the ADCCFG register, setting the bits in that which match the pins desired:</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>&gt; set sfr 0xf2 0x3f	# enable all 6 A/D inputs</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>To trigger a single conversion, we ask the A/D unit to perform an 'extra' conversion, which means to do a single conversion not a whole sequence of conversions. This is controlled by the ADCCON3 register at 0xB6:</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>&gt; set sfr 0xb6 0xb2	# sample P0_2 using 12 bits of precision</p><p>&gt; ds 0xba 0xbb		# dump the ADC data low and high regs</p><p>&gt; set sfr 0xb6 0xbe	# sample internal temperature sensor</p><p>&gt; ds 0xba 0xbb		# dump the ADC data low and high regs</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO ao-dbg&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/sdcdb.1.html"><strong>sdcdb</strong>(1)</a>, <strong>ccload</strong>(1)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Keith Packard</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="ao-cal-accel.1.html"><span aria-hidden="true">&larr;</span> ao-cal-accel.1: Calibrate altos flight computer accelerometers</a></li>
   <li class="next"><a href="ao-dump-up.1.html">ao-dump-up.1: Dump flight log from micropeak flight computer <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
