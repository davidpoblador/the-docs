<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>mbuffer: Measuring buffer</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Measuring buffer">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="mbuffer (1) manual">
  <meta name="twitter:description" content="Measuring buffer">
  <meta name="twitter:image" content="https://www.carta.tech/images/mbuffer-mbuffer-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/mbuffer.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="mbuffer (1) manual" />
  <meta property="og:description" content="Measuring buffer" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/mbuffer-mbuffer-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">mbuffer<small> (1)</small></h1>
        <p class="lead">Measuring buffer</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/mbuffer.1.html">
      <span itemprop="name">mbuffer: Measuring buffer</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/mbuffer/">
      <span itemprop="name">mbuffer</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/mbuffer.1.html">
      <span itemprop="name">mbuffer: Measuring buffer</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNTAX</h2>
        <div class="sectioncontent">
<p>mbuffer [<em>options</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>mbuffer buffers I/O operations and displays the throughput rate. It is multi-threaded, supports network connections, and offers more options than the standard buffer.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-i</strong> &lt;<em>filename</em>&gt;</p>
  </dt>
  <dd>
    <p>Use <em>filename</em> as input instead of the standard input (needs to be given for multi volume support). If <em>filename</em> is -, input is read from standard input.</p>
  </dd>
  <dt>
    <p><strong>-I</strong> &lt;<em>port</em>&gt;</p>
  </dt>
  <dd>
    <p>Use network port <em>port</em> as input instead of the standard input. If given a hostname and a port in the form hostname:port, the first interface with the IP of hostname will be used.</p>
  </dd>
  <dt>
    <p><strong>-o</strong> &lt;<em>filename</em>&gt;</p>
  </dt>
  <dd>
    <p>Use <em>filename</em> as output instead of the standard output (needs to be given for multi volume support, will enable use of sendfile if available). If <em>filename</em> is -, output is written to standard output. The option -o can be passed multiple times to specify multiple outputs.</p>
  </dd>
  <dt>
    <p><strong>-O</strong> &lt;<em>hostname:port</em>&gt;</p>
  </dt>
  <dd>
    <p>Write output to <em>hostname:port</em> instead of the standard output (will enable use of sendfile if available). This option can be used multiple times to send data to multiple machines.</p>
  </dd>
  <dt>
    <p><strong>-b</strong> &lt;<em>num</em>&gt;</p>
  </dt>
  <dd>
    <p>Use <em>num</em> blocks for buffer (default 256).</p>
  </dd>
  <dt>
    <p><strong>-s</strong> &lt;<em>size</em>&gt;</p>
  </dt>
  <dd>
    <p>Use blocks of <em>size</em> bytes for buffer (default pagesize of system).</p>
  </dd>
  <dt>
    <p><strong>-m</strong> &lt;<em>size</em>&gt;</p>
  </dt>
  <dd>
    <p>Use a total of <em>size</em> bytes for buffer (default 2MB) - size can be set with a trailing character (b and B for Byte, k for kByte, M for MByte, G for Gigabyte, and with % for a percentage of total physical memory).</p>
  </dd>
  <dt>
    <p><strong>-L</strong></p>
  </dt>
  <dd>
    <p>Lock buffer in memory - this option is not available for file-based buffers and requires mbuffer to be set-UID root (use with care).</p>
  </dd>
  <dt>
    <p><strong>-n</strong> &lt;<em>num</em>&gt;</p>
  </dt>
  <dd>
    <p><em>num</em> volumes in input device (requires use of option -i for input device specification, pass 0 as argument if mbuffer should prompt for every new volume)</p>
  </dd>
  <dt>
    <p><strong>-t</strong></p>
  </dt>
  <dd>
    <p>use a memory-mapped temporary file as buffer (use with huge buffers)</p>
  </dd>
  <dt>
    <p><strong>-T</strong> &lt;<em>file</em>&gt;</p>
  </dt>
  <dd>
    <p>as -t but use <em>file</em> instead</p>
  </dd>
  <dt>
    <p><strong>-d</strong></p>
  </dt>
  <dd>
    <p>use block-size of device for output (needed for some devices, slows output down)</p>
  </dd>
  <dt>
    <p><strong>-D</strong> &lt;<em>size</em>&gt;</p>
  </dt>
  <dd>
    <p>assume an output volume of <em>size</em> bytes (default infinite) after which a volume change will be initiated. Small values are useful for the timely testing of multi-volume runs; accurate values if your device doesn't properly signal end of media. Size can be set with a trailing character (b and B for Byte, k for kByte, M for MByte, or G for Gigabyte)</p>
  </dd>
  <dt>
    <p><strong>-P</strong> &lt;<em>num</em>&gt;</p>
  </dt>
  <dd>
    <p>start writing after the buffer has been filled to <em>num</em>% (default 0 - start at once)</p>
  </dd>
  <dt>
    <p><strong>-p</strong> &lt;<em>num</em>&gt;</p>
  </dt>
  <dd>
    <p>start reading after the buffer has dropped below fill-ratio of <em>num</em>% (default 100 - start at once)</p>
  </dd>
  <dt>
    <p><strong>-l</strong> &lt;<em>file</em>&gt;</p>
  </dt>
  <dd>
    <p>log messages to <em>file</em> instead of standard error output</p>
  </dd>
  <dt>
    <p><strong>-u</strong> &lt;<em>num</em>&gt;</p>
  </dt>
  <dd>
    <p>pause <em>num</em> microseconds after each write - might increase performance on some drives with very low performance (&lt; 1 MB/sec)</p>
  </dd>
  <dt>
    <p><strong>-r</strong> &lt;<em>rate</em>&gt;</p>
  </dt>
  <dd>
    <p>Set the maximum read rate to &lt;<em>rate</em>&gt;. &lt;<em>rate</em>&gt; can be given in either Bytes, kBytes, MBytes, or GBytes per second. To do so, use an appropriate suffix (i.e. k,M,G). This option is useful if you have a tape that is capable of transferring data faster than the host can handle it. In this case you can use this option to limit the transfer rate and keep the tape running. Be aware that this is both good for your tape drive, and enhances overall performance, by avoiding tape screwing.</p>
  </dd>
  <dt>
    <p><strong>-R</strong> &lt;<em>rate</em>&gt;</p>
  </dt>
  <dd>
    <p>Same as above only for setting the transfer limit for the writer.</p>
  </dd>
  <dt>
    <p><strong>-A</strong> &lt;<em>cmd</em>&gt;</p>
  </dt>
  <dd>
    <p>the device used is an autoloader which uses <em>cmd</em> to load the next volume. Pass &lt;<em>/bin/false</em>&gt; as an autoload command to suppress the warning message that appears when run without controlling terminal (e.g. via cron). Like this the autoload will fail and mbuffer will terminate with an error message when reaching the end of the tape.</p>
  </dd>
  <dt>
    <p><strong>-a</strong> &lt;<em>time</em>&gt;</p>
  </dt>
  <dd>
    <p>the device used is an autoloader which takes <em>time</em> seconds to load a new tape</p>
  </dd>
  <dt>
    <p><strong>-f</strong></p>
  </dt>
  <dd>
    <p>overwrite output file if it exists already</p>
  </dd>
  <dt>
    <p><strong>-c</strong></p>
  </dt>
  <dd>
    <p>write with synchronous data integrity support - This option forces all writes to complete before continuing. This enables errors to be reported earlier and more precisely, but might decrease performance. Especially systems with high level of data integrity support suffer a huge performance hit. Others might seem to be unaffected, but just neglect support for full synchronous data integrity.</p>
  </dd>
  <dt>
    <p><strong>-v</strong> &lt;<em>num</em>&gt;</p>
  </dt>
  <dd>
    <p>set verbose level to <em>num</em>. Valid values are 0..6 (0 = none, 1 = errors, 2 = warnings, 4 = information messages, 5 = debugging messages, 6 = I/O debugging). Higher values include lower values messages.</p>
  </dd>
  <dt>
    <p><strong>-q</strong></p>
  </dt>
  <dd>
    <p>quiet - do not display the status on the standard error output</p>
  </dd>
  <dt>
    <p><strong>-Q</strong></p>
  </dt>
  <dd>
    <p>quiet - do not log the status in the log file</p>
  </dd>
  <dt>
    <p><strong>--direct</strong></p>
  </dt>
  <dd>
    <p>Use O_DIRECT to open file descriptors. This option is not available on all systems. It tells the OS to bypass the page cache to improve performance when reading and writing. On Solaris this is an auto-magic option that is enabled if it is supported for the relevant file. Be aware that this option might lead to read/write failures, if the buffer isn't properly aligned for direct I/O. Additionally, open might fail with EINVAL (i.e. invalid argument) if the named file does not support O_DIRECT.</p>
  </dd>
  <dt>
    <p><strong>--append</strong></p>
  </dt>
  <dd>
    <p>Open next output file given via option -o in append mode.</p>
  </dd>
  <dt>
    <p><strong>--truncate</strong></p>
  </dt>
  <dd>
    <p>Truncate next output file given via option -o when opening it.</p>
  </dd>
  <dt>
    <p><strong>-6</strong></p>
  </dt>
  <dd>
    <p>Force IPv6 mode for the following network I/O options on command line. <strong>-4</strong> Force IPv4 mode for the following network I/O options on command line. <strong>-0</strong> Choose IPv4/IPv6 mode on demand.</p>
  </dd>
  <dt>
    <p><strong>-h, --help</strong></p>
  </dt>
  <dd>
    <p>Output help information and exit.</p>
  </dd>
  <dt>
    <p><strong>-H, --md5</strong></p>
  </dt>
  <dd>
    <p>Generate a MD5 hash of transferred data.</p>
  </dd>
  <dt>
    <p><strong>-V, --version</strong></p>
  </dt>
  <dd>
    <p>Output version information and exit.</p>
  </dd>
  <dt>
    <p><strong>-W</strong> &lt;<em>timeout</em>&gt;</p>
  </dt>
  <dd>
    <p>Activates a watchdog that gets triggered every <em>timeout</em> seconds and checks weather I/O activity has stalled. If either channel has stalled for a complete period, the watchdog writes an error message and terminates mbuffer via SIGINT. Be aware that the watchdog is unaware of tape-change activities. So choose the watchdog timeout greater that the worst-case tape-change time.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DEFAULT VALUES</h2>
        <div class="sectioncontent">
<p>The default values for following options can be set as <em>key = value</em> pairs in the ~/.mbuffer.rc file:</p><p><em>blocksize</em>: block size (option -s)</p><p><em>timeout</em>: watchdog timeout (option -W)</p><p><em>totalmem</em>: total buffer size (option -m)</p><p><em>maxreadspeed</em>: maximum read speed (option -r)</p><p><em>maxwritespeed</em>: maximum write speed (option -R)</p><p><em>startwrite</em>: threshold for start writing (option -P)</p><p><em>startread</em>: threshold for start reading (option -p)</p><p><em>pause</em>: pause after writing a block (option -u)</p><p><em>numblocks</em>: number of blocks in buffer (option -b)</p><p><em>memlock</em>: lock buffer in memory (option -L)</p><p><em>showstatus</em>: print transfer status on console (option -q)</p><p><em>logstatus</em>: write transfer status to logfile (option -Q)</p><p><em>tcpbuffer</em>: TCP buffer size (option --tcpbuffer)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT VARIABLES</h2>
        <div class="sectioncontent">
<p>If TMPDIR is set, mbuffer allocates storage for file-based buffers in this directory. If TMPDIR is unset, <em>/var/tmp</em> will be used.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p><em>/usr/bin/mbuffer</em></p><p><em>/var/tmp/mbuffer-*</em></p><p><em>~/.mbuffer.rc</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>To run this program with the default options just type:</p><p>mbuffer</p><p>Using mbuffer to do a backup with tar to the default tape device. Options for this example: memory-mapped temporary file with a size of 10 Megabytes, start after 80% of the buffer have been filled.</p><p>tar cf - mydirectory | gzip | mbuffer -t -m 10M -P 80 -f -o $TAPE</p><p>Using mbuffer with 3 tapes for input and extracting the contents in the current work directory:</p><p>mbuffer -n 3 -i $TAPE | gzip -dc | tar xf -</p><p>Using mbuffer to write to multiple tape volumes:</p><p>tar cf - /usr | mbuffer -f -o $TAPE</p><p>Write to multiple tapes and erase every tape before writing:</p><p>tar cf - /usr | mbuffer -A "echo next tape; read a &lt; /dev/tty; mt erase $TAPE" -f -o $TAPE</p><p>Making a backup via network:</p><p><em>tape server: </em>mbuffer -I 8000 -f -o $TAPE</p><p><em>backup client: </em>tar zcf - /home | mbuffer -O tapeserver:8000</p><p>Distributing a directory tree to multiple machines:</p><p><em>master: </em>tar cf - /tree_to_clone | mbuffer -O clone0:8000 -O clone1:8000</p><p><em>clones: </em>mbuffer -I master:8000 | tar xf -</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXITCODE</h2>
        <div class="sectioncontent">
<p>mbuffer return 0 upon success. Any kind of failure will yield a non-zero exit code.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Thomas Maier-Komor &lt;thomas@maier-komor.de&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DONATIONS</h2>
        <div class="sectioncontent">
<p>If you like this software, and use it for production purposes in your company, please consider making a donation to support this work. You can donate directly via PayPal to the author's e-mail address (thomas@maier-komor.de).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HOMEPAGE</h2>
        <div class="sectioncontent">
<p>http://www.maier-komor.de/mbuffer.html</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE</h2>
        <div class="sectioncontent">
<p>This software is published under GNU General Public License V3. See file LICENSE for details.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO mbuffer&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/buffer.1.html"><strong>buffer</strong>(1)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="mbtserver.1.html"><span aria-hidden="true">&larr;</span> mbtserver.1: Tilburg memory based tagger server</a></li>
   <li class="next"><a href="mbuild-hybrid.1.html">mbuild-hybrid.1: Mbuild-hybrid  easily build ircd-hybrid v7 modules from source <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
