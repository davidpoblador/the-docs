<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>include_server: Conservative approximation of include dependencies for c/c++</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Conservative approximation of include dependencies for c/c++">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="include_server (1) manual">
  <meta name="twitter:description" content="Conservative approximation of include dependencies for c/c++">
  <meta name="twitter:image" content="https://www.carta.tech/images/distcc-pump-include_server-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/include_server.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="include_server (1) manual" />
  <meta property="og:description" content="Conservative approximation of include dependencies for c/c++" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/distcc-pump-include_server-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">include_server<small> (1)</small></h1>
        <p class="lead">Conservative approximation of include dependencies for c/c++</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/include_server.1.html">
      <span itemprop="name">include_server: Conservative approximation of include dependencies for c/c++</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/distcc-pump/">
      <span itemprop="name">distcc-pump</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/include_server.1.html">
      <span itemprop="name">include_server: Conservative approximation of include dependencies for c/c++</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>include_server</strong> --port <em>INCLUDE_SERVER_PORT [OPTIONS]</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>include_server.py starts an include server process.  This process answers queries from <a href="../man1/distcc.1.html"><strong>distcc</strong>(1)</a> clients about what files to include in C/C++ compilations. The include_server.py command itself terminates as soon as the include server has been spawned.</p><p>The INCLUDE_SERVER_PORT argument is the name of a socket used for all communication between distcc clients and the include server.  The <a href="../man1/distcc-pump.1.html"><strong>distcc-pump</strong>(1)</a> command is responsible for creating the socket location, for passing it to this script, and for passing it to all distcc clients via the environment variable named INCLUDE_SERVER_PORT.</p><p>The protocol used by the include server uses distcc's RPC implementation. Each distcc request consists of (1) the current directory and (2) the list of arguments of the compilation command.</p><p>If the include server is able to process the request, then it answers the distcc client by sending a list of filepaths.  The filepaths are those of the compressed source and header files found to be necessary for compilation through include analysis.  The list also comprises symbolic links and even dummy files needed for the compilation server to construct an accurate replica of the parts of the filesystem needed for compilation.  In this way, a needed header file like /path/foo.h is compressed, renamed, and stored in a temporary location, such as /dev/shm/tmpiAvfGv.include_server-9368-1/path/foo.h.lzo.  The distcc client will pass these files on to a compilation server, where they will be uncompressed and mounted temporarily.</p><p>If the include server is not able to process the request, then it returns the empty list to the distcc client.</p><p>There are two kinds of failures that relate to the include server. The include server may fail to compute the includes or fail in other ways, see section <strong>INCLUDE SERVER SYMPTOMS</strong>.  Also, the compilation on the remove server may fail due to inadequacy of the calculated include closure, but then succeed when locally retried, see section <strong>DISTCC DISCREPANCY SYMPTOMS</strong>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTION SUMMARY</h2>
        <div class="sectioncontent">
<p>The following options are understood by include_server.py.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-dPAT, --debug_pattern=PAT</strong></p>
  </dt>
  <dd>
    <p>Bit vector for turning on warnings and debugging</p>
<pre>
    1 = warnings
    2 = trace some functions
</pre>
<p> other powers of two: see include_server/basics.py.</p>
  </dd>
  <dt>
    <p><strong>-e, --email</strong></p>
  </dt>
  <dd>
    <p>Send email to 'distcc-pump-errors' or if defined, the value of enviroment variable DISTCC_EMAILLOG_WHOM_TO_BLAME, when include server gets in trouble. The default is to not send email.</p>
  </dd>
  <dt>
    <p><strong>--email_bound NUMBER</strong></p>
  </dt>
  <dd>
    <p>Maximal number of emails to send (in addition to a final email). Default: 3.</p>
  </dd>
  <dt>
    <p><strong>--no-email</strong></p>
  </dt>
  <dd>
    <p>Do not send email. This is the default.</p>
  </dd>
  <dt>
    <p><strong>--path_observation_re=RE</strong></p>
  </dt>
  <dd>
    <p>Issue warning message whenever a filename is resolved to a realpath that is matched by RE, which is a regular expression in Python syntax.  This is useful for finding out where files included actually come from. Use RE="" to find them all.  Note: warnings must be enabled with at least -d1.</p>
  </dd>
  <dt>
    <p><strong>--pid_file FILEPATH</strong></p>
  </dt>
  <dd>
    <p>The pid of the include server is written to file FILEPATH. This allows a script such a <strong>distcc-pump</strong> to tear down the include server.</p>
  </dd>
  <dt>
    <p><strong>-s, --statistics</strong></p>
  </dt>
  <dd>
    <p>Print information to stdout about include analysis.</p>
  </dd>
  <dt>
    <p><strong>--stat_reset_triggers=LIST</strong></p>
  </dt>
  <dd>
    <p>Flush stat caches when the timestamp of any filepath in LIST changes or the filepath comes in or out of existence.  LIST is a colon separated string of filepaths, possibly containing simple globs (as allowed by Python's glob module). Print a warning whenever such a change happens (if warnings are enabled). This option allows limited exceptions to distcc-pump's normal assumption that source files are not modified during the build.</p>
  </dd>
  <dt>
    <p><strong>-t, --time</strong></p>
  </dt>
  <dd>
    <p>Print elapsed, user, and system time to stderr.</p>
  </dd>
  <dt>
    <p><strong>--unsafe_absolute_includes</strong></p>
  </dt>
  <dd>
    <p>Do preprocessing on the compilation server even if includes of absolute filepaths are encountered.  Normally the include-server will fall back on local preprocessing if it detects any absolute includes.  Thus, this flag is useful for preventing such fallbacks when the absolute includes are a false alarm, either because the absolute include is discarded during preprocessing or because the absolutely included file exists on the compilation servers.</p><p>More precisely, with --unsafe_absolute_includes absolute includes are ignored for the purposes of gathering the include closure.  Using this option may lead to incorrect results because (1) the header may actually be included on the compilation server and it may not be the same as on the client, (2) the include directives of the header are not further analyzed.</p><p>The option is useful for compiling code that has such hardcoded absolute locations of header files inside conditional directives (e.g. "#ifdef") that render the includes irrelevant.  More precisely, these includes must be eliminated during preprocessing for the actual configuration. Then the question of existence of the header file is moot and the remote compilation is sound. This is often the case if such includes are meant for unusual configurations different from the actual configuration.</p>
  </dd>
  <dt>
    <p><strong>-v, --verify</strong></p>
  </dt>
  <dd>
    <p>Verify that files in CPP closure are contained in closure calculated by include processor.</p>
  </dd>
  <dt>
    <p><strong>-w, --write_include_closure</strong></p>
  </dt>
  <dd>
    <p>Write a .d_approx file which lists all the included files calculated by the include server; with -x, additionally write the included files as calculated by CPP to a .d_exact file.</p>
  </dd>
  <dt>
    <p><strong>-x, --exact_analysis</strong></p>
  </dt>
  <dd>
    <p>Use CPP instead, do not omit system headers files.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INCLUDE SERVER SYMPTOMS AND ISSUES</h2>
        <div class="sectioncontent">
<p>The most likely messages and warnings to come from the include processor are listed below.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>Preprocessing locally. Include server not covering: Couldn't determine default system include directories</strong></p>
  </dt>
  <dd>
    <p>To determine the default system header directories, the include server runs the compiler once for each language needed during its session. This message indicates that the compiler specified to distcc is not present on the client.</p>
  </dd>
  <dt>
    <p><strong>Preprocessing locally. Include server not covering: Bailing out because include server spent more than ...s user time handling request</strong></p>
  </dt>
  <dd>
    <p>In uncommon situations, the include server fails to analyze very complicated macro expressions. The distcc client will use plain distcc mode.</p>
  </dd>
  <dt>
    <p><strong>Warning: Filepath must be relative but isn't</strong></p>
  </dt>
  <dd>
    <p>The include server does not accept absolute filepaths, such as /usr/include/stdio.h, in include directives, because there is no guarantee that this header on the compilation server machine will be the same as that on the client.  The include server gives up analyzing the include closure. The distcc client cannot use pump-mode.</p><p>To overcome this problem in a not always reliable way, set the environment variable INCLUDE_SERVER_ARGS='--unsafe_absolute_includes' when invoking the distcc-pump script to pass the --unsafe_absolute_includes option to the include server.</p>
  </dd>
  <dt>
    <p><strong>Warning: Absolute filepath ... was IGNORED</strong></p>
  </dt>
  <dd>
    <p>The --unsafe_absolute_includes is in use.  This situation happens under the same circumstances as when "Filepath must be relative but isn't" is issued, but in this case the include will provide an answer to the distcc client.</p>
  </dd>
  <dt>
    <p><strong>Warning: Path '/PATH/FILE' changed/came into existence/no longer exists</strong></p>
  </dt>
  <dd>
    <p>These warnings are issued when using stat reset triggers.  Because /PATH/FILE changed, the include server clears its caches; the new version of the file (or the lack of it) renders the include analysis invalid. This message can usually be ignored; it does signify a somewhat precarious use of files by the build system.  It is recommended to fix the build system so that files are not rewritten.</p>
  </dd>
  <dt>
    <p><strong>Warning: For translation unit ..., lookup of file ... resolved to ... whose realpath is ...</strong></p>
  </dt>
  <dd>
    <p>This warning occurs with --path_observation_re when a new realpath matching a source or header file is observed.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DISTCC DISCREPANCY SYMPTOMS</h2>
        <div class="sectioncontent">
<p>The interactions between the build system, distcc, and the include server is somewhat complex. When a distcc commands receives a failing compilation from the remote server it retries the compilation locally.  This section discusses the causes of discrepancies between remote and local compilation.  These are flagged by the demotion message:</p><p><strong>__________Warning: ... pump-mode compilation(s) failed on server,</strong> <strong>but succeeded locally.</strong></p><p><strong>__________Distcc-pump was demoted to plain mode.</strong> <strong>See the Distcc Discrepancy Symptoms section in the <a href="../man1/include_server.1.html"><strong>include_server</strong>(1)</a> man</strong> <strong>page.</strong></p><p>The distcc-pump script issues this message at the end of the build. This means that for at least one distcc invocation a local compilation succeeded after the remote compilation failed. Each distcc invocation for which such a discrepancy occurred in turn also issues a message such as:</p><p><strong>Warning: remote compilation of '...' failed,</strong> <strong>retried locally and got a different result.</strong></p><p>The demotion makes subsequent distcc invocations use plain distcc mode.  Thus preprocessing will take place on the local machine for the remainder of the build.  This technique prevents very slow builds where all compilations end up on the local machine after failing remotely.</p><p>Of course, if the local compilations fails after the remote failures, then the distcc invocation exits with the non-zero status of the local compilation. The error messages printed are also those of the local compilation.</p><p>The fallback behavior for distcc-pump mode to local compilation can be disabled by setting the environment variable DISTCC_FALLBACK to 1, which makes the distcc command fail as soon as the remote compilation has failed. This setting is very useful for debugging why the remote compilation went wrong, because now the output from the server will be printed.</p><p>Next we discuss the possible causes of discrepancies.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>The user changed a source or header file during the build.</strong></p>
  </dt>
  <dd>
    <p>This yields inconsistent results of course.</p>
  </dd>
  <dt>
    <p><strong>A source or header file changed during the build.</strong></p>
  </dt>
  <dd>
    <p>The build system rewrites a file.  For Linux kernel 2.6, this happens for 'include/linux/compile.h' and 'include/asm/asm-offsets.h'. This condition is fixed by letting the include server know that it must reset its caches when a stat of any of the files changes. Practically, this is done by gathering the files in a colon-separated list and then setting the INCLUDE_SERVER_ARGS command as in:</p>
<pre>
   include_server_args="--stat_reset_triggers=include/linux/compile.h:include/asm/asm-offsets.h"
</pre>

  </dd>
  <dt>
    <p><strong>A header file is potentially included, but does not exist, and is then later included.</strong></p>
  </dt>
  <dd>
    <p>This occurs when some header foo.h includes another header file trick.h, but the trick.h file has not yet been generated and the inclusion is actually ignored because of preprocessing directives. The include server will probe for the existence of trick.h, because it overapproximates all possible ways directives actually evaluate. The file trick.h is determined not to exist. If it is later generated, and then really included, then the include server will falsely believe that the file still does not exist.  The solution to this problem is to make the build system generate trick.h before the first time any header file is included that makes a syntactic reference to trick.h</p>
  </dd>
  <dt>
    <p><strong>The include server was started with </strong><strong>--unsafe_absolute_includes</strong>.</p>
  </dt>
  <dd>
    <p>This is a problem if there are header files locally that do not exist remotely and that are actually used.  Such includes are often protected by conditional directives that evaluate so that are actually used on only specific and often uncommon platforms. If you are not compiling for such a platform, then it may be correct to use <strong>--unsafe_absolute_include</strong>.</p>
  </dd>
  <dt>
    <p><strong>The include server has calculated the wrong includes.</strong></p>
  </dt>
  <dd>
    <p>We do not know of such a situation.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT CODES</h2>
        <div class="sectioncontent">
<p>The exit code of include_server.py is usually 0. That the include server has been started properly is communicated through the existence of the pid_file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT VARIABLES</h2>
        <div class="sectioncontent">
<p><strong>DISTCC_EMAILLOG_WHOM_TO_BLAME</strong> The email address to use for include server automated emails. The default is 'distcc-pump-errors' (which is an email address that probably will not exist in your domain).</p><p>Additionally, the invocation of the compiler may use additional environment variables.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>If you think you have found a distcc bug, please see the file <em>reporting-bugs.txt</em> in the documentation directory for information on how to report it.</p><p>In distcc-pump mode, the include server is unable to handle certain very complicated computed includes as found in parts of the Boost library. The include server will time out and distcc will revert to plain mode.</p><p>Other known bugs may be documented on <em>http://code.google.com/p/distcc/</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>The include server was written by Nils Klarlund, with assistance from Fergus Henderson, Manos Renieris, and Craig Silverstein. Please report bugs to &lt;distcc@lists.samba.org&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENCE</h2>
        <div class="sectioncontent">
<p>You are free to use distcc.  distcc (including this manual) may be copied, modified or distributed only under the terms of the GNU General Public Licence version 2 or later.  distcc comes with absolutely no warrany.  A copy of the GPL is included in the file COPYING.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO include_server&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/distcc.1.html"><strong>distcc</strong>(1)</a>, <a href="../man1/distccd.1.html"><strong>distccd</strong>(1)</a>, <a href="../man1/include_server.1.html"><strong>include_server</strong>(1)</a>, and <strong>gcc</strong>(1). http://code.google.com/p/distcc/ http://ccache.samba.org/</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="include-what-you-use.1.html"><span aria-hidden="true">&larr;</span> include-what-you-use.1: Analyze #includes in c and c++ source files</a></li>
   <li class="next"><a href="includeres.1.html">includeres.1: Filter to include resources in a postscript document <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
