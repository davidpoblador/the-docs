<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>t-prot: Tofu protection - display filter for rfc 5322 messages</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Tofu protection - display filter for rfc 5322 messages">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="t-prot (1) manual">
  <meta name="twitter:description" content="Tofu protection - display filter for rfc 5322 messages">
  <meta name="twitter:image" content="https://www.carta.tech/images/t-prot-t-prot-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/t-prot.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="t-prot (1) manual" />
  <meta property="og:description" content="Tofu protection - display filter for rfc 5322 messages" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/t-prot-t-prot-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">t-prot<small> (1)</small></h1>
        <p class="lead">Tofu protection - display filter for rfc 5322 messages</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/t-prot.1.html">
      <span itemprop="name">t-prot: Tofu protection - display filter for rfc 5322 messages</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/t-prot/">
      <span itemprop="name">t-prot</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/t-prot.1.html">
      <span itemprop="name">t-prot: Tofu protection - display filter for rfc 5322 messages</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>t-prot [</strong><em>OPTIONS</em><strong>]...</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This program is a filter to improve the readability of internet messages (emails and usenet posts) by *hiding* some annoying parts, e.g. mailing list footers, signatures, and TOFU (see definition below), as well as squeezing sequences of blank lines or punctuation. The program also detects TOFU or a high quoting ratio in a message (so you may take appropriate action, e.g. when submitting messages to a mailing list or a news server).</p><p>The filter is written in Perl and relies on input to be a single message conforming to RFC 822 or its successors, RFC 2822 and RFC 5322. In messages conforming to MIME (RFCs 2045-2049) t-prot handles text/plain parts, others are not touched.</p><p>Already reformatted messages are handled well: the script was initially designed to cope with the output of the MUA mutt (which is the reason for not using standard CPAN modules for handling messages).</p><p>T-prot offers example configuration files for mutt and its fork mutt-kz, Heirloom mailx and metamail. Also coming with the t-prot package is the example S-Lang macro t-prot.sl for using t-prot from within slrn. There is a proof-of-concept filter for INN2, which you will have to adapt to the needs of the news site you host. For use with sendmail's <strong>alias</strong>(5) file, please see below (the option <strong>-p</strong> provides an example line).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>If you do not specify any options, t-prot does ... nothing. Every feature you want must be turned on explicitly. Admittedly, we have quite a number of options for t-prot. To limit confusion they are grouped into five sections: Input/Output Options, Advertisement And Mailing List Footers, Filtering Options, Detection Options, and Other Options. While the others should be quite clear, filtering and detection might deserve a word (or two).</p><p>If you want to tune the appearance of your mail from within your MUA (or news messages from within your NUA), then go for the Filtering Options section.</p><p>If you want to use t-prot to check on mails before they are submitted to mailing lists, fed to your news server, or delivered by your MDA, then have a peek at the Detection Options section. You may accept or reject/bounce messages depending on t-prot's result.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INPUT/OUTPUT OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-i</strong>=FILE</p>
  </dt>
  <dd>
    <p>Defines an input file; default is '-' i.e. STDIN.</p>
  </dd>
  <dt>
    <p><strong>-o</strong>=FILE</p>
  </dt>
  <dd>
    <p>Defines the output file; default is STDOUT.</p>
  </dd>
  <dt>
    <p><strong>--body</strong></p>
  </dt>
  <dd>
    <p>Input consists just of the message's body. There are no RFC 5322 header lines.</p><ul>
<li><p><em>NOTE</em>: This does not work with --pgp-short, and multipart messages will not be detected due to missing headers.</p></li>
</ul>
  </dd>
  <dt>
    <p><strong>--lax-security</strong></p>
  </dt>
  <dd>
    <p>Allow insecure writing method. DO NOT USE UNLESS YOU REALLY KNOW WHAT YOU ARE DOING. (This ugly workaround is needed for some early mutt versions and should NEVER be used as a default, otherwise it will probably turn into a security issue.)</p><p>You can use this option safely to enable <strong>-o</strong> /dev/null (or other files which cannot be changed with the user's privileges).</p>
  </dd>
  <dt>
    <p><strong>--max-lines</strong>=x</p>
  </dt>
  <dd>
    <p>Maximum number of lines a message may count (with headers). If the message is longer than x lines, the message will not be processed but printed unmodified. Exit status will be EX_DATAERR except when called with -Mmutt or -Mmutt-kz.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ADVERTISEMENT AND MAILING LIST FOOTERS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-a</strong></p>
  </dt>
  <dd>
    <p>"commercial signature": Hides "footers" (signatures) from commercial email providers.</p><p>This option compares the last lines of the message body with any footer file found in the directory specified with <strong>-A</strong> DIRECTORY (which is mandatory for this option). The comparison is done by perl's <strong>index()</strong> function (please try <em>perldoc -f index</em> for details).</p><p><em>NOTE</em>: This option is not needed if <strong>--ftr-ad</strong> is specified.</p>
  </dd>
  <dt>
    <p><strong>--ftr-ad</strong></p>
  </dt>
  <dd>
    <p>"enable aggressive ad footer matching": With this option enabled, t-prot makes footer detection really greedy: We assume that commercial email providers aren't even frightened to append changing texts *under* their ads which are appended to the message body. Because these texts even have changing lengths we simply detect the lines of the footer *anywhere* in the body of the message and assume that everything below belongs to the footer. (Man, if life where always that easy! ;)</p><p>With this option even GMX ads should be easy to hide -- you buy this with a slight performance hit (which is the reason this option is disabled by default), and with the possibility that sometimes the algorithm is just a little *too* greedy.</p><p><em>NOTE</em>: This requires a directory with footer files to be given with option <strong>-A</strong>=DIRECTORY<strong>.</strong></p>
  </dd>
  <dt>
    <p><strong>-A</strong>=DIRECTORY</p>
  </dt>
  <dd>
    <p>"ad footer directory": Defines the directory which contains the advertisement list footers (one footer per file) which are to be tested when removing them with options <strong>-a</strong> or <strong>--ftr-ad</strong>.</p><p>This option is also needed if you do not want signature lengths to be counted wrong or fullquotes get undetected when an ad footer is appended at the bottom of the message (especially when using <strong>-S</strong> or <strong>-t</strong>).</p>
  </dd>
  <dt>
    <p><strong>-l</strong></p>
  </dt>
  <dd>
    <p>"list signature": Hides "footers" (signatures) from mailing lists. Footer detection works like the <strong>-a</strong> option.</p><p><em>NOTE</em>: This requires a directory with footer files to be given with option <strong>-L</strong>=DIRECTORY<strong>.</strong> <strong>-l</strong> is not needed if <strong>--ftr-ml</strong> is specified.</p>
  </dd>
  <dt>
    <p><strong>--ftr-ml</strong></p>
  </dt>
  <dd>
    <p>"enable aggressive mailing list footer matching": With this option enabled t-prot makes footer detection really greedy: Should be helpful with broken list servers, or even if your email provider munges the bodies of your messages.</p><p>Works similar to --ftr-ad, just that it is intended for mailing list footers.</p><p><em>NOTE</em>: This requires a directory with footer files to be given with option <strong>-L</strong>=DIRECTORY<strong>.</strong></p>
  </dd>
  <dt>
    <p><strong>-L</strong>=DIRECTORY</p>
  </dt>
  <dd>
    <p>"list footer directory": Defines the directory which contains the mailing list footers (one footer per file) which are to be tested when removing them with the options <strong>-l</strong> or <strong>--ftr-ml</strong>.</p><p>This option is also needed if you do not want signature lengths to be counted wrong or fullquotes get undetected when a mailing list footer is appended at the bottom of the message (especially when using <strong>-S</strong> or <strong>-t</strong>).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILTER OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>--bigq</strong>[=n[,x]]</p>
  </dt>
  <dd>
    <p>"shrink big quotes": Blocks of quotes with more than n lines will be shrunk to x lines. Defaults are 30 for n and 10 for x.</p>
  </dd>
  <dt>
    <p><strong>-c</strong>[=n]</p>
  </dt>
  <dd>
    <p>"compress": Squeezes a sequence of blank lines to just n blank lines. n defaults to 2.</p>
  </dd>
  <dt>
    <p><strong>--diff</strong></p>
  </dt>
  <dd>
    <p>Tolerate unified diff (see <a href="../man1/diff.1.html"><strong>diff</strong>(1)</a> and <a href="../man1/patch.1.html"><strong>patch</strong>(1)</a>) appended after the signature (which usually makes the signature too long to be valid).</p><p>Also, protect diff standard output from hiding (which would otherwise be easy prey for <strong>-t</strong>).</p>
  </dd>
  <dt>
    <p><strong>-e</strong></p>
  </dt>
  <dd>
    <p>"ellipsis": Squeezes a sequence of four or more dots, exclamation marks, or question marks to only three dots or marks, respectively.</p>
  </dd>
  <dt>
    <p><strong>--fixind</strong></p>
  </dt>
  <dd>
    <p>Fix broken quotes to adhere to RFC 3676 by removing spaces between quote characters and adding a space after them.</p><p><em>NOTE</em>: This may produce false positives if spaces in between quote characters are intended (thus changing the quoting level, see RFC 3676 for details).</p>
  </dd>
  <dt>
    <p><strong>--groupwise</strong></p>
  </dt>
  <dd>
    <p>Hides TOFU as produced by Novell Groupwise.</p>
  </dd>
  <dt>
    <p><strong>-k</strong></p>
  </dt>
  <dd>
    <p>"anti Kammquote": Tries (not too aggressively) to fix those broken zig-zag-shaped lines wrapped around by some MUAs which are known as "Kammquoting" in German.</p><ul>
<li><p><em>NOTE</em>: This option is considered stable by now. However, sometimes Kammquotes should have been removed but weren't. Please send a bug report if this happens to you (after carefully reading the BUGS and REPORTING BUGS section of this man page, that is).</p></li><li><p>Please also note that enabling this option is quite a performance hit.</p></li>
</ul>
  </dd>
  <dt>
    <p><strong>--kdiff</strong>=n</p>
  </dt>
  <dd>
    <p>Minimum length difference between two lines for wrapped line detection on Kammquotes. For details, please see the source code.</p><p>Anyway, lower values make the algorithm more aggressive, higher values make Kammquotes harder to detect. Default is 20.</p><p>Requires <strong>-k</strong>.</p>
  </dd>
  <dt>
    <p><strong>--kmaxl</strong>=n</p>
  </dt>
  <dd>
    <p>Maximum line length for wrapped line detection on Kammquotes. For details, please see the source code.</p><p>Anyway, higher values make the algorithm more aggressive, lower values make Kammquotes harder to detect. Default is 80.</p><p>Requires <strong>-k</strong>.</p>
  </dd>
  <dt>
    <p><strong>--kminl</strong>=n</p>
  </dt>
  <dd>
    <p>Minimum line length for wrapped line detection on Kammquotes. For details, please see the source code.</p><p>Anyway, lower values make the algorithm more aggressive, higher values make Kammquotes harder to detect. Default is 65.</p><p>Requires <strong>-k</strong>.</p>
  </dd>
  <dt>
    <p><strong>--locale</strong>=LOCALE</p>
  </dt>
  <dd>
    <p>Specify which locale to use for correct parsing of your MUA's formatting of the displayed message (usually it is the locale your MUA uses). Right now this option is only used when <em>-Mmutt</em> or <em>-Mmutt-kz</em> is specified, but this may change in future. You need the Perl module <em>Locale::gettext</em> for this feature.</p><p><em>NOTE</em>: If you use <strong>mutt</strong>, <strong>mutt-kz</strong> or <strong>gnupg</strong> with locales, t-prot will only work correctly if you specify the corresponding locale string. Alternatively, you can use the environment variables <em>LC_ALL</em>, <em>LC_MESSAGES</em>, or <em>LANG</em> to specify the locale string.</p><p><em>NOTE also</em>: You also have to make sure you are running t-prot with matching <strong>gnupg</strong> and <strong>mutt</strong> / <strong>mutt-kz</strong> versions. T-prot detects <strong>gnupg</strong> and <strong>mutt</strong> / <strong>mutt-kz</strong> locales of the recent stable versions of those programs, earlier versions might not work well with a recent version of t-prot.</p>
  </dd>
  <dt>
    <p><strong>-M, --mua</strong>=MUA</p>
  </dt>
  <dd>
    <p>"mail user agent": Turn on special treatment for some mail user agents. (Right now only <strong>mutt</strong>(1) and <strong>mutt-kz</strong>(1) are supported, but more might be added in future.) <em>Caveat</em>: If your MUA is supported by this feature you must ensure t-prot makes use of it when called from within your MUA to work as desired.</p>
  </dd>
  <dt>
    <p><strong>-m</strong></p>
  </dt>
  <dd>
    <p>"Microsoft TOFU": Hides TOFU as given by some Microsoft mailers. (You all surely know these fullquotes beginning with</p><p>"----- Original Message -----"</p><p>and some header lines...)</p>
  </dd>
  <dt>
    <p><strong>--ms-smart</strong></p>
  </dt>
  <dd>
    <p>Burn CPU cycles trying to be smart with MS style TOFU: If there are PGP signed parts inside the TOFU, the text still might conceal other message parts and therefore should not be deleted.</p><p>Please note that this is probably just a waste of time because most MS Outlook users who do produce this kind of TOFU won't care about making their messages the least bit readable or even predictable. So this option will probably just be interesting for mutt message hooks (to activate it on demand when you <strong>know</strong> the sender tries to write legible messages).</p><p>Requires <strong>-Mmutt</strong> / <strong>-Mmutt-kz</strong> and <strong>-m</strong>.</p>
  </dd>
  <dt>
    <p><strong>--pgp-move</strong></p>
  </dt>
  <dd>
    <p>Move PGP and SSL verification output to bottom; requires <strong>-Mmutt</strong> / <strong>-Mmutt-kz</strong>.</p>
  </dd>
  <dt>
    <p><strong>--pgp-move-vrf</strong></p>
  </dt>
  <dd>
    <p>Move PGP and SSL verification output to bottom only if verification shows a good signature and the signature could be verified as authentic (using a trust path). If there is any problem with the signature, the PGP output should not be moved so the user is more likely to notice. Requires <strong>-Mmutt</strong> / <strong>-Mmutt-kz</strong>.</p><p><em>NOTE</em>: If gpg is terminated before finished (e.g. hitting Ctrl-C, or using <a href="../man1/kill.1.html"><strong>kill</strong>(1)</a>), we cannot always detect if the check was interrupted. Though t-prot tries to be smart, there will be false positives.</p>
  </dd>
  <dt>
    <p><strong>--pgp-short</strong></p>
  </dt>
  <dd>
    <p>Hide non-relevant PGP key uids; requires <strong>-Mmutt</strong> / <strong>-Mmutt-kz</strong>.</p>
  </dd>
  <dt>
    <p><strong>-r</strong></p>
  </dt>
  <dd>
    <p>"rip header off": Hides all mail header lines.</p>
  </dd>
  <dt>
    <p><strong>--reply</strong></p>
  </dt>
  <dd>
    <p>Subject lines with multiple reply prefixes (Re: and translations into other languages) get squeezed to only one prefix.</p>
  </dd>
  <dt>
    <p><strong>-S</strong>[=n]</p>
  </dt>
  <dd>
    <p>"suppression of overlong signatures": Signatures are to be n lines (not including the one containing dash-dash-space) or less. If there are more, it is probably not that spirited after all. So with this option you trade it for a <strong>truely</strong> nice line.</p><p>If no n is given, default is 4. (We do not recommend using a value other than 4. Consider this old-fashioned, but we actually do *like* RFC conformance.)</p><p><em>NOTE</em>: The line containing "-- " ist not counted when testing for an overlong signature, but it is included when displaying how many lines were deleted.</p>
  </dd>
  <dt>
    <p><strong>-s</strong></p>
  </dt>
  <dd>
    <p>"signature deletion": Hides signatures, i.e. all lines after a "signature dashes" line, i.e. a line with three characters: dash-dash-space (no more, no less).</p>
  </dd>
  <dt>
    <p><strong>--sani</strong></p>
  </dt>
  <dd>
    <p>Sanitize headers "To:", "From:" and "Subject:": Quoted-printable gets fixed to the corresponding chars. German Umlauts are translated to their "ae", "oe", "ue" pendants.</p><p>Useful e.g. for searching by subject within MUAs like Berkeley mailx.</p>
  </dd>
  <dt>
    <p><strong>--sigsmax</strong>[=n]</p>
  </dt>
  <dd>
    <p>"maximum number of tolerated signatures": Here you can define how many signatures you accept to be treated as such. (Most significant behaviour is when microsoft style quotes are removed. Experts please see the code for the more subtle implications of this option.)</p><p>Leave empty or specify zero to have an unlimited number of sigs. Default is 1.</p>
  </dd>
  <dt>
    <p><strong>--spass</strong></p>
  </dt>
  <dd>
    <p>"SpamAssassin workaround": SpamAssassin (available at <em>http://spamassassin.org/</em>) often is configured that it adds some lines to the message body containing information about the spam criteria which were found matching for the message. This option enables an extra test to avoid false positives for Microsoft style TOFU on such messages.</p>
  </dd>
  <dt>
    <p><strong>-t</strong></p>
  </dt>
  <dd>
    <p>"TOFU deletion": Hides "traditional style" TOFU, where each line begins with the indent string "&gt;".</p>
  </dd>
  <dt>
    <p><strong>-w</strong></p>
  </dt>
  <dd>
    <p>"whitespace deletion": Hides trailing whitespace (sequences of space and tab). CAVEAT: This may lead to interesting effects with crossposts between mailing lists or with undetected signature attempts.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DETECTION OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-P</strong>=MESSAGE</p>
  </dt>
  <dd>
    <p>"user defined bounce message for picky delivery": You may specify your own bounce message to be returned when we try to deliver an email and bounce it because there is TOFU inside. See <strong>-p</strong>.</p>
  </dd>
  <dt>
    <p><strong>-p</strong>[=ADDRESS]</p>
  </dt>
  <dd>
    <p>"picky delivery": If we really find some TOFU, abort with exit code <em>EX_UNAVAILABLE</em>. Otherwise redirect the message to ADDRESS if given.</p><p>Intended for use from within mail delivery agents (MDAs) or mail transport agents (MTAs), or even from within INN, so the message bounces if TOFU is detected, and does not get on *your* nerves. :)</p><p>As an example for usage with <strong>sendmail</strong>, put this line into your alias file and invoke <strong>newaliases</strong>:</p><p>notofu: |"/usr/local/bin/t-prot -mt -p=user@mydomain"</p><p>This will bounce messages for &lt;notofu@domainname&gt; if any TOFU is detected inside the message, and deliver it to &lt;user@mydomain&gt; otherwise. <em>Note</em> that TOFU is only detected if you specify <strong>-t</strong> respectively <strong>-m</strong>.</p><p><strong>PLEASE be careful not to bounce messages to mailing lists!</strong></p>
  </dd>
  <dt>
    <p><strong>--check</strong>[=FLAGS]</p>
  </dt>
  <dd>
    <p>Run checks. If successful, print an error message and quit with an appropriate exit code. Useful e.g. for rejecting messages from within INN2.</p><ul>
<li><p>Flags are separated by commas (no whitespaces), and can be the following (right now just one flag):</p></li><li><p><em>ratio</em>[=n]</p><p>If the quoting ratio is n or more, the message is rejected. Must be between 0 and 1, or else it is entirely disabled. Default is 0.75 (i.e., 75% of the message lines are quotes).</p></li>
</ul>
  </dd>
  <dt>
    <p><strong>-d, --debug</strong></p>
  </dt>
  <dd>
    <p>Print envelope info to syslog when bouncing TOFU contaminated email. Default syslog facility is mail.debug. Requires <strong>-p</strong>.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OTHER OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-h, --help</strong></p>
  </dt>
  <dd>
    <p>Displays a short help text with a summary on all options, and exits.</p>
  </dd>
  <dt>
    <p><strong>-v, --version</strong></p>
  </dt>
  <dd>
    <p>Prints the current version number and exits.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">
<p>The environment variables <em>LC_ALL</em>, <em>LC_MESSAGES</em>, and <em>LANG</em> are read and respected when interpreting output by mutt / mutt-kz or gnupg (unless they are overruled by the --locale option). T-prot's own output is English regardless of any locale setting.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">
<p>On program exit, t-prot uses exit codes from <em>/usr/include/sysexits.h</em> and thus behaves in a manner that sendmail and others understand when calling t-prot.</p><p>Currently, the codes used are</p>
<dl class='dl-vertical'>
  <dt>
    <p>EX_OK</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>EX_USAGE</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>EX_DATAERR</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>EX_UNAVAILABLE</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>EX_SOFTWARE</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>EX_IOERR</p>
  </dt>
  <dd>
    
  </dd>

</dl>
<p>If, however, perl fails to compile and execute t-prot, perl's normal exit codes will be returned.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TOFU?</h2>
        <div class="sectioncontent">
<p>TOFU is an abbreviation which mixes German and English words; it expands to "text oben, full-quote unten" which means "text above - full quote below" and describes the style of so many users who let their mailer or newsreader quote everything of the previous message and just add some text at the top; obviously they think that quoted text must not be changed at all. This is quite annoying as it needlessly sends a lot of data even when it is not required. Some editing of messages is desired. Please point these people to the page <em>http://www.river.com/users/share/etiquette/edit.html</em> - thank you!</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PERFORMANCE</h2>
        <div class="sectioncontent">
<p>There are several ways to fine-tune t-prot's performance:</p><p>Some command line options are quite grave a performance hit -- do not use -k and especially --ms-smart if you are content without them.</p><p>Checking for special footers is very costly as well. Put as few footer files as absolutely needed in any footer directory.</p><p>All PGP related options are eating up lots of CPU time. Try to avoid them on unsigned and unencrypted messages.</p><p>When calling t-prot from within mutt (or mutt-kz), you might use mutt's folder-hook and message-hook facilities to turn options on only when needed, e.g. to set up a different footer directory for each mailing list folder.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TROUBLESHOOTING</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>Q</em>:</p>
  </dt>
  <dd>
    <p>I want to make my mailing list footer files match more different mailing list footers. Can I use regular expressions, or how can I accomplish that?</p>
  </dd>
  <dt>
    <p><em>A</em>:</p>
  </dt>
  <dd>
    <p>Nope, regexp's do not work here. The comparison is made by the perl builtin <em>index</em>() function (see <strong>perldoc</strong> for more detailed info), so you must exactly match the beginning of the line. The longer the line you specify, the more precise the match; if your line is empty you match unconditionally.</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    <p><em>Q</em>:</p>
  </dt>
  <dd>
    <p>I use the options -l and -L to suppress mailing list footers when displaying messages in <strong>mutt</strong>(1). This does work sometimes, but sometimes it does not: the footer is not detected, and therefore full quotes are not deleted and signatures are detected as too long (which they aren't).</p>
  </dd>
  <dt>
    <p><em>A</em>:</p>
  </dt>
  <dd>
    <p>This might occur if the message is badly encoded, so mutt cannot resolve all encoded characters, e.g. if you have an encoded message on a mailing list, and majordomo appends a mailing list footer in a different encoding (or even plain us-ascii). "-- " simply does not match "--=20".</p><p>Another problem are non-us-ascii characters. Just avoid them, and everything should work fine.</p><p>See the preceding Q+A for a solution.</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    <p><em>Q</em>:</p>
  </dt>
  <dd>
    <p>I want to write a message which contains parts that should *not* be deleted even when filtered with t-prot. Is this possible?</p>
  </dd>
  <dt>
    <p><em>A</em>:</p>
  </dt>
  <dd>
    <p>Yes, but please do not spread word of it. Make unobstrusive use of the <em></em> verbatim instruction:</p><p>#v+</p><p>This line is protected from being filtered by t-prot !!!!!!!</p><p>#v-</p><p>Text coming now is not.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Written by Jochen Striepe &lt;t-prot@tolot.escape.de&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>All of the documentation and software included in the t-prot releases is copyrighted by Jochen Striepe (except when explicitly stated otherwise).</p><p>Copyright &copy; 2001-2014 Jochen Striepe. All rights reserved.</p><p>Redistribution and use, with or without modification, are permitted provided that the following conditions are met:</p><p>1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</p><p>2. All advertising materials mentioning features or use of this software must display the following acknowledgement:</p>
<pre>
  This product includes software developed by Jochen Striepe and others.
</pre>
<p>3. Neither the name of the author nor the names of any contributors may be used to endorse or promote products derived from this software without specific prior written permission.</p><p>THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">IDEAS AND INSPIRATION</h2>
        <div class="sectioncontent">
<p>Many good ideas, bug reports and support from (in alphabetical order) Bjoern Buerger, Bjoern Laessig, Christian Borss, Gerfried Fuchs, Martin Neitzel, Martin Dietze, Matthias Kilian, Ralf Doeblitz, Sven Guckes and many more (see the ChangeLog for active contributors). Many thanks to all of them!</p><p>Many thanks to Gerhard H. Wrodnigg who uses a TOFU protection script in order to keep the responses to his cancel bot reasonably short.  The entire inspiration for this hack came from the "TOFU protection" line of his script on many usenet postings.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AVAILABILITY</h2>
        <div class="sectioncontent">
<p>You can get the latest version from <em>http://www.escape.de/users/tolot/mutt/</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>There is a problem when mutt gives a PGP verified or even a multipart message to t-prot: The information where the PGP encrypted/signed data or even attachments begin and end is plainly embedded in the text, not really cleanly recognizable for t-prot. The problem should be worked around by now, please send a bug report if it does not work for you.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">
<p>Please note that t-prot development happens on <strong>current stable perl versions only</strong>. If you do run t-prot on earlier (or unstable) perl versions, you might encounter perl compiler bugs (or funny t-prot behaviour). One solution is to upgrade your perl, another is simply to write a bug report. If you do not run a current perl version, please include this information in your bug report.</p><p>Please do <em>not</em> report a bug if</p><p> * you found it in the TODO file coming with the distribution. We do know those and try to fix them as soon as possible.</p><p> * you have an old t-prot version. If you encounter a problem, first see if there is a new t-prot version which fixes the issue. If you upgraded to the latest version and it still occurs, a bug report is just great.</p><p>If you noticed a bug when processing a message and want to provide the t-prot team with some useful info, please:</p><p> * if invoking t-prot by mutt's <em>display_filter</em> facility, just set display_filter to something like</p><ul>
<li><p>"tee ~/foobar | t-prot &lt;your options&gt;"</p></li>
</ul><p>and include ~/foobar in the bug report -- this way we might reproduce the bug much easier if you are using a different environment than we do.</p><p> * provide information on what command line options you use t-prot with, what perl version t-prot runs on your system, and what else might be important to enable us reproducing the bug.</p><p>Send your bug report to <em>&lt;t-prot-bugs@tolot.escape.de&gt;</em>. Thank you.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TODO</h2>
        <div class="sectioncontent">
<p>Fix bugs (see the <em>BUGS</em> section). Beside that, all main features should be implemented by now. See the TODO file for more information.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO t-prot&hellip;</h2>
        <div class="sectioncontent">
<p><strong>mutt</strong>(1), <strong>mutt-kz</strong>(1), <strong>muttrc</strong>(5) and the part about "display_filter", <strong>perl</strong>(1), <strong>aliases</strong>(5),</p><p>RFCs 2045-2049, 3676 and 5322,</p><p><em>http://freshmeat.net/articles/t-prot/</em> (a nice, solid introduction),</p><p><em>http://got.to/quote/</em> (German language),</p><p><em>http://www.river.com/users/share/etiquette/edit.html</em> (the Learn To Edit Messages HowTo has found a new home).</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="szap.1.html"><span aria-hidden="true">&larr;</span> szap.1: A program to process channels.conf files.</a></li>
   <li class="next"><a href="t1ascii.1.html">t1ascii.1: Convert postscript type 1 font from binary to ascii <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
