<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>g_wham: Perform weighted histogram analysis after umbrella sampling</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Perform weighted histogram analysis after umbrella sampling">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="g_wham (1) manual">
  <meta name="twitter:description" content="Perform weighted histogram analysis after umbrella sampling">
  <meta name="twitter:image" content="https://www.carta.tech/images/gromacs-data-g_wham-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/g_wham.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="g_wham (1) manual" />
  <meta property="og:description" content="Perform weighted histogram analysis after umbrella sampling" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/gromacs-data-g_wham-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">g_wham<small> (1)</small></h1>
        <p class="lead">Perform weighted histogram analysis after umbrella sampling</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/g_wham.1.html">
      <span itemprop="name">g_wham: Perform weighted histogram analysis after umbrella sampling</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/gromacs-data/">
      <span itemprop="name">gromacs-data</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/g_wham.1.html">
      <span itemprop="name">g_wham: Perform weighted histogram analysis after umbrella sampling</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>gmx wham [-ix [&lt;.dat&gt;]] [-if [&lt;.dat&gt;]] [-it [&lt;.dat&gt;]] [-ip [&lt;.dat&gt;]]</p>
<pre>
         [-is [&lt;.dat&gt;]] [-o [&lt;.xvg&gt;]] [-hist [&lt;.xvg&gt;]]
         [-oiact [&lt;.xvg&gt;]] [-iiact [&lt;.dat&gt;]] [-bsres [&lt;.xvg&gt;]]
         [-bsprof [&lt;.xvg&gt;]] [-tab [&lt;.dat&gt;]] [-nice &lt;int&gt;]
         [-xvg &lt;enum&gt;] [-min &lt;real&gt;] [-max &lt;real&gt;] [-[no]auto]
         [-bins &lt;int&gt;] [-temp &lt;real&gt;] [-tol &lt;real&gt;] [-[no]v]
         [-b &lt;real&gt;] [-e &lt;real&gt;] [-dt &lt;real&gt;] [-[no]histonly]
         [-[no]boundsonly] [-[no]log] [-unit &lt;enum&gt;] [-zprof0 &lt;real&gt;]
         [-[no]cycl] [-[no]sym] [-[no]ac] [-acsig &lt;real&gt;]
         [-ac-trestart &lt;real&gt;] [-nBootstrap &lt;int&gt;]
         [-bs-method &lt;enum&gt;] [-bs-tau &lt;real&gt;] [-bs-seed &lt;int&gt;]
         [-histbs-block &lt;int&gt;] [-[no]vbs]
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>gmx wham</strong> is an analysis program that implements the Weighted Histogram Analysis Method (WHAM). It is intended to analyze output files generated by umbrella sampling simulations to compute a potential of mean force (PMF).</p><p>At present, three input modes are supported. <strong>*</strong> With option <strong>-it</strong>, the user provides a file which contains the  file names of the umbrella simulation run-input files (<strong>.tpr</strong> files),  AND, with option <strong>-ix</strong>, a file which contains file names of  the pullx <strong>mdrun</strong> output files. The <strong>.tpr</strong> and pullx files must  be in corresponding order, i.e. the first <strong>.tpr</strong> created the  first pullx, etc. <strong>*</strong> Same as the previous input mode, except that the the user  provides the pull force output file names (<strong>pullf.xvg</strong>) with option <strong>-if</strong>.  From the pull force the position in the umbrella potential is  computed. This does not work with tabulated umbrella potentials. <strong>*</strong> With option <strong>-ip</strong>, the user provides file names of (gzipped) <strong>.pdo</strong> files, i.e.  the GROMACS 3.3 umbrella output files. If you have some unusual reaction coordinate you may also generate your own <strong>.pdo</strong> files and  feed them with the <strong>-ip</strong> option into to <strong>gmx wham</strong>. The <strong>.pdo</strong> file header  must be similar to the following:</p><p><strong> UMBRELLA      3.0</strong> Component selection: 0 0 1 nSkip 1 Ref. Group 'TestAtom' Nr. of pull groups 2 Group 1 'GR1'  Umb. Pos. 5.0 Umb. Cons. 1000.0 Group 2 'GR2'  Umb. Pos. 2.0 Umb. Cons. 500.0</p><p>The number of pull groups, umbrella positions, force constants, and names may (of course) differ. Following the header, a time column and a data column for each pull group follows (i.e. the displacement with respect to the umbrella center). Up to four pull groups are possible per <strong>.pdo</strong> file at present.</p><p>By default, all pull groups found in all pullx/pullf files are used in WHAM. If only some of the pull groups should be used, a pull group selection file (option <strong>-is</strong>) can be provided. The selection file must contain one line for each tpr file in tpr-files.dat. Each of these lines must contain one digit (0 or 1) for each pull group in the tpr file. Here, 1 indicates that the pull group is used in WHAM, and 0 means it is omitted. Example: If you have three tpr files, each containing 4 pull groups, but only pull group 1 and 2 should be used, groupsel.dat looks like this: 1 1 0 0 1 1 0 0 1 1 0 0</p><p>By default, the output files are <strong>-o</strong>      PMF output file <strong>-hist</strong>   Histograms output file Always check whether the histograms sufficiently overlap.</p><p>The umbrella potential is assumed to be harmonic and the force constants are read from the <strong>.tpr</strong> or <strong>.pdo</strong> files. If a non-harmonic umbrella force was applied a tabulated potential can be provided with <strong>-tab</strong>.</p><p>WHAM OPTIONS ------------ <strong>-bins</strong>   Number of bins used in analysis <strong>-temp</strong>   Temperature in the simulations <strong>-tol</strong>    Stop iteration if profile (probability) changed less than tolerance <strong>-auto</strong>   Automatic determination of boundaries <strong>-min,-max</strong>   Boundaries of the profile The data points that are used to compute the profile can be restricted with options <strong>-b</strong>, <strong>-e</strong>, and <strong>-dt</strong>. Adjust <strong>-b</strong> to ensure sufficient equilibration in each umbrella window.</p><p>With <strong>-log</strong> (default) the profile is written in energy units, otherwise (with <strong>-nolog</strong>) as probability. The unit can be specified with <strong>-unit</strong>. With energy output, the energy in the first bin is defined to be zero. If you want the free energy at a different position to be zero, set <strong>-zprof0</strong> (useful with bootstrapping, see below).</p><p>For cyclic or periodic reaction coordinates (dihedral angle, channel PMF without osmotic gradient), the option <strong>-cycl</strong> is useful. <strong>gmx wham</strong> will make use of the periodicity of the system and generate a periodic PMF. The first and the last bin of the reaction coordinate will assumed be be neighbors.</p><p>Option <strong>-sym</strong> symmetrizes the profile around z=0 before output, which may be useful for, e.g. membranes.</p><p>AUTOCORRELATIONS ---------------- With <strong>-ac</strong>, <strong>gmx wham</strong> estimates the integrated autocorrelation time (IACT) tau for each umbrella window and weights the respective window with 1/[1+2*tau/dt]. The IACTs are written to the file defined with <strong>-oiact</strong>. In verbose mode, all autocorrelation functions (ACFs) are written to <strong>hist_autocorr.xvg</strong>. Because the IACTs can be severely underestimated in case of limited sampling, option <strong>-acsig</strong> allows one to smooth the IACTs along the reaction coordinate with a Gaussian (sigma provided with <strong>-acsig</strong>, see output in <strong>iact.xvg</strong>). Note that the IACTs are estimated by simple integration of the ACFs while the ACFs are larger 0.05. If you prefer to compute the IACTs by a more sophisticated (but possibly less robust) method such as fitting to a double exponential, you can compute the IACTs with <strong>gmx analyze</strong> and provide them to <strong>gmx wham</strong> with the file <strong>iact-in.dat</strong> (option <strong>-iiact</strong>), which should contain one line per input file (<strong>.pdo</strong> or pullx/f file) and one column per pull group in the respective file.</p><p>ERROR ANALYSIS -------------- Statistical errors may be estimated with bootstrap analysis. Use it with care, otherwise the statistical error may be substantially underestimated. More background and examples for the bootstrap technique can be found in Hub, de Groot and Van der Spoel, JCTC (2010) 6: 3713-3720. <strong>-nBootstrap</strong> defines the number of bootstraps (use, e.g., 100). Four bootstrapping methods are supported and selected with <strong>-bs-method</strong>. (1) <strong>b-hist</strong>   Default: complete histograms are considered as independent data points, and the bootstrap is carried out by assigning random weights to the histograms ("Bayesian bootstrap"). Note that each point along the reaction coordinate must be covered by multiple independent histograms (e.g. 10 histograms), otherwise the statistical error is underestimated. (2) <strong>hist</strong>    Complete histograms are considered as independent data points. For each bootstrap, N histograms are randomly chosen from the N given histograms (allowing duplication, i.e. sampling with replacement). To avoid gaps without data along the reaction coordinate blocks of histograms (<strong>-histbs-block</strong>) may be defined. In that case, the given histograms are divided into blocks and only histograms within each block are mixed. Note that the histograms within each block must be representative for all possible histograms, otherwise the statistical error is underestimated. (3) <strong>traj</strong>  The given histograms are used to generate new random trajectories, such that the generated data points are distributed according the given histograms and properly autocorrelated. The autocorrelation time (ACT) for each window must be known, so use <strong>-ac</strong> or provide the ACT with <strong>-iiact</strong>. If the ACT of all windows are identical (and known), you can also provide them with <strong>-bs-tau</strong>. Note that this method may severely underestimate the error in case of limited sampling, that is if individual histograms do not represent the complete phase space at the respective positions. (4) <strong>traj-gauss</strong>  The same as method <strong>traj</strong>, but the trajectories are not bootstrapped from the umbrella histograms but from Gaussians with the average and width of the umbrella histograms. That method yields similar error estimates like method <strong>traj</strong>.</p><p>Bootstrapping output: <strong>-bsres</strong>   Average profile and standard deviations <strong>-bsprof</strong>  All bootstrapping profiles With <strong>-vbs</strong> (verbose bootstrapping), the histograms of each bootstrap are written, and, with bootstrap method <strong>traj</strong>, the cumulative distribution functions of the histograms.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>Options to specify input and output files:</p><p><strong>-ix</strong><em> [&lt;.dat&gt;] (pullx-files.dat) (Input, Optional)</em></p>
<pre>
    Generic data file
</pre>
<p><strong>-if</strong><em> [&lt;.dat&gt;] (pullf-files.dat) (Input, Optional)</em></p>
<pre>
    Generic data file
</pre>
<p><strong>-it</strong><em> [&lt;.dat&gt;] (tpr-files.dat) (Input, Optional)</em></p>
<pre>
    Generic data file
</pre>
<p><strong>-ip</strong><em> [&lt;.dat&gt;] (pdo-files.dat) (Input, Optional)</em></p>
<pre>
    Generic data file
</pre>
<p><strong>-is</strong><em> [&lt;.dat&gt;] (groupsel.dat) (Input, Optional)</em></p>
<pre>
    Generic data file
</pre>
<p><strong>-o</strong><em> [&lt;.xvg&gt;] (profile.xvg) (Output)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-hist</strong><em> [&lt;.xvg&gt;] (histo.xvg) (Output)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-oiact</strong><em> [&lt;.xvg&gt;] (iact.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-iiact</strong><em> [&lt;.dat&gt;] (iact-in.dat) (Input, Optional)</em></p>
<pre>
    Generic data file
</pre>
<p><strong>-bsres</strong><em> [&lt;.xvg&gt;] (bsResult.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-bsprof</strong><em> [&lt;.xvg&gt;] (bsProfs.xvg) (Output, Optional)</em></p>
<pre>
    xvgr/xmgr file
</pre>
<p><strong>-tab</strong><em> [&lt;.dat&gt;] (umb-pot.dat) (Input, Optional)</em></p>
<pre>
    Generic data file
</pre>
<p>Other options:</p><p><strong>-nice</strong><em> &lt;int&gt; (19)</em></p>
<pre>
    Set the nicelevel
</pre>
<p><strong>-xvg</strong><em> &lt;enum&gt; (xmgrace)</em></p>
<pre>
    xvg plot formatting: xmgrace, xmgr, none
</pre>
<p><strong>-min</strong><em> &lt;real&gt; (0)</em></p>
<pre>
    Minimum coordinate in profile
</pre>
<p><strong>-max</strong><em> &lt;real&gt; (0)</em></p>
<pre>
    Maximum coordinate in profile
</pre>
<p><strong>-[no]auto</strong><em>  (yes)</em></p>
<pre>
    Determine min and max automatically
</pre>
<p><strong>-bins</strong><em> &lt;int&gt; (200)</em></p>
<pre>
    Number of bins in profile
</pre>
<p><strong>-temp</strong><em> &lt;real&gt; (298)</em></p>
<pre>
    Temperature
</pre>
<p><strong>-tol</strong><em> &lt;real&gt; (1e-06)</em></p>
<pre>
    Tolerance
</pre>
<p><strong>-[no]v</strong><em>  (no)</em></p>
<pre>
    Verbose mode
</pre>
<p><strong>-b</strong><em> &lt;real&gt; (50)</em></p>
<pre>
    First time to analyse (ps)
</pre>
<p><strong>-e</strong><em> &lt;real&gt; (1e+20)</em></p>
<pre>
    Last time to analyse (ps)
</pre>
<p><strong>-dt</strong><em> &lt;real&gt; (0)</em></p>
<pre>
    Analyse only every dt ps
</pre>
<p><strong>-[no]histonly</strong><em>  (no)</em></p>
<pre>
    Write histograms and exit
</pre>
<p><strong>-[no]boundsonly</strong><em>  (no)</em></p>
<pre>
    Determine min and max and exit (with <strong>-auto</strong>)
</pre>
<p><strong>-[no]log</strong><em>  (yes)</em></p>
<pre>
    Calculate the log of the profile before printing
</pre>
<p><strong>-unit</strong><em> &lt;enum&gt; (kJ)</em></p>
<pre>
    Energy unit in case of log output: kJ, kCal, kT
</pre>
<p><strong>-zprof0</strong><em> &lt;real&gt; (0)</em></p>
<pre>
    Define profile to 0.0 at this position (with <strong>-log</strong>)
</pre>
<p><strong>-[no]cycl</strong><em>  (no)</em></p>
<pre>
    Create cyclic/periodic profile. Assumes min and max are the same point.
</pre>
<p><strong>-[no]sym</strong><em>  (no)</em></p>
<pre>
    Symmetrize profile around z=0
</pre>
<p><strong>-[no]ac</strong><em>  (no)</em></p>
<pre>
    Calculate integrated autocorrelation times and use in wham
</pre>
<p><strong>-acsig</strong><em> &lt;real&gt; (0)</em></p>
<pre>
    Smooth autocorrelation times along reaction coordinate with Gaussian of this sigma
</pre>
<p><strong>-ac-trestart</strong><em> &lt;real&gt; (1)</em></p>
<pre>
    When computing autocorrelation functions, restart computing every .. (ps)
</pre>
<p><strong>-nBootstrap</strong><em> &lt;int&gt; (0)</em></p>
<pre>
    nr of bootstraps to estimate statistical uncertainty (e.g., 200)
</pre>
<p><strong>-bs-method</strong><em> &lt;enum&gt; (b-hist)</em></p>
<pre>
    Bootstrap method: b-hist, hist, traj, traj-gauss
</pre>
<p><strong>-bs-tau</strong><em> &lt;real&gt; (0)</em></p>
<pre>
    Autocorrelation time (ACT) assumed for all histograms. Use option <strong>-ac</strong> if ACT is unknown.
</pre>
<p><strong>-bs-seed</strong><em> &lt;int&gt; (-1)</em></p>
<pre>
    Seed for bootstrapping. (-1 = use time)
</pre>
<p><strong>-histbs-block</strong><em> &lt;int&gt; (8)</em></p>
<pre>
    When mixing histograms only mix within blocks of <strong>-histbs-block</strong>.
</pre>
<p><strong>-[no]vbs</strong><em>  (no)</em></p>
<pre>
    Verbose bootstrapping. Print the CDFs and a histogram file for each bootstrap.
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO g_wham&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man7/gromacs.7.html"><strong>gromacs</strong>(7)</a></strong></p><p>More information about <strong>GROMACS</strong> is available at &lt;<em>http://www.gromacs.org/</em>&gt;.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="g_view_d.1.html"><span aria-hidden="true">&larr;</span> g_view_d.1: View a trajectory on an x-windows terminal</a></li>
   <li class="next"><a href="g_wham_d.1.html">g_wham_d.1: Perform weighted histogram analysis after umbrella sampling <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
