<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>nbd-server: Serve a file as a block device to other computers    running the gnu/linux(tm) or gnu/hurd operating    system</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Serve a file as a block device to other computers    running the gnu/linux(tm) or gnu/hurd operating    system">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="nbd-server (1) manual">
  <meta name="twitter:description" content="Serve a file as a block device to other computers    running the gnu/linux(tm) or gnu/hurd operating    system">
  <meta name="twitter:image" content="https://www.carta.tech/images/nbd-server-nbd-server-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/nbd-server.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="nbd-server (1) manual" />
  <meta property="og:description" content="Serve a file as a block device to other computers    running the gnu/linux(tm) or gnu/hurd operating    system" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/nbd-server-nbd-server-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">nbd-server<small> (1)</small></h1>
        <p class="lead">Serve a file as a block device to other computers    running the gnu/linux(tm) or gnu/hurd operating    system</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/nbd-server.1.html">
      <span itemprop="name">nbd-server: Serve a file as a block device to other computers    running the gnu/linux(tm) or gnu/hurd operating    system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/nbd-server/">
      <span itemprop="name">nbd-server</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/nbd-server.1.html">
      <span itemprop="name">nbd-server: Serve a file as a block device to other computers    running the gnu/linux(tm) or gnu/hurd operating    system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>nbd-server </strong> <strong></strong><em>[ip@]port</em><strong></strong> <strong></strong><em>filename</em><strong></strong> [ <strong></strong><em>size</em><strong></strong> ] [ <strong>-r</strong> ] [ <strong>-m</strong> ] [ <strong>-c</strong> ] [ <strong>-l </strong><em>host list filename</em><strong></strong> ] [ <strong>-o </strong><em>section name</em><strong></strong> ] [ <strong>-C </strong><em>config file</em><strong></strong> ] [ <strong>-M </strong><em>max connections</em><strong></strong> ] [ <strong>-d</strong> ]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>nbd-server</strong> is the server for the Linux Network Block Device (NBD). With NBD, a client can use a file, exported over the network from a server, as a block device. It can then be used for whatever purpose a normal block device (harddisk, CD-ROM, ...) can be used for.</p><p>NBD can be useful for diskless clients that need swapspace, but you can also create a filesystem on it and use it as though it were a local filesystem.</p><p><strong>nbd-server</strong> implements some security through a file called "/etc/nbd-server/allow" (by default; a different file can be chosen with the '-l' option or through a config file specification). This file must list the IP-addresses or network masks of clients that are allowed to connect. If it does not exist, all clients are able to connect. If the file is empty, no clients can connect.</p><p>Note that while the command line allows for specifying an export, the use of this option is deprecated. It is preferred to make use of a configuration file instead, the format of which is defined in <a href="../man5/nbd-server.5.html"><strong>nbd-server</strong>(5)</a>.</p><p>While nbd-server is running, new exports can be added by re-writing configuration files and then sending SIGHUP to nbd-server. SIGHUP causes nbd-server to re-read its configuration files and to start serving all new exports which were not served earlier. Reconfiguration does not modify any existing export, it only appends new ones.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>ip</strong></p>
  </dt>
  <dd>
    <p>The ip address the server should listen on. This may be an IPv4 address, an IPv6 address, or a hostname. In the latter case, nbd-server will do a hostname lookup for the name specified, and will listen on the first address that is returned. For compatibility with past versions of nbd-server, if an IPv4 address is specified, the @ sign that serves as separator between the address and port may be replaced by a colon.</p><p>If this parameter is not specified, nbd-server will listen on all local addresses on both IPv4 and IPv6. To limit to IPv4, specify the address as 0.0.0.0; to limit to IPv6, specify it as ::.</p>
  </dd>
  <dt>
    <p><strong>port </strong></p>
  </dt>
  <dd>
    <p>The port the server should listen to. A valid port is any number between 1 and 65536; if 0 is used, nbd-server will listen on stdin (so that nbd-server can be ran from inetd)</p>
  </dd>
  <dt>
    <p><strong>filename</strong></p>
  </dt>
  <dd>
    <p>The filename of the file that should be exported. This can be any file, including "real" blockdevices (i.e. a file from /dev). If the filename includes the literal string "%s", then this %s will be substituded with the IP-address of the client trying to connect.</p>
  </dd>
  <dt>
    <p><strong>size</strong></p>
  </dt>
  <dd>
    <p>The size of the block device at the client side. This is especially useful in conjunction with the -m option</p><p>Can optionally be followed by one of K,k,M or m, in which case the size will be multiplied by 1024 (K or k) or 1048576 (M or m)</p>
  </dd>
  <dt>
    <p><strong>-r</strong></p>
  </dt>
  <dd>
    <p>Export the file read-only. If a client tries to write to a read-only exported file, it will receive an error, but the connection will stay up.</p>
  </dd>
  <dt>
    <p><strong>-m</strong></p>
  </dt>
  <dd>
    <p>Work with multiple files. This can be used to export blockdevices that are larger than the maximum allowed filesize on a given filesystem; i.e. when the filesystem does not allow files larger than 2GB (which is true for Linux 2.2 and below), you can use this option to store the data in multiple files and export a larger filesystem, if needed.</p><p>To use this option, you must create a number of files with names in the format "name.X", where "name" is given as the filename argument to nbd-server, and "X" is a number starting by 0 and going up for each file.</p><p>Allowing more flexibility for this option is planned for future versions.</p>
  </dd>
  <dt>
    <p><strong>-c</strong></p>
  </dt>
  <dd>
    <p>Copy on write. When this option is provided, write-operations are not done to the exported file, but to a separate file. This separate file is removed when the connection is closed, which means that serving this way will make nbd-server slow down (especially on large block devices with lots of writes), and that after disconnecting and reconnecting the client or the server, all changes are lost.</p>
  </dd>
  <dt>
    <p><strong>-C</strong></p>
  </dt>
  <dd>
    <p>Specify configuration file. The default configuration file, if this parameter is not specified, is <em>/etc/nbd-server/config</em>.</p><p>Note that the configuration file is always parsed and the entries in the file used, even if an extra server is specified on the command line. To disable the configuration file entirely, either move it away or use the -C option to point <a href="../man1/nbd-server.1.html"><strong>nbd-server</strong>(1)</a> to a non-existing or empty configuration file.</p><p>Also note that if an empty, incomplete, or invalid configuration file is specified, nbd-server will produce a warning about failure to parse the config file. If the command line contains a fully specified configuration, this warning is harmless and may be ignored.</p>
  </dd>
  <dt>
    <p><strong>-M</strong></p>
  </dt>
  <dd>
    <p>Specify the maximum number of opened connections. If this parameter is not specified, no limit is set.</p>
  </dd>
  <dt>
    <p><strong>-d</strong></p>
  </dt>
  <dd>
    <p>Do not fork. Useful for debugging.</p>
  </dd>
  <dt>
    <p><strong>host list filename</strong></p>
  </dt>
  <dd>
    <p>This argument should contain a list of IP-addresses for hosts that may connect to the server. Wildcards are <strong>not</strong> allowed. If the file does not exist, it is ignored (and any host can connect); If the file does exist, but is empty, no host can connect. By default, the name 'nbd_server.allow' is used, and looked for in the current directory, unless nbd-server is compiled as a daemon, in which case it is looked for in the root-directory.</p>
  </dd>
  <dt>
    <p><strong>section name</strong></p>
  </dt>
  <dd>
    <p>If the <strong>-o</strong> argument is given on the command line, then nbd-server will output a configuration file section with this as the header that is functionally equivalent to the other options specified on the command line, and exit. This is useful for migrating pre-2.9 nbd-server initscript configuration files to the new format.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Some examples of nbd-server usage:</p>
<dl class='dl-vertical'>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>To export a file /export/nbd/exp-bl-dev on port 2000:</p><p><strong>nbd-server 2000 /export/nbd/exp-bl-dev</strong></p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>To export a the same file read-only:</p><p><strong>nbd-server 2000 /export/nbd/exp-bl-dev -r</strong></p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>To export the same file read-write, but make sure changes are lost after restarting the client or the server:</p><p><strong>nbd-server 2000 /export/nbd/exp-bl-dev</strong> -c</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO nbd-server&hellip;</h2>
        <div class="sectioncontent">
<p>nbd-client (8), nbd-server (5), nbd-trdump (8)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>The NBD kernel module and the NBD tools were originally written by Pavel Machek (pavel@ucw.cz)</p><p>The Linux kernel module is now maintained by Paul Clements (Paul.Clements@steeleye.com), while the userland tools are maintained by Wouter Verhelst (&lt;wouter@debian.org&gt;)</p><p>On The Hurd there is a regular translator available to perform the client side of the protocol, and the use of <strong>nbd-client</strong> is not required. Please see the relevant documentation for more information.</p><p>This manual page was written by Wouter Verhelst (&lt;wouter@debian.org&gt;) for the Debian GNU/Linux system (but may be used by others).  Permission is granted to copy, distribute and/or modify this document under the terms of the GNU General Public License, version 2, as published by the Free Software Foundation.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="nbd-proxy.1.html"><span aria-hidden="true">&larr;</span> nbd-proxy.1: A proxy for reliable nbd mounts</a></li>
   <li class="next"><a href="nbd-trdump.1.html">nbd-trdump.1: Translate an nbd transaction log into human readable form <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
