<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>cpipe: Copy stdin to stdout while counting bytes and reporting progress</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Copy stdin to stdout while counting bytes and reporting progress">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="cpipe (1) manual">
  <meta name="twitter:description" content="Copy stdin to stdout while counting bytes and reporting progress">
  <meta name="twitter:image" content="https://www.carta.tech/images/cpipe-cpipe-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/cpipe.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="cpipe (1) manual" />
  <meta property="og:description" content="Copy stdin to stdout while counting bytes and reporting progress" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/cpipe-cpipe-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">cpipe<small> (1)</small></h1>
        <p class="lead">Copy stdin to stdout while counting bytes and reporting progress</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/cpipe.1.html">
      <span itemprop="name">cpipe: Copy stdin to stdout while counting bytes and reporting progress</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/cpipe/">
      <span itemprop="name">cpipe</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/cpipe.1.html">
      <span itemprop="name">cpipe: Copy stdin to stdout while counting bytes and reporting progress</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>cpipe</strong> [-b bsize] [-vt] [-vr] [-vw] [-ngr] [-s speed]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    -b
  </dt>
  <dd>
    <p>buffer size in kB,</p><p>1 Int value between 1 and oo.</p><p>Default: `128'</p>
  </dd>
  <dt>
    -vt
  </dt>
  <dd>
    <p>show throughput.</p>
  </dd>
  <dt>
    -vr
  </dt>
  <dd>
    <p>show read-times.</p>
  </dd>
  <dt>
    -vw
  </dt>
  <dd>
    <p>show write-times.</p>
  </dd>
  <dt>
    -ngr
  </dt>
  <dd>
    <p>non-greedy read. Don't enforce a full buffer on read before starting to write.</p>
  </dd>
  <dt>
    -s
  </dt>
  <dd>
    <p>throughput speed limit in kB/s,</p><p>1 Double value between 1 and oo.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>Cpipe</strong> copies its standard input to its standard output while measuring the time it takes to read an input buffer and write an output buffer. If one or more of the <strong>-v</strong><em>x</em> options is given, statistics of average throughput and the total amount of bytes copied are printed to the standard error output.</p><h3>Non Greedy Read</h3>
<p>Normally, cpipe does its best to totally fill its buffer (option <strong>-b</strong>) before it starts writing. In some situations however, e.g. if you talk to an interactive program via cpipe, this deadlocks the communication: said program waits for input which it will never see, because the input is stuck in cpipe's buffer. But cpipe itself will not see more input before the program does not respond.</p><p>To get around this, try using <strong>-ngr</strong>. When issuing a read call, cpipe is then satisfied as soon as it gets at least one byte. Instead of filling the buffer, it stops reading and writes whatever it got to the output. Note, however, that the throughput measurements will be less exact if the number of bytes transferred in one read/write pair becomes small, because cpipe will spent relatively more time working on every byte.</p>
<h3>Limiting Throughput</h3>
<p>If a throughput limit is specified with option <strong>-s</strong>, <strong>cpipe</strong> calls <a href="../man3/usleep.3.html"><strong>usleep</strong>(3)</a> in between copying buffers, thereby artificially extending the duration of a read/write-cycle. Since on most systems there is a certain minimum time usleep() sleeps, e.g. 0.01s, it is impossible to reach high limits with a small buffer size. In this case increasing the buffer size (option <strong>-b</strong>) might help. However, keep in mind that this limits the throughput only on the average. Every single buffer is copied as fast as possible.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>The command</p>
<pre>
  tar cCf / - usr | cpipe -vr -vw -vt &gt; /dev/null
</pre>
<p>results in an output like</p>
<pre>
  ...
    in:  19.541ms at    6.4MB/s (   4.7MB/s avg)    2.0MB
   out:   0.004ms at   30.5GB/s (  27.1GB/s avg)    2.0MB
  thru:  19.865ms at    6.3MB/s (   4.6MB/s avg)    2.0MB
  ...
</pre>
<p>The <em>first column</em> shows the times it takes to handle one buffer of data (128kB by default). The read-call took 19.541ms, the write-call to /dev/null took just 0.004ms and from the start of the read to the end of write, it took 19.865ms.</p><p>The <em>second column</em> shows the result of dividing the buffer size (128kB by default) by the times in the first column.</p><p>The <em>third column</em> contains the average over all measured values from the start of the program.</p><p>Finally, the <em>last column</em> shows the total number of bytes transferred, which is of course the same for reading and writing.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>This program uses precious processor cycles. Consequently the measured times will be different from the transfer rates possible without it.</p><p>Instead of just non-greedy reading, full non-blocking I/O and use of <a href="../man2/select.2.html"><strong>select</strong>(2)</a> should be used to make sure that no deadlocks occur when communicating with interactive programs.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CREDITS</h2>
        <div class="sectioncontent">
<p>Peter Astrand &lt;astrand@lysator.liu.se&gt; recommended the speed limit.</p><p>Ivo De Decker &lt;ivo@zeus.rug.ac.be&gt; asked for deadlock prevention, which is (hopefully) sufficiently covered by the non-greedy read.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Bug reports, beer and postcards go to <em>pifpafpuf@gmx.de</em>. New versions will show up on</p><p><em>http://cpipe.berlios.de/</em>.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="cpio.1.html"><span aria-hidden="true">&larr;</span> cpio.1: Copy files to and from archives</a></li>
   <li class="next"><a href="cplay.1.html">cplay.1: A front-end for various audio players <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
