<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>fdrawcmd: None</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="None">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="fdrawcmd (1) manual">
  <meta name="twitter:description" content="None">
  <meta name="twitter:image" content="https://www.carta.tech/images/fdutils-fdrawcmd-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/fdrawcmd.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="fdrawcmd (1) manual" />
  <meta property="og:description" content="None" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/fdutils-fdrawcmd-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">fdrawcmd<small> (1)</small></h1>
        <p class="lead">None</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/fdrawcmd.1.html">
      <span itemprop="name">fdrawcmd: None</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/fdutils/">
      <span itemprop="name">fdutils</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/fdrawcmd.1.html">
      <span itemprop="name">fdrawcmd: None</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">Name</h2>
        <div class="sectioncontent">
<p>fdrawcmd - send raw commands to the floppy disk controller</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Note</h2>
        <div class="sectioncontent">
<p>This manpage has been automatically generated from fdutils's texinfo documentation.  However, this process is only approximative, and some items, such as cross-references, footnotes and indices are lost in this translation process.  Indeed, these items have no appropriate representation in the manpage format.  Moreover, only the items specific to each command have been translated, and the general information about fdutils has been dropped in the manpage version.  Thus I strongly advise you to use the original texinfo doc.</p>
<dl class='dl-vertical'>
  <dt>
    <p>* &nbsp; To generate a printable copy from the texinfo doc, run the following</p>
  </dt>
  <dd>
    <p>commands:</p>
<pre>
    ./configure; make dvi; dvips fdutils.dvi
</pre>

  </dd>
  <dt>
    <p>* &nbsp; To generate a HTML copy,  run:</p>
  </dt>
  <dd>
    
<pre>
    ./configure; make html
</pre>
<p>A pre-made HTML can be found at: \(ifhttp://www.tux.org/pub/knaff/fdutils\(is</p>
  </dd>
  <dt>
    <p>* &nbsp; To generate an info copy (browsable using emacs' info mode), run:</p>
  </dt>
  <dd>
    
<pre>
    ./configure; make info
</pre>

  </dd>

</dl>
<p>The texinfo doc looks most pretty when printed or as HTML.  Indeed, in the info version certain examples are difficult to read due to the quoting conventions used in info.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Description</h2>
        <div class="sectioncontent">

<pre>
fdrawcmd [drive=<em>drive</em>] [rate=<em>rate</em>]
[length=<em>length</em>] [repeat=<em>repeat</em>]
[cylinder=<em>physical-cyl</em>] <em>command</em> [<em>parameters</em> ...] [<em>mode</em>]
</pre>
<p>fdrawcmd is used to send raw commands to the floppy disk controller, after having selected a given drive. You must have write permission to the selected drive.</p><p>When writing to a disk, data is read from stdin; when reading, data is printed to stdout.  Diagnostic messages, return values from the controller, and the value of the disk change line after the command are printed to stderr.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Options</h2>
        <div class="sectioncontent">
<p>All numbers may be given in octal (0211), decimal (137), or hexadecimal (0x89).</p><ul>
<li></li>
</ul>
<dl class='dl-vertical'>
  <dt>
    <p>drive=<em>drive</em> Selects the drive.  The default is drive 0 (\(if/dev/fd0\(is).</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>rate=<em>rate</em> Selects the data transfer rate. Use 0 for high density disks, 1 for</p>
  </dt>
  <dd>
    <p>double density 5 1/4 disks (or 2 Mbps tapes, if the appropriate rate table is selected), and 2 for double density 3 1/2 disks.</p>
  </dd>
  <dt>
    <p>length=<em>length</em> Describes the length of the transferred data for commands reading from</p>
  </dt>
  <dd>
    <p>and writing to the disk.  The default is to continue until end of file.</p>
  </dd>
  <dt>
    <p>repeat=<em>count</em> Repeat the command <em>count</em> times.  This only works correctly for</p>
  </dt>
  <dd>
    <p>commands which don't do any data transfer.</p>
  </dd>
  <dt>
    <p>cylinder=<em>count</em> Seek to the given cylinder before executing the command</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><em>command</em> The name of the command to send.  <em>command</em> may be a spelled out</p>
  </dt>
  <dd>
    <p>name (like read or write), or a number representing the commands floppy disk controller opcode.  A named command has already a mode associated with it, whereas for a number the mode parameter should be described using the mode option.</p><ul>
<li></li>
</ul>
  </dd>
  <dt>
    <p><em>parameters</em> The parameters for the command (optional, not all commands need</p>
  </dt>
  <dd>
    <p>parameters).</p>
  </dd>
  <dt>
    <p><em>mode</em> Various flags or'ed together describing the properties of the command.</p>
  </dt>
  <dd>
    
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Commands</h2>
        <div class="sectioncontent">
<p>The description of the various floppy commands given in this manpage is very sketchy. For more details get the 82078 spec sheet which can be found at:</p>
<pre>
http://www-techdoc.intel.com/docs/periph/fd_contr/datasheets/
</pre>
<p>Look for the chapter COMMAND SET/DESCRIPTIONS.  Older FDCs only support a subset of the commands described therein, but the syntax for the commands that do exist is the same.</p><h3>Commands&nbsp;available&nbsp;on&nbsp;all&nbsp;FDCs</h3>
<ul>
<li></li>
</ul>
<dl class='dl-vertical'>
  <dt>
    <p>read&nbsp;<em>drvsel&nbsp;cyl&nbsp;head&nbsp;sect&nbsp;szcod&nbsp;spt&nbsp;rw-gap&nbsp;szcod2</em> Reads <em>length</em> bytes of data from the disk.  <em>drvsel</em> is the</p>
  </dt>
  <dd>
    <p>drive selector. Bit 0 and 1 describe the drive, and bit 2 describes the head.  The remaining parameters give the cylinder, head (yes, again), sector, size of the sector (128 * 2 ^ <em>szcod</em>), sectors per track (spt, this is used to switch to the second head when the first side has been read), and size of the read-write gap. <em>szcod2</em> should be 0xff.  read returns <em>ST0 ST1 ST2</em> and <em>cyl head sect</em> szcod of the next sector to be read; see \(if/usr/include/linux/fdreg.h\(is .</p><ul>
<li><p>N.B. Certain newer floppy disk controllers are buggy, and do not correctly recognize the end of transfer when operating in virtual DMA mode.  For these, you need to set spt to the id of the last sector to be read (for example, if you intend to read sectors 2, 3, 4, set spt to 4, even if the disk has more sectors), and set the no-mt flag.</p></li>
</ul>
  </dd>
  <dt>
    <p>write&nbsp;<em>drvsel&nbsp;cyl&nbsp;head&nbsp;sect&nbsp;szcod&nbsp;spt&nbsp;rw-gap&nbsp;szcod2</em> Analogous to</p>
  </dt>
  <dd>
    <p>read.</p>
  </dd>
  <dt>
    <p>sense&nbsp;<em>drvsel</em> Returns the third status byte (<em>ST3</em>)</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>recalibrate&nbsp;<em>drvsel</em> Recalibrates the drive and returns <em>ST0 ST1</em>.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>seek&nbsp;<em>drvsel&nbsp;cyl</em> Moves the head to <em>cyl</em> and returns <em>ST0 ST1</em>.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>specify&nbsp;<em>drvsel&nbsp;spec1&nbsp;spec2</em> Specify various parameters to the drive.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>format&nbsp;<em>drvsel&nbsp;szcod&nbsp;sect-per-track&nbsp;fmt-gap&nbsp;fmt-fill</em> Formats the cylinder. The new sectors are filled with <em>fmt-fill</em>.</p>
  </dt>
  <dd>
    <p>The header information comes from the input, which is made up of <em>cyl head sect szcod</em> quadruples. The <em>szcod</em> parameter from the command line is used to describe the actual size of the sectors, and the <em>szcod</em> from the input is used to write into the header. However, the first write to these sectors will use the header information, and might overwrite the following sectors if the <em>szcod</em> parameter from the command line was too small.</p>
  </dd>
  <dt>
    <p>readid&nbsp;<em>drvsel</em> reads the first sector header that comes and returns</p>
  </dt>
  <dd>
    <p><em>ST0 ST1 ST2 </em> and <em>cyl head sect szcod </em> of the encountered header.</p>
  </dd>

</dl>

<h3>Commands&nbsp;available&nbsp;on&nbsp;82072&nbsp;and&nbsp;later</h3>

<dl class='dl-vertical'>
  <dt>
    <p>dumpregs Prints the contents of the FDCs registers, if supported.</p>
  </dt>
  <dd>
    
  </dd>

</dl>

<h3>Commands&nbsp;available&nbsp;on&nbsp;82072A&nbsp;and&nbsp;later</h3>

<dl class='dl-vertical'>
  <dt>
    <p>configure&nbsp;<em>conf1&nbsp;conf2&nbsp;conf3</em> Configures FIFO operation.</p>
  </dt>
  <dd>
    
  </dd>

</dl>

<h3>Commands&nbsp;available&nbsp;on&nbsp;82077&nbsp;and&nbsp;later</h3>

<dl class='dl-vertical'>
  <dt>
    <p>version Echoes 0x90 if the FDC is more recent than 82072A, and 0x80 otherwise</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>perpendicular&nbsp;<em>rate</em> Sets the perpendicular mode.  Use 0 for normal, 2 for 500kb/s</p>
  </dt>
  <dd>
    <p>perpendicular, and 3 for 1 Mb/s perpendicular.</p>
  </dd>
  <dt>
    <p>seek_out&nbsp;<em>drvsel&nbsp;n</em> does a relative seek of</p>
  </dt>
  <dd>
    <p><em>n</em> cylinders towards cylinder 0.</p>
  </dd>
  <dt>
    <p>seek_in&nbsp;&nbsp;<em>drvsel&nbsp;n</em> does a relative seek of <em>n</em> cylinders away from cylinder 0.</p>
  </dt>
  <dd>
    
  </dd>

</dl>

<h3>Commands&nbsp;available&nbsp;on&nbsp;82077AA&nbsp;and&nbsp;later</h3>

<dl class='dl-vertical'>
  <dt>
    <p>lock Locks the FIFO configuration, so that it survives a FDC software reset.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>unlock Unlock the FIFO configuration</p>
  </dt>
  <dd>
    
  </dd>

</dl>

<h3>Commands&nbsp;available&nbsp;on&nbsp;82078</h3>

<dl class='dl-vertical'>
  <dt>
    <p>partid echoes a byte describing the type of the FDC in the 3 high bits, and</p>
  </dt>
  <dd>
    <p>the stepping in the three low bits.</p>
  </dd>
  <dt>
    <p>powerdown&nbsp;<em>powerconf</em> configures automatic power down of the FDC. The old configuration is echoed</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>option&nbsp;<em>iso</em> enables/disables ISO formats. Odd values of</p>
  </dt>
  <dd>
    <p><em>iso</em> enable these formats, whereas even values disable them. ISO formats don't have index headers, and thus allow to fit slightly more data on a disk.</p>
  </dd>
  <dt>
    <p>save prints out 16 internal registers of the FDC.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>restore&nbsp;<em>r1&nbsp;r2&nbsp;r3&nbsp;...&nbsp;r16</em> restores the 16 internal registers of the FDC.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>format_n_write&nbsp;<em>drvsel&nbsp;szcod&nbsp;sect-per-track&nbsp;fmt-gap&nbsp;fmt-fill</em> formats the cylinder and writes initial data to it. The input data is</p>
  </dt>
  <dd>
    <p>made up of a sequence of headers (4 bytes) and data: <em>header1 data1 header2 data2 ... headern datan</em></p>
  </dd>
  <dt>
    <p>drivespec&nbsp;<em>dspec1&nbsp;dspec2&nbsp;...&nbsp;specn&nbsp;terminator</em> chooses rate tables for various drives. Each dspec byte describes one</p>
  </dt>
  <dd>
    <p>drive. Bits 0 and 1 say which drive is described. Bits 2 and 3 describe the rate table. Only tables 0 and 2 are interesting. Both tables only differ in the meaning of rate 1. For table 0 (the default) rate 0 is 300 kb/s (used for 5 1/4 DD disks), whereas for table 1 it is 2 Mbps (used for fast floppy tape drives). Bit 4 is the precompensation table select bit. It should be set to 0. Bit 5-7 should be zero as well. The <em>terminator</em> byte ends the drivespec command. It is either 0xc0 or 0x80. If it is 0xc0, no result phase follows; if it is 0x80, the current data rate table configuration for the four drives is echoed.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Modes</h2>
        <div class="sectioncontent">
<p>The mode option is only needed when you describe the command as a numerical value. Some mode names are also valid command names. They are considered as command name if the command name has not yet been given, and as mode name otherwise.</p><p> If you give a command name followed by explicit modes, both the implicit flags of the command name, and the explicit modes are or'ed together.</p><p> If on the other hand you give a command name preceded by explicit modes, only the explicit modes are or'ed together.</p>
<dl class='dl-vertical'>
  <dt>
    <p>read Read data from disk using DMA.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>write Write data to the disk.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>intr Wait for an interrupt.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>spin wait for the disk to spin up</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>disk Aborts the operation if no disk is in the drive. This only works if you</p>
  </dt>
  <dd>
    <p>also chose a physical cylinder to seek to.</p>
  </dd>
  <dt>
    <p>no-motor Don't switch on the drive motor while issuing the command</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>no-motor-after Switch off the motor immediately after the command returns.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>fm Uses the FM version of the read, readid, write and</p>
  </dt>
  <dd>
    <p>format commands.</p>
  </dd>
  <dt>
    <p>no-mt Do not use MT (multitrack) mode for the read, readid and</p>
  </dt>
  <dd>
    <p>write commands. This is needed on certain broken FDC's which don't recognize end of transfer when running in nodma mode. In order to use these safely, set no-mt, and chose the id of the last sector to be read as sect-per-track.</p>
  </dd>

</dl>
<p>fdrawcmd opens the device node with the NDELAY flag. This means that the driver should not try to autodetect the disk type (it might not be formatted), and that it should not reset the FDC. If a reset was needed, the command simply fails. If that happens, execute floppycontrol --resetnow 0 , and try again.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">See Also</h2>
        <div class="sectioncontent">
<p>Fdutils' texinfo doc</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="fdp.1.html"><span aria-hidden="true">&larr;</span> fdp.1: Filter for drawing directed graphs  neato - filter for drawing undirected graphs  twopi - filter for radial layouts of graphs  circo - filter for circular layout of graphs  fdp - filter for drawing undirected graphs  sfdp - filter for drawing large undirected graphs  patchwork - filter for tree maps</a></li>
   <li class="next"><a href="fdsh.1.html">fdsh.1: Simple shell for fdclone <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
