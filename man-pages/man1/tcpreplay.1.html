<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>tcpreplay: Replay network traffic stored in pcap files</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Replay network traffic stored in pcap files">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="tcpreplay (1) manual">
  <meta name="twitter:description" content="Replay network traffic stored in pcap files">
  <meta name="twitter:image" content="https://www.carta.tech/images/tcpreplay-tcpreplay-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/tcpreplay.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="tcpreplay (1) manual" />
  <meta property="og:description" content="Replay network traffic stored in pcap files" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/tcpreplay-tcpreplay-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">tcpreplay<small> (1)</small></h1>
        <p class="lead">Replay network traffic stored in pcap files</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/tcpreplay.1.html">
      <span itemprop="name">tcpreplay: Replay network traffic stored in pcap files</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/tcpreplay/">
      <span itemprop="name">tcpreplay</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/tcpreplay.1.html">
      <span itemprop="name">tcpreplay: Replay network traffic stored in pcap files</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>tcpreplay</strong> [<strong>-</strong><em>flag</em><strong></strong> [<em>value</em>]]... [<strong>--</strong><em>opt-name</em><strong></strong> [[=| ]<em>value</em>]]...</p><p>&lt;pcap_file(s)&gt;</p><p>tcpreplay is a tool for replaying network traffic from files saved with tcpdump or other tools which write <strong>pcap</strong>(3) files.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This manual page briefly documents the <strong>tcpreplay</strong> command. The basic operation of tcpreplay is to resend  all  packets  from  the input file(s) at the speed at which they were recorded, or a specified data rate, up to as fast as the hardware is capable.</p><p>Optionally, the traffic can be split between two interfaces, written to files, filtered and edited in various ways, providing the means to test firewalls, NIDS and other network devices.</p><p>For more details, please see the Tcpreplay Manual at: http://tcpreplay.synfin.net/trac/wiki/manual</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-d</strong> <em>number</em>, <strong>--dbug</strong>=<strong></strong><em>number</em><strong></strong></p>
  </dt>
  <dd>
    <p>Enable debugging output. This option may appear up to 1 times. This option takes an integer number as its argument. The value of <em>number</em> is constrained to being:</p>
<pre>
in the range  0 through 5
</pre>
<p>The default <em>number</em> for this option is:  0</p><p>If configured with --enable-debug, then you can specify a verbosity level for debugging output.  Higher numbers increase verbosity.</p>
  </dd>
  <dt>
    <p><strong>-q</strong>, <strong>--quiet</strong></p>
  </dt>
  <dd>
    <p>Quiet mode.</p><p>Print nothing except the statistics at the end of the run</p>
  </dd>
  <dt>
    <p><strong>-T</strong> <em>string</em>, <strong>--timer</strong>=<strong></strong><em>string</em><strong></strong></p>
  </dt>
  <dd>
    <p>Select packet timing mode: select, ioport, rdtsc, gtod, nano, abstime. This option may appear up to 1 times. The default <em>string</em> for this option is:  gtod</p><p>Allows you to select the packet timing method to use:</p><p><em>nano</em> - Use nanosleep() API</p><p><em>select</em> - Use select() API</p><p><em>ioport</em> - Write to the i386 IO Port 0x80</p><p><em>rdtsc</em> - Use the x86/x86_64/PPC RDTSC</p><p><em>gtod [default]</em> - Use a gettimeofday() loop</p><p><em>abstime</em> - Use OS X's AbsoluteTime API</p>
  </dd>
  <dt>
    <p><strong>--sleep-accel</strong>=<em>number</em></p>
  </dt>
  <dd>
    <p>Reduce the amount of time to sleep by specified usec. This option takes an integer number as its argument. The default <em>number</em> for this option is:  0</p><p>Reduce the amount of time we would normally sleep between two packets by the specified number of usec.  This provides a "fuzz factor" to compensate for running on a non-RTOS and other processes using CPU time.  Default is disabled.</p>
  </dd>
  <dt>
    <p><strong>--rdtsc-clicks</strong>=<em>number</em></p>
  </dt>
  <dd>
    <p>Specify the RDTSC clicks/usec. This option may appear up to 1 times. This option takes an integer number as its argument. The default <em>number</em> for this option is:  0</p><p>Override the calculated number of RDTSC clicks/usec which is often the speed of the CPU in Mhz.  Only useful if you specified <strong>--timer=rdtsc</strong></p>
  </dd>
  <dt>
    <p><strong>-v</strong>, <strong>--verbose</strong></p>
  </dt>
  <dd>
    <p>Print decoded packets via tcpdump to STDOUT. This option may appear up to 1 times.</p>
  </dd>
  <dt>
    <p><strong>-A</strong> <em>string</em>, <strong>--decode</strong>=<strong></strong><em>string</em><strong></strong></p>
  </dt>
  <dd>
    <p>Arguments passed to tcpdump decoder. This option may appear up to 1 times. This option must appear in combination with the following options: verbose.</p><p>When enabling verbose mode (<strong>-v</strong>) you may also specify one or more additional  arguments to pass to <strong>tcpdump</strong> to modify the way packets are decoded.  By default, -n and -l are used.   Be  sure  to quote the arguments like: -A "-axxx" so that they are not interpreted by tcpreplay.   Please see the <strong>tcpdump</strong>(1) man page for a complete list of options.</p>
  </dd>
  <dt>
    <p><strong>-K</strong>, <strong>--enable-file-cache</strong></p>
  </dt>
  <dd>
    <p>Enable caching of packets to internal memory. This option must appear in combination with the following options: loop.</p><p>Cache pcap file(s) the first time they are cached in RAM so that subsequent loops don't incurr any disk I/O latency in order to increase performance.  Make sure you have enough free RAM to store the entire pcap file(s) in memory or the system will swap and performance will suffer.</p>
  </dd>
  <dt>
    <p><strong>--preload-pcap</strong></p>
  </dt>
  <dd>
    <p>Preloads packets into RAM before sending.</p><p>This option loads the specified pcap(s) into RAM before starting to send in order to improve replay performance while introducing a startup performance hit. Preloading can be used with or without <strong>--loop</strong> and implies <strong>--enable-file-cache</strong>.</p>
  </dd>
  <dt>
    <p><strong>-c</strong> <em>string</em>, <strong>--cachefile</strong>=<strong></strong><em>string</em><strong></strong></p>
  </dt>
  <dd>
    <p>Split traffic via a tcpprep cache file. This option may appear up to 1 times.</p>
  </dd>
  <dt>
    <p><strong>-i</strong> <em>string</em>, <strong>--intf1</strong>=<strong></strong><em>string</em><strong></strong></p>
  </dt>
  <dd>
    <p>Server/primary traffic output interface. This option may appear up to 1 times.</p>
  </dd>
  <dt>
    <p><strong>-I</strong> <em>string</em>, <strong>--intf2</strong>=<strong></strong><em>string</em><strong></strong></p>
  </dt>
  <dd>
    <p>Client/secondary traffic output interface. This option may appear up to 1 times. This option must appear in combination with the following options: cachefile.</p>
  </dd>
  <dt>
    <p><strong>--listnics</strong></p>
  </dt>
  <dd>
    <p>List available network interfaces and exit.</p>
  </dd>
  <dt>
    <p><strong>-l</strong> <em>number</em>, <strong>--loop</strong>=<strong></strong><em>number</em><strong></strong></p>
  </dt>
  <dd>
    <p>Loop through the capture file X times. This option may appear up to 1 times. This option takes an integer number as its argument. The value of <em>number</em> is constrained to being:</p>
<pre>
greater than or equal to 0
</pre>
<p>The default <em>number</em> for this option is:  1</p>
  </dd>
  <dt>
    <p><strong>--pktlen</strong></p>
  </dt>
  <dd>
    <p>Override the snaplen and use the actual packet len. This option may appear up to 1 times.</p><p>By default, tcpreplay will send packets based on the size of the "snaplen" stored in the pcap file which is usually the correct thing to do.  However, occasionally, tools will store more bytes then told to.  By specifying this option, tcpreplay will ignore the snaplen field and instead try to send packets based on the original packet length.  Bad things may happen if you specify this option.</p>
  </dd>
  <dt>
    <p><strong>-L</strong> <em>number</em>, <strong>--limit</strong>=<strong></strong><em>number</em><strong></strong></p>
  </dt>
  <dd>
    <p>Limit the number of packets to send. This option may appear up to 1 times. This option takes an integer number as its argument. The value of <em>number</em> is constrained to being:</p>
<pre>
greater than or equal to 1
</pre>
<p>The default <em>number</em> for this option is:  -1</p><p>By default, tcpreplay will send all the packets.  Alternatively, you can specify a maximum number of packets to send.</p>
  </dd>
  <dt>
    <p><strong>-x</strong> <em>string</em>, <strong>--multiplier</strong>=<strong></strong><em>string</em><strong></strong></p>
  </dt>
  <dd>
    <p>Modify replay speed to a given multiple. This option may appear up to 1 times. This option must not appear in combination with any of the following options: pps, mbps, oneatatime, topspeed.</p><p>Specify a floating point value to modify the packet replay speed. Examples:</p>
<pre>
        2.0 will replay traffic at twice the speed captured
        0.7 will replay traffic at 70% the speed captured
</pre>

  </dd>
  <dt>
    <p><strong>-p</strong> <em>number</em>, <strong>--pps</strong>=<strong></strong><em>number</em><strong></strong></p>
  </dt>
  <dd>
    <p>Replay packets at a given packets/sec. This option may appear up to 1 times. This option must not appear in combination with any of the following options: multiplier, mbps, oneatatime, topspeed. This option takes an integer number as its argument.</p>
  </dd>
  <dt>
    <p><strong>-M</strong> <em>string</em>, <strong>--mbps</strong>=<strong></strong><em>string</em><strong></strong></p>
  </dt>
  <dd>
    <p>Replay packets at a given Mbps. This option may appear up to 1 times. This option must not appear in combination with any of the following options: multiplier, pps, oneatatime, topspeed.</p><p>Specify a floating point value for the Mbps rate that tcpreplay should send packets at.</p>
  </dd>
  <dt>
    <p><strong>-t</strong>, <strong>--topspeed</strong></p>
  </dt>
  <dd>
    <p>Replay packets as fast as possible. This option must not appear in combination with any of the following options: mbps, multiplier, pps, oneatatime.</p>
  </dd>
  <dt>
    <p><strong>-o</strong>, <strong>--oneatatime</strong></p>
  </dt>
  <dd>
    <p>Replay one packet at a time for each user input. This option must not appear in combination with any of the following options: mbps, pps, multiplier, topspeed.</p><p>Allows you to step through one or more packets at a time.</p>
  </dd>
  <dt>
    <p><strong>--pps-multi</strong>=<em>number</em></p>
  </dt>
  <dd>
    <p>Number of packets to send for each time interval. This option must appear in combination with the following options: pps. This option takes an integer number as its argument. The value of <em>number</em> is constrained to being:</p>
<pre>
greater than or equal to 1
</pre>
<p>The default <em>number</em> for this option is:  1</p><p>When trying to send packets at very high rates, the time between each packet can be so short that it is impossible to accurately sleep for the required period of time.  This option allows you to send multiple packets at a time, thus allowing for longer sleep times which can be more accurately implemented.</p>
  </dd>
  <dt>
    <p><strong>-P</strong>, <strong>--pid</strong></p>
  </dt>
  <dd>
    <p>Print the PID of tcpreplay at startup.</p>
  </dd>
  <dt>
    <p><strong>--stats</strong>=<em>number</em></p>
  </dt>
  <dd>
    <p>Print statistics every X seconds. This option takes an integer number as its argument. The value of <em>number</em> is constrained to being:</p>
<pre>
greater than or equal to 1
</pre>
<p>Note that this is very much a "best effort" and long delays between sending packets may cause equally long delays between printing statistics.</p>
  </dd>
  <dt>
    <p><strong>-V</strong>, <strong>--version</strong></p>
  </dt>
  <dd>
    <p>Print version information.</p>
  </dd>
  <dt>
    <p><strong>-h</strong>, <strong>--less-help</strong></p>
  </dt>
  <dd>
    <p>Display less usage information and exit.</p>
  </dd>
  <dt>
    <p><strong>-H</strong>,<strong> --help</strong></p>
  </dt>
  <dd>
    <p>Display usage information and exit.</p>
  </dd>
  <dt>
    <p><strong>-!</strong>,<strong> --more-help</strong></p>
  </dt>
  <dd>
    <p>Extended usage information passed thru pager.</p>
  </dd>
  <dt>
    <p><strong>-</strong> [<em>rcfile</em>],<strong> --save-opts</strong>[=<em>rcfile</em>]</p>
  </dt>
  <dd>
    <p>Save the option state to <em>rcfile</em>.  The default is the <em>last</em> configuration file listed in the <strong>OPTION PRESETS</strong> section, below.</p>
  </dd>
  <dt>
    <p><strong>-</strong> <em>rcfile</em>,<strong> --load-opts</strong>=<em>rcfile</em>,<strong> --no-load-opts</strong></p>
  </dt>
  <dd>
    <p>Load options from <em>rcfile</em>. The <em>no-load-opts</em> form will disable the loading of earlier RC/INI files.  <em>--no-load-opts</em> is handled early, out of order.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTION PRESETS</h2>
        <div class="sectioncontent">
<p>Any option that is not marked as <em>not presettable</em> may be preset by loading values from configuration ("RC" or ".INI") file(s). The <em>homerc</em> file is "<em>$$/</em>", unless that is a directory. In that case, the file "<em>.tcpreplayrc</em>" is searched for within that directory.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SIGNALS</h2>
        <div class="sectioncontent">
<p>tcpreplay understands the following signals:</p><p><em></em><strong>SIGUSR1</strong><em></em> Suspend tcpreplay</p><p><em></em><strong>SIGCONT</strong><em></em> Restart tcpreplay</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO tcpreplay&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/tcpreplay-edit.1.html"><strong>tcpreplay-edit</strong>(1)</a>, <strong>tcpdump</strong>(1), <a href="../man1/tcpprep.1.html"><strong>tcpprep</strong>(1)</a>, <a href="../man1/tcprewrite.1.html"><strong>tcprewrite</strong>(1)</a>, <strong>libnet</strong>(3)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>tcpreplay can only send packets as fast as your computer's interface, processor, disk and system bus will allow.</p><p>Packet timing at high speeds is a black art and very OS/CPU dependent.</p><p>Replaying captured traffic may simulate odd or broken conditions on your network and cause all sorts of problems.</p><p>In most cases, you can not replay traffic back to/at a server.</p><p>Some operating systems by default do not allow for forging source MAC addresses.  Please consult your operating system's documentation and the tcpreplay FAQ if you experience this issue.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Copyright 2000-2010 Aaron Turner</p><p>For support please use the tcpreplay-users@lists.sourceforge.net mailing list.</p><p>The latest version of this software is always available from: http://tcpreplay.synfin.net/</p><p>Released under the Free BSD License.</p><p>This manual page was <em>AutoGen</em>-erated from the <strong>tcpreplay</strong> option definitions.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="tcpreen.1.html"><span aria-hidden="true">&larr;</span> tcpreen.1: Tcp stream monitoring tool</a></li>
   <li class="next"><a href="tcpreplay-edit.1.html">tcpreplay-edit.1: Replay network traffic stored in pcap files <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
