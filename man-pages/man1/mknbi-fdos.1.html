<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>mknbi-fdos: Make network bootable image</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Make network bootable image">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="mknbi-fdos (1) manual">
  <meta name="twitter:description" content="Make network bootable image">
  <meta name="twitter:image" content="https://www.carta.tech/images/mknbi-mknbi-fdos-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/mknbi-fdos.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="mknbi-fdos (1) manual" />
  <meta property="og:description" content="Make network bootable image" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/mknbi-mknbi-fdos-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">mknbi-fdos<small> (1)</small></h1>
        <p class="lead">Make network bootable image</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/mknbi-fdos.1.html">
      <span itemprop="name">mknbi-fdos: Make network bootable image</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/mknbi/">
      <span itemprop="name">mknbi</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/mknbi-fdos.1.html">
      <span itemprop="name">mknbi-fdos: Make network bootable image</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>mknbi</strong> --version</p><p><strong>mknbi</strong> --format=<em>format</em> --target=<em>target</em> [--output=<em>outputfile</em>] <em>target-specific-arguments</em></p><p><strong>mkelf-linux</strong> [--output=<em>outputfile</em>] <em>kernelimage</em> [<em>ramdisk</em>]</p><p><strong>mknbi-linux</strong> [--output=<em>outputfile</em>] <em>kernelimage</em> [<em>ramdisk</em>]</p><p><strong>mknbi-rom</strong> [--output=<em>outputfile</em>] <em>.z?rom-file</em></p><p><strong>mkelf-img</strong> [--output=<em>outputfile</em>] <em>.z?img-file</em></p><p><strong>mkelf-menu</strong> [--output=<em>outputfile</em>] [<em>dataimage</em>]</p><p><strong>mknbi-menu</strong> [--output=<em>outputfile</em>] [<em>dataimage</em>]</p><p><strong>mkelf-nfl</strong> [--output=<em>outputfile</em>] [<em>dataimage</em>]</p><p><strong>mknbi-nfl</strong> [--output=<em>outputfile</em>] [<em>dataimage</em>]</p><p><strong>mkelf-lua</strong> [--output=<em>outputfile</em>] <em>luabin</em></p><p><strong>mknbi-fdos</strong> [--output=<em>outputfile</em>] <em>kernel.sys floppyimage</em></p><p><strong>mknbi-dos</strong> [--output=<em>outputfile</em>] <em>floppyimage</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>mknbi</strong> is a program that makes network bootable images for various operating systems suitable for network loading by Etherboot or Netboot, which are \s-1ROM\s0 boot loaders.  If you are looking to boot using \s-1PXE\s0, look no further, mknbi is not what you want. You probably want something like \s-1PXELINUX\s0 which is part of the \s-1SYSLINUX\s0 package.</p><p><strong>mknbi</strong> --version prints the current version. Use this before reporting problems.</p><p><strong>mknbi</strong> can be invoked with the <strong>--format</strong> and <strong>--target</strong> options or links can be made to it under format and target specific names. E.g. mkelf-linux is the same as mknbi --format=elf --target=linux.</p><p><strong>--format</strong>=<em>format</em> Specify the format of the output. Currently available are nbi and elf.  \s-1ELF\s0 format only works with linux and menu. Otherwise the invocation is the same as for mknbi. In discussions below, the mknbi form is used.</p><p><strong>--target</strong>=<em>target</em> Specify the target binary. Currently available are linux, menu, rom, fdos and dos. <strong>mknbi</strong> is not needed for booting FreeBSD.</p><p><strong>--output=</strong><em>outputfile</em> Specify the output file, can be used with all variants.  Stdout is the default.</p><p>The package must be installed in the destination location before the executables can be run, because it looks for library files.</p><p>Each of the variants will be described separately.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MKELF-LINUX</h2>
        <div class="sectioncontent">
<p><strong>mkelf-linux</strong> and <strong>mknbi-linux</strong> makes a boot image from a Linux kernel image, either a zImage or a bzImage.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MKELF-LINUX OPTIONS</h2>
        <div class="sectioncontent">
<p><strong>--param=</strong><em>string</em> Replace the default parameter string with the specified one. This option overrides all the following options so you should know what you are doing.</p><p><strong>--append</strong>=<em>string</em> Appends the specified string to the existing parameter string. This option operates after the other parameter options have been evaluated.</p><p><strong>--rootdir</strong>=<em>rootdir</em> Define name of directory to mount via \s-1NFS\s0 from the boot server.</p><p>In the absence of this option, the default is to use the directory \*(C`/tftpboot/\*(C'<em></em><strong>%s</strong><em></em>, with the <em></em><strong>%s</strong><em></em> representing the hostname or IP-address of the booting system, depending on whether the hostname attribute is present in the \s-1BOOTP/DHCP\s0 reply.</p><p>If \*(C`rom\*(C' is given, and if the \s-1BOOTP/DHCP\s0 server is able to handle the \s-1RFC\s0 1497 extensions, the value of the rootpath option is used as the root directory.</p><p>If the name given to the option starts with \*(C`/dev/\*(C', the corresponding device is used as the root device, and no \s-1NFS\s0 directory will be mounted.</p><p><strong>--rootmode</strong>=\*(C`ro|rw\*(C' Defines whether the root device will be mounted read-only or read-write respectively. Without this parameter, the default is \*(C`rw\*(C'.</p><p><strong>--ip=</strong><em>string</em> Define client and server \s-1IP\s0 addresses.</p><p>In the absence of this option no \s-1IP\s0 addresses are defined, and the kernel will determine the \s-1IP\s0 addresses by itself, usually by using \s-1DHCP\s0, \s-1BOOTP\s0 or \s-1RARP\s0.  Note that the kernel's query is <em>in addition to</em> the query made by the bootrom, and requires the \s-1IP:\s0 kernel level autoconfiguration (\s-1CONFIG_IP_PNP\s0) feature to be included in the kernel.</p><p>Important note: In Linux kernels 2.2.x where x &gt;= 18, and 2.4.x where x &gt;= 5, it is <strong>necessary</strong> to specify one of the enabling options in the next paragraph to cause the \s-1IP\s0 autoconfiguration to be activated. Unlike in previous kernels, \s-1IP\s0 autoconfiguration does not happen by default. Also note that \s-1IP\s0 autoconfiguration and NFSroot are likely to go away in Linux 2.6 and that userspace \s-1IP\s0 configuration methods using ramdisk and userspace \s-1DHCP\s0 daemons are preferred now.</p><p>If one of the following: \*(C`off, none, on, any, dhcp, bootp, rarp, both\*(C', is given, then the option will be passed unmodified to the kernel and cause that autoconfig option to be chosen.</p><p>If \*(C`rom\*(C' is given as the argument to this option, all necessary \s-1IP\s0 addresses for \s-1NFS\s0 root mounting will be inherited from the \s-1BOOTP/DHCP\s0 answer the bootrom got from the server.</p><p>It's also possible to define the addresses during compilation of the boot image. Then, all addresses must be separated by a colon, and ordered in the following way:</p><p>\*(C`--ip=\*(C'<em>client:server:gateway:netmask:hostname[:dev[:proto]]</em></p><p>Using this option <strong>mkelf-linux</strong> will automatically convert system names into decimal \s-1IP\s0 addresses for the first three entries in this string. The <strong>hostname</strong> entry will be used by the kernel to set the host name of the booted Linux diskless client.  When more than one network interface is installed in the diskless client, it is possible to specify the name of the interface to use for mounting the root directory via \s-1NFS\s0 by giving the optional value \*(C`dev\*(C'.  This entry has to start with the string \*(C`eth\*(C' followed by a number from 0 to 9. However, if only one interface is installed in the client, this <em>dev</em> entry including the preceding semicolon can be left out. The <em>proto</em> argument is one of the \s-1IP\s0 autoconfiguration enabling options listed above.  (Author: it's not clear to me what the \s-1IP\s0 autoconfiguration does when the parameters are already specified.  Perhaps it's to obtain parameters not specified, e.g. \s-1NIS\s0 domain.)</p><p><strong>--rdbase=</strong><em>top|asis|0xNNNNNNNN</em> Set the ramdisk load address.  \*(C`top\*(C' moves the ramdisk to the top of memory before jumping to the kernel. This is the default if rdbase is not specified.  This option requires that first-linux's kernel sizing work correctly.  \*(C`asis\*(C' loads it at 0x100000 (1MB) if the kernel is loaded low; or leaves it just after the kernel in memory, if the kernel is loaded high. For this option to work, the kernel must be able to handle ramdisks at these addresses. <em>0xNNNNNNNN</em> moves the ramdisk to the hex address specified. The onus is on the user to specify a suitable address that is acceptable to the kernel and doesn't overlap with any other segments. Etherboot will round address down to multiple of 4k (last 3 digits to zero).</p><p><strong>--rdnopad</strong> By default, etherboot pads (with nulls) the given initrd of any size to multiple of 4k bytes (aligning to memory page boundary). Use this option to disable padding if it causes problem.</p><p><strong>--first32=</strong><em>program</em> Override the default first stage setup program.  It can be used to call extensions to the Etherboot code, which paves the way for additional useful functionality without enlarging the size of the Etherboot footprint.  --first32 is implied by the \s-1ELF\s0 format.</p><p><strong>--progreturns</strong> This option is used in conjunction with and only valid with the --first32 option to indicate to the Etherboot loader that the called program will return to loader and hence Etherboot should not disable the network device as is the case when the program will never return to Etherboot.</p><p><strong>--relocseg=</strong><em>segaddr</em> This option is used to specify a relocation of the Linux first, boot, setup, and parameter segments to another 64k band.  Currently the only valid values are 0x9000 and 0x8000, corresponding to linear addresses of 0x90000 and 0x80000 upwards. The default is 0x9000.  Usually you use this option if you have relocated Etherboot to 0x84000 to avoid other code in the 0x90000 segment like \s-1DOC\s0. The Linux kernel must support relocation which implies a 2.4 kernel or later. --relocseg only works reliably with \s-1ELF\s0 or --first32=.</p><p><strong>mem=</strong><em>memsize</em> This is not a command line option but a kernel parameter that is intercepted by the first32 stage and used as the top of memory, to match Linux's interpretation. <em>memsize</em> can be suffixed by \*(C`G\*(C' to indicate gibibytes (times 2^30), \*(C`M\*(C' to indicate mebibytes (times 2^20) or \*(C`K\*(C' to indicate kibibytes (times 2^10). Note that the suffixes are uppercase. This kernel parameter can be specified in --append= or option-129 of the \s-1DHCP/BOOTP\s0 record.</p><p>Run the program thus:</p><p>mkelf-linux <em>kernel-image</em> [<em>ramdisk-image</em>] &gt; linux.nb</p><p>Then move <em>linux.nb</em> to where the network booting process expects to find it.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MKELF-LINUX BOOTP/DHCP VENDOR TAGS</h2>
        <div class="sectioncontent">
<p><strong>mkelf-linux</strong> includes a startup code at the beginning of the Linux kernel which is able to detect certain \s-1DHCP\s0 vendor defined options. These can be used to modify the kernel loading process at runtime. To use these options with \s-1ISC\s0 \s-1DHCPD\s0 v3, a popular \s-1DHCP\s0 daemon, the syntax is as below. You will need to adjust the syntax for other \s-1DHCP\s0 or \s-1BOOTP\s0 daemons.</p><p>option etherboot-signature code 128 = string;</p><p>option kernel-parameters code 129 = text;</p><p>...</p>
<pre>
                option etherboot-signature E4:45:74:68:00:00;

                option kernel-parameters "INITRD_DBG=6 NIC=3c509";
</pre>
<p>Option 128 is required to be the six byte signature above. See the vendortags appendix of the Etherboot user manual for details.</p><p>The following option is presently supported by <strong>mkelf-linux</strong>:</p><p><strong>129</strong> The <em>string</em> value given with this option is appended verbatim to the end of the kernel command line.  It can be used to specify arguments like I/O addresses or \s-1DMA\s0 channels required for special hardware like \s-1SCSI\s0 adapters, network cards etc. Please consult the Linux kernel documentation about the syntax required by those options. It is the same as the <strong>--append</strong> command line option to <strong>mkelf-linux</strong>, but works at boot time instead of image build time.</p><p><strong>130</strong> With this option it is possible to the select the network adapter used for mounting root via \s-1NFS\s0 on a multihomed diskless client. The syntax for the <em>string</em> value is the same as for the \*(C`dev\*(C' entry used with the <strong>--ip=</strong> option as described above. However note that the <strong>mkelf-linux</strong> runtime setup routine does not check the syntax of the string.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MKNBI-ROM</h2>
        <div class="sectioncontent">
<p><strong>mknbi-rom</strong> makes a boot image from an Etherboot \*(C`.rom\*(C' or \*(C`.zrom\*(C' boot \s-1ROM\s0 image.  This allows it to be netbooted using an existing \s-1ROM\s0. This is useful for developing Etherboot drivers or to load a newer version of Etherboot with an older one.</p><p>Run mknbi-rom like this:</p><p>mknbi-rom nic.zrom &gt; nic.nb</p><p>Move <em>nic.nb</em> to where the network booting process expects to find it. The boot \s-1ROM\s0 will load this as the <em>operating system</em> and execute the \s-1ROM\s0 image.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MKELF-IMG</h2>
        <div class="sectioncontent">
<p><strong>mkelf-img</strong> makes a boot image from an Etherboot \*(C`.img\*(C' or \*(C`.zimg\*(C' image.  This allows it to be netbooted using an existing \s-1ROM\s0. This is useful for developing Etherboot drivers or to load a newer version of Etherboot with an older one.</p><p>Run mkelf-img like this:</p><p>mkelf-img nic.zimg &gt; nic.nb</p><p>Move <em>nic.nb</em> to where the network booting process expects to find it. The boot \s-1ROM\s0 will load this as the <em>operating system</em> and execute the image.</p><p>Note that this does not test the \s-1ROM\s0 loader portion that's in a \*(C`.z?rom\*(C' image, but not in a \*(C`.z?img\*(C'.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MKELF-MENU</h2>
        <div class="sectioncontent">
<p><strong>mkelf-menu</strong> and <strong>mknbi-menu</strong> make a boot image from an auxiliary menu program. Etherboot has the ability to load an auxiliary program which can interact with the user, modify the \s-1DHCP\s0 structure, and return a status.  Based on the status, Etherboot can load another binary, restart or exit.  This makes it possible to have elaborate user interface programs without having to modify Etherboot. The specification for auxiliary program is documented in the Etherboot Developer's Manual.</p><p><strong>mkelf-menu</strong> and <strong>mknbi-menu</strong> take a binary named \*(C`menu\*(C' from the library directory, which is assumed to have an entry point of 0x60000. An optional argument is accepted, and this is loaded at 0x80000. This can be a data file used by the menu program.</p><p>Currently, the menu binary provided duplicates the builtin menu facility of Etherboot with the exception of a couple of small differences: no server or gateway specifications are used and nested \s-1TFTP\s0 loads don't work. You should not have \s-1MOTD\s0 or \s-1IMAGE_MENU\s0 defined in your Etherboot build to be able to use this external menu binary. The specifications of the \s-1DHCP\s0 option required is in the vendortags document in the Etherboot user manual.</p><p>Typical usage is like this:</p><p>mkelf-menu &gt; menu.nb</p><p>Then put menu.nb in the \s-1TFTP\s0 boot directory and edit your \s-1DHCP\s0 options according to the documentation.</p><p>Alternate user interface programs are highly encouraged.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MKELF-NFL</h2>
        <div class="sectioncontent">
<p><strong>mkelf-nfl</strong> and <strong>mknbi-nfl</strong> make a boot image from the \s-1NFL\s0 menu program. This menu program takes the names of images from a menu-text-file file which just contains lines with the filenames (relative to the tftpd root directory) of images to load. The user-interface is a light-bar, similar to that used in \s-1GRUB\s0.  There is a sample menu-text-file in \*(C`menu-nfl.eg\*(C'. The special entry \*(L"Quit Etherboot\*(R" (without quotes, of course) can be used in menu-text-files as an entry that causes Etherboot to quit and return to the invoking environment, which is the \s-1BIOS\s0 in the case of ROMs.</p><p>Typical usage is:</p><p>mkelf-nfl <em>menu-text-file</em> &gt; nfl.nb</p><p>Then put nfl.nb in the \s-1TFTP\s0 boot directory and specify as the boot image. Chaining to other menus works.</p><p>Enhancements to the menu format accepted to specify other features such as titles, timeout, colours, and so forth are highly encouraged.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MKELF-LUA</h2>
        <div class="sectioncontent">
<p><strong>mkelf-lua</strong> makes an \s-1ELF\s0 image from a precompiled Lua (\*(C`http://www.tecgraf.puc-rio.br/lua/\*(C') program.</p><p>Typical usage is:</p><p>mkelf-lua hello.lb &gt; luaprog.nb</p><p>where \*(C`hello.lb\*(C' was generated from a Lua program by:</p><p>luac -o hello.lb hello.lua</p><p>The functions available to Lua programs in this environment is described in a separate document.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MKNBI-FDOS</h2>
        <div class="sectioncontent">
<p><strong>mknbi-fdos</strong> makes a boot image from a FreeDOS kernel file and a floppy image.  Note that the kernel image is not read from the floppy section of the boot image, but is a separate section in the boot image. The bootloader has been adjusted to jump to it directly. This means the space that would be taken up on the <em>floppy</em> by the kernel image file can now be used for applications and data.</p><p>Obtain a distribution of FreeDOS with a recent kernel, probably at least 2006. It has been tested with 2012 but nothing older. You can get the FreeDOS kernel here:</p><p>\*(C`http://freedos.sourceforge.net/\*(C'</p><p>Follow the instructions to make a bootable floppy. Then get an image of the floppy with:</p><p>dd if=/dev/fd0 of=/tmp/floppyimage</p><p>Also extract <em>kernel.sys</em> from the floppy. You can do this from the image using the mtools package, by specifying a file as a <em>drive</em> with a declaration like this in <em>~/.mtoolsrc</em>:</p><p>drive x: file=\*(L"/tmp/floppyimage\*(R"</p><p>Then run:</p><p>mcopy x:kernel.sys .</p><p>Then run mknbi by:</p><p>mknbi-fdos kernel.sys /tmp/floppyimage &gt; freedos.nb</p><p>where <em>kernel.sys</em> and <em>/tmp/floppyimage</em> are the files extracted above. Then move <em>freedos.nb</em> to where the network booting process expects to find it.</p><p>If you have got it to netboot successfully, then you can go back and add your files to the floppy image. You can delete <em>kernel.sys</em> in the floppy image to save space, that is not needed. Note that you can create a floppy image of any size you desire with the mformat program from mtools, you are not restricted to the actual size of the boot floppy.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MKNBI-FDOS OPTIONS</h2>
        <div class="sectioncontent">
<p><strong>--harddisk</strong> Make the boot ramdisk the first hard disk, i.e. C:. One reason you might want to do this is because you want to use the real floppy. The limit on \*(L"disk size\*(R" in the boot image is not raised by this option so that is not a reason to use this option. This option is incompatible with --disableharddisk.</p><p><strong>--disableharddisk</strong> When the ramdisk is simulating a floppy disk drive, this switch will disable hard disk accesses.  This is necessary if the client should use a network file system as drive C:, which is only possible if there are no hard disks found by \s-1DOS\s0. This option is incompatible with --harddisk.</p><p><strong>--nosquash</strong> Do not try to chop unused sectors from the end of the floppy image. This increases the boot image size and hence loading time if the \s-1FAT\s0 filesystem on the floppy is mostly empty but you may wish to use this option if you have doubts as to whether the squashing algorithm is working correctly.</p><p><strong>--rdbase=</strong><em>0xNNNNNNNN</em> Set the ramdisk load address. The default load address for the ramdisk is 0x110000. It can be moved higher (lower will not work) if for some reason you need to load other stuff at the address it currently occupies. As this is a linear address and not a segment address, the last 4 bits are not used and should be 0.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MKNBI-DOS</h2>
        <div class="sectioncontent">
<p><strong>mknbi-dos</strong> makes a boot image from a floppy image containing a bootable \s-1DOS\s0 filesystem.  It is not necessary to build the filesystem on a physical floppy if you have the mtools package, but you need a bootable floppy of any size to start with. First extract the boot block from the floppy, this boot block must match the \s-1DOS\s0 kernel files you will copy in the next step:</p><p>dd if=/dev/fd0 of=bootblock bs=512 count=1</p><p>Then get the \s-1DOS\s0 kernel files (this is correct for DR-DOS, the names are different in MS-DOS, \s-1IO\s0.SYS and \s-1MSDOS\s0.SYS):</p><p>mcopy a:IBMBIO.COM a:IBMDOS.COM a:COMMAND.COM .</p><p>Next make an entry in <em>~/.mtoolsrc</em> to declare a floppy to be mapped to a file:</p><p>drive x: file=\*(L"/tmp/floppyimage\*(R"</p><p>Now format a floppy of the desired size, in this example a 2.88 \s-1MB\s0 floppy, at the same time writing the bootblock onto it:</p><p>mformat -C -t 80 -s 36 -h 2 -B bootblock x:</p><p>The size of the \*(L"floppy\*(R" is only limited by the limits on the number of cylinders, sectors and heads, which are 1023, 63 and 255 respectively, and the amount of \s-1RAM\s0 you are willing to allocate to the \*(L"floppy\*(R" in memory. As \s-1RAM\s0 is precious, choose a size slightly bigger than what is needed to hold your \*(L"floppy\*(R" files.</p><p>Finally, copy all your desired files onto the floppy:</p><p>mcopy \s-1IBMBIO\s0.COM x:</p><p>mcopy \s-1IBMDOS\s0.COM x:</p><p>mcopy \s-1COMMAND\s0.COM x:</p><p>mcopy \s-1CONFIG\s0.SYS \s-1AUTOEXEC\s0.BAT \s-1APP\s0.EXE \s-1APP\s0.DAT ... x:</p><p>For MS-DOS substitute \s-1IO\s0.SYS for \s-1IBMIO\s0.COM, and \s-1MSDOS\s0.SYS for \s-1IBMDOS\s0.COM.  The case of the files must be preserved, it may not work if \s-1VFAT\s0 lower case names are generated in the floppy image.  Pay attention to the order of copying as the boot block may expect the first two entries on a newly formatted disk to be \s-1IO\s0.SYS, \s-1MSDOS\s0.SYS.  Possibly too \s-1COMMAND\s0.COM has to be the third entry so we play safe.  Thanks to Phil Davey and Phillip Roa for these tips.</p><p>I have reports that the bootblock of MS-DOS 6.22 sometimes fails to boot the ramdisk.  You could try using the boot block from Netboot instead of getting the boot block off the floppy. I have provided this boot block in the distribution as altboot.bin, and in source form as altboot.S and boot.inc. One essential thing is to make \s-1IO\s0.SYS the first file on the disk, or this bootblock will not work.</p><p>If you happen to have a media of the same size you could test if the image is bootable by copying it onto the media, and then booting it:</p><p>dd if=/tmp/floppyimage of=/dev/fd0</p><p>Then run mknbi-dos over the image <em>/tmp/floppyimage</em> to create a boot image:</p><p>mknbi-dos /tmp/floppyimage &gt; dos.nb</p><p>Move <em>dos.nb</em> to where the network booting process expects to find it.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MKNBI-DOS OPTIONS</h2>
        <div class="sectioncontent">
<p><strong>--harddisk</strong> Make the boot ramdisk the first hard disk, i.e. C:. One reason you might want to do this is because you want to use the real floppy. The limit on \*(L"disk size\*(R" in the boot image is not raised by this option so that is not a reason to use this option. This option is incompatible with --disableharddisk.</p><p><strong>--disableharddisk</strong> When the ramdisk is simulating a floppy disk drive, this switch will disable hard disk accesses.  This is necessary if the client should use a network file system as drive C:, which is only possible if there are no hard disks found by \s-1DOS\s0. This option is incompatible with --harddisk.</p><p><strong>--nosquash</strong> Do not try to chop unused sectors from the end of the floppy image. This increases the boot image size and hence loading time if the \s-1FAT\s0 filesystem on the floppy is mostly empty but you may wish to use this option if you have doubts as to whether the squashing algorithm is working correctly.</p><p><strong>--rdbase=</strong><em>0xNNNNNNNN</em> Set the ramdisk load address. The default load address for the ramdisk is 0x110000. It can be moved higher (lower will not work) if for some reason you need to load other stuff at the address it currently occupies. As this is a linear address and not a segment address, the last 4 bits are not used and should be 0.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Please report all bugs to Etherboot users mailing list: &lt;https://sourceforge.net/mail/?group_id=4233&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO mknbi-fdos&hellip;</h2>
        <div class="sectioncontent">
<p>Etherboot tutorial at \*(C`http://etherboot.sourceforge.net/\*(C' Mtools package is at \*(C`http://wauug.erols.com/pub/knaff/mtools/\*(C' Make sure you have a recent version, the ability to map a drive to a file is not present in old versions.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p><strong>mknbi</strong> is under the \s-1GNU\s0 Public License</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Ken Yap</p><p>mk{elf,nbi}-nfl was contributed by Robb Main of Genedyne.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DATE</h2>
        <div class="sectioncontent">
<p>See man page footer for date and version. Sorry, not available in the \s-1HTML\s0 version.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="mknbi-dos.1.html"><span aria-hidden="true">&larr;</span> mknbi-dos.1: Make network bootable image</a></li>
   <li class="next"><a href="mknbi-linux.1.html">mknbi-linux.1: Make network bootable image <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
