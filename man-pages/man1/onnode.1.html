<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>onnode: Run commands on ctdb cluster nodes</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Run commands on ctdb cluster nodes">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="onnode (1) manual">
  <meta name="twitter:description" content="Run commands on ctdb cluster nodes">
  <meta name="twitter:image" content="https://www.carta.tech/images/ctdb-onnode-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/onnode.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="onnode (1) manual" />
  <meta property="og:description" content="Run commands on ctdb cluster nodes" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/ctdb-onnode-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">onnode<small> (1)</small></h1>
        <p class="lead">Run commands on ctdb cluster nodes</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/onnode.1.html">
      <span itemprop="name">onnode: Run commands on ctdb cluster nodes</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/ctdb/">
      <span itemprop="name">ctdb</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/onnode.1.html">
      <span itemprop="name">onnode: Run commands on ctdb cluster nodes</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>onnode</strong> [<em>OPTION</em>...] {<em>NODES</em>} {<em>COMMAND</em>}</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>onnode is a utility to run commands on a specific node of a CTDB cluster, or on all nodes.</p><p><em>NODES</em> specifies which node(s) to run a command on. See section NODES SPECIFICATION for details.</p><p><em>COMMAND</em> can be any shell command. The onnode utility uses ssh or rsh to connect to the remote nodes and run the command.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>-c</p><p>Execute COMMAND in the current working directory on the specified nodes.</p><p>-f <em>FILENAME</em></p><p>Specify an alternative nodes FILENAME to use instead of the default. This option overrides the CTDB_NODES_FILE environment variable. See the discussion of /etc/ctdb/nodes in the FILES section for more details.</p><p>-i</p><p>Keep standard input open, allowing data to be piped to onnode. Normally onnode closes stdin to avoid surprises when scripting. Note that this option is ignored when using <strong>-p</strong> or if <strong>SSH</strong> is set to anything other than "ssh".</p><p>-n</p><p>Allow nodes to be specified by name rather than node numbers. These nodes don&apos;t need to be listed in the nodes file. You can avoid the nodes file entirely by combining this with -f /dev/null.</p><p>-o <em>PREFIX</em></p><p>Causes standard output from each node to be saved into a file with name PREFIX.<em>IP</em>.</p><p>-p</p><p>Run COMMAND in parallel on the specified nodes. The default is to run COMMAND sequentially on each node.</p><p>-P</p><p>Push files to nodes. Names of files to push are specified rather than the usual command. Quoting is fragile/broken - filenames with whitespace in them are not supported.</p><p>-q</p><p>Do not print node addresses. Normally, onnode prints informational node addresses if more than one node is specified. This overrides -v.</p><p>-v</p><p>Print node addresses even if only one node is specified. Normally, onnode prints informational node addresses when more than one node is specified.</p><p>-h, --help</p><p>Show a short usage guide.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NODES SPECIFICATION</h2>
        <div class="sectioncontent">
<p>Nodes can be specified via numeric node numbers (from 0 to N-1) or mnemonics. Multiple nodes are specified using lists of nodes, separated by commas, and ranges of numeric node numbers, separated by dashes. If nodes are specified multiple times then the command will be executed multiple times on those nodes. The order of nodes is significant.</p><p>The following mnemonics are available:</p><p>all</p><p>All nodes.</p><p>any</p><p>A node where ctdbd is running. This semi-random but there is a bias towards choosing a low numbered node.</p><p>ok | healthy</p><p>All nodes that are not disconnected, banned, disabled or unhealthy.</p><p>con | connected</p><p>All nodes that are not disconnected.</p><p>lvs | lvsmaster</p><p>The current LVS master.</p><p>natgw | natgwlist</p><p>The current NAT gateway.</p><p>rm | recmaster</p><p>The current recovery master.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>The following command would show the process ID of ctdbd on all nodes</p>
<pre>
      onnode all ctdb getpid

</pre>
<p>The following command would show the last 5 lines of log on each node, preceded by the node&apos;s hostname</p>
<pre>
      onnode all "hostname; tail -5 /var/log/log.ctdb"

</pre>
<p>The following command would restart the ctdb service on all nodes, in parallel.</p>
<pre>
      onnode -p all service ctdb restart

</pre>
<p>The following command would run ./foo in the current working directory, in parallel, on nodes 0, 2, 3 and 4.</p>
<pre>
      onnode -c -p 0,2-4 ./foo

</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">
<p><strong>CTDB_BASE</strong></p><p>Directory containing CTDB configuration files. The default is /etc/ctdb.</p><p><strong>CTDB_NODES_FILE</strong></p><p>Name of alternative nodes file to use instead of the default. See the FILES section for more details.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/etc/ctdb/nodes</p><p>Default file containing a list of each node&apos;s IP address or hostname.</p><p>Actually, the default is $CTDB_BASE/nodes, where <strong>CTDB_BASE</strong> defaults to /etc/ctdb. If a relative path is given (via the -f option or <strong>CTDB_BASE</strong>) and no corresponding file exists relative to the current directory then the file is also searched for in the $CTDB_BASE directory.</p><p>/etc/ctdb/onnode.conf</p><p>If this file exists it is sourced by onnode. The main purpose is to allow the administrator to set <strong>SSH</strong> to something other than "ssh". In this case the -t option is ignored. For example, the administrator may choose to use use rsh instead of ssh.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO onnode&hellip;</h2>
        <div class="sectioncontent">
<p><strong>ctdb</strong>(7), \m[blue]<strong>http://ctdb.samba.org/</strong>\m[]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>This documentation was written by Andrew Tridgell, Martin Schwenke</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2007 Andrew Tridgell, Ronnie Sahlberg</p><p>Copyright &copy; 2008 Martin Schwenke</p><p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.</p><p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p><p>You should have received a copy of the GNU General Public License along with this program; if not, see \m[blue]<strong>http://www.gnu.org/licenses</strong>\m[].</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="onig-config.1.html"><span aria-hidden="true">&larr;</span> onig-config.1: Provide information about the installed version of libonig</a></li>
   <li class="next"><a href="onsgmls.1.html">onsgmls.1: An sgml/xml parser and validator <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
