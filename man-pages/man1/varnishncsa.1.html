<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>varnishncsa: Display varnish logs in apache / ncsa combined log format</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Display varnish logs in apache / ncsa combined log format">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="varnishncsa (1) manual">
  <meta name="twitter:description" content="Display varnish logs in apache / ncsa combined log format">
  <meta name="twitter:image" content="https://www.carta.tech/images/varnish-varnishncsa-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/varnishncsa.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="varnishncsa (1) manual" />
  <meta property="og:description" content="Display varnish logs in apache / ncsa combined log format" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/varnish-varnishncsa-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">varnishncsa<small> (1)</small></h1>
        <p class="lead">Display varnish logs in apache / ncsa combined log format</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/varnishncsa.1.html">
      <span itemprop="name">varnishncsa: Display varnish logs in apache / ncsa combined log format</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/varnish/">
      <span itemprop="name">varnish</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/varnishncsa.1.html">
      <span itemprop="name">varnishncsa: Display varnish logs in apache / ncsa combined log format</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>varnishncsa [-a] [-C] [-d] [-D] [-F format] [-g &lt;request|vxid&gt;] [-h] [-n name] [-N filename] [-P file] [-q query] [-V] [-w filename]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The varnishncsa utility reads <a href="../man1/varnishd.1.html"><strong>varnishd</strong>(1)</a> shared memory logs and presents them in the Apache / NCSA "combined" log format.</p><p>Each log line produced is based on a single Request type transaction gathered from the shared memory log. The Request transaction is then scanned for the relevant parts in order to output one log line. To filter the log lines produced, use the query language to select the applicable transactions. Non-request transactions are ignored.</p><p>The following options are available:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-a</strong></p>
  </dt>
  <dd>
    <p>When writing output to a file, append to it rather than overwrite it.</p>
  </dd>
  <dt>
    <p><strong>-C</strong></p>
  </dt>
  <dd>
    <p>Do all regular expression and string matching caseless.</p>
  </dd>
  <dt>
    <p><strong>-d</strong></p>
  </dt>
  <dd>
    <p>Start processing log records at the head of the log instead of the tail.</p>
  </dd>
  <dt>
    <p><strong>-D</strong></p>
  </dt>
  <dd>
    <p>Daemonize.</p>
  </dd>
  <dt>
    <p><strong>-F</strong><em></em><strong>format</strong></p>
  </dt>
  <dd>
    <p>Set the output log format string.</p>
  </dd>
  <dt>
    <p><strong>-g</strong><em></em><strong>&lt;request|vxid&gt;</strong></p>
  </dt>
  <dd>
    <p>The grouping of the log records. The default is to group by vxid.</p>
  </dd>
  <dt>
    <p><strong>-h</strong></p>
  </dt>
  <dd>
    <p>Print program usage and exit</p>
  </dd>
  <dt>
    <p><strong>-n</strong><em></em><strong>name</strong></p>
  </dt>
  <dd>
    <p>Specify the name of the varnishd instance to get logs from. If -n is not specified, the host name is used.</p>
  </dd>
  <dt>
    <p><strong>-N</strong><em></em><strong>filename</strong></p>
  </dt>
  <dd>
    <p>Specify the filename of a stale VSM instance. When using this option the abandonment checking is disabled.</p>
  </dd>
  <dt>
    <p><strong>-P</strong><em></em><strong>file</strong></p>
  </dt>
  <dd>
    <p>Write the process&apos; PID to the specified file.</p>
  </dd>
  <dt>
    <p><strong>-q</strong><em></em><strong>query</strong></p>
  </dt>
  <dd>
    <p>Specifies the VSL query to use.</p>
  </dd>
  <dt>
    <p><strong>-V</strong></p>
  </dt>
  <dd>
    <p>Print version information and exit.</p>
  </dd>
  <dt>
    <p><strong>-w</strong><em></em><strong>filename</strong></p>
  </dt>
  <dd>
    <p>Redirect output to file. The file will be overwritten unless the -a option was specified. If the application receives a SIGHUP the file will be reopened allowing the old one to be rotated away.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FORMAT</h2>
        <div class="sectioncontent">
<p>Specify the log format used. If no format is specified the default log format is used.</p><p>The default log format is:</p>
<pre>
%h %l %u %t "%r" %s %b "%{Referer}i" "%{User-agent}i"
</pre>
<p>Escape sequences &#92;n and &#92;t are supported.</p><p>Supported formatters are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>%b</strong></p>
  </dt>
  <dd>
    <p>Size of response in bytes, excluding HTTP headers.  In CLF format, i.e. a &apos;-&apos; rather than a 0 when no bytes are sent.</p>
  </dd>
  <dt>
    <p><strong>%D</strong></p>
  </dt>
  <dd>
    <p>Time taken to serve the request, in microseconds.</p>
  </dd>
  <dt>
    <p><strong>%H</strong></p>
  </dt>
  <dd>
    <p>The request protocol. Defaults to HTTP/1.0 if not known.</p>
  </dd>
  <dt>
    <p><strong>%h</strong></p>
  </dt>
  <dd>
    <p>Remote host. Defaults to &apos;-&apos; if not known.</p>
  </dd>
  <dt>
    <p><strong>%I</strong></p>
  </dt>
  <dd>
    <p>Total bytes received from client.</p>
  </dd>
  <dt>
    <p><strong>%{X}i</strong></p>
  </dt>
  <dd>
    <p>The contents of request header X.</p>
  </dd>
  <dt>
    <p><strong>%l</strong></p>
  </dt>
  <dd>
    <p>Remote logname (always &apos;-&apos;)</p>
  </dd>
  <dt>
    <p><strong>%m</strong></p>
  </dt>
  <dd>
    <p>Request method. Defaults to &apos;-&apos; if not known.</p>
  </dd>
  <dt>
    <p><strong>%{X}o</strong></p>
  </dt>
  <dd>
    <p>The contents of response header X.</p>
  </dd>
  <dt>
    <p><strong>%O</strong></p>
  </dt>
  <dd>
    <p>Total bytes sent to client.</p>
  </dd>
  <dt>
    <p><strong>%q</strong></p>
  </dt>
  <dd>
    <p>The query string, if no query string exists, an empty string.</p>
  </dd>
  <dt>
    <p><strong>%r</strong></p>
  </dt>
  <dd>
    <p>The first line of the request. Synthesized from other fields, so it may not be the request verbatim.</p>
  </dd>
  <dt>
    <p><strong>%s</strong></p>
  </dt>
  <dd>
    <p>Status sent to the client</p>
  </dd>
  <dt>
    <p><strong>%t</strong></p>
  </dt>
  <dd>
    <p>Time when the request was received, in HTTP date/time format.</p>
  </dd>
  <dt>
    <p><strong>%{X}t</strong></p>
  </dt>
  <dd>
    <p>Time when the request was received, in the format specified by X. The time specification format is the same as for <a href="../man3/strftime.3.html"><strong>strftime</strong>(3)</a>.</p>
  </dd>
  <dt>
    <p><strong>%T</strong></p>
  </dt>
  <dd>
    <p>Time taken to serve the request, in seconds.</p>
  </dd>
  <dt>
    <p><strong>%U</strong></p>
  </dt>
  <dd>
    <p>The request URL without any query string. Defaults to &apos;-&apos; if not known.</p>
  </dd>
  <dt>
    <p><strong>%u</strong></p>
  </dt>
  <dd>
    <p>Remote user from auth</p>
  </dd>
  <dt>
    <p><strong>%{X}x</strong></p>
  </dt>
  <dd>
    <p>Extended variables.  Supported variables are:</p>
  </dd>
  <dt>
    <p><strong>Varnish:time_firstbyte</strong></p>
  </dt>
  <dd>
    <p>Time from when the request processing starts until the first byte is sent to the client.</p>
  </dd>
  <dt>
    <p><strong>Varnish:hitmiss</strong></p>
  </dt>
  <dd>
    <p>Whether the request was a cache hit or miss. Pipe and pass are considered misses.</p>
  </dd>
  <dt>
    <p><strong>Varnish:handling</strong></p>
  </dt>
  <dd>
    <p>How the request was handled, whether it was a cache hit, miss, pass, pipe or error.</p>
  </dd>
  <dt>
    <p><strong>VCL_Log:key</strong></p>
  </dt>
  <dd>
    <p>Output value set by std.log("key:value") in VCL.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SIGNALS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>SIGHUP</strong></p>
  </dt>
  <dd>
    <p>Rotate the log file (see -w option)</p>
  </dd>
  <dt>
    <p><strong>SIGUSR1</strong></p>
  </dt>
  <dd>
    <p>Flush any outstanding transactions</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO varnishncsa&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/varnishd.1.html"><strong>varnishd</strong>(1)</a> <a href="../man1/varnishlog.1.html"><strong>varnishlog</strong>(1)</a> <strong>varnishstat</strong>(1)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">
<p>The varnishncsa utility was developed by Poul-Henning Kamp in cooperation with Verdens Gang AS and Varnish Software AS. This manual page was initially written by Dag-Erling Smørgrav &lt;<em>des@des.no</em>&gt;, and later updated by Martin Blix Grydeland.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>This document is licensed under the same licence as Varnish itself. See LICENCE for details.</p><ul>
<li><p>Copyright (c) 2006 Verdens Gang AS</p></li><li><p>Copyright (c) 2006-2014 Varnish Software AS</p></li>
</ul>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="varnishlog.1.html"><span aria-hidden="true">&larr;</span> varnishlog.1: Display varnish logs</a></li>
   <li class="next"><a href="varnishtop.1.html">varnishtop.1: Varnish log entry ranking <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
