<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>tricensus-mpi: Distribute a triangulation census amongst several machines using mpi</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Distribute a triangulation census amongst several machines using mpi">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="tricensus-mpi (1) manual">
  <meta name="twitter:description" content="Distribute a triangulation census amongst several machines using mpi">
  <meta name="twitter:image" content="https://www.carta.tech/images/regina-normal-mpi-tricensus-mpi-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/tricensus-mpi.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="tricensus-mpi (1) manual" />
  <meta property="og:description" content="Distribute a triangulation census amongst several machines using mpi" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/regina-normal-mpi-tricensus-mpi-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">tricensus-mpi<small> (1)</small></h1>
        <p class="lead">Distribute a triangulation census amongst several machines using mpi</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/tricensus-mpi.1.html">
      <span itemprop="name">tricensus-mpi: Distribute a triangulation census amongst several machines using mpi</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/regina-normal-mpi/">
      <span itemprop="name">regina-normal-mpi</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/tricensus-mpi.1.html">
      <span itemprop="name">tricensus-mpi: Distribute a triangulation census amongst several machines using mpi</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>tricensus-mpi</strong> [ <strong>-D, --depth=</strong><em>levels</em><strong></strong> ] [ <strong>-x, --dryrun</strong> ] [ <strong>-2, --dim2</strong> ] [ <strong>-o, --orientable</strong> | <strong>-n, --nonorientable</strong> ] [ <strong>-f, --finite</strong> | <strong>-d, --ideal</strong> ] [ <strong>-m, --minimal</strong> | <strong>-M, --minprime</strong> | <strong>-N, --minprimep2</strong> | <strong>-h, --minhyp</strong> ] [ <strong>-s, --sigs</strong> ] <strong></strong><em>pairs-file</em><strong></strong> <strong></strong><em>output-file-prefix</em><strong></strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Allows multiple processes, possibly running on a cluster of different machines, to collaborate in forming a census of 3-manifold or 2-manifold triangulations. Coordination is done through MPI (the Message Passing Interface), and the entire census is run as a single MPI job. This program is well suited for high-performance clusters.</p><p>The default behaviour is to enumerate 3-manifold triangulations. If you wish to enumerate 2-manifold triangulations instead, you must pass <strong>--dim2</strong>.</p><p>To prepare a census for distribution amongst several processes or machines, the census must be split into smaller pieces. Running <strong>tricensus</strong> with option <strong>--genpairs</strong> (which is very fast) will create a list of face pairings, each of which must be analysed in order to complete the census.</p><p>The full list of face pairings should be stored in a single file, which is passed on the command-line as <em>pairs-file</em>. This file must contain one face pairing per line, and each of these face pairings must be in canonical form (i.e., must be a minimal representative of its isomorphism class).  The face pairings generated by <strong>tricensus</strong> --genpairs are guaranteed to satisfy these conditions.</p><p>The <strong>tricensus-mpi</strong> utility has two modes of operation: default mode, and subsearch mode.  These are explained separately under modes of operation below.</p><p>In both modes, one MPI process acts as the controller and the remaining processes all act as slaves.  The controller reads the list of face pairings from <em>pairs-file</em>, constructs a series of tasks based on these, and farms these tasks out to the slaves for processing.  Each slave processes one task at a time, asking the controller for a new task when it is finished with the previous one.</p><p>At the end of each task, if any triangulations were found then the slave responsible will save these triangulations to an output file. The output file will have a name of the form <em>output-file-prefix_p.rga</em> in default mode or <em>output-file-prefix_p-s.rga</em> in subsearch mode. Here <em>output-file-prefix</em> is passed on the command line, <em>p</em> is the number of the face pairing being processed, and <em>s</em> is the number of the subsearch within that face pairing (both face pairings and subsearches are numbered from 1 upwards). If no triangulations were found then the slave will not write any output file at all.</p><p>The controller and slave processes all take the same <strong>tricensus-mpi</strong> options (excluding MPI-specific options, which are generally supplied by an MPI wrapper program such as <strong>mpirun</strong> or <strong>mpiexec</strong>). The different roles of the processes are determined solely by their MPI process rank (the controller is always the process with rank 0). It should therefore be possible to start all MPI processes by running a single command, as illustrated in the examples below.</p><p>As the census progresses, the controller keeps a detailed log of each slave's activities, including how long each slave task has taken and how many triangulations have been found.  This log is written to the file <em>output-file-prefix.log</em>. The utility <strong>tricensus-mpi-status</strong> can parse this log and produce a shorter human-readable summary.</p><p><strong>Important:</strong> It is <strong>highly recommended</strong> that you use the <strong>--sigs</strong> option.  This will keep output files small, and will significantly reduce the memory footprint of <strong>tricensus-mpi</strong> itself.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MODES OF OPERATION</h2>
        <div class="sectioncontent">
<p>As discussed above, there are two basic modes of operation. These are default mode (used when <strong>--depth</strong> is not passed), and subsearch mode (used when <strong>--depth</strong> is passed).</p>
<dl class='dl-vertical'>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>In <strong>default mode</strong>, the controller simply reads the list of face pairings and gives each pairing to a slave for processing, one after another.</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>In <strong>subsearch mode</strong>, more work is pushed to the controller and the slave tasks are shorter.  Here the controller reads one face pairing at a time and begins processing that face pairing.  A fixed depth is supplied in the argument <strong>--depth</strong>; each time that depth is reached in the search tree, the subsearch from that point on is given as a task to the next idle slave. Meanwhile the controller backtracks (as though the subsearch had finished) and continues, farming the next subsearch out when the given depth is reached again, and so on.</p>
  </dd>

</dl>
<p>The modes can be visualised as follows. For each face pairing, consider the corresponding recursive search as a large search tree.  In default mode, the entire tree is processed at once as a single slave task.  In subsearch mode, each subtree rooted at the given depth is processed as a separate slave task (and all processing between the root and the given depth is done by the controller).</p><p>The main difference between the different modes of operation is the lengths of the slave tasks, which can have a variety of effects.</p>
<dl class='dl-vertical'>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>In default mode the slave tasks are quite long. This means the parallelisation can become very poor towards the end of the census, with some slaves sitting idle for a long time as they wait for the remaining slaves to finish.</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>As we move to subsearch mode with increasing depth, the slave tasks become shorter and the slaves' finish times will be closer together (thus avoiding the idle slave inefficiency described above). Moreover, with a more refined subsearch, the progress information stored in the log will be more detailed, giving a better idea of how long the census has to go.  On the other hand, more work is pushed to the single-process controller (risking a bottleneck if the depth is too great, with slaves now sitting idle as they wait for new tasks).  In addition the MPI overhead is greater, and the number of output files can become extremely large.</p>
  </dd>

</dl>
<p>In the end, experimentation is the best way to decide whether to run in subsearch mode and at what depth.  Be aware of the option <strong>--dryrun</strong>, which can give a quick overview of the search space (and in particular, show how many subsearches are required for each face pairing at any given depth).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>The census options accepted by <strong>tricensus-mpi</strong> are identical to the options for <strong>tricensus</strong> See the <strong>tricensus</strong> reference for details.</p><p>Some options from <strong>tricensus</strong> are not available here (e.g., tetrahedra and boundary options), since these must be supplied earlier on when generating the initial list of face pairings.</p><p>There are new options specific to <strong>tricensus-mpi</strong>, which are as follows.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-D, --depth=</strong><em>levels</em><strong></strong></p>
  </dt>
  <dd>
    <p>Indicates that subsearch mode should be used (instead of default mode).  The argument <em>levels</em> specifies at what depth in the search tree processing should pass from the controller to a new slave task.</p><p>The given depth must be strictly positive (running at depth zero is equivalent to running in default mode).</p><p>See the modes of operation section above for further information, as well as hints on choosing a good value for <em>levels</em>.</p>
  </dd>
  <dt>
    <p><strong>-x, --dryrun</strong></p>
  </dt>
  <dd>
    <p>Specifies that a fast dry run should be performed, instead of a full census.</p><p>In a dry run, each time a slave accepts a task it will immediately mark it as finished with no triangulations found. The behaviour of the controller remains unchanged.</p><p>The result will be an empty census.  The benefit of a dry run is the log file it produces, which will show precisely how face pairings would be divided into subsearches in a real census run. In particular, the log file will show how many subsearches each face pairing produces (the utility <strong>tricensus-mpi-status</strong> can help extract this information from the log).</p><p>At small subsearch depths, a dry run should be extremely fast. As the depth increases however, the dry run will become slower due to the extra work given to the controller.</p><p>This option is only useful in subsearch mode (it can be used in default mode, but the results are uninteresting). See the modes of operation section above for further details.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Suppose we wish to form a census of all 6-tetrahedron closed non-orientable triangulations, optimised for prime minimal P2-irreducible triangulations (so some non-prime, non-minimal or non-P2-irreducible triangulations may be omitted).</p><p>We begin by using <strong>tricensus</strong> to generate a full list of face pairings.</p>
<pre>
    example$ <strong>tricensus --genpairs -t 6 -i &gt; 6.pairs</strong>
    Total face pairings: 97
    example$
</pre>
<p>We now use <strong>tricensus-mpi</strong> to run the distributed census.  A wrapper program such as <strong>mpirun</strong> or <strong>mpiexec</strong> can generally be used to start the MPI processes, though this depends on your specific MPI implementation.  The following command runs a distributed census on 10 processors using the MPICH implementation of MPI.</p>
<pre>
    example$ <strong>mpirun -np 10 /usr/bin/tricensus-mpi -Nnf 6.pairs 6-nor</strong>
    example$
</pre>
<p>The current state of processing is kept in the controller log <em>6-nor.log</em>.  You can watch this log with the help of <strong>tricensus-mpi-status</strong>.</p>
<pre>
    example$ <strong>tricensus-mpi-status 6-nor.log</strong>
    Pairing 1: done, 0 found
    ...
    Pairing 85: done, 0 found
    Pairing 86: done, 7 found
    Pairing 87: running
    Pairing 88: running
    Still running, 15 found, last activity: Wed Jun 10 05:57:34 2009
    example$
</pre>
<p>Once the census is finished, the resulting triangulations will be saved in files such as <em>6-nor_8.rga</em>, <em>6-nor_86.rga</em> and so on.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MACOS&#92;~X AND WINDOWS USERS</h2>
        <div class="sectioncontent">
<p>This utility is not shipped with the drag-and-drop app bundle for <strong>MacOS\~X</strong> or with the <strong>Windows</strong> installer.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO tricensus-mpi&hellip;</h2>
        <div class="sectioncontent">
<p>censuslookup, regconcat, sigcensus, tricensus, tricensus-mpi-status, regina-gui.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>This utility was written by Benjamin Burton &lt;bab@debian.org&gt;. Many people have been involved in the development of Regina; see the users' handbook for a full list of credits.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="tricensus.1.html"><span aria-hidden="true">&larr;</span> tricensus.1: Form a census of 3-manifold triangulations</a></li>
   <li class="next"><a href="tricensus-mpi-status.1.html">tricensus-mpi-status.1: Summarise the log file of an mpi census of triangulations <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
