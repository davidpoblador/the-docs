<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pegasus-exitcode: Checks the stdout/stderr files of a workflow job for any indication that an error occurred in the job. this script is intended to be invoked automatically by dagman as the post script of a job.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Checks the stdout/stderr files of a workflow job for any indication that an error occurred in the job. this script is intended to be invoked automatically by dagman as the post script of a job.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="pegasus-exitcode (1) manual">
  <meta name="twitter:description" content="Checks the stdout/stderr files of a workflow job for any indication that an error occurred in the job. this script is intended to be invoked automatically by dagman as the post script of a job.">
  <meta name="twitter:image" content="https://www.carta.tech/images/pegasus-wms-pegasus-exitcode-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/pegasus-exitcode.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="pegasus-exitcode (1) manual" />
  <meta property="og:description" content="Checks the stdout/stderr files of a workflow job for any indication that an error occurred in the job. this script is intended to be invoked automatically by dagman as the post script of a job." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/pegasus-wms-pegasus-exitcode-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pegasus-exitcode<small> (1)</small></h1>
        <p class="lead">Checks the stdout/stderr files of a workflow job for any indication that an error occurred in the job. this script is intended to be invoked automatically by dagman as the post script of a job.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/pegasus-exitcode.1.html">
      <span itemprop="name">pegasus-exitcode: Checks the stdout/stderr files of a workflow job for any indication that an error occurred in the job. this script is intended to be invoked automatically by dagman as the post script of a job.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/pegasus-wms/">
      <span itemprop="name">pegasus-wms</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/pegasus-exitcode.1.html">
      <span itemprop="name">pegasus-exitcode: Checks the stdout/stderr files of a workflow job for any indication that an error occurred in the job. this script is intended to be invoked automatically by dagman as the post script of a job.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>pegasus-exitcode</strong> [<strong>-h</strong>][<strong>-r</strong> <em>rv</em>][<strong>-n</strong>][<strong>-s</strong> <em>msg</em>][<strong>-f</strong> <em>msg</em>] <em>job.out</em>
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>pegasus-exitcode</strong> is a utility that examines the STDOUT of a job to determine if the job failed, and renames the STDOUT and STDERR files of a job to preserve them in case the job is retried.</p><p>Pegasus uses <strong>pegasus-exitcode</strong> as the DAGMan postscript for jobs submitted via Globus GRAM. This tool exists as a workaround to a known problem with Globus and Condor-G where the exitcodes of GRAM jobs are not returned. This is a problem because Pegasus uses the exitcode of a job to determine if the job failed or not.</p><p>In order to get around the exitcode problem, Pegasus can wrap GRAM jobs with Kickstart, which records the exitcode of the job in an XML invocation record, which it writes to the job\(cqs STDOUT. The STDOUT is transferred from the execution host back to the submit host when the job terminates. After the job terminates, DAGMan runs the job\(cqs postscript, which Pegasus sets to be <strong>pegasus-exitcode</strong>. <strong>pegasus-exitcode</strong> looks at the invocation record generated by kickstart to see if the job succeeded or failed. If the invocation record indicates a failure, then <strong>pegasus-exitcode</strong> returns a non-zero result, which indicates to DAGMan that the job has failed. If the invocation record indicates that the job succeeded, then <strong>pegasus-exitcode</strong> returns 0, which tells DAGMan that the job succeeded.</p><p>In addition, clustered jobs executed with <strong>pegasus-cluster</strong> or <strong>pegasus-mpi-cluster</strong> will have a [cluster-summary] record in their STDOUT. <strong>pegasus-exitcode</strong> can examine these records to determine if any of the tasks in the clustered job failed.</p><p><strong>pegasus-exitcode</strong> performs several checks (some optional) to determine whether a job failed or not. These checks include:</p><p>Is the Condor exitcode non-zero? If so, then the job failed.</p><p>Is STDOUT empty? If it is empty, then the job failed.</p><p>Are there any failure messages in the STDOUT or STDERR? If so, the job failed.</p><p>Are all of the success messages in the STDOUT or STDERR? If not, then the job failed.</p><p>Does the [cluster-summary] record indicate that the job was successful. If not, then the job failed.</p><p>Are there any &lt;status&gt; tags with a non-zero value? If there are, then the job failed. Note that, if this is a clustered job, there could be multiple &lt;status&gt; tags, one for each task. If any of them are non-zero, then the job failed.</p><p>Is there at least one &lt;status&gt; tag with a zero value? There must be at least one successful invocation or the job has failed.</p><p>In addition, <strong>pegasus-exitcode</strong> allows the caller to specify the exitcode returned by Condor using the <strong>--return</strong> argument. This can be passed to <strong>pegasus-exitcode</strong> in a DAGMan post script by using the $RETURN variable. If this value is non-zero, then <strong>pegasus-exitcode</strong> returns a non-zero result before performing any other checks. For GRAM jobs, the value of $RETURN will always be 0 regardless of whether the job failed or not.</p><p>In addition to checking the success/failure of a job, <strong>pegasus-exitcode</strong> also renames the STDOUT and STDERR files of the job so that if the job is retried, the STDOUT and STDERR of the previous run are not lost. It does this by appending a sequence number to the end of the files. For example, if the STDOUT file is called "job.out", then the first time the job is run <strong>pegasus-exitcode</strong> will rename the file "job.out.000". If the job is run again, then <strong>pegasus-exitcode</strong> sees that "job.out.000" already exists and renames the file "job.out.001". It will continue to rename the file by incrementing the sequence number every time the job is executed.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p><strong>-h</strong>, <strong>--help</strong></p><p>Prints a usage summary with all the available command-line options.</p><p><strong>-r</strong> <em>rv</em>, <strong>--return</strong> <em>rv</em></p><p>Return value reported by DAGMan. This can be specified in the DAG using the $RETURN variable. If this is non-zero, then <strong>pegasus-exitcode</strong> immediately fails with a non-zero return value itself. If it is zero, then just rotate the file and don\(cqt check for proper kickstart output. This option can be used in cases where kickstart cannot be used (such as pegasus-create-dir) to enable file rotation.</p><p><strong>-n</strong>, <strong>--no-rename</strong></p><p>Don\(cqt rename <em>job.out</em> and <em>job.err</em> to <em>.out.XXX</em> and <em>.err.XXX</em>. This option is used primarily for testing.</p><p><strong>-f</strong> <em>msg</em>, <strong>--failure-message</strong> <em>msg</em></p><p>Failure message to find in job stdout/stderr. If this message exists in the stdout/stderr of the job, then the job will be considered a failure no matter what other output exists. If multiple failure messages are provided, then none of them can exist in the output or the job is considered a failure.</p><p><strong>-s</strong> <em>msg</em>, <strong>--success-message</strong> <em>msg</em></p><p>Success message to find in job stdout/stderr. If this message does not exist in the stdout/stderr of the job, then the job will be considered a failure no matter what other output exists. If multiple success messages are provided, then they must all exist in the output or the job is considered a failure.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Gideon Juve &lt;juve@usc.edu&gt;</p><p>Pegasus Team \m[blue]<strong>http://pegasus.isi.edu</strong>\m[]</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pegasus-dax-validator.1.html"><span aria-hidden="true">&larr;</span> pegasus-dax-validator.1: Determines if a given dax file is valid.</a></li>
   <li class="next"><a href="pegasus-gridftp.1.html">pegasus-gridftp.1: Perform file and directory operations on remote gridftp servers <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
