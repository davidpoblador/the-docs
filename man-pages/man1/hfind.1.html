<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>hfind: Lookup a hash value in a hash database</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Lookup a hash value in a hash database">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="hfind (1) manual">
  <meta name="twitter:description" content="Lookup a hash value in a hash database">
  <meta name="twitter:image" content="https://www.carta.tech/images/sleuthkit-hfind-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/hfind.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="hfind (1) manual" />
  <meta property="og:description" content="Lookup a hash value in a hash database" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/sleuthkit-hfind-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">hfind<small> (1)</small></h1>
        <p class="lead">Lookup a hash value in a hash database</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/hfind.1.html">
      <span itemprop="name">hfind: Lookup a hash value in a hash database</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/sleuthkit/">
      <span itemprop="name">sleuthkit</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/hfind.1.html">
      <span itemprop="name">hfind: Lookup a hash value in a hash database</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>hfind [-i</strong> <em>db_type</em> <strong>] [-f</strong> <em>lookup_file</em> <strong>] [-eq]</strong> <em>db_file [hashes]</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>hfind</strong> looks up hash values in a database using a binary search algorithm. This allows one to easily create a hash database and identify if a file is known or not.  It works with the NIST National Software Reference Library (NSRL) and the output of 'md5sum'.</p><p>Before the database can be used by 'hfind', an index file must be created with the '-i' option.</p><p>This tool is needed for efficiency.  Most text-based databases do not have fixed length entries and are sometimes not sorted.  The hfind tool will create an index file that is sorted and has fixed-length entries.  This allows for fast lookups using a binary search algorithm instead of a linear search such as 'grep'.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ARGUMENTS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    -i db_type
  </dt>
  <dd>
    <p>Create an index file for the database.  This step must be done before a lookup can be performed. The 'db_type' argument specifies the database type (i.e. nsrl-md5 or md5sum).  See section below.</p>
  </dd>
  <dt>
    -f lookup_file
  </dt>
  <dd>
    <p>Specify the location of a file that contains one hash value per line. These hashes will be looked up in the database.</p>
  </dd>
  <dt>
    -e
  </dt>
  <dd>
    <p>Extended mode.  Additional information besides just the name is printed. (Does not apply for all hash database types).</p>
  </dd>
  <dt>
    -q
  </dt>
  <dd>
    <p>Quick mode.  Instead of displaying the corresponding information with the hash, just display 0 if the hash was not found and 1 if it was.  If this flag is used, then only one hash can be given at a time.</p>
  </dd>
  <dt>
    -V
  </dt>
  <dd>
    <p>Display version</p>
  </dd>
  <dt>
    db_file
  </dt>
  <dd>
    <p>The location of the hash database file.</p>
  </dd>
  <dt>
    [hashes]
  </dt>
  <dd>
    <p>The hashes to lookup.  If they are not supplied on the command line, STDIN is used.  If index files exist for both SHA-1 and MD5 hashes, then both types of hashes can be given at runtime.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INDEX FILE</h2>
        <div class="sectioncontent">
<p><strong>hfind</strong> uses an index file to perform a binary search for a hash value. This is much faster than using 'grep', which will do a linear search.  Before a hash database is used, a corresponding index file must be created. This is done with the '-i' option to hfind.</p><p>The resulting index file will be named based on the database file name. The name will have the original name following by the hash type (sha1 or md5) followed by '.idx'.  For example, creating an MD5 hash index of the NIST NSRL results in 'NSRLFile.txt-md5.idx' and the SHA-1 index results in 'NSRLFile.txt-sha1.idx'.</p><p>The file has two columns.  Each entry is sorted by the first column, which is the hash value.  The second column has the byte offset of the corresponding entry in the original file.  So, when a hash is found in the index, the offset is recorded and then 'hfind' seeks to the entry in the original database.</p><p>The following input types are valid.  For NSRL, 'nsrl-md5' and \'nsrl-sha1' can be used.  The difference is which hash value the index is sorted by.  The 'md5sum' value can also be used to sort and index "home made" databases.  'hfind' can take data in both common formats:</p>
<pre>
    MD5 (test.txt) = 76b1f4de1522c20b67acc132937cf82e
</pre>
<p>and</p>
<pre>
    76b1f4de1522c20b67acc132937cf82e        test.txt
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>To create an MD5 index file for NIST NSRL:</p>
<pre>
    # hfind -i nsrl-md5 /usr/local/hash/nsrl/NSRLFile.txt
</pre>
<p>To lookup a value in the NSRL:</p>
<pre>
    # hfind /usr/local/hash/nsrl/NSRLFile.txt 76b1f4de1522c20b67acc132937cf82e
</pre>

<pre>
    76b1f4de1522c20b67acc132937cf82e  Hash Not Found
</pre>
<p>You can even do both SHA-1 and MD5 if you want:</p>
<pre>
    # hfind -i nsrl-sha1 /usr/local/hash/nsrl/NSRLFile.txt
</pre>

<pre>
    # hfind /usr/local/hash/nsrl/NSRLFile.txt
    76b1f4de1522c20b67acc132937cf82e
    80001A80B3F1B80076B297CEE8805AAA04E1B5BA
</pre>

<pre>
    76b1f4de1522c20b67acc132937cf82e  Hash Not Found
</pre>

<pre>
    80001A80B3F1B80076B297CEE8805AAA04E1B5BA  thrdcore.cpp
</pre>
<p>To make a database of critical binaries of a trusted system, use 'md5sum':</p>
<pre>
    # md5sum /bin/* /sbin/* /usr/bin/* /usr/bin/* /usr/local/bin/* /usr/local/sbin/* &gt; system.md5
</pre>

<pre>
    # hfind -i md5sum system.md5
</pre>
<p>To look entries up, the following will work:</p>
<pre>
    # hfind system.md5 76b1f4de1522c20b67acc132937cf82e
</pre>

<pre>
    76b1f4de1522c20b67acc132937cf82e  Hash Not Found
</pre>
<p>or</p>
<pre>
    # md5sum -q /bin/* | hfind system.md5
</pre>

<pre>
    928682269cd3edb1acdf9a7f7e606ff2  /bin/bash
</pre>

<pre>
    &lt;...&gt;
</pre>
<p>or</p>
<pre>
    # md5sum -q /bin/* &gt; bin.md5
</pre>

<pre>
    # hfind -f bin.md5 system.md5
</pre>

<pre>
    928682269cd3edb1acdf9a7f7e606ff2  /bin/bash
</pre>

<pre>
    &lt;...&gt;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO hfind&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/sorter.1.html"><strong>sorter</strong>(1)</a></p><p>The NIST National Software Reference Library (NSRL) can be found at www.nsrl.nist.gov.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE</h2>
        <div class="sectioncontent">
<p>Distributed under the Common Public License, found in the <em>cpl1.0.txt</em> file in the The Sleuth Kit licenses directory.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Brian Carrier &lt;carrier at sleuthkit dot org&gt;</p><p>Send documentation updates to &lt;doc-updates at sleuthkit dot org&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="hf77.1.html"><span aria-hidden="true">&larr;</span> hf77.1: Compile lam fortran programs.</a></li>
   <li class="next"><a href="hformat.1.html">hformat.1: Create a new hfs filesystem and make it current <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
