<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ntlm_auth: Tool to allow external access to winbinds ntlm authentication function</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Tool to allow external access to winbinds ntlm authentication function">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="ntlm_auth (1) manual">
  <meta name="twitter:description" content="Tool to allow external access to winbinds ntlm authentication function">
  <meta name="twitter:image" content="https://www.carta.tech/images/winbind-ntlm_auth-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/ntlm_auth.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ntlm_auth (1) manual" />
  <meta property="og:description" content="Tool to allow external access to winbinds ntlm authentication function" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/winbind-ntlm_auth-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">ntlm_auth<small> (1)</small></h1>
        <p class="lead">Tool to allow external access to winbinds ntlm authentication function</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/ntlm_auth.1.html">
      <span itemprop="name">ntlm_auth: Tool to allow external access to winbinds ntlm authentication function</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/winbind/">
      <span itemprop="name">winbind</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/ntlm_auth.1.html">
      <span itemprop="name">ntlm_auth: Tool to allow external access to winbinds ntlm authentication function</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>ntlm_auth</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This tool is part of the <a href="../man7/samba.7.html"><strong>samba</strong>(7)</a> suite.</p><p>ntlm_auth is a helper utility that authenticates users using NT/LM authentication. It returns 0 if the users is authenticated successfully and 1 if access was denied. ntlm_auth uses winbind to access the user and authentication data for a domain. This utility is only intended to be used by other programs (currently Squid and mod_ntlm_winbind)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPERATIONAL REQUIREMENTS</h2>
        <div class="sectioncontent">
<p>The <a href="../man8/winbindd.8.html"><strong>winbindd</strong>(8)</a> daemon must be operational for many of these commands to function.</p><p>Some of these commands also require access to the directory winbindd_privileged in $LOCKDIR. This should be done either by running this command as root or providing group access to the winbindd_privileged directory. For security reasons, this directory should not be world-accessable.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>--helper-protocol=PROTO</p><p>Operate as a stdio-based helper. Valid helper protocols are:</p><p>squid-2.4-basic</p><p>Server-side helper for use with Squid 2.4&apos;s basic (plaintext) authentication.</p><p>squid-2.5-basic</p><p>Server-side helper for use with Squid 2.5&apos;s basic (plaintext) authentication.</p><p>squid-2.5-ntlmssp</p><p>Server-side helper for use with Squid 2.5&apos;s NTLMSSP authentication.</p><p>Requires access to the directory winbindd_privileged in $LOCKDIR. The protocol used is described here: http://devel.squid-cache.org/ntlm/squid_helper_protocol.html. This protocol has been extended to allow the NTLMSSP Negotiate packet to be included as an argument to the YR command. (Thus avoiding loss of information in the protocol exchange).</p><p>ntlmssp-client-1</p><p>Client-side helper for use with arbitrary external programs that may wish to use Samba&apos;s NTLMSSP authentication knowledge.</p><p>This helper is a client, and as such may be run by any user. The protocol used is effectively the reverse of the previous protocol. A YR command (without any arguments) starts the authentication exchange.</p><p>gss-spnego</p><p>Server-side helper that implements GSS-SPNEGO. This uses a protocol that is almost the same as squid-2.5-ntlmssp, but has some subtle differences that are undocumented outside the source at this stage.</p><p>Requires access to the directory winbindd_privileged in $LOCKDIR.</p><p>gss-spnego-client</p><p>Client-side helper that implements GSS-SPNEGO. This also uses a protocol similar to the above helpers, but is currently undocumented.</p><p>ntlm-server-1</p><p>Server-side helper protocol, intended for use by a RADIUS server or the &apos;winbind&apos; plugin for pppd, for the provision of MSCHAP and MSCHAPv2 authentication.</p><p>This protocol consists of lines in the form: Parameter: value and Parameter:: Base64-encode value. The presence of a single period . indicates that one side has finished supplying data to the other. (Which in turn could cause the helper to authenticate the user).</p><p>Currently implemented parameters from the external program to the helper are:</p><p>Username</p><p>The username, expected to be in Samba&apos;s \m[blue]<strong>unix charset</strong>\m[].</p><p>Examples:</p><p>Username: bob</p><p>Username:: Ym9i</p><p>NT-Domain</p><p>The user&apos;s domain, expected to be in Samba&apos;s \m[blue]<strong>unix charset</strong>\m[].</p><p>Examples:</p><p>NT-Domain: WORKGROUP</p><p>NT-Domain:: V09SS0dST1VQ</p><p>Full-Username</p><p>The fully qualified username, expected to be in Samba&apos;s \m[blue]<strong>unix charset</strong>\m[] and qualified with the \m[blue]<strong>winbind separator</strong>\m[].</p><p>Examples:</p><p>Full-Username: WORKGROUP&#92;bob</p><p>Full-Username:: V09SS0dST1VQYm9i</p><p>LANMAN-Challenge</p><p>The 8 byte LANMAN Challenge value, generated randomly by the server, or (in cases such as MSCHAPv2) generated in some way by both the server and the client.</p><p>Examples:</p><p>LANMAN-Challenge: 0102030405060708</p><p>LANMAN-Response</p><p>The 24 byte LANMAN Response value, calculated from the user&apos;s password and the supplied LANMAN Challenge. Typically, this is provided over the network by a client wishing to authenticate.</p><p>Examples:</p><p>LANMAN-Response: 0102030405060708090A0B0C0D0E0F101112131415161718</p><p>NT-Response</p><p>The &gt;= 24 byte NT Response calculated from the user&apos;s password and the supplied LANMAN Challenge. Typically, this is provided over the network by a client wishing to authenticate.</p><p>Examples:</p><p>NT-Response: 0102030405060708090A0B0C0D0E0F10111213141516171</p><p>Password</p><p>The user&apos;s password. This would be provided by a network client, if the helper is being used in a legacy situation that exposes plaintext passwords in this way.</p><p>Examples:</p><p>Password: samba2</p><p>Password:: c2FtYmEy</p><p>Request-User-Session-Key</p><p>Upon successful authenticaiton, return the user session key associated with the login.</p><p>Examples:</p><p>Request-User-Session-Key: Yes</p><p>Request-LanMan-Session-Key</p><p>Upon successful authenticaiton, return the LANMAN session key associated with the login.</p><p>Examples:</p><p>Request-LanMan-Session-Key: Yes</p><p><strong>Warning</strong></p><p>Implementers should take care to base64 encode any data (such as usernames/passwords) that may contain malicous user data, such as a newline. They may also need to decode strings from the helper, which likewise may have been base64 encoded.</p><p>--username=USERNAME</p><p>Specify username of user to authenticate</p><p>--domain=DOMAIN</p><p>Specify domain of user to authenticate</p><p>--workstation=WORKSTATION</p><p>Specify the workstation the user authenticated from</p><p>--challenge=STRING</p><p>NTLM challenge (in HEXADECIMAL)</p><p>--lm-response=RESPONSE</p><p>LM Response to the challenge (in HEXADECIMAL)</p><p>--nt-response=RESPONSE</p><p>NT or NTLMv2 Response to the challenge (in HEXADECIMAL)</p><p>--password=PASSWORD</p><p>User&apos;s plaintext password</p><p>If not specified on the command line, this is prompted for when required.</p><p>For the NTLMSSP based server roles, this parameter specifies the expected password, allowing testing without winbindd operational.</p><p>--request-lm-key</p><p>Retrieve LM session key</p><p>--request-nt-key</p><p>Request NT key</p><p>--diagnostics</p><p>Perform Diagnostics on the authentication chain. Uses the password from --password or prompts for one.</p><p>--require-membership-of={SID|Name}</p><p>Require that a user be a member of specified group (either name or SID) for authentication to succeed.</p><p>--pam-winbind-conf=FILENAME</p><p>Define the path to the pam_winbind.conf file.</p><p>--target-hostname=HOSTNAME</p><p>Define the target hostname.</p><p>--target-service=SERVICE</p><p>Define the target service.</p><p>--use-cached-creds</p><p>Whether to use credentials cached by winbindd.</p><p>--configfile=&lt;configuration file&gt;</p><p>The file specified contains the configuration details required by the server. The information in this file includes server-specific information such as what printcap file to use, as well as descriptions of all the services that the server is to provide. See smb.conf for more information. The default configuration file name is determined at compile time.</p><p>-V|--version</p><p>Prints the program version number.</p><p>-?|--help</p><p>Print a summary of command line options.</p><p>--usage</p><p>Display brief usage message.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE SETUP</h2>
        <div class="sectioncontent">
<p>To setup ntlm_auth for use by squid 2.5, with both basic and NTLMSSP authentication, the following should be placed in the squid.conf file.</p>
<pre>
auth_param ntlm program ntlm_auth --helper-protocol=squid-2.5-ntlmssp
auth_param basic program ntlm_auth --helper-protocol=squid-2.5-basic
auth_param basic children 5
auth_param basic realm Squid proxy-caching web server
auth_param basic credentialsttl 2 hours
</pre>
<p><strong>Note</strong></p><p>This example assumes that ntlm_auth has been installed into your path, and that the group permissions on winbindd_privileged are as described above.</p><p>To setup ntlm_auth for use by squid 2.5 with group limitation in addition to the above example, the following should be added to the squid.conf file.</p>
<pre>
auth_param ntlm program ntlm_auth --helper-protocol=squid-2.5-ntlmssp --require-membership-of=&apos;WORKGROUP&#92;Domain Users&apos;
auth_param basic program ntlm_auth --helper-protocol=squid-2.5-basic --require-membership-of=&apos;WORKGROUP&#92;Domain Users&apos;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TROUBLESHOOTING</h2>
        <div class="sectioncontent">
<p>If you&apos;re experiencing problems with authenticating Internet Explorer running under MS Windows 9X or Millennium Edition against ntlm_auth&apos;s NTLMSSP authentication helper (--helper-protocol=squid-2.5-ntlmssp), then please read the Microsoft Knowledge Base article #239869 and follow instructions described there.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>This man page is correct for version 3 of the Samba suite.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>The original Samba software and related utilities were created by Andrew Tridgell. Samba is now developed by the Samba Team as an Open Source project similar to the way the Linux kernel is developed.</p><p>The ntlm_auth manpage was written by Jelmer Vernooij and Andrew Bartlett.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="nted.1.html"><span aria-hidden="true">&larr;</span> nted.1: A wysiwyg musical score editor</a></li>
   <li class="next"><a href="ntpdc.1.html">ntpdc.1: Special ntp query program <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
