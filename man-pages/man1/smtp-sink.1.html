<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>smtp-sink - multi-threaded SMTP/LMTP test server</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Multi-threaded smtp/lmtp test server">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">smtp-sink<small> (1)</small></h1>
        <p class="lead">Multi-threaded smtp/lmtp test server</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/smtp-sink.1.html">
      <span itemprop="name">smtp-sink</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/postfix/">
      <span itemprop="name">postfix</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/smtp-sink.1.html">
      <span itemprop="name">smtp-sink</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p><strong>smtp-sink</strong> [<em>options</em>] [<strong>inet:</strong>][<em>host</em>]:<em>port</em> <em>backlog</em></p>
<p class='spacer'>

<p><strong>smtp-sink</strong> [<em>options</em>] <strong>unix:</strong><em>pathname</em> <em>backlog</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p><strong>smtp-sink</strong> listens on the named host (or address) and port. It takes SMTP messages from the network and throws them away. The purpose is to measure client performance, not protocol compliance.</p>
<p class='spacer'>

<p><strong>smtp-sink</strong> may also be configured to capture each mail delivery transaction to file. Since disk latencies are large compared to network delays, this mode of operation can reduce the maximal performance by several orders of magnitude.</p>
<p class='spacer'>

<p>Connections can be accepted on IPv4 or IPv6 endpoints, or on UNIX-domain sockets. IPv4 and IPv6 are the default. This program is the complement of the <a href="../man1/smtp-source.1.html"><strong>smtp-source</strong>(1)</a> program.</p>
<p class='spacer'>

<p>Note: this is an unsupported test program. No attempt is made to maintain compatibility between successive versions.</p>
<p class='spacer'>

  <p>Arguments:</p>
  <dl class='dl-horizontal'>
    <dt><strong>-4</strong></dt>
    <dd>
  <p>Support IPv4 only. This option has no effect when Postfix is built without IPv6 support.</p>
    </dd>
    <dt><strong>-6</strong></dt>
    <dd>
  <p>Support IPv6 only. This option is not available when Postfix is built without IPv6 support.</p>
    </dd>
    <dt><strong>-8</strong></dt>
    <dd>
  <p>Do not announce 8BITMIME support.</p>
    </dd>
    <dt><strong>-a</strong></dt>
    <dd>
  <p>Do not announce SASL authentication support.</p>
    </dd>
    <dt>-A <em>delay</em></dt>
    <dd>
  <p>Wait <em>delay</em> seconds after responding to DATA, then abort prematurely with a 550 reply status.  Do not read further input from the client; this is an attempt to block the client before it sends ".".  Specify a zero delay value to abort immediately.</p>
    </dd>
    <dt>-b <em>soft-bounce-reply</em></dt>
    <dd>
  <p>Use <em>soft-bounce-reply</em> for soft reject responses.  The default reply is "450 4.3.0 Error: command failed".</p>
    </dd>
    <dt>-B <em>hard-bounce-reply</em></dt>
    <dd>
  <p>Use <em>hard-bounce-reply</em> for hard reject responses.  The default reply is "500 5.3.0 Error: command failed".</p>
    </dd>
    <dt><strong>-c</strong></dt>
    <dd>
  <p>Display running counters that are updated whenever an SMTP session ends, a QUIT command is executed, or when "." is received.</p>
    </dd>
    <dt><strong>-C</strong></dt>
    <dd>
  <p>Disable XCLIENT support.</p>
    </dd>
    <dt>-d <em>dump-template</em></dt>
    <dd>
  <p>Dump each mail transaction to a single-message file whose name is created by expanding the <em>dump-template</em> via <a href="../man3/strftime.3.html"><strong>strftime</strong>(3)</a> and appending a pseudo-random hexadecimal number (example: "%Y%m%d%H/%M." expands into "2006081203/05.809a62e3"). If the template contains "/" characters, missing directories are created automatically.  The message dump format is described below.</p>
<p class='spacer'>

  <p>Note: this option keeps one capture file open for every mail transaction in progress.</p>
    </dd>
    <dt>-D <em>dump-template</em></dt>
    <dd>
  <p>Append mail transactions to a multi-message dump file whose name is created by expanding the <em>dump-template</em> via <a href="../man3/strftime.3.html"><strong>strftime</strong>(3)</a>. If the template contains "/" characters, missing directories are created automatically.  The message dump format is described below.</p>
<p class='spacer'>

  <p>Note: this option keeps one capture file open for every mail transaction in progress.</p>
    </dd>
    <dt><strong>-e</strong></dt>
    <dd>
  <p>Do not announce ESMTP support.</p>
    </dd>
    <dt><strong>-E</strong></dt>
    <dd>
  <p>Do not announce ENHANCEDSTATUSCODES support.</p>
    </dd>
    <dt>-f <em>command,command,...</em></dt>
    <dd>
  <p>Reject the specified commands with a hard (5xx) error code. This option implies <strong>-p</strong>.</p>
<p class='spacer'>

  <p>Examples of commands are CONNECT, HELO, EHLO, LHLO, MAIL, RCPT, VRFY, DATA, ., RSET, NOOP, and QUIT. Separate command names by white space or commas, and use quotes to protect white space from the shell. Command names are case-insensitive.</p>
    </dd>
    <dt><strong>-F</strong></dt>
    <dd>
  <p>Disable XFORWARD support.</p>
    </dd>
    <dt>-h<em> hostname</em></dt>
    <dd>
  <p>Use <em>hostname</em> in the SMTP greeting, in the HELO response, and in the EHLO response. The default hostname is "smtp-sink".</p>
    </dd>
    <dt><strong>-L</strong></dt>
    <dd>
  <p>Enable LMTP instead of SMTP.</p>
    </dd>
    <dt>-m <em>count</em> (default: 256)</dt>
    <dd>
  <p>An upper bound on the maximal number of simultaneous connections that <strong>smtp-sink</strong> will handle. This prevents the process from running out of file descriptors. Excess connections will stay queued in the TCP/IP stack.</p>
    </dd>
    <dt>-M <em>count</em></dt>
    <dd>
  <p>Terminate after receiving <em>count</em> messages.</p>
    </dd>
    <dt>-n <em>count</em></dt>
    <dd>
  <p>Terminate after <em>count</em> sessions.</p>
    </dd>
    <dt><strong>-p</strong></dt>
    <dd>
  <p>Do not announce support for ESMTP command pipelining.</p>
    </dd>
    <dt><strong>-P</strong></dt>
    <dd>
  <p>Change the server greeting so that it appears to come through a CISCO PIX system. Implies <strong>-e</strong>.</p>
    </dd>
    <dt>-q <em>command,command,...</em></dt>
    <dd>
  <p>Disconnect (without replying) after receiving one of the specified commands.</p>
<p class='spacer'>

  <p>Examples of commands are CONNECT, HELO, EHLO, LHLO, MAIL, RCPT, VRFY, DATA, ., RSET, NOOP, and QUIT. Separate command names by white space or commas, and use quotes to protect white space from the shell. Command names are case-insensitive.</p>
    </dd>
    <dt>-Q <em>command,command,...</em></dt>
    <dd>
  <p>Send a 421 reply and disconnect after receiving one of the specified commands.</p>
<p class='spacer'>

  <p>Examples of commands are CONNECT, HELO, EHLO, LHLO, MAIL, RCPT, VRFY, DATA, ., RSET, NOOP, and QUIT. Separate command names by white space or commas, and use quotes to protect white space from the shell. Command names are case-insensitive.</p>
    </dd>
    <dt>-r <em>command,command,...</em></dt>
    <dd>
  <p>Reject the specified commands with a soft (4xx) error code. This option implies <strong>-p</strong>.</p>
<p class='spacer'>

  <p>Examples of commands are CONNECT, HELO, EHLO, LHLO, MAIL, RCPT, VRFY, DATA, ., RSET, NOOP, and QUIT. Separate command names by white space or commas, and use quotes to protect white space from the shell. Command names are case-insensitive.</p>
    </dd>
    <dt>-R <em>root-directory</em></dt>
    <dd>
  <p>Change the process root directory to the specified location. This option requires super-user privileges. See also the <strong>-u</strong> option.</p>
    </dd>
    <dt>-s <em>command,command,...</em></dt>
    <dd>
  <p>Log the named commands to syslogd.</p>
<p class='spacer'>

  <p>Examples of commands are CONNECT, HELO, EHLO, LHLO, MAIL, RCPT, VRFY, DATA, ., RSET, NOOP, and QUIT. Separate command names by white space or commas, and use quotes to protect white space from the shell. Command names are case-insensitive.</p>
    </dd>
    <dt><strong>-S start-string</strong></dt>
    <dd>
  <p>An optional string that is prepended to each message that is written to a dump file (see the dump file format description below). The following C escape sequences are supported: &#92;a (bell), &#92;b (backslace), &#92;f (formfeed), &#92;n (newline), &#92;r (carriage return), &#92;t (horizontal tab), &#92;v (vertical tab), &#92;<em>ddd</em> (up to three octal digits) and &#92;&#92; (the backslash character).</p>
    </dd>
    <dt>-t <em>timeout</em> (default: 100)</dt>
    <dd>
  <p>Limit the time for receiving a command or sending a response. The time limit is specified in seconds.</p>
    </dd>
    <dt>-T <em>windowsize</em></dt>
    <dd>
  <p>Override the default TCP window size. To work around broken TCP window scaling implementations, specify a value &gt; 0 and &lt; 65536.</p>
    </dd>
    <dt>-u <em>username</em></dt>
    <dd>
  <p>Switch to the specified user privileges after opening the network socket and optionally changing the process root directory. This option is required when the process runs with super-user privileges. See also the <strong>-R</strong> option.</p>
    </dd>
    <dt><strong>-v</strong></dt>
    <dd>
  <p>Show the SMTP conversations.</p>
    </dd>
    <dt>-w <em>delay</em></dt>
    <dd>
  <p>Wait <em>delay</em> seconds before responding to a DATA command.</p>
    </dd>
    <dt>-W <em>command:delay[:odds]</em></dt>
    <dd>
  <p>Wait <em>delay</em> seconds before responding to <em>command</em>. If <em>odds</em> is also specified (a number between 1-99 inclusive), wait for a random multiple of <em>delay</em>. The random multiplier is equal to the number of times the program needs to roll a dice with a range of 0..99 inclusive, before the dice produces a result greater than or equal to <em>odds</em>.</p>
    </dd>
    <dt>[<strong>inet:</strong>][<em>host</em>]:<em>port</em></dt>
    <dd>
  <p>Listen on network interface <em>host</em> (default: any interface) TCP port <em>port</em>. Both <em>host</em> and <em>port</em> may be specified in numeric or symbolic form.</p>
    </dd>
    <dt><strong>unix:</strong><em>pathname</em></dt>
    <dd>
  <p>Listen on the UNIX-domain socket at <em>pathname</em>.</p>
    </dd>
    <dt><em>backlog</em></dt>
    <dd>
  <p>The maximum length the queue of pending connections, as defined by the <a href="../man2/listen.2.html"><strong>listen</strong>(2)</a> system call.</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DUMP FILE FORMAT</h2>
        <div class="sectioncontent">

  <p>Each dumped message contains a sequence of text lines, terminated with the newline character. The sequence of information is as follows:</p>
  <dl class='dl-horizontal'>
    <dt>&bull;</dt>
    <dd>
  <p>The optional string specified with the <strong>-S</strong> option.</p>
    </dd>
    <dt>&bull;</dt>
    <dd>
  <p>The <strong>smtp-sink</strong> generated headers as documented below.</p>
    </dd>
    <dt>&bull;</dt>
    <dd>
  <p>The message header and body as received from the SMTP client.</p>
    </dd>
    <dt>&bull;</dt>
    <dd>
  <p>An empty line.</p>
    </dd>
  </dl>
<p class='spacer'>

  <p>The format of the <strong>smtp-sink</strong> generated headers is as follows:</p>
  <dl class='dl-horizontal'>
    <dt>X-Client-Addr: <em>text</em></dt>
    <dd>
  <p>The client IP address without enclosing []. An IPv6 address is prefixed with "ipv6:". This record is always present.</p>
    </dd>
    <dt>X-Client-Proto: <em>text</em></dt>
    <dd>
  <p>The client protocol: SMTP, ESMTP or LMTP. This record is always present.</p>
    </dd>
    <dt>X-Helo-Args: <em>text</em></dt>
    <dd>
  <p>The arguments of the last HELO or EHLO command before this mail delivery transaction. This record is present only if the client sent a recognizable HELO or EHLO command before the DATA command.</p>
    </dd>
    <dt>X-Mail-Args: <em>text</em></dt>
    <dd>
  <p>The arguments of the MAIL command that started this mail delivery transaction. This record is present exactly once.</p>
    </dd>
    <dt>X-Rcpt-Args: <em>text</em></dt>
    <dd>
  <p>The arguments of an RCPT command within this mail delivery transaction. There is one record for each RCPT command, and they are in the order as sent by the client.</p>
    </dd>
    <dt>Received: <em>text</em></dt>
    <dd>
      <p>A message header for compatibility with mail processing software. This three-line header marks the end of the headers provided by <strong>smtp-sink</strong>, and is formatted as follows:</p>
      <dl class='dl-horizontal'>
        <dt>from <em>helo ([addr])</em></dt>
        <dd>
      <p>The HELO or EHLO command argument and client IP address. If the client did not send HELO or EHLO, the client IP address is used instead.</p>
        </dd>
        <dt>by <em>host (smtp-sink) with proto id random;</em></dt>
        <dd>
      <p>The hostname specified with the <strong>-h</strong> option, the client protocol (see <strong>X-Client-Proto</strong> above), and the pseudo-random portion of the per-message capture file name.</p>
        </dd>
        <dt><em>time-stamp</em></dt>
        <dd>
      <p>A time stamp as defined in RFC 2822.</p>
        </dd>
      </dl>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<a href="../man1/smtp-source.1.html"><strong>smtp-source</strong>(1)</a>, SMTP/LMTP message generator</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE</h2>
        <div class="sectioncontent">

<p>The Secure Mailer license must be distributed with this software.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR(S)</h2>
        <div class="sectioncontent">

<pre>Wietse Venema
IBM T.J. Watson Research
P.O. Box 704
Yorktown Heights, NY 10598, USA</pre>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="sleep.1.html"><span aria-hidden="true">&larr;</span> sleep.1: delay for a specified amount of time</a></li>
   <li class="next"><a href="smtp-source.1.html">smtp-source.1: multi-threaded SMTP/LMTP test generator <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
