<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>nf2csv: Iptables to csv data</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Iptables to csv data">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="nf2csv (1) manual">
  <meta name="twitter:description" content="Iptables to csv data">
  <meta name="twitter:image" content="https://www.carta.tech/images/psad-nf2csv-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/nf2csv.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="nf2csv (1) manual" />
  <meta property="og:description" content="Iptables to csv data" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/psad-nf2csv-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">nf2csv<small> (1)</small></h1>
        <p class="lead">Iptables to csv data</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/nf2csv.1.html">
      <span itemprop="name">nf2csv: Iptables to csv data</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/psad/">
      <span itemprop="name">psad</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/nf2csv.1.html">
      <span itemprop="name">nf2csv: Iptables to csv data</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>nf2csv [options]</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>nf2csv</strong> Parses iptables log messages and generates comma-separate value formatted data. This is useful to provide input to the <strong>AfterGlow</strong> project (see http://afterglow.sourceforge.net) so iptables logs can be visualized graphically.  An interesting application of <strong>nf2csv</strong> and <strong>AfterGlow</strong> is to parse and visualize the iptables logfiles made available by the Honeynet project in their Scan of the Month challenges.  The Scan30 and Scan34 challenges (see http://www.honeynet.org/scans/scan30/ and http://www.honeynet.org/scans/scan34/) contain extensive iptables logfiles, and some graphical representations of these can be viewed here: http://www.cipherdyne.org/psad/honeynet/. The <strong>psad</strong> program also has the ability to generate CSV data from iptables logs with its <em>--CSV</em> mode.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-f</strong>, <strong>-\^-fields</strong>lt;tokens&gt;</p>
  </dt>
  <dd>
    <p>Specify the set of fields that should be printed from iptables log messages. The most common usage of this argument is <strong>SRC DST DPT</strong> to print the source and destination IP addresses, followed by the destination port number.  Available fields to print include: SRC, SPT, DST, DPT, PROTO, LEN, IN, TOS, TTL, SEQ, ID, TYPE, CODE (and these can also be referred to as src, dst, sp, dp, proto, ip_len, intf, tos, and ttl).  There are several additional fields that are not given specific tags within iptables log messages, and these can be included by specifying one of the following: flags, top_opts, ip_opts, chain, log_prefix, frag_bit, src_mac, dst_mac, and udp_len.  Each of these fields accepts a search criteria in the form of a numeric comparison, string match, or IP match.  See the EXAMPLES section below for more information.</p>
  </dd>
  <dt>
    <p><strong>-u</strong>, <strong>-\^-unique-lines</strong></p>
  </dt>
  <dd>
    <p>Only print unique output lines.  This can drastically reduce the output of <strong>nf2csv</strong> depending on the characteristics of the iptables logfile that is being parsed.</p>
  </dd>
  <dt>
    <p><strong>-m</strong>, <strong>-\^-max-lines</strong>lt;num&gt;</p>
  </dt>
  <dd>
    <p>Specify the maximum number of output lines <strong>nf2csv</strong> will generate.  This is useful for providing a limited set of data to AfterGlow in order to make visualizations more clear and less cluttered.</p>
  </dd>
  <dt>
    <p><strong>-r</strong>, <strong>-\^-regex</strong>lt;regex&gt;</p>
  </dt>
  <dd>
    <p>Specify a regular expression that must match against the entire iptables log message in order for it to be included within the CSV output.  This allows log messages to be included from the output with all of the flexibility of regular expressions. See the EXAMPLES section below for more information.</p>
  </dd>
  <dt>
    <p><strong>-n</strong>, <strong>-\^-neg-regex</strong>lt;regex&gt;</p>
  </dt>
  <dd>
    <p>Specify a regular expression that must not match against the iptables log message in order for it to be included within the CSV output.  This allows log messages to be excluded from the output with all of the flexibility of regular expressions. See the EXAMPLES section below for more information.</p>
  </dd>
  <dt>
    <p><strong>-s</strong>, <strong>-\^-start-line</strong>lt;line&gt;</p>
  </dt>
  <dd>
    <p>Specify the starting line where <strong>nf2csv</strong> begins to process iptables log data.  If you are processing a huge file with thousands of iptables log messages this option can be useful to parse a specific chunk of this data.  Also see the <em>--end-line</em> option below.</p>
  </dd>
  <dt>
    <p><strong>-e</strong>, <strong>-\^-end-line</strong>lt;line&gt;</p>
  </dt>
  <dd>
    <p>Specify the last line of iptables log data that <strong>nf2csv</strong> will parse.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>The following examples illustrate the command line arguments that could be supplied to <strong>nf2csv</strong> in a few situations:</p><p>Print source and destination IP addresses and the destination port number:</p><p><strong>$ nfcsv -f src dst dp</strong></p><p>Same as above, but now require that the source IP come from the 11.11.11.0/24 subnet:</p><p><strong>$ nfcsv -f src:11.11.11.0/24 dst dp</strong></p><p>Display instances of the MyDoom worm:</p><p><strong>$ nfcsv -f src dst dp:3127</strong></p><p>Display packets that have low TTL values:</p><p><strong>$ nfcsv -f src dst ttl:&lt;10</strong></p><p>Display all traffic to or from the host 11.11.11.67 (this sets up an OR condition between the src and dst fields):</p><p><strong>$ nfcsv -f src dst dp -r 11.11.11.67</strong></p><p>Display likely instances of Window Messanger popup spam attempts (note the use of the --regex argument to require minimal lengths on the UDP length field and source port, but the output contains the destination port of 1026):</p><p><strong>$ nfcsv -f src dst dp -r SPT=\d{4}.*LEN=[4-9]\d{2}</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO nf2csv&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/psad.8.html"><strong>psad</strong>(8)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Michael Rash &lt;mbr@cipherdyne.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Send bug reports to mbr@cipherdyne.org.  Suggestions and/or comments are always welcome as well.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DISTRIBUTION</h2>
        <div class="sectioncontent">
<p><strong>nf2csv</strong> is distributed with the psad project (http://www.cipherdyne.org/psad/) under the GNU General Public License (GPL), and the latest version may be downloaded from <strong>http://www.cipherdyne.org/</strong></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="nexp.1.html"><span aria-hidden="true">&larr;</span> nexp.1: A framework for crafting network packets and processing responses</a></li>
   <li class="next"><a href="nfc-anticol.1.html">nfc-anticol.1: Demonstration of nfc anti-collision command line tool based on libnfc <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
