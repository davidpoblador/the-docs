<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>jail.conf: Configuration for the fail2ban server</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Configuration for the fail2ban server">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="jail.conf (10) manual">
  <meta name="twitter:description" content="Configuration for the fail2ban server">
  <meta name="twitter:image" content="https://www.carta.tech/images/fail2ban-jail.conf-10.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man10/jail.conf.10.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="jail.conf (10) manual" />
  <meta property="og:description" content="Configuration for the fail2ban server" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/fail2ban-jail.conf-10.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">jail.conf<small> (10)</small></h1>
        <p class="lead">Configuration for the fail2ban server</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man10/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man10/jail.conf.10.html">
      <span itemprop="name">jail.conf: Configuration for the fail2ban server</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/fail2ban/">
      <span itemprop="name">fail2ban</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man10/jail.conf.10.html">
      <span itemprop="name">jail.conf: Configuration for the fail2ban server</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><em>fail2ban.conf fail2ban.d/*.conf fail2ban.local fail2ban.d/*.local</em></p><p><em>jail.conf jail.d/*.conf jail.local jail.d/*.local</em></p><p><em>action.d/*.conf action.d/*.local</em></p><p><em>filter.d/*.conf filter.d/*.local</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Fail2ban has four configuration file types:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>fail2ban.conf</em></p>
  </dt>
  <dd>
    <p>Fail2Ban global configuration (such as logging)</p>
  </dd>
  <dt>
    <p><em>filter.d/*.conf</em></p>
  </dt>
  <dd>
    <p>Filters specifying how to detect authentication failures</p>
  </dd>
  <dt>
    <p><em>action.d/*.conf</em></p>
  </dt>
  <dd>
    <p>Actions defining the commands for banning and unbanning of IP address</p>
  </dd>
  <dt>
    <p><em>jail.conf</em></p>
  </dt>
  <dd>
    <p>Jails defining combinations of Filters with Actions.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION FILES FORMAT</h2>
        <div class="sectioncontent">
<p><em>*.conf</em> files are distributed by Fail2Ban.  It is recommended that *.conf files should remain unchanged to ease upgrades.  If needed, customizations should be provided in <em>*.local</em> files.  For example, if you would like to enable the [ssh-iptables-ipset] jail specified in jail.conf, create jail.local containing</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>jail.local</em></p>
  </dt>
  <dd>
    <p>[ssh-iptables-ipset]</p><p>enabled = true</p>
  </dd>

</dl>
<p>In .local files specify only the settings you would like to change and the rest of the configuration will then come from the corresponding .conf file which is parsed first.</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>jail.d/</em> and <em>fail2ban.d/</em></p>
  </dt>
  <dd>
    <p>In addition to .local, for jail.conf or fail2ban.conf file there can be a corresponding <em>.d/</em> directory containing additional .conf files. The order e.g. for <em>jail</em> configuration would be:</p><p>jail.conf</p><p>jail.d/*.conf (in alphabetical order)</p><p>jail.local</p><p>jail.d/*.local (in alphabetical order).</p><p>i.e. all .local files are parsed after .conf files in the original configuration file and files under .d directory.  Settings in the file parsed later take precedence over identical entries in previously parsed files.  Files are ordered alphabetically, e.g.</p><p><em>fail2ban.d/01_custom_log.conf</em> - to use a different log path</p><p><em>jail.d/01_enable.conf</em> - to enable a specific jail</p><p><em>jail.d/02_custom_port.conf</em> - to change the port(s) of a jail.</p>
  </dd>

</dl>
<p>Configuration files have sections, those specified with [section name], and name = value pairs. For those name items that can accept multiple values, specify the values separated by spaces, or in separate lines space indented at the beginning of the line before the second value.</p><p>Configuration files can include other (defining common variables) configuration files, which is often used in Filters and Actions. Such inclusions are defined in a section called [INCLUDES]:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>before</strong></p>
  </dt>
  <dd>
    <p>indicates that the specified file is to be parsed before the current file.</p>
  </dd>
  <dt>
    <p><strong>after</strong></p>
  </dt>
  <dd>
    <p>indicates that the specified file is to be parsed after the current file.</p>
  </dd>

</dl>
<p>Using Python "string interpolation" mechanisms, other definitions are allowed and can later be used within other definitions as %(name)s. For example.</p><p>baduseragents = IE|wget</p><p>failregex = useragent=%(baduseragents)s</p><p>Comments: use '#' for comment lines and '; ' (space is important) for inline comments. When using Python2.X '; ' can only be used on the first line due to an Python library bug.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FAIL2BAN CONFIGURATION FILE(S) (\fIfail2ban.conf\fB)</h2>
        <div class="sectioncontent">
<p>These files have one section, [Definition].</p><p>The items that can be set are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>loglevel</strong></p>
  </dt>
  <dd>
    <p>verbosity level of log output: 1 = ERROR, 2 = WARN, 3 = INFO, 4 = DEBUG. Default: 1</p>
  </dd>
  <dt>
    <p><strong>logtarget</strong></p>
  </dt>
  <dd>
    <p>log target: filename, SYSLOG, STDERR or STDOUT. Default: STDERR . Only a single log target can be specified. If you change logtarget from the default value and you are using logrotate -- also adjust or disable rotation in the corresponding configuration file (e.g. /etc/logrotate.d/fail2ban on Debian systems).</p>
  </dd>
  <dt>
    <p><strong>socket</strong></p>
  </dt>
  <dd>
    <p>socket filename.  Default: /var/run/fail2ban/fail2ban.sock . This is used for communication with the fail2ban server daemon. Do not remove this file when Fail2ban is running. It will not be possible to communicate with the server afterwards.</p>
  </dd>
  <dt>
    <p><strong>pidfile</strong></p>
  </dt>
  <dd>
    <p>PID filename.  Default: /var/run/fail2ban/fail2ban.pid. This is used to store the process ID of the fail2ban server.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">JAIL CONFIGURATION FILE(S) (\fIjail.conf\fB)</h2>
        <div class="sectioncontent">
<p>The following options are applicable to any jail. They appear in a section specifying the jail name or in the <em>[DEFAULT]</em> section which defines default values to be used if not specified in the individual section.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>filter</strong></p>
  </dt>
  <dd>
    <p>name of the filter -- filename of the filter in /etc/fail2ban/filter.d/ without the .conf/.local extension. Only one filter can be specified.</p>
  </dd>
  <dt>
    <p><strong>logpath</strong></p>
  </dt>
  <dd>
    <p>filename(s) of the log files to be monitored. Globs -- paths containing * and ? or [0-9] -- can be used however only the files that exist at start up matching this glob pattern will be considered.</p><p>Ensure syslog or the program that generates the log file isn't configured to compress repeated log messages to "<em>*last message repeated 5 time*s</em>" otherwise it will fail to detect. This is called <em>RepeatedMsgReduction</em> in rsyslog and should be <em>Off</em>.</p>
  </dd>
  <dt>
    <p><strong>action</strong></p>
  </dt>
  <dd>
    <p>action(s) from <em>/etc/fail2ban/action.d/</em> without the <em>.conf</em>/<em>.local</em> extension. Arguments can be passed to actions to override the default values from the [Init] section in the action file. Arguments are specified by:</p><p>[name=value,name2=value,name3="values,values"]</p><p>Values can also be quoted (required when value includes a ","). More that one action can be specified (in separate lines).</p>
  </dd>
  <dt>
    <p><strong>ignoreip</strong></p>
  </dt>
  <dd>
    <p>list of IPs not to ban. They can include a CIDR mask too.</p>
  </dd>
  <dt>
    <p><strong>ignorecommand</strong></p>
  </dt>
  <dd>
    <p>command that is executed to determine if the current candidate IP for banning should not be banned. IP will not be banned if command returns successfully (exit code 0). Like ACTION FILES, tags like &lt;ip&gt; are can be included in the ignorecommand value and will be substituted before execution. Currently only &lt;ip&gt; is supported however more will be added later.</p>
  </dd>
  <dt>
    <p><strong>bantime</strong></p>
  </dt>
  <dd>
    <p>effective ban duration (in seconds).</p>
  </dd>
  <dt>
    <p><strong>findtime</strong></p>
  </dt>
  <dd>
    <p>time interval (in seconds) before the current time where failures will count towards a ban.</p>
  </dd>
  <dt>
    <p><strong>maxretry</strong></p>
  </dt>
  <dd>
    <p>number of failures that have to occur in the last <strong>findtime</strong> seconds to ban then IP.</p>
  </dd>
  <dt>
    <p><strong>backend</strong></p>
  </dt>
  <dd>
    <p>backend to be used to detect changes in the logpath. It defaults to "auto" which will try "pyinotify", "gamin" before "polling". Any of these can be specified. "pyinotify" is only valid on Linux systems with the "pyinotify" Python libraries. "gamin" requires the "gamin" libraries.</p>
  </dd>
  <dt>
    <p><strong>usedns</strong></p>
  </dt>
  <dd>
    <p>use DNS to resolve HOST names that appear in the logs. By default it is "warn" which will resolve hostnames to IPs however it will also log a warning. If you are using DNS here you could be blocking the wrong IPs due to the asymmetric nature of reverse DNS (that the application used to write the domain name to log) compared to forward DNS that fail2ban uses to resolve this back to an IP (but not necessarily the same one). Ideally you should configure your applications to log a real IP. This can be set to "yes" to prevent warnings in the log or "no" to disable DNS resolution altogether (thus ignoring entries where hostname, not an IP is logged)..</p>
  </dd>
  <dt>
    <p><strong>failregex</strong></p>
  </dt>
  <dd>
    <p>regex (Python <strong>reg</strong>ular <strong>ex</strong>pression) to be added to the filter's failregexes. If this is useful for others using your application please share you regular expression with the fail2ban developers by reporting an issue (see REPORTING BUGS below).</p>
  </dd>
  <dt>
    <p><strong>ignoreregex</strong></p>
  </dt>
  <dd>
    <p>regex which, if the log line matches, would cause Fail2Ban not consider that line.  This line will be ignored even if it matches a failregex of the jail or any of its filters.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ACTION CONFIGURATION FILES (\fIaction.d/*.conf\fB)</h2>
        <div class="sectioncontent">
<p>Action files specify which commands are executed to ban and unban an IP address.</p><p>Like with jail.conf files, if you desire local changes create an <em>[actionname].local</em> file in the <em>/etc/fail2ban/action.d</em> directory and override the required settings.</p><p>Action files have two sections, <strong>Definition</strong> and <strong>Init</strong> .</p><p>The [Init] section enables action-specific settings. In <em>jail.conf/jail.local</em> these can be overridden for a particular jail as options of the action's specification in that jail.</p><p>The following commands can be present in the [Definition] section.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>actionstart</strong></p>
  </dt>
  <dd>
    <p>command(s) executed when the jail starts.</p>
  </dd>
  <dt>
    <p><strong>actionstop</strong></p>
  </dt>
  <dd>
    <p>command(s) executed when the jail stops.</p>
  </dd>
  <dt>
    <p><strong>actioncheck</strong></p>
  </dt>
  <dd>
    <p>command(s) ran before any other action. It aims to verify if the environment is still ok.</p>
  </dd>
  <dt>
    <p><strong>actionban</strong></p>
  </dt>
  <dd>
    <p>command(s) that bans the IP address after <strong>maxretry</strong> log lines matches within last <strong>findtime</strong> seconds.</p>
  </dd>
  <dt>
    <p><strong>actionunban</strong></p>
  </dt>
  <dd>
    <p>command(s) that unbans the IP address after <strong>bantime</strong>.</p>
  </dd>

</dl>
<p>Commands specified in the [Definition] section are executed through a system shell so shell redirection and process control is allowed. The commands should return 0, otherwise error would be logged.  Moreover if <strong>actioncheck</strong> exits with non-0 status, it is taken as indication that firewall status has changed and fail2ban needs to reinitialize itself (i.e. issue <strong>actionstop</strong> and <strong>actionstart</strong> commands).</p><p>Tags are enclosed in &lt;&gt;.  All the elements of [Init] are tags that are replaced in all action commands.  Tags can be added by the <strong>fail2ban-client</strong> using the setctag command. <strong>&lt;br&gt;</strong> is a tag that is always a new line (&#92;n).</p><p>More than a single command is allowed to be specified. Each command needs to be on a separate line and indented with whitespace(s) without blank lines. The following example defines two commands to be executed.</p><p> actionban = iptables -I fail2ban-&lt;name&gt; --source &lt;ip&gt; -j DROP</p>
<pre>
             echo ip=&lt;ip&gt;, match=&lt;match&gt;, time=&lt;time&gt; &gt;&gt; /var/log/fail2ban.log
</pre>
<h3>Action Tags</h3>
<p>The following tags are substituted in the actionban, actionunban and actioncheck (when called before actionban/actionunban) commands.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>ip</strong></p>
  </dt>
  <dd>
    <p>IPv4 IP address to be banned. e.g. 192.168.0.2</p>
  </dd>
  <dt>
    <p><strong>failures</strong></p>
  </dt>
  <dd>
    <p>number of times the failure occurred in the log file. e.g. 3</p>
  </dd>
  <dt>
    <p><strong>time</strong></p>
  </dt>
  <dd>
    <p>UNIX (epoch) time of the ban. e.g. 1357508484</p>
  </dd>
  <dt>
    <p><strong>matches</strong></p>
  </dt>
  <dd>
    <p>concatenated string of the log file lines of the matches that generated the ban. Many characters interpreted by shell get escaped to prevent injection, nevertheless use with caution.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILTER FILES (\fIfilter.d/*.conf\fB)</h2>
        <div class="sectioncontent">
<p>Filter definitions are those in <em>/etc/fail2ban/filter.d/*.conf</em> and <em>filter.d/*.local</em>.</p><p>These are used to identify failed authentication attempts in log files and to extract the host IP address (or hostname if <strong>usedns</strong> is <strong>true</strong>).</p><p>Like action files, filter files are ini files. The main section is the [Definition] section.</p><p>There are two filter definitions used in the [Definition] section:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>failregex</strong></p>
  </dt>
  <dd>
    <p>regex  that will match failed attempts. The tag &lt;HOST&gt; is used as part of the regex and is itself a regex for IPv4 addresses (and hostnames if <strong>usedns</strong>). Fail2Ban will work out which one of these it actually is.</p>
  </dd>
  <dt>
    <p><strong>ignoreregex</strong></p>
  </dt>
  <dd>
    <p>regex to identify log entries that should be ignored by Fail2Ban, even if they match failregex.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Fail2ban was originally written by Cyril Jaquier &lt;cyril.jaquier@fail2ban.org&gt;. At the moment it is maintained and further developed by Yaroslav O. Halchenko &lt;debian@onerussian.com&gt;, Daniel Black &lt;daniel.subs@internode.on.net&gt; and Steven Hiscocks &lt;steven-fail2ban@hiscocks.me.uk&gt; along with a number of contributors.  See <strong>THANKS</strong> file shipped with Fail2Ban for a full list. Manual page written by Daniel Black and Yaroslav Halchenko.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">
<p>Report bugs to https://github.com/fail2ban/fail2ban/issues</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2013 the Fail2Ban Team</p><p>Copyright of modifications held by their respective authors.</p><p>Licensed under the GNU General Public License v2 (GPL) or (at your option) any later version.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO jail.conf&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/fail2ban-server.1.html"><strong>fail2ban-server</strong>(1)</a></p>
        </div>
      </section>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
