<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>tcptraceroute.mt: A traceroute implementation using tcp packets</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A traceroute implementation using tcp packets">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="tcptraceroute.mt (1) manual">
  <meta name="twitter:description" content="A traceroute implementation using tcp packets">
  <meta name="twitter:image" content="https://www.carta.tech/images/tcptraceroute-tcptraceroute.mt-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/tcptraceroute.mt.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="tcptraceroute.mt (1) manual" />
  <meta property="og:description" content="A traceroute implementation using tcp packets" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/tcptraceroute-tcptraceroute.mt-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">tcptraceroute.mt<small> (1)</small></h1>
        <p class="lead">A traceroute implementation using tcp packets</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/tcptraceroute.mt.1.html">
      <span itemprop="name">tcptraceroute.mt: A traceroute implementation using tcp packets</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/tcptraceroute/">
      <span itemprop="name">tcptraceroute</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/tcptraceroute.mt.1.html">
      <span itemprop="name">tcptraceroute.mt: A traceroute implementation using tcp packets</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>tcptraceroute [-nNFSAE] [ -i</strong> <em>interface</em> <strong>] [ -f</strong> <em>first ttl</em> <strong>]</strong></p><p><strong>[ -l</strong> <em>length</em> <strong>] [ -q</strong> <em>number of queries</em> <strong>] [ -t</strong> <em>tos</em> <strong>]</strong></p><p><strong>[ -m</strong> <em>max ttl</em> <strong>] [ -p</strong> <em>source port</em> <strong>] [ -s</strong> <em>source address</em> <strong>]</strong></p><p><strong>[ -w</strong> <em>wait time</em> <strong>]</strong> <em>host</em> <strong>[</strong> <em>destination port</em> <strong>]</strong> <strong>[</strong> <em>length</em> <strong>]</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>tcptraceroute</strong> is a traceroute implementation using TCP packets.</p><p>The more traditional <strong>traceroute</strong>(8) sends out either UDP or ICMP ECHO packets with a TTL of one, and increments the TTL until the destination has been reached.  By printing the gateways that generate ICMP time exceeded messages along the way, it is able to determine the path packets are taking to reach the destination.</p><p>The problem is that with the widespread use of firewalls on the modern Internet, many of the packets that <strong>traceroute</strong>(8) sends out end up being filtered, making it impossible to completely trace the path to the destination.  However, in many cases, these firewalls will permit inbound TCP packets to specific ports that hosts sitting behind the firewall are listening for connections on.  By sending out TCP SYN packets instead of UDP or ICMP ECHO packets, <strong>tcptraceroute</strong> is able to bypass the most common firewall filters.</p><p>It is worth noting that <strong>tcptraceroute</strong> never completely establishes a TCP connection with the destination host. If the host is not listening for incoming connections, it will respond with an RST indicating that the port is closed.  If the host instead responds with a SYN|ACK, the port is known to be open, and an RST is sent by the kernel <strong>tcptraceroute</strong> is running on to tear down the connection without completing three-way handshake.  This is the same half-open scanning technique that <a href="../man1/nmap.1.html"><strong>nmap</strong>(1)</a> uses when passed the <strong>-sS</strong> flag.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p><strong></strong></p>
<dl class='dl-vertical'>
  <dt>
    -n
  </dt>
  <dd>
    <p>Display numeric output, rather than doing a reverse DNS lookup for each hop. By default, reverse lookups are never attempted on RFC1918 address space, regardless of the -n flag. <strong></strong></p>
  </dd>
  <dt>
    -N
  </dt>
  <dd>
    <p>Perform a reverse DNS lookup for each hop, including RFC1918 addresses. <strong></strong></p>
  </dd>
  <dt>
    -f
  </dt>
  <dd>
    <p>Set the initial TTL used in the first outgoing packet.  The default is 1. <strong></strong></p>
  </dd>
  <dt>
    -m
  </dt>
  <dd>
    <p>Set the maximum TTL used in outgoing packets.  The default is 30. <strong></strong></p>
  </dd>
  <dt>
    -p
  </dt>
  <dd>
    <p>Use the specified local TCP port in outgoing packets.  The default is to obtain a free port from the kernel using <a href="../man2/bind.2.html"><strong>bind</strong>(2)</a>. Unlike with traditional <strong>traceroute</strong>(8), this number will not increase with each hop. <strong></strong></p>
  </dd>
  <dt>
    -s
  </dt>
  <dd>
    <p>Set the source address for outgoing packets.  See also the -i flag. <strong></strong></p>
  </dd>
  <dt>
    -i
  </dt>
  <dd>
    <p>Use the specified interface for outgoing packets. <strong></strong></p>
  </dd>
  <dt>
    -q
  </dt>
  <dd>
    <p>Set the number of probes to be sent to each hop.  The default is 3. <strong></strong></p>
  </dd>
  <dt>
    -w
  </dt>
  <dd>
    <p>Set the timeout, in seconds, to wait for a response for each probe.  The default is 3. <strong></strong></p>
  </dd>
  <dt>
    -S
  </dt>
  <dd>
    <p>Set the TCP SYN flag in outgoing packets.  This is the default, if neither -S or -A is specified. <strong></strong> <strong></strong></p>
  </dd>
  <dt>
    -A
  </dt>
  <dd>
    <p>Set the TCP ACK flag in outgoing packets.  By doing so, it is possible to trace through stateless firewalls which permit outgoing TCP connections. <strong></strong></p>
  </dd>
  <dt>
    -E
  </dt>
  <dd>
    <p>Send ECN SYN packets, as described in RFC2481. <strong></strong></p>
  </dd>
  <dt>
    -t
  </dt>
  <dd>
    <p>Set the IP TOS (type of service) to be used in outgoing packets.  The default is not to set any TOS. <strong></strong></p>
  </dd>
  <dt>
    -F
  </dt>
  <dd>
    <p>Set the IP "don't fragment" bit in outgoing packets. <strong></strong></p>
  </dd>
  <dt>
    -l
  </dt>
  <dd>
    <p>Set the total packet length to be used in outgoing packets.  If the length is greater than the minimum size required to assemble the necessary probe packet headers, this value is automatically increased. <strong></strong></p>
  </dd>
  <dt>
    -d
  </dt>
  <dd>
    <p>Enable debugging, which may or may not be useful. <strong></strong></p>
  </dd>
  <dt>
    --dnat
  </dt>
  <dd>
    <p>Enable DNAT detection, and display messages when DNAT transitions are observed.  DNAT detection is based on the fact that some NAT devices, such as some Linux 2.4 kernels, do not correctly rewrite the IP address of the IP packets quoted in ICMP time-exceeded messages tcptraceroute solicits, revealing the destination IP address an outbound probe packet was NATed to.  NAT devices which correctly rewrite the IP address quoted by ICMP messages, such as some Linux 2.6 kernels, will not be detected.  For some target hosts, it may be necessary to use --dnat in conjunction with --track-port.  See the examples.txt file for examples. <strong></strong></p>
  </dd>
  <dt>
    --no-dnat
  </dt>
  <dd>
    <p>Enable DNAT detection for the purposes of correctly identifying ICMP time-exceeded messages that match up with outbound probe packets, but do not display messages when a DNAT transition is observed.  This is the default behavior. <strong></strong></p>
  </dd>
  <dt>
    --no-dnat-strict
  </dt>
  <dd>
    <p>Do not perform any DNAT detection whatsoever.  No attempt will be made match up ICMP time-exceeded messages with outbound probe packets, and when tracerouting through a NAT device which does not rewrite the IP addresses of the IP packets quoted in ICMP time-exceeded messages, some hops along the path may appear to be unresponsive.  This option should not be needed in the vast majority of cases, but may be utilized if it is suspected that the DNAT detection code is misidentifying ICMP time-exceeded messages.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Please see the <em>examples.txt</em> file included in the <strong>tcptraceroute</strong> distribution for a few real world examples.</p><p>To trace the path to a web server listening for connections on port 80:</p><p><strong>tcptraceroute webserver</strong></p><p>To trace the path to a mail server listening for connections on port 25:</p><p><strong>tcptraceroute mailserver 25</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>No error checking is performed on the source address specified by the -s flag, and it is therefore possible for <strong></strong> tcptraceroute to send out TCP SYN packets for which it has no chance of seeing a response to.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Michael C. Toren &lt;mct@toren.net&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AVAILABILITY</h2>
        <div class="sectioncontent">
<p>For updates, please see:</p><p>http://michael.toren.net/code/tcptraceroute/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO tcptraceroute.mt&hellip;</h2>
        <div class="sectioncontent">
<p><strong>traceroute</strong>(8), <a href="../man8/ping.8.html"><strong>ping</strong>(8)</a>, <a href="../man1/nmap.1.html"><strong>nmap</strong>(1)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="tcptrace.1.html"><span aria-hidden="true">&larr;</span> tcptrace.1: A tcp connection analysis tool</a></li>
   <li class="next"><a href="tcptrack.1.html">tcptrack.1: Monitor tcp connections on the network <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
