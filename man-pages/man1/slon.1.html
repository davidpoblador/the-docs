<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>slon: Slony-i daemon</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Slony-i daemon">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="slon (1) manual">
  <meta name="twitter:description" content="Slony-i daemon">
  <meta name="twitter:image" content="https://www.carta.tech/images/slony1-2-bin-slon-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/slon.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="slon (1) manual" />
  <meta property="og:description" content="Slony-i daemon" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/slony1-2-bin-slon-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">slon<small> (1)</small></h1>
        <p class="lead">Slony-i daemon</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/slon.1.html">
      <span itemprop="name">slon: Slony-i daemon</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/slony1-2-bin/">
      <span itemprop="name">slony1-2-bin</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/slon.1.html">
      <span itemprop="name">slon: Slony-i daemon</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>slon</strong> \kx [<em>option</em>]... [<em>clustername</em>] [<em>conninfo</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>slon is the daemon application that \(oqruns\(cq Slony-I replication. A slon instance must be run for each node in a Slony-I cluster.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>\*(T&lt;<strong>-d</strong>\*(T&gt;<em> log_level</em></p>
  </dt>
  <dd>
    <p>The <strong>log_level</strong> specifies which levels of debugging messages slon should display when logging its activity.</p><p>The nine levels of logging are:</p>
<dl class='dl-vertical'>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>Fatal</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>Error</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>Warn</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>Config</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>Info</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>Debug1</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>Debug2</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>Debug3</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>Debug4</p>
  </dd>

</dl>
<p>The first five non-debugging log levels (from Fatal to Info) are <em>always</em> displayed in the logs. In early versions of Slony-I, the \(oqsuggested\(cq <strong>log_level</strong> value was 2, which would list output at all levels down to debugging level 2. In Slony-I version 2, it is recommended to set <strong>log_level</strong> to 0; most of the consistently interesting log information is generated at levels higher than that.</p>
  </dd>
  <dt>
    <p>\*(T&lt;<strong>-s</strong>\*(T&gt;<em> SYNC check interval</em></p>
  </dt>
  <dd>
    <p>The <strong>sync_interval</strong>, measured in milliseconds, indicates how often slon should check to see if a <strong>SYNC</strong> should be introduced. Default is 2000 ms. The main loop in \*(T&lt;<strong>sync_Thread_main()</strong>\*(T&gt; sleeps for intervals of <strong>sync_interval</strong> milliseconds between iterations.</p><p>Short sync check intervals keep the origin on a \(oqshort leash\(cq, updating its subscribers more frequently. If you have replicated sequences that are frequently updated <em>without</em> there being tables that are affected, this keeps there from being times when only sequences are updated, and therefore <em>no</em> syncs take place</p><p>If the node is not an origin for any replication set, so no updates are coming in, it is somewhat wasteful for this value to be much less the <strong>sync_interval_timeout</strong> value.</p>
  </dd>
  <dt>
    <p>\*(T&lt;<strong>-t</strong>\*(T&gt;<em> SYNC interval timeout</em></p>
  </dt>
  <dd>
    <p>At the end of each <strong>sync_interval_timeout</strong> timeout period, a <strong>SYNC</strong> will be generated on the \(oqlocal\(cq node even if there has been no replicable data updated that would have caused a <strong>SYNC</strong> to be generated.</p><p>If application activity ceases, whether because the application is shut down, or because human users have gone home and stopped introducing updates, the <a href="../man1/slon.1.html"><strong>slon</strong>(1)</a> will iterate away, waking up every <strong>sync_interval</strong> milliseconds, and, as no updates are being made, no <strong>SYNC</strong> events would be generated. Without this timeout parameter, <em>no</em> <strong>SYNC</strong> events would be generated, and it would appear that replication was falling behind.</p><p>The <strong>sync_interval_timeout</strong> value will lead to eventually generating a <strong>SYNC</strong>, even though there was no real replication work to be done. The lower that this parameter is set, the more frequently <a href="../man1/slon.1.html"><strong>slon</strong>(1)</a> will generate <strong>SYNC</strong> events when the application is not generating replicable activity; this will have two effects:</p>
<dl class='dl-vertical'>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>The system will do more replication work.</p><p>(Of course, since there is no application load on the database, and no data to replicate, this load will be very easy to handle.</p>
  </dd>
  <dt>
    <p>&bull;</p>
  </dt>
  <dd>
    <p>Replication will appear to be kept more \(oqup to date.\(cq</p><p>(Of course, since there is no replicable activity going on, being \(oqmore up to date\(cq is something of a mirage.)</p>
  </dd>

</dl>
<p>Default is 10000 ms and maximum is 120000 ms. By default, you can expect each node to \(oqreport in\(cq with a <strong>SYNC</strong> every 10 seconds.</p><p>Note that <strong>SYNC</strong> events are also generated on subscriber nodes. Since they are not actually generating any data to replicate to other nodes, these <strong>SYNC</strong> events are of not terribly much value.</p>
  </dd>
  <dt>
    <p>\*(T&lt;<strong>-g</strong>\*(T&gt;<em> group size</em></p>
  </dt>
  <dd>
    <p>This controls the maximum <strong>SYNC</strong> group size, <strong>sync_group_maxsize</strong>; defaults to 6. Thus, if a particular node is behind by 200 <strong>SYNC</strong>s, it will try to group them together into groups of a maximum size of <strong>sync_group_maxsize</strong>. This can be expected to reduce transaction overhead due to having fewer transactions to <strong>COMMIT</strong>.</p><p>The default of 6 is probably suitable for small systems that can devote only very limited bits of memory to slon. If you have plenty of memory, it would be reasonable to increase this, as it will increase the amount of work done in each transaction, and will allow a subscriber that is behind by a lot to catch up more quickly.</p><p>Slon processes usually stay pretty small; even with large value for this option, slon would be expected to only grow to a few MB in size.</p><p>The big advantage in increasing this parameter comes from cutting down on the number of transaction <strong>COMMIT</strong>s; moving from 1 to 2 will provide considerable benefit, but the benefits will progressively fall off once the transactions being processed get to be reasonably large. There isn't likely to be a material difference in performance between 80 and 90; at that point, whether \(oqbigger is better\(cq will depend on whether the bigger set of <strong>SYNC</strong>s makes the <strong>LOG</strong> cursor behave badly due to consuming more memory and requiring more time to sortt.</p><p>In Slony-I version 1.0, slon will always attempt to group <strong>SYNC</strong>s together to this maximum, which <em>won't</em> be ideal if replication has been somewhat destabilized by there being very large updates (<em>e.g.</em> - a single transaction that updates hundreds of thousands of rows) or by <strong>SYNC</strong>s being disrupted on an origin node with the result that there are a few <strong>SYNC</strong>s that are very large. You might run into the problem that grouping together some very large <strong>SYNC</strong>s knocks over a slon process. When it picks up again, it will try to process the same large grouped set of <strong>SYNC</strong>s, and run into the same problem over and over until an administrator interrupts this and changes the \*(T&lt;<strong>-g</strong>\*(T&gt; value to break this \(oqdeadlock.\(cq</p><p>In Slony-I version 1.1 and later versions, the slon instead adaptively \(oqramps up\(cq from doing 1 <strong>SYNC</strong> at a time towards the maximum group size. As a result, if there are a couple of <strong>SYNC</strong>s that cause problems, the slon will (with any relevant watchdog assistance) always be able to get to the point where it processes the troublesome <strong>SYNC</strong>s one by one, hopefully making operator assistance unnecessary.</p>
  </dd>
  <dt>
    <p>\*(T&lt;<strong>-o</strong>\*(T&gt;<em> desired sync time</em></p>
  </dt>
  <dd>
    <p>A \(oqmaximum\(cq time planned for grouped <strong>SYNC</strong>s.</p><p>If replication is running behind, slon will gradually increase the numbers of <strong>SYNC</strong>s grouped together, targeting that (based on the time taken for the <em>last</em> group of <strong>SYNC</strong>s) they shouldn't take more than the specified <strong>desired_sync_time</strong> value.</p><p>The default value for <strong>desired_sync_time</strong> is 60000ms, equal to one minute.</p><p>That way, you can expect (or at least hope!) that you'll get a <strong>COMMIT</strong> roughly once per minute.</p><p>It isn't <em>totally</em> predictable, as it is entirely possible for someone to request a <em>very</em> large update, all as one transaction, that can \(oqblow up\(cq the length of the resulting <strong>SYNC</strong> to be nearly arbitrarily long. In such a case, the heuristic will back off for the <em>next</em> group.</p><p>The overall effect is to improve Slony-I's ability to cope with variations in traffic. By starting with 1 <strong>SYNC</strong>, and gradually moving to more, even if there turn out to be variations large enough to cause PostgreSQL backends to crash, Slony-I will back off down to start with one sync at a time, if need be, so that if it is at all possible for replication to progress, it will.</p>
  </dd>
  <dt>
    <p>\*(T&lt;<strong>-c</strong>\*(T&gt;<em> cleanup cycles</em></p>
  </dt>
  <dd>
    <p>The value <strong>vac_frequency</strong> indicates how often to <strong>VACUUM</strong> in cleanup cycles.</p><p>Set this to zero to disable slon-initiated vacuuming. If you are using something like pg_autovacuum to initiate vacuums, you may not need for slon to initiate vacuums itself. If you are not, there are some tables Slony-I uses that collect a <em>lot</em> of dead tuples that should be vacuumed frequently, notably <strong>pg_listener</strong>.</p><p>In Slony-I version 1.1, this changes a little; the cleanup thread tracks, from iteration to iteration, the earliest transaction ID still active in the system. If this doesn't change, from one iteration to the next, then an old transaction is still active, and therefore a <strong>VACUUM</strong> will do no good. The cleanup thread instead merely does an <strong>ANALYZE</strong> on these tables to update the statistics in <strong>pg_statistics</strong>.</p>
  </dd>
  <dt>
    <p>\*(T&lt;<strong>-p</strong>\*(T&gt;<em> PID filename</em></p>
  </dt>
  <dd>
    <p><strong>pid_file</strong> contains the filename in which the PID (process ID) of the slon is stored.</p><p>This may make it easier to construct scripts to monitor multiple slon processes running on a single host.</p>
  </dd>
  <dt>
    <p>\*(T&lt;<strong>-f</strong>\*(T&gt;<em> config file</em></p>
  </dt>
  <dd>
    <p>File from which to read slon configuration.</p><p>This configuration is discussed further in Slon Run-time Configuration [&ldquo;Run-time Configuration&rdquo; [not available as a man page]]. If there are to be a complex set of configuration parameters, or if there are parameters you do not wish to be visible in the process environment variables (such as passwords), it may be convenient to draw many or all parameters from a configuration file. You might either put common parameters for all slon processes in a commonly-used configuration file, allowing the command line to specify little other than the connection info. Alternatively, you might create a configuration file for each node.</p>
  </dd>
  <dt>
    <p>\*(T&lt;<strong>-a</strong>\*(T&gt;<em> archive directory</em></p>
  </dt>
  <dd>
    <p><strong>archive_dir</strong> indicates a directory in which to place a sequence of <strong>SYNC</strong> archive files for use in log shipping [&ldquo;Log Shipping - Slony-I with Files&rdquo; [not available as a man page]] mode.</p>
  </dd>
  <dt>
    <p>\*(T&lt;<strong>-x</strong>\*(T&gt;<em> command to run on log archive</em></p>
  </dt>
  <dd>
    <p><strong>command_on_logarchive</strong> indicates a command to be run each time a SYNC file is successfully generated.</p><p>See more details on &ldquo;slon_conf_command_on_log_archive&rdquo; [not available as a man page].</p>
  </dd>
  <dt>
    <p>\*(T&lt;<strong>-q</strong>\*(T&gt;<em> quit based on SYNC provider </em></p>
  </dt>
  <dd>
    <p><strong>quit_sync_provider</strong> indicates which provider's worker thread should be watched in order to terminate after a certain event. This must be used in conjunction with the \*(T&lt;<strong>-r</strong>\*(T&gt; option below...</p><p>This allows you to have a slon stop replicating after a certain point.</p>
  </dd>
  <dt>
    <p>\*(T&lt;<strong>-r</strong>\*(T&gt;<em> quit at event number </em></p>
  </dt>
  <dd>
    <p><strong>quit_sync_finalsync</strong> indicates the event number after which the remote worker thread for the provider above should terminate. This must be used in conjunction with the \*(T&lt;<strong>-q</strong>\*(T&gt; option above...</p>
  </dd>
  <dt>
    <p>\*(T&lt;<strong>-l</strong>\*(T&gt;<em> lag interval </em></p>
  </dt>
  <dd>
    <p><strong>lag_interval</strong> indicates an interval value such as <strong>3 minutes </strong>or <strong>4 hours </strong> or <strong>2 days </strong>that indicates that this node is to lag its providers by the specified interval of time. This causes events to be ignored until they reach the age corresponding to the interval.</p><p><strong>Warning</strong></p><p>There is a concommittant downside to this lag; events that require all nodes to synchronize, as typically happens with <strong>SLONIK <strong>FAILOVER</strong>(7)</strong> and <strong>SLONIK MOVE <a href="../man7/SET.7.html"><strong>SET</strong>(7)</a></strong>, will have to wait for this lagging node.</p><p>That might not be ideal behaviour at failover time, or at the time when you want to run <strong>SLONIK EXECUTE <strong>SCRIPT</strong>(7)</strong>.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">
<p>slon returns 0 to the shell if it finished normally. It returns via \*(T&lt;<strong>exit(-1)</strong>\*(T&gt; (which will likely provide a return value of either 127 or 255, depending on your system) if it encounters any fatal error.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="slock.1.html"><span aria-hidden="true">&larr;</span> slock.1: Simple screen locker</a></li>
   <li class="next"><a href="slon_kill.1.html">slon_kill.1: Slony-i administration script <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
