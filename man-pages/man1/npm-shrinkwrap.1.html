<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>npm-shrinkwrap: Lock down dependency versions</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Lock down dependency versions">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="npm-shrinkwrap (1) manual">
  <meta name="twitter:description" content="Lock down dependency versions">
  <meta name="twitter:image" content="https://www.carta.tech/images/npm-npm-shrinkwrap-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/npm-shrinkwrap.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="npm-shrinkwrap (1) manual" />
  <meta property="og:description" content="Lock down dependency versions" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/npm-npm-shrinkwrap-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">npm-shrinkwrap<small> (1)</small></h1>
        <p class="lead">Lock down dependency versions</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/npm-shrinkwrap.1.html">
      <span itemprop="name">npm-shrinkwrap: Lock down dependency versions</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/npm/">
      <span itemprop="name">npm</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/npm-shrinkwrap.1.html">
      <span itemprop="name">npm-shrinkwrap: Lock down dependency versions</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
npm shrinkwrap
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This command locks down the versions of a package\'s dependencies so that you can control exactly which versions of each dependency will be used when your package is installed. The "package.json" file is still required if you want to use "npm install".</p><p>By default, "npm install" recursively installs the target\'s dependencies (as specified in package.json), choosing the latest available version that satisfies the dependency\'s semver pattern. In some situations, particularly when shipping software where each change is tightly managed, it\'s desirable to fully specify each version of each dependency recursively so that subsequent builds and deploys do not inadvertently pick up newer versions of a dependency that satisfy the semver pattern. Specifying specific semver patterns in each dependency\'s package.json would facilitate this, but that\'s not always possible or desirable, as when another author owns the npm package. It\'s also possible to check dependencies directly into source control, but that may be undesirable for other reasons.</p><p>As an example, consider package A:</p><ul>
<li>
<pre>
{
  "name": "A",
  "version": "0.1.0",
  "dependencies": {
    "B": "&lt;0.1.0"
  }
}
</pre>
</li><li></li>
</ul><p>package B:</p><ul>
<li>
<pre>
{
  "name": "B",
  "version": "0.0.1",
  "dependencies": {
    "C": "&lt;0.1.0"
  }
}
</pre>
</li><li></li>
</ul><p>and package C:</p><ul>
<li>
<pre>
{
  "name": "C,
  "version": "0.0.1"
}
</pre>
</li><li></li>
</ul><p>If these are the only versions of A, B, and C available in the registry, then a normal "npm install A" will install:</p><ul>
<li>
<pre>
A@0.1.0
`-- B@0.0.1
    `-- C@0.0.1
</pre>
</li><li></li>
</ul><p>However, if B@0.0.2 is published, then a fresh "npm install A" will install:</p><ul>
<li>
<pre>
A@0.1.0
`-- B@0.0.2
    `-- C@0.0.1
</pre>
</li><li></li>
</ul><p>assuming the new version did not modify B\'s dependencies. Of course, the new version of B could include a new version of C and any number of new dependencies. If such changes are undesirable, the author of A could specify a dependency on B@0.0.1. However, if A\'s author and B\'s author are not the same person, there\'s no way for A\'s author to say that he or she does not want to pull in newly published versions of C when B hasn\'t changed at all.</p><p>In this case, A\'s author can run</p><ul>
<li>
<pre>
npm shrinkwrap
</pre>
</li><li></li>
</ul><p>This generates npm-shrinkwrap.json, which will look something like this:</p><ul>
<li>
<pre>
{
  "name": "A",
  "version": "0.1.0",
  "dependencies": {
    "B": {
      "version": "0.0.1",
      "dependencies": {
        "C": {
          "version": "0.1.0"
        }
      }
    }
  }
}
</pre>
</li><li></li>
</ul><p>The shrinkwrap command has locked down the dependencies based on what\'s currently installed in node_modules. When "npm install" installs a package with a npm-shrinkwrap.json file in the package root, the shrinkwrap file (rather than package.json files) completely drives the installation of that package and all of its dependencies (recursively). So now the author publishes A@0.1.0, and subsequent installs of this package will use B@0.0.1 and C@0.1.0, regardless the dependencies and versions listed in A\'s, B\'s, and C\'s package.json files.</p><h3>Using shrinkwrapped packages</h3>
<p>Using a shrinkwrapped package is no different than using any other package: you can "npm install" it by hand, or add a dependency to your package.json file and "npm install" it.</p>
<h3>Building shrinkwrapped packages</h3>
<p>To shrinkwrap an existing package:</p>
<dl class='dl-vertical'>
  <dt>
    1.
  </dt>
  <dd>
    <p>Run "npm install" in the package root to install the current versions of all dependencies.</p>
  </dd>
  <dt>
    2.
  </dt>
  <dd>
    <p>Validate that the package works as expected with these versions.</p>
  </dd>
  <dt>
    3.
  </dt>
  <dd>
    <p>Run "npm shrinkwrap", add npm-shrinkwrap.json to git, and publish your package.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    
  </dd>

</dl>
<p>To add or update a dependency in a shrinkwrapped package:</p>
<dl class='dl-vertical'>
  <dt>
    1.
  </dt>
  <dd>
    <p>Run "npm install" in the package root to install the current versions of all dependencies.</p>
  </dd>
  <dt>
    2.
  </dt>
  <dd>
    <p>Add or update dependencies. "npm install" each new or updated package individually and then update package.json. Note that they must be explicitly named in order to be installed: running <strong>npm install</strong> with no arguments will merely reproduce the existing shrinkwrap.</p>
  </dd>
  <dt>
    3.
  </dt>
  <dd>
    <p>Validate that the package works as expected with the new dependencies.</p>
  </dd>
  <dt>
    4.
  </dt>
  <dd>
    <p>Run "npm shrinkwrap", commit the new npm-shrinkwrap.json, and publish your package.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    
  </dd>

</dl>
<p>npm help You can use npm-outdated to view dependencies with newer versions available.</p>
<h3>Other Notes</h3>
<p>A shrinkwrap file must be consistent with the package\'s package.json file. "npm shrinkwrap" will fail if required dependencies are not already installed, since that would result in a shrinkwrap that wouldn\'t actually work. Similarly, the command will fail if there are extraneous packages (not referenced by package.json), since that would indicate that package.json is not correct.</p><p>Since "npm shrinkwrap" is intended to lock down your dependencies for production use, <strong>devDependencies</strong> will not be included unless you explicitly set the <strong>--dev</strong> flag when you run <strong>npm shrinkwrap</strong>. If installed <strong>devDependencies</strong> are excluded, then npm will print a warning. If you want them to be installed with your module by default, please consider adding them to <strong>dependencies</strong> instead.</p><p>If shrinkwrapped package A depends on shrinkwrapped package B, B\'s shrinkwrap will not be used as part of the installation of A. However, because A\'s shrinkwrap is constructed from a valid installation of B and recursively specifies all dependencies, the contents of B\'s shrinkwrap will implicitly be included in A\'s shrinkwrap.</p>
<h3>Caveats</h3>
<p>If you wish to lock down the specific bytes included in a package, for example to have 100% confidence in being able to reproduce a deployment or build, then you ought to check your dependencies into source control, or pursue some other mechanism that can verify contents rather than versions.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO npm-shrinkwrap&hellip;</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    *
  </dt>
  <dd>
    <p>npm help install</p>
  </dd>
  <dt>
    *
  </dt>
  <dd>
    <p>npm help  package.json</p>
  </dd>
  <dt>
    *
  </dt>
  <dd>
    <p>npm help ls</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="npm-search.1.html"><span aria-hidden="true">&larr;</span> npm-search.1: Search for packages</a></li>
   <li class="next"><a href="npm-star.1.html">npm-star.1: Mark your favorite packages <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
