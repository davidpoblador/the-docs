<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ocsptool: Gnutls ocsp tool</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Gnutls ocsp tool">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="ocsptool (1) manual">
  <meta name="twitter:description" content="Gnutls ocsp tool">
  <meta name="twitter:image" content="https://www.carta.tech/images/gnutls-bin-ocsptool-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/ocsptool.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ocsptool (1) manual" />
  <meta property="og:description" content="Gnutls ocsp tool" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/gnutls-bin-ocsptool-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">ocsptool<small> (1)</small></h1>
        <p class="lead">Gnutls ocsp tool</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/ocsptool.1.html">
      <span itemprop="name">ocsptool: Gnutls ocsp tool</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/gnutls-bin/">
      <span itemprop="name">gnutls-bin</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/ocsptool.1.html">
      <span itemprop="name">ocsptool: Gnutls ocsp tool</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>ocsptool</strong> [<strong>-flags</strong>] [<strong>-flag</strong> [<em>value</em>]] [<strong>--option-name</strong>[[=| ]<em>value</em>]]</p><p>All arguments must be options.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Ocsptool is a program that can parse and print information about OCSP requests/responses, generate requests and verify responses.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>Enable debugging.</p>
  </dt>
  <dd>
    <p>This option takes an integer number as its argument. The value of <em>number</em> is constrained to being:</p>
<pre>
in the range  0 through 9999
</pre>
<p>Specifies the debug level.</p>
  </dd>
  <dt>
    <p>More verbose output.</p>
  </dt>
  <dd>
    <p>This option may appear an unlimited number of times.</p>
  </dd>
  <dt>
    <p>Input file.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>Output file.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>Ask an OCSP/HTTP server on a certificate validity.</p>
  </dt>
  <dd>
    <p>This option must appear in combination with the following options: load-cert, load-issuer.</p><p>Connects to the specified HTTP OCSP server and queries on the validity of the loaded certificate.</p>
  </dd>
  <dt>
    <p>Verify response.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>Print information on a OCSP request.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>Print information on a OCSP response.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>Generate an OCSP request.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>Use (or not) a nonce to OCSP request.</p>
  </dt>
  <dd>
    <p>The <em>no-nonce</em> form will disable the option.</p>
  </dd>
  <dt>
    <p>Read issuer certificate from file.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>Read certificate to check from file.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>Read OCSP trust anchors from file.</p>
  </dt>
  <dd>
    <p>This option must not appear in combination with any of the following options: load-signer.</p>
  </dd>
  <dt>
    <p>Read OCSP response signer from file.</p>
  </dt>
  <dd>
    <p>This option must not appear in combination with any of the following options: load-trust.</p>
  </dd>
  <dt>
    <p>Use DER format for input certificates and private keys.</p>
  </dt>
  <dd>
    <p>The <em>no-inder</em> form will disable the option.</p>
  </dd>
  <dt>
    <p>Read DER encoded OCSP request from file.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>Read DER encoded OCSP response from file.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>Display usage information and exit.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>Pass the extended usage information through a pager.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>Output version of program and exit.  The default mode is `v', a simple</p>
  </dt>
  <dd>
    <p>version.  The `c' mode will print copyright information and `n' will print the full copyright notice.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p><strong>Print information about an OCSP request</strong></p><p>To parse an OCSP request and print information about the content, the <strong>-i</strong> or <strong>--request-info</strong> parameter may be used as follows. The <strong>-Q</strong> parameter specify the name of the file containing the OCSP request, and it should contain the OCSP request in binary DER format.</p>
<pre>
$ ocsptool -i -Q ocsp-request.der
</pre>
<p>The input file may also be sent to standard input like this:</p>
<pre>
$ cat ocsp-request.der | ocsptool --request-info
</pre>
<p><strong>Print information about an OCSP response</strong></p><p>Similar to parsing OCSP requests, OCSP responses can be parsed using the <strong>-j</strong> or <strong>--response-info</strong> as follows.</p>
<pre>
$ ocsptool -j -Q ocsp-response.der
$ cat ocsp-response.der | ocsptool --response-info
</pre>
<p><strong>Generate an OCSP request</strong></p><p>The <strong>-q</strong> or <strong>--generate-request</strong> parameters are used to generate an OCSP request.  By default the OCSP request is written to standard output in binary DER format, but can be stored in a file using <strong>--outfile</strong>.  To generate an OCSP request the issuer of the certificate to check needs to be specified with <strong>--load-issuer</strong> and the certificate to check with <strong>--load-cert</strong>.  By default PEM format is used for these files, although <strong>--inder</strong> can be used to specify that the input files are in DER format.</p>
<pre>
$ ocsptool -q --load-issuer issuer.pem --load-cert client.pem             --outfile ocsp-request.der
</pre>
<p>When generating OCSP requests, the tool will add an OCSP extension containing a nonce.  This behaviour can be disabled by specifying <strong>--no-nonce</strong>.</p><p><strong>Verify signature in OCSP response</strong></p><p>To verify the signature in an OCSP response the <strong>-e</strong> or <strong>--verify-response</strong> parameter is used.  The tool will read an OCSP response in DER format from standard input, or from the file specified by <strong>--load-response</strong>.  The OCSP response is verified against a set of trust anchors, which are specified using <strong>--load-trust</strong>.  The trust anchors are concatenated certificates in PEM format.  The certificate that signed the OCSP response needs to be in the set of trust anchors, or the issuer of the signer certificate needs to be in the set of trust anchors and the OCSP Extended Key Usage bit has to be asserted in the signer certificate.</p>
<pre>
$ ocsptool -e --load-trust issuer.pem             --load-response ocsp-response.der
</pre>
<p>The tool will print status of verification.</p><p><strong>Verify signature in OCSP response against given certificate</strong></p><p>It is possible to override the normal trust logic if you know that a certain certificate is supposed to have signed the OCSP response, and you want to use it to check the signature.  This is achieved using <strong>--load-signer</strong> instead of <strong>--load-trust</strong>.  This will load one certificate and it will be used to verify the signature in the OCSP response.  It will not check the Extended Key Usage bit.</p>
<pre>
$ ocsptool -e --load-signer ocsp-signer.pem             --load-response ocsp-response.der
</pre>
<p>This approach is normally only relevant in two situations.  The first is when the OCSP response does not contain a copy of the signer certificate, so the <strong>--load-trust</strong> code would fail.  The second is if you want to avoid the indirect mode where the OCSP response signer certificate is signed by a trust anchor.</p><p><strong>Real-world example</strong></p><p>Here is an example of how to generate an OCSP request for a certificate and to verify the response.  For illustration we'll use the <strong>blog.josefsson.org</strong> host, which (as of writing) uses a certificate from CACert.  First we'll use <strong>gnutls-cli</strong> to get a copy of the server certificate chain.  The server is not required to send this information, but this particular one is configured to do so.</p>
<pre>
$ echo | gnutls-cli -p 443 blog.josefsson.org --print-cert &gt; chain.pem
</pre>
<p>Use a text editor on <strong>chain.pem</strong> to create three files for each separate certificates, called <strong>cert.pem</strong> for the first certificate for the domain itself, secondly <strong>issuer.pem</strong> for the intermediate certificate and <strong>root.pem</strong> for the final root certificate.</p><p>The domain certificate normally contains a pointer to where the OCSP responder is located, in the Authority Information Access Information extension.  For example, from <strong>certtool -i &lt; cert.pem</strong> there is this information:</p>
<pre>
Authority Information Access Information (not critical):
Access Method: 1.3.6.1.5.5.7.48.1 (id-ad-ocsp)
Access Location URI: http://ocsp.CAcert.org/
</pre>
<p>This means the CA support OCSP queries over HTTP.  We are now ready to create a OCSP request for the certificate.</p>
<pre>
$ ocsptool --ask ocsp.CAcert.org --load-issuer issuer.pem             --load-cert cert.pem --outfile ocsp-response.der
</pre>
<p>The request is sent via HTTP to the OCSP server address specified. If the address is ommited ocsptool will use the address stored in the certificate.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">
<p>One of the following exit values will be returned:</p>
<dl class='dl-vertical'>
  <dt>
    <p>Successful program execution.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>The operation failed or the command syntax was not valid.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>libopts had an internal operational error.  Please report</p>
  </dt>
  <dd>
    <p>it to autogen-users@lists.sourceforge.net.  Thank you.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO ocsptool&hellip;</h2>
        <div class="sectioncontent">

<pre>
    certtool (1)
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Nikos Mavrogiannopoulos, Simon Josefsson and others; see /usr/share/doc/gnutls/AUTHORS for a complete list.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (C) 2000-2014 Free Software Foundation, and others all rights reserved. This program is released under the terms of the GNU General Public License, version 3 or later.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Please send bug reports to: bugs@gnutls.org</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>This manual page was <em>AutoGen</em>-erated from the <strong>ocsptool</strong> option definitions.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="ocsigenserver.opt.1.html"><span aria-hidden="true">&larr;</span> ocsigenserver.opt.1: Web programming framework in ocaml</a></li>
   <li class="next"><a href="octave.1.html">octave.1: A high-level interactive language for numerical computations. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
