<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>vdm_encode: Block ecc for files</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Block ecc for files">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="vdm_encode (1) manual">
  <meta name="twitter:description" content="Block ecc for files">
  <meta name="twitter:image" content="https://www.carta.tech/images/vdmfec-vdm_encode-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/vdm_encode.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="vdm_encode (1) manual" />
  <meta property="og:description" content="Block ecc for files" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/vdmfec-vdm_encode-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">vdm_encode<small> (1)</small></h1>
        <p class="lead">Block ecc for files</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/vdm_encode.1.html">
      <span itemprop="name">vdm_encode: Block ecc for files</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/vdmfec/">
      <span itemprop="name">vdmfec</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/vdm_encode.1.html">
      <span itemprop="name">vdm_encode: Block ecc for files</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>vdmfec</strong> [-v] [-d] [-b <em>blocksize</em>] [-n <em>N</em>] [-k <em>K</em>] [file]
<strong>vdm_encode</strong> [-v] [-b <em>blocksize</em>] [-n <em>N</em>] [-k <em>K</em>] [file]
<strong>vdm_decode</strong> [-v] [-b <em>blocksize</em>] [-n <em>N</em>] [-k <em>K</em>] [file]
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>vdmfec</strong> reads an input stream and adds error correction blocks so that large consecutive sections of the output stream may be corrupted, and the data recovered.  For example, diskettes typically lose whole sectors at once, or related groups of sectors, or even entire tracks.  Data written to a diskette with this program may be recovered even with many read errors.</p><p>The algorithm used is a Forward Error Correction (FEC) code based on Vandermonde (VDM) matrices in GF(2^8) due to Luigi Rizzo.  Given the FEC parameters K and N, with N greater than K, N blocks are written for every K input blocks in such a way that any K blocks are sufficient to reconstruct the data.  That is, up to N - K blocks out of every group of N blocks may be lost without loss of data.</p><p>The amount of overhead in the output stream is easily adjustable by varying K.  N and blocksize control the total amount of data written.  Depending on the types of errors you expect, different settings may be more or less useful.  For example, you may not expect to have two or three bad sectors on every track (if you do it's time to replace the diskette!), but you might expect three bad sectors on two or three contiguous tracks (diskette errors tend to cluster).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-v</strong></p>
  </dt>
  <dd>
    <p>Print informative messages about the encoding or decoding process to <em>stderr</em>, including the expansion factor.  Use <strong>-vv</strong> to get information about each block being read or written.</p>
  </dd>
  <dt>
    <p><strong>-d</strong></p>
  </dt>
  <dd>
    <p>Decode the input rather than encoding it.  Using this option is equivalent to invoking the program as <strong>vdm_decode</strong>.</p>
  </dd>
  <dt>
    <p><strong>-b</strong> <em>blocksize</em></p>
  </dt>
  <dd>
    <p>Set the FEC block size to blocksize bytes. The blocksize may have a 'k' or 'K' appended, in which case the block size is set to blocksize * 1024 bytes.  This should usually be a multiple of the output media block or sector size (e.g., 512, 1024, 18K, etc.), and must be at least 26 bytes in version 1.  Default 1024.</p>
  </dd>
  <dt>
    <p><strong>-n</strong> <em>N</em> <strong>-k</strong> <em>K</em></p>
  </dt>
  <dd>
    <p>Set the FEC N and K parameters.  N must be greater than 2 and less than or equal to 256.  K must be greater than 0 and less than N.  Default N=18, K=14.</p>
  </dd>

</dl>
<p>Note that the N, K, and blocksize parameters are NOT written to the output! You must specify the <em>same</em> parameters when you run the decoder. (Actually, the decoder is capable of explicitly detecting an invalid K value, but incorrect blocksize or N values will result in bad blocks and decode failure.)</p><p>The decoder is capable of reading from non-seekable media such as pipes, however, buffer underruns are not detected and will result in failure. Also, when reading from a pipe the entire file must be read.  Reading from a seek-able stream can be faster because only K good blocks out of N need to be read.</p><p>The encoder stores chunk and block ids which are used to detect out of order blocks, but those errors (which can sometimes happen due to filesystem corruption) are not corrected.  The only type of error that can be corrected is <em>in place</em> corruption of data.  In particular, missing blocks (as from lost packets) result in decode failure, even when K good blocks are available.  This program is primarily intended to recover data lost due to read errors on fixed media such as diskettes; several other programs and libraries are available that use FEC to handle the other (typically network packet) errors.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Consider a diskette with 80 tracks, 2 heads, and 18 512-byte sectors per track (a standard 1.44MB diskette).</p><ul>
<li><p>bzip2 &lt; file | vdmfec &gt; /dev/fd0</p></li>
</ul><p>uses the default parameters of -b1k -n18 -k14, stores up to ~1.1MB of compressed input data, written one (double-sided) track (18K) at a time, and allows 4 bad clusters (8 sectors) per track.</p><ul>
<li><p>vdmfec -d /dev/fd0 | bunzip2 &gt; file</p></li>
</ul><p>recovers the original file.</p><ul>
<li><p>vdm_encode -b18k -n80 -k70 file.img &gt; /dev/fd0</p></li>
</ul><p>writes the entire diskette, stores up to ~1.23MB of data, and allows multiple errors on 10 different double-sided tracks.</p><ul>
<li><p>vdm_decode -b18k -n80 -k70 /dev/fd0 &gt; file.img</p></li>
</ul><p>recovers the data and reads no less than 70 tracks.  Note that vdm_decode exits with a non-zero status on failure, so that constructions such as</p><ul>
<li><p>vdm_decode /dev/fd0 &gt; moo && tar -xvf moo</p></li>
</ul><p>are possible.</p><ul>
<li><p>dd if=/dev/tape ibs=1024 conv=noerror,sync | &#92;</p><p>vdm_decode &gt; file</p></li>
</ul><p>This might be necessary to recover data from some non-seekable media. You can of course simply write the encoded output to a normal file, as in</p><ul>
<li><p>tar -cf - dir | gzip | vdm_encode -v &gt; dir.tgz.vdm</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">
<p>Report bugs to Tom Holroyd &lt;tomh@po.crl.go.jp&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO vdm_encode&hellip;</h2>
        <div class="sectioncontent">
<p><strong>fec</strong>(3)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="vdm_decode.1.html"><span aria-hidden="true">&larr;</span> vdm_decode.1: Block ecc for files</a></li>
   <li class="next"><a href="vdmfec.1.html">vdmfec.1: Block ecc for files <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
