<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>tcpreen: Tcp stream monitoring tool</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Tcp stream monitoring tool">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="tcpreen (1) manual">
  <meta name="twitter:description" content="Tcp stream monitoring tool">
  <meta name="twitter:image" content="https://www.carta.tech/images/tcpreen-tcpreen-1.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man1/tcpreen.1.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="tcpreen (1) manual" />
  <meta property="og:description" content="Tcp stream monitoring tool" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/tcpreen-tcpreen-1.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">tcpreen<small> (1)</small></h1>
        <p class="lead">Tcp stream monitoring tool</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/">
      <span itemprop="name">Executable programs or shell commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/tcpreen.1.html">
      <span itemprop="name">tcpreen: Tcp stream monitoring tool</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/tcpreen/">
      <span itemprop="name">tcpreen</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man1/tcpreen.1.html">
      <span itemprop="name">tcpreen: Tcp stream monitoring tool</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>tcpreen</strong> [<strong>-cdflnqv</strong>] [<strong>-b maxbytes</strong>] [ <strong>-f format</strong>] [<strong>-F maxclients</strong>] [<strong>-m maxconnect</strong>] [ <strong>-o logfile</strong>] [<strong>-u user</strong>] [<strong>-a bindaddress</strong>] [ <strong>-s servername</strong>] [<strong>-p proto1/proto2</strong>] serverport [localport]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTON</h2>
        <div class="sectioncontent">
<p><strong>TCPreen</strong> monitors and let the user analyse data transmitted between clients and servers via TCP connections. It focuses on the data stream and operates at the software layer, not on lower level transmission protocols as a packet sniffers do.</p><p>It works like a bridge between a server and clients that communicates through TCP sessions, and can display or save data that is sent either way.</p><p>In standard mode, <strong>TCPreen</strong> opens a listening socket (on port  <strong>localport</strong> which is dynamically allocated by default), and waits  until a client connects to it. Then, it connects to the server (on port <strong>serverport</strong>) and forwards data between each hosts until the session  is closed by either side.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-a interface</strong>, <strong>--accept interface</strong> or <strong>--bind interface</strong></p>
  </dt>
  <dd>
    <p>Specify an interface that will be used to listen for client connections. By default, all network interfaces are used.</p>
  </dd>
  <dt>
    <p><strong>-b bytecount</strong> or <strong>--bytes bytecount</strong></p>
  </dt>
  <dd>
    <p>Limit the length of a TCP session to <strong>bytecount</strong> bytes. If a session exceeds this quantity, it will be closed on the next data packet boundary.</p>
  </dd>
  <dt>
    <p><strong>-c</strong> or <strong>--connect</strong></p>
  </dt>
  <dd>
    <p>Connect to the specified client instead of waiting for the client to connect. This is meant for expert users who know what they are doing only. If no hostname is specified, TCPreen will try to connect to the local host.</p><p>Use <strong>-a address</strong> to specify the client address to connect to.</p>
  </dd>
  <dt>
    <p><strong>-d</strong> or <strong>--daemon</strong></p>
  </dt>
  <dd>
    <p>Turn on <em>daemon mode</em>. When this option is selected, <strong>TCPreen</strong> will run in the background and send informations to <strong>syslog</strong> instead of the console. This enables <em>quiet mode</em> and <em>multiple clients mode</em>  automatically.</p><p>You will probably want to use option -F as well.</p><p><strong>NOTE</strong>: if you turn this feature on, log files will be created from  the <strong>root</strong> directory, not from the current one. See <a href="../man3/daemon.3.html"><strong>daemon</strong>(3)</a> for more details.</p>
  </dd>
  <dt>
    <p><strong>-f logformat</strong> or <strong>--format logformat</strong></p>
  </dt>
  <dd>
    <p>Selects a format for output. Supported formats includes: <strong>C</strong> (C source strings-like encoding), <strong>hex</strong> (hexadecimal data dump), <strong>count</strong> (write quantities of data), <strong>null</strong> (only displays new connections addresses), <strong>password</strong> (basic password capture, unfinished yet), <strong>raw</strong> (write data as is, even if it is not 7-bit clean), <strong>strip</strong> (replace non printable characters with dots).</p>
  </dd>
  <dt>
    <p><strong>-F nproc</strong> or <strong>--fork nproc</strong></p>
  </dt>
  <dd>
    <p>Specifies the maximum number of sessions that can be treated at the same time. By default, only one session is allowed at a time not so as to keep the program output easy to read.</p>
  </dd>
  <dt>
    <p><strong>-h</strong> or <strong>--help</strong></p>
  </dt>
  <dd>
    <p>Display some help and exit.</p>
  </dd>
  <dt>
    <p><strong>-l</strong> or <strong>--listen</strong></p>
  </dt>
  <dd>
    <p>Listen for the "server" instead of connecting to it. This can be used by advanced users to run a human brain-powered server by telnet-ing to <strong>TCPreen server</strong> address. An optionnal listening interface address can be specified.</p>
  </dd>
  <dt>
    <p><strong>-m conn_num</strong> or <strong>--maxconn conn_num</strong></p>
  </dt>
  <dd>
    <p>Handle <strong>conn_num</strong> consecutive client connections before exiting. When this option is not used, the program will run forever (until interrupted).</p>
  </dd>
  <dt>
    <p><strong>-n</strong> or <strong>--numeric</strong></p>
  </dt>
  <dd>
    <p>Disable reverse DNS lookup and service name resolution. Node names and port numbers will appear in numeric form. This option will speed up connections a little.</p>
  </dd>
  <dt>
    <p><strong>-o logfile</strong> or <strong>--output logfile</strong></p>
  </dt>
  <dd>
    <p>Save data to file <strong>logfile</strong>. If it already exists, it will be overwritten. "-" is used for <em>stdout</em>.</p><p>Multiple log files can be used (with different formats). For example:</p><p>tcpreen -f hex -o hexafile.log -f C -o file.log smtp</p><p>will save <em>hexafile.log</em> in hexadecimal and <em>file.log</em> in C  encoding.</p>
  </dd>
  <dt>
    <p><strong>-p</strong> or <strong>--protocol</strong></p>
  </dt>
  <dd>
    <p>Specifies which network protocol(s) is/are going to be used. If a single protocol name is specified, it will be used both ways. Two different protocols can be used on each side by separating them with a slash like this: 'tcp/tcp6'. The first protocol will then be used to communicate with the server, the last one will be used to exchange data with the client.</p><p>The following protocols are currently recognized: <strong>tcp</strong> (TCP over IPv4), <strong>tcp6</strong> (TCP over IPv6) and <strong>unix</strong> or  <strong>local</strong> (Unix interprocess streams). By default, <strong>tcp</strong> is used.</p>
  </dd>
  <dt>
    <p><strong>-q</strong> or <strong>--quiet</strong></p>
  </dt>
  <dd>
    <p>Turn on <em>quiet mode</em>:  Do not write anything on the standard output (<em>stdout</em>).</p>
  </dd>
  <dt>
    <p><strong>-s hostname</strong> or <strong>--server hostname</strong></p>
  </dt>
  <dd>
    <p>Connect to the specified server instead of the local host which is used by default.</p>
  </dd>
  <dt>
    <p><strong>-u user</strong> or <strong>--user user</strong></p>
  </dt>
  <dd>
    <p>When run as super-user, drop privilege and set UID to that of <strong>user</strong> (it must be a valid username). That is highly recommended if <strong>tcpreen</strong> is to be bound to a reserved port, which only root can bind on Unix systems.</p><p>You must be root to use this option.</p>
  </dd>
  <dt>
    <p><strong>-v</strong> or <strong>--verbose</strong></p>
  </dt>
  <dd>
    <p>Increase program verbosity. This can be cumulated.</p>
  </dd>
  <dt>
    <p><strong>-V</strong> or <strong>--version</strong></p>
  </dt>
  <dd>
    <p>Display program version and license and exit.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">
<p>These are common problems:</p><p>Nothing happens:</p><p>The client is communicating with the server correctly, but TCPreen stays quiet. Make sure you told the client to connect to TCPreen address rather than the actual server address.</p><p>Make sure you have enabled verbose mode.</p><p>Strange port names:</p><p>Have a look at <em>/etc/services</em> and you will realize what this means. Alternatively, you may want to use <strong>-n</strong>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SECURITY</h2>
        <div class="sectioncontent">
<p><strong>tcpreen</strong> requires <em>root</em> privileges to be bound to a reserved TCP port (under 1024). If you really need to do so, you may run <strong>tcpreen</strong> Set-UID <em>root</em>. In such circumstances, you must ensure that only trustworthy users can run <strong>tcpreen</strong>, as it could be used to divert traffic to  <strong>any</strong> reserved ports on the system.</p><p><strong>tcpreen</strong> will automatically drop privileges as soon as it has allocated its listening socket(s) to limit exposure. Log files are always created with the default permission of the current user.</p><p>Care should be taken when using <strong>tcpreen</strong> as it could be used to access your network or system from the outside (that is why it will normally refuse to run as root).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO tcpreen&hellip;</h2>
        <div class="sectioncontent">
<p>nc(1), <a href="../man1/nc6.1.html"><strong>nc6</strong>(1)</a>, <a href="../man1/tcpflow.1.html"><strong>tcpflow</strong>(1)</a>, <a href="../man8/tcpdump.8.html"><strong>tcpdump</strong>(8)</a>, <strong>tethereal</strong>(1)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Remi Denis-Courmont &lt;rdenis at simphalempin.com&gt;</p><p>$Id: tcpreen.1 178 2006-03-18 18:10:23Z remi $</p><p>http://www.simphalempin.com/dev/tcpreen/</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="tcpprep.1.html"><span aria-hidden="true">&larr;</span> tcpprep.1: Create a tcpreplay cache cache file from a pcap file.</a></li>
   <li class="next"><a href="tcpreplay.1.html">tcpreplay.1: Replay network traffic stored in pcap files <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
