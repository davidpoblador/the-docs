<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>fwlogwatch: A firewall log analyzer and realtime response agent</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A firewall log analyzer and realtime response agent">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="fwlogwatch (8) manual">
  <meta name="twitter:description" content="A firewall log analyzer and realtime response agent">
  <meta name="twitter:image" content="https://www.carta.tech/images/fwlogwatch-fwlogwatch-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/fwlogwatch.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="fwlogwatch (8) manual" />
  <meta property="og:description" content="A firewall log analyzer and realtime response agent" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/fwlogwatch-fwlogwatch-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">fwlogwatch<small> (8)</small></h1>
        <p class="lead">A firewall log analyzer and realtime response agent</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/fwlogwatch.8.html">
      <span itemprop="name">fwlogwatch: A firewall log analyzer and realtime response agent</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/fwlogwatch/">
      <span itemprop="name">fwlogwatch</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/fwlogwatch.8.html">
      <span itemprop="name">fwlogwatch: A firewall log analyzer and realtime response agent</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>fwlogwatch</strong> [<em>options</em>]<em>[</em>input_files<em>]</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>fwlogwatch</strong> produces Linux ipchains, Linux netfilter/iptables, Solaris/BSD/Irix/HP-UX ipfilter, ipfw, Cisco IOS, Cisco PIX/ASA, NetScreen, Elsa Lancom router and Snort IDS log summary reports in plain text and HTML form and has a lot of options to analyze and display relevant patterns. It also can run as daemon (with web interface) doing realtime log monitoring and reporting anomalies or starting attack countermeasures.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">GENERAL OPTIONS</h2>
        <div class="sectioncontent">
<p>These options are independent from the main modes of operation.</p>
<dl class='dl-vertical'>
  <dt>
    -h
  </dt>
  <dd>
    <p>Show the available options.</p>
  </dd>
  <dt>
    -L
  </dt>
  <dd>
    <p>Show time of the first and the last log entry. The input file(s) can be compressed or plain log file(s). Summary mode will show the time of the first and last packet log entry, this log times mode will show the time of the first and last entry overall.</p>
  </dd>
  <dt>
    -V
  </dt>
  <dd>
    <p>Show version and copyright information and the options used to compile fwlogwatch.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">GLOBAL OPTIONS</h2>
        <div class="sectioncontent">
<p>The global options for all modes are:</p>
<dl class='dl-vertical'>
  <dt>
    -b
  </dt>
  <dd>
    <p>Show the amount of data in bytes this entry represents, this is the sum of total packet lengths of packets matching this rule (obviously only available for log formats that contain this information).</p>
  </dd>
  <dt>
    -c
  </dt>
  <dd>
    <p>Use the alternate configuration file <em>config</em> instead of the default configuration file <strong>/etc/fwlogwatch/fwlogwatch.config</strong> (which does not need to exist). Only options not specified in the files can be overridden by command line options.</p>
  </dd>
  <dt>
    -D
  </dt>
  <dd>
    <p>Do not differentiate destination IP addresses. Useful for finding scans in whole subnets.</p>
  </dd>
  <dt>
    -d
  </dt>
  <dd>
    <p>Differentiate destination ports.</p>
  </dd>
  <dt>
    -E
  </dt>
  <dd>
    <p>Specific hosts, ports, chains and branches (targets) can be selected or excluded, selections an exclusions can be added and combined. The <em>format</em> is composed of one of the functions <em>i</em> include or <em>e</em> exclude, then one of the parameters <em>h</em> host, <em>p</em> port, <em>c</em> chain or <em>b</em> branch. In case of a host or port a third parameter for <em>s</em> source or <em>d</em> destination is needed. Finally, the object is directly appended, in case of a host this is an IP address (networks can be specified in CIDR format), port is a number and chain and branch are strings. To show entries with destination port 25 you would use <strong>-Eipd25</strong> and to exclude entries which have the class C network 192.168.1.0 as source or belong to the chain INPUT: <strong>-Eehs192.168.1.0/24 -EecINPUT</strong></p>
  </dd>
  <dt>
    -M
  </dt>
  <dd>
    <p>If you only want to see a fixed maximum amount of entries (e.g. the "top 20") this option will trim the output for you.</p>
  </dd>
  <dt>
    -m
  </dt>
  <dd>
    <p>When analyzing large amounts of data you usually aren't interested in entries that have a small count. You can hide entries below a certain threshold with this option.</p>
  </dd>
  <dt>
    -N
  </dt>
  <dd>
    <p>Enable service lookups. Port numbers will be looked up in /etc/services.</p>
  </dd>
  <dt>
    -n
  </dt>
  <dd>
    <p>Enable DNS lookups. Host names will be resolved (reverse and forward lookup with a warning if they don't match). This makes summary generation very slow if a lot of different hosts appear in the log file. Resolved host names are cached.</p>
  </dd>
  <dt>
    -O
  </dt>
  <dd>
    <p>This is the sort order of the summary and packet cache. Since entries often are equal in certain fields you can sort by several fields one after another (the sort algorithm is stable, so equal entries will remain sorted in the order they were sorted before). The sort string can be composed of up to 11 fields of the form <strong>ab</strong> where <strong>a</strong> is the sort criteria: <em>c</em> count, <em>t</em> start time, <em>e</em> end time, <em>z</em> duration, <em>n</em> target name, <em>p</em> protocol, <em>b</em> byte count (sum of total packet lengths), <em>S</em> source host, <em>s</em> source port, <em>D</em> destination host and <em>d</em> destination port. <strong>b</strong> is the direction: <em>a</em> ascending and <em>d</em> descending. Sorting is done in the order specified, so the last option is the primary criteria. The default in summary mode is <em>tacd</em> (start with the highest count, if two counts match list the one earlier in time first) of which <em>ta</em> is built in, so if you specify an empty sort string or everything else is equal entries will be sorted ascending by time. The realtime response mode default is <em>cd</em> ( <em>ta</em> is not built in).</p>
  </dd>
  <dt>
    -P
  </dt>
  <dd>
    <p>Only use certain parsers, where the log <em>format</em> can be one or a combination of: <em>i</em> ipchains, <em>n</em> netfilter, <em>f</em> ipfilter, <em>b</em> ipfw, <em>c</em> Cisco IOS, <em>p</em> Cisco PIX/ASA, <em>e</em> NetScreen, <em>l</em> Elsa Lancom and <em>s</em> Snort. The default is to use all parsers except the ones for NetScreen, Elsa Lancom and Snort logs.</p>
  </dd>
  <dt>
    -p
  </dt>
  <dd>
    <p>Differentiate protocols. This is activated automatically if you differentiate source and/or destination ports.</p>
  </dd>
  <dt>
    -s
  </dt>
  <dd>
    <p>Differentiate source ports.</p>
  </dd>
  <dt>
    -U
  </dt>
  <dd>
    <p>Set <em>title</em> as title of the report and status page.</p>
  </dd>
  <dt>
    -v
  </dt>
  <dd>
    <p>Be verbose. You can specify it twice for more information. In very verbose mode while parsing the log file you will see "." for relevant packet filter log entries, "r" for 'last message repeated' entries concerning packet filter logs, "o" for packet filter log entries that are too old and "_" for entries that are not packet filter logs.</p>
  </dd>
  <dt>
    -y
  </dt>
  <dd>
    <p>Differentiate TCP options. All packets with a SYN are listed separately, other TCP flags are shown in full format if they are available (ipchains does not log them, netfilter and ipfilter do, Cisco IOS doesn't even log SYNs).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOG SUMMARY MODE</h2>
        <div class="sectioncontent">
<p>This are additional options that are only available in log summary mode:</p>
<dl class='dl-vertical'>
  <dt>
    -e
  </dt>
  <dd>
    <p>Show timestamp of last packet logged. End times are only available if there is more than one packet log entry with unique characteristics.</p>
  </dd>
  <dt>
    -l
  </dt>
  <dd>
    <p>Process recent events only. See <strong>TIME FORMAT</strong> below for the time options.</p>
  </dd>
  <dt>
    -o
  </dt>
  <dd>
    <p>Specify an output file.</p>
  </dd>
  <dt>
    -S
  </dt>
  <dd>
    <p>Do not differentiate source IP addresses.</p>
  </dd>
  <dt>
    -T
  </dt>
  <dd>
    <p>The summary will be sent by email to this address. If HTML output is selected the report will be embedded as attachment so HTML-aware mail clients can show it directly.</p>
  </dd>
  <dt>
    -t
  </dt>
  <dd>
    <p>Show timestamp of first packet logged.</p>
  </dd>
  <dt>
    -W
  </dt>
  <dd>
    <p>Look up information about the source addresses in the whois database. This is slow, please don't stress the registry with too many queries.</p>
  </dd>
  <dt>
    -w
  </dt>
  <dd>
    <p>Produce output in HTML format.</p>
  </dd>
  <dt>
    -z
  </dt>
  <dd>
    <p>Show time interval between start and end time of packet log entries. This is only available if there is more than one packet log entry with unique characteristics.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REALTIME RESPONSE MODE</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    -R
  </dt>
  <dd>
    <p>Enter realtime response mode. This means: detach and run as daemon until the TERM signal (kill) is received. The HUP signal forces a reload of the configuration file, the USR1 signal forces fwlogwatch to reopen and read the input file from the beginning (useful e.g. for log rotation). All output can be followed in the system log.</p>
  </dd>
  <dt>
    -a
  </dt>
  <dd>
    <p>Alert threshold. Notify or start countermeasures if this limit is reached. Defaults to 5.</p>
  </dd>
  <dt>
    -l
  </dt>
  <dd>
    <p>Forget events that happened this long ago (defaults to 1 day). See <strong>TIME FORMAT</strong> below for the time options.</p>
  </dd>
  <dt>
    -k
  </dt>
  <dd>
    <p>This option defines a host or network in CIDR notation that will never be blocked or other actions taken against. To specify more than one, use the -k parameter again for each IP address or network you want to add.</p>
  </dd>
  <dt>
    -A
  </dt>
  <dd>
    <p>The notification script is invoked when the threshold is reached. A few examples of possible notifications are included in fwlw_notify, you can add your own ones as you see fit.</p>
  </dd>
  <dt>
    -B
  </dt>
  <dd>
    <p>The response script is invoked when the threshold is reached. Using the example script fwlw_respond this will block the attacking host with a new firewall rule. A new chain for <strong>fwlogwatch</strong> actions is inserted in the input chain and block rules added as needed. The chain and its content is removed if <strong>fwlogwatch</strong> is terminated normally. The example scripts contain actions for ipchains and netfilter, you can modify them or add others as you like.</p>
  </dd>
  <dt>
    -X
  </dt>
  <dd>
    <p>Activate the internal web server to monitor and control the current status of the daemon. It listens on the specified <em>port</em> and by default only allows connections from localhost. The default user name is <strong>admin</strong> and the default password is <strong>fwlogwat</strong> (since DES can only encrypt 8 characters). All options related to the status web server can be changed in the configuration file.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INPUT FILES</h2>
        <div class="sectioncontent">
<p>You can specify one or more input files (if none is given it defaults to <strong>/var/log/messages</strong> ). Relevant entries are automatically detected so combined log files (e.g. from a log host) are no problem. Compressed files are supported (except in realtime response mode where they don't make sense anyway). The '-' sign may be used for reading from standard input (stdin). In realtime response mode the file needs to be specified with an absolute path since the daemon uses the file system root (/) as working directory.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TIME FORMAT</h2>
        <div class="sectioncontent">
<p>Time is specified as <strong>nx</strong> where <strong>n</strong> is a natural number and <strong>x</strong> is one of the following: <em>s</em> for seconds (this is the default), <em>m</em> for minutes, <em>h</em> for hours, <em>d</em> for days, <em>w</em> for weeks, <em>M</em> for months and <em>y</em> for years.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <strong>/etc/fwlogwatch.config</strong>
  </dt>
  <dd>
    <p>Default configuration file.</p>
  </dd>
  <dt>
    <strong>/var/log/messages</strong>
  </dt>
  <dd>
    <p>Default input log file.</p>
  </dd>
  <dt>
    <strong>/var/run/fwlogwatch.pid</strong>
  </dt>
  <dd>
    <p>Default PID file generated by the daemon in realtime response mode if configured to do so.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FEATURES ONLY IN CONFIGURATION FILE</h2>
        <div class="sectioncontent">
<p>The following features are only available in the configuration file and not on the command line, they are presented and explained in more detail in the sample configuration file.</p>
<dl class='dl-vertical'>
  <dt>
    HTML
  </dt>
  <dd>
    <p>The colors of the HTML output and status page can be customized, an external cascading stylesheet can be referenced.</p>
  </dd>
  <dt>
    Realtime
  </dt>
  <dd>
    <p>Verification of ipchains rules, PID file handling, the user <strong>fwlogwatch</strong> should run as, the location of the notification and response scripts, which address the status web server listens on, which host can connect, the refresh interval of the status page and the admin name and password can be configured.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SECURITY</h2>
        <div class="sectioncontent">
<p>Since <strong>fwlogwatch</strong> is a security tool special care was taken to make it secure. You can and should run it with user permissions for most functions, you can make it setgid for a group <strong>/var/log/messages</strong> is in if all you need is to be able to read this file. Only the realtime response mode with activated ipchains rule analysis needs superuser permissions but you might also need them to write the PID file, for actions in the response script and for binding the default status port. However, you can configure fwlogwatch to drop root privileges as soon as possible after allocating these resources (the notification and response scripts will still be executed with user privileges and log rotation might not work).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Boris Wesslowski &lt;bw@inside-security.de&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="fwknopd.8.html"><span aria-hidden="true">&larr;</span> fwknopd.8: Firewall knock operator daemon</a></li>
   <li class="next"><a href="fwlw_notify.8.html">fwlw_notify.8: A firewall log analyzer and realtime response agent <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
