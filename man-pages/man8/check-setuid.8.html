<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>check-setuid: Check for changes to setuid programs</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Check for changes to setuid programs">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="check-setuid (8) manual">
  <meta name="twitter:description" content="Check for changes to setuid programs">
  <meta name="twitter:image" content="https://www.carta.tech/images/checksecurity-check-setuid-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/check-setuid.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="check-setuid (8) manual" />
  <meta property="og:description" content="Check for changes to setuid programs" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/checksecurity-check-setuid-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">check-setuid<small> (8)</small></h1>
        <p class="lead">Check for changes to setuid programs</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/check-setuid.8.html">
      <span itemprop="name">check-setuid: Check for changes to setuid programs</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/checksecurity/">
      <span itemprop="name">checksecurity</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/check-setuid.8.html">
      <span itemprop="name">check-setuid: Check for changes to setuid programs</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>checksecurity</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <strong>checksecurity</strong> command scans the mounted files systems (subject to the filter defined in /etc/checksecurity.conf) and compares the list of setuid programs to the list created on the previous run. Any changes are printed to standard output. Also, it generates a list of <em>nfs</em> and <em>afs</em> filesystems that are mounted insecurely (i.e. they are missing the <em>nodev</em> and either the <em>noexec</em> or <em>nosuid</em> flags).</p><p><strong>checksecurity</strong> is run by <strong>cron</strong> on a daily basis, and the output stored in /var/log/setuid/setuid.changes.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION</h2>
        <div class="sectioncontent">
<p>The <strong>checksecurity.conf</strong> file defines several configuration variables: <strong>CHECKSECURITY_FILTER</strong>, <strong>CHECKSECURITY_NOFINDERRORS</strong>, <strong>CHECKSECURITY_NONFSAFS</strong>, <strong>CHECKSECURITY_EMAIL</strong>, <strong>CHECKSECURITY_DEVICEFILTER</strong>, <strong>CHECKSECURITY_PATHFILTER</strong>, and <strong>LOGDIR</strong>. Each is described below.</p><p>The <strong>CHECKSECURITY_FILTER</strong> environment variable which is the argument of 'grep -vE' applied to the output of the <strong>mount</strong> command. In other words, the value of <strong>CHECKSECURITY_FILTER</strong> is a regular expression that removes matching lines from those file systems that will be scanned. The default value removes all file systems of type <em>proc, bind, msdos, iso9660, ncpfs, nfs, afs,</em> <em>smbfs, auto, ntfs, coda</em> file systems, anything mounted on /dev/fd*, anything mounted on /mnt or /amd, and anything mounted with option nosuid or noexec.</p><p>The <strong>checksecurity.conf</strong> file is sourced from <strong>checksecurity,</strong> so you could do some fairly tricky things to define <strong>CHECKSECURITY_FILTER</strong>.</p><p>The <strong>CHECKSECURITY_NOFINDERRORS</strong> environment variable, if set to the literal "TRUE", disables find errors from checksecurity (actually, it re-routes them to <strong>/dev/null</strong> ).</p><p>The <strong>CHECKSECURITY_NONFSAFS</strong> environment variable, if set to the literal "TRUE", disables the message about <em>nfs</em> and <em>afs</em> file systems that are mounted without the <em>nodev</em> and either the <em>noexec</em> or <em>nosuid</em> options.</p><p>If set, the <strong>CHECKSECURITY_EMAIL</strong> variable defines who is sent a copy of the setuid.changes file.</p><p>The <strong>CHECKSECURITY_DEVICEFILTER</strong> variable specifies a <strong>find</strong> clause for which matching block and character device files will not be monitored for changing owners and permissions. For example, if you don't want to check for permission changes on tty device files beneath /dev, you could set the following:</p><p>CHECKSECURITY_DEVICEFILTER='-path /dev/tty*'</p><p>Note that any added or modified suid programs under that path would still be detected. If you want to specify multiple expressions, separate them with '-o', but there is no need to surround the whole clause with parentheses. To disable this filter, specify it as '-false' (which is the default).</p><p>Note that if the system gets restarted often checksecurity will report a lot of changes in the /dev/ subdirectory due to timestamp changes. In this case you might want to change it to:</p><p>CHECKSECURITY_DEVICEFILTER='-path /dev/'</p><p>The <strong>CHECKSECURITY_PATHFILTER</strong> variable specifies a <strong>find</strong> clause which will be pruned from the search path. <strong>This means that the entire subtree will be completely skipped.</strong> Thus, specifying</p><p>CHECKSECURITY_PATHFILTER='-path /var/ftp'</p><p>then the entire /var/ftp tree will be skipped. To disable this filter, specify it as '-false' (which is the default).</p><p><strong>LOGDIR</strong> sets the name of the directory which stores the files which track the permission and ownership changes. By default, they are in <strong>/var/log/setuid</strong>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>/etc/checksecurity.conf</em></p>
  </dt>
  <dd>
    <p>checksecurity configuration file</p>
  </dd>
  <dt>
    <p><em>/var/log/setuid/setuid.today</em></p>
  </dt>
  <dd>
    <p>setuid files from the most recent run</p>
  </dd>
  <dt>
    <p><em>/var/log/setuid/setuid.yesterday</em></p>
  </dt>
  <dd>
    <p>setuid files from the previous run</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="check-selinux-installation.8.html"><span aria-hidden="true">&larr;</span> check-selinux-installation.8: Check-selinux-installation  perform configuration checks in selinux installation</a></li>
   <li class="next"><a href="check_backuppc.8.html">check_backuppc.8: A nagios plugin to monitor backuppc <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
