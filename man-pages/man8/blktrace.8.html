<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>blktrace: Generate traces of the i/o traffic on block devices</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Generate traces of the i/o traffic on block devices">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="blktrace (8) manual">
  <meta name="twitter:description" content="Generate traces of the i/o traffic on block devices">
  <meta name="twitter:image" content="https://www.carta.tech/images/blktrace-blktrace-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/blktrace.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="blktrace (8) manual" />
  <meta property="og:description" content="Generate traces of the i/o traffic on block devices" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/blktrace-blktrace-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">blktrace<small> (8)</small></h1>
        <p class="lead">Generate traces of the i/o traffic on block devices</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/blktrace.8.html">
      <span itemprop="name">blktrace: Generate traces of the i/o traffic on block devices</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/blktrace/">
      <span itemprop="name">blktrace</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/blktrace.8.html">
      <span itemprop="name">blktrace: Generate traces of the i/o traffic on block devices</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>blktrace -d </strong><em>dev</em> [ -r <em>debugfs_path</em> ] [ -o <em>output</em> ] [-k ] [ -w <em>time</em> ] [ -a <em>action</em> ] [ -A <em>action_mask</em> ] [ -v ]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>blktrace is a block layer IO tracing mechanism which provides detailed information about request queue operations up to user space. There are three major components: a kernel component, a utility to record the i/o trace information for the kernel to user space, and utilities to analyse and view the trace information.  This man page describes blktrace, which records the i/o event trace information for a specific block device to a file.</p><p>The <strong>blktrace</strong> utility extracts event traces from the kernel (via the relaying through the debug file system). Some background details concerning the run-time behaviour of blktrace will help to understand some of the more arcane command line options:</p>
<dl class='dl-vertical'>
  <dt>
    <p>-</p>
  </dt>
  <dd>
    <p>blktrace receives data from the kernel in buffers passed up through the debug file system (relay). Each device being traced has a file created in the mounted directory for the debugfs, which defaults to <em>/sys/kernel/debug</em> -- this can be overridden with the <strong>-r</strong> command line argument.</p>
  </dd>
  <dt>
    <p>-</p>
  </dt>
  <dd>
    <p>blktrace defaults to collecting all events that can be traced. To limit the events being captured, you can specify one or more filter masks via the <strong>-a</strong> option.</p><p>Alternatively, one may specify the entire mask utilising a hexadecimal value that is version-specific. (Requires understanding of the internal representation of the filter mask.)</p>
  </dd>
  <dt>
    <p>-</p>
  </dt>
  <dd>
    <p>As noted above, the events are passed up via a series of buffers stored into debugfs files. The size and number of buffers can be specified via the <strong>-b</strong> and <strong>-n</strong> arguments respectively.</p>
  </dd>
  <dt>
    <p>-</p>
  </dt>
  <dd>
    <p>blktrace stores the extracted data into files stored in the local directory. The format of the file names is (by default) <strong>device</strong>.<strong>blktrace</strong>.<strong>cpu</strong>, where <strong>device</strong> is the base device name (e.g, if we are tracing /dev/sda, the base device name would be <strong>sda</strong>); and <strong>cpu</strong> identifies a CPU for the event stream.</p><p>The <strong>device</strong> portion of the event file name can be changed via the <strong>-o</strong> option.</p>
  </dd>
  <dt>
    <p>-</p>
  </dt>
  <dd>
    <p>blktrace may also be run concurrently with blkparse to produce <strong>live</strong> output -- to do this specify <strong>-o -</strong> for blktrace.</p>
  </dd>
  <dt>
    <p>-</p>
  </dt>
  <dd>
    <p>The default behaviour for blktrace is to run forever until explicitly killed by the user (via a control-C, or sending SIGINT signal to the process via invocation the kill (1) utility). Also you can specify a run-time duration for blktrace via the <strong>-w</strong> option -- then blktrace will run for the specified number of seconds, and then halt.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>-A <em>hex-mask</em></p><p>--set-mask=<em>hex-mask</em></p><p>Set filter mask to <em>hex-mask</em> (see below for masks)</p><p>-a <em>mask</em></p><p>--act-mask=<em>mask</em></p><p>Add <em>mask</em> to current filter (see below for masks)</p><p>-b <em>size</em></p><p>--buffer-size=<em>size</em></p><p>Specifies buffer size for event extraction (scaled by 1024). The default buffer size is 512KiB.</p><p>-d <em>dev</em></p><p>--dev=<em>dev</em></p><p>Adds <em>dev</em> as a device to trace</p><p>-I <em>file</em></p><p>--input-devs=<em>file</em></p><p>Adds the devices found in <em>file</em> as devices to trace</p><p>-n <em>num-sub</em></p><p>--num-sub-buffers=<em>num-sub</em></p><p>Specifies number of buffers to use. blktrace defaults to 4 sub buffers.</p><p>-l</p><p>--listen</p><p>Run in network listen mode (blktrace server)</p><p>-h <em>hostname</em></p><p>--host=<em>hostname</em></p><p>Run in network client mode, connecting to the given host</p><p>-p <em>number</em></p><p>--port=<em>number</em></p><p>Network port to use (default 8462)</p><p>-s</p><p>--no-sendfile</p><p>Make the network client NOT use sendfile() to transfer data</p><p>-o <em>basename</em></p><p>--output=<em>basename</em></p><p>Specifies base name for input files. Default is device.blktrace.cpu. Specifying -o - runs in live mode with blkparse (writing data to standard out).</p><p>-D <em>dir</em></p><p>--output-dir=<em>dir</em></p><p>Prepend <em>file</em> to output file name(s)</p><p>This only works when supplying a single device, or when piping the output via "-o -" with multiple devices.</p><p>-r <em>rel-path</em></p><p>--relay=<em>rel-path</em></p><p>Specifies debugfs mount point</p><p>-v</p><p>--version</p><p>Outputs version</p><p>-V</p><p>--version</p><p>Outputs version</p><p>-w <em>seconds</em></p><p>--stopwatch=<em>seconds</em></p><p>Sets run time to the number of seconds specified</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILTER MASKS</h2>
        <div class="sectioncontent">
<p>The following masks may be passed with the <em>-a</em> command line option, multiple filters may be combined via multiple <em>-a</em> command line options.</p><p><em>barrier</em>: barrier attribute</p><p><em>complete</em>: completed by driver</p><p><em>fs</em>: requests</p><p><em>issue</em>: issued to driver</p><p><em>pc</em>: packet command events</p><p><em>queue</em>: queue operations</p><p><em>read</em>: read traces</p><p><em>requeue</em>: requeue operations</p><p><em>sync</em>: synchronous attribute</p><p><em>write</em>: write traces</p><p><em>notify</em>: trace messages</p><p><em>drv_data</em>: additional driver specific trace</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REQUEST TYPES</h2>
        <div class="sectioncontent">
<p>blktrace distinguishes between two types of block layer requests, file system and SCSI commands. The former are dubbed <strong>fs</strong> requests, the latter <strong>pc</strong> requests. File system requests are normal read/write operations, i.e. any type of read or write from a specific disk location at a given size. These requests typically originate from a user process, but they may also be initiated by the vm flushing dirty data to disk or the file system syncing a super or journal block to disk. <strong>pc</strong> requests are SCSI commands. blktrace sends the command data block as a payload so that blkparse can decode it.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>To trace the i/o on the device <em>/dev/hda</em> and parse the output to human readable form, use the following command:</p>
<pre>
    % blktrace -d /dev/sda -o - | blkparse -i -
</pre>
<p>This same behaviour can be achieve with the convenience script <em>btrace</em>. The command</p>
<pre>
    % btrace /dev/sda
</pre>
<p>has exactly the same effect as the previous command. See <em>btrace</em> (8) for more information.</p><p>To trace the i/o on a device and save the output for later processing with <em>blkparse</em>, use <em>blktrace</em> like this:</p>
<pre>
    % blktrace /dev/sda /dev/sdb
</pre>
<p>This will trace i/o on the devices <em>/dev/sda</em> and <em>/dev/sdb</em> and save the recorded information in the files <em>sda</em> and <em>sdb</em> in the current directory, for the two different devices, respectively.  This trace information can later be parsed by the <em>blkparse</em> utility:</p>
<pre>
    % blkparse sda sdb
</pre>
<p>which will output the previously recorded tracing information in human readable form to stdout.  See <em>blkparse</em> (1) for more information.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>blktrace was written by Jens Axboe, Alan D. Brunelle and Nathan Scott.  This man page was created from the blktrace documentation by Bas Zoetekouw.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">
<p>Report bugs to &lt;linux-btrace@vger.kernel.org&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2006 Jens Axboe, Alan D. Brunelle and Nathan Scott.</p><p>This is free software.  You may redistribute copies of it under the terms of the GNU General Public License &lt;http://www.gnu.org/licenses/gpl.html&gt;. There is NO WARRANTY, to the extent permitted by law.</p><p>This manual page was created for Debian by Bas Zoetekouw.  It was derived from the documentation provided by the authors and it may be used, distributed and modified under the terms of the GNU General Public License, version 2.</p><p>On Debian systems, the text of the GNU General Public License can be found in /usr/share/common-licenses/GPL-2.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO blktrace&hellip;</h2>
        <div class="sectioncontent">
<p>btrace (8), blkparse (1), verify_blkparse (1), blkrawverify (1), btt (1)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="blktool.8.html"><span aria-hidden="true">&larr;</span> blktool.8: Display or change block device settings</a></li>
   <li class="next"><a href="blockdev.8.html">blockdev.8: Call block device ioctls from the command line <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
