<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>snapper: Command-line program for filesystem snapshot management</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Command-line program for filesystem snapshot management">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="snapper (8) manual">
  <meta name="twitter:description" content="Command-line program for filesystem snapshot management">
  <meta name="twitter:image" content="https://www.carta.tech/images/snapper-snapper-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/snapper.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="snapper (8) manual" />
  <meta property="og:description" content="Command-line program for filesystem snapshot management" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/snapper-snapper-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">snapper<small> (8)</small></h1>
        <p class="lead">Command-line program for filesystem snapshot management</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/snapper.8.html">
      <span itemprop="name">snapper: Command-line program for filesystem snapshot management</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/snapper/">
      <span itemprop="name">snapper</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/snapper.8.html">
      <span itemprop="name">snapper: Command-line program for filesystem snapshot management</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>snapper</strong> [<em>--global-opts</em>] <em>command</em> [<em>--command-opts</em>] [<em>command-arguments</em>] <strong>snapper</strong> {--help}</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Snapper is a command-line program for filesystem snapshot management. It can create, delete and compare snapshots and undo changes done between snapshots.</p><p>Snapper never modifies the content of snapshots. Thus snapper creates read-only snapshots if supported by the kernel. Supported filesystems are btrfs and ext4 as well as snapshots of LVM logical volumes with thin-provisioning. Some filesystems might not be supported depending on your installation.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONCEPTS</h2>
        <div class="sectioncontent">
<h3>Configurations</h3>
<p>For each filesystem or subvolume that should be snapshotted by snapper, a configuration file is required, see <a href="../man5/snapper-configs.5.html"><strong>snapper-configs</strong>(5)</a>. The setup can be done with the create-config command.</p>
<h3>Snapshots</h3>
<p>Snapper distinguishes three types of snapshots.</p><p>pre</p><p>Pre snapshots should always have a corresponding post snapshot. The intention of pre/post snapshot pairs is to snapshot the filesystem before and after a modification.</p><p>post</p><p>See pre type.</p><p>single</p><p>These snapshots have no special relationship to other snapshots.</p><p>Note that filesystem-wise all three types are the same.</p>
<h3>Snapshot Description and Userdata</h3>
<p>With each snapshot a description and some userdata can be associated. The description is a string. The userdata is a list of key-value pairs where the keys and values are strings.</p>
<h3>Automatic Snapshot Creation</h3>
<p>Next to manual snapshot creation, snapshots are also created automatically.</p><p>A cron-job creates hourly snapshots.</p><p>Certain programs like YaST and zypper create pre/post snapshot pairs when modifying the system.</p>
<h3>Cleanup Algorithms</h3>
<p>Snapper provides several algorithms to clean up old snapshots. The algorithms are executed in a daily cron-job. This can be configured in the corresponding configurations files along with parameters for every algorithm.</p><p>number</p><p>Deletes old snapshots when a certain number of snapshots is reached.</p><p>timeline</p><p>Deletes old snapshots but keeps a number of hourly, daily, monthly and yearly snapshots.</p><p>empty-pre-post</p><p>Deletes pre/post snapshot pairs with empty diffs.</p>
<h3>Filters</h3>
<p>Some files keep state information of the system, e.g. /etc/mtab. Such files should never be reverted. To help users, snapper allows to ignore these files.</p><p>Each line in all files /etc/snapper/filters/*.txt specifies a pattern. When snapper computes the difference between two snapshots it ignores all files and directories matching any of those patterns by using <a href="../man3/fnmatch.3.html"><strong>fnmatch</strong>(3)</a> with the flag FNM_LEADING_DIR.</p><p>Note that filters do not exclude files or directories from being snapshotted. For that, use subvolumes or mount points.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">GLOBAL OPTIONS</h2>
        <div class="sectioncontent">
<p><strong>-q, --quiet</strong></p><p>Suppress normal output. Error messages will still be printed, though.</p><p><strong>-v, --verbose</strong></p><p>Increase verbosity.</p><p><strong>--utc</strong></p><p>Display dates and times in UTC.</p><p><strong>--iso</strong></p><p>Display dates and times in ISO format.</p><p><strong>-t, --table-style</strong></p><p>Specifies table style. Table style is identified by an integer number.</p><p><strong>-c, --config </strong><strong></strong><em>name</em></p><p>Use specified configuration instead of the default configuration. The default configuration is named "root".</p><p><strong>--no-dbus</strong></p><p>Operate without a DBus connection. Only works for some commands.</p><p>Use with caution since a running snapperd will not know about modifications made to the system.</p><p><strong>--version</strong></p><p>Print version and exit.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMMANDS</h2>
        <div class="sectioncontent">
<p>Snapper provides a number of <em>commands</em>. Each command accepts the options listed in the GLOBAL OPTIONS section. These options must be specified <em>before</em> the command name. In addition, many commands have specific options, which are listed in this section. These command-specific options must be specified <em>after</em> the name of the command and <em>before</em> any of the command arguments.</p><p><strong>help</strong></p><p>Show short help text.</p><p><strong>list-configs</strong></p><p>List available configurations.</p><p><strong>create-config [options] </strong><strong></strong><em>subvolume</em></p><p>Create a new configuration for a filesystem or subvolume. For this command you will likely need the global option <strong>--config</strong>, see GLOBAL OPTIONS and CONCEPTS.</p><p><strong>-f, --fstype</strong> <em>fstype</em></p><p>Manually set filesystem type. Supported values are btrfs, ext4 and lvm. For lvm, snapper uses LVM thin-provisioned snapshots. The filesystem type on top of LVM must be provided in parentheses, e.g. lvm(xfs).</p><p>Without this option snapper tries to detect the filesystem.</p><p><strong>-t, --template</strong> <em>name</em></p><p>Name of template for the new configuration file.</p><p><strong>delete-config</strong></p><p>Delete a configuration for a filesystem or subvolume. For this command you will likely need to global option <strong>--config</strong>, see GLOBAL OPTIONS and CONCEPTS.</p><p><strong>get-config</strong></p><p>Displays the settings of the configuration.</p><p><strong>set-config</strong> <em>configdata</em></p><p>Changes the settings of the configuration. The settings <em>configdata</em> are a list of key-value-pairs separated by spaces and the key and value must be separated by an equal sign, e.g. "NUMBER_CLEANUP=yes NUMBER_LIMIT=10". The value of SUBVOLUME and FSTYPE cannot be changed.</p><p><strong>list (ls) [options]</strong></p><p>List snapshots.</p><p><strong>-t, --type</strong> <em>type</em></p><p>Selects type of snapshots to list. Possible values are all, single and pre-post.</p><p><strong>create [options]</strong></p><p>Create a new snapshot.</p><p><strong>-t, --type</strong> <em>type</em></p><p>Specifies the type of the new snapshot. Possible values are single, pre and post.</p><p><strong>--pre-number</strong> <em>number</em></p><p>For post snapshots the number of the pre snapshot must be provided.</p><p><strong>-p, --print-number</strong></p><p>Print number of the created snapshot.</p><p><strong>-d, --description</strong> <em>description</em></p><p>Description for the snapshot.</p><p><strong>-c, --cleanup-algorithm</strong> <em>cleanup-algorithm</em></p><p>Set the cleanup algorithm for the snapshot.</p><p><strong>-u, --userdata</strong> <em>userdata</em></p><p>Set userdata for the snapshot. The key-value pairs must be separated by comma and the key and value must be separated by an equal sign, e.g. requestid=42,user=arthur.</p><p><strong>--command</strong> <em>command</em></p><p>Create a pre and post snapshot and run command in between.</p><p><strong>modify [options] </strong><strong></strong><em>number</em></p><p>Modify a snapshot.</p><p><strong>-d, --description</strong> <em>description</em></p><p>New description for snapshot.</p><p><strong>-c, --cleanup-algorithm</strong> <em>cleanup-algorithm</em></p><p>Set the cleanup algorithm for the snapshot.</p><p><strong>-u, --userdata</strong> <em>userdata</em></p><p>Set userdata for the snapshot. The key-value pairs must be separated by comma and the key and value must be separated by an equal sign, e.g. requestid=42,user=arthur.</p><p><strong>delete (remove|rm) </strong><strong></strong><em>number</em><strong> | </strong><strong></strong><em>number1-number2</em></p><p>Delete a snapshot or a range of snapshots.</p><p><strong>mount </strong><strong></strong><em>number</em></p><p>Mount a snapshot. Not required for all filesystem types.</p><p><strong>umount </strong><strong></strong><em>number</em></p><p>Unmount a snapshot. Not required for all filesystem types.</p><p><strong>status [options] </strong><strong></strong><em>number1</em><strong>..</strong><strong></strong><em>number2</em></p><p>Compare the snapshots <em>number1</em> and <em>number2</em>. This will show a list of files and directories that have been created, modified or deleted in the time between the two snapshots have been made.</p><p><strong>-o, --output</strong> <em>file</em></p><p>Write output to file <em>file</em>.</p><p>The output consists of a string encoding the status followed by the filename. The characters of the status string are:</p><p>A "+" means the file was created, a "-" means the file was deleted. A "c" means the content of the file has changed and a "t" means the type of the file has changed (e.g. from regular file to directory).</p><p>A "p" means the permissions are have changed.</p><p>An "u" means the user ownership has changed.</p><p>A "g" means the group ownership has changed.</p><p>A "x" means the extended attribute information has changed.</p><p>An "a" means the ACL information has changed.</p><p>If there is no change a "." is outputted.</p><p><strong>diff [options] </strong><strong></strong><em>number1</em><strong>..</strong><strong></strong><em>number2</em><strong> [files]</strong></p><p>Compare the snapshots <em>number1</em> and <em>number2</em>. This will show a diff of the content of files and directories that have been created, modified or deleted in the time between the two snapshots have been made.</p><p><strong>undochange [options] </strong><strong></strong><em>number1</em><strong>..</strong><strong></strong><em>number2</em><strong> [files]</strong></p><p>Undo changes done between snapshot <em>number1</em> and <em>number2</em>.</p><p><strong>-i, --input</strong> <em>file</em></p><p>Read files for which to undo changes from file <em>file</em>.</p><p><strong>rollback [options] [</strong><strong></strong><em>number</em><strong>]</strong></p><p>Creates two new snapshots and sets the default subvolume. Per default the system boots from the default subvolume of the root filesystem. The exact actions depend on whether a number is provided or not:</p><p>Without a number, a first read-only snapshot of the default subvolume is created. A second read-write snapshot of the current system is created. The system is set to boot from the second snapshot.</p><p>With a number, a first read-only snapshot of the current system in created. A second read-write snapshot is created of <em>number</em>. The system is set to boot from the second snapshot.</p><p>Rollback is only supported with btrfs and requires a properly configured system.</p><p><strong>-p, --print-number</strong></p><p>Print number of the second created snapshot.</p><p><strong>-d, --description</strong> <em>description</em></p><p>Description for the snapshot.</p><p><strong>-c, --cleanup-algorithm</strong> <em>cleanup-algorithm</em></p><p>Set the cleanup algorithm for the snapshot.</p><p><strong>-u, --userdata</strong> <em>userdata</em></p><p>Set userdata for the snapshot. The key-value pairs must be separated by comma and the key and value must be separated by an equal sign, e.g. requestid=42,user=arthur.</p><p><strong>cleanup </strong><strong></strong><em>cleanup-algorithm</em></p><p>Run the cleanup algorithm <em>cleanup-algorithm</em>. Currently implemented cleanup algorithms are number, timeline and empty-pre-post.</p><p><strong>xadiff </strong><strong></strong><em>number1</em><strong>..</strong><strong></strong><em>number2</em><strong> [files]</strong></p><p>Compare the extended attributes between snapshot <em>number1</em> and <em>number2</em>. See examples below:</p><p>+:user.foo for created attributes</p><p>-:user.bar for removed attributes</p><p>-+:security.selinux for modified attributes</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PERMISSIONS</h2>
        <div class="sectioncontent">
<p>Non-root users can be allowed to use a configuration by setting ALLOW_USERS or ALLOW_GROUPS in the config file. For all operations to work, the user must also be able to read and access the .snapshots directory inside the subvolume. The .snapshots directory must be owned by root and must not be writable by anybody else.</p><p>Here are some methods how to achieve that:</p><p>Make the directory accessible for everyone:</p><p><strong>chmod a+rx .snapshots</strong></p><p>Make the directory accessible for a group the user belongs to, e.g.:</p><p><strong>chown :users .snapshots</strong></p><p>Make the directory accessible for the user using ACLs, e.g.:</p><p><strong>setfacl -m u:tux:rx .snapshots</strong></p><p>The last method can be performed by snapper, see the SYNC_ACL setting in <a href="../man5/snapper-configs.5.html"><strong>snapper-configs</strong>(5)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/etc/sysconfig/snapper</p><p>Global configuration file.</p><p>/etc/snapper/configs</p><p>Directory containing configuration files.</p><p>/etc/snapper/config-templates</p><p>Directory containing configuration templates.</p><p>/etc/snapper/filters/*.txt</p><p>Filter files.</p><p>/var/log/snapper.log</p><p>Logfile. Please include this file in bug reports.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>There is no mechanism to ensure consistency of the files while a snapshot it made. E.g. the files of a database can be inconsistent while the database is running.</p><p>Consistency after undochange is not guaranteed. E.g. when the creation of a user is undone, there might still exist files from that user.</p><p>Support for individual filesystems, rollback and extended attributes are compile-time options and may not be available.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HOMEPAGE</h2>
        <div class="sectioncontent">
<p>\m[blue]<strong>http://snapper.io/</strong>\m[]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Arvin Schnell &lt;aschnell@suse.de&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO snapper&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/snapper-configs.5.html"><strong>snapper-configs</strong>(5)</a>, <strong>snapper-zypp-plugin</strong>(8), <a href="../man8/pam_snapper.8.html"><strong>pam_snapper</strong>(8)</a>, <a href="../man8/btrfs.8.html"><strong>btrfs</strong>(8)</a>, <a href="../man8/lvm.8.html"><strong>lvm</strong>(8)</a>, <a href="../man5/attr.5.html"><strong>attr</strong>(5)</a>, <strong>acl</strong>(5)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="sn.8.html"><span aria-hidden="true">&larr;</span> sn.8: The sn news system.</a></li>
   <li class="next"><a href="snapperd.8.html">snapperd.8: Dbus daemon for snapper <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
