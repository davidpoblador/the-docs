<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>amsamba: Amanda application to interface with smbclient</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Amanda application to interface with smbclient">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="amsamba (8) manual">
  <meta name="twitter:description" content="Amanda application to interface with smbclient">
  <meta name="twitter:image" content="https://www.carta.tech/images/amanda-common-amsamba-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/amsamba.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="amsamba (8) manual" />
  <meta property="og:description" content="Amanda application to interface with smbclient" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/amanda-common-amsamba-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">amsamba<small> (8)</small></h1>
        <p class="lead">Amanda application to interface with smbclient</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/amsamba.8.html">
      <span itemprop="name">amsamba: Amanda application to interface with smbclient</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/amanda-common/">
      <span itemprop="name">amanda-common</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/amsamba.8.html">
      <span itemprop="name">amsamba: Amanda application to interface with smbclient</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Amsamba is an Amanda Application API script. It should not be run by users directly. It uses smbclient to backup and restore data.</p><p>The <strong>diskdevice</strong> in the disklist (DLE) must have the form &apos;//CIFSHOST/SHARE/SUBDIR&apos; where CIFSHOST is the CIFS host containing the data to be backed up, SHARE is the share to connect, and subdir is the subdirectory to backup. &apos;/subdir&apos; can be ommited, in which case the complete share is archived.</p><p>Unlike most applications, amsamba backs up and restores data located on a different system from that where amsamba itself runs. The host containing the data is the CIFS host. In practice, amsamba is usually run on the same system as the Amanda server, with a DLE like</p>
<pre>
localhost "//CIFSHOST/SHARENAME" amsamba-dumptype
</pre>
<p>Include or exclude can be used, but not both. The path for &apos;exclude list&apos; or &apos;include list&apos; must be absolute path on the CIFS host. The estimate calculates the complete size of the share, without regard for include or exclude directives. It will be larger than the actual dump if you use include or exclude. Using &apos;estimate server&apos; in the dumptype could give better estimate.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PROPERTIES</h2>
        <div class="sectioncontent">
<p>This section lists the properties that control amsamba&apos;s functionality. See <a href="../man7/amanda-applications.7.html"><strong>amanda-applications</strong>(7)</a> for information on application properties and how they are configured.</p><p>SMBCLIENT-PATH</p><p>The path to the smbclient binary.  The default is set when Amanda is built by the --with-smbclient configure option.</p><p>GNUTAR-PATH</p><p>The path to the gnutar binary.  The default is set when Amanda is built by the --with-gnutar configure option. gnutar is used to create the index.</p><p>AMANDAPASS</p><p>Location of the amandapass file, defaulting to "$CONFIG_DIR/amandapass". Relative pathnames are relative to the configuration directory, "$CONFIG_DIR/&lt;config&gt;". Note that this file is located on the client, not on the server. The format of the file is as follow:</p>
<pre>
  Sharename User%Password Domain
</pre>
<p>Sharename is &apos;//HOST/SHARE&apos; without the SUBDIR. Sharename can be quoted, it can be &apos;*&apos; to match all share, it can be &apos;//pc-host/*&apos; to match all share on pc-host. User is the username use to connect to the share. Password is the password use to connect to the share. &apos;%Password&apos; is optional if the user can connect to the share without password. &apos;User%Password&apos; is optional, the user &apos;guest&apos; without password is use to connect to the share. Domain is optional. Example:</p>
<pre>
  //another-pc/share otheruser%otherpw domain
  //another-pc/share otheruser%otherpw
  //another-pc/share myuser mydomain
  //another-pc/share myuser
  //another-pc/share
</pre>
<p>ALLOW-ANONYMOUS</p><p>This username without password is used to connect to the share if no matching entry is found in the amandapass file.</p><p>DIRECTORY</p><p>For restore command only, the data is recoved in that directory. Must be a unix path for "tar" RECOVER-MODE or a smb path for "smb" recover-MODE.</p><p>RECOVER-MODE</p><p>"tar" or "smb", default to "tar". If "tar", the data is recovered on the local machine, If "smb", the data is recovered on the smb client machine.</p><p>REGEX-MATCH</p><p>If set to "YES", amsamba use the &apos;r&apos; tarmode which uses regex to do the include and exclude pattern matching, it can be slow.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INCLUDE AND EXCLUDE LISTS</h2>
        <div class="sectioncontent">
<p>This application supplies exclude lists via the <strong>smbclient</strong> <strong>-TX</strong> option. Normal shell-style wildcard expressions, using * and ?, are not supported. All expressions are matched only from the base directory of the DLE. Expressions that match a directory may have a leading or trailing "/". Example expressions:</p>
<pre>
  ./temp-files           # exclude top-level dir "temp-files" entirely
  ./temp-files/          # same
  /temp-files            # same
  temp-files             # same
  ./temp-files/*         # BAD: does nothing
  *.iso                  # BAD: does nothing
  proxy/local/cache      # exclude "cache" in dir "proxy/local"
</pre>
<p>Include lists are supported only if excludes are not given. They are handled via the <strong>smbclient</strong> <strong>-TI</strong> option. Include matching is identical to the exclude matching described above.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<pre>
  define application app_amsamba {
    property "SMBCLIENT-PATH" "/usr/bin/smbclient"
    property "GNUTAR-PATH" "/bin/tar"
    property "AMANDAPASS" /etc/amandapass"
    property "ALLOW-ANONYMOUS" "guest"
  }
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO amsamba&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/amanda.8.html"><strong>amanda</strong>(8)</a>, <a href="../man5/amanda.conf.5.html"><strong>amanda.conf</strong>(5)</a>, <a href="../man7/amanda-applications.7.html"><strong>amanda-applications</strong>(7)</a></p><p>The Amanda Wiki: : http://wiki.zmanda.com/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p><strong>Jean-Louis Martineau</strong> &lt;martineau@zmanda.com&gt;</p><p>Zmanda, Inc. (http://www.zmanda.com)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="amrmtape.8.html"><span aria-hidden="true">&larr;</span> amrmtape.8: Remove a tape from the amanda database</a></li>
   <li class="next"><a href="amserverconfig.8.html">amserverconfig.8: Program to setup initial amanda configuration <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
