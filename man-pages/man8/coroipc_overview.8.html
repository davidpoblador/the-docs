<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>coroipc_overview: Overview of coroipc libraries</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Overview of coroipc libraries">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="coroipc_overview (8) manual">
  <meta name="twitter:description" content="Overview of coroipc libraries">
  <meta name="twitter:image" content="https://www.carta.tech/images/corosync-coroipc_overview-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/coroipc_overview.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="coroipc_overview (8) manual" />
  <meta property="og:description" content="Overview of coroipc libraries" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/corosync-coroipc_overview-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">coroipc_overview<small> (8)</small></h1>
        <p class="lead">Overview of coroipc libraries</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/coroipc_overview.8.html">
      <span itemprop="name">coroipc_overview: Overview of coroipc libraries</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/corosync/">
      <span itemprop="name">corosync</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/coroipc_overview.8.html">
      <span itemprop="name">coroipc_overview: Overview of coroipc libraries</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">OVERVIEW</h2>
        <div class="sectioncontent">
<p>The coroipcs and coroipcc libraries provide a generically reusable very high performance shared memory IPC sytem for client and service applications. It supports many features including:</p><p>65536 user services and 65536 command ids per service.</p><p>Shared memory implementation for very high performance.</p><p>A synchronous request/response channel and asynchronous response channel per ipc connection.</p><p>User defined private data per IPC connection.</p><p>Ability to call a function per service on ipc connection and disconnection.</p><p>Authenticated IPC connection with ability for developer to define which UIDs and GIDs are valid at connection time.</p><p>Fully abstracted poll system so that any poll library may be used.</p><p>User defined selector for determining the proper function to call per service and id.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Description of the libraries</h2>
        <div class="sectioncontent">
<p>There are two shared libraries available for developing IPC client applications.</p><p>The first library is coroipcs.so which is responsible for the server implementation.  This library should be linked with the server and then initialized with <strong>coroipcs_init</strong>(3).</p><p>Once the library is initialized, it will provide service to coroipcc.so library users.</p><p>The second library is coroipcc.so which is responsible for the client implementation.  This library should be linked with the client and requires no initialization.  This library provides communication functions for sending and receiving synchronous requests, and also reading asynchronous message requests from the server.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Initializing the coroipcs library</h2>
        <div class="sectioncontent">
<p>To use the coroipcs library, the developer creates a coroipcs_init_state structure and populates it with function names.  The functions do various operations described in <strong>coroipcs_init</strong>(3) man page.  Not all operations must be specified.  If some are missing, the corosync ipcs library will automatically populate the structure with internal versions which provide basic functionality.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Communicating with the coroipcc clients</h2>
        <div class="sectioncontent">
<p>Every ipc connection is represented by a void * pointer which uniquely identifies the data set for the IPC connection.  Each IPC connection also contains user defined private data.  To obtain this private data pointer, the function <strong>coroipcs_private_data_get</strong>(3) function can be called.</p><p>There are two channels for communication.  The primary channel is the synchronous request/response channel.  Another channel is available for out of band asynchronous responses from the server.</p><p>To send a response on the syncronous channel,  <strong>coroipcs_response_send</strong>(3) or <strong>coroipcs_response_iov_send</strong>(3) should be used.  To send a message on the asynchronous channel, <strong>coroipcs_dispatch_send</strong>(3) or <strong>coroipc_dispatch_iov_send</strong>(3) should be used.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">The abstracted poll system</h2>
        <div class="sectioncontent">
<p>There are many different poll systems in use in applications.  They are usually intricately tied up in the implementation of the application and each provide different APIs and functionality.  To manage this, the coroipcs library provides callbacks in <strong>coroipcs_init</strong>(3) which should be called when a new connection should be added for accept system calls or to dispatch messages.</p><p>These callbacks add the relevant fd to the application's poll system.  When the application poll system triggers the callback registered by the user defined poll adding functions, they then call either <strong>coroipc_handler_accept</strong>(3) or <strong>coroipc_handler_dispatch</strong>(3).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Initializing the coroipcc library</h2>
        <div class="sectioncontent">
<p>No initialization is required in the coroipcc library.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Lifecycle of an IPC connection.</h2>
        <div class="sectioncontent">
<p>An IPC connection is made to the server with <strong>coroipcc_service_connect</strong>(3).  This function connects to the server and requests channels be created for communication.  To disconnect, the client either exits or executes the function <strong>coroipcc_service_disconnect</strong>(3).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Synchronous communication</h2>
        <div class="sectioncontent">
<p>There are two functions for sending a request and receiving a response.  The first function <strong>coroipcc_msg_send_reply_receive</strong>(3) sends an iovector request and receives a response.  This function copies the response into the response buffer.  the second function <strong>coroipcc_msg_end_reply_receive_in_buf</strong>(3) does not copy the response buffer and allows for zero-copy reading of the response when the lifetime of the response buffer is known.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Asynchronous communication</h2>
        <div class="sectioncontent">
<p>The <strong>coroipcc_dispatch_recv</strong>(3) function receives an out-of-band asyncronous message.  Unlike the synchronous communication channel, the asynchronous messages are queued and can provide very high out-of-band performance.</p><p>To determine when to call <strong>coroipcc_dispatch_recv</strong>(3) the <strong>corosync_fd_get</strong>(3) call is used to obtain a file descriptor used in the <a href="../man2/poll.2.html"><strong>poll</strong>(2)</a> or <a href="../man2/select.2.html"><strong>select</strong>(2)</a> system calls.</p><p>Finally the current dispatch flow control state can be obtained with <strong>coroipcc_flow_control_get</strong>(3).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Performance</h2>
        <div class="sectioncontent">
<p>The ipc system is tuned for very high performance while also being comletely abstracted from the underlying poll mechanism and any internalisms required by the server.  The ipc system achieves such high performance by using shared memory as oppossed to slower techniques such as UNIX_PF sockets.</p><p>We intend to do further development to allow syncronous requests to return messages in an asyncronous way to avoid blocking involved in the syncronous request/response model used today for higher throughput in some use cases.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Security</h2>
        <div class="sectioncontent">
<p>The ipc system uses default operating system security mechanics to ensure ipc connections are validated.  A callback used with <strong>coroipcs_init</strong>(3) is called for every new ipc connection with the parameters of UID and GID.  The callback then determines if the UID and GID are authenticated for communication.  More about this topic can be viewed in the <strong>coroipcs_init</strong>(3) man page.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO coroipc_overview&hellip;</h2>
        <div class="sectioncontent">
<p><strong>coroipcs_ipc_init</strong>(3), <strong>coroipcs_ipc_exit</strong>(3), <strong>coroipcs_private_data_get</strong>(3), <strong>coroipcs_respone_send</strong>(3), <strong>coroipcs_response_iov_send</strong>(3), <strong>coroipcs_dispatch_send</strong>(3), <strong>coroipcs_dispatch_iov_send</strong>(3), <strong>coroipcs_refcount_inc</strong>(3), <strong>coroipcs_refcount_dec</strong>(3), <strong>coroipcs_handler_accept</strong>(3), <strong>coroipcs_handler_dispatch</strong>(3),</p><p><strong>cooripcc_service_connect</strong>(3), <strong>coroipcc_service_disconnect</strong>(3), <strong>coroipcc_msg_send_reply_receive</strong>(3), <strong>coroipcc_msg_send_reply_receive_in_buf</strong>(3), <strong>coroipcc_dispatch_recv</strong>(3), <strong>coroipcc_fd_get</strong>(3),</strong> <strong>coroipcc_dispatch_flow_control_get</strong>(3)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="coraid-update.8.html"><span aria-hidden="true">&larr;</span> coraid-update.8: Upload an update file to a coraid appliance</a></li>
   <li class="next"><a href="corosync.8.html">corosync.8: The corosync cluster engine. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
