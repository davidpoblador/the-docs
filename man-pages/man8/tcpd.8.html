<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>tcpd: Access control facility for internet services</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Access control facility for internet services">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="tcpd (8) manual">
  <meta name="twitter:description" content="Access control facility for internet services">
  <meta name="twitter:image" content="https://www.carta.tech/images/tcpd-tcpd-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/tcpd.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="tcpd (8) manual" />
  <meta property="og:description" content="Access control facility for internet services" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/tcpd-tcpd-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">tcpd<small> (8)</small></h1>
        <p class="lead">Access control facility for internet services</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/tcpd.8.html">
      <span itemprop="name">tcpd: Access control facility for internet services</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/tcpd/">
      <span itemprop="name">tcpd</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/tcpd.8.html">
      <span itemprop="name">tcpd: Access control facility for internet services</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <em>tcpd</em> program can be set up to monitor incoming requests for <em>telnet</em>, <em>finger</em>, <em>ftp</em>, <em>exec</em>, <em>rsh</em>, <em>rlogin</em>, <em>tftp</em>, <em>talk</em>, <em>comsat</em> and other services that have a one-to-one mapping onto executable files.</p><p>The program supports both 4.3BSD-style sockets and System V.4-style TLI.  Functionality may be limited when the protocol underneath TLI is not an internet protocol.</p><p>There are two possible modes of operation: execution of <em>tcpd</em> before a service started by <em>inetd</em>, or linking a daemon with the <em>libwrap</em> shared library as documented in the <a href="../man3/hosts_access.3.html"><strong>hosts_access</strong>(3)</a> manual page. Operation when started by <em>inetd</em> is as follows: whenever a request for service arrives, the <em>inetd</em> daemon is tricked into running the <em>tcpd</em> program instead of the desired server. <em>tcpd</em> logs the request and does some additional checks. When all is well, <em>tcpd</em> runs the appropriate server program and goes away.</p><p>Optional features are: pattern-based access control, client username lookups with the RFC 931 etc. protocol, protection against hosts that pretend to have someone elses host name, and protection against hosts that pretend to have someone elses network address.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOGGING</h2>
        <div class="sectioncontent">
<p>Connections that are monitored by <em>tcpd</em> are reported through the <a href="../man3/syslog.3.html"><strong>syslog</strong>(3)</a> facility. Each record contains a time stamp, the client host name and the name of the requested service.  The information can be useful to detect unwanted activities, especially when logfile information from several hosts is merged.</p><p>In order to find out where your logs are going, examine the syslog configuration file, usually /etc/syslog.conf.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ACCESS CONTROL</h2>
        <div class="sectioncontent">
<p>Optionally, <em>tcpd</em> supports a simple form of access control that is based on pattern matching.  The access-control software provides hooks for the execution of shell commands when a pattern fires.  For details, see the <a href="../man5/hosts_access.5.html"><strong>hosts_access</strong>(5)</a> manual page.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HOST NAME VERIFICATION</h2>
        <div class="sectioncontent">
<p>The authentication scheme of some protocols (<em>rlogin, rsh</em>) relies on host names. Some implementations believe the host name that they get from any random name server; other implementations are more careful but use a flawed algorithm.</p><p><em>tcpd</em> verifies the client host name that is returned by the address-&gt;name DNS server by looking at the host name and address that are returned by the name-&gt;address DNS server.  If any discrepancy is detected, <em>tcpd</em> concludes that it is dealing with a host that pretends to have someone elses host name.</p><p>If the sources are compiled with -DPARANOID, <em>tcpd</em> will drop the connection in case of a host name/address mismatch. Otherwise, the hostname can be matched with the <em>PARANOID</em> wildcard, after which suitable action can be taken.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HOST ADDRESS SPOOFING</h2>
        <div class="sectioncontent">
<p>Optionally, <em>tcpd</em> disables source-routing socket options on every connection that it deals with. This will take care of most attacks from hosts that pretend to have an address that belongs to someone elses network. UDP services do not benefit from this protection. This feature must be turned on at compile time.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RFC 931</h2>
        <div class="sectioncontent">
<p>When RFC 931 etc. lookups are enabled (compile-time option) <em>tcpd</em> will attempt to establish the name of the client user. This will succeed only if the client host runs an RFC 931-compliant daemon. Client user name lookups will not work for datagram-oriented connections, and may cause noticeable delays in the case of connections from PCs.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>The details of using <em>tcpd</em> depend on pathname information that was compiled into the program.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE 1</h2>
        <div class="sectioncontent">
<p>This example applies when <em>tcpd</em> expects that the original network daemons will be moved to an "other" place.</p><p>In order to monitor access to the <em>finger</em> service, move the original finger daemon to the "other" place and install tcpd in the place of the original finger daemon. No changes are required to configuration files.</p>
<pre>
# mkdir /other/place
# mv /usr/sbin/in.fingerd /other/place
# cp tcpd /usr/sbin/in.fingerd
</pre>
<p>The example assumes that the network daemons live in /usr/sbin. On some systems, network daemons live in /usr/sbin or in /usr/libexec, or have no `in.\' prefix to their name.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE 2</h2>
        <div class="sectioncontent">
<p>This example applies when <em>tcpd</em> expects that the network daemons are left in their original place.</p><p>In order to monitor access to the <em>finger</em> service, perform the following edits on the <em>inetd</em> configuration file (usually <em>/etc/inetd.conf</em>):</p>
<pre>
finger  stream  tcp  nowait  nobody  /usr/sbin/in.fingerd  in.fingerd

becomes:

finger  stream  tcp  nowait  nobody  /usr/sbin/tcpd     in.fingerd

</pre>
<p>The example assumes that the network daemons live in /usr/sbin. On some systems, network daemons live in /usr/sbin or in /usr/libexec, the daemons have no `in.\' prefix to their name, or there is no userid field in the inetd configuration file.</p><p>Similar changes will be needed for the other services that are to be covered by <em>tcpd</em>.  Send a `kill -HUP\' to the <strong>inetd</strong>(8) process to make the changes effective.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE 3</h2>
        <div class="sectioncontent">
<p>In the case of daemons that do not live in a common directory ("secret" or otherwise), edit the <em>inetd</em> configuration file so that it specifies an absolute path name for the process name field. For example:</p>
<pre>
    ntalk  dgram  udp  wait  root  /usr/sbin/tcpd  /usr/local/lib/ntalkd

</pre>
<p>Only the last component (ntalkd) of the pathname will be used for access control and logging.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Some UDP (and RPC) daemons linger around for a while after they have finished their work, in case another request comes in.  In the inetd configuration file these services are registered with the <em>wait</em> option. Only the request that started such a daemon will be logged.</p><p>The program does not work with RPC services over TCP. These services are registered as <em>rpc/tcp</em> in the inetd configuration file. The only non-trivial service that is affected by this limitation is <em>rexd</em>, which is used by the <em>on(1)</em> command. This is no great loss.  On most systems, <em>rexd</em> is less secure than a wildcard in /etc/hosts.equiv.</p><p>RPC broadcast requests (for example: <em>rwall, rup, rusers</em>) always appear to come from the responding host. What happens is that the client broadcasts the request to all <em>portmap</em> daemons on its network; each <em>portmap</em> daemon forwards the request to a local daemon. As far as the <em>rwall</em> etc.  daemons know, the request comes from the local host.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>The default locations of the host access control tables are:</p><p>/etc/hosts.allow</p><p>/etc/hosts.deny</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO tcpd&hellip;</h2>
        <div class="sectioncontent">

<pre>
<a href="../man3/hosts_access.3.html"><strong>hosts_access</strong>(3)</a>, functions provided by the libwrap library.
<a href="../man5/hosts_access.5.html"><strong>hosts_access</strong>(5)</a>, format of the tcpd access control tables.
<strong>syslog.conf</strong>(5), format of the syslogd control file.
<strong>inetd.conf</strong>(5), format of the inetd control file.
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">

<pre>
Wietse Venema (wietse@wzv.win.tue.nl),
Department of Mathematics and Computing Science,
Eindhoven University of Technology
Den Dolech 2, P.O. Box 513,
5600 MB Eindhoven, The Netherlands

</pre>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="tcpcryptd.8.html"><span aria-hidden="true">&larr;</span> tcpcryptd.8: Implement the tcpcrypt protocol by transparently modifying network i/o</a></li>
   <li class="next"><a href="tcpdchk.8.html">tcpdchk.8: Tcp wrapper configuration checker <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
