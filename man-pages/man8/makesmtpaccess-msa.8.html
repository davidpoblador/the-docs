<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>makesmtpaccess-msa: Build esmtp server access file</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Build esmtp server access file">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="makesmtpaccess-msa (8) manual">
  <meta name="twitter:description" content="Build esmtp server access file">
  <meta name="twitter:image" content="https://www.carta.tech/images/courier-mta-makesmtpaccess-msa-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/makesmtpaccess-msa.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="makesmtpaccess-msa (8) manual" />
  <meta property="og:description" content="Build esmtp server access file" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/courier-mta-makesmtpaccess-msa-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">makesmtpaccess-msa<small> (8)</small></h1>
        <p class="lead">Build esmtp server access file</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/makesmtpaccess-msa.8.html">
      <span itemprop="name">makesmtpaccess-msa: Build esmtp server access file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/courier-mta/">
      <span itemprop="name">courier-mta</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/makesmtpaccess-msa.8.html">
      <span itemprop="name">makesmtpaccess-msa: Build esmtp server access file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>makesmtpaccess</strong> <strong>makesmtpaccess-msa</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>makesmtpaccess</strong> rebuilds the contents of the /etc/courier/smtpaccess.dat database from the contents of the files in the /etc/courier/smtpaccess directory. When the <strong>esmtpd</strong> script starts <strong>couriertcpd</strong>, the script specifies /etc/courier/smtpaccess.dat file to control access to the Courier mail server&apos;s ESMTP daemon. The <strong>makesmtpaccess</strong> script must be run before any changes in the /etc/courier/smtpaccess directory take effect. Note that this build of courier ignores any files that match the regex pattern ".*.dpkg-[a-z]*" (dpkg configuration file handling) and ".*~" (backup files of some editors).</p><p>The \m[blue]<strong></strong><strong>couriertcpd</strong>(8)\m[]\s-2\u[1]\d\s+2 manual page describes the general format of the access file.</p><p>The default Courier mail server configuration uses the same access file, /etc/courier/smtpaccess.dat for both the regular ESMTP server, and the message submission server on port 587 (\m[blue]<strong>RFC 2476</strong>\m[]\s-2\u[2]\d\s+2). It is possible to use different access files. To do so, create a different access file, edit /etc/courier/esmtpd-msa, and set <strong>ACCESSFILE</strong> to the filename of the access file directory (the directory containing the plain text files, not the .dat file). Then, use <strong>makesmtpaccess-msa</strong> instead of <strong>makesmtpaccess</strong> to build the .dat file.</p><h3>The smtpaccess configuration file</h3>
<p>The \m[blue]<strong></strong><strong>couriertcpd</strong>(8)\m[]\s-2\u[1]\d\s+2 manual page describes the generic format of the access file. The access file specifies what should be done with connections from defined IP address ranges. The basic choices are to accept or reject the connection. Also, the generic format of the access file allows arbitrary environment variables to be set based on the connection&apos;s remote IP address.</p><p>The Courier mail server&apos;s ESMTPD server understands the following environment variables, which may be set in the access file:</p><p>BLOCK</p><p>If this variable is set to a non-empty value, all mail will be rejected for this connection. The contents of the environment variable will be used as the error message. This is not the same as the <strong>couriertcpd</strong> access file setting that immediately drops the connection. The incoming connection is accepted, but every message will be rejected.</p><p>FAXRELAYCLIENT</p><p>Allow the client to send faxes via the \m[blue]<strong></strong><a href="../man8/courierfax.8.html"><strong>courierfax</strong>(8)</a>\m[]\s-2\u[3]\d\s+2 module.</p><p><strong>Note</strong></p><p>When ESMTP authentication is enabled, a successful authentication automatically sets <strong>FAXRELAYCLIENT</strong>.</p><p>RELAYCLIENT</p><p>Allow the client to relay mail.</p><p><strong>Note</strong></p><p>When ESMTP authentication is enabled, a successful authentication automatically sets <strong>RELAYCLIENT</strong>.</p><p>The following options are typically set globally in the esmtpd configuration file, but may be overriden in the smtpaccess configuration file:</p><p>BOFHCHECKDNS</p><p>Do not check the return address&apos;s domain in DNS if this environment variable is set to 0. The default value of <strong>BOFHCHECKDNS</strong> is 1.</p><p><strong>Note</strong></p><p>Turning off the DNS check disables a number of options in the bofh configuration file. See \m[blue]<strong></strong><a href="../man8/courier.8.html"><strong>courier</strong>(8)</a>\m[]\s-2\u[4]\d\s+2 for more information.</p><p>BOFHCHECKHELO</p><p>Set this variable to 1 to check the <em>hostname</em> argument to the ESMTP HELO/EHLO command, as follows:</p><p>A <em>hostname</em> that&apos;s actually an IP address, and is the same as the connecting ESMTP client&apos;s IP address, is valid.</p><p>Otherwise <em>hostname</em> should be a valid DNS name with MX and/or A records, with at least one record matching the connecting ESMTP client&apos;s IP address.</p><p>An ESMTP client with relaying privileges (either due to <strong>RELAYCLIENT</strong> explicitly set, or if it succesfully authenticates) may use anything for an EHLO/HELO. The EHLO/HELO argument coming from an authenticated/relaying client is not checked.</p><p>BOFHNOEXPN</p><p>Disable the EXPN command if this environment variable is set to 1.</p><p>BOFHNOVRFY</p><p>Disable the VRFY command if this environment variable is set to 1.</p><p>Other useful environment variables are listed in the \m[blue]<strong></strong><a href="../man8/submit.8.html"><strong>submit</strong>(8)</a>\m[]\s-2\u[5]\d\s+2 manual page.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO makesmtpaccess-msa&hellip;</h2>
        <div class="sectioncontent">
<p>\m[blue]<strong></strong><a href="../man8/esmtpd.8.html"><strong>esmtpd</strong>(8)</a>\m[]\s-2\u[6]\d\s+2, \m[blue]<strong></strong><strong>couriertcpd</strong>(8)\m[]\s-2\u[1]\d\s+2, \m[blue]<strong></strong><a href="../man8/submit.8.html"><strong>submit</strong>(8)</a>\m[]\s-2\u[5]\d\s+2.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p><strong>Sam Varshavchik</strong></p><p>Author</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
     1.
  </dt>
  <dd>
    <p><strong>couriertcpd</strong>(8)</p><p>[set $man.base.url.for.relative.links]/couriertcpd.html</p>
  </dd>
  <dt>
     2.
  </dt>
  <dd>
    <p>RFC 2476</p><p>http://www.rfc-editor.org/rfc/rfc2476.txt</p>
  </dd>
  <dt>
     3.
  </dt>
  <dd>
    <p><a href="../man8/courierfax.8.html"><strong>courierfax</strong>(8)</a></p><p>[set $man.base.url.for.relative.links]/courierfax.html</p>
  </dd>
  <dt>
     4.
  </dt>
  <dd>
    <p><a href="../man8/courier.8.html"><strong>courier</strong>(8)</a></p><p>[set $man.base.url.for.relative.links]/courier.html</p>
  </dd>
  <dt>
     5.
  </dt>
  <dd>
    <p><a href="../man8/submit.8.html"><strong>submit</strong>(8)</a></p><p>[set $man.base.url.for.relative.links]/submit.html</p>
  </dd>
  <dt>
     6.
  </dt>
  <dd>
    <p><a href="../man8/esmtpd.8.html"><strong>esmtpd</strong>(8)</a></p><p>[set $man.base.url.for.relative.links]/esmtpd.html</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="makesmtpaccess.8.html"><span aria-hidden="true">&larr;</span> makesmtpaccess.8: Build esmtp server access file</a></li>
   <li class="next"><a href="makeuserdb.8.html">makeuserdb.8: Create /etc/courier/userdb <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
