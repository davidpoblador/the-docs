<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>lockfs_mount_helper: Helper script for the mount command</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Helper script for the mount command">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="lockfs_mount_helper (8) manual">
  <meta name="twitter:description" content="Helper script for the mount command">
  <meta name="twitter:image" content="https://www.carta.tech/images/bilibop-lockfs-lockfs_mount_helper-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/lockfs_mount_helper.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="lockfs_mount_helper (8) manual" />
  <meta property="og:description" content="Helper script for the mount command" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/bilibop-lockfs-lockfs_mount_helper-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">lockfs_mount_helper<small> (8)</small></h1>
        <p class="lead">Helper script for the mount command</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/lockfs_mount_helper.8.html">
      <span itemprop="name">lockfs_mount_helper: Helper script for the mount command</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/bilibop-lockfs/">
      <span itemprop="name">bilibop-lockfs</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/lockfs_mount_helper.8.html">
      <span itemprop="name">lockfs_mount_helper: Helper script for the mount command</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>mount.lockfs</strong> <em>FILESYSTEM</em> <em>MOUNTPOINT</em> <strong>-o</strong> <em>MOUNTOPTIONS</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>/sbin/mount.lockfs</strong> is a symlink to <em>/lib/bilibop/lockfs_mount_helper</em>. It is used as an helper program by the <a href="../man8/mount.8.html"><strong>mount</strong>(8)</a> command for the &apos;<strong>lockfs</strong>&apos; filesystem type entries in <em>/etc/fstab</em>. This script cannot be run manually, and fails if the root filesystem is not already managed by <strong>bilibop-lockfs</strong>. The expected way to run it and how it does its job are the followings:</p>
<dl class='dl-vertical'>
  <dt>
    1.
  </dt>
  <dd>
    <p>Enable <strong>bilibop-lockfs</strong>: set the BILIBOP_LOCKFS variable to <em>true</em> in <a href="../man5/bilibop.conf.5.html"><strong>bilibop.conf</strong>(5)</a> and reboot the computer; or reboot the computer and append the &apos;<strong>lockfs</strong>&apos; kernel parameter to the boot commandline.</p>
  </dd>
  <dt>
    2.
  </dt>
  <dd>
    <p>One time the future &apos;/&apos; is set as an <strong>aufs</strong>(5) mountpoint from into the initramfs environment, the temporary and writable <a href="../man5/fstab.5.html"><strong>fstab</strong>(5)</a> on it is modified to replace filesystem types of some entries by &apos;<strong>lockfs</strong>&apos;. Options are also modified to remember the original fstype.</p>
  </dd>
  <dt>
    3.
  </dt>
  <dd>
    <p>One time the aufs mountpoint is the new root filesystem, initscripts are executed: <a href="../man5/fstab.5.html"><strong>fstab</strong>(5)</a> is parsed by &apos;<strong>mount</strong> <strong>-a</strong>&apos;, and then <a href="../man8/mount.8.html"><strong>mount</strong>(8)</a> calls <em>mount.lockfs</em> with the proper arguments when a &apos;<strong>lockfs</strong>&apos; fstype is encountered.</p>
  </dd>
  <dt>
    4.
  </dt>
  <dd>
    <p><strong>mount.lockfs</strong> parses arguments and checks if the filesystem has been whitelisted in <a href="../man5/bilibop.conf.5.html"><strong>bilibop.conf</strong>(5)</a>, or not. If it is the case, the filesystem is mounted normally and the fstab entry is modified to reflect the actual mount call. If neither the filesystem nor the mountpoint have been whitelisted, then the filesystem is mounted elsewhere and readonly, a temporary filesystem is mounted with proper options, size, permissions and ownership, and an aufs is mounted on the <em>MOUNTPOINT</em> given as argument with the lower/readonly and upper/writable branches previously set. The fstab entry is replaced by three lines reflecting the actual mount calls. If something fails, <strong>mount.lockfs</strong> acts as if the filesystem was whitelisted. See <em>/usr/share/doc/bilibop-lockfs/README.Debian</em> for details.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p><strong>lockfs_mount_helper</strong> uses options and arguments as they are given by <a href="../man8/mount.8.html"><strong>mount</strong>(8)</a> after it has parsed the corresponding <a href="../man5/fstab.5.html"><strong>fstab</strong>(5)</a> entry. So, options and arguments are mandatory and come in the following order:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>FILESYSTEM</em></p>
  </dt>
  <dd>
    <p>Corresponding to the first field in fstab. This must be a block device, or a symlink to a block device. If this field is given with one of the <strong>UUID=*</strong> or <strong>LABEL=*</strong> formats, then the mount command translates it to the corresponding device name before to call the helper program.</p>
  </dd>
  <dt>
    <p><em>MOUNTPOINT</em></p>
  </dt>
  <dd>
    <p>Corresponding to the second field in fstab.</p>
  </dd>
  <dt>
    <p><em>-o MOUNTOPTIONS</em></p>
  </dt>
  <dd>
    <p>Corresponding to the fourth field in fstab. The mount options are parsed by the helper script: if <strong>fstype=*</strong> is encountered, it is removed from the options and used to mount the readonly branch with this filesystem type. If <strong>ro</strong>, <strong>noexec</strong>, <strong>nosuid</strong> or <strong>nodev</strong> options are encountered, they are added to the list of mount options of the writable branch.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/etc/fstab</p><p>/lib/bilibop/lockfs_mount_helper</p><p>/usr/share/doc/bilibop-lockfs/README.Debian</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO lockfs_mount_helper&hellip;</h2>
        <div class="sectioncontent">
<p><strong>aufs</strong>(5), <a href="../man7/bilibop.7.html"><strong>bilibop</strong>(7)</a>, <a href="../man5/bilibop.conf.5.html"><strong>bilibop.conf</strong>(5)</a>, <a href="../man5/fstab.5.html"><strong>fstab</strong>(5)</a>, <a href="../man8/mount.8.html"><strong>mount</strong>(8)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>This manual page has been written by Bilibop Project &lt;quidame@poivron.org&gt;.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="lock-util.8.html"><span aria-hidden="true">&larr;</span> lock-util.8: Short desc goes here</a></li>
   <li class="next"><a href="lockname.8.html">lockname.8: Generate a uucp lock filename <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
