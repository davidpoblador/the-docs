<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pklocalauthority: Policykit local authority</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Policykit local authority">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="pklocalauthority (8) manual">
  <meta name="twitter:description" content="Policykit local authority">
  <meta name="twitter:image" content="https://www.carta.tech/images/policykit-1-pklocalauthority-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/pklocalauthority.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="pklocalauthority (8) manual" />
  <meta property="og:description" content="Policykit local authority" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/policykit-1-pklocalauthority-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pklocalauthority<small> (8)</small></h1>
        <p class="lead">Policykit local authority</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/pklocalauthority.8.html">
      <span itemprop="name">pklocalauthority: Policykit local authority</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/policykit-1/">
      <span itemprop="name">policykit-1</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/pklocalauthority.8.html">
      <span itemprop="name">pklocalauthority: Policykit local authority</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The Local Authority is the default PolicyKit authority implementation. Configuration for the Local Authority and information pertaining to authorization decisions are read from local files on the disk. One design goal of the Local Authority is to split configuration items into separate files such that 3rd party packages and users won&apos;t conflict trying to edit the same files. This policy also ensures smooth upgrades when distributing PolicyKit using a package management system.</p><p>Files shipped with PolicyKit and 3rd party packages (e.g. under package manager control) typically have comments (such as &ldquo;DO NOT EDIT THIS FILE, it will be overwritten on update&rdquo;) telling the system administrator that changes will be overwritten on update.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ADMINISTRATOR AUTHENTICATION</h2>
        <div class="sectioncontent">
<p>PolicyKit makes a distinction between <em>user authentication</em> (to make the user in front of the system prove he really is the user) and <em>administrator authentication</em> (to make the user in front of the system prove he really is an administrator). Since various operating systems (or even flavors of the same operating system) has different ways of defining "administrator", the Local Authority provides a way to specify what "administrator authentication" means.</p><p>By default, "administrator authentication" is defined as asking for the root password. Since some systems, for usability reasons, don&apos;t have a root password and instead rely on a group of users being member of an administrative group that gives them super-user privileges, the Local Authority can be configured to support this use-case as well.</p><p>Configuration for the Local Authority is read from files in the /etc/polkit-1/localauthority.conf.d directory. All files are read in lexigraphical order (using the C locale) meaning that later files can override earlier ones. The file 50-localauthority.conf contains the settings provided by the OS vendor. Users and 3rd party packages can drop configuration files with a priority higher than 60 to change the defaults. The configuration file format is simple. Each configuration file is a <em>key file</em> (also commonly known as a <em>ini file</em>) with a single group called [Configuration]. Only a single key, AdminIdentities is read. The value of this key is a semi-colon separated list of identities that can be used when administrator authentication is required. Users are specified by prefixing the user name with unix-user:, groups of users are specified by prefixing with unix-group:, and netgroups of users are specified with unix-netgroup:. See the section called &ldquo;EXAMPLES&rdquo; for an example of a configuration file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIRECTORY STRUCTURE</h2>
        <div class="sectioncontent">
<p>The Local Authority reads files with .pkla extension from all directories located inside the /etc/polkit-1/localauthority and /var/lib/polkit-1/localauthority directories. By default, the following sub-directories are installed.</p>
<pre>
/etc/polkit-1/
`-- localauthority
    |-- 10-vendor.d
    |-- 20-org.d
    |-- 30-site.d
    |-- 50-local.d
    `-- 90-mandatory.d

</pre>
<p>and</p>
<pre>
/var/lib/polkit-1/
`-- localauthority
    |-- 10-vendor.d
    |-- 20-org.d
    |-- 30-site.d
    |-- 50-local.d
    `-- 90-mandatory.d

</pre>
<p>The /etc/polkit-1/localauthority hierarchy is inteded for local configuration and the /var/lib/polkit-1/localauthority is intended for 3rd party packages.</p><p>Each .pkla file contains one or more authorization entries. If the underlying filesystem supports file monitoring, the Local Authority will reload information whenever .pkla files are added, removed or changed.</p><p>Each directory is intended for a specific audience</p><p><em>10-vendor.d</em></p><p>Intended for use by the OS vendor.</p><p><em>20-org.d</em></p><p>Intended for the organization deploying the OS.</p><p><em>30-site.d</em></p><p>Intended for the site deploying the system.</p><p><em>50-local.d</em></p><p>Intended for local usage.</p><p><em>90-mandatory.d</em></p><p>Intended for the organization deploying the OS.</p><p>and new directories can be added/removed as needed.</p><p>As to regards to the content, each .pkla file is a standard <em>key file</em> and contains key/value pairs in one or more groups with each group representing an authorization entry. A .pkla file MUST be named by using a scheme to ensure that the name is unique, e.g. reverse DNS notation or similar. For example, if the organization is &ldquo;Acme Corp&rdquo; needs to modify policy for the product &ldquo;Frobnicator&rdquo;, a name like com.acme.frobnicator.pkla would be suitable.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORIZATION ENTRY</h2>
        <div class="sectioncontent">
<p>Each group in a .pkla file must have a name that is unique within the file it belongs to. The following keys are are recognized:</p><p><em>Identity</em></p><p>A semi-colon separated list of globs to match identities. Each glob should start with unix-user: or unix-group: to specify whether to match on a UNIX user name or a UNIX group name. Netgroups are supported with the unix-netgroup: prefix, but cannot support glob syntax.</p><p><em>Action</em></p><p>A semi-colon separated list of globs to match action identifiers.</p><p><em>ResultActive</em></p><p>The result to return for subjects in an active local session that matches one or more of the given identities. Allowed values are similar to what can be used in the <em>defaults</em> section of .policy files used to define actions, e.g. yes, no, auth_self, auth_self_keep, auth_admin and auth_admin_keep.</p><p><em>ResultInactive</em></p><p>Like <em>ResultActive</em> but instead applies to subjects in inactive local sessions.</p><p><em>ResultAny</em></p><p>Like <em>ResultActive</em> but instead applies to any subject.</p><p><em>ReturnValue</em></p><p>A semi-colon separated list of key/value pairs (of the form key=value) that are added to the details of authorization result on positive matches.</p><p>All keys specified above are required except that only at least one of <em>ResultAny</em>, <em>ResultInactive</em> and <em>ResultActive</em> must be present. The <em>ReturnValue</em> key is optional.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EVALUATION ORDER</h2>
        <div class="sectioncontent">
<p>When a Mechanism requests services from the Authority to check if a given Subject is authorized for a given Action, the authorization entries discussed above are consulted using the following algorithm.</p><p>The authorization entries from all .pkla files are ordered using the following rules. First all the basename of all sub-directories (e.g. <em>30-site.d</em>) from both the /etc/polkit-1/localauthority and /var/lib/polkit-1/localauthority directories are enumerated and sorted (using the C locale). If a name exists in both /etc and /var, the one in /etc takes precedence. Then all .pkla files are read in order from this list of sub-directories. For each .pkla file, authorizations from each file are appended in order resulting in an ordered list of authorization entries.</p><p>For example, given the following files</p>
<pre>
/var/lib/polkit-1
└── localauthority
    ├── 10-vendor.d
    │   └── 10-desktop-policy.pkla
    ├── 20-org.d
    ├── 30-site.d
    ├── 50-local.d
    ├── 55-org.my.company.d
    │   └── 10-org.my.company.product.pkla
    └── 90-mandatory.d

/etc/polkit-1
└── localauthority
    ├── 10-vendor.d
    │   └── 01-some-changes-from-a-subvendor.pkla
    ├── 20-org.d
    ├── 30-site.d
    ├── 50-local.d
    ├── 55-org.my.company.d
    │   └── 10-org.my.company.product.pkla
    └── 90-mandatory.d

</pre>
<p>the evaluation order of the .pkla files is:</p><p>10-desktop-policy.pkla</p><p>01-some-changes-from-a-subvendor.pkla</p><p>10-org.my.company.product.pkla (the /var one)</p><p>10-org.my.company.product.pkla (the /etc one)</p><p>When the list of authorization entries has been calculated, the authorization check can be made. First, the user of the Subject is determined and the groups that the user belongs are looked up. For each group identity, the authorization entries are consulted in order. If the authorization check matches the data from the authorization check, then the authorization result from <em>RequireAny</em>, <em>RequireInactive</em> or <em>RequireActive</em> is used and <em>ReturnValue</em> is added to the authorization result.</p><p>Finally, the authorization entries are consulted using the user identity in the same manner.</p><p>Note that processing continues even after a match. This allows for socalled &ldquo;negative authorizations&rdquo;, see the section called &ldquo;EXAMPLES&rdquo; for further discussion.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>The following .conf file</p>
<pre>
[Configuration]
AdminIdentities=unix-group:desktop_admin_r

</pre>
<p>that any user in the desktop_admin_r UNIX group can be used for authentication when administrator authentication is needed. This file would typically be installed in the /etc/polkit-1/localauthority.conf.d directory and given the name 60-desktop-policy.conf to ensure that it is evaluted after the 50-localauthority.conf file shipped with PolicyKit. If the local administrator wants to override this (suppose 60-desktop-policy.conf was shipped as part of the OS) he can simply create a file 99-my-admin-configuration.conf with the following content</p>
<pre>
[Configuration]
AdminIdentities=unix-user:lisa;unix-user:marge

</pre>
<p>to specify that only the users lisa and marge can authenticate when administrator authentication is needed.</p><p>The following .pkla file grants authorization to all users in the staff group for actions matching the glob com.example.awesomeproduct.* provided they are in an active session on the local console:</p>
<pre>
[Normal Staff Permissions]
Identity=unix-group:staff
Action=com.example.awesomeproduct.*
ResultAny=no
ResultInactive=no
ResultActive=yes

</pre>
<p>If the users homer and grimes are member of the staff group but policy requires that an administrator needs to authenticate every time authorization for any action matching com.example.awesomeproduct.* is required, one would add</p>
<pre>
[Exclude Some Problematic Users]
Identity=unix-user:homer;unix-user:grimes
Action=com.example.awesomeproduct.*
ResultAny=no
ResultInactive=no
ResultActive=auth_admin

</pre>
<p>and make sure this authorization entry is after the first one.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Written by David Zeuthen &lt;davidz@redhat.com&gt; with a lot of help from many others.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Please send bug reports to either the distribution or the polkit-devel mailing list, see the link \m[blue]<strong>http://lists.freedesktop.org/mailman/listinfo/polkit-devel</strong>\m[] on how to subscribe.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO pklocalauthority&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/polkit.8.html"><strong>polkit</strong>(8)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pkgsync.8.html"><span aria-hidden="true">&larr;</span> pkgsync.8: Automated package synchronization tool</a></li>
   <li class="next"><a href="plipconfig.8.html">plipconfig.8: Fine tune plip device parameters <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
