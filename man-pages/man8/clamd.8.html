<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>clamd: An anti-virus daemon</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="An anti-virus daemon">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="clamd (8) manual">
  <meta name="twitter:description" content="An anti-virus daemon">
  <meta name="twitter:image" content="https://www.carta.tech/images/clamav-daemon-clamd-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/clamd.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="clamd (8) manual" />
  <meta property="og:description" content="An anti-virus daemon" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/clamav-daemon-clamd-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">clamd<small> (8)</small></h1>
        <p class="lead">An anti-virus daemon</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/clamd.8.html">
      <span itemprop="name">clamd: An anti-virus daemon</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/clamav-daemon/">
      <span itemprop="name">clamav-daemon</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/clamd.8.html">
      <span itemprop="name">clamd: An anti-virus daemon</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>clamd [options]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The daemon listens for incoming connections on Unix and/or TCP socket and scans files or directories on demand. It reads the configuration from /etc/clamav/clamd.conf</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMMANDS</h2>
        <div class="sectioncontent">
<p>It's recommended to prefix clamd commands with the letter <strong>z</strong> (eg. zSCAN) to indicate that the command will be delimited by a NULL character and that clamd should continue reading command data until a NULL character is read. The null delimiter assures that the complete command and its entire argument will be processed as a single command. Alternatively commands may be prefixed with the letter <strong>n</strong> (e.g. nSCAN) to use a newline character as the delimiter. Clamd replies will honour the requested terminator in turn. If clamd doesn't recognize the command, or the command doesn't follow the requirements specified below, it will reply with an error message, and close the connection.</p><p>Clamd recognizes the following commands:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>PING</strong></p>
  </dt>
  <dd>
    <p>Check the server's state. It should reply with "PONG".</p>
  </dd>
  <dt>
    <p><strong>VERSION</strong></p>
  </dt>
  <dd>
    <p>Print program and database versions.</p>
  </dd>
  <dt>
    <p><strong>RELOAD</strong></p>
  </dt>
  <dd>
    <p>Reload the virus databases.</p>
  </dd>
  <dt>
    <p><strong>SHUTDOWN</strong></p>
  </dt>
  <dd>
    <p>Perform a clean exit.</p>
  </dd>
  <dt>
    <p><strong>SCAN file/directory</strong></p>
  </dt>
  <dd>
    <p>Scan a file or a directory (recursively) with archive support enabled (if not disabled in clamd.conf). A full path is required.</p>
  </dd>
  <dt>
    <p><strong>CONTSCAN file/directory</strong></p>
  </dt>
  <dd>
    <p>Scan file or directory (recursively) with archive support enabled and don't stop the scanning when a virus is found.</p>
  </dd>
  <dt>
    <p><strong>MULTISCAN file/directory</strong></p>
  </dt>
  <dd>
    <p>Scan file in a standard way or scan directory (recursively) using multiple threads (to make the scanning faster on SMP machines).</p>
  </dd>
  <dt>
    <p><strong>ALLMATCHSCAN file/directory</strong></p>
  </dt>
  <dd>
    <p>ALLMATCHSCAN works just like SCAN except that it sets a mode where scanning continues after finding a match within a file.</p>
  </dd>
  <dt>
    <p><strong>INSTREAM</strong></p>
  </dt>
  <dd>
    <p>It is mandatory to prefix this command with <strong>n</strong> or <strong>z</strong>.</p><p>Scan a stream of data. The stream is sent to clamd in chunks, after INSTREAM, on the same socket on which the command was sent. This avoids the overhead of establishing new TCP connections and problems with NAT. The format of the chunk is: '&lt;length&gt;&lt;data&gt;' where &lt;length&gt; is the size of the following data in bytes expressed as a 4 byte unsigned integer in network byte order and &lt;data&gt; is the actual chunk. Streaming is terminated by sending a zero-length chunk. Note: do not exceed StreamMaxLength as defined in clamd.conf, otherwise clamd will reply with <strong>INSTREAM size limit exceeded</strong> and close the connection.</p>
  </dd>
  <dt>
    <p><strong>FILDES</strong></p>
  </dt>
  <dd>
    <p>It is mandatory to newline terminate this command, or prefix with <strong>n</strong> or <strong>z</strong>.</p><p>This command only works on UNIX domain sockets. Scan a file descriptor. After issuing a FILDES command a subsequent rfc2292/bsd4.4 style packet (with at least one dummy character) is sent to clamd carrying the file descriptor to be scanned inside the ancillary data. Alternatively the file descriptor may be sent in the same packet, including the extra character.</p>
  </dd>
  <dt>
    <p><strong>STATS</strong></p>
  </dt>
  <dd>
    <p>It is mandatory to newline terminate this command, or prefix with <strong>n</strong> or <strong>z</strong>, it is recommended to only use the <strong>z</strong> prefix.</p><p>Replies with statistics about the scan queue, contents of scan queue, and memory usage. The exact reply format is subject to change in future releases.</p>
  </dd>
  <dt>
    <p><strong>IDSESSION, END</strong></p>
  </dt>
  <dd>
    <p>It is mandatory to prefix this command with <strong>n</strong> or <strong>z</strong>, and all commands inside IDSESSION must be prefixed.</p><p>Start/end a clamd session. Within a session multiple SCAN, INSTREAM, FILDES, VERSION, STATS commands can be sent on the same socket without opening new connections. Replies from clamd will be in the form '&lt;id&gt;: &lt;response&gt;' where &lt;id&gt; is the request number (in ascii, starting from 1) and &lt;response&gt; is the usual clamd reply. The reply lines have same delimiter as the corresponding command had. Clamd will process the commands asynchronously, and reply as soon as it has finished processing.</p><p>Clamd requires clients to read all the replies it sent, before sending more commands to prevent send() deadlocks. The recommended way to implement a client that uses IDSESSION is with non-blocking sockets, and a select()/poll() loop: whenever send would block, sleep in select/poll until either you can write more data, or read more replies. <em>Note that using non-blocking sockets without the select/poll loop and alternating recv()/send() doesn't comply with clamd's requirements.</em></p><p>If clamd detects that a client has deadlocked,  it will close the connection. Note that clamd may close an IDSESSION connection too if you don't follow the protocol's requirements. The client can use the PING command to keep the connection alive.</p>
  </dd>
  <dt>
    <p><strong>VERSIONCOMMANDS</strong></p>
  </dt>
  <dd>
    <p>It is mandatory to prefix this command with either <strong>n</strong> or <strong>z</strong>. It is recommended to use <strong>nVERSIONCOMMANDS</strong>.</p><p>Print program and database versions, followed by "| COMMANDS:" and a space-delimited list of supported commands. Clamd &lt;0.95 will recognize this as the VERSION command, and reply only with their version, without the commands list.</p><p>This command can be used as an easy way to check for IDSESSION support for example.</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    <p><strong>DEPRECATED COMMANDS</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>STREAM</strong></p>
  </dt>
  <dd>
    <p>Scan stream - on this command clamd will return "PORT number" you should connect to and send data to scan. (<strong>DEPRECATED</strong>, use INSTREAM instead)</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    <p><strong>NOT SUPPORTED COMMANDS</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>SESSION, END</strong></p>
  </dt>
  <dd>
    <p>Start/end a clamd session which will allow you to run multiple commands per TCP session. (use IDSESSION instead)</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-h, --help</strong></p>
  </dt>
  <dd>
    <p>Output help information and exit.</p>
  </dd>
  <dt>
    <p><strong>-V, --version</strong></p>
  </dt>
  <dd>
    <p>Print the version number and exit.</p>
  </dd>
  <dt>
    <p><strong>-c FILE, --config-file=FILE</strong></p>
  </dt>
  <dd>
    <p>Read configuration from FILE.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SIGNALS</h2>
        <div class="sectioncontent">
<p>Clamd recognizes the following signals:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>SIGHUP</strong></p>
  </dt>
  <dd>
    <p>Reopen the logfile.</p>
  </dd>
  <dt>
    <p><strong>SIGUSR2</strong></p>
  </dt>
  <dd>
    <p>Reload the signature databases.</p>
  </dd>
  <dt>
    <p><strong>SIGTERM</strong></p>
  </dt>
  <dd>
    <p>Perform a clean exit.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/etc/clamav/clamd.conf</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CREDITS</h2>
        <div class="sectioncontent">
<p>Please check the full documentation for credits.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Tomasz Kojm &lt;tkojm@clamav.net&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO clamd&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/clamd.conf.5.html"><strong>clamd.conf</strong>(5)</a>, <a href="../man1/clamdscan.1.html"><strong>clamdscan</strong>(1)</a>, <a href="../man1/freshclam.1.html"><strong>freshclam</strong>(1)</a>, <a href="../man5/freshclam.conf.5.html"><strong>freshclam.conf</strong>(5)</a>, <a href="../man8/clamav-milter.8.html"><strong>clamav-milter</strong>(8)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="clamav-unofficial-sigs.8.html"><span aria-hidden="true">&larr;</span> clamav-unofficial-sigs.8: Download, test, and install third-party clamav signature databases.</a></li>
   <li class="next"><a href="clean-crl.8.html">clean-crl.8: Remove orphaned crl like files from a certificate directory <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
