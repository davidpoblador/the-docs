<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>mkcephfs: Create a ceph file system</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Create a ceph file system">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="mkcephfs (8) manual">
  <meta name="twitter:description" content="Create a ceph file system">
  <meta name="twitter:image" content="https://www.carta.tech/images/ceph-mkcephfs-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/mkcephfs.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="mkcephfs (8) manual" />
  <meta property="og:description" content="Create a ceph file system" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/ceph-mkcephfs-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">mkcephfs<small> (8)</small></h1>
        <p class="lead">Create a ceph file system</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/mkcephfs.8.html">
      <span itemprop="name">mkcephfs: Create a ceph file system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/ceph/">
      <span itemprop="name">ceph</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/mkcephfs.8.html">
      <span itemprop="name">mkcephfs: Create a ceph file system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>mkcephfs</strong> -c <em>ceph.conf</em> [ --mkfs ] [ -a, --all-hosts [ -k
<em>/path/to/admin.keyring</em> ] ]
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>mkcephfs</strong> is used to create an empty Ceph file system, possibly spanning multiple hosts. The ceph.conf file describes the composition of the entire Ceph cluster, including which hosts are participating, which daemons run where, and which paths are used to store file system data or metadata.</p><p>The mkcephfs tool can be used in two ways. If -a is used, it will use ssh and scp to connect to remote hosts on your behalf and do the setup of the entire cluster. This is the easiest solution, but can also be inconvenient (if you don&apos;t have ssh to connect without prompting for passwords) or slow (if you have a large cluster).</p><p>Alternatively, you can run each setup phase manually. First, you need to prepare a monmap that will be shared by each node:</p>
<pre>
# prepare
master# mkdir /tmp/foo
master# mkcephfs -c /etc/ceph/ceph.conf &#92;
  --prepare-monmap -d /tmp/foo
</pre>
<p>Share the <strong>/tmp/foo</strong> directory with other nodes in whatever way is convenient for you. On each OSD and MDS node:</p>
<pre>
osdnode# mkcephfs --init-local-daemons osd -d /tmp/foo
mdsnode# mkcephfs --init-local-daemons mds -d /tmp/foo
</pre>
<p>Collect the contents of the /tmp/foo directories back onto a single node, and then:</p>
<pre>
master# mkcephfs --prepare-mon -d /tmp/foo
</pre>
<p>Finally, distribute <strong>/tmp/foo</strong> to all monitor nodes and, on each of those nodes:</p>
<pre>
monnode# mkcephfs --init-local-daemons mon -d /tmp/foo
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-a, --allhosts</strong></p>
  </dt>
  <dd>
    <p>Performs the necessary initialization steps on all hosts in the cluster, executing commands via SSH.</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    <p><strong>-c ceph.conf, --conf=ceph.conf</strong></p>
  </dt>
  <dd>
    <p>Use the given conf file instead of the default <strong>/etc/ceph/ceph.conf</strong>.</p>
  </dd>
  <dt>
    <p><strong>-k /path/to/keyring</strong></p>
  </dt>
  <dd>
    <p>When <strong>-a</strong> is used, we can specify a location to copy the client.admin keyring, which is used to administer the cluster. The default is <strong>/etc/ceph/keyring</strong> (or whatever is specified in the config file).</p>
  </dd>
  <dt>
    <p><strong>--mkfs</strong></p>
  </dt>
  <dd>
    <p>Create and mount the file systems specified in the ceph.conf for OSD data storage using mkfs.$type. The <strong>devs</strong> option in ceph.conf must specify the device(s) and the <strong>osd mkfs type</strong> option must specify the file system type (normally one of btrfs, xfs, or ext4).</p>
  </dd>
  <dt>
    <p><strong>--no-copy-conf</strong></p>
  </dt>
  <dd>
    <p>By default, mkcephfs with -a will copy the new configuration to /etc/ceph/ceph.conf on each node in the cluster.  This option disables that behavior.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SUBCOMMANDS</h2>
        <div class="sectioncontent">
<p>The sub-commands performed during cluster setup can be run individually with</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>--prepare-monmap -d dir -c ceph.conf</strong></p>
  </dt>
  <dd>
    <p>Create an initial monmap with a random fsid/uuid and store it and the ceph.conf in dir.</p>
  </dd>
  <dt>
    <p><strong>--init-local-daemons type -d dir</strong></p>
  </dt>
  <dd>
    <p>Initialize any daemons of type type on the local host using the monmap in dir.  For types osd and mds, the resulting authentication keys will be placed in dir.  For type mon, the initial data files generated by --prepare-mon (below) are expected in dir.</p>
  </dd>
  <dt>
    <p><strong>--prepare-mon -d dir</strong></p>
  </dt>
  <dd>
    <p>Prepare the initial monitor data based on the monmap, OSD, and MDS authentication keys collected in dir, and put the result in dir.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AVAILABILITY</h2>
        <div class="sectioncontent">
<p><strong>mkcephfs</strong> is part of the Ceph distributed file system. Please refer to the Ceph documentation at <em>http://ceph.com/docs</em> for more information.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO mkcephfs&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/ceph.8.html"><strong>ceph</strong>(8)</a>, <a href="../man8/monmaptool.8.html"><strong>monmaptool</strong>(8)</a>, <a href="../man8/osdmaptool.8.html"><strong>osdmaptool</strong>(8)</a>, <a href="../man8/crushtool.8.html"><strong>crushtool</strong>(8)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>2010-2013, Inktank Storage, Inc. and contributors. Licensed under Creative Commons BY-SA</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="mkcat.8.html"><span aria-hidden="true">&larr;</span> mkcat.8: Create a new gnats category</a></li>
   <li class="next"><a href="mkcover.8.html">mkcover.8: \*(fx continuation cover page generation command <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
