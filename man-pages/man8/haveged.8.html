<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>haveged: Generate random numbers and feed linux random device.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Generate random numbers and feed linux random device.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="haveged (8) manual">
  <meta name="twitter:description" content="Generate random numbers and feed linux random device.">
  <meta name="twitter:image" content="https://www.carta.tech/images/haveged-haveged-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/haveged.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="haveged (8) manual" />
  <meta property="og:description" content="Generate random numbers and feed linux random device." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/haveged-haveged-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">haveged<small> (8)</small></h1>
        <p class="lead">Generate random numbers and feed linux random device.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/haveged.8.html">
      <span itemprop="name">haveged: Generate random numbers and feed linux random device.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/haveged/">
      <span itemprop="name">haveged</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/haveged.8.html">
      <span itemprop="name">haveged: Generate random numbers and feed linux random device.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>haveged [options]</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>haveged</strong> generates an unpredictable stream of random numbers harvested from the indirect effects of hardware events on hidden processor state (caches, branch predictors, memory translation tables, etc) using the HAVEGE (HArdware Volatile Entropy Gathering and Expansion) algorithm. The algorithm operates in user space, no special privilege is required for file system access to the output stream.</p><p>Linux pools randomness for distribution by the /dev/random and /dev/urandom device interfaces. The standard mechanisms of filling the /dev/random pool may not be sufficient to meet demand on systems with high needs or limited user interaction. In those circumstances, <strong>haveged</strong> may be run as a privileged daemon to fill the /dev/random pool whenever the supply of random bits in /dev/random falls below the low water mark of the device.</p><p><strong>haveged</strong> tunes itself to its environment and provides the same built-in test suite for the output stream as used on certified hardware security devices. See <strong>NOTES</strong> below for further information.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>-b nnn, --buffer=nnn</p>
  </dt>
  <dd>
    <p>Set collection buffer size to nnn KW. Default is 128KW (or 512KB).</p>
  </dd>
  <dt>
    <p>-d nnn, --data=nnn</p>
  </dt>
  <dd>
    <p>Set data cache size to nnn KB. Default is 16 or as determined dynamically.</p>
  </dd>
  <dt>
    <p>-f file, --file=file</p>
  </dt>
  <dd>
    <p>Set output file path for non-daemon use. Default is "sample", use "-" for stdout.</p>
  </dd>
  <dt>
    <p>-F , --Foreground</p>
  </dt>
  <dd>
    <p>Run daemon in foreground. Do not fork and detach.</p>
  </dd>
  <dt>
    <p>-i nnn, --inst=nnn</p>
  </dt>
  <dd>
    <p>Set instruction cache size to nnn KB. Default is 16 or as determined dynamically.</p>
  </dd>
  <dt>
    <p>-n nnn, --number=nnn</p>
  </dt>
  <dd>
    <p>Set number of bytes written to the output file. The value may be specified using one of the suffixes k, m, g, or t. The upper bound of this value is "16t" (2^44 Bytes = 16TB). A value of 0 indicates unbounded output and forces output to stdout. This argument is required if the daemon interface is not present. If the daemon interface is present, this setting takes precedence over any --run value.</p>
  </dd>
  <dt>
    <p>-o &lt;spec&gt;, --onlinetest=&lt;spec&gt;</p>
  </dt>
  <dd>
    <p>Specify online tests to run. The &lt;spec&gt; consists of optional "t"ot and "c"ontinuous groups, each group indicates the procedures to be run, using "a&lt;n&gt;" to indicate a AIS-31 procedure A variant, and "b" to indicate AIS procedure B. The specifications are order independent (procedure B always runs first in each group) and case insensitive. The a&lt;n&gt; variations exist to mitigate the a slow autocorrelation test (test5). Normally all procedure A tests, except the first are iterated 257 times. An a&lt;n&gt; option indicates test5 should only be executed every modulo &lt;n&gt; times during the procedure's 257 repetitions. The effect is so noticable that A8 is the usual choice.</p><p>The "tot" tests run only at initialization - there are no negative performance consequences except for a slight increase in the time required to initialize. The "tot" tests guarantee haveged has initialized properly. The use of both test procedures in the "tot" test is highly recommended because the two test emphasize different aspects of RNG quality.</p><p>In continuous testing, the test sequence is cycled repeatedly. For example, the string "tbca8b" (suitable for an AIS NTG.1 device) would run procedure B for the "tot" test, then cycle between procedure A8 and procedure B continuously for all further output. Continuous testing does not come for free, impacting both throughput and resource consumption. Continual testing also opens up the possibility of a test failure. A strict retry procedure recovers from spurious failure in all but the most extreme circumstances. When the retry fails, operation will terminate unless a "w" has been appended to the test token to make the test advisory only. In our example above, the string "tbca8wbw" would make all continuous tests advisory. For more detailed information on AIS retries see <strong>NOTES</strong> below.</p><p>Complete control over the test configuration is provided for flexibility. The defaults (ta8bcb" if run as a daemon and "ta8b" otherwise) are suitable for most circumstances.</p>
  </dd>
  <dt>
    <p>-p file, --pidfile=file</p>
  </dt>
  <dd>
    <p>Set file path for the daemon pid file. Default is "/var/run/haveged.pid",</p>
  </dd>
  <dt>
    <p>-r n, --run=n</p>
  </dt>
  <dd>
    <p>Set run level for daemon interface:</p><p>n = 0 Run as daemon - must be root. Fills /dev/random when the supply of random bits  falls below the low water mark of the device.</p><p>n = 1 Display configuration info and terminate.</p><p>n &gt; 1 Write &lt;n&gt; kb of output. Deprecated (use --number instead), only provided for backward compatibility.</p><p>If --number is specified, values other than 0,1 are ignored. Default is 0.</p>
  </dd>
  <dt>
    <p>-v n, --verbose=n</p>
  </dt>
  <dd>
    <p>Set diagnostic bitmap as sum of following options:</p><p>1=Show build/tuning summary on termination, summary for online test retries.</p><p>2=Show online test retry details</p><p>4=Show timing for collections</p><p>8=Show collection loop layout</p><p>16=Show collection loop code offsets</p><p>32=Show all online test completion detail</p><p>Default is 0. Use -1 for all diagnostics.</p>
  </dd>
  <dt>
    <p>-w nnn, --write=nnn</p>
  </dt>
  <dd>
    <p>Set write_wakeup_threshold of daemon interface to nnn bits. Applies only to run level 0.</p>
  </dd>
  <dt>
    <p>-?, --help</p>
  </dt>
  <dd>
    <p>This summary of program options.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>haveged tunes the HAVEGE algorithm for maximum effectiveness using a hierarchy of defaults, command line options, virtual file system information, and cpuid information where available. Under most circumstances, user input is not required for excellent results.</p><p>Run-time testing provides assurance of correct haveged operation. The run-time test suite is modeled upon the AIS-31 specification of the German Common Criteria body, BIS. This specification is typically applied to hardware devices, requiring formal certification and mandated start-up and continuous operational testing. Because haveged runs on many different hardware platforms, certification cannot be a goal, but the AIS-31 test suite provides the means to assess haveged output with the same operational tests applied to certified hardware devices.</p><p>AIS test procedure A performs 6 tests to check for statistically inconspicuous behavior. AIS test procedure B performs more theoretical tests such as checking multi-step transition probabilities and making an empirical entropy estimate. Procedure A is the much more resource and compute intensive of the two but is still recommended for the haveged start-up tests. Procedure B is well suited to use of haveged as a daemon because the test entropy estimate confirms the entropy estimate haveged uses when adding entropy to the /dev/random device.</p><p>No test is perfect. There is a 10e-4 probability that a perfect generator will fail either of the test procedures. AIS-31 mandates a strict retry policy to filter out false alarms and haveged always logs test procedure failures. Retries are expected but rarely observed except when large data sets are generated with continuous testing. See the <a href="../man3/libhavege.3.html"><strong>libhavege</strong>(3)</a></strong> notes for more detailed information.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>If running as a daemon, access to the following files is required</p><p><em>/dev/random</em></p><p><em>/proc/sys/kernel/osrelease</em></p><p><em>/proc/sys/kernel/random/poolsize</em></p><p><em>/proc/sys/kernel/random/write_wakeup_threshold</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">
<p>Haveged returns 0 for success and non-zero for failure. The failure return code is 1 "general failure" unless execution is terminated by signal &lt;n&gt;, in which case the return code will be 128 + &lt;n&gt;. The following diagnostics are issued to stderr upon non-zero termination:</p><p>Cannot fork into the background</p><p>Call to <a href="../man3/daemon.3.html"><strong>daemon</strong>(3)</a> failed.</p><p>Cannot open file &lt;s&gt; for writing.</p><p>Could not open sample file &lt;s&gt; for writing.</p><p>Cannot write data in file:</p><p>Could not write data to the sample file.</p><p>Couldn't get pool size.</p><p>Unable to read /proc/sys/kernel/random/poolsize</p><p>Couldn't initialize HAVEGE rng</p><p>Invalid data or instruction cache size.</p><p>Couldn't open PID file &lt;s&gt; for writing</p><p>Unable to write daemon PID</p><p>Couldn't open random device</p><p>Could not open /dev/random for read-write.</p><p>Couldn't query entropy-level from kernel: error</p><p>Call to <a href="../man2/ioctl.2.html"><strong>ioctl</strong>(2)</a> failed.</p><p>Couldn't open PID file &lt;path&gt; for writing</p><p>Error writing /var/run/haveged.pid</p><p>Fail:set_watermark()</p><p>Unable to write to /proc/sys/kernel/random/write_wakeup_threshold</p><p>RNDADDENTROPY failed!</p><p>Call to <a href="../man2/ioctl.2.html"><strong>ioctl</strong>(2)</a> to add entropy failed</p><p>RNG failed</p><p>The random number generator failed self-test or encountered a fatal error.</p><p>Select error</p><p>Call to <a href="../man2/select.2.html"><strong>select</strong>(2)</a> failed.</p><p>Stopping due to signal &lt;n&gt;</p><p>Signal &lt;n&gt; caught.</p><p>Unable to setup online tests</p><p>Memory unavailable for online test resources.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>Write 1.5MB of random data to the file /tmp/random</p>
  </dt>
  <dd>
    <p>haveged -n 1.5M -f /tmp/random</p>
  </dd>
  <dt>
    <p>Generate a /tmp/keyfile for disk encryption with LUKS</p>
  </dt>
  <dd>
    <p>haveged -n 2048 -f /tmp/keyfile</p>
  </dd>
  <dt>
    <p>Overwrite partition /dev/sda1 with random data. Be careful, all data on the partition will be lost!</p>
  </dt>
  <dd>
    <p>haveged -n 0 | dd of=/dev/sda1</p>
  </dd>
  <dt>
    <p>Generate random ASCII passwords of the length 16 characters</p>
  </dt>
  <dd>
    <p>(haveged -n 1000 -f - 2&gt;/dev/null | tr -cd '[:graph:]' | fold -w 16 && echo ) | head</p>
  </dd>
  <dt>
    <p>Write endless stream of random bytes to the pipe. Utility pv measures the speed by which data are written to the pipe.</p>
  </dt>
  <dd>
    <p>haveged -n 0 | pv &gt; /dev/null</p>
  </dd>
  <dt>
    <p>Evaluate speed of haveged to generate 1GB of random data</p>
  </dt>
  <dd>
    <p>haveged -n 1g -f - | dd of=/dev/null</p>
  </dd>
  <dt>
    <p>Create a random key file containing 65 random keys for the encryption program aespipe.</p>
  </dt>
  <dd>
    <p>haveged -n 3705 -f - 2&gt;/dev/null | uuencode -m - | head -n 66 | tail -n 65</p>
  </dd>
  <dt>
    <p>Test the randomness of the generated data with dieharder test suite</p>
  </dt>
  <dd>
    <p>haveged -n 0 | dieharder -g 200 -a</p>
  </dd>
  <dt>
    <p>Generate 16k of data, testing with procedure A and B with detailed test results. No c result seen because a single buffer fill did not contain enough data to complete the test.</p>
  </dt>
  <dd>
    <p>haveged -n 16k -o tba8ca8 -v 33</p>
  </dd>
  <dt>
    <p>Generate 16k of data as above with larger buffer. The c test now completes - enough data now generated to complete the test.</p>
  </dt>
  <dd>
    <p>haveged -n 16k -o tba8ca8 -v 33 -b 512</p>
  </dd>
  <dt>
    <p>Generate 16m of data as above, observe many c test completions with default buffer size.</p>
  </dt>
  <dd>
    <p>haveged -n 16m -o tba8ca8 -v 33</p>
  </dd>
  <dt>
    <p>Generate large amounts of data - in this case 16TB. Enable initialization test but made continuous tests advisory only to avoid a possible situation that program will terminate because of procedureB failing two times in a row. The probability of procedureB to fail two times in a row can be estimated as &lt;TB to generate&gt;/3000 which yields 0.5% for 16TB.</p>
  </dt>
  <dd>
    <p>haveged -n 16T -o tba8cbw -f - | pv &gt; /dev/null</p>
  </dd>
  <dt>
    <p>Generate large amounts of data (16TB). Disable continuous tests for the maximum throughput but run the online tests at the startup to make sure that generator for properly initialized:</p>
  </dt>
  <dd>
    <p>haveged -n 16T -o tba8c -f - | pv &gt; /dev/null</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO haveged&hellip;</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><a href="../man3/libhavege.3.html"><strong>libhavege</strong>(3)</a>,</strong></p>
  </dt>
  <dd>
    <p><a href="../man8/cryptsetup.8.html"><strong>cryptsetup</strong>(8)</a>,</strong> <a href="../man1/aespipe.1.html"><strong>aespipe</strong>(1)</a>,</strong> <strong>pv(1),</strong> <strong>openssl</strong>(1),</strong> <a href="../man1/uuencode.1.html"><strong>uuencode</strong>(1)</a></strong></p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REFERENCES</h2>
        <div class="sectioncontent">
<p><em>HArdware Volatile Entropy Gathering and Expansion: generating unpredictable random numbers at user level</em> by A. Seznec, N. Sendrier, INRIA Research Report, RR-4592, October 2002</p><p><em>A proposal for: Functionality classes for random number generators</em> by W. Killmann and W. Schindler, version 2.0, Bundesamt fur Sicherheit in der Informationstechnik (BSI), September, 2011</p><p><em>A Statistical Test Suite for the Validation of Random NUmber Generators and Pseudorandom Number Generators for Cryptographic Applications,</em> special publication SP800-22, National Institute of Standards and Technology, revised April, 2010</p><p>Additional information can also be found at <strong>http://www.issihosts.com/haveged/</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Gary Wuertz &lt;gary@issiweb.com&gt; and Jirka Hladky &lt;hladky jiri AT gmail DOT com&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="hard-reboot.8.html"><span aria-hidden="true">&larr;</span> hard-reboot.8: Reboot your system immedeately</a></li>
   <li class="next"><a href="hb_report.8.html">hb_report.8: Create report for crm based clusters (pacemaker) <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
