<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>smp_discover: Invoke discover smp function</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Invoke discover smp function">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="smp_discover (8) manual">
  <meta name="twitter:description" content="Invoke discover smp function">
  <meta name="twitter:image" content="https://www.carta.tech/images/smp-utils-smp_discover-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/smp_discover.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="smp_discover (8) manual" />
  <meta property="og:description" content="Invoke discover smp function" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/smp-utils-smp_discover-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">smp_discover<small> (8)</small></h1>
        <p class="lead">Invoke discover smp function</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/smp_discover.8.html">
      <span itemprop="name">smp_discover: Invoke discover smp function</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/smp-utils/">
      <span itemprop="name">smp-utils</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/smp_discover.8.html">
      <span itemprop="name">smp_discover: Invoke discover smp function</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>smp_discover</strong> [<em>--adn</em>] [<em>--brief</em>] [<em>--cap</em>] [<em>--help</em>] [<em>--hex</em>] [<em>--ignore</em>] [<em>--interface=PARAMS</em>] [<em>--list</em>] [<em>--multiple</em>] [<em>--my</em>] [<em>--num=NUM</em>] [<em>--phy=ID</em>] [<em>--raw</em>] [<em>--sa=SAS_ADDR</em>] [<em>--summary</em>] [<em>--verbose</em>] [<em>--version</em>] [<em>--zero</em>] <em>SMP_DEVICE[,N]</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Sends one or more SAS Serial Management Protocol (SMP) DISCOVER function requests to an SMP target and decodes or outputs the responses. The SMP target is identified by the <em>SMP_DEVICE</em> and the <em>SAS_ADDR</em>. Depending on the interface, the <em>SAS_ADDR</em> may be deduced from the <em>SMP_DEVICE</em>. The mpt interface uses <em>SMP_DEVICE</em> to identify a HBA (an SMP initiator) and needs the additional <em>,N</em> to differentiate between HBAs if there are multiple present.</p><p>If the <em>--phy=ID</em> option is not given then <em>--summary</em> is assumed. When <em>--summary</em> is given or assumed, this utility shows the disposition of each active expander phy in table form. One row is shown for each phy and is described in the SINGLE LINE PER PHY FORMAT section below. For this purpose disabled expander phys and those with errors are considered "active" and can be suppressed from the output by adding the <em>--brief</em> option.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>Mandatory arguments to long options are mandatory for short options as well.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-A</strong>, <strong>--adn</strong></p>
  </dt>
  <dd>
    <p>causes the "attached device name" field to be output when the <em>--multiple</em> or <em>--summary</em> option is also given. See the section below on SINGLE LINE PER PHY FORMAT. Note the "attached device name" field was added is SAS-2.</p>
  </dd>
  <dt>
    <p><strong>-b</strong>, <strong>--brief</strong></p>
  </dt>
  <dd>
    <p>reduce the decoded response output. If used twice will exit if there is no attached device (after outputting that). When used with <em>--multiple</em>, unattached phys are not listed; when used twice, trims attached phys output.</p>
  </dd>
  <dt>
    <p><strong>-c</strong>, <strong>--cap</strong></p>
  </dt>
  <dd>
    <p>decode and print phy capabilities bits fields (see SNW-3 in draft). Each expander phy has three of these fields: programmed, current and attached. By default these fields are only printed out in hex, or not at all if the <em>--brief</em> option is given or implied. Of the three the attached phy capability field is probably the most interesting. If the <em>--verbose</em> option is given, then the various "G" identifiers are expanded (e.g. instead of "G4:" it prints "G4 (12 Gbps):").</p>
  </dd>
  <dt>
    <p><strong>-h</strong>, <strong>--help</strong></p>
  </dt>
  <dd>
    <p>output the usage message then exit.</p>
  </dd>
  <dt>
    <p><strong>-H</strong>, <strong>--hex</strong></p>
  </dt>
  <dd>
    <p>output the response (less the CRC field) in hexadecimal.</p>
  </dd>
  <dt>
    <p><strong>-i</strong>, <strong>--ignore</strong></p>
  </dt>
  <dd>
    <p>sets the Ignore Zone Group bit in the SMP Discover request. Expander phys hidden by zoning will appear as "phy vacant" unless this option is given.</p>
  </dd>
  <dt>
    <p><strong>-I</strong>, <strong>--interface</strong>=<em>PARAMS</em></p>
  </dt>
  <dd>
    <p>interface specific parameters. In this case "interface" refers to the path through the operating system to the SMP initiator. See the smp_utils man page for more information.</p>
  </dd>
  <dt>
    <p><strong>-l</strong>, <strong>--list</strong></p>
  </dt>
  <dd>
    <p>list attributes in "name=value" form, one entry per line.</p>
  </dd>
  <dt>
    <p><strong>-m</strong>, <strong>--multiple</strong></p>
  </dt>
  <dd>
    <p>loops over multiple phys within SMP target (typically an expander) and does a DISCOVER request and outputs a one line summary. Phy 0 is queried first, then phy 1, continuing until an error occurs. The starting phy and the number of phys "discovered" can be controlled by <em>--phy=ID</em> and <em>--num=NUM</em>. If <em>--brief</em> is given then there is no output for phys that indicate there is no attached device. When this option is used twice then multi-line output is produced for each phy. See the section below on SINGLE LINE PER PHY FORMAT.</p>
  </dd>
  <dt>
    <p><strong>-M</strong>, <strong>--my</strong></p>
  </dt>
  <dd>
    <p>outputs my (this expander's) SAS address in hex (prefixed by "0x"). This is obtained from the DISCOVER response of phy id 0 (unless <em>--phy=ID</em> is given). The expander's SAS address is typically available even if a phy is not connected, "vacant" or disabled. This option overrides most other options (e.g. overrides <em>--multiple</em> and <em>--summary</em> options).</p>
  </dd>
  <dt>
    <p><strong>-n</strong>, <strong>--num</strong>=<em>NUM</em></p>
  </dt>
  <dd>
    <p>number of phys to fetch, starting at <em>--phy=ID</em> when the <em>--multiple</em> option is given. The default value is 0 which is interpreted as "the rest" (i.e. until a "phy does not exist" function result is received). This option is ignored in the absence of the <em>--multiple</em> option.</p>
  </dd>
  <dt>
    <p><strong>-p</strong>, <strong>--phy</strong>=<em>ID</em></p>
  </dt>
  <dd>
    <p>phy identifier. <em>ID</em> is a value between 0 and 254. If this option is not given then the <em>--summary</em> option is assumed.</p>
  </dd>
  <dt>
    <p><strong>-r</strong>, <strong>--raw</strong></p>
  </dt>
  <dd>
    <p>send the response (less the CRC field) to stdout in binary. All error messages are sent to stderr.</p>
  </dd>
  <dt>
    <p><strong>-s</strong>, <strong>--sa</strong>=<em>SAS_ADDR</em></p>
  </dt>
  <dd>
    <p>specifies the SAS address of the SMP target device. Typically this is an expander. This option may not be needed if the <em>SMP_DEVICE</em> has the target's SAS address within it. The <em>SAS_ADDR</em> is in decimal but most SAS addresses are shown in hexadecimal. To give a number in hexadecimal either prefix it with '0x' or put a trailing 'h' on it.</p>
  </dd>
  <dt>
    <p><strong>-S</strong>, <strong>--summary</strong></p>
  </dt>
  <dd>
    <p>output a multi line summary, with one line per active phy. Checks all phys (or less is <em>--num=NUM</em> is given), starting at phy 0 (unless <em>--phy=ID</em> is given). Equivalent to '--multiple --brief' ('-mb'). See the section below on SINGLE LINE PER PHY FORMAT. If the <em>--phy=ID</em> is not given then this option is assumed.</p>
  </dd>
  <dt>
    <p><strong>-v</strong>, <strong>--verbose</strong></p>
  </dt>
  <dd>
    <p>increase the verbosity of the output. Can be used multiple times</p>
  </dd>
  <dt>
    <p><strong>-V</strong>, <strong>--version</strong></p>
  </dt>
  <dd>
    <p>print the version string and then exit.</p>
  </dd>
  <dt>
    <p><strong>-z</strong>, <strong>--zero</strong></p>
  </dt>
  <dd>
    <p>zero the Allocated Response Length field in the request. This option also zeros the Request Length field in the request. This is required for strict SAS-1.1 compliance. However this option should not be given in SAS-2 and later; if it is given an abridged response may result.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SINGLE LINE PER PHY FORMAT</h2>
        <div class="sectioncontent">
<p>The <em>--summary</em> option causes SMP DISCOVER responses to be compressed to a header followed by one line per phy. To save space SAS addresses are shown in hex without a '0x' prefix or 'h' suffix. The header line gives the SAS address of the SMP target itself and assumes it is an expander.</p><p>Each line starts with "  phy  &lt;n&gt;:" where &lt;n&gt; is the phy identifier (and they are origin zero). That is followed by the routing attribute represented by a single letter which is either "D" for direct routing, "S" for subtractive routing, "T" or "U". Both "T" and "U" imply table routing, the difference is that if REPORT GENERAL indicates "table to table supported" then "U" is output to indicate that phy can be part of an enclosure <strong>universal</strong> port; otherwise "T" is used. Next comes the negotiated physical link rate which is either "disabled", "reset problem" or "spinup hold". Other states are mapped to "attached". This includes enabled phys with nothing connected which appear as "attached:[0000000000000000:00]".</p><p>Information shown between the brackets is for the attached device. Phys that are connected display something like: "attached:[5000c50000520a2a:01 " where the first number is the attached SAS address (in hex) and the second number is the attached device's phy identifier. If the attached device type is other than a SAS or SATA device then one of these abbreviations is output: "exp" (for expander), "fex" (for fanout expander) or "res" (for unknown attached device type). If a phy is flagged as "virtual" then the letter "V" appears next. Next are the protocols supported by the attached device which are shown as "i(&lt;list&gt;)" for initiator protocols and/or "t(&lt;list&gt;)" for target protocols. The &lt;list&gt; is made up of "PORT_SEL", "SSP", "STP", "SMP" and "SATA" with "+" used as a separator. For example a SAS host adapter will most likely appear as: "i(SSP+STP+SMP)". This completes the information about the attached phy, hence the closing right bracket.</p><p>If appropriate, the negotiated physical link rate is shown in gigabits per second. Here is an example of a line for expander phy identifier 11 connected to a SATA target (or SATA "device" to use the t13.org term):</p>
<pre>
  phy  11:T:attached:[500605b000000afb:00  t(SATA)]  1.5 Gbps
</pre>
<p>If the expander has zoning enabled (i.e. REPORT GENERAL response bit for 'zoning enabled' is set) and a phy's zone group is other than zg 1 then the phy's zone group is shown (e.g. "ZG:2").</p><p>If the <em>--adn</em> option is given then after the attached SAS address and the attached device's phy identifier are output an extra field is inserted containing the "attached device name" field. For a SAS disk this should be its target device name (in NAA-5 format) and for a SATA disk its WWN (if provided, also in NAA-5 format). Also when the <em>--adn</em> option is given the phy speed and zone group are not output in order to keep the line length reasonable.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>In SAS-2 and later both the DISCOVER and DISCOVER LIST functions are available. The DISCOVER LIST function should be favoured for several reasons: its response can hold up to 40 descriptors each describing the state of one expander phy. The vast majority of expander chips on the market support 36 phys or less so one DISCOVER LIST response will summarize the states of all its phys. With the DISCOVER function only one expander phy's state is returned in its response. Other advantages of the DISCOVER LIST function are its "phy filter" and "descriptor type" function request fields.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>See "Examples" section in http://sg.danny.cz/sg/smp_utils.html</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFORMING TO</h2>
        <div class="sectioncontent">
<p>The SMP DISCOVER function was introduced in SAS-1, with small additions in SAS-1.1 . There were a large number of additions in SAS-2 . After SAS-2 the protocol sections of SAS were split into another document series known as SPL. Now SPL and SPL-2 are standards and SPL-3 is in the draft stage.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Written by Douglas Gilbert.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">
<p>Report bugs to &lt;dgilbert at interlog dot com&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2006-2014 Douglas Gilbert</p><p>This software is distributed under a FreeBSD license. There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO smp_discover&hellip;</h2>
        <div class="sectioncontent">
<p><strong>smp_utils, smp_discover_list, smp_phy_control</strong></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="smp_conf_zone_phy_info.8.html"><span aria-hidden="true">&larr;</span> smp_conf_zone_phy_info.8: Invoke configure zone phy information function</a></li>
   <li class="next"><a href="smp_discover_list.8.html">smp_discover_list.8: Invoke discover list smp function <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
