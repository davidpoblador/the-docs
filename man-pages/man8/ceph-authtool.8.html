<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ceph-authtool: Ceph keyring manipulation tool</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Ceph keyring manipulation tool">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="ceph-authtool (8) manual">
  <meta name="twitter:description" content="Ceph keyring manipulation tool">
  <meta name="twitter:image" content="https://www.carta.tech/images/ceph-common-ceph-authtool-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/ceph-authtool.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ceph-authtool (8) manual" />
  <meta property="og:description" content="Ceph keyring manipulation tool" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/ceph-common-ceph-authtool-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">ceph-authtool<small> (8)</small></h1>
        <p class="lead">Ceph keyring manipulation tool</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/ceph-authtool.8.html">
      <span itemprop="name">ceph-authtool: Ceph keyring manipulation tool</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/ceph-common/">
      <span itemprop="name">ceph-common</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/ceph-authtool.8.html">
      <span itemprop="name">ceph-authtool: Ceph keyring manipulation tool</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>ceph-authtool</strong> <em>keyringfile</em> [ -l | --list ] [ -C | --create-keyring
] [ -p | --print ] [ -n | --name <em>entityname</em> ] [ --gen-key ] [ -a |
--add-key <em>base64_key</em> ] [ --caps <em>capfile</em> ]
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>ceph-authtool</strong> is a utility to create, view, and modify a Ceph keyring file. A keyring file stores one or more Ceph authentication keys and possibly an associated capability specification. Each key is associated with an entity name, of the form <strong>{client,mon,mds,osd}.name</strong>.</p><p><strong>WARNING</strong> Ceph provides authentication and protection against man-in-the-middle attacks once secret keys are in place.  However, data over the wire is not encrypted, which may include the messages used to configure said keys.  The system is primarily intended to be used in trusted environments.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-l, --list</strong></p>
  </dt>
  <dd>
    <p>will list all keys and capabilities present in the keyring</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    <p><strong>-p, --print</strong></p>
  </dt>
  <dd>
    <p>will print an encoded key for the specified entityname. This is suitable for the <strong>mount -o secret=</strong> argument</p>
  </dd>
  <dt>
    <p><strong>-C, --create-keyring</strong></p>
  </dt>
  <dd>
    <p>will create a new keyring, overwriting any existing keyringfile</p>
  </dd>
  <dt>
    <p><strong>--gen-key</strong></p>
  </dt>
  <dd>
    <p>will generate a new secret key for the specified entityname</p>
  </dd>
  <dt>
    <p><strong>--add-key</strong></p>
  </dt>
  <dd>
    <p>will add an encoded key to the keyring</p>
  </dd>
  <dt>
    <p><strong>--cap subsystem capability</strong></p>
  </dt>
  <dd>
    <p>will set the capability for given subsystem</p>
  </dd>
  <dt>
    <p><strong>--caps capsfile</strong></p>
  </dt>
  <dd>
    <p>will set all of capabilities associated with a given key, for all subsystems</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CAPABILITIES</h2>
        <div class="sectioncontent">
<p>The subsystem is the name of a Ceph subsystem: <strong>mon</strong>, <strong>mds</strong>, or <strong>osd</strong>.</p><p>The capability is a string describing what the given user is allowed to do. This takes the form of a comma separated list of allow clauses with a permission specifier containing one or more of rwx for read, write, and execute permission. The <strong>allow *</strong> grants full superuser permissions for the given subsystem.</p><p>For example:</p>
<pre>
# can read, write, and execute objects
osd = "allow rwx"

# can access mds server
mds = "allow"

# can modify cluster state (i.e., is a server daemon)
mon = "allow rwx"
</pre>
<p>A librados user restricted to a single pool might look like:</p>
<pre>
mon = "allow r"

osd = "allow rw pool foo"
</pre>
<p>A client using rbd with read access to one pool and read/write access to another:</p>
<pre>
mon = "allow r"

osd = "allow class-read object_prefix rbd_children, allow pool templates r class-read, allow pool vms rwx"
</pre>
<p>A client mounting the file system with minimal permissions would need caps like:</p>
<pre>
mds = "allow"

osd = "allow rw pool data"

mon = "allow r"
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OSD CAPABILITIES</h2>
        <div class="sectioncontent">
<p>In general, an osd capability follows the grammar:</p>
<pre>
osdcap  := grant[,grant...]
grant   := allow (match capspec | capspec match)
match   := [pool[=]&lt;poolname&gt; | object_prefix &lt;prefix&gt;]
capspec := * | [r][w][x] [class-read] [class-write]
</pre>
<p>The capspec determines what kind of operations the entity can perform:</p>
<pre>
r           = read access to objects
w           = write access to objects
x           = can call any class method (same as class-read class-write)
class-read  = can call class methods that are reads
class-write = can call class methods that are writes
*           = equivalent to rwx, plus the ability to run osd admin commands,
              i.e. ceph osd tell ...
</pre>
<p>The match criteria restrict a grant based on the pool being accessed. Grants are additive if the client fulfills the match condition. For example, if a client has the osd capabilities: "allow r object_prefix prefix, allow w pool foo, allow x pool bar", then it has rw access to pool foo, rx access to pool bar, and r access to objects whose names begin with &apos;prefix&apos; in any pool.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CAPS FILE FORMAT</h2>
        <div class="sectioncontent">
<p>The caps file format consists of zero or more key/value pairs, one per line. The key and value are separated by an <strong>=</strong>, and the value must be quoted (with <strong>&apos;</strong> or <strong>"</strong>) if it contains any whitespace. The key is the name of the Ceph subsystem (<strong>osd</strong>, <strong>mds</strong>, <strong>mon</strong>), and the value is the capability string (see above).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>To create a new keyring containing a key for client.foo:</p>
<pre>
ceph-authtool -C -n client.foo --gen-key keyring
</pre>
<p>To associate some capabilities with the key (namely, the ability to mount a Ceph filesystem):</p>
<pre>
ceph-authtool -n client.foo --cap mds &apos;allow&apos; --cap osd &apos;allow rw pool=data&apos; --cap mon &apos;allow r&apos; keyring
</pre>
<p>To display the contents of the keyring:</p>
<pre>
ceph-authtool -l keyring
</pre>
<p>When mount a Ceph file system, you can grab the appropriately encoded secret key with:</p>
<pre>
mount -t ceph serverhost:/ mountpoint -o name=foo,secret=\(gaceph-authtool -p -n client.foo keyring\(ga
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AVAILABILITY</h2>
        <div class="sectioncontent">
<p><strong>ceph-authtool</strong> is part of the Ceph distributed storage system. Please refer to the Ceph documentation at <em>http://ceph.com/docs</em> for more information.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO ceph-authtool&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/ceph.8.html"><strong>ceph</strong>(8)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>2010-2014, Inktank Storage, Inc. and contributors. Licensed under Creative Commons BY-SA</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="ceph.8.html"><span aria-hidden="true">&larr;</span> ceph.8: Ceph file system control utility</a></li>
   <li class="next"><a href="ceph-clsinfo.8.html">ceph-clsinfo.8: Show class object information <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
