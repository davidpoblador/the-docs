<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>iptstate: A top-like display of ip tables state table entries</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A top-like display of ip tables state table entries">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="iptstate (8) manual">
  <meta name="twitter:description" content="A top-like display of ip tables state table entries">
  <meta name="twitter:image" content="https://www.carta.tech/images/iptstate-iptstate-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/iptstate.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="iptstate (8) manual" />
  <meta property="og:description" content="A top-like display of ip tables state table entries" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/iptstate-iptstate-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">iptstate<small> (8)</small></h1>
        <p class="lead">A top-like display of ip tables state table entries</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/iptstate.8.html">
      <span itemprop="name">iptstate: A top-like display of ip tables state table entries</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/iptstate/">
      <span itemprop="name">iptstate</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/iptstate.8.html">
      <span itemprop="name">iptstate: A top-like display of ip tables state table entries</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>iptstate</strong> [&lt;<strong>options</strong>&gt;]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>iptstate</strong> displays information held in the IP Tables state table in real-time in a top-like format. Output can be sorted by any field, or any field reversed. Users can choose to have the output only print once and exit, rather than the top-like system. Refresh rate is configurable, IPs can be resolved to names, output can be formatted, the display can be filtered, and color coding are among some of the many features.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMMAND-LINE OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-c, --no-color</strong></p>
  </dt>
  <dd>
    <p>Toggle color-code by protocol</p>
  </dd>
  <dt>
    <p><strong>-C, --counters</strong></p>
  </dt>
  <dd>
    <p>Toggle display of bytes/packets counters</p>
  </dd>
  <dt>
    <p><strong>-d, --dst-filter </strong><em>IP</em><strong></strong></p>
  </dt>
  <dd>
    <p>Only show states with a destination of <em>IP</em> Note, that this must be an IP, hostname matching is not yet supported.</p>
  </dd>
  <dt>
    <p><strong>-D --dstpt-filter </strong><em>port</em><strong></strong></p>
  </dt>
  <dd>
    <p>Only show states with a destination port of <em>port</em></p>
  </dd>
  <dt>
    <p><strong>-h, --help</strong></p>
  </dt>
  <dd>
    <p>Show help message</p>
  </dd>
  <dt>
    <p><strong>-l, --lookup</strong></p>
  </dt>
  <dd>
    <p>Show hostnames instead of IP addresses</p>
  </dd>
  <dt>
    <p><strong>-m, --mark-truncated</strong></p>
  </dt>
  <dd>
    <p>Mark truncated hostnames with a '+'</p>
  </dd>
  <dt>
    <p><strong>-o, --no-dynamic</strong></p>
  </dt>
  <dd>
    <p>Toggle dynamic formatting</p>
  </dd>
  <dt>
    <p><strong>-L, --no-dns</strong></p>
  </dt>
  <dd>
    <p>Skip outgoing DNS lookup states</p>
  </dd>
  <dt>
    <p><strong>-f, --no-loopback</strong></p>
  </dt>
  <dd>
    <p>Filter states on loopback</p>
  </dd>
  <dt>
    <p><strong>-p, --no-scroll</strong></p>
  </dt>
  <dd>
    <p>No scrolling (don't use a "pad"). See <strong>SCROLLING AND PADS</strong> for more information.</p>
  </dd>
  <dt>
    <p><strong>-r, --reverse</strong></p>
  </dt>
  <dd>
    <p>Reverse sort order</p>
  </dd>
  <dt>
    <p><strong>-R, --rate </strong><em>seconds</em><strong></strong></p>
  </dt>
  <dd>
    <p>Refresh rate, followed by rate in <em>seconds</em>. Note that this is for statetop mode, and not applicable for single-run mode (--single).</p>
  </dd>
  <dt>
    <p><strong>-1, --single</strong></p>
  </dt>
  <dd>
    <p>Single run (no curses)</p>
  </dd>
  <dt>
    <p><strong>-b, --sort </strong><em>column</em><strong></strong></p>
  </dt>
  <dd>
    <p>This determines what column to sort by. Options:</p><p><strong>	S</strong> Source Port</p><p><strong>	d</strong> Destination IP (or Name)</p><p><strong>	D</strong> Destination Port</p><p><strong>	p</strong> Protocol</p><p><strong>	s</strong> State</p><p><strong>	t</strong> TTL</p><p><strong>	b</strong> Bytes</p><p><strong>	P</strong> Packets</p><p>To sort by Source IP (or Name), don't use -b. Sorting by bytes/packets is only available for kernels that support it, and only when compiled against libnetfilter_conntrack (the default).</p>
  </dd>
  <dt>
    <p><strong>-s, --src-filter </strong><em>IP</em><strong></strong></p>
  </dt>
  <dd>
    <p>Only show states with a source of <em>IP</em>. Note, that this must be an IP, hostname matching is not yet supported.</p>
  </dd>
  <dt>
    <p><strong>-S, --srcpt-filter </strong><em>port</em><strong></strong></p>
  </dt>
  <dd>
    <p>Only show states with a source port of <em>port</em></p>
  </dd>
  <dt>
    <p><strong>-t, --totals</strong></p>
  </dt>
  <dd>
    <p>Toggle display of totals</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INTERACTIVE OPTIONS</h2>
        <div class="sectioncontent">
<p>As of version 2.0, all command-line options are now available interactively using the same key as the short-option. For example, <strong>--sort</strong> is also <strong>-b</strong>, so while <strong>iptstate</strong> is running, hitting <strong>b</strong> will change the sorting to the next column. Similarly, <strong>t</strong> toggles the display of totals, and so on.</p><p>There are also extra interactive options: <strong>B</strong> - change sorting to previous column (opposite of <strong>b</strong>); <strong>q</strong> - quit; and <strong>x</strong> - delete the currently highlighted state from the netfilter conntrack table.</p><p>Additionally, the following keys are used to navigate within <strong>iptstate</strong>:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>Up</strong> or <strong>j</strong> - Move up one line</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>Down</strong> or <strong>k</strong> - Move down one line</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>Left</strong> or <strong>h</strong> - Move left one column</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>Right</strong> or <strong>l</strong> - Move right one column</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>PageUp</strong> or <strong>^u</strong> - Move up one page</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>PageDown</strong> or <strong>^d</strong> - Move down one page</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>Home</strong> - Go to the top</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>End</strong> - Go to the end</p>
  </dt>
  <dd>
    
  </dd>

</dl>
<p>In many cases, <strong>iptstate</strong> needs to prompt you in order to change something. For example, if you want to set or change the source-ip filter, when you hit <strong>s</strong>, <strong>iptstate</strong> will pop up a prompt at the top of the window to ask you what you want to set it to.</p><p>Note that like many UNIX applications, ctrl-G will tell <strong>iptstate</strong> "nevermind" - it'll remove the prompt and forget you ever hit <strong>s</strong>.</p><p>In most cases, a blank response means "clear" - clear the source IP filter, for example.</p><p>At anytime while <strong>iptstate</strong> is running, you can hit <strong>h</strong> to get to the <strong>interactive help</strong> which will display all the current settings to you as well give you a list of all interactive commands available.</p><p>While running, <strong>space</strong> will immediately update the display. <strong>Iptstate</strong> should gracefully handle all window resizes, but if it doesn't, you can force it to re-calculate and re-draw the screen with a <strong>ctrl-L</strong>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SCROLLING AND PADS</h2>
        <div class="sectioncontent">
<p>For almost any user, there is no reason to turn off scrolling. The ability to turn this off - and especially the ability to toggle this interactively - is done more for theoretical completeness than anything else.</p>
<dl class='dl-vertical'>
  <dt>
    <p>But, nonetheless, here are the details. Typically in a curses application you create a "window." Windows don't scroll, however. They are, at most, the size of your terminal. Windows provide double-buffering to make refreshing as fast and seemless as possible. However, to enable scrolling, one has to use "pads" instead of windows. Pads can be bigger than the current terminal. Then all necessary data is written to the pad, and "scrolling" becomes a function of just showing the right part of that pad on the screen.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>However, pads do not have the double-buffering feature that windows have. Thus, there _might_ be some case where for some user using some very strange machine, having scrolling enabled could cause poor refreshing. Given the nature of the way <strong>iptstate</strong> uses the screen though, I find this highly unlikely. In addition, the scrolling method uses a little more memory. However, <strong>iptstate</strong> is not a memory intensive application, so this shouldn't be a problem even on low-memory systems.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p>Nonetheless, if this does negatively affect you, the option to turn it off is there.</p>
  </dt>
  <dd>
    
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">
<p>Anything other than 0 indicates and error. A list of current exit statuses are below:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>0</strong></p>
  </dt>
  <dd>
    <p>Success</p>
  </dd>
  <dt>
    <p><strong>1</strong></p>
  </dt>
  <dd>
    <p>Bad command-line arguments</p>
  </dd>
  <dt>
    <p><strong>2</strong></p>
  </dt>
  <dd>
    <p>Error communicating with the netfilter subsystem.</p>
  </dd>
  <dt>
    <p><strong>3</strong></p>
  </dt>
  <dd>
    <p>Terminal too narrow</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>We don't support filtering on resolved names, and we don't support filtering on networks. IPv6 support is new and the dynamic formatting doesn't yet always handle IPv6 addresses as well as it should.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUG REPORTS</h2>
        <div class="sectioncontent">
<p>All bugs should be reported to Phil Dibowitz &lt;phil AT ipom DOT com&gt;. Please see the <strong>README</strong> and <strong>BUGS</strong> for more information on bug reports. Please read the <strong>WISHLIST</strong> before sending in features you hope to see.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p><strong>iptstate</strong> does a lot of work to try to fit everything on the screen in an easy-to-read way. However, in some cases, hostnames may need to be truncated (in lookup mode). Similarly, IPv6 addresses may need to be truncated. The truncation of names happens from the right for source because you most likely know your own domain name, and from the left for destination because knowing your users are connection to "mail.a." doesn't help much. However, for addresses, this is reversed.</p><p><strong>iptstate</strong> does not automatically handle window-resizes while in the <strong>interactive help</strong> screen. If you do resize while in this window, you should return to the main window, hit <strong>ctrl-L</strong> to re-calculate and re-draw the screen, and then, if you choose, return to the <strong>interactive help</strong>.</p><p><strong>iptstate</strong> currently uses libnetfilter_conntrack to access the netfilter connection state table. However, older versions read out of /proc/net/ip_conntrack, and the current version can still be compiled to do this. This deprecated method can be racy on SMP systems, and can hurt performance on very heavily loaded firewalls. This deprecated method should be avoided - support will be removed in future versions.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO iptstate&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/iptables.8.html"><strong>iptables</strong>(8)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p><strong>iptstate</strong> was written by Phil Dibowitz &lt;phil AT ipom DOT com&gt;</p><p>http://www.phildev.net/iptstate/</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="iptraf-ng.8.html"><span aria-hidden="true">&larr;</span> iptraf-ng.8: Interactive colorful ip lan monitor</a></li>
   <li class="next"><a href="ipv6calc.8.html">ipv6calc.8: Ipv6calc <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
