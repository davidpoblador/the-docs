<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>stunnel3: Universal ssl tunnel</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Universal ssl tunnel">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="stunnel3 (8) manual">
  <meta name="twitter:description" content="Universal ssl tunnel">
  <meta name="twitter:image" content="https://www.carta.tech/images/stunnel4-stunnel3-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/stunnel3.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="stunnel3 (8) manual" />
  <meta property="og:description" content="Universal ssl tunnel" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/stunnel4-stunnel3-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">stunnel3<small> (8)</small></h1>
        <p class="lead">Universal ssl tunnel</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/stunnel3.8.html">
      <span itemprop="name">stunnel3: Universal ssl tunnel</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/stunnel4/">
      <span itemprop="name">stunnel4</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/stunnel3.8.html">
      <span itemprop="name">stunnel3: Universal ssl tunnel</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>stunnel</strong> [-c&nbsp;|&nbsp;-T] [-D&nbsp;[facility.]level] [-O&nbsp;a|l|r:option=value[:value]] [-o&nbsp;file] [-C&nbsp;cipherlist] [-p&nbsp;pemfile] [-v&nbsp;level] [-A&nbsp;certfile] [-S&nbsp;sources] [-a&nbsp;directory] [-t&nbsp;timeout] [-u&nbsp;ident_username] [-s&nbsp;setuid_user] [-g&nbsp;setgid_group] [-n&nbsp;protocol] [-P&nbsp;{&nbsp;filename&nbsp;|&nbsp;''&nbsp;}&nbsp;] [-B&nbsp;bytes] [-R&nbsp;randfile] [-W] [-E&nbsp;socket] [-I&nbsp;host] [-d&nbsp;[host:]port&nbsp;[-f]&nbsp;] [&nbsp;-r&nbsp;[host:]port&nbsp;|&nbsp;{&nbsp;-l&nbsp;|&nbsp;-L&nbsp;}&nbsp;program&nbsp;[--&nbsp;progname&nbsp;args]&nbsp;]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <strong>stunnel</strong> program is designed to work as <em>\s-1SSL\s0</em> encryption wrapper between remote clients and local (<em>inetd</em>-startable) or remote servers. The concept is that having non-SSL aware daemons running on your system you can easily set them up to communicate with clients over secure \s-1SSL\s0 channels.</p><p><strong>stunnel</strong> can be used to add \s-1SSL\s0 functionality to commonly used <em>inetd</em> daemons like \s-1POP-2\s0, \s-1POP-3\s0, and \s-1IMAP\s0 servers, to standalone daemons like \s-1NNTP\s0, \s-1SMTP\s0 and \s-1HTTP\s0, and in tunneling \s-1PPP\s0 over network sockets without changes to the source code.</p><p>This product includes cryptographic software written by Eric Young (eay@cryptsoft.com)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <strong>-h</strong>
  </dt>
  <dd>
    <p>Print stunnel help menu</p>
  </dd>
  <dt>
    <strong>-D</strong> level
  </dt>
  <dd>
    <p>Debugging level Level is a one of the syslog level names or numbers emerg (0), alert (1), crit (2), err (3), warning (4), notice (5), info (6), or debug (7).  All logs for the specified level and all levels numerically less than it will be shown.  Use -D debug or -D 7 for greatest debugging output.  The default is notice (5). The syslog facility 'daemon' will be used unless a facility name is supplied.  (Facilities are not supported on windows.) Case is ignored for both facilities and levels.</p>
  </dd>
  <dt>
    <strong>-O</strong> a|l|r:option=value[:value]
  </dt>
  <dd>
    <p>Set an option on accept/local/remote socket The values for linger option are l_onof:l_linger. The values for time are tv_sec:tv_usec. <strong>Examples:</strong> <strong>-O l:SO_LINGER=1:60</strong> - set one minute timeout for closing local socket <strong>-O r:TCP_NODELAY=1</strong> - turn off the Nagle algorithm for remote sockets <strong>-O r:SO_OOBINLINE=1</strong> - place out-of-band data directly into the receive data stream for remote sockets <strong>-O a:SO_REUSEADDR=0</strong> - disable address reuse (enabled by default) <strong>-O a:SO_BINDTODEVICE=lo</strong> - only accept connections on loopback interface The available options and their defaults are:</p>
<pre>
    Option          Accept    Local     Remote    OS default
    SO_DEBUG            --        --        --             0
    SO_DONTROUTE        --        --        --             0
    SO_KEEPALIVE        --        --        --             0
    SO_LINGER           --        --        --    0:0
    SO_OOBINLINE        --        --        --             0
    SO_RCVBUF           --        --        --         87380
    SO_SNDBUF           --        --        --         16384
    SO_RCVLOWAT         --        --        --             1
    SO_SNDLOWAT         --        --        --             1
    SO_RCVTIMEO         --        --        --         0:0
    SO_SNDTIMEO         --        --        --         0:0
    SO_REUSEADDR             1    --        --             0
    SO_BINDTODEVICE     --        --        --        --
    IP_TOS              --        --        --             0
    IP_TTL              --        --        --            64
    TCP_NODELAY         --        --        --             0
</pre>

  </dd>
  <dt>
    <strong>-o</strong> file
  </dt>
  <dd>
    <p>Append log messages to a file.</p>
  </dd>
  <dt>
    <strong>-C</strong> cipherlist
  </dt>
  <dd>
    <p>Select permitted \s-1SSL\s0 ciphers A colon delimited list of the ciphers to allow in the \s-1SSL\s0 connection. For example \s-1DES-CBC3-SHA:IDEA-CBC-MD5\s0</p>
  </dd>
  <dt>
    <strong>-c</strong>
  </dt>
  <dd>
    <p>client mode (remote service uses \s-1SSL\s0) default: server mode</p>
  </dd>
  <dt>
    <strong>-T</strong>
  </dt>
  <dd>
    <p>transparent proxy mode Re-write address to appear as if wrapped daemon is connecting from the \s-1SSL\s0 client machine instead of the machine running stunnel. Available only on some operating systems (Linux only, we believe) and then only in server mode. Note that this option will not combine with proxy mode (-r) unless the client's default route to the target machine lies through the host running stunnel, which cannot be localhost.</p>
  </dd>
  <dt>
    <strong>-p</strong> pemfile
  </dt>
  <dd>
    <p>private key and certificate chain \s-1PEM\s0 file name A \s-1PEM\s0 is always needed in server mode (by default located in <em>/etc/stunnel/stunnel.pem</em>). Specifying this flag in client mode will use this key and certificate chain as a client side certificate chain.  Using client side certs is optional. The certificates must be in \s-1PEM\s0 format and must be sorted starting with the certificate to the highest level (root \s-1CA\s0).</p>
  </dd>
  <dt>
    <strong>-v</strong> level
  </dt>
  <dd>
    <p>verify peer certificate</p><ul>
<li><p>level 1 - verify peer certificate if present</p></li><li><p>level 2 - verify peer certificate</p></li><li><p>level 3 - verify peer with locally installed certificate</p></li><li><p>default - no verify</p></li>
</ul>
  </dd>
  <dt>
    <strong>-a</strong> directory
  </dt>
  <dd>
    <p>client certificate directory This is the directory in which stunnel will look for certificates when using the <em>-v</em> options. Note that the certificates in this directory should be named \s-1XXXXXXXX\s0.0 where \s-1XXXXXXXX\s0 is the hash value of the cert.</p>
  </dd>
  <dt>
    <strong>-A</strong> certfile
  </dt>
  <dd>
    <p>Certificate Authority file This file contains multiple \s-1CA\s0 certificates, used with the <em>-v</em> options.</p>
  </dd>
  <dt>
    <strong>-t</strong> timeout
  </dt>
  <dd>
    <p>session cache timeout default: 300 seconds.</p>
  </dd>
  <dt>
    <strong>-N</strong> servicename
  </dt>
  <dd>
    <p>Service name to use for tcpwrappers. If not specified then a tcpwrapper service name will be generated automatically for you. This will also be used when auto-generating pid filenames.</p>
  </dd>
  <dt>
    <strong>-u</strong> ident_username
  </dt>
  <dd>
    <p>Use \s-1IDENT\s0 (\s-1RFC\s0 1413) username checking</p>
  </dd>
  <dt>
    <strong>-n</strong> proto
  </dt>
  <dd>
    <p>Negotiate \s-1SSL\s0 with specified protocol currently supported: smtp, pop3, nntp</p>
  </dd>
  <dt>
    <strong>-E</strong> socket
  </dt>
  <dd>
    <p>Entropy Gathering Daemon socket to use to feed OpenSSL random number generator.  (Available only if compiled with OpenSSL 0.9.5a or higher)</p>
  </dd>
  <dt>
    <strong>-R</strong> filename
  </dt>
  <dd>
    <p>File containing random input.  The \s-1SSL\s0 library will use data from this file first to seed the random number generator.</p>
  </dd>
  <dt>
    <strong>-W</strong>
  </dt>
  <dd>
    <p>Do not overwrite the random seed files with new random data.</p>
  </dd>
  <dt>
    <strong>-B</strong> bytes
  </dt>
  <dd>
    <p>Number of bytes of data read from random seed files.  With \s-1SSL\s0 versions less than 0.9.5a, also determines how many bytes of data are considered sufficient to seed the \s-1PRNG\s0.  More recent OpenSSL versions have a builtin function to determine when sufficient randomness is available.</p>
  </dd>
  <dt>
    <strong>-I</strong> host
  </dt>
  <dd>
    <p>\s-1IP\s0 of the outgoing interface is used as source for remote connections. Use this option to bind a static local \s-1IP\s0 address, instead.</p>
  </dd>
  <dt>
    <strong>-d</strong> [host:]port
  </dt>
  <dd>
    <p>daemon mode Listen for connections on [host:]port. If no host specified, defaults to all \s-1IP\s0 addresses for the local host. default: inetd mode</p>
  </dd>
  <dt>
    <strong>-f</strong>
  </dt>
  <dd>
    <p>foreground mode Stay in foreground (don't fork) and log to stderr instead of via syslog (unless -o is specified). default: background in daemon mode</p>
  </dd>
  <dt>
    <strong>-l</strong> program [-- programname [arg1 arg2 arg3...]  ]
  </dt>
  <dd>
    <p>execute local inetd-type program.</p>
  </dd>
  <dt>
    <strong>-L</strong> program [-- programname [arg1 arg2 arg3...]  ]
  </dt>
  <dd>
    <p>open local pty and execute program.</p>
  </dd>
  <dt>
    <strong>-s</strong> username
  </dt>
  <dd>
    <p><em>setuid()</em> to username in daemon mode</p>
  </dd>
  <dt>
    <strong>-g</strong> groupname
  </dt>
  <dd>
    <p><em>setgid()</em> to groupname in daemon mode. Clears all other groups.</p>
  </dd>
  <dt>
    <strong>-P</strong> { file | '' }
  </dt>
  <dd>
    <p>Pid file location If the argument is a filename, then that filename will be used for the pid. If the argument is empty ('', not missing), then no pid file will be created.</p>
  </dd>
  <dt>
    <strong>-r</strong> [host:]port
  </dt>
  <dd>
    <p>connect to remote service If no host specified, defaults to localhost.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>In order to provide \s-1SSL\s0 encapsulation to your local <em>imapd</em> service, use</p>
<pre>
  stunnel -d 993 -l /usr/sbin/imapd -- imapd
</pre>
<p>In order to let your local e-mail client connect to a \s-1SSL\s0-enabled <em>imapd</em> service on another server, configure the e-mail client to connect to localhost on port 119 and use:</p><p>  stunnel -c -d 143 -r servername:993</p><p>If you want to provide tunneling to your <em>pppd</em> daemon on port 2020, use something like</p><p>  stunnel -d 2020 -L /usr/sbin/pppd -- pppd local</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">
<p>If Stunnel is used to create local processes using the <strong>-l</strong> or <strong>-L</strong> options, it will set the following environment variables</p>
<dl class='dl-vertical'>
  <dt>
    \s-1REMOTE_HOST\s0
  </dt>
  <dd>
    <p>The \s-1IP\s0 address of the remote end of the connection.</p>
  </dd>
  <dt>
    \s-1SSL_CLIENT_DN\s0
  </dt>
  <dd>
    <p>The \s-1DN\s0 (Distinguished Name, aka subject name) of the peer certificate, if a certificate was present and verified.</p>
  </dd>
  <dt>
    \s-1SSL_CLIENT_I_DN\s0
  </dt>
  <dd>
    <p>The Issuer's \s-1DN\s0 of the peer's certificate, if a certificate was present and verified.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CERTIFICATES</h2>
        <div class="sectioncontent">
<ul>
<li><p>Each \s-1SSL\s0 enabled daemon needs to present a valid X.509 certificate to the peer. It also needs a private key to decrypt the incoming data. The easiest way to obtain a certificate and a key is to generate them with the free <em>openssl</em> package. You can find more information on certificates generation on pages listed below. Two things are important when generating certificate-key pairs for <strong>stunnel</strong>. The private key cannot be encrypted, because the server has no way to obtain the password from the user. To produce an unencrypted key add the <em>-nodes</em> option when running the <strong>req</strong> command from the <em>openssl</em> kit. The order of contents of the <em>.pem</em> file is also important. It should contain the unencrypted private key first, then a signed certificate (not certificate request). There should be also empty lines after certificate and private key. Plaintext certificate information appended on the top of generated certificate should be discarded. So the file should look like this:   -----BEGIN RSA PRIVATE KEY-----   [encoded key]   -----END RSA PRIVATE KEY-----   [empty line]   -----BEGIN CERTIFICATE-----   [encoded certificate]   -----END CERTIFICATE-----   [empty line]</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RANDOMNESS</h2>
        <div class="sectioncontent">
<ul>
<li><p><em>stunnel</em> needs to seed the \s-1PRNG\s0 (pseudo random number generator) in order for \s-1SSL\s0 to use good randomness.  The following sources are loaded in order until sufficient random data has been gathered:</p><ul>
<li><p>The file specified with the <em>-R</em> flag.</p></li><li><p>The file specified by the \s-1RANDFILE\s0 environment variable, if set.</p></li><li><p>The file .rnd in your home directory, if \s-1RANDFILE\s0 not set.</p></li><li><p>The file specified with '--with-random' at compile time.</p></li><li><p>The contents of the screen if running on Windows.</p></li><li><p>The egd socket specified with the <em>-E</em> flag.</p></li><li><p>The egd socket specified with '--with-egd-sock' at compile time.</p></li><li><p>The /dev/urandom device.</p></li>
</ul><p>With recent (&gt;=OpenSSL 0.9.5a) version of \s-1SSL\s0 it will stop loading random data automatically when sufficient entropy has been gathered. With previous versions it will continue to gather from all the above sources since no \s-1SSL\s0 function exists to tell when enough data is available. Note that on Windows machines that do not have console user interaction (mouse movements, creating windows, etc) the screen contents are not variable enough to be sufficient, and you should provide a random file for use with the <em>-R</em> flag. Note that the file specified with the <em>-R</em> flag should contain random data \*(-- that means it should contain different information each time <em>stunnel</em> is run.  This is handled automatically unless the <em>-W</em> flag is used.  If you wish to update this file manually, the <em>openssl</em> rand command in recent versions of OpenSSL, would be useful. One important note \*(-- if /dev/urandom is available, OpenSSL has a habit of seeding the \s-1PRNG\s0 with it even when checking the random state, so on systems with /dev/urandom you're likely to use it even though it's listed at the very bottom of the list above.  This isn't stunnel's behaviour, it's OpenSSLs.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LIMITATIONS</h2>
        <div class="sectioncontent">
<ul>
<li><p><em>stunnel</em> cannot be used for the \s-1FTP\s0 daemon because of the nature of the \s-1FTP\s0 protocol which utilizes multiple ports for data transfers. There are available \s-1SSL\s0 enabled versions of \s-1FTP\s0 and telnet daemons, however.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO stunnel3&hellip;</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <em>tcpd</em>\|(8)
  </dt>
  <dd>
    <p>access control facility for internet services</p>
  </dd>
  <dt>
    <em>inetd</em>\|(8)
  </dt>
  <dd>
    <p>internet ``super-server''</p>
  </dd>
  <dt>
    <em>http://stunnel.mirt.net/</em>
  </dt>
  <dd>
    <p>Stunnel homepage</p>
  </dd>
  <dt>
    <em>http://www.stunnel.org/</em>
  </dt>
  <dd>
    <p>Stunnel Frequently Asked Questions</p>
  </dd>
  <dt>
    <em>http://www.openssl.org/</em>
  </dt>
  <dd>
    <p>OpenSSL project website</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    Michal Trojnara
  </dt>
  <dd>
    <p>&lt;<em>Michal.Trojnara@mirt.net</em>&gt;</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="stund.8.html"><span aria-hidden="true">&larr;</span> stund.8: Stun protocol (simple traversal of udp through nats) server</a></li>
   <li class="next"><a href="submit.8.html">submit.8: Submit a new message to the courier mail server <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
