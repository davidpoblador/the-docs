<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>usbhid-ups: Driver for usb/hid ups equipment</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Driver for usb/hid ups equipment">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="usbhid-ups (8) manual">
  <meta name="twitter:description" content="Driver for usb/hid ups equipment">
  <meta name="twitter:image" content="https://www.carta.tech/images/nut-server-usbhid-ups-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/usbhid-ups.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="usbhid-ups (8) manual" />
  <meta property="og:description" content="Driver for usb/hid ups equipment" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/nut-server-usbhid-ups-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">usbhid-ups<small> (8)</small></h1>
        <p class="lead">Driver for usb/hid ups equipment</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/usbhid-ups.8.html">
      <span itemprop="name">usbhid-ups: Driver for usb/hid ups equipment</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/nut-server/">
      <span itemprop="name">nut-server</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/usbhid-ups.8.html">
      <span itemprop="name">usbhid-ups: Driver for usb/hid ups equipment</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">NOTE</h2>
        <div class="sectioncontent">
<p>This man page only documents the hardware-specific features of the usbhid-ups driver. For information about the core driver, see <a href="../man8/nutupsdrv.8.html"><strong>nutupsdrv</strong>(8)</a>.</p><p>This driver, formerly called <em>newhidups</em>, replaces the legacy <em>hidups</em> driver, which only supported Linux systems.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SUPPORTED HARDWARE</h2>
        <div class="sectioncontent">
<p><strong>usbhid-ups</strong> brings USB/HID UPS monitoring to NUT on all platform supporting USB through libusb. It should detect any UPS that uses the HID power device class, but the amount of data will vary depending on the manufacturer and model.</p><p>At the present time, usbhid-ups supports:</p><p>the newer Eaton USB models,</p><p>all MGE USB models,</p><p>all Dell USB models,</p><p>some APC models,</p><p>some Belkin models,</p><p>some Cyber Power Systems models.</p><p>some TrippLite models</p><p>For a more complete list, refer to the NUT hardware compatibility list, available in the source distribution as data/drivers.list, or on the NUT website. You may use the "explore" driver option to gather information from HID UPSes which are not yet supported; see below for details.</p><p>This driver is known to work on:</p><p>most Linux systems,</p><p>FreeBSD (beta stage) and maybe other *BSD,</p><p>Darwin / Mac OS X,</p><p>Solaris 10.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXTRA ARGUMENTS</h2>
        <div class="sectioncontent">
<p>This driver also supports the following optional settings:</p><p><strong>offdelay</strong>=<em>num</em></p><p>Set the timer before the UPS is turned off after the kill power command is sent (via the <strong>-k</strong> switch).</p><p>The default value is 20 (in seconds). Usually this <strong>must be lower</strong> than <em>ondelay</em>, but the driver will <strong>not</strong> warn you upon startup if it isn\(cqt.</p><p><strong>ondelay</strong>=<em>num</em></p><p>Set the timer for the UPS to switch on in case the power returns after the kill power command had been sent but before the actual switch off. This ensures the machines connected to the UPS are, in all cases, rebooted after a power failure.</p><p>The default value is 30 (in seconds). Usually this <strong>must be greater</strong> than offdelay, but the driver will <strong>not</strong> warn you upon startup if it isn\(cqt. Some UPS\(cqes will restart no matter what, even if the power is (still) out at the moment this timer elapses. In that case, you could try if setting <em>ondelay = -1</em> in <strong>ups.conf</strong> helps.</p><p><strong>pollfreq</strong>=<em>num</em></p><p>Set polling frequency, in seconds, to reduce the USB data flow. Between two polling requests, the driver will wait for interrupts (aka UPS notifications), which are data changes returned by the UPS by itself. This mechanism allow to avoid or reduce staleness message, due to the UPS being temporarily overloaded with too much polling requests. The default value is 30 (in seconds).</p><p><strong>pollonly</strong></p><p>If this flag is set, the driver will ignore interrupts it receives from the UPS (not recommended, but needed if these reports are broken on your UPS).</p><p><strong>vendor</strong>=<em>regex</em>, <strong>product</strong>=<em>regex</em>, <strong>serial</strong>=<em>regex</em>, <strong>vendorid</strong>=<em>regex</em>, <strong>productid</strong>=<em>regex</em></p><p>Select a specific UPS, in case there is more than one connected via USB Each option specifies an extended regular expression (see <a href="../man7/regex.7.html"><strong>regex</strong>(7)</a>) that must match the UPS\(cqs entire vendor/product/serial string (minus any surrounding whitespace), or the whole 4-digit hexadecimal code for vendorid and productid. Try <strong>-DD</strong> for finding out the strings to match.</p><p>Examples:</p><p>-x vendor="Foo.Corporation.*"</p><p>-x vendorid=051d* (APC)</p><p>-x product=".*(Smart|Back)-?UPS.*"</p><p><strong>bus</strong>=<em>regex</em></p><p>Select a UPS on a specific USB bus or group of busses. The argument is a regular expression that must match the bus name where the UPS is connected (e.g. bus="002", bus="00[2-3]").</p><p><strong>explore</strong></p><p>With this option, the driver will connect to any device, including ones that are not yet supported. This must always be combined with the "vendorid" option. In this mode, the driver will not do anything useful except for printing debugging information (typically used with -DD).</p><p><strong>maxreport</strong></p><p>With this option, the driver activates a tweak to workaround buggy firmware returning invalid HID report length. Some APC Back-UPS units are known to have this bug.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INSTALLATION</h2>
        <div class="sectioncontent">
<p>This driver is not built by default. You can build it by using "configure --with-usb=yes". Note that it will also install other USB drivers.</p><p>You also need to install manually the legacy hotplug files (libhidups and libhid.usermap, generally in /etc/hotplug/usb/), or the udev file (nut-usbups.rules, generally in /etc/udev/rules.d/) to address the permission settings problem. For more information, refer to the README file in nut/scripts/hotplug or nut/scripts/udev.</p><p>On Linux with MGE equipment, you will need at least a 2.4.25 or 2.6.2 kernel as well as libusb-0.1.8 or later to disable hiddev support and avoid conflict.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">IMPLEMENTATION</h2>
        <div class="sectioncontent">
<p>The driver ignores the "port" value in <strong>ups.conf</strong>. Unlike previous versions of this driver, it is now possible to control multiple UPS units simultaneously with this driver, provided they can be distinguished by setting some combination of the "vendor", "product", "serial", "vendorid", and "productid" options. For instance:</p>
<pre>
[mge]
        driver = usbhid-ups
        port = auto
        vendorid = 0463
[tripplite]
        driver = usbhid-ups
        port = auto
        vendorid = 09ae
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">KNOWN ISSUES AND BUGS</h2>
        <div class="sectioncontent">
<h3>Repetitive timeout and staleness</h3>
<p>Some models tends to be unresponsive with the default polling frequency. The result is that your system log will have lots of messages like:</p>
<pre>
usb 2-1: control timeout on ep0in
usb 2-1: usbfs: USBDEVFS_CONTROL failed cmd usbhid-ups rqt 128 rq 6 len 256
ret -110
</pre>
<p>In this case, simply modify the general parameter "pollinterval" to a higher value (like 10 for 10 seconds). This should solve the issue.</p>
<h3>Got EPERM: Operation not permitted upon driver startup</h3>
<p>You have forgotten to install the hotplug files, as explained in the INSTALLATION section above. Don\(cqt forget to restart hotplug so that it applies these changes.</p>
<h3>Unattended shutdowns</h3>
<p>The hardware which was used for development of this driver is almost certainly different from what you have, and not all manufacturers follow the USB HID Power Device Class specifications to the letter. You don\(cqt want to find out that yours has issues here when a power failure hits your server room and you\(cqre not around to manually restart your servers.</p><p>If you rely on the UPS to shutdown your systems in case of mains failure and to restart them when the power returns, you <strong>must</strong> test this. You can do so by running <em>upsmon -c fsd</em>. With the mains present, this should bring your systems down and then cycle the power to restart them again. If you do the same without mains present, it should do the same, but in this case, the outputs shall remain off until mains power is applied again.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Originally sponsored by MGE UPS SYSTEMS. Now sponsored by Eaton http://opensource.eaton.com Arnaud Quette, Peter Selinger, Arjen de Korte</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO usbhid-ups&hellip;</h2>
        <div class="sectioncontent">
<h3>The core driver</h3>
<p><a href="../man8/nutupsdrv.8.html"><strong>nutupsdrv</strong>(8)</a></p>
<h3>Internet resources</h3>
<p>The NUT (Network UPS Tools) home page: http://www.networkupstools.org/</p>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="urfkilld.8.html"><span aria-hidden="true">&larr;</span> urfkilld.8: Urfkill daemon</a></li>
   <li class="next"><a href="usbip.8.html">usbip.8: Manage usb/ip devices <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
