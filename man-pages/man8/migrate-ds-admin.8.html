<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>migrate-ds-admin: Admin server and directory server migration script</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Admin server and directory server migration script">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="migrate-ds-admin (8) manual">
  <meta name="twitter:description" content="Admin server and directory server migration script">
  <meta name="twitter:image" content="https://www.carta.tech/images/389-admin-migrate-ds-admin-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/migrate-ds-admin.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="migrate-ds-admin (8) manual" />
  <meta property="og:description" content="Admin server and directory server migration script" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/389-admin-migrate-ds-admin-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">migrate-ds-admin<small> (8)</small></h1>
        <p class="lead">Admin server and directory server migration script</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/migrate-ds-admin.8.html">
      <span itemprop="name">migrate-ds-admin: Admin server and directory server migration script</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/389-admin/">
      <span itemprop="name">389-admin</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/migrate-ds-admin.8.html">
      <span itemprop="name">migrate-ds-admin: Admin server and directory server migration script</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>migrate-ds-admin.pl</strong> [--options] <strong>--</strong> [args]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Admin Server and Directory Server migration script - migrates Admin Server and all Directory Server instances from older releases to the current release.</p><p>This script will copy instances (data and configuration) from the old server root directory to their new FHS locations.  This script does a copy only - the data in the old instances will be left untouched.  The old instances must be shutdown first to ensure that the databases are copied safely.  During migration your migrated instances will be started.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>A summary of options is included below:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong></strong><strong>--help</strong></p>
  </dt>
  <dd>
    <p>This message</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--version</strong></p>
  </dt>
  <dd>
    <p>Print the version and exit</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--debug</strong></p>
  </dt>
  <dd>
    <p>Turn on debugging</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--oldsroot</strong></p>
  </dt>
  <dd>
    <p>The old server root directory to migrate from</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--actualsroot</strong> This is the old location of the old server root.</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong></strong><strong>--silent</strong></p>
  </dt>
  <dd>
    <p>Use silent setup - no user input</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--file</strong>=<em>name</em></p>
  </dt>
  <dd>
    <p>Use the file 'name' in .inf format to supply the default answers</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--keepcache</strong></p>
  </dt>
  <dd>
    <p>Do not delete the temporary .inf file generated by this program</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--logfile</strong></p>
  </dt>
  <dd>
    <p>Log migration messages to this file - otherwise, a temp file will be used</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--instance</strong></p>
  </dt>
  <dd>
    <p>By default, all directory server instances will be migrated.  You can use this argument to specify one or more (e.g. <strong>-i</strong> slapd-foo <strong>-i</strong> slapd-bar) if you do not want to migrate all of them.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--cross</strong></p>
  </dt>
  <dd>
    <p>See below.</p>
  </dd>

</dl>
<p>For all options, you can also use the short name e.g. <strong>-h</strong>, <strong>-d</strong>, etc. For the <strong>-d</strong> argument, specifying it more than once will increase the debug level e.g. <strong>-ddddd</strong></p><p>args: You can supply default .inf data in this format:</p><ul>
<li><p>section.param=value</p></li>
</ul><p>e.g.</p><ul>
<li><p>General.FullMachineName=foo.example.com</p></li>
</ul><p>or</p><ul>
<li><p>"slapd.Suffix=dc=example, dc=com"</p></li>
</ul><p>Values passed in this manner will override values in an .inf file given with the <strong>-f</strong> argument.  The only required argument is the password of the Configuration Directory Administrator, which can be specified on the command line like this:</p><ul>
<li><p>migrate-ds-admin.pl General.ConfigDirectoryAdminPwd=thepassword</p></li>
</ul><p>All other parameters needed for migration will be read from the old Admin Server configuration.</p><p>actualsroot: This is used when you must migrate from one machine to another.  The usual case is that you have mounted the old server root on a different root directory, either via a network mount, or by copying a tarball made using a relative directory on the source machine to the destination machine and untarring it.</p><p>For example: machineA is a 32bit machine, and you want to migrate your servers to a new 64bit machine.  Lets assume your old server root on machineA was /opt/myds, and your new machine also wants to use a server root of /opt/myds.  There are a couple of different ways to proceed.  Either make a tarball of opt/myds from machineA using a relative path (i.e. NOT /opt/myds) or use NFS to mount machineA:/opt/myds on a different mount point (e.g. machineB:/migration/opt/myds).</p><p>If you do this, you should give the old "real" server root (/opt/myds) as the <strong>--actualsroot</strong> argument, and use /migration/opt/myds for the <strong>--oldsroot</strong> argument.  That is, the oldsroot is the physical location of the files on disk.  The actualsroot is the old value of the server root on the source machine.</p><p>cross: Also known as crossplatform, or 'c', or 'x'. This is when the source machine is a different architecture than the destination machine.  In this case, only certain data will be available for migration.  Changelog information will not be migrated, and replicas will need to be reinitialized (if migrating masters or hubs).  This type of migration requires that all of your old databases have been dumped to LDIF format, and the LDIF file must be in the default database directory (usually /opt/fedora-ds/slapd-instance/db), and the LDIF file must have the same name as the database instance directory, with a ".ldif".  For example, if you have</p><ul>
<li>
<pre>
/opt/fedora-ds/slapd-instance/db/userRoot/
and
/opt/fedora-ds/slapd-instance/db/NetscapeRoot/
</pre>
</li>
</ul><p>you must first use db2ldif to export these databases to LDIF e.g.</p><ul>
<li>
<pre>
cd /opt/fedora-ds/slapd-instance
./db2ldif <strong>-n</strong> userRoot <strong>-a</strong> /opt/fedora-ds/slapd-instance/db/userRoot.ldif and
./db2ldif <strong>-n</strong> NetscapeRoot <strong>-a</strong> /opt/fedora-ds/slapd-instance/db/NetscapeRoot.ldif
</pre>
</li>
</ul><p>Then you must somehow make your old server root directory available on the destination machine, either by creating a tar archive on the source and copying it to the destination, or by network mounting the source directory on the destination machine.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>migrate-ds-admin.pl was written by the 389 Project.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">
<p>Report bugs to http://bugzilla.redhat.com.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2008 Red Hat, Inc.</p><p>This manual page was written by Michele Baldessari &lt;michele@pupazzo.org&gt;, for the Debian project (but may be used by others).</p><p>This is free software.  You may redistribute copies of it under the terms of the Directory Server license found in the LICENSE file of this software distribution.  This license is essentially the GNU General Public License version 2 with an exception for plug-in distribution.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="migrate-ds.8.html"><span aria-hidden="true">&larr;</span> migrate-ds.8: Directory server migration script</a></li>
   <li class="next"><a href="migratepages.8.html">migratepages.8: Migrate the physical location a processes pages <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
