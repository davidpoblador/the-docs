<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>greylistd: Simple greylisting system for mail transport agents</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Simple greylisting system for mail transport agents">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="greylistd (8) manual">
  <meta name="twitter:description" content="Simple greylisting system for mail transport agents">
  <meta name="twitter:image" content="https://www.carta.tech/images/greylistd-greylistd-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/greylistd.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="greylistd (8) manual" />
  <meta property="og:description" content="Simple greylisting system for mail transport agents" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/greylistd-greylistd-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">greylistd<small> (8)</small></h1>
        <p class="lead">Simple greylisting system for mail transport agents</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/greylistd.8.html">
      <span itemprop="name">greylistd: Simple greylisting system for mail transport agents</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/greylistd/">
      <span itemprop="name">greylistd</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/greylistd.8.html">
      <span itemprop="name">greylistd: Simple greylisting system for mail transport agents</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>greylistd</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<h3>Greylisting</h3>
<p>This daemon provides a simple greylisting implementation for use with Exim and other mail transport agents (MTAs).  For a more elaborate introduction to greylisting, please refer to Evan Harris' whitepaper at: 	http://projects.puremagic.com/greylisting/</p><p>Greylisting is a simple but highly effective means to weed out messages that are being delivered via spamware/ratware tools.  The idea is to establish whether a prior relationship exists between the sender and the receiver of a message.  Most of the time it does, and the delivery proceeds normally.</p><p>On the other hand, if no prior relationship exists, the delivery is temporarily rejected, using a 451 SMTP response.  Legitimate MTAs will treat this response accordingly, and retry the delivery in a while. In contrast, ratware will usually fail to retry the delivery in a normal fashion.</p><p>As a result, greylisting is currently more than 90% effective in blocking incoming junk mail, while nearly all legitimate mail goes through.</p><p>Three pieces of information (herafter called a <em>triplet</em>) from the delivery attempt are cached for future reference:</p>
<pre>
  - The address of the host attempting the delivery
  - The envelope sender address (MAIL FROM:)
  - The envelope recipient address (RCPT TO:)
</pre>
<p>If a delivery attempt was temporarily rejected, then after an initial timeout (60 minutes by default), but before a retry expiration time (8 hours by default), new delivery attempts with the same <em>triplet</em> are accepted, and the <em>triplet</em> is added to a whitelist.  This allows for delivery retries, presumably from legitimate MTAs, and ensures that future mail from the same contact is not subject to greylisting.</p><p>If a whitelisted <em>triplet</em> has not been seen for an extended duration (by default 60 days), it is expired.  This prevents unlimited growth of the list.</p><p>The downside to greylisting is that legitimate mail from people who have never sent you mail in the past (or, at least, within the last 60 days) are subject to a one-hour delay.</p><p>The upside is that the current generation of ratware tools will not be able to deliver spam or virii to you.  Even if, as a result of lots of sites incorporating the greylisting concept, ratware tools are modified such that temporarily rejected deliveries are retried, you stand an increased chance of blocking such mail.  That is because within the mandatory 1-hour initial delay, chances are that the sending host's IP address has been listed in one or more DNS block lists (such as bl.spamcop.net, cbl.abuseat.org, etc..), and can be rejected by your MTA by consulting these lists directly, or via anti-spam software like SpamAssassin.</p>
<h3>greylistd</h3>
<p><strong>greylistd</strong> is meant to be installed on a server that accepts incoming mail.  The MTA on this server connects to the greylistd daemon over a UNIX domain socket (by default <em>/var/run/greylistd/socket</em>), or alternatively via the command <a href="../man1/greylist.1.html"><strong>greylist</strong>(1)</a>, and submits a string (<em>triplet</em>) that identifies a particular host/sender/recipient relationship. <strong>greylistd</strong> responds "white", "grey" or "black", depending on the current listing status of the provided <em>triplet</em>.  Alternatively, if either of the "--white", "--grey", or "--black" options precede the data, <strong>greylistd</strong> responds "true" or "false", indicating whether the triplet is currently in the corresponding state.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<h3>Exim 4</h3>
<p>A sample greylistd statement for Exim 4 is provided with this package, and can normally be found in "/usr/share/doc/greylistd/examples/exim4-acl-example.txt".</p>
<h3>Others</h3>
<p>What others?  :-)</p><p>A prerequisite to greylisting in general is the ability to perform custom filtering throughout the various stages in the SMTP transaction, most notably after the <strong>RCPT TO:</strong> SMTP command.  In particular, <a href="../man8/greylistd.8.html"><strong>greylistd</strong>(8)</a> can be invoked either over a UNIX domain socket or via the supplied <a href="../man1/greylist.1.html"><strong>greylist</strong>(1)</a> utility.</p><p>Although <a href="../man8/greylistd.8.html"><strong>greylistd</strong>(8)</a> is written mainly with Exim in mind, it should be possible to use it with any MTA that:</p>
<dl class='dl-vertical'>
  <dt>
      -
  </dt>
  <dd>
    <p>Allows arbitrary strings to be passed on via a UNIX domain socket (<strong>/var/run/greylistd/socket</strong>) or supplied to external programs (<a href="../man1/greylist.1.html"><strong>greylist</strong>(1)</a>).</p>
  </dd>
  <dt>
      -
  </dt>
  <dd>
    <p>Can defer the incoming delivery, based on the response.</p>
  </dd>

</dl>
<p>Some MTAs either have limited or no support for such external filters in the SMTP transaction (e.g. Sendmail), or define a very custom interface for such filters (e.g. Postifx "Policy Servers").</p><p>That said, solutions exist for these other MTAs as well.  For Postfix, check into "postgrey", and for Sendmail there is "relaydelay".  For other MTAs, check the links on Evan Harris' greylisting project page:</p>
<pre>
    http://projects.puremagic.com/greylisting/links.html
</pre>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<h3>/etc/greylistd/config</h3>
<p>Configuration settings.  Currently, this file consists of three sections:</p>
<dl class='dl-vertical'>
  <dt>
    [timeout]
  </dt>
  <dd>
    <p>Lists various timeouts used to determine how long to keep a new <em>triplet</em> greylisted, and when to expire previosly known <em>triplet</em>s.</p>
  </dd>
  <dt>
    [socket]
  </dt>
  <dd>
    <p>Specifies path and permissions of the UNIX domain socket on which <strong>greylistd</strong> will listen.</p>
  </dd>
  <dt>
    [data]
  </dt>
  <dd>
    <p>Specifies the paths to the data files, containing the data items and statistics, as well as an <em>update interval</em> specifying how often data will be written to these files.</p>
  </dd>

</dl>

<h3>/var/lib/greylistd/states</h3>
<p>(default path, can be modified in the configuration file)</p><p>Runtime data.  Theare are four sections: <strong>[white]</strong>, <strong>[grey]</strong>, <strong>[black]</strong> and <strong>[statistics]</strong>.  The first three sections consist of lines of the form:</p>
<pre>
    <em>hash</em> = <em>lastseen firstseen count</em>
</pre>
<p>where:</p>
<dl class='dl-vertical'>
  <dt>
      -
  </dt>
  <dd>
    <p><em>hash</em> is a 32-bit value representing a given <em>triplet</em>,</p>
  </dd>
  <dt>
      -
  </dt>
  <dd>
    <p><em>lastseen</em> is a 32-bit value representing the timestamp of last delivery attempt for this triplet,</p>
  </dd>
  <dt>
      -
  </dt>
  <dd>
    <p><em>firstseen</em> is a 32-bit value representing the timestamp of first known delivery attempt for this triplet,</p>
  </dd>
  <dt>
      -
  </dt>
  <dd>
    <p><em>count</em> is a 32-bit value representing the number of delivery attempts that have been made for this triplet in this time period.</p>
  </dd>

</dl>
<p>The <strong>[statistics]</strong> section contains a counter for each of the three lists, indicating how many items that has ever made its way into these lists by way of the <strong>update</strong> protocol.</p>
<h3>/var/lib/greylistd/triplets</h3>
<p>(default path, can be modified in the configuration file)</p><p>Unhashed data - i.e. the original triplets passed to greylistd. Internally, <a href="../man8/greylistd.8.html"><strong>greylistd</strong>(8)</a> hashes the provided data into a single 32-bit value for efficiency.  Prior to version 0.6, the original data was not retained; as of version 0.6, data is optionally saved into this file.</p><p>Data items are saved in the form:</p>
<pre>
    <em>hash</em> = <em>data</em> ...
</pre>

<h3>/var/run/greylistd/socket</h3>
<p>(default path, can be modified in the configuration file)</p><p>The UNIX domain socket providing the main interface to "greylistd". The MTA can either connect to this socket directly, or use the supplied "greylist" utility to do so.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Because <em>triplet</em>s and timestamps are hashed into simple 32-bit values, there is a very slim chance that deliveries that should have been greylisted are allowed through.  More so for very busy sites.</p><p>Commands are actually executed in the daemon, not the "greylist" client.  If the user who invokes "greylist" interactively has a different time zone than the daemon process, time and date representations in the output will reflect those of the daemon.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>This python script and manual page is written by Tor Slettnes, originally for Debian GNU/Linux.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2004-2005 Tor Slettnes.</p><p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p><p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.</p><p>On a Debian GNU/Linux system, the full text of the GPL is available in /usr/share/common-licenses/GPL.  It is also available at:</p>
<pre>
    http://www.gnu.org/licenses/gpl.html
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO greylistd&hellip;</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    http://projects.puremagic.com/greylisting/
  </dt>
  <dd>
    <p>Evan Harris' greylisting whitepaper</p>
  </dd>
  <dt>
    <strong>greylist</strong>(1)
  </dt>
  <dd>
    <p>Command-line interface to the greylist daemon.</p>
  </dd>
  <dt>
    <strong>greylistd-setup-exim4</strong>(8)
  </dt>
  <dd>
    <p>Utility to add/remove support for greylistd in Exim 4 configuration files.</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="gradm2.8.html"><span aria-hidden="true">&larr;</span> gradm2.8: Administration program for the grsecurity rbac system</a></li>
   <li class="next"><a href="greylistd-setup-exim4.8.html">greylistd-setup-exim4.8: Add/remove support for greylistd in exim 4 <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
