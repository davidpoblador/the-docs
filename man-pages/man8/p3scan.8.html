<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>p3scan: Fully transparent proxy scanning server for pop3 and smtp</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Fully transparent proxy scanning server for pop3 and smtp">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="p3scan (8) manual">
  <meta name="twitter:description" content="Fully transparent proxy scanning server for pop3 and smtp">
  <meta name="twitter:image" content="https://www.carta.tech/images/p3scan-p3scan-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/p3scan.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="p3scan (8) manual" />
  <meta property="og:description" content="Fully transparent proxy scanning server for pop3 and smtp" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/p3scan-p3scan-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">p3scan<small> (8)</small></h1>
        <p class="lead">Fully transparent proxy scanning server for pop3 and smtp</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/p3scan.8.html">
      <span itemprop="name">p3scan: Fully transparent proxy scanning server for pop3 and smtp</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/p3scan/">
      <span itemprop="name">p3scan</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/p3scan.8.html">
      <span itemprop="name">p3scan: Fully transparent proxy scanning server for pop3 and smtp</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>p3scan</strong> [<em>options</em>]
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>p3scan is a fully transparent proxy scanning server for POP3, SMTP, and limited POP3S email clients. It runs on a Linux box with iptables (for port redirection).</p><p>It implements a centralized email scanning point, transparently inspecting messages fetched by internal network hosts from servers "in the wild" (the Internet) for viruses, worms, trojans, spam and potentially dangerous attachments. Since HTML email can be used by spammers to validate the recipient address (via Web Bugs) p3scan can also provide HTML stripping by using the associated p3pmail (or other) program.</p><p>It can also inspect outgoing SMTP messages for virus's.</p><p>p3scan can help you in protecting your "Other OS" LAN especially if used synergically with a firewall and other proxy servers.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-a, --renattach=FILE Specify location of renattach if wanted</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-A, --altvnmsg Creates a copy of 'template=FILE' for manipulation prior to use. /var/spool/p3scan/children/&lt;pid&gt;/vnmsg</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-b, --bytesfree=NUM Number (in KBytes) that should be available before we can process messages. If not enough, report it and die.</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-B, --broken Enable broken processing (some Outlook/Outlook Express clients).</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-c, --viruscode=N[,N] The code(s) the scanner returns when a virus is found</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-C, --checksize=NUM Number (in KBytes) of the maximum smtp message size.</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-d, --debug Turn on debugging. See /etc/p3scan/p3scan.conf for recommended debug procedure.</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-e, --extra Extra notification of recipient's email address</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-f, --configfile=FILE Specify a configfile Default is /etc/p3scan/p3scan.conf</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-F, --footer=CMD Specify a command to get the version info of your scanner if using the smtp footer feature file /etc/p3scan/p3scan.footer</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-g, --virusregexp=RX Specify a RegularExpression which describes where to get the name of the virus. The first substring is used, or if regexp ends with /X the X substring</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-G  --goodcode The codes that enable the message to be delivered without a warning. For example Kaspersky AV reports code 10 for an encrypted .zip file</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-h, --help Prints this text</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-i, --ip=IP Listen only on IP &lt;IP&gt;. Default: ANY</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-I, --targetip=IP Connect only to IP &lt;IP&gt;. Default: use transparent-proxy</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-j, --justdelete Just delete infected mail after reporting infection</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-k, --checkspam Turn on Spam Checking</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-K, --emergcon Emergency Contact email address to be notified in event of program termination like no disk space.</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-l, --pidfile=FILE Specify where to write a pid-file</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-L, --sslport=PORT Use SSL on connections to port &lt;PORT&gt;. Default 995</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-m, --maxchilds=NUM Allow not more then NUM childs</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-M, --ispspam Specify a line used by your ISP to mark Spam For example, cox.net uses -- Spam --</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-n, --notifydir=DIR Create notification mails in &lt;DIR&gt; Default: /var/spool/p3scan/notify Also used for temporary storage.</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-N, --notify Change infected file status line</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-o, --overwrite Specify path to HTML parsing program executable. Default none</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-O, --timeout=NUM Specify seconds to use for timeout notification.</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-p, --port=PORT Listen on port &lt;PORT&gt;. Default: 8110</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-P, --targetport=PORT Connect to port &lt;PORT&gt;. Default: 8110 Ignored in transparent proxy mode</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-q, --quiet Turn off normal reporting</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-r, --virusdir=DIR Save infected mails in &lt;DIR&gt; Default: /var/spool/p3scan</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-R, --smtprset Change smtp reject message line</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-s, --scanner=FILE Specify the scanner. Every scannertype handles this in a specific way. This could be the scanner- executable or a FIFO, Socket, ...</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-S, --subject=TEXT Change virus reporting subject line</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-t, --template=FILE Use virus-notification-template &lt;FILE&gt;</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-T, --scannertype=T Define which buildin scanner-frontend to use. Supported types:</p>
<pre>
  basic: Basic file invocation scanner
   avpd: Kaspersky AVPDaemon
</pre>
<p>trophie: Trophie antivirus daemon (for Trend Antivirus)</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-u, --user=[UID|NAME] Run as user &lt;UID&gt;. Default: mail Only takes effect when started as superuser</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-U, --useurl Parse username for destination "username#url:port" vice using iptables redirection.</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-v, --version Prints version information</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-x, --demime eXtract all MIME-Parts before scanning</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-X, --Xtra mail program=FILE Xtra notification reciept mail program. Default: /bin/mail</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>-z, --spamcheck=FILE Specify path to Spam Checking program executable Default /usr/bin/spamc (Mail::SpamAssassin)</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIRECTORIES/FILES</h2>
        <div class="sectioncontent">

<pre>
/etc/p3scan
/var/run/p3scan
/var/spool/p3scan
/var/spool/p3scan/children
/var/spool/p3scan/notify
/usr/doc/p3scan-&lt;version&gt;/AUTHORS
/usr/doc/p3scan-&lt;version&gt;/ChangeLog
/usr/doc/p3scan-&lt;version&gt;/CONTRIBUTERS
/usr/doc/p3scan-&lt;version&gt;/LICENSE
/usr/doc/p3scan-&lt;version&gt;/NEWS
/usr/doc/p3scan-&lt;version&gt;/README
/usr/doc/p3scan-&lt;version&gt;/README-ripmime
/usr/doc/p3scan-&lt;version&gt;/README-rpm
/usr/doc/pscan-&lt;version&gt;/TODO.list
/usr/doc/p3scan-&lt;version&gt;/spamfaq.html
/usr/doc/p3scan-&lt;version&gt;/spamfaq.txt
/usr/man/man8/p3scan.8.gz
/usr/man/man8/p3scan_readme.8.gz

/etc/p3scan/p3scan.conf
  Configuration file
/etc/p3scan/p3scan.mail
  Symlink to the email message templates sent to client in event
  a virus is found. You can create a symlink, or copy a language
  file p3scan-??.mail for any language provided. If you translate
  a mail file into your own language, please consider contributing
  it to the project so that others may enjoy your work.
/etc/p3scan/p3scan-??.mail
/etc/p3scan/p3scan-??-??.mail
  Email templates for specific languages.
/etc/p3scan/p3scan.footer (optional)
  This file is used to add the virus definition info from your scanner
  to an smtp message. It will only be added as a footer if the message
  is not signed cryptographically and is only a text message.
  It is used in conjunction with the "footer" option in the
  following fashion:

  1) If file does not exist and "footer" is defined:
     No footer information will added to outgoing messages, but the p3scan
     version and scanner info will be added to the header.

  2) If file exists but blank and "footer" is defined:
     P3Scan version/host info and scanner info will be added to end of
     message and header.

  3) If file contains information and "footer" is defined:
     All lines of this file will be added to the end of the smtp message and
     then p3scan version/host info and scanner info will be appended.

  4) If file does not exist and "footer" is not defined:
     P3Scan will only insert p3scan version info into the header.
/usr/sbin/p3scan
  Executable program file
/var/run/p3scan/p3scan.pid
  This file is written when p3scan is running.
/var/spool/p3scan/children/$FILES
  Each email scanned is manipulated in this directory
/var/spool/p3scan/notify/$FILES
  When a virus is found, the email sent to the client is generated here.

</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO p3scan&hellip;</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>p3scan_readme /etc/p3scan/p3scan.conf /etc/p3scan/p3scan.mail dspam spamc spamd renattach p3pmail</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS/SUPPORT</h2>
        <div class="sectioncontent">

<pre>
Please report any bugs to the <strong>p3scan</strong> support mailing list accessable through:
http://sourceforge.net/projects/<strong>p3scan</strong>
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">

<pre>
Jack S. Lai &lt;laitcg at cox dot net&gt;
and contributers (see CONTRIBUTERS file).
</pre>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="ownership.8.html"><span aria-hidden="true">&larr;</span> ownership.8: Compaq ownership tag retriever</a></li>
   <li class="next"><a href="p3scan_readme.8.html">p3scan_readme.8: Readme for the p3scan tool <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
