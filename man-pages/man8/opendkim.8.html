<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>opendkim: Dkim signing and verifying filter for mtas</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Dkim signing and verifying filter for mtas">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="opendkim (8) manual">
  <meta name="twitter:description" content="Dkim signing and verifying filter for mtas">
  <meta name="twitter:image" content="https://www.carta.tech/images/opendkim-opendkim-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/opendkim.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="opendkim (8) manual" />
  <meta property="og:description" content="Dkim signing and verifying filter for mtas" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/opendkim-opendkim-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">opendkim<small> (8)</small></h1>
        <p class="lead">Dkim signing and verifying filter for mtas</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/opendkim.8.html">
      <span itemprop="name">opendkim: Dkim signing and verifying filter for mtas</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/opendkim/">
      <span itemprop="name">opendkim</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/opendkim.8.html">
      <span itemprop="name">opendkim: Dkim signing and verifying filter for mtas</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>opendkim</strong> [-A] [-b modes] [-c canon] [-d domain[,...]] [-D] [-e name] [-f] [-F time] [-k keyfile] [-l] [-L min] [-n] [-o hdrlist] [-p socketspec] [-P pidfile] [-Q] [-r] [-s selector] [-S signalg] [-t testfiles] [-T secs] [-u userid[:group]] [-v] [-V] [-W] [-x configfile]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>opendkim</strong> implements the <strong>DKIM</strong> standard for signing and verifying e-mail messages on a per-domain basis.</p><p><strong>opendkim</strong> uses the <em>milter</em> interface, originally distributed as part of version 8.11 of <a href="../man8/sendmail.8.html"><strong>sendmail</strong>(8)</a>,</strong> to provide DKIM signing and/or verifying service for mail transiting a milter-aware MTA.</p><p>Most, if not all, of the command line options listed below can also be set using a configuration file.  See the <em>-x</em> option for details.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DATA SETS</h2>
        <div class="sectioncontent">
<p>Many of the command line and configuration file parameters will refer to a "dataset" as their values.  This refers to a string that either contains the list of desirable values, or to a file that contains them, or (if enabled at compile time) a database containing the data.</p><p>Some data sets require that the value contain more than one entry.  How this is done depends on which data set type is used.</p><p>Which type is used depends on the format of the specification string. Note that not all of these are necessarily supported for all installations; most of them depend on the availability of a particular third-party library at compile time.</p><p>In particular:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>a)</em></p>
  </dt>
  <dd>
    <p>If the string begins with "file:", then the remainder of the string is presumed to refer to a flat file that contains elements of the data set, one per line.  If a line contains whitespace-separated values, then the line is preusmed to define a key and its corresponding value.  Blank lines are ignored, and the hash ("#") character denotes the start of a comment. If a value contains multiple entries, the entries should be separated by colons.</p>
  </dd>
  <dt>
    <p><em>b)</em></p>
  </dt>
  <dd>
    <p>If the string begins with "refile:", then the remainder of the string is presumed to specify a file that contains a set of patterns, one per line, and their associated values.  The pattern is taken as the start of the line to the first whitespace, and the portion after that whitespace is taken as the value to be used when that pattern is matched.  Patterns are simple wildcard patterns, matching all text except that the asterisk ("*") character is considered a wildcard.  If a value contains multiple entries, the entries should be separated by colons.</p>
  </dd>
  <dt>
    <p><em>c)</em></p>
  </dt>
  <dd>
    <p>If the string begins with "db:" and the program was compiled with Sleepycat DB support, then the remainder of the string is presumed to identify a Sleepycat database containing keys and corresponding values. These may be used only to test for membership in the data set, or for storing keys and corresponding values.  If a value contains multiple entries, the entries should be separated by colons.</p>
  </dd>
  <dt>
    <p><em>d)</em></p>
  </dt>
  <dd>
    <p>If the string begins with "dsn:" and the OpenDKIM library was compiled to support that database type, then the remainder of the string is a Data Store Name describing the type, location parameters and access credentials for an ODBC or SQL database.  The DSN is of the form:</p><p>backend://[user[:pwd]@][port+]host/dbase[/key=value[?...]]</p><p>where <em>backend</em> is the name of a supported backend database mechanism (e.g. "mysql"), <em>user</em> and <em>password</em> are optional login credentials for the database, <em>port</em> and <em>host</em> describe the destination of a TCP connection to connect to that database, <em>dbase</em> is the name of the database to be accessed, and the <em>key=value</em> pairs must specify at least "table", "keycol" and "datacol" values specifying the name of the table, the name of the column to consider as the key, and the name(s) of the column(s) to be considered as the values (separated by commas).  For example (all in one line):</p><p>mysql:://dbuser:dbpass@3306+dbhost/odkim/table=macros</p>
<pre>
         ?keycol=host?datacol=v1,v2
</pre>
<p>defines a MySQL database listening at port 3306 on host "dbhost"; the userid "dbuser" and password "dbpass" should be used to access the database; the database name is "odkim", and the data are in columns "host" (the keys) and "v1" and "v2" (the values) inside table "macros".  This example would thus return two values when a match is found.</p><p>No value within the DSN may contain any of the six punctuation characters (":", "/", "@", "+", "?" and "=") used to separate portions of the DSN from each other.</p>
  </dd>
  <dt>
    <p><em>e)</em></p>
  </dt>
  <dd>
    <p>If the string begins with "ldap:", "ldaps:" or "ldapi:", it is presumed to be a space-separated set of one or more LDAP URLs that identify a set of servers to be queried.  The first one should be a full RFC4516 LDAP URL indicating a base DN template and optional scope, filter and attribute names to use in queries.  When constructing a DN template or filter, the special tokens "$d" and "$D" are replaced with the key being queried and the key broken into components, separated at "." characters, each component preceded by "dc=" and followed by "," (so "example.com" would become "dc=example,dc=com").  If a data set requires multiple values to be returned, the appropriate attribute names should be given in the correct order to satisfy such requests.</p>
  </dd>
  <dt>
    <p><em>f)</em></p>
  </dt>
  <dd>
    <p>If the string begins with "lua:", it is presumed to refer to a file that contains a Lua script to be executed whenever a query is performed.  The key for the query is placed in a global variable called "query", which the called script can then access.  The script may return any number of values as required for the type of query being performed.</p>
  </dd>
  <dt>
    <p><em>g)</em></p>
  </dt>
  <dd>
    <p>If the string begins with "memcache:", it is presumed to refer to a memory cache database provided by <strong>memcached.</strong> The remainder of the string is a comma-separated list of hosts to which query attempts should be made, each optionally followed by ":" and a port number; that list must be followed by a slash ("/") character and a string that will be used to prefix queries send to the cache.  For example:</p><p>memcache:localhost,otherhost/keyname</p><p>This would use either "localhost" or "otherhost" to conduct queries, and all strings sent to the dataset will be prefixed with "keyname:".</p>
  </dd>
  <dt>
    <p><em>h)</em></p>
  </dt>
  <dd>
    <p>If the string contains none of these prefixes but ends with ".db", it is presumed to be a Sleepycat DB as described above (if support for same is compiled in).</p>
  </dd>
  <dt>
    <p><em>i)</em></p>
  </dt>
  <dd>
    <p>If the string contains none of these prefixes but starts with a slash ("/") character, it is presumed to be a flat file as described above.</p>
  </dd>
  <dt>
    <p><em>j)</em></p>
  </dt>
  <dd>
    <p>If the string begins with "csl:", the string is treated as a comma-separated list as described in m) below.</p>
  </dd>
  <dt>
    <p><em>k)</em></p>
  </dt>
  <dd>
    <p>If the string begins with "erlang:", it is presumed to refer to a function called to be made to the specified distributed Erlang node(s). The specification is of the form</p><p>erlang:node@host[,...]:cookie:module:function</p><p>where <em>node[,...]</em> is a list of comma-separated erlang nodes, <em>cookie</em> is the cookie for the known nodes of the distributed Erlang setup, <em>module</em> is the name of the Erlang module where the function to be called resides, <em>function</em> is the name of the Erlang function to be called. For example, (all in one line):</p><p>erlang:mynode@myhost,myothernode@myotherhost:</p>
<pre>
       chocolate:dkim:lookup
</pre>
<p>will join the distributed Erlang setup connecting to either "mynode@myhost" or "myothernode@myotherhost" (connections to nodes are tried in order) using "chocolate" as the cookie, and use the function "dkim:lookup/1" for lookups.</p>
  </dd>
  <dt>
    <p><em>l)</em></p>
  </dt>
  <dd>
    <p>If the string begins with "mdb:", it refers to a directory that contains a memory database, as provided by libmdb from OpenLDAP.</p>
  </dd>
  <dt>
    <p><em>m)</em></p>
  </dt>
  <dd>
    <p>In any other case, the string is presumed to be a comma-separated list. Elements in the list are either simple data elements that are part of the set or, in the case of an entry of the form "x=y", are stored as key-value pairs as described above.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>-A</em></p>
  </dt>
  <dd>
    <p>Automatically re-start on failures.  Use with caution; if the filter fails instantly after it starts, this can cause a tight <a href="../man2/fork.2.html"><strong>fork</strong>(2)</a></em> loop.  This can be mitigated using some values in the configuration file to limit restarting.  See <a href="../man5/opendkim.conf.5.html"><strong>opendkim.conf</strong>(5)</a>.</em></p>
  </dd>
  <dt>
    <p><em>-b modes</em></p>
  </dt>
  <dd>
    <p>Selects operating modes. <em>modes</em> is a concatenation of characters that indicate which mode(s) of operation are desired.  Valid modes are <em>s</em> (signer) and <em>v</em> (verifier).  The default is <em>sv</em> except in test mode (see <em>-t</em> below) in which case the default is <em>v.</em></p>
  </dd>
  <dt>
    <p><em>-c canon</em></p>
  </dt>
  <dd>
    <p>Selects the canonicalization method(s) to be used when signing messages. When verifying, the message's DKIM-Signature: header specifies the canonicalization method.  The recognized values are <em>relaxed</em> and <em>simple</em> as defined by the DKIM specification.  The default is <em>simple.</em> The value may include two different canonicalizations separated by a slash ("/") character, in which case the first will be applied to the headers and the second to the body.</p>
  </dd>
  <dt>
    <p><em>-d dataset</em></p>
  </dt>
  <dd>
    <p>A set of domains whose mail should be signed by this filter.  Mail from other domains will be verified rather than being signed.</p>
  </dd>
  <dt>
    <p><em>-D</em></p>
  </dt>
  <dd>
    <p>Sign subdomains of those listed by the <em>-d</em> option as well as the actual domains.</p>
  </dd>
  <dt>
    <p><em>-e name</em></p>
  </dt>
  <dd>
    <p>Extracts the value of <em>name</em> from the configuration file (if any).</p>
  </dd>
  <dt>
    <p><em>-f</em></p>
  </dt>
  <dd>
    <p>Normally <em>opendkim</em> forks and exits immediately, leaving the service running in the background. This flag suppresses that behaviour so that it runs in the foreground.</p>
  </dd>
  <dt>
    <p><em>-F time</em></p>
  </dt>
  <dd>
    <p>Specifies a fixed time to use when generating signatures.  Ignored unless also used in conjunction with <em>-t</em> (see below).  The time must be expressed in the usual UNIX <em>time_t</em> (seconds since epoch) format.</p>
  </dd>
  <dt>
    <p><em>-k keyfile</em></p>
  </dt>
  <dd>
    <p>Gives the location of a PEM-formatted private key to be used for signing all messages.  Ignored if a configuration file is referenced that defines a KeyTable.</p>
  </dd>
  <dt>
    <p><em>-l</em></p>
  </dt>
  <dd>
    <p>Log via calls to <a href="../man3/syslog.3.html"><strong>syslog</strong>(3)</a></em> any interesting activity.</p>
  </dd>
  <dt>
    <p><em>-L min[%+]</em></p>
  </dt>
  <dd>
    <p>Instructs the verification code to fail messages for which a partial signature was received.  There are three possible formats: <em>min</em> indicating at least <em>min</em> bytes of the message must be signed (or if the message is smaller than <em>min</em> then all of it must be signed); <em>min%</em> requiring that at least <em>min</em> percent of the received message must be signed; and <em>min+</em> meaning there may be no more than <em>min</em> bytes of unsigned data appended to the message for it to be considered valid.</p>
  </dd>
  <dt>
    <p><em>-n</em></p>
  </dt>
  <dd>
    <p>Parse the configuration file and command line arguments, reporting any errors found, and then exit.  The exit value will be 0 if the filter would start up without complaint, or non-zero otherwise.</p>
  </dd>
  <dt>
    <p><em>-o dataset</em></p>
  </dt>
  <dd>
    <p>Specifies a list of headers that should be omitted when generating signatures. If an entry in the list names any header which is mandated by the DKIM specification, the entry is ignored.  A set of headers is listed in the DKIM specification as "SHOULD NOT" be signed; the default list for this parameter contains those headers (Return-Path, Received, Comments, Keywords, Bcc, Resent-Bcc and DKIM-Signature).  To omit no headers, simply use the string "-" (or any string that will match no headers).</p>
  </dd>
  <dt>
    <p><em>-p socketspec</em></p>
  </dt>
  <dd>
    <p>Specifies the socket that should be established by the filter to receive connections from <a href="../man8/sendmail.8.html"><strong>sendmail</strong>(8)</a></em> in order to provide service. <em>socketspec</em> is in one of two forms: <em>local:path</em> which creates a UNIX domain socket at the specified <em>path,</em> or <em>inet:port[@host]</em> or <em>inet6:port[@host]</em> which creates a TCP socket on the specified <em>port</em> using the requested protocol family.  If the <em>host</em> is not given as either a hostname or an IP address, the socket will be listening on all interfaces.  A literal IP address must be enclosed in square brackets.  If neither socket type is specified, <em>local</em> is assumed, meaning the parameter is interpreted as a path at which the socket should be created.  This parameter is mandatory either here or in the configuration file.</p>
  </dd>
  <dt>
    <p><em>-P pidfile</em></p>
  </dt>
  <dd>
    <p>Specifies a file into which the filter should write its process ID at startup.</p>
  </dd>
  <dt>
    <p><em>-Q</em></p>
  </dt>
  <dd>
    <p>Query test mode.  The filter will read two lines from standard input, one containing a database description to be opened and one containing a string of the form "q/n" where "q" is the query to be performed and "n" is the number of fields to be retrieved.</p>
  </dd>
  <dt>
    <p><em>-r</em></p>
  </dt>
  <dd>
    <p>Checks all messages for compliance with RFC5322 header count requirements. Non-compliant messages are rejected.</p>
  </dd>
  <dt>
    <p><em>-s selector</em></p>
  </dt>
  <dd>
    <p>Defines the name of the selector to be used when signing messages. See the <strong>DKIM</strong> specification for details.</p>
  </dd>
  <dt>
    <p><em>-S signalg</em></p>
  </dt>
  <dd>
    <p>Selects the signing algorithm to use when generating signatures. Use 'opendkim -V' to see the list of supported algorithms. The default is <em>rsa-sha256</em> if it is available, otherwise it will be <em>rsa-sha1.</em></p>
  </dd>
  <dt>
    <p><em>-t testfiles</em></p>
  </dt>
  <dd>
    <p>Evaluates (verifies) one or more RFC5322-formatted message found in <em>testfiles</em> and exits.  The value of <em>testfiles</em> should be a comma-separated list of one or more filenames, one of which may be "-" if the message should be read from standard input.</p>
  </dd>
  <dt>
    <p><em>-T secs</em></p>
  </dt>
  <dd>
    <p>Sets the DNS timeout in seconds.  A value of 0 causes an infinite wait. The default is 5.  Ignored if not using an asynchronous resolver package. See also the NOTES section below.</p>
  </dd>
  <dt>
    <p><em>-u userid[:group]</em></p>
  </dt>
  <dd>
    <p>Attempts to be come the specified <em>userid</em> before starting operations.  The process will be assigned all of the groups and primary group ID of the named <em>userid</em> unless an alternate <em>group</em> is specified.  See the FILE PERMISSIONS section for more information.</p>
  </dd>
  <dt>
    <p><em>-v</em></p>
  </dt>
  <dd>
    <p>Increase verbose output during test mode (see <em>-t</em> above).  May be specified more than once to request increasing amounts of output.</p>
  </dd>
  <dt>
    <p><em>-V</em></p>
  </dt>
  <dd>
    <p>Print the version number and supported canonicalization and signature algorithms, and then exit without doing anything else.</p>
  </dd>
  <dt>
    <p><em>-W</em></p>
  </dt>
  <dd>
    <p>If logging is enabled (see <em>-l</em> above), issues very detailed logging about the logic behind the filter's decision to either sign a message or verify it.  The "W" stands for "Why?!" since the logic behind the decision is non-trivial and can be confusing to administrators not familiar with its operation.  A description of how the decision is made can be found in the OPERATION section of this document.  This causes a large increase in the amount of log data generated for each message, so it should be limited to debugging use and not enabled for general operation.</p>
  </dd>
  <dt>
    <p><em>-x configfile</em></p>
  </dt>
  <dd>
    <p>Read the named configuration file.  See the <a href="../man5/opendkim.conf.5.html"><strong>opendkim.conf</strong>(5)</a></em> man page for details.  Values in the configuration file are overridden when their equivalents are provided on the command line until a configuration reload occurs.  The OPERATION section describes how reloads are triggered. The default is to read a configuration file from <em>/etc/opendkim.conf</em> if one exists, or otherwise to apply defaults to all values.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPERATION</h2>
        <div class="sectioncontent">
<p>A message will be verified unless it conforms to the signing criteria, which are: (1) the domain on the From: address (if present) must be listed by the <em>-d</em> command line switch or the <em>Domain</em> configuration file setting, and (2) (a) the client connecting to the MTA must have authenticated, or (b) the client connecting to the MTA must be listed in the file referenced by the <em>InternalHosts</em> configuration file setting (or be in the default list for that option), or (c) the client must be connected to a daemon port named by the <em>MTAs</em> configuration file setting, or (d) the MTA must have set one or more macros matching the criteria set by the <em>MacroList</em> configuration file setting.</p><p>For (a) above, the test is whether or not the MTA macro "{auth_type}" is set and contains any non-empty value.  This means the MTA must pass the value of that macro to the filter before or during the end-of-header (EOH) phase in order for its value to be tested.  Check your MTA's configuration documentation for details.</p><p>For (1) above, other header fields may be selected using the SenderHeaders configuration file setting.  See <a href="../man5/opendkim.conf.5.html"><strong>opendkim.conf</strong>(5)</a></em> for more information.</p><p>When signing a message, a <em>DKIM-Signature:</em> header will be prepended to the message.  The signature is computed using the private key provided.  You must be running a version of <a href="../man8/sendmail.8.html"><strong>sendmail</strong>(8)</a></em> recent enough to be able to do header prepend operations (8.13.0 or later).</p><p>When verifying a message, an <em>Authentication-Results:</em> header will be prepended to indicate the presence of a signature and whether or not it could be validated against the body of the message using the public key advertised by the sender's nameserver.  The value of this header can be used by mail user agents to sort or discard messages that were not signed or could not be verified.</p><p>Upon receiving SIGUSR1, if the filter was started with a configuration file, it will be re-read and the new values used.  Note that any command line overrides provided at startup time will be lost when this is done.  Also, the following configuration file values (and their corresponding command line items, if any) are not reloaded through this process: AutoRestart (-A), AutoRestartCount, AutoRestartRate, Background, MilterDebug, PidFile (-P), POPDBFile, Quarantine (-q), QueryCache, Socket (-p), StrictTestMode, TestPublicKeys, UMask, UserID (-u).  The filter does not automatically check the configuration file for changes and reload.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MTA MACROS</h2>
        <div class="sectioncontent">
<p><strong>opendkim</strong> makes use of three MTA-provided macros, plus any demanded by configuration. The basic three are: "i" (the envelope ID, also known as the job ID or the queue ID), which is used for logging; "daemon_name" (the symbolic name given to the MTA instance that accepted the connection), which is used when performing tests against any "MTAs" setting used; and "auth_type", which is used to determine whether or not the SMTP client authenticated to the MTA. If the MTA does not provide them to <strong>opendkim</strong> then it is not able to apply their corresponding tests or do useful logging. Consult your MTA documentation to determine how to adjust your its configuration if some or all of these are not available.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILE PERMISSIONS</h2>
        <div class="sectioncontent">
<p>When the filter is started as the superuser and the UserID (-u) setting is used, the filter gives up its root privileges by changing to the specified user after the following steps are taken: (1) the configuration file (if any) is loaded; (2) if the KeyFile (-k) setting is used, that key is loaded into memory; (3) all data sets in the configuration file are opened, and those that are based on flat files are also read into memory; and (4) if ChangeRootDirectory is set, the process root is changed to that directory. This means on configuration reload, the filter will not be accessing these files or the configuration file as the superuser (and possibly from a different root), and any key files referenced by the KeyTable will also be accessed by the new user.</p><p>Thus, keys referenced by the KeyTable must always be accessible for read by the unprivileged user.  Also, run-time reloads are not possible if any of the other files will not be readable by the unprivileged user.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">
<p>The following environment variable(s) can be used to adjust the behaviour of this filter:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>DKIM_TMPDIR</em></p>
  </dt>
  <dd>
    <p>The directory to use when creating temporary files.  The default is <em>/tmp.</em></p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>When using DNS timeouts (see the <em>-T</em> option above), be sure not to use a timeout that is larger than the timeout being used for interaction between <em>sendmail</em> and the filter.  Otherwise, the MTA could abort a message while waiting for a reply from the filter, which in turn is still waiting for a DNS reply.</p><p>The POP authentication database is expected to be a Sleepycat DB file (formerly known as a Berkeley DB) in hash format with keys containing the IP address in text form without a terminating NULL.  The values of these records are not checked; only the existence of such records is of interest.  The filter will attempt to establish a shared lock on the database before reading from it, so any programs which write to the database should keep their lock use to a minimum or else this filter will appear to hang while waiting for the lock operation to complete.</p><p>Features that involve specification of IPv4 addresses or CIDR blocks will use the <a href="../man3/inet_addr.3.html"><strong>inet_addr</strong>(3)</a></em> function to parse that information.  Users should be familiar with the way that function handles the non-trivial cases (for example, "192.0.2/24" and "192.0.2.0/24" are not the same thing).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">
<p>Filter exit status codes are selected according to <strong>sysexits</strong>(3).</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">
<p>DKIM is an amalgam of Yahoo!'s <strong>DomainKeys</strong> proposal, and Cisco's <strong>Internet Identified Mail</strong> (IIM) proposal.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>This man page covers version 2.9.2 of <em>opendkim.</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (c) 2005-2008, Sendmail, Inc. and its suppliers.  All rights reserved.</p><p>Copyright (c) 2009-2013, The Trusted Domain Project.  All rights reserved.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO opendkim&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/opendkim.conf.5.html"><strong>opendkim.conf</strong>(5)</a>, <a href="../man8/sendmail.8.html"><strong>sendmail</strong>(8)</a></em></p><p>Sendmail Operations Guide</p><p>RFC5321 - Simple Mail Transfer Protocol</p><p>RFC5322 - Internet Messages</p><p>RFC5451 - Message Header Field for Indicating Message Authentication Status</p><p>RFC6008 - Authentication-Results Registration for Differentiating among Cryptographic Results</p><p>RFC6376 - DomainKeys Identified Mail</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="openais_overview.8.html"><span aria-hidden="true">&larr;</span> openais_overview.8: None</a></li>
   <li class="next"><a href="opendkim-atpszone.8.html">opendkim-atpszone.8: Dkim atps zone file generation tool <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
