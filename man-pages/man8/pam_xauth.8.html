<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pam_xauth - PAM module to forward xauth keys between users</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="${metadescription}">
  
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pam_xauth<small> (8)</small></h1>
        <p class="lead">PAM module to forward xauth keys between users</p>
      </div>

    <ol class="breadcrumb">
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="https://www.carta.tech/man-pages/"><span itemprop="title">Linux Man Pages</span></a>
	</li>
	<li id="breadcrumb_section" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_page" itemprop="child">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man8/"><span itemprop="title">System administration commands</span></a>
	</li>
	<li id="breadcrumb_page" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="active">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man8/pam_xauth.8.html"><span itemprop="title">pam_xauth</span></a>
	</li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p><strong>pam_xauth.so</strong> [debug] [xauthpath=<em>/path/to/xauth</em>] [systemuser=<em>UID</em>] [targetuser=<em>UID</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>The pam_xauth PAM module is designed to forward xauth keys (sometimes referred to as "cookies") between users.</p>
<p class='spacer'>

<p>Without pam_xauth, when xauth is enabled and a user uses the <strong>su</strong>(1) command to assume another user&apos;s privileges, that user is no longer able to access the original user&apos;s X display because the new user does not have the key needed to access the display. pam_xauth solves the problem by forwarding the key from the user running su (the source user) to the user whose identity the source user is assuming (the target user) when the session is created, and destroying the key when the session is torn down.</p>
<p class='spacer'>

<p>This means, for example, that when you run <strong>su</strong>(1) from an xterm session, you will be able to run X programs without explicitly dealing with the <strong>xauth</strong>(1) xauth command or ~/.Xauthority files.</p>
<p class='spacer'>

<p>pam_xauth will only forward keys if xauth can list a key connected to the $DISPLAY environment variable.</p>
<p class='spacer'>

<p>Primitive access control is provided by ~/.xauth/export in the invoking user&apos;s home directory and ~/.xauth/import in the target user&apos;s home directory.</p>
<p class='spacer'>

<p>If a user has a ~/.xauth/import file, the user will only receive cookies from users listed in the file. If there is no ~/.xauth/import file, the user will accept cookies from any other user.</p>
<p class='spacer'>

<p>If a user has a .xauth/export file, the user will only forward cookies to users listed in the file. If there is no ~/.xauth/export file, and the invoking user is not <strong>root</strong>, the user will forward cookies to any other user. If there is no ~/.xauth/export file, and the invoking user is <strong>root</strong>, the user will <em>not</em> forward cookies to other users.</p>
<p class='spacer'>

<p>Both the import and export files support wildcards (such as <em>*</em>). Both the import and export files can be empty, signifying that no users are allowed.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p><strong>debug</strong> Print debug information.</p>
<p class='spacer'>

<p><strong>xauthpath=</strong><strong><em>/path/to/xauth</em></strong> Specify the path the xauth program (it is expected in /usr/X11R6/bin/xauth, /usr/bin/xauth, or /usr/bin/X11/xauth by default).</p>
<p class='spacer'>

<p><strong>systemuser=</strong><strong><em>UID</em></strong> Specify the highest UID which will be assumed to belong to a "system" user. pam_xauth will refuse to forward credentials to users with UID less than or equal to this number, except for root and the "targetuser", if specified.</p>
<p class='spacer'>

<p><strong>targetuser=</strong><strong><em>UID</em></strong> Specify a single target UID which is exempt from the systemuser check.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MODULE TYPES PROVIDED</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>Only the <strong>session</strong> type is provided.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUES</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>PAM_BUF_ERR Memory buffer error.</p>
<p class='spacer'>

<p>PAM_PERM_DENIED Permission denied by import/export file.</p>
<p class='spacer'>

<p>PAM_SESSION_ERR Cannot determine user name, UID or access users home directory.</p>
<p class='spacer'>

<p>PAM_SUCCESS Success.</p>
<p class='spacer'>

<p>PAM_USER_UNKNOWN User not known.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>Add the following line to /etc/pam.d/su to forward xauth keys between users when calling su:</p>
<p class='spacer'>

<pre>session  optional  pam_xauth.so
</pre>

<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">IMPLEMENTATION DETAILS</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>pam_xauth will work <em>only</em> if it is used from a setuid application in which the <strong>getuid</strong>() call returns the id of the user running the application, and for which PAM can supply the name of the account that the user is attempting to assume. The typical application of this type is <strong>su</strong>(1). The application must call both <strong>pam_open_session</strong>() and <strong>pam_close_session</strong>() with the ruid set to the uid of the calling user and the euid set to root, and must have provided as the PAM_USER item the name of the target user.</p>
<p class='spacer'>

<p>pam_xauth calls <strong>xauth</strong>(1) as the source user to extract the key for $DISPLAY, then calls xauth as the target user to merge the key into the a temporary database and later remove the database.</p>
<p class='spacer'>

<p>pam_xauth cannot be told to not remove the keys when the session is closed.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>~/.xauth/import XXX</p>
<p class='spacer'>

<p>~/.xauth/export XXX</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p><strong>pam.conf</strong>(5), <strong>pam.d</strong>(5), <strong>pam</strong>(7)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>pam_xauth was written by Nalin Dahyabhai &lt;nalin@redhat.com&gt;, based on original version by Michael K. Johnson &lt;johnsonm@redhat.com&gt;.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
  <li class="previous"><a href="pam_wheel.8.html"><span aria-hidden="true">&larr;</span> pam_wheel.8: Only permit root access to members of group wheel</a></li><li class="next"><a href="pivot_root.8.html">pivot_root.8: change the root filesystem <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>
  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
