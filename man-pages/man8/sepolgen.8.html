<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>sepolgen - Generate an initial SELinux policy module template.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Generate an initial selinux policy module template.">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">sepolgen<small> (8)</small></h1>
        <p class="lead">Generate an initial selinux policy module template.</p>
      </div>

    <ol class="breadcrumb">
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="/"><span itemprop="title">Carta.tech</span></a>
	</li>
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="https://www.carta.tech/man-pages/"><span itemprop="title">man-pages</span></a>
	</li>
	<li id="breadcrumb_section" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_page" itemprop="child">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man8/"><span itemprop="title">System administration commands</span></a>
	</li>
	<li id="breadcrumb_page" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="active">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man8/sepolgen.8.html"><span itemprop="title">sepolgen</span></a>
	</li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>Common options</p>
<p class='spacer'>

<p><strong>sepolicy generate [-h ] [-p PATH]</strong></p>
<p class='spacer'>

<p class='spacer'>

<p>Confined Applications</p>
<p class='spacer'>

<p class='spacer'>

<p><strong>sepolicy generate --application [-n NAME] command [-w WRITE_PATH ]</strong></p>
<p class='spacer'>

<p><strong>sepolicy generate --cgi [-n NAME] command [-w WRITE_PATH ]</strong></p>
<p class='spacer'>

<p><strong>sepolicy generate --dbus [-n NAME] command [-w WRITE_PATH ]</strong></p>
<p class='spacer'>

<p><strong>sepolicy generate --inetd [-n NAME] command [-w WRITE_PATH ]</strong></p>
<p class='spacer'>

<p><strong>sepolicy generate --init [-n NAME] command [-w WRITE_PATH ]</strong></p>
<p class='spacer'>

<p>Confined Users</p>
<p class='spacer'>

<p class='spacer'>

<p><strong>sepolicy generate --admin_user [-r TRANSITION_ROLE] -n NAME</strong></p>
<p class='spacer'>

<p><strong>sepolicy generate --confined_admin -n NAME [-a ADMIN_DOMAIN] [-u USER] [-n NAME] [-w WRITE_PATH]</strong></p>
<p class='spacer'>

<p><strong>sepolicy generate --desktop_user -n NAME [-w WRITE_PATH]</strong></p>
<p class='spacer'>

<p><strong>sepolicy generate --term_user -n NAME [-w WRITE_PATH]</strong></p>
<p class='spacer'>

<p><strong>sepolicy generate --x_user -n NAME [-w WRITE_PATH]</strong></p>
<p class='spacer'>

<p>Miscellaneous Policy</p>
<p class='spacer'>

<p class='spacer'>

<p><strong>sepolicy generate --customize -d DOMAIN -n NAME [-a ADMIN_DOMAIN]</strong></p>
<p class='spacer'>

<p><strong>sepolicy generate --newtype -t type -n NAME</strong></p>
<p class='spacer'>

<p><strong>sepolicy generate --sandbox -n NAME</strong></p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p>Use <strong>sepolicy generate</strong> to generate an SELinux policy Module.</p>
<p class='spacer'>

<p class='spacer'>

<p><strong>sepolicy generate</strong> will create 5 files.</p>
<p class='spacer'>

<p>When specifying a <strong>confined application</strong> you must specify a path. <strong>sepolicy generate</strong> will use the rpm payload of the application along with <strong>nm -D APPLICATION</strong> to help it generate types and policy rules for your policy files.</p>
<p class='spacer'>

<p><strong>Type Enforcing File NAME.te</strong></p>
<p class='spacer'>

<p>This file can be used to define all the types rules for a particular domain.</p>
<p class='spacer'>

<p><em>Note:</em> Policy generated by <strong>sepolicy generate</strong> will automatically add a permissive DOMAIN to your te file.  When you are satisfied that your policy works, you need to remove the permissive line from the te file to run your domain in enforcing mode.</p>
<p class='spacer'>

<p><strong>Interface File NAME.if</strong></p>
<p class='spacer'>

<p>This file defines the interfaces for the types generated in the te file, which can be used by other policy domains.</p>
<p class='spacer'>

<p><strong>File Context NAME.fc</strong></p>
<p class='spacer'>

<p>This file defines the default file context for the system, it takes the file types created in the te file and associates file paths to the types.  Tools like restorecon and RPM will use these paths to put down labels.</p>
<p class='spacer'>

<p><strong>RPM Spec File NAME_selinux.spec</strong></p>
<p class='spacer'>

<p>This file is an RPM SPEC file that can be used to install the SELinux policy on to machines and setup the labeling. The spec file also installs the interface file and a man page describing the policy.  You can use <strong>sepolicy manpage -d NAME</strong> to generate the man page.</p>
<p class='spacer'>

<p><strong>Shell File NAME.sh</strong></p>
<p class='spacer'>

<p>This is a helper shell script to compile, install and fix the labeling on your test system.  It will also generate a man page based on the installed policy, and compile and build an RPM suitable to be installed on other machines</p>
<p class='spacer'>

<p>If a generate is possible, this tool will print out all generate paths from the source domain to the target domain</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

  <dl class='dl-vertical'>
    <dt><em>-h, --help</em></dt>
    <dd>
  <p>Display help message</p>
    </dd>
    <dt><em>-d, --domain</em></dt>
    <dd>
  <p>Enter domain type(s) which you will be extending</p>
    </dd>
    <dt><em>-n, --name</em></dt>
    <dd>
  <p>Specify alternate name of policy. The policy will default to the executable or name specified</p>
    </dd>
    <dt><em>-p, --path</em></dt>
    <dd>
  <p>Specify the directory to store the created policy files. (Default to current working directory ) optional arguments:</p>
    </dd>
    <dt><em>-r, --role</em></dt>
    <dd>
  <p>Enter role(s) to which this admin user will transition.</p>
    </dd>
    <dt><em>-t, --type</em></dt>
    <dd>
  <p>Enter type(s) for which you will generate new definition and rule(s)</p>
    </dd>
    <dt><em>-u, --user</em></dt>
    <dd>
  <p>SELinux user(s) which will transition to this domain</p>
    </dd>
    <dt><em>-w, --writepath</em></dt>
    <dd>
  <p>Path(s) which the confined processes need to write</p>
    </dd>
    <dt><em>-a, --admin</em></dt>
    <dd>
  <p>Domain(s) which the confined admin will administrate</p>
    </dd>
    <dt><em>--admin_user</em></dt>
    <dd>
  <p>Generate Policy for Administrator Login User Role</p>
    </dd>
    <dt><em>--application</em></dt>
    <dd>
  <p>Generate Policy for User Application</p>
    </dd>
    <dt><em>--cgi</em></dt>
    <dd>
  <p>Generate Policy for Web Application/Script (CGI)</p>
    </dd>
    <dt><em>--confined_admin</em></dt>
    <dd>
  <p>Generate Policy for Confined Root Administrator Role</p>
    </dd>
    <dt><em>--customize</em></dt>
    <dd>
  <p>Generate Policy for Existing Domain Type</p>
    </dd>
    <dt><em>--dbus</em></dt>
    <dd>
  <p>Generate Policy for DBUS System Daemon</p>
    </dd>
    <dt><em>--desktop_user</em></dt>
    <dd>
  <p>Generate Policy for Desktop Login User Role</p>
    </dd>
    <dt><em>--inetd</em></dt>
    <dd>
  <p>Generate Policy for Internet Services Daemon</p>
    </dd>
    <dt><em>--init</em></dt>
    <dd>
  <p>Generate Policy for Standard Init Daemon (Default)</p>
    </dd>
    <dt><em>--newtype</em></dt>
    <dd>
  <p>Generate new policy for new types to add to an existing policy.</p>
    </dd>
    <dt><em>--sandbox</em></dt>
    <dd>
  <p>Generate Policy for Sandbox</p>
    </dd>
    <dt><em>--term_user</em></dt>
    <dd>
  <p>Generate Policy for Minimal Terminal Login User Role</p>
    </dd>
    <dt><em>--x_user</em></dt>
    <dd>
  <p>Generate Policy for Minimal X Windows Login User Role</p>
<p class='spacer'>

    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<p><strong>&gt; sepolicy generate --init /usr/sbin/rwhod</strong></p>
<p class='spacer'>

<p>Generating Policy for /usr/sbin/rwhod named rwhod</p>
<p class='spacer'>

<p>Created the following files:</p>
<p class='spacer'>

<p>rwhod.te # Type Enforcement file</p>
<p class='spacer'>

<p>rwhod.if # Interface file</p>
<p class='spacer'>

<p>rwhod.fc # File Contexts file</p>
<p class='spacer'>

<p>rwhod_selinux.spec # Spec file</p>
<p class='spacer'>

<p>rwhod.sh # Setup Script</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">

<p>This man page was written by Daniel Walsh &lt;dwalsh@redhat.com&gt;</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<a href="../man8/sepolicy.8.html"><strong>sepolicy</strong>(8)</a>, <a href="../man8/selinux.8.html"><strong>selinux</strong>(8)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="semodule_unpackage.8.html"><span aria-hidden="true">&larr;</span> semodule_unpackage.8: Extract policy module and file context file from an SELinux policy module unpackage.</a></li>
   <li class="next"><a href="sepolicy-booleans.8.html">sepolicy-booleans.8: Query SELinux Policy to see description of booleans <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
