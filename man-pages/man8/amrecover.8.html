<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>amrecover: Amanda index database browser</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Amanda index database browser">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="amrecover (8) manual">
  <meta name="twitter:description" content="Amanda index database browser">
  <meta name="twitter:image" content="https://www.carta.tech/images/amanda-client-amrecover-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/amrecover.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="amrecover (8) manual" />
  <meta property="og:description" content="Amanda index database browser" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/amanda-client-amrecover-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">amrecover<small> (8)</small></h1>
        <p class="lead">Amanda index database browser</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/amrecover.8.html">
      <span itemprop="name">amrecover: Amanda index database browser</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/amanda-client/">
      <span itemprop="name">amanda-client</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/amrecover.8.html">
      <span itemprop="name">amrecover: Amanda index database browser</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>amrecover</strong> [-s&nbsp;<em>index-server</em>] [-t&nbsp;<em>tape-server</em>] [-d&nbsp;<em>tape-device</em>] [-h&nbsp;<em>hostname</em>] [<strong>-o</strong>&nbsp;<em>configoption</em>...] [-C&nbsp;<em>config</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>Amrecover</strong> browses the database of Amanda index files to determine which tapes contain files to recover. Furthermore, it is able to recover files.</p><p>In order to restore files in place, you must invoke <strong>amrecover</strong> from the root of the backed up filesystem, or use <strong>lcd</strong> to move into that directory, otherwise a directory tree that resembles the backed up filesystem will be created in the current directory. See the examples below for details.</p><p>Amrecover will read the <strong>amanda-client.conf</strong> file and the <em>config</em><strong>/amanda-client.conf</strong> file. If no configuration name is supplied on the command line, Amrecover will try the compiled-in default configuration ,usually <strong>DailySet1</strong>.</p><p>See the <a href="../man8/amanda.8.html"><strong>amanda</strong>(8)</a> man page for more details about Amanda.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p><strong>Note</strong></p><p>The Default values are those set at compile-time. Use <strong>amrestore</strong> to recover client-encrypted or client-custom-compressed tapes.</p><p><strong>[ -C ] config</strong></p><p>Amanda configuration.</p><p><strong>-s index-server</strong></p><p>Host that runs the index daemon.</p><p><strong>-t tape-server</strong></p><p>Host that runs the tape server daemon.</p><p><strong>-d tape-device</strong></p><p>Tape device to use on the tape server host.</p><p><strong>-h hostname</strong></p><p>Hostname to begin restoring; defaults to the system&apos;s hostname.</p><p><strong>-o</strong> <em>clientconfigoption</em></p><p>See the "<strong>CONFIGURATION OVERRIDE</strong>" section in <a href="../man8/amanda.8.html"><strong>amanda</strong>(8)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTH</h2>
        <div class="sectioncontent">
<p>The default <strong>auth</strong> is &apos;BSDTCP&apos;, you can set a different auth in the <strong>amanda-client.conf</strong> file or by specifying the &apos;-oauth=bsd&apos; command line argument.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMMANDS</h2>
        <div class="sectioncontent">
<p><strong>Amrecover</strong> connects to the index server and then presents a command line prompt. Usage is similar to an ftp client. The GNU readline library is used to provide command line history and editing if it was built in to <strong>amrecover</strong>.</p><p>The purpose of browsing the database is to build up a <em>restore list</em> of files to be extracted from the backup system. The following commands are available:</p><p><strong>sethost hostname</strong></p><p>Specifies which host to look at backup files for (default: the local host).</p><p><strong>setdate YYYY-MM-DD-HH-MM[-SS] | YYYY-MM-DD</strong></p><p>Set the restore time (default: now). File listing commands only return information on backup images for this day, for the day before with the next lower dump level, and so on, until the most recent level 0 backup on or before the specified date is encountered.</p><p>For example, if:</p>
<pre>
1996-07-01 was a level 0 backup
1996-07-02 through 1996-07-05 were level 1 backups
1996-07-06 through 1997-07-08 were level 2 backups
</pre>
<p>then the command <strong>setdate 1997-07-08-00</strong> would yield files from the following days:</p>
<pre>
1997-07-08 (the latest level 2 backup)
1997-07-05 (the latest level 1 backup)
1997-07-01 (the latest level 0 backup)
</pre>
<p>Only the most recent version of a file will be presented.</p><p>The following abbreviated date specifications are accepted:</p><p><strong>--MM-DD</strong></p><p>dates in the current year</p><p><strong>---DD</strong></p><p>dates in the current month of the current year</p><p><strong>setdisk</strong> <em>diskname</em> [<em>mountpoint</em>]</p><p>Specifies which disk to consider (default: the disk holding the working directory where <strong>amrecover</strong> is started). It can only be set after the host is set with <strong>sethost</strong>. <em>Diskname</em> is the device name specified in the <em>amanda.conf</em> or <a href="../man5/disklist.5.html"><strong>disklist</strong>(5)</a>. The disk must be local to the host. If <em>mountpoint</em> is not specified, all pathnames will be relative to the (unknown) mount point instead of full pathnames.</p><p><strong>listhost</strong> [<em>diskdevice</em>]</p><p>List all <strong>host</strong></p><p><strong>listdisk</strong> [<em>diskdevice</em>]</p><p>List all <strong>diskname</strong></p><p><strong>listproperty</strong></p><p>List all <strong>property</strong></p><p><strong>setproperty</strong> [<strong>append</strong>] [<strong>priority</strong>] <em>name</em> [<em>value</em> ...]</p><p>Set the property <em>name</em> to the value <em>value</em>. The <strong>append</strong> keyword appends the <em>value</em> to the values already set for this property. Without <em>value</em>, the property is unset. The <strong>priority</strong> keyword is unused, it is present for ease of copy/paste from application definition.</p><p><strong>setdevice</strong> [[-h <em>tape-server</em>] <em>tapedev</em>]</p><p>Specifies the host to use as the tape server, and which of its tape devices to use. If the server is omitted, the server name reverts to the configure-time default. If the tape device is omitted, the default is used.</p><p>If you want amrecover to use your changer, the <em>tapedev</em> must be equal to the <strong>amrecover-changer</strong> setting on the server.</p><p>Since device names contain colons, you must always specify the hostname.</p>
<pre>
settape 192.168.0.10:file:/file1
</pre>
<p>You can change the tape device when amrecover ask you to load the tape:</p>
<pre>
Load tape DMP014 now
Continue? [Y/n/t]: t
Tape device: server2:/dev/nst2
Continue? [Y/n/t]: Y
Using tape /dev/nst2 from server server2.
</pre>
<p><strong>setmode</strong> <em>mode</em></p><p>Set the extraction mode for Samba shares. If <em>mode</em> is <strong>smb</strong>, shares are sent to the Samba server to be restored back onto the PC. If <em>mode</em> is <strong>tar</strong>, they are extracted on the local machine the same way tar volumes are extracted.</p><p><strong>settranslate</strong> [<strong>on</strong>|<strong>off</strong>]</p><p>Default: on. Translate escaped octal value (&apos;&#92;000&apos;) in the index file to their corespondig characters, it improve the interface if amrecover is run in the same charset as the filename. Set it to <strong>off</strong> if the charset of some filename is not compatible with the amrecover charset.</p><p><strong>mode</strong></p><p>Displays the extracting mode for Samba shares.</p><p><strong>history</strong></p><p>Show the backup history of the current host and disk. Dates, levels, tapes and file position on tape of each backup are displayed.</p><p><strong>pwd</strong></p><p>Display the name of the current backup working directory.</p><p><strong>cd</strong> <em>dir</em></p><p>Change the backup working directory to <em>dir.</em> If the mount point was specified with <strong>setdisk</strong>, this can be a full pathname or it can be relative to the current backup working directory. If the mount point was not specified, paths are relative to the mount point if they start with "/", otherwise they are relative to the current backup working directory. The <em>dir</em> can be a shell style wildcards.</p><p><strong>cdx</strong> <em>dir</em></p><p>Like the <strong>cd</strong> command but allow regular expression.</p><p><strong>lpwd</strong></p><p>Display the <strong>amrecover</strong> working directory. Files will be restored under this directory, relative to the backed up filesystem.</p><p><strong>lcd</strong> <em>path</em></p><p>Change the <strong>amrecover</strong> working directory to <em>path</em>.</p><p><strong>ls</strong></p><p>List the contents of the current backup working directory. See the description of the <strong>setdate</strong> command for how the view of the directory is built up. The backup date is shown for each file.</p><p><strong>add</strong> <em>item1 item2 ...</em></p><p>Add the specified files or directories to the restore list. Each item may have shell style wildcards.</p><p><strong>addx</strong> <em>item1 item2 ...</em></p><p>Add the specified files or directories to the restore list. Each item may be a regular expression.</p><p><strong>delete</strong> <em>item1 item2 ...</em></p><p>Delete the specified files or directories from the restore list. Each item may have shell style wildcards.</p><p><strong>deletex</strong> <em>item1 item2 ...</em></p><p>Delete the specified files or directories from the restore list. Each item may be a regular expression.</p><p><strong>list</strong> <em>file</em></p><p>Display the contents of the restore list. If a file name is specified, the restore list is written to that file. This can be used to manually extract the files from the Amanda tapes with <strong>amrestore</strong>.</p><p><strong>clear</strong></p><p>Clear the restore list.</p><p><strong>quit</strong></p><p>Close the connection to the index server and exit.</p><p><strong>exit</strong></p><p>Close the connection to the index server and exit.</p><p><strong>extract</strong></p><p>Start the extract sequence (see the examples below). Make sure the local working directory is the root of the backed up filesystem, or another directory that will behave like that. Use <strong>lpwd</strong> to display the local working directory, and <strong>lcd</strong> to change it.</p><p><strong>help</strong></p><p>Display a brief list of these commands.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>The following shows the recovery of an old <em>syslog</em> file.</p>
<pre>
# cd /var/log
# ls -l syslog.7
syslog.7: No such file or directory
# amrecover MyConfig
AMRECOVER Version 2.4.2. Contacting server on oops ...
220 oops Amanda index server (2.4.2) ready.
Setting restore date to today (1997-12-09)
200 Working date set to 1997-12-09.
200 Config set to MyConfig.
200 Dump host set to this-host.some.org.
$CWD &apos;/var/log&apos; is on disk &apos;/var&apos; mounted at &apos;/var&apos;.
200 Disk set to /var.
/var/log
WARNING: not on root of selected filesystem, check man-page!
amrecover&gt; ls
1997-12-09 daemon.log
1997-12-09 syslog
1997-12-08 authlog
1997-12-08 sysidconfig.log
1997-12-08 syslog.0
1997-12-08 syslog.1
1997-12-08 syslog.2
1997-12-08 syslog.3
1997-12-08 syslog.4
1997-12-08 syslog.5
1997-12-08 syslog.6
1997-12-08 syslog.7
amrecover&gt; add syslog.7
Added /log/syslog.7
amrecover&gt; lpwd
/var/log
amrecover&gt; lcd ..
/var
amrecover&gt; extract

Extracting files using tape drive /dev/nst0 on host 192.168.0.10

The following tapes are needed: DMP014

Restoring files into directory /var
Continue? [Y/n]: y

Load tape DMP014 now
Continue? [Y/n/t]: y
set owner/mode for &apos;.&apos;? [yn] n
amrecover&gt; quit
200 Good bye.
# ls -l syslog.7
total 26
-rw-r--r--   1 root     other      12678 Oct 14 16:36 syslog.7
</pre>
<p>If you do not want to overwrite existing files, create a subdirectory to run <strong>amrecover</strong> from and then move the restored files afterward.</p>
<pre>
# cd /var
# (umask 077 ; mkdir .restore)
# cd .restore
# amrecover
AMRECOVER Version 2.4.2. Contacting server on oops ...
...
amrecover&gt; cd log
/var/log
amrecover&gt; ls
...
amrecover&gt; add syslog.7
Added /log/syslog.7
amrecover&gt; lpwd
/var/.restore
amrecover&gt; extract

Extracting files using tape drive /dev/nst0 on host 192.168.0.10
...
amrecover&gt; quit
200 Good bye.
# mv -i log/syslog.7 ../log/syslog.7-restored
# cd ..
# rm -fr .restore
</pre>
<p>If you need to run <strong>amrestore</strong> by hand instead of letting <strong>amrecover</strong> control it, use the <strong>list</strong> command after browsing to display the needed tapes.</p>
<pre>
# cd /var/log
# amrecover
AMRECOVER Version 2.4.2. Contacting server on oops ...
...
amrecover&gt; ls
...
amrecover&gt; add syslog syslog.6 syslog.7
Added /log/syslog
Added /log/syslog.6
Added /log/syslog.7
amrecover&gt; list
TAPE DMP014 LEVEL 0 DATE 1997-12-08
        /log/syslog.7
        /log/syslog.6
TAPE DMP015 LEVEL 1 DATE 1997-12-09
        /log/syslog
amrecover&gt; quit
</pre>
<p>The <strong>history</strong> command shows each tape that has a backup of the current disk along with the date of the backup, the level, the tape label and the file position on the tape. All active tapes are listed, not just back to the most recent full dump.</p><p>Tape file position zero is a label. The first backup image is in file position one.</p>
<pre>
# cd /var/log
# amrecover
AMRECOVER Version 2.4.2. Contacting server on oops ...
...
amrecover&gt; history
200- Dump history for config "MyConfig" host "this-host.some.org" disk "/var"
201- 1997-12-09 1 DMP015 9
201- 1997-12-08 1 DMP014 11
201- 1997-12-07 0 DMP013 22
201- 1997-12-06 1 DMP012 16
201- 1997-12-05 1 DMP011 9
201- 1997-12-04 0 DMP010 11
201- 1997-12-03 1 DMP009 7
201- 1997-12-02 1 DMP008 7
201- 1997-12-01 1 DMP007 9
201- 1997-11-30 1 DMP006 6
...
amrecover&gt; quit
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">
<p><strong>PAGER</strong> The <strong>ls</strong> and <strong>list</strong> commands will use $PAGER to display the file lists. Defaults to <em>more</em> if PAGER is not set.</p><p><strong>AMANDA_SERVER</strong> If set, $AMANDA_SERVER will be used as index-server. The value will take precedence over the compiled default, but will be overridden by the -s switch.</p><p><strong>AMANDA_TAPE_SERVER</strong> If set, $AMANDA_TAPE_SERVER will be used as tape-server. The value will take precedence over the compiled default, but will be overridden by the -t switch.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO amrecover&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/amanda.8.html"><strong>amanda</strong>(8)</a>, <a href="../man5/amanda-client.conf.5.html"><strong>amanda-client.conf</strong>(5)</a>, <a href="../man8/amrestore.8.html"><strong>amrestore</strong>(8)</a>, <a href="../man8/amfetchdump.8.html"><strong>amfetchdump</strong>(8)</a>, <strong>readline</strong>(3)</p><p>The Amanda Wiki: : http://wiki.zmanda.com/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p><strong>Alan M. McIvor</strong> &lt;alan@kauri.auck.irl.cri.nz&gt;</p><p><strong>Stefan G. Weichinger</strong> &lt;sgw@amanda.org&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="amraw.8.html"><span aria-hidden="true">&larr;</span> amraw.8: Amanda application open and read data</a></li>
   <li class="next"><a href="amreport.8.html">amreport.8: Generate a formatted output of statistics for an amanda run <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
