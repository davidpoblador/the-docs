<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>multilog: Reads a sequence of lines from stdin and appends selected lines to any number of logs.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Reads a sequence of lines from stdin and appends selected lines to any number of logs.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="multilog (8) manual">
  <meta name="twitter:description" content="Reads a sequence of lines from stdin and appends selected lines to any number of logs.">
  <meta name="twitter:image" content="https://www.carta.tech/images/daemontools-multilog-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/multilog.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="multilog (8) manual" />
  <meta property="og:description" content="Reads a sequence of lines from stdin and appends selected lines to any number of logs." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/daemontools-multilog-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">multilog<small> (8)</small></h1>
        <p class="lead">Reads a sequence of lines from stdin and appends selected lines to any number of logs.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/multilog.8.html">
      <span itemprop="name">multilog: Reads a sequence of lines from stdin and appends selected lines to any number of logs.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/daemontools/">
      <span itemprop="name">daemontools</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/multilog.8.html">
      <span itemprop="name">multilog: Reads a sequence of lines from stdin and appends selected lines to any number of logs.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>multilog</strong> <em>script</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><em>script</em> consists of any number of arguments. Each argument specifies one action. The actions are carried out in order for each line of input. Note that actions may contain shell metacharacters that need to be quoted when <strong>multilog</strong> is run from a shell.</p><p><strong>multilog</strong> exits 0 when it sees the end of stdin. If stdin has a partial final line then <strong>multilog</strong> inserts a final newline.</p><p><strong>multilog</strong> writes a message to stderr and exits 111, without reading any input, if it runs out of memory or if another <strong>multilog</strong> process is writing to one of the same automatically rotated logs.</p><p>If <strong>multilog</strong> has trouble writing to disk after it starts reading input, it writes a message to stderr, pauses, and tries again, without losing any data. Note that this may block any program feeding input to <strong>multilog</strong>.</p><p>If <strong>multilog</strong> receives a TERM signal, it will read and process data until the next newline, and then exit, leaving stdin at the first byte of data it has not processed.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SELECTING LINES</h2>
        <div class="sectioncontent">
<p>Each line is initially selected. The action</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-</strong><em>pattern</em></p>
  </dt>
  <dd>
    <p>deselects the line if <em>pattern</em> matches the line. The action</p>
  </dd>
  <dt>
    <p><strong>+</strong><em>pattern</em></p>
  </dt>
  <dd>
    <p>selects the line if <em>pattern</em> matches the line.</p>
  </dd>

</dl>
<p><em>pattern</em> is a string of stars and non-stars. It matches any concatenation of strings matched by all the stars and non-stars in the same order. A non-star matches itself. A star before the end of <em>pattern</em> matches any string that does not include the next character in <em>pattern</em>. A star at the end of <em>pattern</em> matches any string.</p><p>For example, the action</p>
<pre>
  +hello
</pre>
<p>selects hello. It does not select hello world.</p><p>The action</p>
<pre>
  -named[*]: Cleaned cache *
</pre>
<p>deselects named[135]: Cleaned cache of 3121 RRs. The first star matches any string that does not include a right bracket.</p><p>The action</p>
<pre>
  -*
</pre>
<p>deselects every line.</p><p>To save memory, <strong>multilog</strong> actually checks pattern against only the first 1000 characters of each line.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ALERTS</h2>
        <div class="sectioncontent">
<p>The action</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>e</strong></p>
  </dt>
  <dd>
    <p>prints (the first 200 bytes of) each selected line to stderr.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">STATUS FILES</h2>
        <div class="sectioncontent">
<p>The action</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>=</strong><em>file</em></p>
  </dt>
  <dd>
    <p>replaces the contents of <em>file</em> with (the first 1000 bytes of) each selected line, padded with newlines to 1001 bytes. There is no protection of <em>file</em> against power outages.</p><p>For example, the sequence of actions</p>
<pre>
     -*
     +STAT*
     =log/status
</pre>
<p>maintains log/status as a copy of the most recent line starting with STAT.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TIMESTAMPING</h2>
        <div class="sectioncontent">
<p>The action</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>t</strong></p>
  </dt>
  <dd>
    <p>inserts an @, a precise timestamp, and a space in front of each line, using the same format as <a href="../man8/tai64n.8.html"><strong>tai64n</strong>(8)</a>. This is required to be the first action.</p>
  </dd>

</dl>
<p>Patterns apply to the line after the timestamp is inserted. For example, if</p>
<pre>
  multilog t '-*' '+* fatal: *' ./main
</pre>
<p>reads the line</p>
<pre>
  fatal: out of memory
</pre>
<p>then it will log a line such as</p>
<pre>
  @400000003b4a39c23294b13c fatal: out of memory
</pre>
<p>with the first * matching the timestamp.</p><p>You can use <a href="../man8/tai64nlocal.8.html"><strong>tai64nlocal</strong>(8)</a> to convert these timestamps to human-readable form.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTOMATICALLY ROTATED LOGS</h2>
        <div class="sectioncontent">
<p>If <em>dir</em> starts with a dot or slash then the action</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>dir</em></p>
  </dt>
  <dd>
    <p>appends each selected line to a log named <em>dir</em>. If <em>dir</em> does not exist, <strong>multilog</strong> creates it.</p><p>Do not attempt to write to one log from two simultaneous <strong>multilog</strong> processes, or two actions in one process.</p><p>The log format is as follows. <em>dir</em> is a directory containing some number of old log files, a log file named <em>current</em>, and other files for <strong>multilog</strong> to keep track of its actions. Each old log file has a name beginning with @, continuing with a precise timestamp showing when the file was finished, and ending with one of the following codes:</p>
  </dd>
  <dt>
    <p><strong>.s</strong></p>
  </dt>
  <dd>
    <p>This file is completely processed and safely written to disk.</p>
  </dd>
  <dt>
    <p><strong>.u</strong></p>
  </dt>
  <dd>
    <p>This file was being created at the moment of an outage. It may have been truncated and has not been processed.</p><p>Beware that NFS, async filesystems, and softupdates filesystems may discard files that were not safely written to disk before an outage.</p><p>While <strong>multilog</strong> is running, <em>current</em> has mode 644. If <strong>multilog</strong> sees the end of stdin, it writes <em>current</em> safely to disk, and sets the mode of <em>current</em> to 744. When it restarts, it sets the mode of <em>current</em> back to 644 and continues writing new lines.</p><p>When <strong>multilog</strong> decides that <em>current</em> is big enough, it writes <em>current</em> safely to disk, sets the mode of <em>current</em> to 744, and renames <em>current</em> as an old log file. The action</p>
  </dd>
  <dt>
    <p><strong>s</strong><em>size</em></p>
  </dt>
  <dd>
    <p>sets the maximum file size for subsequent <em>dir</em> actions. <strong>multilog</strong> will decide that <em>current</em> is big enough if <em>current</em> has <em>size</em> bytes. (<strong>multilog</strong> will also decide that <em>current</em> is big enough if it sees a newline within 2000 bytes of the maximum file size; it tries to finish log files at line boundaries.) <em>size</em> must be between 4096 and 16777215. The default maximum file size is 99999.</p><p>In versions 0.75 and above: If <strong>multilog</strong> receives an ALRM signal, it immediately decides that <em>current</em> is big enough, if <em>current</em> is nonempty. The action</p>
  </dd>
  <dt>
    <p><strong>n</strong><em>num</em></p>
  </dt>
  <dd>
    <p>sets the number of log files for subsequent <em>dir</em> actions. After renaming <em>current</em>, if <strong>multilog</strong> sees <em>num</em> or more old log files, it removes the old log file with the smallest timestamp. <em>num</em> must be at least 2. The default number of log files is 10. The action</p>
  </dd>
  <dt>
    <p><strong>!</strong><em>processor</em></p>
  </dt>
  <dd>
    <p>sets a <em>processor</em> for subsequent <em>dir</em> actions. <strong>multilog</strong> will feed <em>current</em> through <em>processor</em> and save the output as an old log file instead of <em>current</em>. <strong>multilog</strong> will also save any output that <em>processor</em> writes to descriptor 5, and make that output readable on descriptor 4 when it runs <em>processor</em> on the next log file. For reliability, <em>processor</em> must exit nonzero if it has any trouble creating its output; <strong>multilog</strong> will then run it again. Note that running <em>processor</em> may block any program feeding input to <strong>multilog</strong>.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO multilog&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/supervise.8.html"><strong>supervise</strong>(8)</a>, <a href="../man8/svc.8.html"><strong>svc</strong>(8)</a>, <a href="../man8/svok.8.html"><strong>svok</strong>(8)</a>, <a href="../man8/svstat.8.html"><strong>svstat</strong>(8)</a>, <a href="../man8/svscanboot.8.html"><strong>svscanboot</strong>(8)</a>, <a href="../man8/svscan.8.html"><strong>svscan</strong>(8)</a>, <a href="../man8/readproctitle.8.html"><strong>readproctitle</strong>(8)</a>, <a href="../man8/fghack.8.html"><strong>fghack</strong>(8)</a>, <a href="../man8/pgrphack.8.html"><strong>pgrphack</strong>(8)</a>, <a href="../man8/tai64n.8.html"><strong>tai64n</strong>(8)</a>, <a href="../man8/tai64nlocal.8.html"><strong>tai64nlocal</strong>(8)</a>, <a href="../man8/setuidgid.8.html"><strong>setuidgid</strong>(8)</a>, <a href="../man8/envuidgid.8.html"><strong>envuidgid</strong>(8)</a>, <a href="../man8/envdir.8.html"><strong>envdir</strong>(8)</a>, <a href="../man8/softlimit.8.html"><strong>softlimit</strong>(8)</a>, <a href="../man8/setlock.8.html"><strong>setlock</strong>(8)</a></p><p>http://cr.yp.to/daemontools.html</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="mtr-tiny-mtr.8.html"><span aria-hidden="true">&larr;</span> mtr.8: A network diagnostic tool</a></li>
   <li class="next"><a href="multinet.8.html">multinet.8: Connect to a multinet* decnet over ip server <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
