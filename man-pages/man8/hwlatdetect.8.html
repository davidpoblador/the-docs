<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>hwlatdetect: Program to control the kernel hardware latency detection module</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Program to control the kernel hardware latency detection module">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="hwlatdetect (8) manual">
  <meta name="twitter:description" content="Program to control the kernel hardware latency detection module">
  <meta name="twitter:image" content="https://www.carta.tech/images/rt-tests-hwlatdetect-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/hwlatdetect.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="hwlatdetect (8) manual" />
  <meta property="og:description" content="Program to control the kernel hardware latency detection module" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/rt-tests-hwlatdetect-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">hwlatdetect<small> (8)</small></h1>
        <p class="lead">Program to control the kernel hardware latency detection module</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/hwlatdetect.8.html">
      <span itemprop="name">hwlatdetect: Program to control the kernel hardware latency detection module</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/rt-tests/">
      <span itemprop="name">rt-tests</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/hwlatdetect.8.html">
      <span itemprop="name">hwlatdetect: Program to control the kernel hardware latency detection module</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>hwlatdetect</strong> [ --duration=&lt;time&gt; ] [--threshold=&lt;usecs&gt; ]  [--window=&lt;time interval&gt; ] [--width=&lt;time interval&gt; ] [--report=&lt;path&gt; ]  [--cleanup ] [--debug ] [--quiet ]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>hwlatdetect</strong> is a program that controls the kernel hardware latency detector module (hwlat_detector.ko). The module is a special purpose kernel module that is used to detect large system latencies induced by the behavior of certain underlying hardware or firmware, independent of Linux itself. The code was developed originally to detect SMIs (System Management Interrupts) on x86 systems, however there is nothing x86 specific about this patchset. It was originally written for use by the "RT" patch since the Real Time kernel is highly latency sensitive.</p><p>SMIs are usually not serviced by the Linux kernel, which typically does not even know that they are occuring. SMIs are instead are set up by BIOS code and are serviced by BIOS code, usually for "critical" events such as management of thermal sensors and fans. Sometimes though, SMIs are used for other tasks and those tasks can spend an inordinate amount of time in the handler (sometimes measured in milliseconds). Obviously this is a problem if you are trying to keep event service latencies down in the microsecond range.</p><p>The hardware latency detector module works by hogging all of the cpus for configurable amounts of time (by calling stop_machine()), polling the CPU Time Stamp Counter for some period, then looking for gaps in the TSC data. Any gap indicates a time when the polling was interrupted and since the machine is stopped and interrupts turned off the only thing that could do that would be an SMI.</p><p>The hwlatdetector script manages the mounting/unmounting of the debugfs as well as the loading/unloading of the hwlat_detector module. If the debugfs is already mounted then hwlatdetector will not unmount it after a run. Likewise, if the hwlat_detector module is already loaded, it will not be unloaded after a run.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>--duration=&lt;time&gt;{s,m,d}</strong></p>
  </dt>
  <dd>
    <p>Run the detector logic in for the specified duration. The duration is a base 10 integer number that defaults to a value in seconds. An optional suffix may be specified to indicate minutes, hours or days.</p>
  </dd>
  <dt>
    <p><strong>--threshold=&lt;microsecond value&gt;</strong></p>
  </dt>
  <dd>
    <p>Specify the TSC gap used to detect an SMI. Any gap value greater than &lt;theshold&gt; is considered to be the result of an SMI occuring.</p>
  </dd>
  <dt>
    <p><strong>--window=&lt;time value&gt;{us,ms,s,m,d}</strong></p>
  </dt>
  <dd>
    <p>specify the size of the sample window. Converted to microseconds when passed to the kernel module.</p>
  </dd>
  <dt>
    <p><strong>--width=&lt;time value&gt;{us,ms,s,m,d}</strong></p>
  </dt>
  <dd>
    <p>The amount of time within the sample window where the detector is actually sampling. Must be less than the --window value.</p>
  </dd>
  <dt>
    <p><strong>--report=FILENAME</strong></p>
  </dt>
  <dd>
    <p>Specify the output filename of the detector report. Default behavior is to print to standard output</p>
  </dd>
  <dt>
    <p><strong>--cleanup</strong></p>
  </dt>
  <dd>
    <p>Force unload of hwlat_detector.ko and unmounting of debugfs filesystem.</p>
  </dd>
  <dt>
    <p><strong>--debug</strong></p>
  </dt>
  <dd>
    <p>Turn on debug prints</p>
  </dd>
  <dt>
    <p><strong>--quiet</strong></p>
  </dt>
  <dd>
    <p>Turn off all information prints</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p><strong>hwlatdetect</strong> was written by Clark Williams &lt;williams@redhat.com&gt;</p><p><strong>hwlat_detector.ko</strong> was written by Jon Masters &lt;jcm@redhat.com&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="hwinfo.8.html"><span aria-hidden="true">&larr;</span> hwinfo.8: Probe for hardware</a></li>
   <li class="next"><a href="i2c-stub-from-dump.8.html">i2c-stub-from-dump.8: Feed i2c-stub with dump files <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
