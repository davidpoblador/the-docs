<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>perfquery: Perfquery -</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Perfquery -">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="perfquery (8) manual">
  <meta name="twitter:description" content="Perfquery -">
  <meta name="twitter:image" content="https://www.carta.tech/images/infiniband-diags-perfquery-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/perfquery.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="perfquery (8) manual" />
  <meta property="og:description" content="Perfquery -" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/infiniband-diags-perfquery-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">perfquery<small> (8)</small></h1>
        <p class="lead">Perfquery -</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/perfquery.8.html">
      <span itemprop="name">perfquery: Perfquery -</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/infiniband-diags/">
      <span itemprop="name">infiniband-diags</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/perfquery.8.html">
      <span itemprop="name">perfquery: Perfquery -</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">QUERY INFINIBAND PORT COUNTERS ON A SINGLE PORT</h2>
        <div class="sectioncontent">
<h3>SYNOPSIS</h3>
<p>perfquery [options] [&lt;lid|guid&gt; [[port(s)] [reset_mask]]]</p>
<h3>DESCRIPTION</h3>
<p>perfquery uses PerfMgt GMPs to obtain the PortCounters (basic performance and error counters), PortExtendedCounters, PortXmitDataSL, PortRcvDataSL, PortRcvErrorDetails, PortXmitDiscardDetails, PortExtendedSpeedsCounters, or PortSamplesControl from the PMA at the node/port specified. Optionally shows aggregated counters for all ports of node.  Finally it can, reset after read, or just reset the counters.</p><p>Note: In PortCounters, PortCountersExtended, PortXmitDataSL, and PortRcvDataSL, components that represent Data (e.g. PortXmitData and PortRcvData) indicate octets divided by 4 rather than just octets.</p><p>Note: Inputting a port of 255 indicates an operation be performed on all ports.</p><p>Note: For PortCounters, ExtendedCounters, and resets, multiple ports can be specified by either a comma separated list or a port range.  See examples below.</p>
<h3>OPTIONS</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong></strong><strong>-x, --extended</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show extended port counters rather than (basic) port counters. Note that extended port counters attribute is optional.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>-X, --xmtsl</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show transmit data SL counter. This is an optional counter for QoS.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>-S, --rcvsl</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show receive data SL counter. This is an optional counter for QoS.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>-D, --xmtdisc</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show transmit discard details. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>-E, --rcverr</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show receive error details. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>-D, --xmtdisc</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show transmit discard details. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>-T, --extended_speeds</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show extended speeds port counters. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--oprcvcounters</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show Rcv Counters per Op code. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--flowctlcounters</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show flow control counters. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--vloppackets</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show packets received per Op code per VL. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--vlopdata</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show data received per Op code per VL. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--vlxmitflowctlerrors</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show flow control update errors per VL. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--vlxmitcounters</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show ticks waiting to transmit counters per VL. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--swportvlcong</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show sw port VL congestion. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--rcvcc</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show Rcv congestion control counters. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--slrcvfecn</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show SL Rcv FECN counters. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--slrcvbecn</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show SL Rcv BECN counters. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--xmitcc</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show Xmit congestion control counters. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>--vlxmittimecc</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show VL Xmit Time congestion control counters. This is an optional counter.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>-c, --smplctl</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show port samples control.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>-a, --all_ports</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show aggregated counters for all ports of the destination lid, reset all counters for all ports, or if multiple ports are specified, aggregate the counters of the specified ports.  If the destination lid does not support the AllPortSelect flag, all ports will be iterated through to emulate AllPortSelect behavior.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>-l, --loop_ports</strong><strong></strong></p>
  </dt>
  <dd>
    <p>If all ports are selected by the user (either through the <strong>-a</strong> option or port 255) or multiple ports are specified iterate through each port rather than doing than aggregate operation.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>-r, --reset_after_read</strong><strong></strong></p>
  </dt>
  <dd>
    <p>reset counters after read</p>
  </dd>
  <dt>
    <p><strong></strong><strong>-R, --Reset_only</strong><strong></strong></p>
  </dt>
  <dd>
    <p>only reset counters</p>
  </dd>

</dl>

<h3>Addressing Flags</h3>
<p><strong>-G, --Guid</strong>     The address specified is a Port GUID</p><p><strong>-L, --Lid</strong>   The address specified is a LID</p><p><strong>-s, --sm_port &lt;smlid&gt;</strong>     use &apos;smlid&apos; as the target lid for SA queries.</p>
<h3>Port Selection flags</h3>
<p><strong>-C, --Ca &lt;ca_name&gt;</strong>    use the specified ca_name.</p><p><strong>-P, --Port &lt;ca_port&gt;</strong>    use the specified ca_port.</p>
<h3>Local port Selection</h3>
<p>Multiple port/Multiple CA support: when no IB device or port is specified (see the "local umad parameters" below), the libibumad library selects the port to use by the following criteria:</p>
<dl class='dl-vertical'>
  <dt>
    1.
  </dt>
  <dd>
    <p>the first port that is ACTIVE.</p>
  </dd>
  <dt>
    2.
  </dt>
  <dd>
    <p>if not found, the first port that is UP (physical link up).</p><p>If a port and/or CA name is specified, the libibumad library attempts to fulfill the user request, and will fail if it is not possible.</p><p>For example:</p>
<pre>
ibaddr                 # use the first port (criteria #1 above)
ibaddr -C mthca1       # pick the best port from "mthca1" only.
ibaddr -P 2            # use the second (active/up) port from the first available IB device.
ibaddr -C mthca0 -P 2  # use the specified port only.
</pre>

  </dd>

</dl>

<h3>Debugging flags</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>-d</strong></p>
  </dt>
  <dd>
    <p>raise the IB debugging level. May be used several times (-ddd or -d -d -d).</p>
  </dd>
  <dt>
    <p><strong>-e</strong></p>
  </dt>
  <dd>
    <p>show send and receive errors (timeouts and others)</p><p><strong>-h, --help</strong>      show the usage message</p>
  </dd>
  <dt>
    <p><strong></strong><strong>-v, --verbose</strong><strong></strong></p>
  </dt>
  <dd>
    <p>increase the application verbosity level. May be used several times (-vv or -v -v -v)</p><p><strong>-V, --version</strong>     show the version info.</p>
  </dd>

</dl>

<h3>Configuration flags</h3>
<p><strong>-t, --timeout &lt;timeout_ms&gt;</strong> override the default timeout for the solicited mads.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong></strong><strong>-y, --m_key &lt;key&gt;</strong><strong></strong></p>
  </dt>
  <dd>
    <p>use the specified M_key for requests. If non-numeric value (like &apos;x&apos;) is specified then a value will be prompted for.</p><p><strong>--config, -z  &lt;config_file&gt;</strong> Specify alternate config file. Default: /etc/infiniband-diags/ibdiag.conf</p>
  </dd>

</dl>

<h3>FILES</h3>

<h3>CONFIG FILE</h3>
<p>/etc/infiniband-diags/ibdiag.conf</p><p>A global config file is provided to set some of the common options for all tools.  See supplied config file for details.</p>
<h3>EXAMPLES</h3>

<pre>
perfquery                # read local port performance counters
perfquery 32 1           # read performance counters from lid 32, port 1
perfquery -x 32 1        # read extended performance counters from lid 32, port 1
perfquery -a 32          # read perf counters from lid 32, all ports
perfquery -r 32 1        # read performance counters and reset
perfquery -x -r 32 1     # read extended performance counters and reset
perfquery -R 0x20 1      # reset performance counters of port 1 only
perfquery -x -R 0x20 1   # reset extended performance counters of port 1 only
perfquery -R -a 32       # reset performance counters of all ports
perfquery -R 32 2 0x0fff # reset only error counters of port 2
perfquery -R 32 2 0xf000 # reset only non-error counters of port 2
perfquery -a 32 1-10     # read performance counters from lid 32, port 1-10, aggregate output
perfquery -l 32 1-10     # read performance counters from lid 32, port 1-10, output each port
perfquery -a 32 1,4,8    # read performance counters from lid 32, port 1, 4, and 8, aggregate output
perfquery -l 32 1,4,8    # read performance counters from lid 32, port 1, 4, and 8, output each port
</pre>

<h3>AUTHOR</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>Hal Rosenstock</strong></p>
  </dt>
  <dd>
    <p>&lt; <em>hal.rosenstock@gmail.com</em> &gt;</p>
  </dd>

</dl>


        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="perf-stat-hist.8.html"><span aria-hidden="true">&larr;</span> perf-stat-hist.8: Histogram summary of tracepoint values. uses linux perf_events.</a></li>
   <li class="next"><a href="perl-nocem.8.html">perl-nocem.8: A nocem-on-spool implementation for inn2.x <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
