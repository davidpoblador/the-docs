<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>sg_write_long: Send scsi write long command</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Send scsi write long command">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="sg_write_long (8) manual">
  <meta name="twitter:description" content="Send scsi write long command">
  <meta name="twitter:image" content="https://www.carta.tech/images/sg3-utils-sg_write_long-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/sg_write_long.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="sg_write_long (8) manual" />
  <meta property="og:description" content="Send scsi write long command" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/sg3-utils-sg_write_long-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">sg_write_long<small> (8)</small></h1>
        <p class="lead">Send scsi write long command</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/sg_write_long.8.html">
      <span itemprop="name">sg_write_long: Send scsi write long command</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/sg3-utils/">
      <span itemprop="name">sg3-utils</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/sg_write_long.8.html">
      <span itemprop="name">sg_write_long: Send scsi write long command</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>sg_write_long</strong> [<em>--16</em>] [<em>--cor_dis</em>] [<em>--help</em>] [<em>--in=IF</em>] [<em>--lba=LBA</em>] [<em>--pblock</em>] [<em>--verbose</em>] [<em>--version</em>] [<em>--wr_uncor</em>] [<em>--xfer_len=BTL</em>] <em>DEVICE</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Send the SCSI WRITE LONG (10 or 16 byte) command to <em>DEVICE</em>. The buffer to be written to the <em>DEVICE</em> is filled with <strong>0xff</strong> bytes or read from the <em>IF</em> file. This buffer includes the logical data (e.g. 512 bytes) and the ECC bytes.</p><p>This utility can be used to generate a MEDIUM ERROR at a specific logical block address. This can be useful for testing error handling. Prior to such a test, the <strong>sg_dd</strong> utility could be used to copy the original contents of the logical block address to some safe location. After the test the <strong>sg_dd</strong> utility could be used to write back the original contents of the logical block address. An alternate strategy would be to read the "long" contents of the logical block address with <strong>sg_read_long</strong> utility prior to testing and restore it with this utility after testing.</p><p><strong>Take care:</strong> If recoverable errors are being injected (e.g. only one or a few bits changed so that the ECC is able to correct the data) then care should be taken with the settings in the "read write error recovery" mode page. Specifically if the ARRE (for reads) and/or AWRE (for writes) are set then recovered errors will cause the lba to be reassigned (and the old location to be added to the grown defect list (PLIST)). This is not easily reversed and uses (one of the finite number of) the spare sectors set aside for this purpose. If in doubt it is probably safest to clear the ARRE and AWRE bits. These bits can be checked and modified with the sdparm utility.  For example: "sdparm -c AWRE,ARRE /dev/sda" will clear the bits until the disk is power cycled.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>Arguments to long options are mandatory for short options as well.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-S</strong>, <strong>--16</strong></p>
  </dt>
  <dd>
    <p>send a SCSI WRITE LONG (16) command to <em>DEVICE</em>. The default action (in the absence of this option) is to send a SCSI WRITE LONG (10) command.</p>
  </dd>
  <dt>
    <p><strong>-c</strong>, <strong>--cor_dis</strong></p>
  </dt>
  <dd>
    <p>sets the correction disabled (i.e 'COR_DIS') bit. This inhibits various other mechanisms such as automatic block reallocation, error recovery and various informational exception conditions being triggered. This bit is relatively new in SBC-3 .</p>
  </dd>
  <dt>
    <p><strong>-h</strong>, <strong>--help</strong></p>
  </dt>
  <dd>
    <p>output the usage message then exit.</p>
  </dd>
  <dt>
    <p><strong>-i</strong>, <strong>--in</strong>=<em>IF</em></p>
  </dt>
  <dd>
    <p>read data (binary) from file named <em>IF</em> and use it for the SCSI WRITE LONG command. If <em>IF</em> is "-" then stdin is read. If this option is not given then 0xff bytes are used as fill.</p>
  </dd>
  <dt>
    <p><strong>-l</strong>, <strong>--lba</strong>=<em>LBA</em></p>
  </dt>
  <dd>
    <p>where <em>LBA</em> is the logical block address of the sector to overwrite. Defaults to lba 0 which is a dangerous block to overwrite on a disk that is in use. Assumed to be in decimal unless prefixed with '0x' or has a trailing 'h'. If <em>LBA</em> is larger than can fit in 32 bits then the <em>--16</em> option should be used.</p>
  </dd>
  <dt>
    <p><strong>-p</strong>, <strong>--pblock</strong></p>
  </dt>
  <dd>
    <p>sets the physical block (i.e 'PBLOCK') bit. This instructs <em>DEVICE</em> to use the given data (unless <em>--wr_uncor</em> is also given) to write to the physical block specified by <em>LBA</em>. The default action is to write to the logical block corresponding to the given lba. This bit is relatively new in SBC-3 .</p>
  </dd>
  <dt>
    <p><strong>-v</strong>, <strong>--verbose</strong></p>
  </dt>
  <dd>
    <p>increase the degree of verbosity (debug messages).</p>
  </dd>
  <dt>
    <p><strong>-V</strong>, <strong>--version</strong></p>
  </dt>
  <dd>
    <p>output version string then exit.</p>
  </dd>
  <dt>
    <p><strong>-w</strong>, <strong>--wr_uncor</strong></p>
  </dt>
  <dd>
    <p>sets the "write uncorrected" (i.e 'WR_UNCOR') bit. This instructs the <em>DEVICE</em> to flag the given lba (or the physical block that contains it if <em>--pblock</em> is also given) as having an unrecoverable error associated with it. Note: no data is transferred to <em>DEVICE</em>, other than the command (i.e. the cdb). In the absence of this option, the default action is to use the provided data or 0xff bytes (<em>--xfer_len=BTL</em> in length) and write it to <em>DEVICE</em>. This bit is relatively new in SBC-3 .</p>
  </dd>
  <dt>
    <p><strong>-x</strong>, <strong>--xfer_len</strong>=<em>BTL</em></p>
  </dt>
  <dd>
    <p>where <em>BTL</em> is the byte transfer length (default to 520). If the given value (or the default) does not match the "long" block size of the device, nothing is written to <em>DEVICE</em> and the appropriate xfer_len value may be deduced from the error response which is printed (to stderr).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>Various numeric arguments (e.g. <em>LBA</em>) may include multiplicative suffixes or be given in hexadecimal. See the "NUMERIC ARGUMENTS" section in the <a href="../man8/sg3_utils.8.html"><strong>sg3_utils</strong>(8)</a> man page.</p><p>The 10 byte SCSI WRITE LONG command limits the logical block address to a 32 bit quantity. For larger LBAs use the <em>--16</em> option for the SCSI WRITE LONG (16) command.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>This section outlines setting up a block with corrupted data, checking the error condition, then restoring useful contents to that sector.</p><p>First, if the data in a sector is important, save it with the sg_read_long utility:</p>
<pre>
  sg_read_long --lba=0x1234 --out=0x1234_1.img -x <em>BTL</em> /dev/sda
</pre>
<p>This utility may need to be executed several time in order to determine what the correct value for <em>BTL</em> is. Next use this utility to "corrupt" that sector. That might be done with:</p>
<pre>
  sg_write_long --lba=0x1234 -x <em>BTL</em> /dev/sda
</pre>
<p>This will write a sector (and ECC data) of 0xff bytes. Some disks may reject this (at least one of the author's does). Another approach is to copy the 0x1234_1.img file (to 0x1234_2.img in this example) and change some values with a hex editor. Then write the changed image with:</p>
<pre>
  sg_write_long --lba=0x1234 --in=0x1234_2.img -x <em>BTL</em> /dev/sda
</pre>
<p>Yet another approach is to use the <em>--wr_uncor</em> option, if supported:</p>
<pre>
  sg_write_long --lba=0x1234 --wr_uncor /dev/sda
</pre>
<p>Next we use the sg_dd utility to check that the sector is corrupted. Here is an example:</p>
<pre>
  sg_dd if=/dev/sda blk_sgio=1 skip=0x1234 of=. bs=512 count=1 verbose=4
</pre>
<p>Notice that the "blk_sgio=1" option is given. This is to make sure that the sector is read (and no others) and the error is fully reported. The "blk_sgio=1" option causes the SG_IO ioctl to be used by sg_dd rather than the block subsystem.</p><p>Finally we should restore sector 0x1234 to a non-corrupted state. A sector full of zeros could be written with:</p>
<pre>
  sg_dd if=/dev/zero of=/dev/sda blk_sgio=1 seek=0x1234 bs=512 count=1
</pre>
<p>This will result in a sector (block) with 512 bytes of 0x0 without a MEDIUM ERROR since the ECC and associated data will be regenerated and thus well formed. The 'blk_sgio=1' option is even more important in this case as it may stop the block subsystem doing a read before write (since the read will most likely fail). Another approach is to write back the original contents:</p>
<pre>
  sg_write_long --lba=0x1234 --in=0x1234_1.img -x <em>BTL</em> /dev/sda
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">
<p>The exit status of sg_write_long is 0 when it is successful. Otherwise see the <a href="../man8/sg3_utils.8.html"><strong>sg3_utils</strong>(8)</a> man page.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Written by Saeed Bishara. Further work by Douglas Gilbert.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">
<p>Report bugs to &lt;dgilbert at interlog dot com&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2004-2013 Douglas Gilbert</p><p>This software is distributed under the GPL version 2. There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO sg_write_long&hellip;</h2>
        <div class="sectioncontent">
<p><strong>sg_read_long, sg_dd (both in sg3_utils), sdparm(sdparm)</strong></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="sg_write_buffer.8.html"><span aria-hidden="true">&larr;</span> sg_write_buffer.8: Send scsi write buffer commands</a></li>
   <li class="next"><a href="sg_write_same.8.html">sg_write_same.8: Send scsi write same command <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
