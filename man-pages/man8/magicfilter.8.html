<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>magicfilter: Automatic configurable printer filter</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Automatic configurable printer filter">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="magicfilter (8) manual">
  <meta name="twitter:description" content="Automatic configurable printer filter">
  <meta name="twitter:image" content="https://www.carta.tech/images/magicfilter-magicfilter-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/magicfilter.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="magicfilter (8) manual" />
  <meta property="og:description" content="Automatic configurable printer filter" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/magicfilter-magicfilter-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">magicfilter<small> (8)</small></h1>
        <p class="lead">Automatic configurable printer filter</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/magicfilter.8.html">
      <span itemprop="name">magicfilter: Automatic configurable printer filter</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/magicfilter/">
      <span itemprop="name">magicfilter</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/magicfilter.8.html">
      <span itemprop="name">magicfilter: Automatic configurable printer filter</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>magicfilter</strong> config-file [-c] [-n user] [-h host] [-iindent] [--debug] [other-options]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>magicfilter</strong> is an extensible and customizable automatic printer filter.  It selects an appropriate conversion technique for the input data by seeking for <em>magic numbers</em>, and then utilizing the appropriate conversion utility.</p><p><strong>magicfilter</strong> is primarily intended for use as the ``input filter'' by the <strong>lpd</strong> print spooler.  The options accepted by <strong>magicfilter</strong> are exactly the ones passed to the input filter by <strong>lpd</strong>.</p><h3>OPTIONS</h3>
<p>Typically <strong>magicfilter</strong> will be invoked by <strong>lpd</strong> and hence provided the right options automatically.  This list is included for reference only.</p><p>Note that only the <em>-n</em> and <em>-h</em> options may have spaces between the option letter and the option value.</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>-c</em></p>
  </dt>
  <dd>
    <p>Copy the input to the output without any conversion whatsoever (used by <strong>lpd</strong> whenever the <em>-l</em> option is passed to the <strong>lpr</strong> program).</p>
  </dd>
  <dt>
    <p><em>-nuser, -n user</em></p>
  </dt>
  <dd>
    <p>The login name of the user who submitted the job.  Available to subfilters as <strong>$LPUSER</strong>. If the user has an associated GECOS entry it will be available as <strong>$LPUSERNAME</strong>.</p>
  </dd>
  <dt>
    <p><em>-hhost, -h host</em></p>
  </dt>
  <dd>
    <p>The host on which the job was submitted.  Available to subfilters as <strong>$LPHOST</strong>.</p>
  </dd>
  <dt>
    <p><em>-iindent</em></p>
  </dt>
  <dd>
    <p>A numeric option passed by <strong>lpd</strong>; can be set by the user by the <em>-i</em> option to <strong>lpr.</strong> Although nominally used for the amount of indentation requested, <strong>magicfilter</strong> makes it available to subfilters for any useful purpose as <strong>$LPINDENT</strong>.</p>
  </dd>
  <dt>
    <p><em>-Cclassname</em></p>
  </dt>
  <dd>
    <p>LPRng class (priority) name.  Available to subfilters as <strong>$LPCLASS</strong>.</p>
  </dd>
  <dt>
    <p><em>-Fformat</em></p>
  </dt>
  <dd>
    <p>Format letter (passed by LPRng only).  When used as input filter (if) this will be <em>f</em>, when used as other filter types it will be the option character corresponding to this filter.  Available to subfilters as <strong>$LPFORMAT</strong>.</p>
  </dd>
  <dt>
    <p><em>-Jjobname</em></p>
  </dt>
  <dd>
    <p>The name of the printer job (passed by LPRng only).  Available to subfilters as <strong>$LPJOB</strong>.</p>
  </dd>
  <dt>
    <p><em>-Kcopies</em></p>
  </dt>
  <dd>
    <p>Copy count (passed by LPRng only).  Available to subfilters as <strong>$LPCOPIES</strong>.</p>
  </dd>
  <dt>
    <p><em>-Lbannername</em></p>
  </dt>
  <dd>
    <p>User name from the banner page (passed by LPRng only).  Available to subfilters as <strong>$BANNERNAME</strong>.</p>
  </dd>
  <dt>
    <p><em>-Pprinter</em></p>
  </dt>
  <dd>
    <p>Printer name (passed by LPRng only).  Available to subfilters as <strong>$PRINTER</strong>.</p>
  </dd>
  <dt>
    <p><em>-Qqueuename</em></p>
  </dt>
  <dd>
    <p>Spool queue name (passed by LPRng only).  Available to subfilters as <strong>$LPQUEUE</strong>.</p>
  </dd>
  <dt>
    <p><em>-Raccountinfo</em></p>
  </dt>
  <dd>
    <p>Accounting information (passed by LPRng only).  Available to subfilters as <strong>$LPACCT</strong>.</p>
  </dd>
  <dt>
    <p><em>-Zoptions</em></p>
  </dt>
  <dd>
    <p>LPRng ``Z-options''.  The LPRng <strong>lpr</strong> program supports a <em>-Z</em> option, which can be used to pass arbitrary information to the printer filters.  Available to subfilters as <strong>$ZOPT</strong>.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><em>--debug</em></p>
  </dt>
  <dd>
    <p>Write the name of each facility invoked (together with any options) to standard error.  This can be useful for debugging complicated configuration files.</p>
  </dd>
  <dt>
    <p><em>other options</em></p>
  </dt>
  <dd>
    <p>Any other options, such as the <em>-w</em>, <em>-l</em>, <em>-x</em>, and <em>-y</em> options typically passed by <strong>lpd</strong> are ignored.</p>
  </dd>

</dl>

<h3>RUNNING MAGICFILTER FROM LPD</h3>
<p>To run <strong>magicfilter</strong> from <strong>lpd</strong> it should be entered as one of the filters in the <em>/etc/printcap</em> file.  Typically, it will be the input filter (if).  Since most version of <strong>lpd</strong> do not accept arguments entered as part of the filter name, typically the filter name entered into the <em>/etc/printcap</em> file will simply be the name of the configuration file, which is set executable and starts with the line:</p><p><strong>#! /usr/sbin/magicfilter</strong></p><p>Most UNIX kernels will then be able to treat the configuration file itself as if it was the actual program.</p><p>For systems which do not support the ``#!-hack'', the filter set in the if entry should point to <strong>magicfilter</strong> directly, and the accounting file (af) entry should point to the configuration file.  This, however, is a less general, and hence less desirable solution.</p><p>This version of <strong>magicfilter</strong> supports the enhanced <strong>lpd</strong> included with the LPRng package from <em>dickory.sdsu.edu</em>.</p>
<h3>THE CONFIGURATION FILE</h3>
<p>The configuration file is used by <strong>magicfilter</strong> to redirect various types of data to the various conversion utilities. The configuration file is printer-specific, and often system-specific, depending on the available conversion programs.  For example, a system which has GhostScript installed would be able to print PostScript to a non-PostScript printer, whereas other systems typically would not.</p><p>The configuration file contains a sequence of lines of the form:</p><p><em>offset	magic	facility</em></p><p>where the <em>offset</em> represents the location of the indentification string in the data format, <em>magic</em> represents the identification string itself, <em>facility</em> represents the type of action to take.</p><p>Blank lines and lines with a hash mark (#) as the first nonblank character are ignored.  A line may be continued onto the next line by ending the line in a backslash (&#92;).</p><p>The <em>offset</em> is a nonnegative integer, which can be represented either in decimal form (default), octal form (preceded by <em>0</em>), or hexadecimal form (preceded by <em>0x</em>).</p><p>The <em>magic</em> is a string of characters, which may include C-style &#92;-escape sequences.  In addition, the sequence &#92;? can be used to represent a ``wildcard'' byte.  If the string includes spaces, the spaces have to be preceded by a backslash, or the entire string must be enclosed in double quotation marks.</p><p>For ambiguous matches, the first match is used.  Hence, the most specific match should always be placed first in the file.  In addition, the last line may be of the form:</p><p><strong>default</strong>	<em>facility</em></p><p>which designates a default action to be used in case no other action matches.  This will typically be the action for plain text.</p>
<h3>FACILITIES</h3>
<p><strong>magicfilter</strong> provides the following options for the <em>facility</em> field in the configuration file:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>cat</strong> [<em>prefix</em> [<em>suffix</em>]]</p>
  </dt>
  <dd>
    <p>Copy the input to the output without any conversion, like the <strong>cat</strong> command.  If the optional <em>prefix</em> and <em>suffix</em> strings are specified, they are transmitted to the printer immediately before and after the data itself.  The <em>prefix</em> and <em>suffix</em> strings are specified in the same way as the <em>magic</em> string (except that the wildcard sequence &#92;? is not permitted), and like the <em>magic</em> sequence can contain any control character, including nulls (&#92;0).  To specify a <em>suffix</em> without a <em>prefix</em>, specify an empty <em>prefix</em> string enclosed in double quotes (i.e. "").</p>
  </dd>
  <dt>
    <p><strong>text</strong> [<em>prefix</em> [<em>suffix</em>]]</p>
  </dt>
  <dd>
    <p>Copy the input to the output, but add carriage return characters before every line feed and form feed character in the file, and a line feed-form feed sequence at end of file. The <em>prefix</em> and <em>suffix</em> arguments are treated the same way as for the <strong>cat</strong> facility; the <em>suffix</em>, if present, is added after the final line feed-form feed sequence.</p>
  </dd>
  <dt>
    <p><strong>postscript</strong></p>
  </dt>
  <dd>
    <p>Same as the <strong>text</strong> facility, except add an ASCII EOT (Ctrl-D) character to the end of the data.  This lets a PostScript printer know that the end of the job has been reached.  This is functionally equivalent to the command</p>
  </dd>
  <dt>
    <p><em> </em></p>
  </dt>
  <dd>
    <p><strong>text</strong> "" &#92;004</p>
  </dd>
  <dt>
    <p><strong>ignore</strong></p>
  </dt>
  <dd>
    <p>Ignore the job; do not provide any output whatsoever.</p>
  </dd>
  <dt>
    <p><strong>reject</strong> <em>message</em></p>
  </dt>
  <dd>
    <p>Same as the <strong>ignore</strong> facility, but attempt to send an email message to the user who submitted the job to inform that a job has been rejected and why.</p>
  </dd>
  <dt>
    <p><strong>filter</strong> <em>command</em></p>
  </dt>
  <dd>
    <p>Run the given <em>command</em>, feeding it the input data, and sending the output data to the printer. The environment variables <strong>LPUSER</strong>, <strong>LPHOST</strong>, and <strong>LPINDENT</strong> is set to the values of the user, host and indent options passed to <strong>magicfilter</strong>. Since the <em>command</em> is fed to <em>/bin/sh</em> it may contain shell special characters, and the sequences <strong>$LPUSER</strong>, <strong>$LPHOST</strong>, and <strong>$LPINDENT</strong> can be used to access the values of the passed environment variables. If the <strong>lpd</strong> daemon on the system is LPRng, the following environment variables are also available, see the <strong>OPTIONS</strong> section for details: <strong>LPCLASS</strong>, <strong>LPFORMAT</strong>, <strong>LPJOB</strong>, <strong>LPCOPIES</strong>, <strong>BANNERNAME</strong>, <strong>PRINTER</strong>, <strong>LPQUEUE</strong>, <strong>LPACCT</strong>, and <strong>ZOPT</strong>.</p>
  </dd>
  <dt>
    <p><strong>pipe</strong> <em>command</em></p>
  </dt>
  <dd>
    <p>Same as the <strong>filter</strong> facility, except that the output data is fed back into <strong>magicfilter</strong> for reprocessing.  This is used for external filter programs which themselves do not produce a format that the printer can accept, but which can be futher processed to obtain such a format.</p>
  </dd>
  <dt>
    <p><strong>ffilter</strong> <em>command</em></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>fpipe</strong> <em>command</em></p>
  </dt>
  <dd>
    <p>Same as the <strong>filter</strong> and <strong>pipe</strong> facilities, respectively, except that the input is written to a temporary file before being fed to the filter program given by <em>command</em>. This is useful for programs which require seekable input, such as <strong>dvips</strong>, or which need to do multiple passes over an input file, such as <strong>grog</strong>. The environment variable <strong>FILE</strong> is set to the name of the temporary file (and, like the other ones, it can be accessed on the command line as <strong>$FILE</strong>).</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HINTS</h2>
        <div class="sectioncontent">
<p>Using the <strong>pipe</strong> facility together with <strong>zcat</strong> or <strong>gunzip</strong> lets you transparently print compressed files.</p><p>The <strong>pbmplus</strong> or <strong>netpbm</strong> collections of image conversion utilities contain a large number of very useful external filter programs.</p><p>You will probably want to examine the sample configuration files included with the <strong>magicfilter</strong> distribution before creating your own.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Some data formats cannot be easily identified by a simple fixed-offset magic number check.</p><p>Providing large offsets can cause <strong>magicfilter</strong> to take up lots of memory.  Fortunately, large offsets for magic numbers are pretty much unheard of.</p><p>Currently, there is no protection against the <strong>pipe</strong> or <strong>fpipe</strong> facilities going into an infinite loop.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>H. Peter Anvin &lt;hpa@zytor.com&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO magicfilter&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/printcap.5.html"><strong>printcap</strong>(5)</a>, <strong>lpr</strong>(8), <a href="../man1/dvips.1.html"><strong>dvips</strong>(1)</a>, <strong>grog</strong>(1), <strong>gs</strong>(1), <a href="../man1/gzip.1.html"><strong>gzip</strong>(1)</a>, <strong>troff</strong>(1).</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="madwimax.8.html"><span aria-hidden="true">&larr;</span> madwimax.8: Driver for mobile wimax equipment based on samsung cmc-730</a></li>
   <li class="next"><a href="magicfilterconfig.8.html">magicfilterconfig.8: Writes interactively a printcap file. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
