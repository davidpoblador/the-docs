<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>faxrunqd: Daemon to send fax jobs queued by faxspool(1)</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Daemon to send fax jobs queued by faxspool(1)">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="faxrunqd (8) manual">
  <meta name="twitter:description" content="Daemon to send fax jobs queued by faxspool(1)">
  <meta name="twitter:image" content="https://www.carta.tech/images/mgetty-fax-faxrunqd-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/faxrunqd.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="faxrunqd (8) manual" />
  <meta property="og:description" content="Daemon to send fax jobs queued by faxspool(1)" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/mgetty-fax-faxrunqd-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">faxrunqd<small> (8)</small></h1>
        <p class="lead">Daemon to send fax jobs queued by faxspool(1)</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/faxrunqd.8.html">
      <span itemprop="name">faxrunqd: Daemon to send fax jobs queued by faxspool(1)</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/mgetty-fax/">
      <span itemprop="name">mgetty-fax</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/faxrunqd.8.html">
      <span itemprop="name">faxrunqd: Daemon to send fax jobs queued by faxspool(1)</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>faxrunqd [-v] [-d] [-D] [-l &lt;ttys&gt;] [-u &lt;user or uid&gt;] [ -g &lt;group or gid&gt; ] [-V]</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Runs in the background, and regularily checks the fax queue set up by <a href="../man1/faxspool.1.html"><strong>faxspool</strong>(1)</a>.  Sends all jobs that are due, records results, and takes appropriate action (notify mails etc).</p><p><em>faxrunqd</em> basically does the same as <a href="../man1/faxrunq.1.html"><strong>faxrunq</strong>(1)</a>, just more so.  Please read the <a href="../man1/faxrunq.1.html"><strong>faxrunq</strong>(1)</a> man page if you're not already familiar with the concept.</p><p>The advantages of <em>faxrunqd</em> are:</p><p>- runs all the time, so you don't have to set up a cron job (but you have to set up an entry in /etc/inittab or start it from /etc/rc*)</p><p>- quicker response to new faxes in queue</p><p>- can sensibly handle more than one modem</p><p>- can handle prioritized fax jobs</p><p>- can do 'policy routing' of faxes depending on the fax number</p><p>The disadvantages are:</p><p>- needs more system ressources if you have only little fax traffic</p><p>- requires Perl 5.004</p><p>- more tricky to set up and to debug</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SETUP</h2>
        <div class="sectioncontent">
<p><em>faxrunqd</em> is started at system boot from /etc/rc.*, or from /etc/inittab.  You can also start it from the command line. It does <strong>not</strong> put itself in the background, so you have to start it with an "&", or from a ":respawn:" line in /etc/inittab.   Using /etc/inittab has the advantage that <em>faxrunqd</em> is restarted automatically if something goes wrong and faxrunqd is stopped.</p><p><em>faxrunqd</em> will first read a global configuration file (see below), then (optionally) the faxrunqd policy file (see further below).  From then on, it will sit in a loop. It will check the fax queue every 60 seconds for new jobs, and will then distribute them over all available modems.  If the job is sent, or fails, it will do the same thing <a href="../man1/faxrunq.1.html"><strong>faxrunq</strong>(1)</a></em> would do (send a mail, delete the JOB directory, execute a named program, etc.).  Both programs are fully compatible in this respect.</p><p><strong>faxrunqd [-v] [-d] [-D] [-l &lt;ttys&gt;] [-u &lt;user or uid&gt;] [ -g &lt;group or gid&gt; ] [-V]</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-v</strong></p>
  </dt>
  <dd>
    <p>Tells <em>faxrunqd</em> to write progress information to the log file.</p>
  </dd>
  <dt>
    <p><strong>-D</strong></p>
  </dt>
  <dd>
    <p>Tells <em>faxrunqd</em> to run in the background, as a daemon.</p>
  </dd>
  <dt>
    <p><strong>-d</strong></p>
  </dt>
  <dd>
    <p>Tells <em>faxrunqd</em> to write debugging information to stdout and the log file (usually used together with -v).</p>
  </dd>
  <dt>
    <p><strong>-l &lt;ttyS&gt;</strong></p>
  </dt>
  <dd>
    <p>Specifies the list of modem devices to use.  Multiple devices are separated with ':', e.g. '-l ttyS0:ttyS1'.</p>
  </dd>
  <dt>
    <p><strong>-u &lt;user or uid&gt;</strong></p>
  </dt>
  <dd>
    <p><em>faxrunqd</em> can now (since 1.1.29) run as unprivileged user.  If you start it as root from /etc/inittab or from one of the /etc/rc* scripts, it's strongly recommended to use '-u uucp' (to be precise: the user that is owning the outgoing fax spool directory).  This will make <em>faxrunqd</em> drop all its privileges at startup, and run as the specified user.  Running <em>faxrunqd</em> as root user might lead to security problems - don't do it. This parameter takes either a uid or a username as argument.</p>
  </dd>
  <dt>
    <p><strong>-g &lt;group or gid&gt;</strong></p>
  </dt>
  <dd>
    <p><em>Same effect as above but for the group id. Indicates the group which</em> should own the fax files. This parameter takes either a gid or a groupname as argument.</p>
  </dd>
  <dt>
    <p><strong>-V</strong></p>
  </dt>
  <dd>
    <p>print version number and exit</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION FILE</h2>
        <div class="sectioncontent">
<p>Some aspects of the behaviour of <em>faxrunqd</em> can be controlled by a configuration file, usually named /etc/mgetty/faxrunq.config (this is the same file that <a href="../man1/faxrunq.1.html"><strong>faxrunq</strong>(1)</a></em> uses, but there are additional options for <em>faxrunqd). In</em> this file, you can use the following options:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>success-send-mail [y/n]</strong></p>
  </dt>
  <dd>
    <p>A boolean parameter that controls whether a mail will be sent after successful completition of the fax job.</p>
  </dd>
  <dt>
    <p><strong>failure-send-mail [y/n]</strong></p>
  </dt>
  <dd>
    <p>A boolean parameter that controls whether a mail will be sent after the fax job has failed more than the maximum number of times.</p>
  </dd>
  <dt>
    <p><strong>success-call-program &lt;name&gt;</strong></p>
  </dt>
  <dd>
    <p>Here, you can specify a program that will be run when the fax has been successfully sent. It will be passed two command line parameters. The first is the full path to the fax JOB file (see <strong>faxq</strong>(5)), the second is the last exit code from <em>sendfax</em> (for success-call-program, this is always "0").</p>
  </dd>
  <dt>
    <p><strong>failure-call-program &lt;name&gt;</strong></p>
  </dt>
  <dd>
    <p>Similar to the "success-call-program", this program will be run when the fax has been failed too often and <em>faxrunqd</em> gives up. This script could, for example, print out the fax on a printer so that it can be sent manually on a paper fax machine.</p>
  </dd>
  <dt>
    <p><strong>update-call-program &lt;name&gt;</strong></p>
  </dt>
  <dd>
    <p>This is, again, similar to "success-call-program".  It will be called for interim status updates ("we've tried and it was BUSY"), so that frontend programs can display this information.  "update-call-program" will only be called for jobs that will be <em>kept</em> in the fax queue for at least one more try.</p>
  </dd>
  <dt>
    <p><strong>maxfail-costly &lt;n&gt;</strong></p>
  </dt>
  <dd>
    <p>This specifies the number of times that a fax may fail "fatally", that is, causing telephone costs (explained above). The default value is 5.</p>
  </dd>
  <dt>
    <p><strong>maxfail-total &lt;m&gt;</strong></p>
  </dt>
  <dd>
    <p>This is the absolute maximum number of times that <em>faxrunqd</em> will try to send any given fax. The default value is 10.</p>
  </dd>
  <dt>
    <p><strong>delete-sent-jobs [y/n]</strong></p>
  </dt>
  <dd>
    <p>Determines whether <em>faxrunqd</em> should delete jobs after sending, or leave them in the fax queue (while moving the "JOB" file to "JOB.done") so that they can be seen at by "faxq -o". The default value is "do not delete sent faxes".</p>
  </dd>
  <dt>
    <p><strong>acct-log &lt;path&gt;</strong></p>
  </dt>
  <dd>
    <p>Specifies where <em>faxrunqd</em> should protocol success and failure of each try to send a fax job. The default location is /var/spool/fax/outgoing/acct.log.</p>
  </dd>

</dl>
<p>The options that are specific to <em>faxrunqd</em> are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>fax-devices [tty(s)]</strong></p>
  </dt>
  <dd>
    <p>Specifies which ttys should be used for sending jobs. <em>faxrunqd</em> will always explicitely tell <em>sendfax</em> which modem to use, so the settings in sendfax.config are ignored. If you use policy routing (see below), this applies only to fax jobs that do not have a tty set by faxrunqd.policy.</p>
  </dd>
  <dt>
    <p><strong>faxrunqd-log [filename]</strong></p>
  </dt>
  <dd>
    <p>Specifies where logging information is written to.  This is only used if <em>faxrunqd</em> is called with the <strong>-v</strong> or <strong>-d</strong> option.</p>
  </dd>
  <dt>
    <p><strong>policy-config [filename]</strong></p>
  </dt>
  <dd>
    <p>Specifies a file containing rules for "policy routing", see below. Default is "no file".</p>
  </dd>
  <dt>
    <p><strong>faxrunqd-max-pages [n]</strong></p>
  </dt>
  <dd>
    <p>If this is set to something greater 1 (default is 10), <em>faxrunqd</em> will combine multiple jobs to the same receipient telephone number into one telephone call.  The maximum number of pages that the resulting job may have is specified here.  Usually it makes no sense to increase this, but in some surroundings it might make sense to turn off this feature by setting it to 1.</p>
  </dd>
  <dt>
    <p><strong>sendfax-tty-map [tty] [program path] [args]</strong></p>
  </dt>
  <dd>
    <p>Some special cases might require running a non-default <em>sendfax</em> binary for specific ttys (like "testing new version" or "some other call-compatible sendfax applications for non-class-2 modems").  If you want mappings for more than one "special" tty devices, just use the option multiple times.  Example:</p><p>sendfax-tty-map capi0 /usr/sbin/sendfax.capi</p>
  </dd>
  <dt>
    <p><strong>queue-length-high [number] [program path] [args]</strong></p>
  </dt>
  <dd>
    <p>run the specified command when the number of jobs in the fax queue exceeds <em>number</em> (this could be used to send out a warning by syslog or e-mail when too many modems fail on a busy system, and faxes get stuck).  The script will be run only once, unless the queue length falls below the ``low water mark'' threshold and rises again later on.</p>
  </dd>
  <dt>
    <p><strong>queue-length-low [number] [program path] [args]</strong></p>
  </dt>
  <dd>
    <p>run the specified command when the queue length has been over the ``high water'' threshold, and is back below this number.  This can be used to send ``everything is back to normal'' e-mails, or just to reset the alarm threshold.</p>
  </dd>
  <dt>
    <p><strong>modem-error-threshold [number] [program path] [args]</strong></p>
  </dt>
  <dd>
    <p>this script is called whenever a given modem has more than <em>number</em> consecutive errors.  Every successfully sent fax always resets the counter for a given modem to 0.  This can be used to notify the sysadmin when a modem breaks (by default, <em>faxrunqd</em> just phases out a problematic modem, but will not report the problem).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">POLICY ROUTING</h2>
        <div class="sectioncontent">
<p><em>faxrunqd</em> can do some things differently, depending on the phone number where the fax is supposed to be sent to.  For example, this might be useful to:</p><p>- send in-house faxes over a specific modem connected to a PABX (to avoid paying telco charges)</p><p>- send long-distance faxes to the US over a special LD provider, that is, use a specific dial-prefix for those</p><p>- use extra high debugging when sending to a known-to-be problematic receipient</p><p>etc.</p><p>This feature is controlled by a file, containing match / substitute rules.  The name of the file is specified with the "policy-config" option in faxrunq.config.</p><p>The file is read from top to bottom.  Each line starting with a "#" sign is a comment, and is skipped.  In every other line, the first field of the line is interpreted as a "match" clause, and compared to the telefone number of an to-be-sent fax job.  Regular expressions can be used (see <strong>perlre</strong>(1)).</p><p>If the telefone number is matched, the second field is used to substitute parts of the telefone number, for example, cut off a local prefix, or change a digit, or whatever.  If you do not want any substitutions, put a "-" in that field.</p><p>The third field specifies the tty lines to use for faxes matched by this line (for example, you might have one modem connected to a long-distance provider, and others for local use or so).  Put a "-" in this field if you want to use the default fax modems.</p><p>The remaining part of the line are appended to the sendfax command line. With those, you can set a different dial-string ("-D ATD"), or a higher debug level ("-x 9"), or whatever else you can imagine. Do NOT set a tty to use here ("-l ttyS1"), because that would confuse the internal tty handling of <em>faxrunqd,</em> leading to weird effects processing the fax queue!!</p><p>Examples:</p><p># 12345-nnn is sent to "nnn" over a local PABX, modem on tty2</p><p>^12345		s/12345//	tty2</p><p># fax to 56789 (exact match) is sent with higher debugging</p><p>^56789$		-		-	-x 8</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>/var/spool/fax/outgoing/stop</strong></p>
  </dt>
  <dd>
    <p>if this file exists, <em>faxrunqd</em> will stop whatever it's doing at the moment, wait for all outstanding jobs, and then fall asleep until the file is removed.  You can use this to stop queue processing while testing something, or if you know that the modem(s) are unavailable and do not want to run into any error messages, etc.</p>
  </dd>
  <dt>
    <p><strong>/var/spool/fax/outgoing/faxqueue_done</strong></p>
  </dt>
  <dd>
    <p>Every time <em>faxrunqd</em> runs the fax queue, a time stamp is written into that file. It is used by <em>faxspool</em> to display a warning if the queue hasn't been run recently (so faxes may get stuck).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SIGNALS</h2>
        <div class="sectioncontent">
<p>To control <em>faxrunqd's</em> behaviour, you can send it the following signals:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>SIGINT</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>SIGTERM</strong></p>
  </dt>
  <dd>
    <p>remove lock file, remove pid file, terminate immediately.</p>
  </dd>
  <dt>
    <p><strong>SIGHUP</strong></p>
  </dt>
  <dd>
    <p>finish all fax jobs that are currently being sent, then terminate  (this is used to signal faxrunqd "I want you to terminate" without disturbing the normal flow of operation - SIGINT/TERM etc. can lead to some faxes being sent twice).</p>
  </dd>
  <dt>
    <p><strong>SIGUSR1</strong></p>
  </dt>
  <dd>
    <p>close, roll, and re-open log file.</p>
  </dd>
  <dt>
    <p><strong>SIGUSR2</strong></p>
  </dt>
  <dd>
    <p>dump current modem success/failure statistics to log file.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p><em>faxrunqd</em> does not report if a modem goes bad - instead it will just stop using it (which is good for reliable faxing, but bad for error recovery).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO faxrunqd&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/faxspool.1.html"><strong>faxspool</strong>(1)</a>, <strong>sendfax</strong>(8), <a href="../man1/faxq.1.html"><strong>faxq</strong>(1)</a>, <a href="../man1/faxrunq.1.html"><strong>faxrunq</strong>(1)</a>, <a href="../man5/faxqueue.5.html"><strong>faxqueue</strong>(5)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p><em>faxrunqd</em> is Copyright (C) 1997-2004 by Gert Doering, &lt;gert@greenie.muc.de&gt;.  It was inspired by Bodo Bauer's initial faxrunqd, but completely rewritten.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="faxrcvd.8.html"><span aria-hidden="true">&larr;</span> faxrcvd.8: \*(fx notification script for received facsimile</a></li>
   <li class="next"><a href="faxsend.8.html">faxsend.8: \*(fx facsimile transmit program <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
