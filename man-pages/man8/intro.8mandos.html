<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>intro: Introduction to the mandos system</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Introduction to the mandos system">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="intro (8mandos) manual">
  <meta name="twitter:description" content="Introduction to the mandos system">
  <meta name="twitter:image" content="https://www.carta.tech/images/mandos-intro-8mandos.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8mandos/intro.8mandos.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="intro (8mandos) manual" />
  <meta property="og:description" content="Introduction to the mandos system" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/mandos-intro-8mandos.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">intro<small> (8mandos)</small></h1>
        <p class="lead">Introduction to the mandos system</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8mandos/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8mandos/intro.8mandos.html">
      <span itemprop="name">intro: Introduction to the mandos system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/mandos/">
      <span itemprop="name">mandos</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8mandos/intro.8mandos.html">
      <span itemprop="name">intro: Introduction to the mandos system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This is the the Mandos system, which allows computers to have encrypted root file systems and at the same time be capable of remote and/or unattended reboots.</p><p>The computers run a small client program in the initial RAM disk environment which will communicate with a server over a network. All network communication is encrypted using TLS. The clients are identified by the server using an OpenPGP key; each client has one unique to it. The server sends the clients an encrypted password. The encrypted password is decrypted by the clients using the same OpenPGP key, and the password is then used to unlock the root file system, whereupon the computers can continue booting normally.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INTRODUCTION</h2>
        <div class="sectioncontent">
<p>You know how it is. You\(cqve heard of it happening. The Man comes and takes away your servers, your friends\(cq servers, the servers of everybody in the same hosting facility. The servers of their neighbors, and their neighbors\(cq friends. The servers of people who owe them money. And like <em>that</em>, they\(cqre gone. And you doubt you\(cqll ever see them again.</p><p>That is why your servers have encrypted root file systems. However, there\(cqs a downside. There\(cqs no going around it: rebooting is a pain. Dragging out that rarely-used keyboard and screen and unraveling cables behind your servers to plug them in to type in that password is messy, especially if you have many servers. There are some people who do clever things like using serial line consoles and daisy-chain it to the next server, and keep all the servers connected in a ring with serial cables, which will work, if your servers are physically close enough. There are also other out-of-band management solutions, but with <em>all</em> these, you still have to be on hand and manually type in the password at boot time. Otherwise the server just sits there, waiting for a password.</p><p>Wouldn\(cqt it be great if you could have the security of encrypted root file systems and still have servers that could boot up automatically if there was a short power outage while you were asleep? That you could reboot at will, without having someone run over to the server to type in the password?</p><p>Well, with Mandos, you (almost) can! The gain in convenience will only be offset by a small loss in security. The setup is as follows:</p><p>The server will still have its encrypted root file system. The password to this file system will be stored on another computer (henceforth known as the Mandos server) on the same local network. The password will <em>not</em> be stored in plaintext, but encrypted with OpenPGP. To decrypt this password, a key is needed. This key (the Mandos client key) will not be stored there, but back on the original server (henceforth known as the Mandos client) in the initial RAM disk image. Oh, and all network Mandos client/server communications will be encrypted, using TLS (SSL).</p><p>So, at boot time, the Mandos client will ask for its encrypted data over the network, decrypt it to get the password, use it to decrypt the root file, and continue booting.</p><p>Now, of course the initial RAM disk image is not on the encrypted root file system, so anyone who had physical access could take the Mandos client computer offline and read the disk with their own tools to get the authentication keys used by a client. <em>But</em>, by then the Mandos server should notice that the original server has been offline for too long, and will no longer give out the encrypted key. The timing here is the only real weak point, and the method, frequency and timeout of the server\(cqs checking can be adjusted to any desired level of paranoia</p><p>(The encrypted keys on the Mandos server is on its normal file system, so those are safe, provided the root file system of <em>that</em> server is encrypted.)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FREQUENTLY ASKED QUESTIONS</h2>
        <div class="sectioncontent">
<p>Couldn\(cqt the security be defeated by...</p><h3>Grabbing the Mandos client key from the initrd \fIreally quickly\fR?</h3>
<p>This, as mentioned above, is the only real weak point. But if you set the timing values tight enough, this will be really difficult to do. An attacker would have to physically disassemble the client computer, extract the key from the initial RAM disk image, and then connect to a <em>still online</em> Mandos server to get the encrypted key, and do all this <em>before</em> the Mandos server timeout kicks in and the Mandos server refuses to give out the key to anyone.</p><p>Now, as the typical procedure seems to be to barge in and turn off and grab <em>all</em> computers, to maybe look at them months later, this is not likely. If someone does that, the whole system <em>will</em> lock itself up completely, since Mandos servers are no longer running.</p><p>For sophisticated attackers who <em>could</em> do the clever thing, <em>and</em> had physical access to the server for enough time, it would be simpler to get a key for an encrypted file system by using hardware memory scanners and reading it right off the memory bus.</p>
<h3>Replay attacks?</h3>
<p>Nope, the network stuff is all done over TLS, which provides protection against that.</p>
<h3>Man-in-the-middle?</h3>
<p>No. The server only gives out the passwords to clients which have <em>in the TLS handshake</em> proven that they do indeed hold the OpenPGP private key corresponding to that client.</p>
<h3>Physically grabbing the Mandos server computer?</h3>
<p>You could protect <em>that</em> computer the old-fashioned way, with a must-type-in-the-password-at-boot method. Or you could have two computers be the Mandos server for each other.</p><p>Multiple Mandos servers can coexist on a network without any trouble. They do not clash, and clients will try all available servers. This means that if just one reboots then the other can bring it back up, but if both reboot at the same time they will stay down until someone types in the password on one of them.</p>
<h3>Faking checker results?</h3>
<p>If the Mandos client does not have an SSH server, the default is for the Mandos server to use &ldquo;fping&rdquo;, the replies to which could be faked to eliminate the timeout. But this could easily be changed to any shell command, with any security measures you like. If the Mandos client <em>has</em> an SSH server, the default configuration (as generated by <strong>mandos-keygen</strong> with the <strong>--password</strong> option) is for the Mandos server to use an <strong>ssh-keyscan</strong> command with strict keychecking, which can not be faked. Alternatively, IPsec could be used for the ping packets, making them secure.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SECURITY</h2>
        <div class="sectioncontent">
<p>So, in summary: The only weakness in the Mandos system is from people who have:</p><p>The power to come in and physically take your servers, <em>and</em></p><p>The cunning and patience to do it carefully, one at a time, and <em>quickly</em>, faking Mandos client/server responses for each one before the timeout.</p><p>While there are some who may be threatened by people who have <em>both</em> these attributes, they do not, probably, constitute the majority.</p><p>If you <em>do</em> face such opponents, you must figure that they could just as well open your servers and read the file system keys right off the memory by running wires to the memory bus.</p><p>What Mandos is designed to protect against is <em>not</em> such determined, focused, and competent attacks, but against the early morning knock on your door and the sudden absence of all the servers in your server room. Which it does nicely.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PLUGINS</h2>
        <div class="sectioncontent">
<p>In the early designs, the <strong>mandos-client</strong>(8mandos) program (which retrieves a password from the Mandos server) also prompted for a password on the terminal, in case a Mandos server could not be found. Other ways of retrieving a password could easily be envisoned, but this multiplicity of purpose was seen to be too complex to be a viable way to continue. Instead, the original program was separated into <strong>mandos-client</strong>(8mandos) and <strong>password-prompt</strong>(8mandos), and a <strong>plugin-runner</strong>(8mandos) exist to run them both in parallel, allowing the first successful plugin to provide the password. This opened up for any number of additional plugins to run, all competing to be the first to find a password and provide it to the plugin runner.</p><p>Four additional plugins are provided:</p><p><strong>plymouth</strong>(8mandos)</p><p>This prompts for a password when using <a href="../man8/plymouth.8.html"><strong>plymouth</strong>(8)</a>.</p><p><strong>usplash</strong>(8mandos)</p><p>This prompts for a password when using <strong>usplash</strong>(8).</p><p><strong>splashy</strong>(8mandos)</p><p>This prompts for a password when using <strong>splashy</strong>(8).</p><p><strong>askpass-fifo</strong>(8mandos)</p><p>To provide compatibility with the "askpass" program from cryptsetup, this plugin listens to the same FIFO as askpass would do.</p><p>More plugins can easily be written and added by the system administrator; see the section called "WRITING PLUGINS" in <strong>plugin-runner</strong>(8mandos) to learn the plugin requirements.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO intro&hellip;</h2>
        <div class="sectioncontent">
<p><strong>mandos</strong>(8), <a href="../man5/mandos.conf.5.html"><strong>mandos.conf</strong>(5)</a>, <a href="../man5/mandos-clients.conf.5.html"><strong>mandos-clients.conf</strong>(5)</a>, <a href="../man8/mandos-ctl.8.html"><strong>mandos-ctl</strong>(8)</a>, <strong>mandos-monitor</strong>(8), <strong>plugin-runner</strong>(8mandos), <strong>mandos-client</strong>(8mandos), <strong>password-prompt</strong>(8mandos), <strong>plymouth</strong>(8mandos), <strong>usplash</strong>(8mandos), <strong>splashy</strong>(8mandos), <strong>askpass-fifo</strong>(8mandos), <a href="../man8/mandos-keygen.8.html"><strong>mandos-keygen</strong>(8)</a></p><p>\m[blue]<strong>Mandos</strong>\m[]\s-2\u[1]\d\s+2</p><p>The Mandos home page.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2011-2012 Teddy Hogeborn, Bj\(:orn P\(oahlsson</p><p>This manual page is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p><p>This manual page is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p><p>You should have received a copy of the GNU General Public License along with this program. If not, see \m[blue]<strong>http://www.gnu.org/licenses/</strong>\m[].</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
     1.
  </dt>
  <dd>
    <p>Mandos</p><p>http://www.recompile.se/mandos</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="askpass-fifo.8mandos.html"><span aria-hidden="true">&larr;</span> askpass-fifo.8mandos: Mandos plugin to get a password from a fifo.</a></li>
   <li class="next"><a href="mandos-client.8mandos.html">mandos-client.8mandos: Client for mandos <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
