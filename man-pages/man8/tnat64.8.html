<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>tnat64: Library for intercepting outgoing network connections and redirecting them through the nat64.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Library for intercepting outgoing network connections and redirecting them through the nat64.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="tnat64 (8) manual">
  <meta name="twitter:description" content="Library for intercepting outgoing network connections and redirecting them through the nat64.">
  <meta name="twitter:image" content="https://www.carta.tech/images/tnat64-tnat64-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/tnat64.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="tnat64 (8) manual" />
  <meta property="og:description" content="Library for intercepting outgoing network connections and redirecting them through the nat64." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/tnat64-tnat64-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">tnat64<small> (8)</small></h1>
        <p class="lead">Library for intercepting outgoing network connections and redirecting them through the nat64.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/tnat64.8.html">
      <span itemprop="name">tnat64: Library for intercepting outgoing network connections and redirecting them through the nat64.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/tnat64/">
      <span itemprop="name">tnat64</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/tnat64.8.html">
      <span itemprop="name">tnat64: Library for intercepting outgoing network connections and redirecting them through the nat64.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>Set LD_PRELOAD to load the library then use applications as normal</p><p>The syntax to force preload of the library for different shells is specified below:</p><p>Bash, Ksh and Bourne shell -</p><p>export LD_PRELOAD=/usr/lib/tnat64/libtnat64.so</p><p>C Shell -</p><p>setenv LD_PRELOAD=/usr/lib/tnat64/libtnat64.so</p><p>This process can be automated (for Bash, Bourne and Korn shell users) for a single command or for all commands in a shell session by using the <a href="../man1/tnat64.1.html"><strong>tnat64</strong>(1)</a> script</p><p>You can also setup tnat64 in such a way that all processes automatically use it, a very useful configuration. For more information on this configuration see the CAVEATS section of this manual page.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>tnat64</strong> is a library to allow IPv4-only application to access IPv4 hosts on IPv6-only systems by using NAT64. It wraps the normal connect() function. When a connection is attempted, it consults the configuration file (which is defined at configure time but defaults to /etc/tnat64.conf) and determines if the IP address specified is local. If it is not, the library redirects the connection to an IPv6 address inside the NAT64 prefix that is specified in the configuration file. The redirection is performed only if the destination host is unreachable (when there's no route to host). Also, after the first successful redirection all the following connection attempts are redirected immediately without even trying to connect to the host via IPv4. When the destination host cannot be reached via IPv6, the redirection is disabled.</p><p><strong>tnat64</strong> avoids the need to recompile applications so they can use reach hosts even if they do not support IPv6 and there's no IPv4 connectivity.</p><p><strong>tnat64</strong> is heavily based on the source code of tsocks, a library that intercepts outgoing TCP connections and redirects them though SOCKS proxy. Many thanks for tsocks author, Shaun Clowes!</p><h3>ARGUMENTS</h3>
<p>Most arguments to <strong>tnat64</strong> are provided in the configuration file (the location of which is defined at configure time by the --with-conf=&lt;file&gt; argument but defaults to /etc/tnat64.conf). The structure of this file is documented in <strong>tnat64.conf</strong>(8)</p><p>Some configuration options can be specified at run time using environment variables as follows:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>TNAT64_CONF_FILE</em></p>
  </dt>
  <dd>
    <p>This environment variable overrides the default location of the tnat64 configuration file. This variable is not honored if the program tnat64 is embedded in is setuid. In addition this environment variable can be compiled out of tnat64 with the --disable-envconf argument to configure at build time</p>
  </dd>
  <dt>
    <p><em>TNAT64_DEBUG</em></p>
  </dt>
  <dd>
    <p>This environment variable sets the level of debug output that should be generated by tnat64 (debug output is generated in the form of output to standard error). If this variable is not present by default the logging level is set to 0 which indicates that only error messages should be output. Setting it to higher values will cause tnat64 to generate more messages describing what it is doing. If set to -1 tnat64 will output absolutely no error or debugging messages. This is only needed if tnat64 output interferes with a program it is embedded in. Message output can be permanently compiled out of tnat64 by specifying the --disable-debug option to configure at build time</p>
  </dd>
  <dt>
    <p><em>TNAT64_DEBUG_FILE</em></p>
  </dt>
  <dd>
    <p>This option can be used to redirect the tnat64 output (which would normally be sent to standard error) to a file. This variable is not honored if the program tnat64 is embedded in is setuid. For programs where tnat64 output interferes with normal operation this option is generally better than disabling messages (with TNAT64_DEBUG = -1)</p>
  </dd>

</dl>

<h3>ERRORS</h3>
<p><strong>tnat64</strong> will generate error messages and print them to stderr when there are problems with the configuration file if the TNAT64_DEBUG environment variable is not set to -1 or and --disable-debug was not specified at compile time. This output may cause some problems with programs that redirect standard error.</p>
<h3>CAVEATS</h3>
<p><strong>tnat64</strong> will not in the above configuration be able to provide proxying to setuid applications or applications that are not run from a shell. You can force all applications to LD_PRELOAD the library by placing the path to libtnat64 in /etc/ld.so.preload. Please make sure you correctly enter the full path to the library in this file if you do this. If you get it wrong, you will be UNABLE TO DO ANYTHING with the machine and will have to boot it with a rescue disk and remove the file (or try the saveme program, see the INSTALL file for more info).  THIS IS A ***WARNING***, please be careful. Also be sure the library is in the root filesystem as all hell will break loose if the directory it is in is not available at boot time.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p><strong>tnat64</strong> can only proxy outgoing TCP connections</p><p><strong>tnat64</strong> does NOT work correctly with asynchronous sockets (though it does work with non blocking sockets). This bug would be very difficult to fix and there appears to be no demand for it (I know of no major application that uses asynchronous sockets)</p><p><strong>tnat64</strong> uses ELF dynamic loader features to intercept dynamic function calls from programs in which it is embedded.  As a result, it cannot trace the actions of statically linked executables, non-ELF executables, or executables that make system calls directly with the system call trap or through the syscall() routine.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/etc/tnat64.conf - default tnat64 configuration file</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO tnat64&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/tnat64.conf.5.html"><strong>tnat64.conf</strong>(5)</a> <a href="../man1/tnat64.1.html"><strong>tnat64</strong>(1)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Andrew O. Shadura (bugzilla@tut.by), Shaun Clowes (delius@progsoc.uts.edu.au)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright 2011 Andrew O. Shadura</p><p>Original tsocks manual page, copyright 2000 Shaun Clowes</p><p>tnat64 and its documentation may be freely copied under the terms and conditions of version 2 of the GNU General Public License, as published by the Free Software Foundation (Cambridge, Massachusetts, United States of America).</p><p>This documentation is heavily based on the documentation for tsocks, transparent SOCKSification library, whose documentation itself is based on the documentation for logwrites, another shared library interceptor. One line of code from it was used in tsocks and a lot of the documentation :) logwrites is by adam@yggdrasil.com (Adam J. Richter) and can be had from ftp.yggdrasil.com pub/dist/pkg</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="tmpreaper.8.html"><span aria-hidden="true">&larr;</span> tmpreaper.8: Removes files which haven't been accessed for a period of time</a></li>
   <li class="next"><a href="tntnet.8.html">tntnet.8: Web application server for c++ <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
