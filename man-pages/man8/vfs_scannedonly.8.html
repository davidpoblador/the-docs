<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>vfs_scannedonly: Ensures that only files that have been scanned for viruses are visible and accessible to the end user.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Ensures that only files that have been scanned for viruses are visible and accessible to the end user.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="vfs_scannedonly (8) manual">
  <meta name="twitter:description" content="Ensures that only files that have been scanned for viruses are visible and accessible to the end user.">
  <meta name="twitter:image" content="https://www.carta.tech/images/samba-vfs-modules-vfs_scannedonly-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/vfs_scannedonly.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="vfs_scannedonly (8) manual" />
  <meta property="og:description" content="Ensures that only files that have been scanned for viruses are visible and accessible to the end user." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/samba-vfs-modules-vfs_scannedonly-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">vfs_scannedonly<small> (8)</small></h1>
        <p class="lead">Ensures that only files that have been scanned for viruses are visible and accessible to the end user.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/vfs_scannedonly.8.html">
      <span itemprop="name">vfs_scannedonly: Ensures that only files that have been scanned for viruses are visible and accessible to the end user.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/samba-vfs-modules/">
      <span itemprop="name">samba-vfs-modules</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/vfs_scannedonly.8.html">
      <span itemprop="name">vfs_scannedonly: Ensures that only files that have been scanned for viruses are visible and accessible to the end user.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>vfs objects = scannedonly</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This VFS module is part of the <a href="../man8/samba.8.html"><strong>samba</strong>(8)</a> suite.</p><p>The vfs_scannedonly VFS module ensures that only files that have been scanned for viruses are visible and accessible to the end user. If non-scanned files are found an anti-virus scanning daemon is notified. The anti-virus scanning daemon is not part of the Samba suite.</p><p>Scannedonly comes in two parts: a samba vfs module and (one or more) daemons. The daemon scans files. If a certain file is clean, a second file is created with prefix .scanned:. The Samba module simply looks if such a .scanned: file exists, and is newer than the pertinent file. If this is the case, the file is shown to the user. If this is not the case, the file is not returned in a directory listing (configurable), and cannot be opened (configurable). The Samba vfs module will notify the daemon to scan this file.</p><p>So what happens for the user in the default configuration. The first time a directory is listed, it shows files as &apos;file is being scanned for viruses, but after the first time all files are shown. There is a utility scannedonly_prescan that can help you to prescan all directories. When new files are written the daemon is notified immediately after the file is complete.</p><p>If a virus is found by the daemon, a file with a warning message is created in the directory of the user, a warning is sent to the logs, and the file is renamed to have prefix .virus:. Files with the .virus: prefix are never shown to the user and all access is denied.</p><p>This module is stackable.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION</h2>
        <div class="sectioncontent">
<p>vfs_scannedonly relies on a anti-virus scanning daemon that listens on the scannedonly socket (unix domain socket or UDP socket).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>scannedonly:domain_socket = True</p><p>Whether to use a unix domain socket or not (false reverts to use udp)</p><p>scannedonly:socketname = /var/lib/scannedonly/scan</p><p>The location of the unix domain socket to connect to</p><p>scannedonly:portnum = 2020</p><p>The udp port number to connect to</p><p>scannedonly:scanhost = localhost</p><p>When using UDP the host that runs the scanning daemon (this host needs access to the files!)</p><p>scannedonly:show_special_files = True</p><p>Whether sockets, devices and fifo&apos;s (all not scanned for viruses) should be visible to the user</p><p>scannedonly:rm_hidden_files_on_rmdir = True</p><p>Whether files that are not visible (.scanned: files, .failed: files and .virus: files) should be deleted if the user tries to remove the directory. If false, the user will get the "directory is not empty" error.</p><p>scannedonly:hide_nonscanned_files = True</p><p>If false, all non-scanned files are visible in directory listings. If such files are found in a directory listing the scanning daemon is notified that scanning is required. Access to non-scanned files is still denied (see scannedonly:allow_nonscanned_files).</p><p>scannedonly:scanning_message = is being scanned for viruses</p><p>If non-scanned files are hidden (if scannedonly:hide_nonscanned_files = True), a fake 0 byte file is shown. The filename is the original filename with the message as suffix.</p><p>scannedonly:recheck_time_open = 50</p><p>If a non-scanned file is opened, the vfs module will wait recheck_tries_open times for recheck_time_open milliseconds for the scanning daemon to create a .scanned: file. For small files that are scanned by the daemon within the time (tries * time) the behavior will be just like on-access scanning.</p><p>scannedonly:recheck_tries_open = 100</p><p>See recheck_time_open.</p><p>scannedonly:recheck_time_readdir = 50</p><p>If a non-scanned file is in a directory listing the vfs module notifies the daemon (once for all files that need scanning in that directory), and waits recheck_tries_readdir times for recheck_time_readdir milliseconds. Only used when hide_nonscanned_files is false.</p><p>scannedonly:recheck_tries_readdir = 20</p><p>See recheck_time_readdir.</p><p>scannedonly:allow_nonscanned_files = False</p><p>Allow access to non-scanned files. The daemon is notified, however, and special files such as .scanned: files. .virus: files and .failed: files are not listed.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Enable anti-virus scanning:</p>
<pre>
        <em>[homes]</em>
	\m[blue]<strong>vfs objects = scannedonly</strong>\m[]
	\m[blue]<strong>scannedonly:hide_nonscanned_files = False</strong>\m[]
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CAVEATS</h2>
        <div class="sectioncontent">
<p>This is not true on-access scanning. However, it is very fast for files that have been scanned already.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>This man page is correct for version 4.0.0 of the Samba suite.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>The original Samba software and related utilities were created by Andrew Tridgell. Scannedonly was developed for Samba by Olivier Sessink. Samba is now developed by the Samba Team as an Open Source project similar to the way the Linux kernel is developed.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="vfs_recycle.8.html"><span aria-hidden="true">&larr;</span> vfs_recycle.8: Samba vfs recycle bin</a></li>
   <li class="next"><a href="vfs_shadow_copy.8.html">vfs_shadow_copy.8: Make a samba share read only for a specified time period <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
