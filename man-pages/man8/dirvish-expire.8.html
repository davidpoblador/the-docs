<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>dirvish-expire: Delete expired dirvish images</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Delete expired dirvish images">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="dirvish-expire (8) manual">
  <meta name="twitter:description" content="Delete expired dirvish images">
  <meta name="twitter:image" content="https://www.carta.tech/images/dirvish-dirvish-expire-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/dirvish-expire.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="dirvish-expire (8) manual" />
  <meta property="og:description" content="Delete expired dirvish images" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/dirvish-dirvish-expire-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">dirvish-expire<small> (8)</small></h1>
        <p class="lead">Delete expired dirvish images</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/dirvish-expire.8.html">
      <span itemprop="name">dirvish-expire: Delete expired dirvish images</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/dirvish/">
      <span itemprop="name">dirvish</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/dirvish-expire.8.html">
      <span itemprop="name">dirvish-expire: Delete expired dirvish images</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>dirvish-expire</strong><em>[OPTIONS]</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Delete dirvish image trees or whole images that have expired.</p><p>Each image <strong>summary</strong> file is checked for the <strong>Expire:</strong> field. If that field indicates the image has expired <strong>dirvish-expire</strong> will delete that image from the vault.</p><p>By default all subdirectories of all banks will be treated as vaults and all directories therein except the one named <strong>dirvish</strong> will be checked for summary files.</p><p>The removal of an image will have no effect on other images.</p><p><strong>Dirvish-expire</strong> will not delete an image unless it finds at least one image in that branch that has an intact image tree and <strong>Status: success</strong> in the summary that is not expired.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>Each option on the command line may be specified any number of times. Those options that support lists in the config files will accumulate all of their arguments otherwise each specification will override the ones before.</p><p>Each option may be unambiguously abbreviated.</p>
<dl class='dl-vertical'>
  <dt>
    <p>&#92;.BI \*d&#92;$1 " &#92;$2"</p>
  </dt>
  <dd>
    <p>Execute as though <em>time_expression</em> were the current time.</p><p><em>Time_expression</em> is processed by <strong>Time::Parsedate(3pm)</strong> so relative time and date strings are permitted. See <strong>&#92;$1</strong> for more details.</p>
  </dd>
  <dt>
    <p>&#92;.B \*d&#92;$1</p>
  </dt>
  <dd>
    <p>Only delete the image tree, leave in place the rest of the image directory with summary, log and any other image administrative files.</p>
  </dd>
  <dt>
    <p>Restrict expiration to the specified</p>
  </dt>
  <dd>
    <p><em>vault</em>.</p>
  </dd>
  <dt>
    <p>Don't actually do anything.</p>
  </dt>
  <dd>
    <p>Just display what would have happened.</p>
  </dd>
  <dt>
    <p>Run quietly, only report errors.</p>
  </dt>
  <dd>
    <p>Normally <strong>dirvish-expire</strong> will report the images deleted.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT CODES</h2>
        <div class="sectioncontent">
<p>To facilitate further automation and integration of <strong>dirvish-expire</strong> with other tools <strong>dirvish-expire</strong> provides rationalised exit codes. The exit codes are range based.  While the code for a specific error may change from one version to another it will remain within the specified range.  So don't test for specific exit codes but instead test for a range of values. To the degree possible higher value ranges indicate more severe errors.</p>
<dl class='dl-vertical'>
  <dt>
    <p>0</p>
  </dt>
  <dd>
    <p>success</p>
  </dd>
  <dt>
    <p>200-219</p>
  </dt>
  <dd>
    <p>An error was encountered in loading a configuration file.</p>
  </dd>
  <dt>
    <p>220-254</p>
  </dt>
  <dd>
    <p>An error was detected in the configuration.</p>
  </dd>
  <dt>
    <p>255</p>
  </dt>
  <dd>
    <p>Incorrect usage.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>/etc/dirvish/master.conf</strong></p>
  </dt>
  <dd>
    <p>alternate master configuration file.</p>
  </dd>
  <dt>
    <p><strong>/etc/dirvish.conf</strong></p>
  </dt>
  <dd>
    <p>master configuration file.</p>
  </dd>
  <dt>
    <p><em>bank/vault/image/</em><strong>summary</strong></p>
  </dt>
  <dd>
    <p>image creation summary.</p>
  </dd>
  <dt>
    <p><em>bank/vault/image/</em><strong>tree</strong></p>
  </dt>
  <dd>
    <p>actual image of source directory tree.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO dirvish-expire&hellip;</h2>
        <div class="sectioncontent">

<pre>
<strong>dirvish.conf</strong>(5)
Time::ParseDate(3pm)
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p><strong>Dirvish-expire</strong> will walk the file hierarchy of all banks or the specified vault looking for summary files. Anything non-dirvish in there may cause excess file-walking.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="dirvish.8.html"><span aria-hidden="true">&larr;</span> dirvish.8: Disk based virtual image network backup system</a></li>
   <li class="next"><a href="dirvish-runall.8.html">dirvish-runall.8: Run a set of dirvish backup jobs. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
