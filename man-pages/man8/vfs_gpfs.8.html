<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>vfs_gpfs: Gpfs specific samba extensions like acls and prealloc</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Gpfs specific samba extensions like acls and prealloc">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="vfs_gpfs (8) manual">
  <meta name="twitter:description" content="Gpfs specific samba extensions like acls and prealloc">
  <meta name="twitter:image" content="https://www.carta.tech/images/samba-vfs-modules-vfs_gpfs-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/vfs_gpfs.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="vfs_gpfs (8) manual" />
  <meta property="og:description" content="Gpfs specific samba extensions like acls and prealloc" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/samba-vfs-modules-vfs_gpfs-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">vfs_gpfs<small> (8)</small></h1>
        <p class="lead">Gpfs specific samba extensions like acls and prealloc</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/vfs_gpfs.8.html">
      <span itemprop="name">vfs_gpfs: Gpfs specific samba extensions like acls and prealloc</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/samba-vfs-modules/">
      <span itemprop="name">samba-vfs-modules</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/vfs_gpfs.8.html">
      <span itemprop="name">vfs_gpfs: Gpfs specific samba extensions like acls and prealloc</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>vfs objects = gpfs</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This VFS module is part of the <a href="../man7/samba.7.html"><strong>samba</strong>(7)</a> suite.</p><p>The gpfs VFS module is the home for all gpfs extensions that Samba requires for proper integration with GPFS. It uses the GPL library interfaces provided by GPFS.</p><p>Currently the gpfs vfs module provides extensions in following areas :</p><p>NFSv4 ACL Interfaces with configurable options for GPFS</p><p>Kernel oplock support on GPFS</p><p>Lease support on GPFS</p><p>NOTE:This module follows the posix-acl behaviour and hence allows permission stealing via chown. Samba might allow at a later point in time, to restrict the chown via this module as such restrictions are the responsibility of the underlying filesystem than of Samba.</p><p>This module makes use of the smb.conf parameter \m[blue]<strong>acl map full control = acl map full control</strong>\m[] When set to yes (the default), this parameter will add in the FILE_DELETE_CHILD bit on a returned ACE entry for a file (not a directory) that already contains all file permissions except for FILE_DELETE and FILE_DELETE_CHILD. This can prevent Windows applications that request GENERIC_ALL access from getting ACCESS_DENIED errors when running against a filesystem with NFSv4 compatible ACLs.</p><p>This module is stackable.</p><p>Since Samba 4.0 all options are per share options.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>gpfs:sharemodes = [ yes | no ]</p><p>Enable/Disable cross node sharemode handling for GPFS.</p><p>yes(default) - propagate sharemodes across all GPFS nodes.</p><p>no - do not propagate sharemodes across all GPFS nodes. This should only be used if the GPFS file system is exclusively exported by Samba. Access by local unix application or NFS exports could lead to corrupted files.</p><p>gpfs:leases = [ yes | no ]</p><p>Enable/Disable cross node leases (oplocks) for GPFS. You should also set the oplocks and kernel oplocks options to the same value.</p><p>yes(default) - propagate leases across all GPFS nodes.</p><p>no - do not propagate leases across all GPFS nodes. This should only be used if the GPFS file system is exclusively exported by Samba. Access by local unix application or NFS exports could lead to corrupted files.</p><p>gpfs:hsm = [ yes | no ]</p><p>Enable/Disable announcing if this FS has HSM enabled.</p><p>no(default) - Do not announce HSM.</p><p>yes - Announce HSM.</p><p>gpfs:getrealfilename = [ yes | no ]</p><p>Enable/Disable usage of the gpfs_get_realfilename_path() function. This improves the casesensitive wildcard file name access.</p><p>yes(default) - use gpfs_get_realfilename_path().</p><p>no - do not use gpfs_get_realfilename_path(). It seems that gpfs_get_realfilename_path() doesn&apos;t work on AIX.</p><p>gpfs:winattr = [ yes | no ]</p><p>Enable/Disable usage of the windows attributes in GPFS. GPFS is able to store windows file attributes e.g. HIDDEN, READONLY, SYSTEM and others natively. That means Samba doesn&apos;t need to map them to permission bits or extended attributes.</p><p>no(default) - do not use GPFS windows attributes.</p><p>yes - use GPFS windows attributes.</p><p>gpfs:merge_writeappend = [ yes | no ]</p><p>GPFS ACLs doesn&apos;t know about the &apos;APPEND&apos; right. This option lets Samba map the &apos;APPEND&apos; right to &apos;WRITE&apos;.</p><p>yes(default) - map &apos;APPEND&apos; to &apos;WRITE&apos;.</p><p>no - do not map &apos;APPEND&apos; to &apos;WRITE&apos;.</p><p>gpfs:acl = [ yes | no ]</p><p>This option lets Samba use or ignore GPFS ACLs.</p><p>yes(default) - use GPFS ACLs.</p><p>no - do not use GPFS ACLs and pass everything to the next SMB_VFS module.</p><p>gpfs:refuse_dacl_protected = [ yes | no ]</p><p>As GPFS does not support the ACE4_FLAG_NO_PROPAGATE NFSv4 flag (which would be the mapping for the DESC_DACL_PROTECTED flag), the status of this flag is currently silently ignored by Samba. That means that if you deselect the "Allow inheritable permissions..." checkbox in Windows&apos; ACL dialog and then apply the ACL, the flag will be back immediately.</p><p>To make sure that automatic migration with e.g. robocopy does not lead to ACLs silently (and unintentionally) changed, you can set gpfs:refuse_dacl_protected = yes to enable an explicit check for this flag and if set, it will return NT_STATUS_NOT_SUPPORTED so errors are shown up on the Windows side and the Administrator is aware of the ACLs not being settable like intended</p><p>no(default) - ignore the DESC_DACL_PROTECTED flags.</p><p>yes - reject ACLs with DESC_DACL_PROTECTED.</p><p>gpfs:dfreequota = [ yes | no ]</p><p>Adjust reporting of the size and free space of a share according to quotas. If this setting is "yes", a request for size and free space will also evaluate the user quota of the user requesting the data, the group quota of the primary group of the user and the fileset quota for the fileset containing the top level directory of the share.</p><p>If any of the soft or hard quota limits has been reached, the free space will be reported as 0. If a quota is in place, but the limits have not been reached, the free space will be reported according to the space left in the quota. If more than one quota applies the free space will be reported as the smallest space left in those quotas. The size of the share will be reported according to the quota usage. If more than one quota applies, the smallest size will be reported for the share size according to these quotas.</p><p>yes - include the quotas when reporting the share size and free space</p><p>no(default) - do not include quotas, simply report the size and free space of the file system</p><p>gpfs:prealloc = [ yes | no ]</p><p>If set to yes the gpfs_prealloc function will be used in the fallocate callback when appropriate. If set to no gpfs_prealloc will not be used. In both cases the system and libc calls are avoided.</p><p>yes (default) - Use gpfs_prealloc for the fallocate callback.</p><p>no - Do not use gpfs_prealloc for the fallocate callback.</p><p>nfs4:mode = [ simple | special ]</p><p>Controls substitution of special IDs (OWNER@ and GROUP@) on GPFS. The use of mode simple is recommended. In this mode only non inheriting ACL entries for the file owner and group are mapped to special IDs.</p><p>The following MODEs are understood by the module:</p><p>simple(default) - use OWNER@ and GROUP@ special IDs for non inheriting ACEs only.</p><p>special(deprecated) - use OWNER@ and GROUP@ special IDs in ACEs for all file owner and group ACEs.</p><p>nfs4:acedup = [dontcare|reject|ignore|merge]</p><p>This parameter configures how Samba handles duplicate ACEs encountered in GPFS ACLs. GPFS allows/creates duplicate ACE for different bits for same ID.</p><p>Following is the behaviour of Samba for different values :</p><p>dontcare (default) - copy the ACEs as they come</p><p>reject - stop operation and exit with error on ACL set op</p><p>ignore - don&apos;t include the second matching ACE</p><p>merge - bitwise OR the 2 ace.flag fields and 2 ace.mask fields of the 2 duplicate ACEs into 1 ACE</p><p>nfs4:chown = [yes|no]</p><p>This parameter allows enabling or disabling the chown supported by the underlying filesystem. This parameter should be enabled with care as it might leave your system insecure.</p><p>Some filesystems allow chown as a) giving b) stealing. It is the latter that is considered a risk.</p><p>Following is the behaviour of Samba for different values :</p><p>yes - Enable chown if as supported by the under filesystem</p><p>no (default) - Disable chown</p><p>gpfs:syncio = [yes|no]</p><p>This parameter makes Samba open all files with O_SYNC. This triggers optimizations in GPFS for workloads that heavily share files.</p><p>Following is the behaviour of Samba for different values:</p><p>yes - Open files with O_SYNC</p><p>no (default) - Open files as normal Samba would do</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>A GPFS mount can be exported via Samba as follows :</p>
<pre>
        <em>[samba_gpfs_share]</em>
	\m[blue]<strong>vfs objects = gpfs</strong>\m[]
	\m[blue]<strong>path = /test/gpfs_mount</strong>\m[]
	\m[blue]<strong>nfs4: mode = special</strong>\m[]
	\m[blue]<strong>nfs4: acedup = merge</strong>\m[]
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CAVEATS</h2>
        <div class="sectioncontent">
<p>Depending on the version of gpfs, the libgpfs_gpl library or the libgpfs library is needed at runtime by the gpfs VFS module: Starting with gpfs 3.2.1 PTF8, the complete libgpfs is available as open source and libgpfs_gpl does no longer exist. With earlier versions of gpfs, only the libgpfs_gpl library was open source and could be used at run time.</p><p>At build time, only the header file gpfs_gpl.h is required , which is a symlink to gpfs.h in gpfs versions newer than 3.2.1 PTF8.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>This man page is correct for version 3.0.25 of the Samba suite.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>The original Samba software and related utilities were created by Andrew Tridgell. Samba is now developed by the Samba Team as an Open Source project similar to the way the Linux kernel is developed.</p><p>The GPFS VFS module was created with contributions from Volker Lendecke and the developers at IBM.</p><p>This manpage was created by the IBM FSCC team</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="vfs_full_audit.8.html"><span aria-hidden="true">&larr;</span> vfs_full_audit.8: Record samba vfs operations in the system log</a></li>
   <li class="next"><a href="vfs_linux_xfs_sgid.8.html">vfs_linux_xfs_sgid.8: Vfs_linux_xfs_sgid <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
