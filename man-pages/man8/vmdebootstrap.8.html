<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>vmdebootstrap: Install basic debian system into virtual disk image</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Install basic debian system into virtual disk image">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="vmdebootstrap (8) manual">
  <meta name="twitter:description" content="Install basic debian system into virtual disk image">
  <meta name="twitter:image" content="https://www.carta.tech/images/vmdebootstrap-vmdebootstrap-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/vmdebootstrap.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="vmdebootstrap (8) manual" />
  <meta property="og:description" content="Install basic debian system into virtual disk image" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/vmdebootstrap-vmdebootstrap-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">vmdebootstrap<small> (8)</small></h1>
        <p class="lead">Install basic debian system into virtual disk image</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/vmdebootstrap.8.html">
      <span itemprop="name">vmdebootstrap: Install basic debian system into virtual disk image</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/vmdebootstrap/">
      <span itemprop="name">vmdebootstrap</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/vmdebootstrap.8.html">
      <span itemprop="name">vmdebootstrap: Install basic debian system into virtual disk image</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>vmdebootstrap</strong> --image=FILE --size=SIZE [--mirror=URL] [--distribution=NAME]</p><p><strong>vmdebootstrap</strong> [--output=FILE] [--verbose | --no-verbose] --image=FILE --size=SIZE [--tarball=FILE] [--mirror=URL] [--arch=ARCH] [--distribution=NAME] [--package=PACKAGE] [--custom-package=DEB] [--no-kernel] [--enable-dhcp | --no-enable-dhcp] [--root-password=PASSWORD] [--customize=SCRIPT] [--hostname=HOSTNAME] [--user=USER/PASSWORD] [--serial-console | --no-serial-console] [--sudo | --no-sudo] [--owner=OWNER] [--bootsize=BOOTSIZE] [--boottype=FSTYPE] [--foreign=PATH] [--variant=VARIANT] [--no-extlinux] [--squash] [--configure-apt] [--grub]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>vmdebootstrap</strong> installs a basic Debian system into a virtual disk image, for use with virtual machines, such as KVM, Qemu, or VirtualBox. It is like <a href="../man8/debootstrap.8.html"><strong>debootstrap</strong>(8)</a>, which does the same thing, but puts the system into a directory, for use with <a href="../man8/chroot.8.html"><strong>chroot</strong>(8)</a>. (In fact, <strong>vmdebootstrap</strong> is a wrapper around <strong>debootstrap</strong>).</p><p>You need to run <strong>vmdebootstrap</strong> as root. If the --verbose option is not used, no output will be sent to the command line. If the --log option is not used, no output will be sent to any log files either.</p><p>To use the image, you probably want to create a virtual machine using your preferred virtualization technology, such as <a href="../man1/kvm.1.html"><strong>kvm</strong>(1)</a>, or <strong>qemu</strong>(1). Configure the virtual machine to use the image you've created. Then start the virtual machine, (see <strong>EXAMPLES</strong> ) and log into it via its console to configure it. The image has an empty root password and will not have networking configured by default. Set the root password before you configure networking.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BOOTLOADERS</h2>
        <div class="sectioncontent">
<p>Unless the --no-extlinux or --grub options are specified, the image will use <a href="../man1/extlinux.1.html"><strong>extlinux</strong>(1)</a> as a boot loader. <strong>bootsize</strong> is not recommended when using <strong>extlinux</strong> - use grub instead. Versions of grub2 in wheezy can fail to install in the VM, at which point vmdebootstrap will fall back to extlinux. It may still be possible to complete the installation of grub2 after booting the VM as the problem may be related to the need to use loopback devices during the grub-install operation. Details of the error will appear in the vmdebootstrap log file, if enabled with the --log option. Note that <strong>grub-legacy</strong> is not supported.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    --output=FILE
  </dt>
  <dd>
    <p>write output to FILE, instead of standard output</p>
  </dd>
  <dt>
    --verbose
  </dt>
  <dd>
    <p>report what is going on</p>
  </dd>
  <dt>
    --image=FILE
  </dt>
  <dd>
    <p>put created disk image in FILE</p>
  </dd>
  <dt>
    --size=SIZE
  </dt>
  <dd>
    <p>create a disk image of size SIZE (1000000000)</p>
  </dd>
  <dt>
    --tarball=FILE
  </dt>
  <dd>
    <p>tar up the disk's contents in FILE</p>
  </dd>
  <dt>
    --mirror=URL
  </dt>
  <dd>
    <p>use MIRROR as package source (http://cdn.debian.net/debian/)</p>
  </dd>
  <dt>
    --arch=ARCH
  </dt>
  <dd>
    <p>architecture to use (amd64)</p>
  </dd>
  <dt>
    --distribution=NAME
  </dt>
  <dd>
    <p>release to use (stable)</p>
  </dd>
  <dt>
    --package=PACKAGE
  </dt>
  <dd>
    <p>install PACKAGE onto system</p>
  </dd>
  <dt>
    --custom-package=DEB
  </dt>
  <dd>
    <p>install package in DEB file onto system (not from mirror)</p>
  </dd>
  <dt>
    --no-kernel
  </dt>
  <dd>
    <p>do not install a linux package</p>
  </dd>
  <dt>
    --enable-dhcp
  </dt>
  <dd>
    <p>enable DHCP on eth0</p>
  </dd>
  <dt>
    --root-password=PASSWORD
  </dt>
  <dd>
    <p>set root password</p>
  </dd>
  <dt>
    --customize=SCRIPT
  </dt>
  <dd>
    <p>run SCRIPT after setting up system. If the script does not exist in the current working directory, /usr/share/vmdebootstrap/examples/ will be checked as a fallback. The script needs to be executable and is passed the root directory of the debootstrap as the only argument. Use chroot if you need to execute binaries within the debootstrap.</p>
  </dd>
  <dt>
    --hostname=HOSTNAME
  </dt>
  <dd>
    <p>set name to HOSTNAME (debian)</p>
  </dd>
  <dt>
    --user=USER/PASSWORD
  </dt>
  <dd>
    <p>create USER with PASSWORD</p>
  </dd>
  <dt>
    --owner=OWNER
  </dt>
  <dd>
    <p>change the owner of the final image from root to the specified user.</p>
  </dd>
  <dt>
    --serial-console
  </dt>
  <dd>
    <p>configure image to use a serial console</p>
  </dd>
  <dt>
    --serial-console-command
  </dt>
  <dd>
    <p>set the command to manage the serial console which will be appended to /etc/inittab. Default is "/sbin/getty -L ttyS0 115200 vt100", resulting in a line <strong>S0:23:respawn:/sbin/getty -L ttyS0 115200 vt100</strong></p>
  </dd>
  <dt>
    --sudo
  </dt>
  <dd>
    <p>install sudo, and if user is created, add them to sudo group</p>
  </dd>
  <dt>
    --bootsize=BOOTSIZE
  </dt>
  <dd>
    <p>If specified, create a /boot partition of the given size within the image. Debootstrapping will fail if this is too small for the selected kernel package.</p>
  </dd>
  <dt>
    --boottype=FSTYPE
  </dt>
  <dd>
    <p>Filesystem to use for the /boot partition. (default ext2)</p>
  </dd>
  <dt>
    --foreign=PATH
  </dt>
  <dd>
    <p>Path to the binfmt_handler to enable foreign support in debootstrap. e.g. /usr/bin/qemu-arm-static - note foreign debootstraps may take a signficant amount of time to complete and that debootstrap will retry five times if packages fail to install by default.</p>
  </dd>
  <dt>
    --no-extlinux
  </dt>
  <dd>
    <p>Skip installation of extlinux. needs a customize script to make the image bootable. Useful for architectures where extlinux is not supportable. Depending on how the image is to be booted, the --mbr option may also be necessary with extlinux.</p>
  </dd>
  <dt>
    --squash
  </dt>
  <dd>
    <p>Run mksquashfs against the final image using xz compression - requires squashfs-tools to be installed. The final file will have the .squashfs suffix. By default, mksquashfs is allowed to use all processors which may result in high load. Run mksquashfs separately if you need to control the number of processors used per run.</p>
  </dd>
  <dt>
    --configure-apt
  </dt>
  <dd>
    <p>Use the specified mirror and distribution to create a suitable apt source inside the VM. Can be useful if debootstrap fails to create it automatically.</p>
  </dd>
  <dt>
    --grub
  </dt>
  <dd>
    <p>Disable extlinux installation and configure grub2 instead. grub2 will be added to the list of packages to install. update-grub will be called once the debootstrap is complete and grub-install will be called in the image.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Configuration files and settings:</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    --dump-config
  </dt>
  <dd>
    <p>write out the entire current configuration</p>
  </dd>
  <dt>
    --no-default-configs
  </dt>
  <dd>
    <p>clear list of configuration files to read</p>
  </dd>
  <dt>
    --config=FILE
  </dt>
  <dd>
    <p>add FILE to config files</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Logging:</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    --log=FILE
  </dt>
  <dd>
    <p>write log entries to FILE (default is to not write log files at all); use "syslog" to log to system log, or "none" to disable logging</p>
  </dd>
  <dt>
    --log-level=LEVEL
  </dt>
  <dd>
    <p>log at LEVEL, one of debug, info, warning, error, critical, fatal (default: debug)</p>
  </dd>
  <dt>
    --log-max=SIZE
  </dt>
  <dd>
    <p>rotate logs larger than SIZE, zero for never (default: 0)</p>
  </dd>
  <dt>
    --log-keep=N
  </dt>
  <dd>
    <p>keep last N logs (10)</p>
  </dd>
  <dt>
    --log-mode=MODE
  </dt>
  <dd>
    <p>set permissions of new log files to MODE (octal;  default 0600)</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Peformance:</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    --dump-memory-profile=METHOD
  </dt>
  <dd>
    <p>make memory profiling dumps using METHOD, which is one of: none, simple, meliae, or heapy (default: simple)</p>
  </dd>
  <dt>
    --memory-dump-interval=SECONDS
  </dt>
  <dd>
    <p>make memory profiling dumps at least SECONDS apart</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>To create an image for the stable release of Debian:</p>
<pre>
sudo vmdebootstrap --image test.img --size 1g &#92;
    --log test.log --log-level debug --verbose &#92;
    --mirror http://mirror.lan/debian/

To run the test image, make sure it is writeable. Use the --owner option to set mode 0644 for the specified user or use chmod manually:
sudo chmod a+w ./test.img

Execute using qemu, e.g. on amd64 using qemu-system-x86_64:
qemu-system-x86_64 ./test.img

(This loads the image in a new window.)

For further examples, including u-boot support for beaglebone-black, see /usr/share/vmdebootstrap/examples
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>If you get problems with the bootstrap process, run a similar bootstrap call directly and chroot into the directory to investigate the failure. The actual debootstrap call is part of the vmdebootstrap logfile. The debootstrap logfile, if any, will be copied into your current working directory on error.</p><p><strong>debootstrap</strong> will download all the apt archive files into the apt cache and does not remove them before starting the configuration of the packages. This can mean that debootstrap can fail due to a lack of space on the device if the VM size is small. vmdebootstrap cleans up the apt cache once debootstrap has finished but this doesn't help if the package unpack or configuration steps use up all of the space in the meantime. Avoid this problem by specifying a larger size for the image.</p><p>Note that if you are also using a separate /boot partition in your options to vmdebootstrap, it may well be the boot partition which needs to be enlarged rather than the entire image.</p><p>It is advisable to change the mirror in the example scripts to a mirror closer to your location, particularly if you need to do repeated builds.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO vmdebootstrap&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/debootstrap.8.html"><strong>debootstrap</strong>(8)</a> , <strong>qemu-system-x86_64</strong>(1) , <a href="../man8/grub-install.8.html"><strong>grub-install</strong>(8)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Please provide the config section of the logfile when reporting bugs, as well as the complete command line.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="vmcore-dmesg.8.html"><span aria-hidden="true">&larr;</span> vmcore-dmesg.8: This is just a placeholder until real man page has been written</a></li>
   <li class="next"><a href="vmemctrl.8.html">vmemctrl.8: Control the oom bias for vservers <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
