<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>milter-greylist: Grey listing filter for sendmail</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Grey listing filter for sendmail">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="milter-greylist (8) manual">
  <meta name="twitter:description" content="Grey listing filter for sendmail">
  <meta name="twitter:image" content="https://www.carta.tech/images/milter-greylist-milter-greylist-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/milter-greylist.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="milter-greylist (8) manual" />
  <meta property="og:description" content="Grey listing filter for sendmail" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/milter-greylist-milter-greylist-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">milter-greylist<small> (8)</small></h1>
        <p class="lead">Grey listing filter for sendmail</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/milter-greylist.8.html">
      <span itemprop="name">milter-greylist: Grey listing filter for sendmail</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/milter-greylist/">
      <span itemprop="name">milter-greylist</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/milter-greylist.8.html">
      <span itemprop="name">milter-greylist: Grey listing filter for sendmail</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>milter-greylist</strong> [<strong>-A</strong>] [<strong>-a </strong><em>autowhite_delay</em>] [<strong>-c</strong>] [<strong>-D</strong>] [<strong>-d </strong><em>dumpfile</em>] [<strong>-f </strong><em>configfile</em>] [<strong>-h</strong>] [<strong>-l</strong>] [<strong>-q</strong>] [<strong>-r</strong>] [<strong>-S</strong>] [<strong>-T</strong>] [<strong>-u </strong><em>username</em>[:<em>groupname</em>]] [<strong>-v</strong>] [<strong>-w </strong><em>greylist_delay</em>] [<strong>-L </strong><em>cidrmask</em>] [<strong>-M </strong><em>prefixlen</em>] [<strong>-P </strong><em>pidfile</em>] <strong>-p</strong> <em>socket</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>milter-greylist</strong> is a mail filter for sendmail that implements grey listing, a spam filtering technique proposed by Evan Harris.</p><p>Grey listing works by assuming that contrarily to legitimate MTA, spam engines will not retry sending their junk mail on a temporary error. The filter will always temporarily reject mail on a first attempt, and accept it after some time has elapsed.</p><p>If spammers ever try to resend rejected messages, we can assume they will not stay idle between the two sends. Odds are good that the spammer will send a mail to an honey pot address and get blacklisted in a distributed black list before the second attempt.</p><p>Of course, the filter can be configured to not apply grey listing to some hosts or networks. You can whitelist friendly SMTP servers, and you should whitelist your own network, otherwise your SMTP clients will have real trouble to send e-mail. Whitelisting localhost is also a must.</p><p><strong>milter-greylist</strong> works with two files. <em>greylist.conf</em> is the configuration file. It holds the whitelist of addresses that will not suffer grey list filtering.  It is read once upon <strong>milter-greylist</strong> startup, then it will be automatically reloaded whenever a new message gets in and if it had been modified. You should not send <strong>milter-greylist</strong> a kill -1 as it will just terminate it (libmilter works that way).</p><p>See <a href="../man5/greylist.conf.5.html"><strong>greylist.conf</strong>(5)</a></strong> for documentation on the file's format.</p><p>The second file is <em>greylist.db</em>. <strong>milter-greylist</strong> will regularly dump its grey list database into this file, which is used on startup to restore the previous grey list state. If the file does not exist or is unreadable, <strong>milter-greylist</strong> will start with an empty grey list.</p><p>The default location for the grey list database and the socket for communicating with sendmail is <strong>/var/milter-greylist/</strong>. That directory must be owned and writeable by the user id under which <strong>milter-greylist</strong> runs.</p><p>The following options are available; if present, they override their equivalents specified in the configuration file:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-A</strong></p>
  </dt>
  <dd>
    <p>Normally, <strong>milter-greylist</strong> does not greylist senders that succeeded SMTP AUTH. This option disables that feature and causes authentication to be ignored. Equivalent to the <em>noauth</em> option in the configuration file.</p>
  </dd>
  <dt>
    <p><strong>-a </strong><em>autowhite_delay</em></p>
  </dt>
  <dd>
    <p>Configure auto-whitelisting. After a tuple (sender IP, sender e-mail, recipient e-mail) has been accepted, other identical tuples will get accepted for <em>autowhite_delay</em>. The default is one day. Use zero to disable auto-whitelisting. A suffix can be added to specify seconds (s), minutes (m), hours (h), days (d) or weeks (w). Without any suffix, values are treated as seconds. Equivalent to the <em>autowhite</em> option in the configuration file.</p>
  </dd>
  <dt>
    <p><strong>-c</strong></p>
  </dt>
  <dd>
    <p>Only check the configuration file and exit. Return value is 0 if the configuration is valid, or an error code from <em>&lt;sysexit.h&gt;</em> otherwise.</p>
  </dd>
  <dt>
    <p><strong>-D</strong></p>
  </dt>
  <dd>
    <p>Do not fork; run in the foreground instead. Without this flag, <strong>milter-greylist</strong> will become a daemon. Equivalent to the <em>nodetach</em> option in the configuration file.</p>
  </dd>
  <dt>
    <p><strong>-d </strong><em>dumpfile</em></p>
  </dt>
  <dd>
    <p>Location of the dump file. Default is <em>/var/milter-greylist/greylist.db</em>. Equivalent to the <em>dumpfile</em> option in the configuration file.</p>
  </dd>
  <dt>
    <p><strong>-f </strong><em>configfile</em></p>
  </dt>
  <dd>
    <p>Location of the config file. Default is <em>/etc/mail/greylist.conf</em>.</p>
  </dd>
  <dt>
    <p><strong>-h</strong></p>
  </dt>
  <dd>
    <p>Show usage information.</p>
  </dd>
  <dt>
    <p><strong>-L </strong><em>cidrmask</em></p>
  </dt>
  <dd>
    <p>Use <em>cidrmask</em> as a matching mask when checking IPv4 addresses entries in the greylist. This is aimed as a workaround to mail farms that re-emit messages from different IP addresses. With <strong>-L 24</strong>, the matching mask is 255.255.255.0, and all addresses within the same class C network are considered the same. Default is <strong>-L 32</strong>, which corresponds to all addresses considered different.</p>
  </dd>
  <dt>
    <p><strong>-M </strong><em>prefixlen</em></p>
  </dt>
  <dd>
    <p>Use <em>prefixlen</em> as a matching mask when checking IPv6 addresses entries in the greylist. This is aimed as a workaround to mail farms that re-emit messages from different IP addresses. With <strong>-M 64</strong>, the matching mask is ffff:ffff:ffff:ffff::, and all addresses within the same subnet are considered the same. Default is <strong>-M 128</strong>, which corresponds to all IPv6 addresses considered different.</p>
  </dd>
  <dt>
    <p><strong>-l</strong></p>
  </dt>
  <dd>
    <p>Enable debug output in the access-list management code.</p>
  </dd>
  <dt>
    <p><strong>-P </strong><em>pidfile</em></p>
  </dt>
  <dd>
    <p>write the daemon's PID to <em>pidfile</em>. Equivalent to the <em>pidfile</em> option in the configuration file.</p>
  </dd>
  <dt>
    <p><strong>-p </strong><em>socket</em></p>
  </dt>
  <dd>
    <p>Use <em>socket</em> as the socket used by <a href="../man8/sendmail.8.html"><strong>sendmail</strong>(8)</a></strong> to communicate with <strong>milter-greylist</strong>.</p>
  </dd>
  <dt>
    <p><strong>-q</strong></p>
  </dt>
  <dd>
    <p>Quiet mode. <strong>milter-greylist</strong> will not tell SMTP clients how much time they have to wait before the message will be accepted. Equivalent to the <em>quiet</em> option in the configuration file.</p>
  </dd>
  <dt>
    <p><strong>-r</strong></p>
  </dt>
  <dd>
    <p>Display <strong>milter-greylist</strong> version and build environment, then exit.</p>
  </dd>
  <dt>
    <p><strong>-S</strong></p>
  </dt>
  <dd>
    <p>If <strong>milter-greylist</strong> was built with SPF support, then SPF-compliant senders bypass greylisting. This flag causes messages to be greylisted regardless of whether they are SPF-compliant or not. Equivalent to the <em>nospf</em> option in the configuration file.</p>
  </dd>
  <dt>
    <p><strong>-T</strong></p>
  </dt>
  <dd>
    <p>Enable test mode. This alters the meaning of <em>rcpt</em> lines in <em>greylist.conf</em>, so that only messages sent to recipient addresses listed there are selected for greylisting. This option and the <em>rcpt</em> lines have been deprecated in favor of ACL, so do not use it.</p>
  </dd>
  <dt>
    <p><strong>-u </strong><em>username</em>[:<em>groupname</em>]</p>
  </dt>
  <dd>
    <p>Drop root privileges and switch to <em>username</em> (and optionally <em>groupname</em>) credentials. Make sure this user (and group) has write access to <em>greylist.db</em>. Equivalent to the <em>user</em> option in the configuration file.</p>
  </dd>
  <dt>
    <p><strong>-v</strong></p>
  </dt>
  <dd>
    <p>Enable debug output. <strong>milter-greylist</strong> will send messages (and debug output if it is given the <strong>-v</strong> flag) to <strong>syslogd</strong>(8)</strong> with facility LOG_MAIL. Equivalent to the <em>verbose</em> option in the configuration file.</p>
  </dd>
  <dt>
    <p><strong>-w </strong><em>greylist_delay</em></p>
  </dt>
  <dd>
    <p>sets the minimum delay between the first attempt and the time the message can be accepted. Default is 30 minutes. A suffix can be added to specify seconds (s), minutes (m), hours (h), days (d) or weeks (w). Without any suffix, values are treated as seconds. Equivalent to the <em>greylist</em> option in the configuration file.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">GREYLIST MX SYNC</h2>
        <div class="sectioncontent">
<p><strong>milter-greylist</strong> is now able to sync the greylist between multiple MX. In order to enable this feature, you need to list the peer MXs in <a href="../man5/greylist.conf.5.html"><strong>greylist.conf</strong>(5)</a></strong> like this:</p>
<pre>
  peer 192.0.2.17
  peer 192.0.2.18
</pre>
<p>When peers are configured, <strong>milter-greylist</strong> will listen on the port defined for the mxglsync service in <em>/etc/services</em> (defaults to 5252), and it will connect to peers at this port. Each time an entry is added or deleted on one MX, it will be propagated to the others.</p><p>The protocol is quite simple, just telnet to your MX at port 5252, and type <em>help</em> to see how it works. Note that connections will only be accepted from peer MXs, even localhost will be rejected (and don't ever add localhost as a peer for MX sync, as you will cause each entry in the greylist to be added twice).</p><p>If an MX is down, changes to the greylist will be queued until it gets back up again. The queue length is limited (default is 1024 entries), and if it overflows, newer entries will be discarded.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Emmanuel Dreyfus &lt;manu@netbsd.org&gt;</p><p><strong>milter-greylist</strong> received many contributions from (in alphabetical order): Adrian Dabrowski, Aida Shinra, Adam Katz, Alexander Lobodzinski, Alexandre Cherif, Alexey Popov, Andrew McGill, Attila Bruncsak, Benoit Branciard, Bernhard Schneider, Bob Smith, Constantine A. Murenin, Christian Pelissier, Cyril Guibourg, Dan Hollis, Denis Solovyov, Elrond, Enrico Scholz, Eugene Crosser, Fabien Tassin, Fredrik Pettai, Gary Aitken, Georg Horn, Gert Doering, Greg Troxel, Guido Kerkewitz, Hajimu Umemoto, Hideki ONO, Ivan F. Martinez, Jacques Beigbeder, Jean Benoit, Jean-Jacques Puig, Jeff Rife, Jim Klimov, Jobst Schmalenbach, Joe Pruett, Joel Bertrand, Johann E. Klasek, Johann Klasek, John Thiltges, John Wood, Jorgen Lundman, Klas Heggemann, Kouhei Sutou, Laurence Moindrot, Lev Walkin, Manuel Badzong, Martin Paul, Matt Kettler, Mattheu Herrb, Matthias Scheler, Matthieu Herrb, Michael Fromme, Moritz Both, Nerijus Baliunas, Ole Hansen, Pavel Cahyna, Pascal Lalonde, Per Holm, Petr Kristof, Piotr Wadas, R P Herrold, Ralf S. Engelschall, Ranko Zivojnovic, Remy Card, Rick Adams, Rogier Maas, Romain Kang, Rudy Eschauzier, Stephane Lentz, Thomas Scheunemann, Tim Mooney, Wolfgang Solfrank, and Yaroslav Boychuk.</p><p>Thanks to Helmut Messerer and Thomas Pfau for their feedback on the first releases of this software.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO milter-greylist&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/greylist.conf.5.html"><strong>greylist.conf</strong>(5)</a>, <a href="../man8/sendmail.8.html"><strong>sendmail</strong>(8)</a>, <strong>syslogd</strong>(8).</p>
<dl class='dl-vertical'>
  <dt>
    <p>Evan Harris's paper:</p>
  </dt>
  <dd>
    <p><em>http://projects.puremagic.com/greylisting/</em></p>
  </dd>
  <dt>
    <p>milter-greylist's web site:</p>
  </dt>
  <dd>
    <p><em>http://hcpnet.free.fr/milter-greylist/</em></p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="mii-tool.8.html"><span aria-hidden="true">&larr;</span> mii-tool.8: View, manipulate media-independent interface status</a></li>
   <li class="next"><a href="miltertest.8.html">miltertest.8: Milter unit test utility <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
