<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>amq: Automounter query tool</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Automounter query tool">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="amq (8) manual">
  <meta name="twitter:description" content="Automounter query tool">
  <meta name="twitter:image" content="https://www.carta.tech/images/am-utils-amq-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/amq.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="amq (8) manual" />
  <meta property="og:description" content="Automounter query tool" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/am-utils-amq-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">amq<small> (8)</small></h1>
        <p class="lead">Automounter query tool</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/amq.8.html">
      <span itemprop="name">amq: Automounter query tool</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/am-utils/">
      <span itemprop="name">am-utils</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/amq.8.html">
      <span itemprop="name">amq: Automounter query tool</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>amq</strong> [ <strong>-fmpqsvwHTU</strong> ] [ <strong>-h</strong><em> hostname</em> ] [ <strong>-l</strong><em> log_file</em> ] [ <strong>-x</strong><em> log_options</em> ] [ <strong>-D</strong><em> debug_options</em> ] [ <strong>-P</strong><em> program_number</em> ] [[ <strong>-u</strong> ] <em>directory .\|.\|.</em> ]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>Amq</strong> provides a simple way of determining the current state of <strong>amd</strong> program. Communication is by <small>RPC.</small> Three modes of operation are supported by the current protocol.  By default a list of mount points and auto-mounted filesystems is output.  An alternative host can be specified using the <em>-h</em> option.</p><p>If <em>directory</em> names are given, as output by default, then per-filesystem information is displayed.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-f</strong></p>
  </dt>
  <dd>
    <p>Ask the automounter to flush the internal caches and reload all the maps.</p>
  </dd>
  <dt>
    <p><strong>-h</strong><em> hostname</em></p>
  </dt>
  <dd>
    <p>Specify an alternate host to query.  By default the local host is used.  In an <small>HP-UX</small> cluster, the root server is queried by default, since that is the system on which the automounter is normally run.</p>
  </dd>
  <dt>
    <p><strong>-l</strong><em> log_file</em></p>
  </dt>
  <dd>
    <p>Tell amd to use <em>log_file</em> as the log file name.  For security reasons, this must be the same log file which amd used when started.  This option is therefore only useful to refresh amd's open file handle on the log file, so that it can be rotated and compressed via daily cron jobs.</p>
  </dd>
  <dt>
    <p><strong>-m</strong></p>
  </dt>
  <dd>
    <p>Ask the automounter to provide a list of mounted filesystems, including the number of references to each filesystem and any error which occurred while mounting.</p>
  </dd>
  <dt>
    <p><strong>-p</strong></p>
  </dt>
  <dd>
    <p>Return the process ID of the remote or locally running amd.  Useful when you need to send a signal to the local amd process, and would rather not have to search through the process table.  This option is used in the <em>ctl-amd</em> script.</p>
  </dd>
  <dt>
    <p><strong>-q</strong></p>
  </dt>
  <dd>
    <p>Suppress error messages produced when attempting synchronous unmounts with the <strong>-u</strong> option.</p>
  </dd>
  <dt>
    <p><strong>-s</strong></p>
  </dt>
  <dd>
    <p>Ask the automounter to provide system-wide mount statistics.</p>
  </dd>
  <dt>
    <p><strong>-u</strong></p>
  </dt>
  <dd>
    <p>Ask the automounter to unmount the filesystems named in <em>directory</em> instead of providing information about them.  Unmounts are requested, not forced.  They merely cause the mounted filesystem to timeout, which will be picked up by <strong>amd</strong>'s main scheduler thus causing the normal timeout action to be taken. If the <strong>-u</strong> option is repeated, <strong>amq</strong> will attempt to unmount the file system synchronously by waiting until the timeout action is taken and returning an error if the unmount fails. Any error messages produced may be suppressed with the <strong>-q</strong> option.</p>
  </dd>
  <dt>
    <p><strong>-v</strong></p>
  </dt>
  <dd>
    <p>Ask the automounter for its version information.  This is a subset of the information output by <strong>amd</strong>'s <em>-v</em> option.</p>
  </dd>
  <dt>
    <p><strong>-w</strong></p>
  </dt>
  <dd>
    <p>Translate a full pathname as returned by <a href="../man3/getcwd.3.html"><strong>getcwd</strong>(3)</a> into a short <strong>Amd</strong> pathname that goes through its mount points.   This option requires that <strong>Amd</strong> is running.</p>
  </dd>
  <dt>
    <p><strong>-x</strong><em> log_options</em></p>
  </dt>
  <dd>
    <p>Ask the automounter to use the logging options specified in <em>log_options</em> from now on.  Note that the "fatal" and "error" options cannot be turned off.</p>
  </dd>
  <dt>
    <p><strong>-D</strong><em> debug_options</em></p>
  </dt>
  <dd>
    <p>Ask the automounter to use the debugging options specified in <em>debug_options</em> from now on.</p>
  </dd>
  <dt>
    <p><strong>-H</strong></p>
  </dt>
  <dd>
    <p>Display short usage message.</p>
  </dd>
  <dt>
    <p><strong>-P</strong><em> program_number</em></p>
  </dt>
  <dd>
    <p>Contact an alternate running amd that had registered itself on a different RPC <em>program_number</em> and apply all other operations to that instance of the automounter.  This is useful when you run multiple copies of amd, and need to manage each one separately.  If not specified, amq will use the default program number for amd, 300019.  For security reasons, the only alternate program numbers amd can use range from 300019 to 300029, inclusive.</p>
  </dd>
  <dt>
    <p><strong>-T</strong></p>
  </dt>
  <dd>
    <p>Contact <strong>amd</strong> using the TCP transport only.  Normally <strong>amq</strong> will try TCP, and if that failed, will try UDP.</p>
  </dd>
  <dt>
    <p><strong>-U</strong></p>
  </dt>
  <dd>
    <p>Contact <strong>amd</strong> using UDP (connectionless) transport only.  Normally <strong>amq</strong> will try TCP, and if that failed, will try UDP.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>amq.x</strong></p>
  </dt>
  <dd>
    <p><small>RPC</small> protocol description.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CAVEATS</h2>
        <div class="sectioncontent">
<p><strong>Amq</strong> uses a Sun registered <small>RPC</small> program number (300019 decimal) which may not be in the /etc/rpc database.</p><p>If the TCP wrappers library is available, and the <strong>use_tcpwrappers</strong> global <strong>amd.conf</strong> option is set to ``yes'', then <strong>amd</strong> will verify that the host running <strong>amq</strong> is authorized to connect.  The <em>amd</em> service name must used in the <strong>/etc/hosts.allow</strong> and <strong>/etc/hosts.deny</strong> files.  For example, to allow only localhost to connect to <strong>amd,</strong> add this line to <strong>/etc/hosts.allow:</strong></p><p>amd: localhost</p><p>and this line to <strong>/etc/hosts.deny:</strong></p><p>amd: ALL</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO amq&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/amd.8.html"><strong>amd</strong>(8)</a>, <a href="../man5/amd.conf.5.html"><strong>amd.conf</strong>(5)</a>, <a href="../man5/hosts_access.5.html"><strong>hosts_access</strong>(5)</a>.</p><p>``am-utils'' <a href="../man1/info.1.html"><strong>info</strong>(1)</a> entry.</p><p><em>Linux NFS and Automounter Administration</em> by Erez Zadok, ISBN 0-7821-2739-8, (Sybex, 2001).</p><p><em>http://www.am-utils.org</em></p><p><em>Amd - The 4.4 BSD Automounter</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Jan-Simon Pendry &lt;jsp@doc.ic.ac.uk&gt;, Department of Computing, Imperial College, London, UK.</p><p>Erez Zadok &lt;ezk@cs.sunysb.edu&gt;, Computer Science Department, Stony Brook University, Stony Brook, New York, USA.</p><p>Other authors and contributors to am-utils are listed in the <strong>AUTHORS</strong> file distributed with am-utils.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="amplot.8.html"><span aria-hidden="true">&larr;</span> amplot.8: Visualize the behavior of amanda</a></li>
   <li class="next"><a href="amq-check-wrap.8.html">amq-check-wrap.8: Check loopback rpc connection to amd <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
