<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>tc-mqprio: Multiqueue priority qdisc (offloaded hardware qos)</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Multiqueue priority qdisc (offloaded hardware qos)">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="tc-mqprio (8) manual">
  <meta name="twitter:description" content="Multiqueue priority qdisc (offloaded hardware qos)">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/tc-mqprio.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="tc-mqprio (8) manual" />
  <meta property="og:description" content="Multiqueue priority qdisc (offloaded hardware qos)" />
  <meta property="fb:app_id" content="1241677679199500" />

</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">tc-mqprio<small> (8)</small></h1>
        <p class="lead">Multiqueue priority qdisc (offloaded hardware qos)</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/tc-mqprio.8.html">
      <span itemprop="name">tc-mqprio: Multiqueue priority qdisc (offloaded hardware qos)</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/iproute2/">
      <span itemprop="name">iproute2</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/tc-mqprio.8.html">
      <span itemprop="name">tc-mqprio: Multiqueue priority qdisc (offloaded hardware qos)</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>tc qdisc ... dev</strong> dev <strong>( parent</strong> classid <strong>| root) [ handle</strong> major: <strong>] mqprio [ numtc</strong> tcs <strong>] [ map</strong> P0 P1 P2... <strong>] [ queues</strong> count1@offset1 count2@offset2 ... <strong>] [ hw</strong> 1|0 <strong>]</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The MQPRIO qdisc is a simple queuing discipline that allows mapping traffic flows to hardware queue ranges using priorities and a configurable priority to traffic class mapping. A traffic class in this context is a set of contiguous qdisc classes which map 1:1 to a set of hardware exposed queues.</p><p>By default the qdisc allocates a pfifo qdisc (packet limited first in, first out queue) per TX queue exposed by the lower layer device. Other queuing disciplines may be added subsequently. Packets are enqueued using the <strong>map</strong> parameter and hashed across the indicated queues in the <strong>offset</strong> and <strong>count.</strong> By default these parameters are configured by the hardware driver to match the hardware QOS structures.</p><p>Enabled hardware can provide hardware QOS with the ability to steer traffic flows to designated traffic classes provided by this qdisc. Configuring the hardware based QOS mechanism is outside the scope of this qdisc. Tools such as <strong>lldpad</strong> and <strong>ethtool</strong> exist to provide this functionality. Also further qdiscs may be added to the classes of MQPRIO to create more complex configurations.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ALGORITHM</h2>
        <div class="sectioncontent">
<p>On creation with 'tc qdisc add', eight traffic classes are created mapping priorities 0..7 to traffic classes 0..7 and priorities greater than 7 to traffic class 0. This requires base driver support and the creation will fail on devices that do not support hardware QOS schemes.</p><p>These defaults can be overridden using the qdisc parameters. Providing the 'hw 0' flag allows software to run without hardware coordination.</p><p>If hardware coordination is being used and arguments are provided that the hardware can not support then an error is returned. For many users hardware defaults should work reasonably well.</p><p>As one specific example numerous Ethernet cards support the 802.1Q link strict priority transmission selection algorithm (TSA). MQPRIO enabled hardware in conjunction with the classification methods below can provide hardware offloaded support for this TSA.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CLASSIFICATION</h2>
        <div class="sectioncontent">
<p>Multiple methods are available to set the SKB priority which MQPRIO uses to select which traffic class to enqueue the packet.</p>
<dl class='dl-vertical'>
  <dt>
    <p>From user space</p>
  </dt>
  <dd>
    <p>A process with sufficient privileges can encode the destination class directly with SO_PRIORITY, see <a href="../man7/socket.7.html"><strong>socket</strong>(7)</a>.</strong></p>
  </dd>
  <dt>
    <p>with iptables/nftables</p>
  </dt>
  <dd>
    <p>An iptables/nftables rule can be created to match traffic flows and set the priority. <strong>iptables</strong>(8)</strong></p>
  </dd>
  <dt>
    <p>with net_prio cgroups</p>
  </dt>
  <dd>
    <p>The net_prio cgroup can be used to set the priority of all sockets belong to an application. See kernel and cgroup documentation for details.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">QDISC PARAMETERS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>num_tc</p>
  </dt>
  <dd>
    <p>Number of traffic classes to use. Up to 16 classes supported.</p>
  </dd>
  <dt>
    <p>map</p>
  </dt>
  <dd>
    <p>The priority to traffic class map. Maps priorities 0..15 to a specified traffic class.</p>
  </dd>
  <dt>
    <p>queues</p>
  </dt>
  <dd>
    <p>Provide count and offset of queue range for each traffic class. In the format, <strong>count@offset.</strong> Queue ranges for each traffic classes cannot overlap and must be a contiguous range of queues.</p>
  </dd>
  <dt>
    <p>hw</p>
  </dt>
  <dd>
    <p>Set to <strong>1</strong> to use hardware QOS defaults. Set to <strong>0</strong> to override hardware defaults with user specified values.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>John Fastabend, &lt;john.r.fastabend@intel.com&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="tc-mirred.8.html"><span aria-hidden="true">&larr;</span> tc-mirred.8: Mirror/redirect action</a></li>
   <li class="next"><a href="tc-nat.8.html">tc-nat.8: Stateless native address translation action <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
