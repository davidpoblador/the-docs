<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>perf-stat-hist: Histogram summary of tracepoint values. uses linux perf_events.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Histogram summary of tracepoint values. uses linux perf_events.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="perf-stat-hist (8) manual">
  <meta name="twitter:description" content="Histogram summary of tracepoint values. uses linux perf_events.">
  <meta name="twitter:image" content="https://www.carta.tech/images/perf-tools-unstable-perf-stat-hist-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/perf-stat-hist.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="perf-stat-hist (8) manual" />
  <meta property="og:description" content="Histogram summary of tracepoint values. uses linux perf_events." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/perf-tools-unstable-perf-stat-hist-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">perf-stat-hist<small> (8)</small></h1>
        <p class="lead">Histogram summary of tracepoint values. uses linux perf_events.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/perf-stat-hist.8.html">
      <span itemprop="name">perf-stat-hist: Histogram summary of tracepoint values. uses linux perf_events.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/perf-tools-unstable/">
      <span itemprop="name">perf-tools-unstable</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/perf-stat-hist.8.html">
      <span itemprop="name">perf-stat-hist: Histogram summary of tracepoint values. uses linux perf_events.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>perf-stat-hist</strong> [-h] [-b buckets|-P power] [-m max] tracepoint variable [seconds]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This is a proof-of-concept showing in-kernel histograms using Linux perf_events (aka the "perf" command), on older kernels where perf_events does not have this native capability.</p><p>These histograms show the distribution of variable, allowing details including multiple modes and outliers to be studied.</p><p>This uses multiple counting tracepoints with different filters, one for each histogram bucket. While this is summarized in-kernel, the use of multiple tracepoints does add addiitonal overhead. Hopefully, in the future this this functionality will be provided in an efficient way from perf_events itself, at which point this tool can be deleted or rewritten.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REQUIREMENTS</h2>
        <div class="sectioncontent">
<p>Linux perf_events: add linux-tools-common, run "perf", then add any additional packages it requests. Also uses awk.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>-h</p>
  </dt>
  <dd>
    <p>Usage message.</p>
  </dd>
  <dt>
    <p>-b buckets</p>
  </dt>
  <dd>
    <p>Specify a list of bucket points for the histogram as a string (eg, "10 500 1000"). The histogram will include buckets for less-than the minimum, and greater-than-or-equal-to the maximum.  If a single value is specified, two statistics only are gathered: for less-than and for greater-than-or-equal-to. The overhead is relative to the number of buckets, so only specifying a single value costs the lowest overhead.</p>
  </dd>
  <dt>
    <p>-P power</p>
  </dt>
  <dd>
    <p>Power for power-of histogram. By default, a power-of-4 histogram is created. This and the -b option are exclusive.</p>
  </dd>
  <dt>
    <p>-m max</p>
  </dt>
  <dd>
    <p>Max value for power-of histograms.</p>
  </dd>
  <dt>
    <p>tracepoint</p>
  </dt>
  <dd>
    <p>Tracepoint specification. Eg, syscalls:sys_enter_read.</p>
  </dd>
  <dt>
    <p>variable</p>
  </dt>
  <dd>
    <p>The tracepoint variable name to summarize. To see what are available, cat the format file under /sys/kernel/debug/tracing/events/*/*/format.</p>
  </dd>
  <dt>
    <p>seconds</p>
  </dt>
  <dd>
    <p>Number of seconds to trace. If not specified, this runs until Ctrl-C.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>Trace read() syscalls until Ctrl-C, and show histogram of requested size:</p>
  </dt>
  <dd>
    <p># <strong>perf-stat-hist syscalls:sys_enter_read count</strong></p>
  </dd>
  <dt>
    <p>Trace read() syscall completions until Ctrl-C, and show histogram of successful returned size:</p>
  </dt>
  <dd>
    <p># <strong>perf-stat-hist syscalls:sys_exit_read ret</strong></p>
  </dd>
  <dt>
    <p>Trace read() return sizes for 10 seconds, showing histogram:</p>
  </dt>
  <dd>
    <p># <strong>perf-stat-hist syscalls:sys_exit_read ret 10</strong></p>
  </dd>
  <dt>
    <p>Trace network transmits until Ctrl-C, and show histogram of packet size:</p>
  </dt>
  <dd>
    <p># <strong>perf-stat-hist net:net_dev_xmit len</strong></p>
  </dd>
  <dt>
    <p>Trace read() return sizes, using a power-of-10 histogram:</p>
  </dt>
  <dd>
    <p><strong>perf-stat-hist -P 10 syscalls:sys_exit_read ret</strong></p>
  </dd>
  <dt>
    <p>Trace read() return sizes, using a power-of-2 histogram, and a max of 1024:</p>
  </dt>
  <dd>
    <p><strong>perf-stat-hist -P 2 -m 1024 syscalls:sys_exit_read ret</strong></p>
  </dd>
  <dt>
    <p>Trace read() return sizes, using the specified bucket points:</p>
  </dt>
  <dd>
    <p><strong>perf-stat-hist -b  10 50 100 5000  syscalls:sys_exit_read ret</strong></p>
  </dd>
  <dt>
    <p>Trace read() return sizes, and bifurcate statistics by the value 10:</p>
  </dt>
  <dd>
    <p><strong>perf-stat-hist -b 10 syscalls:sys_exit_read ret</strong></p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FIELDS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>Range</p>
  </dt>
  <dd>
    <p>Range of the histogram bucket, in units of the variable specified.</p>
  </dd>
  <dt>
    <p>Count</p>
  </dt>
  <dd>
    <p>Number of occurrences (tracepoint events) of the variable in this range.</p>
  </dd>
  <dt>
    <p>Distribution</p>
  </dt>
  <dd>
    <p>ASCII histogram representation of the Count column.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OVERHEAD</h2>
        <div class="sectioncontent">
<p>While the counts are performed in-kernel, there is one tracepoint used per histogram bucket, so the overheads are higher than usual (relative to the number of buckets) than function counting using perf stat. The lowest overhead is when -b is used to specify one bucket only, bifurcating statistics.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SOURCE</h2>
        <div class="sectioncontent">
<p>This is from the perf-tools collection.</p><ul>
<li><p>https://github.com/brendangregg/perf-tools</p></li>
</ul><p>Also look under the examples directory for a text file containing example usage, output, and commentary for this tool.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OS</h2>
        <div class="sectioncontent">
<p>Linux</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">STABILITY</h2>
        <div class="sectioncontent">
<p>Unstable - in development.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Brendan Gregg</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO perf-stat-hist&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/perf.1.html"><strong>perf</strong>(1)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="perditiondb_postgresql_makedb.8.html"><span aria-hidden="true">&larr;</span> perditiondb_postgresql_makedb.8: Create perdition database in a postgresql rdms</a></li>
   <li class="next"><a href="perfquery.8.html">perfquery.8: Perfquery - <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
