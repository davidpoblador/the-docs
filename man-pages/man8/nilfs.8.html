<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>nilfs: The new implementation of a log-structured file system</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="The new implementation of a log-structured file system">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="nilfs (8) manual">
  <meta name="twitter:description" content="The new implementation of a log-structured file system">
  <meta name="twitter:image" content="https://www.carta.tech/images/nilfs-tools-nilfs-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/nilfs.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="nilfs (8) manual" />
  <meta property="og:description" content="The new implementation of a log-structured file system" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/nilfs-tools-nilfs-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">nilfs<small> (8)</small></h1>
        <p class="lead">The new implementation of a log-structured file system</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/nilfs.8.html">
      <span itemprop="name">nilfs: The new implementation of a log-structured file system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/nilfs-tools/">
      <span itemprop="name">nilfs-tools</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/nilfs.8.html">
      <span itemprop="name">nilfs: The new implementation of a log-structured file system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>Overview of the NILFS file system and the related tools.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>NILFS is a log-structured file system developed for Linux.  NILFS provides versioning capability of an entire file system and continuous snapshotting that allows users to restore files mistakenly overwritten or destroyed a while ago.</p><p>The current major version of NILFS is version 2, which is referred to as NILFS2.  NILFS2 is equipped with an online garbage collector (also called cleaner) that reclaims disk space in the background with keeping multiple snapshots.</p><p>When data is written or any change is made to a NILFS2 file system, it automatically creates a checkpoint.  A checkpoint represents a consistent state of the NILFS2 file system of a certain instant.  It becomes mountable after being changed into a snapshot.  A snapshot is the checkpoint marked not to be deleted by the cleaner.  NILFS2 creates a number of checkpoints at regular intervals (unless there is no change) or with synchronous writings.  There is no practical limit on the number of checkpoints and snapshots.</p><p>The following tools are available to manage the checkpoint and the snapshot:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>lscp</strong></p>
  </dt>
  <dd>
    <p>lists checkpoints or snapshots</p>
  </dd>
  <dt>
    <p><strong>mkcp</strong></p>
  </dt>
  <dd>
    <p>makes a checkpoint or a snapshot</p>
  </dd>
  <dt>
    <p><strong>chcp</strong></p>
  </dt>
  <dd>
    <p>changes an existing checkpoint to a snapshot or vice versa</p>
  </dd>
  <dt>
    <p><strong>rmcp</strong></p>
  </dt>
  <dd>
    <p>invalidates specified checkpoint(s)</p>
  </dd>

</dl>
<p>These tools give the versioning capability to NILFS2; a user can select significant versions among continuously created checkpoints and can change them to snapshots to be preserved for long periods.</p><p>Every checkpoint except for the snapshot will become unprotected from the cleaner after a given period of time.  This period is controlled by the <strong>protection_period</strong> parameter defined in the <strong>/etc/<a href="../man5/nilfs_cleanerd.conf.5.html"><strong>nilfs_cleanerd.conf</strong>(5)</a></strong> file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MOUNT OPTIONS</h2>
        <div class="sectioncontent">
<p>Refer to the <a href="../man8/mount.nilfs2.8.html"><strong>mount.nilfs2</strong>(8)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>mkfs -t nilfs2 </strong>/dev/sdb1</p>
  </dt>
  <dd>
    <p>creates a NILFS2 file system on a block device `/dev/sdb1'.</p>
  </dd>
  <dt>
    <p><strong>mount -t nilfs2 </strong>/dev/sdb1 /nilfs</p>
  </dt>
  <dd>
    <p>mounts the NILFS2 file system on a mount point `/nilfs' like an ordinary POSIX file system.  This will invoke a cleaner process <a href="../man8/nilfs_cleanerd.8.html"><strong>nilfs_cleanerd</strong>(8)</a> through an external mount program (i.e. <a href="../man8/mount.nilfs2.8.html"><strong>mount.nilfs2</strong>(8)</a>).</p>
  </dd>
  <dt>
    <p><strong>lscp</strong></p>
  </dt>
  <dd>
    <p>lists checkpoints created in the file system as follows:</p>
  </dd>

</dl>

<pre>
        CNO        DATE     TIME  MODE  FLG      BLKCNT       ICNT
          1  2014-01-18 20:49:54   cp    -            4          2
          2  2014-01-18 20:51:45   cp    -         3990         11
          3  2014-01-18 20:51:45   cp    -         6058          3
          4  2014-01-18 20:51:49   cp    -         4807          6
          5  2014-01-18 20:51:49   cp    -          262          3
        ...
</pre>

<dl class='dl-vertical'>
  <dt>
    <p><strong>chcp ss </strong>2</p>
  </dt>
  <dd>
    <p>changes the checkpoint whose <em>checkpoint-number</em> is two to a snapshot. Then the checkpoint list will become as follows:</p>
  </dd>

</dl>

<pre>
        CNO        DATE     TIME  MODE  FLG      BLKCNT       ICNT
          1  2014-01-18 20:49:54   cp    -            4          2
          2  2014-01-18 20:51:45   ss    -         3990         11
          3  2014-01-18 20:51:45   cp    -         6058          3
          4  2014-01-18 20:51:49   cp    -         4807          6
          5  2014-01-18 20:51:49   cp    -          262          3
        ...
</pre>

<dl class='dl-vertical'>
  <dt>
    <p><strong>mount -t nilfs2 -r -o cp=2 </strong>/dev/sdb1 /snapshot</p>
  </dt>
  <dd>
    <p>mounts the snapshot on another directory `/snapshot' as a read-only file system.  Here the snapshot mount requires at least two options, a read-only option (<strong>-r</strong> or <strong>-o ro</strong>) and the <strong>cp</strong> option (<strong>-o cp=</strong><em>checkpoint-number</em>).  Note that a read/write mount and one or more snapshots are mountable independently, so the online backup is possible through the snapshot mounts.</p>
  </dd>

</dl>

<pre>
        # mount -t nilfs2
        /dev/sdb1 on /nilfs type nilfs2 (rw,gcpid=13296)
        /dev/sdb1 on /snapshot type nilfs2 (ro,cp=2)
</pre>

<dl class='dl-vertical'>
  <dt>
    <p><strong>umount </strong>/nilfs</p>
  </dt>
  <dd>
    <p>unmounts the NILFS2 file system mounted on `/nilfs' and will shutdown the <a href="../man8/nilfs_cleanerd.8.html"><strong>nilfs_cleanerd</strong>(8)</a> through an external umount program (<a href="../man8/umount.nilfs2.8.html"><strong>umount.nilfs2</strong>(8)</a>) for the read/write mount.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p><strong>NILFS2</strong> was developed by NILFS development team.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO nilfs&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/mkfs.nilfs2.8.html"><strong>mkfs.nilfs2</strong>(8)</a>, <a href="../man8/mount.nilfs2.8.html"><strong>mount.nilfs2</strong>(8)</a>, <a href="../man8/umount.nilfs2.8.html"><strong>umount.nilfs2</strong>(8)</a>, <a href="../man8/nilfs_cleanerd.8.html"><strong>nilfs_cleanerd</strong>(8)</a>, <a href="../man5/nilfs_cleanerd.conf.5.html"><strong>nilfs_cleanerd.conf</strong>(5)</a>, <a href="../man8/nilfs-tune.8.html"><strong>nilfs-tune</strong>(8)</a>, <a href="../man8/nilfs-clean.8.html"><strong>nilfs-clean</strong>(8)</a>, <a href="../man8/nilfs-resize.8.html"><strong>nilfs-resize</strong>(8)</a>, <a href="../man1/lscp.1.html"><strong>lscp</strong>(1)</a>, <a href="../man8/mkcp.8.html"><strong>mkcp</strong>(8)</a>, <a href="../man8/chcp.8.html"><strong>chcp</strong>(8)</a>, <a href="../man8/rmcp.8.html"><strong>rmcp</strong>(8)</a>, <a href="../man1/lssu.1.html"><strong>lssu</strong>(1)</a>, <a href="../man8/dumpseg.8.html"><strong>dumpseg</strong>(8)</a></p><p>http://nilfs.sourceforge.net/</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="nield.8.html"><span aria-hidden="true">&larr;</span> nield.8: Network interface events logging daemon</a></li>
   <li class="next"><a href="nilfs-clean.8.html">nilfs-clean.8: Run garbage collector on nilfs file system <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
