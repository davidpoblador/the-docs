<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>lvm2create_initrd - create initrd image for booting to root&#92;-on&#92;-LVM2</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Create initrd image for booting to root&#92;-on&#92;-lvm2">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">lvm2create_initrd<small> (8)</small></h1>
        <p class="lead">Create initrd image for booting to root&#92;-on&#92;-lvm2</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/lvm2create_initrd.8.html">
      <span itemprop="name">lvm2create_initrd</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/lvm2/">
      <span itemprop="name">lvm2</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p><strong>lvm2create_initrd</strong> [ <strong>-h|--help</strong> ] [ <strong>-v|--verbose</strong> ] [ <strong>-c|--lvmconf</strong> <em>/path/to/lvm.conf</em> ] [ <strong>-m|--modules</strong> "<em>module1 module2 ...</em>" ] [ <strong>-e|--extra</strong> "<em>file1 file2 ...</em>" ] [ <strong>-r|--raid</strong> "<em>/dev/md1 /dev/md2 ...</em>" ] [ <strong>-R|--raidconf</strong> <em>/path/to/mdadm.conf</em> ] [ <strong>-M|--makedev</strong> <em>style</em> ]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p>lvm2create_initrd creates an initial ramdisk (initrd) image suitable for booting to system that has an \s-1LVM2\s0 volume as its root filesystem.</p>
<p class='spacer'>

<p>To boot to such a setup, you'll either need a bootloader that understands \s-1LVM2\s0 volumes, or you'll need a filesystem on a regular volume to act as a boot partition (typically mounted on /boot).</p>
<p class='spacer'>

<p>The resulting initrd image is fairly full-featured. It can harbor and load kernel modules, start \s-1MD\s0 devices, and boot to a shell to perform rescue operations.</p>
  <h3>Booting to your initrd Image:</h3>
<p>The filesystem image created is an ext2fs filesystem, hence your kernel must have ext2fs built into it statically in order to boot to the image.</p>
<p class='spacer'>

<p>Once you create your initrd image, you must pass the correct options to the kernel when you boot using it. Your kernel command line should look something like this:</p>
<p class='spacer'>

<p><strong>root=/dev/ram0 lvm2root=/dev/rootvg/root [ lvm2rescue ]</strong></p>
<p class='spacer'>

  <p>of course there may be other options.</p>
  <dl class='dl-horizontal'>
    <dt><strong>root=/dev/ram0</strong></dt>
    <dd>
  <p>This option is required. It tells the kernel that the root filesystem should initially be set to the ramdisk (/dev/ram0).</p>
    </dd>
    <dt><strong>lvm2root=/dev/rootvg/root</strong></dt>
    <dd>
  <p>This option is also required. It tells the initrd image which \s-1LVM2\s0 device the root filesystem is located on.</p>
    </dd>
    <dt><strong>lvm2rescue</strong></dt>
    <dd>
  <p>Causes the initrd image to run a shell prior to mounting the root filesystem. This is helpful in disaster situations where your initrd image is accessable, but there is a problem with the root filesystem (corrupted image, incorrect device setup, etc.). This option is (of course) optional.</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

  <p>Most of parameters that can be set via command-line options can also be set via environment variables. Options specified on the command-line always take precedence.</p>
  <dl class='dl-horizontal'>
    <dt><strong>-h|--help</strong></dt>
    <dd>
  <p>Display short help text and exit. If used, other options are ignored.</p>
    </dd>
    <dt><strong>-v|--verbose</strong></dt>
    <dd>
  <p>Turn on extra verbosity for debugging, etc.</p>
    </dd>
    <dt><strong>-c|--lvmconf</strong> <em>/path/to/lvm.conf</em></dt>
    <dd>
  <p>Specify an lvm.conf file to include in the image. This is useful if you have special device filters or other options you wish to use during the initrd stage. If this option is not included, then a lvm.conf file is created that contains only the current device filter from an <strong>lvm dumpconfig</strong>. This can also be set via the <strong>\f(CB$LVMCONF</strong> environment variable. Specify modules to include and plug in during the initrd phase. This option takes a quoted, space-separated list of modules. Full pathnames are required. These modules are loaded into the kernel early in the initrd phase of the boot process. The current modprobe.conf file is also copied to the initrd image as well. This can also be specified via the <strong>\f(CB$MODULES</strong> environment variable. Extra files that should be included in the initrd image. These files will be copied to the same location in the initrd image that they are in the current filesystem. Again full pathnames are required. This can also be specified via the <strong>\f(CB$EXTRAFILES</strong> environment variable. \s-1RAID\s0 devices to be started prior to scanning for \s-1LVM2\s0 volume groups. If this option is used then then <strong>mdadm</strong> program must be installed. This can also be specified via the <strong>\f(CB$RAID</strong> environment variable. Location of a mdadm.conf file to include. If this is not specified, then no files are included, and any devices specified with the <strong>-r</strong> option above must have minor numbers that match their superblock values. This can also be specified via the <strong>\f(CB$RAIDCONF</strong> environment variable.</p>
    </dd>
    <dt><strong>-M|--makedev</strong> <em>style</em></dt>
    <dd>
  <p>Set \s-1MAKEDEV\s0 invocation style. The script currently supports 3 styles of \s-1MAKEDEV\s0 programs <em>debian</em>, <em>redhat</em> and <em>gentoo</em>. The default is <em>debian</em>. Set to <em>redhat</em> if using the RedHat/Fedora binary \s-1MAKEDEV\s0 program. <em>gentoo</em> has the same binary but in /sbin instead of /dev. Please send a bug report to maintainer if your distribution doesn't work with any of the current options.</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT VARIABLES</h2>
        <div class="sectioncontent">

<p>Most of the options to this script can be set via environment variables. In situations where both are set, then the command-line options take precedence. Same as -c option. Same as -m option. Same as -e option. Same as -r option. Same as -R option. Same as -M option. Overrides the default value of \f(CW$BASICDEVICES in the script (which is \*(L"std consoleonly fd\*(R"). These values are passed to the <strong>\s-1MAKEDEV\s0</strong> program to create device entries in the initrd image. Overrides the default value of \f(CW$BLOCKDEVICES in the script (which is \*(L"md hda hdb hdc hdd sda sdb sdc sdd\*(R"). This value is passed to the <strong>\s-1MAKEDEV\s0</strong> program to create device entries in the initrd image. Overrides the default value of \f(CW$BINFILES (which is \*(L"/lib/lvm-200/lvm /bin/bash /bin/busybox /sbin/pivot_root\*(R"). The difference between using this and adding a file to the \f(CW$EXTRAFILES list above is that libraries that these depend upon are also included. You can still use \f(CW$EXTRAFILES to achieve the same effect, but you must resolve library dependencies youself. Force a particular size for your initrd image. The default is to total up the size of the included files and to add 512K as a buffer.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">

<p>I don't like having to specify a -M option to set the \s-1MAKEDEV\s0 style, but I know of no way to reliably detect what type of \s-1MAKEDEV\s0 is being used. We'll probably have to add other \s-1MAKEDEV\s0 styles in the future as this script is tested on other distributions.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">

<p>The script was originally written by Miguel Cabeca, with significant improvements by Jeffrey Layton. Comments, bug reports and patches should be sent to Jeffrey Layton at <strong>jtlayton@poochiereds.net</strong>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<p><strong>\s-1MAKEDEV\s0</strong>(8), <strong>mdadm</strong>(8), <strong>busybox</strong>(8), <strong>lvm.conf</strong>(5)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="lspci.8.html"><span aria-hidden="true">&larr;</span> lspci.8: list all PCI devices</a></li>
   <li class="next"><a href="makedbm.8.html">makedbm.8: create or dump a ypserv database file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
