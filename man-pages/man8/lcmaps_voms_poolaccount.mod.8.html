<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>lcmaps_voms_poolaccount.mod: Lcmaps plugin to switch user identity based on voms credentials by pool accounts</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Lcmaps plugin to switch user identity based on voms credentials by pool accounts">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="lcmaps_voms_poolaccount.mod (8) manual">
  <meta name="twitter:description" content="Lcmaps plugin to switch user identity based on voms credentials by pool accounts">
  <meta name="twitter:image" content="https://www.carta.tech/images/lcmaps-plugins-voms-lcmaps_voms_poolaccount.mod-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/lcmaps_voms_poolaccount.mod.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="lcmaps_voms_poolaccount.mod (8) manual" />
  <meta property="og:description" content="Lcmaps plugin to switch user identity based on voms credentials by pool accounts" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/lcmaps-plugins-voms-lcmaps_voms_poolaccount.mod-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">lcmaps_voms_poolaccount.mod<small> (8)</small></h1>
        <p class="lead">Lcmaps plugin to switch user identity based on voms credentials by pool accounts</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/lcmaps_voms_poolaccount.mod.8.html">
      <span itemprop="name">lcmaps_voms_poolaccount.mod: Lcmaps plugin to switch user identity based on voms credentials by pool accounts</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/lcmaps-plugins-voms/">
      <span itemprop="name">lcmaps-plugins-voms</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/lcmaps_voms_poolaccount.mod.8.html">
      <span itemprop="name">lcmaps_voms_poolaccount.mod: Lcmaps plugin to switch user identity based on voms credentials by pool accounts</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>lcmaps_voms_poolaccount.mod</strong> [<strong>-gridmapfile</strong> <em>gridmapfile</em>] [<strong>-gridmapdir</strong> <em>gridmapdir</em>] [<strong>--add-primary-gid-from-mapped-account</strong>] [<strong>--do-not-add-primary-gid-from-mapped-account</strong>] [<strong>--add-primary-gid-as-secondary-gid-from-mapped-account</strong>] [<strong>--add-secondary-gids-from-mapped-account</strong>] [<strong>--do-not-require-primary-gid</strong>] [<strong>--require-primary-gid</strong>] [<strong>-override_inconsistency</strong>] [<strong>-max_mappings_per_credential</strong> <em>max</em>mappings<em>per</em>credential<em>]</em> [<strong>-strict_poolprefix_match</strong> <em>yes_or_no</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This VOMS poolaccount acquisition plugin is a 'VOMS-aware' modification of the <strong>lcmaps_poolaccount.mod.8</strong> plugin. The plugin tries to find a local account (more specifically a UserID) based on the VOMS information that has available from the LCMAPS, in particular the Fully Qualified Attribute Names (FQAN). The account is acquired from an account pool. The accounts in the account pool must exist on the system, either locally or through a centralized account database, e.g. LDAP.</p><p>The <strong>gridmapdir</strong> directory is going to be used as a persistent and open mapping database. A pool is defined as being a set of accounts following a particular pattern in their naming, i.e. pool001 or atlas001. In the directory the plug-in will make a new filename build-up of the Subject-DN of the user, in URL-encode form, followed by the name of the Unix groups that are already mapped by other plug-ins.</p><p>Example showing the output of ls -li:</p>
<pre>
1836080 -rw-r--r-- 2 root root %2fdc%3dorg%2fdc%3dterena%2fdc%3dtcs%2fc%3dnl%2fo%3dnikhef%2fcn%3doscar%20koeroo%20okoeroo%40nikhef%2enl:pool:group004
1836080 -rw-r--r-- 2 root root pool003
</pre>
<p>This filename is hardlinked to the mapped accountname. Creating this hardlink is designed to be an atomic operation and verified to work on large installations serving multiple services from one NFS-share.</p><p>The VOMS credentials need to be available from the LCMAPS framework.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-gridmapfile </strong><em>gridmapfile</em></p>
  </dt>
  <dd>
    <p>This file must contain FQANs to (local) user account names. If this option is set, it will override the default path of the gridmapfile.  It is advised to use an absolute path to the gridmapfile to avoid usage of the wrong file(path).</p>
  </dd>
  <dt>
    <p><strong>-gridmapdir </strong><em>gridmapdir</em></p>
  </dt>
  <dd>
    <p>A directory used for the mapping database.</p>
  </dd>
  <dt>
    <p><strong>--add-primary-gid-from-mapped-account</strong></p>
  </dt>
  <dd>
    <p>After the account is mapped, add the primary Group ID from the passwd-file/LDAP of the mapped account as a part of the mapping result. Default is to not add the primary Group ID.</p>
  </dd>
  <dt>
    <p><strong>--do-not-add-primary-gid-from-mapped-account</strong></p>
  </dt>
  <dd>
    <p>After the account is mapped, explicitly avoid adding the primary Group ID from the passwd-file/LDAP of the mapped account as a part of the mapping result.. Default is to not add the primary Group ID.</p>
  </dd>
  <dt>
    <p><strong>--add-primary-gid-as-secondary-gid-from-mapped-account</strong></p>
  </dt>
  <dd>
    <p>After the account is mapped, add the primary Group ID from the passwd-file/LDAP of the mapped account as a secondary Group ID as a part of the mapping result.</p>
  </dd>
  <dt>
    <p><strong>--add-secondary-gids-from-mapped-account</strong></p>
  </dt>
  <dd>
    <p>After the account is mapped, add the secondary Group ID from the groups-file/LDAP of the mapped account as a secondary Group ID(s) as a part of the mapping result.</p>
  </dd>
  <dt>
    <p><strong>--do-not-require-primary-gid</strong></p>
  </dt>
  <dd>
    <p>This option will inspect the LCMAPS mapping store and fail enforce the existence of a primary Group ID prior to running this plug-in. When enabled the plug-in will ignore the absence of the primary Group ID prior to its own mapping sequences. This plugin or the next plug-in must map the user's credentials to a primary Group ID in an LCMAPS plug-in execution policy. Default is: do not require a primary GID.</p>
  </dd>
  <dt>
    <p><strong>--require-primary-gid</strong></p>
  </dt>
  <dd>
    <p>This option will inspect the LCMAPS mapping store and fail enforce the existence of a primary Group ID prior to running this plug-in. When enabled the plug-in will fail before doing anything on the grounds of the primary Group ID nonexistence. The solution is to make sure that another plug-in is ensured to map the user's credentials to a primary Group ID. Default is: do not require a primary GID.</p>
  </dd>
  <dt>
    <p><strong>-override_inconsistency</strong></p>
  </dt>
  <dd>
    <p>If the poolaccount is mapped from an URL-encoded Subject DN and Unix Group names to an account, and when the gridmapfile states that this user needs to move to another pool, then the plug-in will remap the user to the new pool. Without this option the plug-in will fail if an existing mapping for the user credentials exist, but do not map the configured mapping pool.</p>
  </dd>
  <dt>
    <p><strong>-max_mappings_per_credential </strong><em>max_mappings_per_credential</em></p>
  </dt>
  <dd>
    <p>This feature is deprecated. It was intended to work together with the Globus Dynamic Account Service/Workspace Service. This value indicates the maximum number of accounts a user, or more specifically a set of credentials (=DN + FQANS), can be mapped to.  Normally this number is 1.  But if each job should run under its own account the number should be increased.  The leasename (or poolindex) in this case looks like:</p>
<pre>
        <strong>url_encoded(&lt;DN&gt;):gid1[:gid2[:gid3[...]]]:mapcount=&lt;mapnumber&gt;)</strong>
</pre>

  </dd>
  <dt>
    <p><strong>-strict_poolprefix_match </strong><em>yes/no</em></p>
  </dt>
  <dd>
    <p>If this is set to 'yes', a line in the gridmapfile like <strong>&lt;FQAN&gt; .pool</strong> will result in accounts matching the regexp <strong>pool[0-9]+</strong>. Otherwise it will be allowed to match <strong>pool.*</strong> (legacy behaviour).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>LCMAPS_MOD_SUCCESS</strong></p>
  </dt>
  <dd>
    <p>Success.</p>
  </dd>
  <dt>
    <p><strong>LCMAPS_MOD_FAIL</strong></p>
  </dt>
  <dd>
    <p>Failure.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>Since version 1.6.0 the voms_poolaccount plugin also takes the <strong> requested</strong> username  (such as forwarded by gsissh) into consideration. When present, the resulting poolaccount has to match it in order for the plugin to succeed. This requires LCMAPS version 1.6.0 or newer.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Please report any errors to the Nikhef Grid Middleware Security Team &lt;grid-mw-security-support@nikhef.nl&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO lcmaps_voms_poolaccount.mod&hellip;</h2>
        <div class="sectioncontent">
<p><strong>lcmaps.db</strong>(5), <a href="../man3/lcmaps.3.html"><strong>lcmaps</strong>(3)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>LCMAPS and the LCMAPS plug-ins were written by the Grid Middleware Security Team &lt;grid-mw-security@nikhef.nl&gt;.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="lcmaps_voms_localgroup.mod.8.html"><span aria-hidden="true">&larr;</span> lcmaps_voms_localgroup.mod.8: Lcmaps plugin to switch user identity based on voms credentials by local groups</a></li>
   <li class="next"><a href="lcmaps_voms_poolgroup.mod.8.html">lcmaps_voms_poolgroup.mod.8: Lcmaps plugin to switch user identity based on voms credentials by pool groups <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
