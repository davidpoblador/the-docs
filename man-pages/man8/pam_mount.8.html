<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pam_mount: None</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="None">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="pam_mount (8) manual">
  <meta name="twitter:description" content="None">
  <meta name="twitter:image" content="https://www.carta.tech/images/libpam-mount-pam_mount-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/pam_mount.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="pam_mount (8) manual" />
  <meta property="og:description" content="None" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libpam-mount-pam_mount-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pam_mount<small> (8)</small></h1>
        <p class="lead">None</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/pam_mount.8.html">
      <span itemprop="name">pam_mount: None</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libpam-mount/">
      <span itemprop="name">libpam-mount</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/pam_mount.8.html">
      <span itemprop="name">pam_mount: None</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">Name</h2>
        <div class="sectioncontent">
<p>pam_mount - A PAM module that can mount volumes for a user session</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Overview</h2>
        <div class="sectioncontent">
<p>This module is aimed at environments with central file servers that a user wishes to mount on login and unmount on logout, such as (semi-)diskless stations where many users can logon and where statically mounting the entire /home from a server is a security risk, or listing all possible volumes in /etc/fstab is not feasible.</p><ul>
<li><p>Users can define their own list of volumes without having to change (possibly non-writable) global config files.</p></li><li><p>Single sign-on feature - the user needs to type the password just once (at login)</p></li><li><p>Transparent mount process</p></li><li><p>No stored passwords</p></li><li><p>Volumes are unmounted on logout, freeing system resources and not leaving data exposed.</p></li>
</ul><p>The module also supports mounting local filesystems of any kind the normal mount utility supports, with extra code to make sure certain volumes are set up properly because often they need more than just a mount call, such as encrypted volumes. This includes SMB/CIFS, FUSE, dm-crypt and LUKS.</p><p>If you intend to use pam_mount to protect volumes on your computer using an encrypted filesystem system, please know that there are many other issues you need to consider in order to protect your data. For example, you probably want to disable or encrypt your swap partition (the cryptoswap can help you do this). Do not assume a system is secure without carefully considering potential threats.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Configuration</h2>
        <div class="sectioncontent">
<p>The primary configuration file for the pam_mount module is pam_mount.conf.xml. On most platforms this file is read from /etc/security/pam_mount.conf.xml. On OpenBSD pam_mount reads its configuration file from /etc/pam_mount.conf.xml. See <a href="../man5/pam_mount.conf.5.html"><strong>pam_mount.conf</strong>(5)</a> documenting its use.</p><p>Individual users may define additional volumes to mount if allowed by pam_mount.conf.xml (usually ~/.pam_mount.conf.xml). The volume keyword is the only valid keyword in these per-user configuration files. If the luserconf parameter is set in pam_mount.conf.xml, allowing user-defined volume, then users may mount and unmount any volume they own at any mount point they own. On some filesystem configurations this may be a security flaw so user-defined volumes are not allowed by the example pam_mount.conf.xml distributed with pam_mount.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PAM configuration</h2>
        <div class="sectioncontent">
<p>In addition, you must include two entries in the system's applicable /etc/pam.d/<em>service</em> config files, as the following example shows:</p><ul>
<li>
<pre>
    auth     required  pam_securetty.so
    auth     required  pam_pwdb.so shadow nullok
    auth     required  pam_nologin.so
+++ auth     optional  pam_mount.so
    account  required  pam_pwdb.so
    password required  pam_cracklib.so
    password required  pam_pwdb.so shadow nullok use_authtok
    session  required  pam_pwdb.so
    session  optional  pam_console.so
+++ session  optional  pam_mount.so
</pre>
</li>
</ul><p>When "sufficient" is used in the second column, you must make sure that pam_mount is added before this entry. Otherwise pam_mount will not get executed should a previous PAM module succeed. Also be aware of the "include" statements. These make PAM look into the specified file. If there is a "sufficient" statement, then the pam_mount entry must either be in the included file before the "sufficient" statement or before the "include" statement.</p><p>If you use pam_ldap, pam_winbind, or any other authentication services that make use of PAM's sufficient keyword, model your configuration on the following order:</p><ul>
<li>
<pre>
&bull;&bull;&bull;
account sufficient  pam_ldap.so
auth    required    pam_mount.so
auth    sufficient  pam_ldap.so use_first_pass
auth    required    pam_unix.so use_first_pass
session optional    pam_mount.so
&bull;&bull;&bull;
</pre>
</li>
</ul><p>This allows for:</p>
<dl class='dl-vertical'>
  <dt>
    1.
  </dt>
  <dd>
    <p>pam_mount, as the first "auth" module, will prompt for a password and export it to the PAM system.</p>
  </dd>
  <dt>
    2.
  </dt>
  <dd>
    <p>pam_ldap will use the password from the PAM system to try and authenticate the user. If this succedes, the user will be authenticated. If it fails, pam_unix will try to authenticate.</p>
  </dd>
  <dt>
    3.
  </dt>
  <dd>
    <p>pam_unix will try to authenticate the user if pam_ldap failed. If pam_unix fails, then the authentication will be refused (due to the "required").</p>
  </dd>

</dl>
<p>Alternatively, the following is possible (thanks to Andrew Morgan for the hint!):</p><ul>
<li>
<pre>
auth [success=2 default=ignore] pam_unix2.so
auth [success=1 default=ignore] pam_ldap.so use_first_pass
auth requisite pam_deny.so
auth optional pam_mount.so
</pre>
</li>
</ul><p>It may seem odd, but the first three lines will make it so that at least one of pam_unix2 or pam_ldap has to succeed. As you can see, pam_mount will be run <strong>after</strong> successful authentication with these subsystems.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Encrypted disks</h2>
        <div class="sectioncontent">
<p>pam_mount supports a few types of crypto. The most common are encfs, dm-crypt and dm-crypt+LUKS.</p><p>The first one uses the FUSE layer; files within the encfs container are stored as single encrypted files on the host in a previously-existing directory. If you store lots of files, it is recommended to have a lower filesystem that is strong in this area, such as xfs, but some software and/or your partitioning decisions may force you to use a different fs. The 1:1 mapping of files also allows encrypted files to be reasonably efficiently rsync'ed for example without having to open the encrypted container. Creation is done through the <a href="../man1/encfs.1.html"><strong>encfs</strong>(1)</a> tool.</p><p>dm-crypt provides whole-filesystem/entire-partition encryption. You can also create a container file, but the idea is that it is represented as a block device on which you still have to create a filesystem. In fact, this way you can select a filesystem of your choice. The downside is that shrinking is often not possible (there is no such issue in encfs because it uses the lower fs). Suitable dm-crypt containers (and auxiliary files), using block devices or plain files, can be created using the <a href="../man8/pmt-ehd.8.html"><strong>pmt-ehd</strong>(8)</a> tool.</p><p>pmt-ehd creates filesystem key material which is a bunch of random bytes that will be used to en-/decrypt the volume. This material itself is encrypted with your own password - this is done so that you can change the password without having to reencrypt all of your data.</p><p>LUKS is an extension for dm-crypt to support multi-password containers. Unless you specifically need it, the above two solutions are recommended.</p><p>NOTE: The key file that <a href="../man8/pmt-ehd.8.html"><strong>pmt-ehd</strong>(8)</a> will create represents the filesystem key material as encrypted with your password. It is thus safe to store this on an unsecured filesystem.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Troubleshooting</h2>
        <div class="sectioncontent">
<p>To ensure that your system and, possibly, the remote server are all properly configured, you should try to mount all or some of the volumes by hand, using the same commands and mount points provided in pam_mount.conf.xml. This will save you a lot of grief, since it is more difficult to debug the mounting process via pam_mount.</p><p>If you can mount the volumes by hand but it is not happening via pam_mount, you may want to enable the "debug" option in pam_mount.conf.xml to see what is happening.</p><p>Verify if the user owns the mount point and has sufficient permissions over that. pam_mount will verify this and will refuse to mount the remote volume if the user does not own that directory.</p><p>If pam_mount is having trouble unmounting volumes upon logging out, enable the debug variable. This causes pam_mount to run ofl on logout and write its output to the system's log.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Authors</h2>
        <div class="sectioncontent">
<p>W. Michael Petullo</p><p>Jan Engelhardt (current maintainer)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Community Support</h2>
        <div class="sectioncontent">
<p>The following two forms of communication are available. The maintainer has no preference, though you will reach more users who could answer by means of the mailing list.</p>
<dl class='dl-vertical'>
  <dt>
    <p>Mailing List:</p>
  </dt>
  <dd>
    <p>http://sf.net/mail/?group_id=41452</p>
  </dd>
  <dt>
    <p>Bug Tracker (no registration needed):</p>
  </dt>
  <dd>
    <p>http://sf.net/tracker/?group_id=41452</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pam_motd.8.html"><span aria-hidden="true">&larr;</span> pam_motd.8: Display the motd file</a></li>
   <li class="next"><a href="pam_namespace.8.html">pam_namespace.8: Pam module for configuring namespace for a session <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
