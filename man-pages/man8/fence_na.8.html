<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>fence_na: Fence_na  this is the fence agent for the node assassin fence device.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Fence_na  this is the fence agent for the node assassin fence device.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="fence_na (8) manual">
  <meta name="twitter:description" content="Fence_na  this is the fence agent for the node assassin fence device.">
  <meta name="twitter:image" content="https://www.carta.tech/images/fence-agents-fence_na-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/fence_na.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="fence_na (8) manual" />
  <meta property="og:description" content="Fence_na  this is the fence agent for the node assassin fence device." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/fence-agents-fence_na-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">fence_na<small> (8)</small></h1>
        <p class="lead">Fence_na  this is the fence agent for the node assassin fence device.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/fence_na.8.html">
      <span itemprop="name">fence_na: Fence_na  this is the fence agent for the node assassin fence device.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/fence-agents/">
      <span itemprop="name">fence-agents</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/fence_na.8.html">
      <span itemprop="name">fence_na: Fence_na  this is the fence agent for the node assassin fence device.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  fence_na -a fence_na01.domain.com -n 2 -l admin -p secret -o off
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This fence agent takes argument from the command line or from the 'fenced' program and interprets them into calls to send to the Node Assassin fence device. It analyzes the returned information and exits with an appropriate exit code as dictated by the FenceAgentAPI.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE</h2>
        <div class="sectioncontent">
<p>Arguments are read from \s-1STDIN\s0 as 'variable=value' pairs, one pair per new line. This is the method used by 'fenced'.</p><p>For testing or manual control, arguments may be passed as command line arguments.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OVERVIEW</h2>
        <div class="sectioncontent">
<p>This takes arguments that defined which Node Assassin to call, what node to work on and what action should be taken. These arguments are defined by the FenceAgentAPI. These actions are then translated into a set of Node Assassin states which then get passed to the device. The FenceAgentAPI refers to \*(L"ports\*(R" while the Node Assassin refers to \*(L"nodes\*(R". These two terms are thus used interchangably. The reason for the difference is that, internally, Node Assassin maps each node to three \*(L"ports\*(R"; The node's power and reset buttons plus the node's power feed.</p><p>Each node in the Node Assassin can be set to one of four states described in the next section.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NODE ASSASSIN STATES</h2>
        <div class="sectioncontent">
<p>Each Node Assassin port can be set to one of four states. They are: This will release the fence on the specified \s-1NA\s0 node's power and reset ports. This state will fence the node specified by the \*(L"port\*(R" argument. The fence will remain active until released. Further, the fence will \*(L"lock out\*(R" the node's front-panel buttons until the fence is released. This will fence the node for one second. This is meant to provide a mechanism to boot or initiate a clean shut down of a node. This state will fence the node for five seconds to 30 seconds, depending on how long it takes for the power feed to drop low. This is meant to provide a way to force crashed nodes to power off without the front-panel lock.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>Which options are valid depends on how the arguments are passed in. The \*(L"main\*(R" method of passing arguments is via \s-1STDIN\s0 as a series of 'varible=value' pairs, one per line. All arguments accepted this way have command-line arguments passed in via single-dashes switches. Each option below shows either calling method's arguments, where available. Prints this help message. Prints the version of this fence agent and then the version of any configured, reachable Node Assassins. Tells this fence agent to only print critical messages. Tells this fence agent to print debug messages. Tells the fence agent which Node Assassin to use.</p><p><em>\s-1NOTE\s0!</em> The name or \s-1IP\s0 addresses *MUST* match a name or \s-1IP\s0 address defined in \*(C`/etc/cluster/fence_na.conf\*(C'! Specifically, it must match one of the \*(C`node::X::ipaddr\*(C' entries where \*(C`X\*(C' is the \s-1ID\s0 of the Node Assassin. This is the login name used to connect to this fence agent. It must match the value \*(C`system::username\*(C' in \*(C`/etc/cluster/fence_na.conf\*(C'. This is the login password used to connect to this fence agent. It must match the value \*(C`system::password\*(C' in \*(C`/etc/cluster/fence_na.conf\*(C'. This tells the fence agent which node to act on.</p><p><em>\s-1NOTE\s0!</em> Please do not confuse this with the Node Assassin's internal concept of a port. This is the \*(C`action\*(C' (formerly \*(C`option\*(C') to perform on the selected node. Valid actions and how Node Assassin implements them are:</p><p><em></em><strong>\*(C`off\*(C'</strong><em></em></p><p>This set's the node to state 1; Fenced. Internally, it will hit the reset switch for one second to immediately disable the node. Then it will release the reset switch for another second before pressing and holding the power switch. After five seconds, Node Assassin will check the node's power feed. If it is still on, it will wait another 25 seconds and check again. If the node is still on, an error will be generated. If the node turns off successfully, the fence is declared a success. reboot</p><p><em></em><strong>\*(C`on\*(C'</strong><em></em></p><p>This sets the node to state '0'; Unfenced. Both the power and reset switches are opened, the Node Assassin will pause for one second and then the power switch will be closed for one second to boot the node (that is, the node is set to \*(L"state 2\*(R").</p><p><em></em><strong>\*(C`reboot\*(C'</strong><em></em></p><p><em>Note</em>: This will do a hard reboot! Do not use when a normal restart would suffice.</p><p>This essetially just calls an \*(C`off\*(C' and then an \*(C`on\*(C'. However, the <strong>fence_na</strong> agent will return a success (exit 0) even if the \*(C`on\*(C' stage succeeded. As per the FenceAgentAPI, a reboot does not need to successfully boot the node to be concidered a success, it only needs to shut it down.</p><p><em></em><strong>\*(C`status\*(C'</strong><em></em></p><p>This checks the power feed for the requested node is checked. If the node is on, the agent will exit with code 0. If the node is off (or disconnected), it will exit with code 1. If an error occurred calling the Node Assassin, this will exit with code 2.</p><p>Note that this argument is designed to be used by the fence agent and will not print any output to \*(C`STDOUT\*(C'.</p><p><em></em><strong>\*(C`monitor\*(C'</strong><em>, </em><strong>\*(C`list\*(C'</strong><em></em></p><h3>Node Assassin Specific Actions</h3>
<p><em>\s-1NOTE\s0</em>: The following states are supported by Node Assassin only. These states are not used by the \*(C`fenced\*(C' daemon and are provided here as a convenience for the user.</p><p>Any commands named *_all ignore the node value, if set. If the node is fenced, the fence will be released. The difference from \*(C`on\*(C' being that this will not boot the node after the fence is released. This does a \*(C`release\*(C' on all fenced nodes. All nodes are fenced. See the \*(C`off\*(C' state above. The power feed of the specific node on the Node Assassin is checked. If it is found to be off, it will be set to state 2 to initiate boot. The power feeds of all nodes on the Node Assassin are checked. Any found to be off are set to state 2 to initiate boot. The power feed of the specific node on the Node Assassin is checked. If it is found to be on, it will be set to state 2 to initiate an ACPI-induced soft shutdown. The power feeds of all nodes on the Node Assassin are checked. Any found to be on are set to state 2 to initiate an ACPI-induced soft shutdown. The power feeds of all nodes on the Node Assassin are checked. Any found to be on are set to state 3. This state is similar to state 1 (see "\*(C`off\*(C'" above), except that the node's front-panel switches are not disabled after the fence completes.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>To simulate how 'fenced' calls the script, create a text file called \*(C`args.txt\*(C' containing:</p><p>  # Test file used as input for the NA fence agent.   ipaddr=fence_na01.domain.com   port=02   login=admin   passwd=secret   action=reboot</p><p>Now use \*(C`cat\*(C' to pipe the contents into the fence agent:</p><p>  cat args.txt | fence_na</p><p>This will call the \*(C`off\*(C' function against node #02 connected to the Node Assassin at \*(C`fence_na01.domain.com\*(C', fencing it. Change the \*(C`action\*(C' line to \*(C`action=on\*(C' and re-run the script to release the fence and boot the node.</p><p>To duplicate the same call using command line arguments:</p><p>  fence_na -a fence_na01.domain.com -n 2 -l admin -p secret -o reboot</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO fence_na&hellip;</h2>
        <div class="sectioncontent">
<p>http://nodeassassin.org</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">UPDATED</h2>
        <div class="sectioncontent">
<p>Nov. 27, 2010</p><p>Digimer (digimer@alteeve.com)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="fence_mcdata.8.html"><span aria-hidden="true">&larr;</span> fence_mcdata.8: I/o fencing agent for mcdata fc switches</a></li>
   <li class="next"><a href="fence_node.8.html">fence_node.8: A utility to run fence agents <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
