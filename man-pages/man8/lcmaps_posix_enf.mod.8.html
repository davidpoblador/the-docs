<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>lcmaps_posix_enf.mod: Lcmaps plugin to switch user identity</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Lcmaps plugin to switch user identity">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="lcmaps_posix_enf.mod (8) manual">
  <meta name="twitter:description" content="Lcmaps plugin to switch user identity">
  <meta name="twitter:image" content="https://www.carta.tech/images/lcmaps-plugins-basic-posixenf-lcmaps_posix_enf.mod-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/lcmaps_posix_enf.mod.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="lcmaps_posix_enf.mod (8) manual" />
  <meta property="og:description" content="Lcmaps plugin to switch user identity" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/lcmaps-plugins-basic-posixenf-lcmaps_posix_enf.mod-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">lcmaps_posix_enf.mod<small> (8)</small></h1>
        <p class="lead">Lcmaps plugin to switch user identity</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/lcmaps_posix_enf.mod.8.html">
      <span itemprop="name">lcmaps_posix_enf.mod: Lcmaps plugin to switch user identity</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/lcmaps-plugins-basic-posixenf/">
      <span itemprop="name">lcmaps-plugins-basic-posixenf</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/lcmaps_posix_enf.mod.8.html">
      <span itemprop="name">lcmaps_posix_enf.mod: Lcmaps plugin to switch user identity</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>lcmaps_posix_enf.mod</strong> [<strong>-maxuid</strong> <em>number of uids</em>] [<strong>-maxpgid</strong> <em>number of primary gids</em>] [<strong>-maxsgid</strong> <em>number of secondary gids</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The Posix Enforcement plugin will enforce (apply) the gathered credentials that are stacked in the datastructure of the Plugin Manager. The plugin will get the credential information that is gathered by one or more Acquisition plugins. This implies that at least one Acquisition should have been run prior to this Enforcement. All of the gathered information will be checked by looking into the 'passwd' file of the system (FIXME: shouldn't that be <strong>getpwent</strong>(2)?). These files have information about all registered system account and its user groups.</p><p>The Posix Enforcement plugin does not check whether the secondary groups have the primary UID as a member, so it is possible to end up with more group memberships than what is defined in the group database.</p><p>The (BSD/POSIX) functions <a href="../man2/setreuid.2.html"><strong>setreuid</strong>(2)</a>, <a href="../man2/setregid.2.html"><strong>setregid</strong>(2)</a> and <a href="../man2/setgroups.2.html"><strong>setgroups</strong>(2)</a> are used to change the privileges of the process from root to that of a local user.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-maxuid </strong><em>number of uids</em></p>
  </dt>
  <dd>
    <p>In principle, this will set the maximum number of allowed UIDs that this plugin will handle, but at the moment only the first UID found will be enforced; the others will discarded.  By setting the value to a maximum there will be a failure raised when the amount of UIDs exceed the set maximum. Without this value the plugin will continue and will enforce only the first found value in the credential data structure.</p>
  </dd>
  <dt>
    <p><strong>-maxpgid </strong><em>number of primary gids</em></p>
  </dt>
  <dd>
    <p>This will set the maximum number of allowed Primary GIDs that this plugin will handle, similar to <strong>-maxuid</strong>. Also here only the first primary GID found will be taken into account.</p>
  </dd>
  <dt>
    <p><strong>-maxsgid </strong><em>number of secondary gids</em></p>
  </dt>
  <dd>
    <p>This will set the maximum allowed Secondary GIDs that this plugin will handle. This number is limited by the system (NGROUPS) and is usually 32. If the plugin cannot determine the system value, it limits itself to 32.</p>
  </dd>

</dl>
<p>The remaining options are considered dangerous, as they have the potential to allow a client process to gain root privileges. <strong>The use of these options is strongly discouraged.</strong></p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-set_only_euid</strong> {<strong>yes</strong>|<strong>no</strong>}</p>
  </dt>
  <dd>
    <p>The result of setting this option to 'yes' is that only the effective uid is set. In other words, it is still possible to regain root (uid) privileges for the process. This is definitely undesirable if this module is used from a process like the gatekeeper, since it would be possible for user jobs to get root privileges.</p>
  </dd>
  <dt>
    <p><strong>-set_only_egid</strong> {<strong>yes</strong>|<strong>no</strong>}</p>
  </dt>
  <dd>
    <p>Analogue to the previous option the result of setting this option to 'yes' is that only the effective (primary) gid is set.  In other words, it is still possible to regain root (gid) privileges for the process.  This is definitely undesirable if this module is used from a process like the gatekeeper, since it would be possible for user jobs to get root privileges. Possibly this option should be set if the module is used by gridFTP, since this service does not spawn user jobs and has to regain root pivileges at the end.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>LCMAPS_MOD_SUCCESS</strong></p>
  </dt>
  <dd>
    <p>Success.</p>
  </dd>
  <dt>
    <p><strong>LCMAPS_MOD_FAIL</strong></p>
  </dt>
  <dd>
    <p>Failure.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Please report any errors to the Nikhef Grid Middleware Security Team &lt;grid-mw-security-support@nikhef.nl&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO lcmaps_posix_enf.mod&hellip;</h2>
        <div class="sectioncontent">
<p><strong>lcmaps.db</strong>(5), <a href="../man3/lcmaps.3.html"><strong>lcmaps</strong>(3)</a>, <a href="../man3/getpwent.3.html"><strong>getpwent</strong>(3)</a>, <a href="../man3/getgrent.3.html"><strong>getgrent</strong>(3)</a>, <a href="../man2/setreuid.2.html"><strong>setreuid</strong>(2)</a>, <a href="../man2/setregid.2.html"><strong>setregid</strong>(2)</a>, <a href="../man2/setgroups.2.html"><strong>setgroups</strong>(2)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>LCMAPS and the LCMAPS plug-ins were written by the Grid Middleware Security Team &lt;grid-mw-security@nikhef.nl&gt;.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="lcmaps_poolaccount.mod.8.html"><span aria-hidden="true">&larr;</span> lcmaps_poolaccount.mod.8: Lcmaps plugin to switch user identity by pool accounts</a></li>
   <li class="next"><a href="lcmaps_verify_proxy.mod.8.html">lcmaps_verify_proxy.mod.8: Lcmaps plugin to verify a certificate chain including proxies <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
