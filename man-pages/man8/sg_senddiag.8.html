<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>sg_senddiag: Performs a scsi send diagnostic command</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Performs a scsi send diagnostic command">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="sg_senddiag (8) manual">
  <meta name="twitter:description" content="Performs a scsi send diagnostic command">
  <meta name="twitter:image" content="https://www.carta.tech/images/sg3-utils-sg_senddiag-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/sg_senddiag.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="sg_senddiag (8) manual" />
  <meta property="og:description" content="Performs a scsi send diagnostic command" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/sg3-utils-sg_senddiag-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">sg_senddiag<small> (8)</small></h1>
        <p class="lead">Performs a scsi send diagnostic command</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/sg_senddiag.8.html">
      <span itemprop="name">sg_senddiag: Performs a scsi send diagnostic command</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/sg3-utils/">
      <span itemprop="name">sg3-utils</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/sg_senddiag.8.html">
      <span itemprop="name">sg_senddiag: Performs a scsi send diagnostic command</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>sg_senddiag</strong> [<em>--doff</em>] [<em>--extdur</em>] [<em>--help</em>] [<em>--hex</em>] [<em>--list</em>] [<em>--pf</em>] [<em>--raw=H,H...</em>] [<em>--raw=-</em>] [<em>--selftest=ST</em>] [<em>--test</em>] [<em>--uoff</em>] [<em>--verbose</em>] [<em>--version</em>] <em>DEVICE</em></p><p><strong>sg_senddiag</strong> [<em>-doff</em>] [<em>-e</em>] [<em>-h</em>] [<em>-H</em>] [<em>-l</em>] [<em>-pf</em>] [<em>-raw=H,H...</em>] [<em>-raw=-</em>] [<em>-s=ST</em>] [<em>-t</em>] [<em>-uoff</em>] [<em>-v</em>] [<em>-V</em>] [<em>-?</em>] <em>DEVICE</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This utility sends a SCSI SEND DIAGNOSTIC command to the <em>DEVICE</em>. It can issue self-tests, find supported diagnostic pages or send arbitrary diagnostic pages.</p><p>When the <em>--list</em> option and a <em>DEVICE</em> are given then the utility sends a SCSI RECEIVE DIAGNOSTIC RESULTS command to fetch the response (i.e. the page numbers of supported diagnostic pages).</p><p>When the <em>--list</em> option is given without a <em>DEVICE</em> then a list of diagnostic page names and their numbers, known by this utility, are listed.</p><p>This utility supports two command line syntax-es, the preferred one is shown first in the synopsis and explained in this section. A later section on the old command line syntax outlines the second group of options.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>Arguments to long options are mandatory for short options as well.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-d</strong>, <strong>--doff</strong></p>
  </dt>
  <dd>
    <p>set the Device Offline (DevOffL) bit (default is clear). Only significant when <em>--test</em> option is set for the default self-test. When set other operations on any logical units controlled by the this device server (target) may be affected (delayed) while a default self-test is underway.</p>
  </dd>
  <dt>
    <p><strong>-e</strong>, <strong>--extdur</strong></p>
  </dt>
  <dd>
    <p>outputs the expected extended self-test duration. The duration is given in seconds (and minutes in parentheses). This figure is obtained from mode page 0xa (i.e. the control mode page).</p>
  </dd>
  <dt>
    <p><strong>-h</strong>, <strong>--help</strong></p>
  </dt>
  <dd>
    <p>print usage message then exit.</p>
  </dd>
  <dt>
    <p><strong>-H</strong>, <strong>--hex</strong></p>
  </dt>
  <dd>
    <p>outputs response from RECEIVE DIAGNOSTIC RESULTS in hex rather than decode it.</p>
  </dd>
  <dt>
    <p><strong>-l</strong>, <strong>--list</strong></p>
  </dt>
  <dd>
    <p>when a <em>DEVICE</em> is also given lists the names of all diagnostic pages supported by this device. The request is sent via a SEND DIAGNOSTIC command (with the "pF" bit set) and the response is fetched by a RECEIVE DIAGNOSTIC RESULTS command. When used in the absence of a <em>--list</em> argument then a list of diagnostic page names and their numbers, known by this utility, are listed.</p>
  </dd>
  <dt>
    <p><strong>-O</strong>, <strong>--old</strong></p>
  </dt>
  <dd>
    <p>switch to older style options.</p>
  </dd>
  <dt>
    <p><strong>-p</strong>, <strong>--pf</strong></p>
  </dt>
  <dd>
    <p>set Page Format (PF) bit. By default it is clear (i.e. 0) unless the list <em>--list</em> option is given in which case the Page Format bit is set (as required by SPC-3).</p>
  </dd>
  <dt>
    <p><strong>-r</strong>, <strong>--raw</strong>=<em>H,H...</em></p>
  </dt>
  <dd>
    <p>string of comma separated hex numbers each of which should resolve to a byte value (i.e. 0 to ff inclusive). A (single) space separated string of hex bytes is also allowed but the list needs to be in quotes. This sequence forms a diagnostic page to be sent with the SCSI SEND DIAGNOSTIC command. Mostly likely the <em>--pf</em> option should also be given.</p>
  </dd>
  <dt>
    <p><strong>-r</strong>, <strong>--raw=-</strong></p>
  </dt>
  <dd>
    <p>reads sequence of bytes from stdin. The sequence may be comma, space, tab or linefeed (newline) separated. If a line contains "#" then the remaining characters on that line are ignored. Otherwise each non separator character should resolve to a byte value (i.e. 0 to ff inclusive). This sequence forms a diagnostic page to be sent with the SCSI SEND DIAGNOSTIC command. Mostly likely the <em>--pf</em> option should also be given.</p>
  </dd>
  <dt>
    <p><strong>-s</strong>, <strong>--selftest</strong>=<em>ST</em></p>
  </dt>
  <dd>
    <p>where <em>ST</em> is the self-test code. The default value is 0 which is inactive. Some other values:</p>
<pre>
  <strong>1</strong> : background short self-test
</pre>

<pre>
  <strong>2</strong> : background extended self-test
</pre>

<pre>
  <strong>4</strong> : aborts a (background) self-test that is in progress
</pre>

<pre>
  <strong>5</strong> : foreground short self-test
</pre>

<pre>
  <strong>6</strong> : foreground extended self-test
</pre>
<p>This option is mutually exclusive with default self-test (i.e. can't have (<em>ST</em> &gt; 0) and <em>--test</em>).</p>
  </dd>
  <dt>
    <p><strong>-t</strong>, <strong>--test</strong></p>
  </dt>
  <dd>
    <p>sets the _default_ Self Test (SelfTest) bit. By default this is clear (0). The <em>--selftest=ST</em> option should not be active together with this option. Both the <em>--doff</em> and/or <em>--uoff</em> options can be used with this option.</p>
  </dd>
  <dt>
    <p><strong>-u</strong>, <strong>--uoff</strong></p>
  </dt>
  <dd>
    <p>set the Unit Offline (UnitOffL) bit (default is clear). Only significant when <em>--test</em> option is set for the default self-test. When set other operations on this logical unit may be affected (delayed) while a default self-test is underway. Some devices (e.g. Fujitsu disks) do more tests when this bit is set.</p>
  </dd>
  <dt>
    <p><strong>-v</strong>, <strong>--verbose</strong></p>
  </dt>
  <dd>
    <p>increase level of verbosity. Can be used multiple times.</p>
  </dd>
  <dt>
    <p><strong>-V</strong>, <strong>--version</strong></p>
  </dt>
  <dd>
    <p>print out version string then exit.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>All devices should support the default self-test. The 'short' self-test codes should complete in 2 minutes or less. The 'extended' self-test codes' maximum duration is vendor specific (e.g. a little over 10 minutes with the author's disks). The foreground self-test codes wait until they are completed while the background self-test codes return immediately. The results of both foreground and background self-test codes are placed in the 'self-test results' log page (see <a href="../man8/sg_logs.8.html"><strong>sg_logs</strong>(8)</a>). The SCSI command timeout for this utility is set to 60 minutes to allow for slow foreground extended self-tests.</p><p>If the <em>DEVICE</em> is a disk then no file systems residing on that disk should be mounted during a foreground self-test. The reason is that other SCSI commands may become queued behind the foreground self-test and timeout.</p><p>When the <em>--raw=H,H...</em> option is given then self-tests should not be selected. However the <strong>--pf</strong> (i.e. "page format") option should be given. The length of the diagnostic page to be sent is derived from the number of bytes given to the <em>--raw=H,H...</em> option. The diagnostic page code (number) should be the first byte of the sequence (i.e. as dictated by SPC-3 diagnostic page format). See the EXAMPLES section below.</p><p>Arbitrary diagnostic pages can be read (in hex) with the <a href="../man8/sg_ses.8.html"><strong>sg_ses</strong>(8)</a> utility (not only those defined in SES-2).</p><p>If the utility is used with no options (e.g. "sg_senddiag /dev/sg1") Then a degenerate SCSI SEND DIAGNOSTIC command is sent with zero in all its fields apart from the opcode. Some devices report this as an error while others ignore it. It is not entirely clear from SPC-3 if it is invalid to send such a command.</p><p>In the 2.4 series of Linux kernels the <em>DEVICE</em> must be a SCSI generic (sg) device. In the 2.6 series block devices (e.g. SCSI disks and DVD drives) can also be specified.</p><p>To access SCSI enclosures see the <a href="../man8/sg_ses.8.html"><strong>sg_ses</strong>(8)</a> utility. sg_ses uses the SCSI SEND DIAGNOSTIC and RECEIVE DIAGNOSTIC RESULTS commands as outlined in the SES-2 (draft) standard.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">
<p>The exit status of sg_senddiag is 0 when it is successful. Otherwise see the <a href="../man8/sg3_utils.8.html"><strong>sg3_utils</strong>(8)</a> man page.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OLDER COMMAND LINE OPTIONS</h2>
        <div class="sectioncontent">
<p>The options in this section were the only ones available prior to sg3_utils version 1.23 . In sg3_utils version 1.23 and later these older options can be selected by either setting the SG3_UTILS_OLD_OPTS environment variable or using '--old' (or '-O) as the first option.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-doff</strong></p>
  </dt>
  <dd>
    <p>set the Device Offline (DevOffL) bit (default is clear). Only significant when <em>-t</em> option is set for the default self-test. Equivalent to <em>--doff</em> in the main description.</p>
  </dd>
  <dt>
    <p><strong>-e</strong></p>
  </dt>
  <dd>
    <p>outputs the expected extended self-test duration. Equivalent to <em>--extdur</em> in the main description.</p>
  </dd>
  <dt>
    <p><strong>-h</strong></p>
  </dt>
  <dd>
    <p>outputs response from RECEIVE DIAGNOSTIC RESULTS in hex rather than decode it.</p>
  </dd>
  <dt>
    <p><strong>-H</strong></p>
  </dt>
  <dd>
    <p>outputs response from RECEIVE DIAGNOSTIC RESULTS in hex rather than decode it.</p>
  </dd>
  <dt>
    <p><strong>-l</strong></p>
  </dt>
  <dd>
    <p>when a <em>DEVICE</em> is also given lists the names of all diagnostic pages supported by this device. The request is sent via a SEND DIAGNOSTIC command (with the "pf" bit set) and the response is fetched by a RECEIVE DIAGNOSTIC RESULTS command. When used in the absence of a <em>DEVICE</em> argument then a list of diagnostic page names and their numbers, known by this utility, are listed.</p>
  </dd>
  <dt>
    <p><strong>-N</strong></p>
  </dt>
  <dd>
    <p>switch to the newer style options.</p>
  </dd>
  <dt>
    <p><strong>-pf</strong></p>
  </dt>
  <dd>
    <p>set Page Format (PF) bit. By default it is clear (i.e. 0) unless the <em>-l</em> option is given in which case the Page Format bit is set (as required by SPC-3).</p>
  </dd>
  <dt>
    <p><strong>-raw</strong>=<em>H,H...</em></p>
  </dt>
  <dd>
    <p>string of comma separated hex numbers each of which should resolve to a byte value (i.e. 0 to ff inclusive). This sequence forms a diagnostic page to be sent with the SCSI SEND DIAGNOSTIC command. Mostly likely the <em>-pf</em> option should also be given.</p>
  </dd>
  <dt>
    <p><strong>-raw=-</strong></p>
  </dt>
  <dd>
    <p>reads sequence of bytes from stdin. The sequence may be comma, space, tab or linefeed (newline) separated. If a line contains "#" then the remaining characters on that line are ignored. Otherwise each non separator character should resolve to a byte value (i.e. 0 to ff inclusive). This sequence forms a diagnostic page to be sent with the SCSI SEND DIAGNOSTIC command. Mostly likely the <em>-pf</em> option should also be given.</p>
  </dd>
  <dt>
    <p><strong>-s</strong>=<em>ST</em></p>
  </dt>
  <dd>
    <p>where <em>ST</em> is the self-test code. The default value is 0 which is inactive. A value of 1 selects a background short self-test; 2 selects a background extended self-test; 5 selects a foreground short self-test; 6 selects a foreground extended test. A value of 4 will abort a (background) self-test that is in progress. This option is mutually exclusive with default self-test (i.e. <em>-t</em>).</p>
  </dd>
  <dt>
    <p><strong>-t</strong></p>
  </dt>
  <dd>
    <p>sets the _default_ Self Test (SelfTest) bit. By default this is clear (0). The <em>-s=ST</em> option should not be active together with this option. Both the <em>-doff</em> and/or <em>-uoff</em> options can be used with this option.</p>
  </dd>
  <dt>
    <p><strong>-uoff</strong></p>
  </dt>
  <dd>
    <p>set the Unit Offline (UnitOffL) bit (default is clear). Equivalent to <em>--uoff</em> in the main description.</p>
  </dd>
  <dt>
    <p><strong>-v</strong></p>
  </dt>
  <dd>
    <p>increase level of verbosity. Can be used multiple times.</p>
  </dd>
  <dt>
    <p><strong>-V</strong></p>
  </dt>
  <dd>
    <p>print out version string then exit.</p>
  </dd>
  <dt>
    <p><strong>-?</strong></p>
  </dt>
  <dd>
    <p>output usage message. Ignore all other parameters.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>The examples sub-directory in the sg3_utils packages contains two example scripts that turn on the CJTPAT (jitter pattern) on some SAS disks (one script for each phy). One possible invocation for phy 1 is:</p>
<pre>
  sg_senddiag --pf --raw=- /dev/sg2 &lt; sdiag_sas_p1_cjtpat.txt
</pre>
<p>There is also an example script that turns on the IDLE pattern. Once a test pattern has been started it can be turned off by resetting the phy or with the STOP phy pattern function:</p>
<pre>
  sg_senddiag --pf --raw=- /dev/sg2 &lt; sdiag_sas_p1_stop.txt
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Written by Douglas Gilbert</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">
<p>Report bugs to &lt;dgilbert at interlog dot com&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2003-2011 Douglas Gilbert</p><p>This software is distributed under the GPL version 2. There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO sg_senddiag&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/sg_ses.8.html"><strong>sg_ses</strong>(8)</a>, <a href="../man8/sg_logs.8.html"><strong>sg_logs</strong>(8)</a>, smartmontools(see net)</strong></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="sg_scan.8.html"><span aria-hidden="true">&larr;</span> sg_scan.8: Scans sg devices (or scsi/atapi/ata devices) and prints results</a></li>
   <li class="next"><a href="sg_ses.8.html">sg_ses.8: Access a scsi enclosure services (ses) device <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
