<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>vfs_full_audit: Record samba vfs operations in the system log</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Record samba vfs operations in the system log">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="vfs_full_audit (8) manual">
  <meta name="twitter:description" content="Record samba vfs operations in the system log">
  <meta name="twitter:image" content="https://www.carta.tech/images/samba-vfs-modules-vfs_full_audit-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/vfs_full_audit.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="vfs_full_audit (8) manual" />
  <meta property="og:description" content="Record samba vfs operations in the system log" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/samba-vfs-modules-vfs_full_audit-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">vfs_full_audit<small> (8)</small></h1>
        <p class="lead">Record samba vfs operations in the system log</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/vfs_full_audit.8.html">
      <span itemprop="name">vfs_full_audit: Record samba vfs operations in the system log</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/samba-vfs-modules/">
      <span itemprop="name">samba-vfs-modules</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/vfs_full_audit.8.html">
      <span itemprop="name">vfs_full_audit: Record samba vfs operations in the system log</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>vfs objects = full_audit</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This VFS module is part of the <a href="../man7/samba.7.html"><strong>samba</strong>(7)</a> suite.</p><p>The vfs_full_audit VFS module records selected client operations to the system log using <a href="../man3/syslog.3.html"><strong>syslog</strong>(3)</a>.</p><p>vfs_full_audit is able to record the complete set of Samba VFS operations:</p><p>chdir</p><p>chflags</p><p>chmod</p><p>chmod_acl</p><p>chown</p><p>close</p><p>closedir</p><p>connect</p><p>copy_chunk_send</p><p>copy_chunk_recv</p><p>disconnect</p><p>disk_free</p><p>fchmod</p><p>fchmod_acl</p><p>fchown</p><p>fget_nt_acl</p><p>fgetxattr</p><p>flistxattr</p><p>fremovexattr</p><p>fset_nt_acl</p><p>fsetxattr</p><p>fstat</p><p>fsync</p><p>ftruncate</p><p>get_nt_acl</p><p>get_quota</p><p>get_shadow_copy_data</p><p>getlock</p><p>getwd</p><p>getxattr</p><p>kernel_flock</p><p>link</p><p>linux_setlease</p><p>listxattr</p><p>lock</p><p>lseek</p><p>lstat</p><p>mkdir</p><p>mknod</p><p>open</p><p>opendir</p><p>pread</p><p>pwrite</p><p>read</p><p>readdir</p><p>readlink</p><p>realpath</p><p>removexattr</p><p>rename</p><p>rewinddir</p><p>rmdir</p><p>seekdir</p><p>sendfile</p><p>set_nt_acl</p><p>set_quota</p><p>setxattr</p><p>stat</p><p>statvfs</p><p>symlink</p><p>sys_acl_delete_def_file</p><p>sys_acl_get_fd</p><p>sys_acl_get_file</p><p>sys_acl_set_fd</p><p>sys_acl_set_file</p><p>telldir</p><p>unlink</p><p>utime</p><p>write</p><p>In addition to these operations, vfs_full_audit recognizes the special operation names "all" and "none ", which refer to all the VFS operations and none of the VFS operations respectively.</p><p>vfs_full_audit records operations in fixed format consisting of fields separated by &apos;|&apos; characters. The format is:</p>
<pre>
		smbd_audit: PREFIX|OPERATION|RESULT|FILE

</pre>
<p>The record fields are:</p><p>PREFIX - the result of the full_audit:prefix string after variable substitutions</p><p>OPERATION - the name of the VFS operation</p><p>RESULT - whether the operation succeeded or failed</p><p>FILE - the name of the file or directory the operation was performed on</p><p>This module is stackable.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>vfs_full_audit:prefix = STRING</p><p>Prepend audit messages with STRING. STRING is processed for standard substitution variables listed in <a href="../man5/smb.conf.5.html"><strong>smb.conf</strong>(5)</a>. The default prefix is "%u|%I".</p><p>full_audit:success = LIST</p><p>LIST is a list of VFS operations that should be recorded if they succeed. Operations are specified using the names listed above. Operations can be unset by prefixing the names with "!". The default is all operations.</p><p>full_audit:failure = LIST</p><p>LIST is a list of VFS operations that should be recorded if they failed. Operations are specified using the names listed above. Operations can be unset by prefixing the names with "!". The default is all operations.</p><p>full_audit:facility = FACILITY</p><p>Log messages to the named <a href="../man3/syslog.3.html"><strong>syslog</strong>(3)</a> facility.</p><p>full_audit:priority = PRIORITY</p><p>Log messages with the named <a href="../man3/syslog.3.html"><strong>syslog</strong>(3)</a> priority.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Log file and directory open operations on the [records] share using the LOCAL7 facility and ALERT priority, including the username and IP address. Logging excludes the open VFS function on failures:</p>
<pre>
        <em>[records]</em>
	\m[blue]<strong>path = /data/records</strong>\m[]
	\m[blue]<strong>vfs objects = full_audit</strong>\m[]
	\m[blue]<strong>full_audit:prefix = %u|%I</strong>\m[]
	\m[blue]<strong>full_audit:success = open opendir</strong>\m[]
	\m[blue]<strong>full_audit:failure = all !open</strong>\m[]
	\m[blue]<strong>full_audit:facility = LOCAL7</strong>\m[]
	\m[blue]<strong>full_audit:priority = ALERT</strong>\m[]
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VERSION</h2>
        <div class="sectioncontent">
<p>This man page is correct for version 3.0.25 of the Samba suite.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>The original Samba software and related utilities were created by Andrew Tridgell. Samba is now developed by the Samba Team as an Open Source project similar to the way the Linux kernel is developed.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="vfs_fileid.8.html"><span aria-hidden="true">&larr;</span> vfs_fileid.8: Generates file_id structs with unique device id values for cluster setups</a></li>
   <li class="next"><a href="vfs_gpfs.8.html">vfs_gpfs.8: Gpfs specific samba extensions like acls and prealloc <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
