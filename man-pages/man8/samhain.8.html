<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>samhain: Check file integrity</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Check file integrity">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="samhain (8) manual">
  <meta name="twitter:description" content="Check file integrity">
  <meta name="twitter:image" content="https://www.carta.tech/images/samhain-samhain-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/samhain.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="samhain (8) manual" />
  <meta property="og:description" content="Check file integrity" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/samhain-samhain-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">samhain<small> (8)</small></h1>
        <p class="lead">Check file integrity</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/samhain.8.html">
      <span itemprop="name">samhain: Check file integrity</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/samhain/">
      <span itemprop="name">samhain</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/samhain.8.html">
      <span itemprop="name">samhain: Check file integrity</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<h3>INITIALIZING, UPDATING, AND CHECKING</h3>
<p><strong>samhain</strong> { <em>-t init|--set-checksum-test=init</em> } [--init2stdout] [-r DEPTH|--recursion=DEPTH] [log-options]</p><p><strong>samhain</strong> { <em>-t update|--set-checksum-test=update</em> } [-D | --daemon | --foreground] [--forever] [-r DEPTH|--recursion=DEPTH] [log-options]</p><p><strong>samhain</strong> { <em>-t check|--set-checksum-test=check</em> } [-D | --daemon | --foreground] [--forever] [-r DEPTH,--recursion=DEPTH] [log-options]</p>
<h3>LISTING THE DATABASE</h3>
<p><strong>samhain</strong> [-a | --full-detail] [--delimited] -d <em>file</em>| --list-database=<em>file</em></p>
<h3>VERIFYING AN AUDIT TRAIL</h3>
<p><strong>samhain</strong> [-j | --just-list] -L <em>logfile</em>| --verify-log=<em>logfile</em></p><p><strong>samhain</strong> -M <em>mailbox</em>| --verify-mail=<em>mailbox</em></p>
<h3>MISCELLANEOUS</h3>
<p><strong>samhain</strong> --server-port=<em>portnumber</em></p><p><strong>samhain</strong> -H <em>string</em> | --hash-string=<em>string</em></p><p><strong>samhain</strong> -c | --copyright</p><p><strong>samhain</strong> -v | --version</p><p><strong>samhain</strong> -h | --help</p><p><strong>samhain</strong> -V key@/path/to/executable | --add-key=key@/path/to/executable</p>
<h3>SERVER STARTUP</h3>
<p><strong>yule</strong> [-q | --qualified] [ --chroot=<em>chrootdir</em>] [-D | --daemon | --foreground] [log-options]</p>
<h3>SERVER MISCELLANEOUS</h3>
<p><strong>yule</strong> [-P <em>password</em> | --password=<em>password</em>]</p><p><strong>yule</strong> [-G | --gen-password]</p>
<h3>LOG OPTIONS</h3>
<p>[-s <em>threshold</em> | --set-syslog-severity=<em>threshold</em>] [-l <em>threshold</em> | --set-log-severity=<em>threshold</em>] [-m <em>threshold</em> | --set-mail-severity=<em>threshold</em>] [-e <em>threshold</em> | --set-export-severity=<em>threshold</em>] [-p <em>threshold</em> | --set-print-severity=<em>threshold</em>] [-x <em>threshold</em> | --set-external-severity=<em>threshold</em>] [ --set-prelude-severity=<em>threshold</em>] [ --set-database-severity=<em>threshold</em>] [ --enable-trace<em>]</em> [ --trace-logfile=<em>tracefile</em>]</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">WARNING</h2>
        <div class="sectioncontent">
<p>The information in this man page is not always up to date. The authoritative documentation is the user manual.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>samhain</strong> is a file integrity / intrusion detection system both for single hosts and networks. It consists of a monitoring application (<strong>samhain</strong>) running on individual hosts, and (optionally) a central log server (<strong>yule</strong>). Currently, samhain can monitor the integrity of files/directories, and (optionally) also check for kernel rootkits (Linux and FreeBSD only), search the disk for SUID/SGID, and watch for login/logout events.</p><p><strong>samhain/yule</strong> can log by email, to a tamper-resistant, signed log file, to syslog, to the Prelude IDS, to a MySQL/PostgreSQL/Oracle database, and/or to stdout (<em>/dev/console</em> if run as daemon). <strong>samhain/yule</strong> can run as a daemon, and can use a time server instead of the host's system clock. Most of the functionality is defined by a configuration file that is read at startup.</p><p>Most options of these usually would be set in the configuration file. Options given on the command line will override those in the configuration file.</p><h3>OPTIONS FOR INITIALIZING, UPDATING, AND CHECKING</h3>
<p><strong>samhain</strong> <em>-t init, --set-checksum-test=init</em> [<em>options</em>]</p><p>Initialize the database of file signatures. The path to the database is compiled in, and initializing will <strong>append</strong> to the respective file (or create it, if it does not exist). <strong>It is ok to append to e.g. a JPEG image, but it is an error</strong> <strong>to append to an already existing file signature database.</strong></p>
<dl class='dl-vertical'>
  <dt>
    <p>[--init2stdout]</p>
  </dt>
  <dd>
    <p>Write the database to stdout.</p>
  </dd>
  <dt>
    <p>[-r DEPTH|--recursion=DEPTH]</p>
  </dt>
  <dd>
    <p>Set the (global) recursion depth.</p>
  </dd>

</dl>
<p><strong>samhain</strong> <em>-t update, --set-checksum-test=update</em> [<em>options</em>]</p><p>Update the database of file signatures. The path to the database is compiled in, and updating will <strong>overwrite</strong> the database, starting from the start of the database (which may not be identical to the start of the file - see above).</p>
<dl class='dl-vertical'>
  <dt>
    <p>[-r DEPTH|--recursion=DEPTH]</p>
  </dt>
  <dd>
    <p>Set the (global) recursion depth.</p>
  </dd>
  <dt>
    <p>[-D|--daemon]</p>
  </dt>
  <dd>
    <p>Run as daemon. File checks are performed as specified by the timing options in the configuration file. Updates are saved after each file check.</p>
  </dd>
  <dt>
    <p>[--foreground]</p>
  </dt>
  <dd>
    <p>Run in the foreground. This will cause samhain to exit after the update, unless the option <em>--forever</em> is used.</p>
  </dd>
  <dt>
    <p>[--forever]</p>
  </dt>
  <dd>
    <p>If not running as daemon, do not exit after finishing the update, but loop forever, and perform checks with corresponding database updates according to the timing options in the configuration file.</p>
  </dd>

</dl>
<p><strong>samhain</strong> <em>-t check, --set-checksum-test=check</em> [<em>options</em>]</p><p>Check the filesystem against the database of file signatures. The path to the database is compiled in.</p>
<dl class='dl-vertical'>
  <dt>
    <p>[-r DEPTH|--recursion=DEPTH]</p>
  </dt>
  <dd>
    <p>Set the (global) recursion depth.</p>
  </dd>
  <dt>
    <p>[-D|--daemon]</p>
  </dt>
  <dd>
    <p>Run as daemon. File checks are performed as specified by the timing options in the configuration file.</p>
  </dd>
  <dt>
    <p>[--foreground]</p>
  </dt>
  <dd>
    <p>Run in the foreground. This will cause samhain to exit after the file check, unless the option <em>--forever</em> is used.</p>
  </dd>
  <dt>
    <p>[--forever]</p>
  </dt>
  <dd>
    <p>If not running as daemon, do not exit after finishing the check, but loop forever, and perform checks according to the timing options in the configuration file.</p>
  </dd>

</dl>

<h3>OPTIONS FOR LISTING THE DATABASE</h3>
<p><strong>samhain</strong> [-a | --full-detail] [--delimited] -d <em>file</em>| --list-database=<em>file</em></p><p>List the entries in the file signature database in a <strong>ls -l</strong> like format.</p>
<dl class='dl-vertical'>
  <dt>
    <p>[-a | --full-detail]</p>
  </dt>
  <dd>
    <p>List all informations for each file, not only those you would get with ls -l. Must precede the -d option.</p>
  </dd>
  <dt>
    <p>[--delimited]</p>
  </dt>
  <dd>
    <p>List all informations for each file, in a comma-separated format. Must precede the -d option.</p>
  </dd>
  <dt>
    <p>[--list-file=<em>file</em>]</p>
  </dt>
  <dd>
    <p>List the literal content of the given file as stored in the database. Content is not stored by default, must be enabled in the runtime configuration file. Must precede the -d option.</p>
  </dd>

</dl>

<h3>OPTIONS TO VERIFY AN AUDIT TRAIL</h3>
<p>These options will only work, if the executable used for verifying the audit trail is compiled with the same --enable-base=... option as the executable of the reporting process.</p><p><strong>samhain</strong> [-j | --just-list] -L <em>logfile</em>| --verify-log=<em>logfile</em></p><p>Verify the integrity of a signed logfile. The signing key is auto-generated on startup, and sent by email. <strong>samhain</strong> will ask for the key. Instead of entering the key, you can also enter the path to the mailbox holding the respective email message.</p>
<dl class='dl-vertical'>
  <dt>
    <p>[-j | --just-list]</p>
  </dt>
  <dd>
    <p>Just list the logfile, do not verify it. This option must come <strong>first</strong>. It is mainly intended for listing the content of an obfuscated logfile, if <strong>samhain</strong> is compiled with the <strong>stealth</strong> option.</p><p><strong>samhain</strong> -M <em>mailbox</em>| --verify-mail=<em>mailbox</em></p><p>Verify the integrity of the email reports from samhain. All reports must be in the same file.</p>
  </dd>

</dl>

<h3>MISCELLANEOUS OPTIONS</h3>
<p><strong>samhain</strong> --server-port=<em>portnumber</em></p><p>Choose the port on the server host to which the client will connect.</p><p><strong>samhain</strong> -H <em>string</em> | --hash-string=<em>string</em></p><p>Compute the TIGER192 checksum of a string. If the string starts with a '/', it is considered as a pathname, and the checksum of the corresponding file will be computed.</p><p><strong>samhain</strong> -c | --copyright</p><p>Print the copyright statement.</p><p><strong>samhain</strong> -v | --version</p><p>Show version and compiled-in options.</p><p><strong>samhain</strong> -h | --help</p><p>Print supported command line options (depending on compilation options).</p><p><strong>samhain</strong> -V key@/path/to/executable | --add-key=key@/path/to/executable</p><p>See the section "SECURITY" below.</p>
<h3>SERVER STARTUP OPTIONS</h3>
<p><strong>yule</strong> [-q | --qualified] [ --chroot=<em>chrootdir</em>] [-D | --daemon | --foreground] [log-options]</p><p>Start the server, which is named <strong>yule</strong> by default. If the server is started with superuser privileges, it will drop them after startup.</p>
<dl class='dl-vertical'>
  <dt>
    <p>[-q | --qualified]</p>
  </dt>
  <dd>
    <p>Log client hostnames with fully qualified path. The default is to log only the leftmost domain label (i.e. the hostname).</p>
  </dd>
  <dt>
    <p>[</p>
  </dt>
  <dd>
    <p>--chroot=<em>chrootdir</em>] Chroot to the listed directory after startup.</p>
  </dd>
  <dt>
    <p>[-D | --daemon]</p>
  </dt>
  <dd>
    <p>Run as daemon.</p>
  </dd>
  <dt>
    <p>[--foreground]</p>
  </dt>
  <dd>
    <p>Run in the foreground.</p>
  </dd>

</dl>

<h3>MISCELLANEOUS SERVER OPTIONS</h3>
<p><strong>yule</strong> [-G | --gen-password]</p><p>Generate a random 8-byte password and print it out in hexadecimal notation.</p><p><strong>yule</strong> [-P <em>password</em> | --password=<em>password</em>]</p><p>Use the given <em>password</em> and generate an entry suitable for the [Clients] section of the configuration file.</p>
<h3>LOGGING OPTIONS</h3>
<p>Depending on the compilation options, some logging facilities may not be available in your executable.</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>-s threshold, --set-syslog-severity=threshold</em></p>
  </dt>
  <dd>
    <p>Set the threshold for logging events via <strong>syslogd</strong>(8). Possible values are <em>debug</em>, <em>info</em>, <em>notice</em>, <em>warn</em>, <em>mark</em>, <em>err</em>, <em>crit</em>, <em>alert</em>, and <em>none</em>. By default, everything equal to and above the threshold will be logged. Time stamps have the priority <em>warn</em>, system-level errors have the priority <em>err</em>, and important start-up messages the priority <em>alert</em>. The signature key for the log file will never be logged to syslog or the log file itself.</p>
  </dd>
  <dt>
    <p><em>-l threshold, --set-log-severity=threshold</em></p>
  </dt>
  <dd>
    <p>Set the threshold for logging events to the log file.</p>
  </dd>
  <dt>
    <p><em>-m threshold, --set-mail-severity=threshold</em></p>
  </dt>
  <dd>
    <p>Set the threshold for logging events via e-mail.</p>
  </dd>
  <dt>
    <p><em>-e threshold, --set-export-severity=threshold</em></p>
  </dt>
  <dd>
    <p>Set the threshold for forwarding events via TCP to a log server.</p>
  </dd>
  <dt>
    <p><em>-x threshold, --set-extern-severity=threshold</em></p>
  </dt>
  <dd>
    <p>Set the threshold for calling external logging programs/scripts (if any are defined in the configuration file).</p>
  </dd>
  <dt>
    <p><em>-p threshold, --set-print-severity=threshold</em></p>
  </dt>
  <dd>
    <p>Set the threshold for logging events to stdout. If <strong>samhain</strong> runs as a daemon, this is redirected to /dev/console.</p>
  </dd>
  <dt>
    <p><em>--set-prelude-severity=threshold</em></p>
  </dt>
  <dd>
    <p>Set the threshold for logging events to the Prelude IDS.</p>
  </dd>
  <dt>
    <p><em>--set-database-severity=threshold</em></p>
  </dt>
  <dd>
    <p>Set the threshold for logging events to the MySQL/PostgreSQL/Oracle database.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SIGNALS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>SIGUSR1</em></p>
  </dt>
  <dd>
    <p>Switch on/off maximum verbosity for console output.</p>
  </dd>
  <dt>
    <p><em>SIGUSR2</em></p>
  </dt>
  <dd>
    <p>Suspend/continue the process, and (on suspend) send a message to the server. This message has the same priority as timestamps. This signal allows to run <em>samhain -t init -e none</em> on the client to regenerate the database, with download of the configuration file from the server, while the daemon is suspended (normally you would get errors because of concurrent access to the server by two processes from the <em>same host</em>).</p>
  </dd>
  <dt>
    <p><em>SIGHUP</em></p>
  </dt>
  <dd>
    <p>Reread the configuration file.</p>
  </dd>
  <dt>
    <p><em>SIGTERM</em></p>
  </dt>
  <dd>
    <p>Terminate.</p>
  </dd>
  <dt>
    <p><em>SIGQUIT</em></p>
  </dt>
  <dd>
    <p>Terminate after processing all pending requests from clients.</p>
  </dd>
  <dt>
    <p><em>SIGABRT</em></p>
  </dt>
  <dd>
    <p>Unlock the log file, pause for three seconds, then proceed, eventually re-locking the log file and starting a fresh audit trail on next access.</p>
  </dd>
  <dt>
    <p><em>SIGTTOU</em></p>
  </dt>
  <dd>
    <p>Force a file check (only client/standalone, and only in daemon mode).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DATABASE</h2>
        <div class="sectioncontent">
<p>The database (default name <em>samhain_file</em>) is a binary file, which can be created or updated using the <strong>-t</strong> <em>init</em> or the <strong>-t</strong> <em>update</em> option. If you use <strong>-t</strong> <em>init</em>, you need to <em>remove</em> the old database first, otherwise the new version will be <em>appended</em> to the old one. The file may be (clear text) signed by PGP/GnuPG.</p><p>It is recommended to use GnuPG with the options <strong>gpg</strong> <em>-a --clearsign --not-dash-escaped</em></p><p><strong>samhain</strong> will check the signature, if compiled with support for that.</p><p>At startup <strong>samhain</strong> will compute the checksum of the database, and verify it for each further access. This checksum is not stored on disk (i.e. is lost after program termination), as there is no secure way to store it.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOG FILE</h2>
        <div class="sectioncontent">
<p>Each entry in the log file has the format <strong>Severity : [Timestamp] Message</strong>, where the timestamp may be obtained from a time server rather than from the system clock, if <strong>samhain</strong> has been compiled with support for this. Each entry is followed by a <em>signature</em>, which is computed as <strong>Hash(Entry Key_N)</strong>, and <strong>Key_N</strong> is computed as <strong>Hash(Key_N-1)</strong>, i.e. only knowledge of the first signature key in this chain allows to verify the integrity of the log file. This first key is autogenerated and e-mailed to the designated recipient.</p><p>The default name of the log file is <em>samhain_log</em>. To prevent multiple instances of <strong>samhain</strong> from writing to the same log file, the log file is locked by creating a <em>lock file</em>, which is normally deleted at program termination. The default name of the <em>lock file</em> is <em>samhain.lock</em>. If <strong>samhain</strong> is terminated abnormally, i.e. with kill -9, a stale lock file might remain, but usually <strong>samhain</strong> will be able to recognize that and remove the stale lock file on the next startup.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EMAIL</h2>
        <div class="sectioncontent">
<p>E-mails are sent (using built-in SMTP code) to one recipient only. The subject line contains timestamp and hostname, which are repeated in the message body. The body of the mail contains a line with a <em>signature</em> similar to that in the log file, computed from the message and a key. The key is iterated by a hash chain, and the initial key is revealed in the first email sent. Obviously, you have to believe that this first e-mail is authentical ...</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CLIENT/SERVER USAGE</h2>
        <div class="sectioncontent">
<p>To monitor several machines, and collecting data by a central log server, <strong>samhain</strong> may be compiled as a client/server application. The log server (<strong>yule</strong>) will accept connection requests from registered clients only. With each client, the server will first engage in a challenge/response protocol for <em>authentication</em> of the client and <em>establishing</em> a <em>session key</em>.</p><p>This protocol requires on the client side a <em>password</em>, and on the server side a <em>verifier</em> that is computed from the <em>password</em>.</p><p>To <em>register</em> a client, simply do the following:</p><p>First, with the included utility program <strong>samhain_setpwd</strong> re-set the compiled-in default password of the client executable to your preferred value (with no option, a short usage help is printed). To allow for non-printable chars, the new value must be given as a 16-digit hexadecimal string (only 0123456789ABCDEF in string), corresponding to an 8-byte password.</p><p>Second, after re-setting the password in the client executable, you can use the server's convenience function <strong>yule</strong> <strong>-P</strong> <em>password</em> that will take as input the (16-digit hex) password, compute the corresponding verifier, and outputs a default configuration file entry to register the client.</p><p>Third, in the configuration file for the server, under the [Clients] section, enter the suggested registration entry of the form <em>Client=hostname@salt@verifier</em>, where <em>hostname</em> must be the (fully qualified) hostname of the machine on which the client will run. <strong>Don't forget to reload the server configuration thereafter.</strong></p><p>If a connection attempt is made, the server will lookup the entry for the connecting host, and use the corresponding value for the <em>verifier</em> to engage in the session key exchange. Failure to verify the client's response(s) will result in aborting the connection.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">STEALTH</h2>
        <div class="sectioncontent">
<p><strong>samhain</strong> may be compiled with support for a <em>stealth</em> mode of operation, meaning that the program can be run without any obvious trace of its presence on disk. The supplied facilities are simple - they are more sophisticated than just running the program under a different name, and might thwart efforts using 'standard' Unix commands, but they will not resist a search using dedicated utilities.</p><p>In this mode, the runtime executable will hold no printable strings, and the configuration file is expected to be a postscript file with <em>uncompressed</em> image data, wherein the configuration data are hidden by steganography. To create such a file from an existing image, you may use e.g. the program <strong>convert</strong>(1), which is part of the <strong>ImageMagick</strong>(1) package, such as: <strong>convert +compress</strong> <em>ima.jpg ima.ps</em>.</p><p>To hide/extract the configuration data within/from the postscript file, a utility program <strong>samhain_stealth</strong> is provided. Use it without options to get help.</p><p>Database and log file may be e.g. existing image files, to which data are appended, xor'ed with some constant to mask them as binary data.</p><p>The user is responsible by herself for re-naming the compiled executable(s) to unsuspicious names, and choosing (at compile time) likewise unsuspicious names for config file, database, and log (+lock) file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SECURITY</h2>
        <div class="sectioncontent">
<p>For security reasons, <strong>samhain</strong> will not write log or data files in a directory, remove the lock file, or read the configuration file, if any element in the path is owned or writeable by an untrusted user (including group-writeable files with untrusted users in the group, and world-writeable files).</p><p><em>root</em> and the <em>effective</em> user are always trusted. You can add more users in the configuration file.</p><p>Using a <em>numerical host address</em> in the e-mail address is more secure than using the hostname (does not require DNS lookup).</p><p>If you use a <em>precompiled</em> <strong>samhain</strong> executable (e.g. from a binary distribution), in principle a prospective intruder could easily obtain a copy of the executable and analyze it in advance. This will enable her/him to generate fake audit trails and/or generate a trojan for this particular binary distribution.</p><p>For this reason, it is possible for the user to add more key material into the binary executable. This is done with the command:</p><p><strong>samhain </strong><em>--add-key=key@/path/to/executable</em></p><p>This will read the file <em>/path/to/executable, add the key</em> <em>key,</em> which should not contain a '@' (because it has a special meaning, separating key from path), overwrite any key previously set by this command, and write the new binary to the location <em>/path/to/executable.out</em> (i.e. with .out appended). You should then copy the new binary to the location of the old one (i.e. overwrite the old one).</p><p><strong>Note that using a precompiled samhain executable from a binary</strong> <strong>package distribution is not recommended unless you add in key material as</strong> <strong>described here.</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>For initializing the key(s), <em>/dev/random</em> is used, if available. This is a device supplying cryptographically strong (non-deterministic) random noise. Because it is slow, <strong>samhain</strong> might appear to hang at startup. Doing some random things (performing rain dances, spilling coffee, hunting the mouse) might speed up things. If you do not have <em>/dev/random</em>, lots of statistics from <a href="../man8/vmstat.8.html"><strong>vmstat</strong>(8)</a> and the like will be pooled and mixed by a hash function.</p><p>Some hosts might check whether the sender of the mail is valid. Use only <em>login names</em> for the sender.</p><p>For sending mails, you may need to set a relay host for the sender domain in the configuration file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Whoever has the original signature key may change the log file and send fake e-mails. The signature keys are e-mailed at program startup with a one-time pad encryption. This should be safe against an eavesdropper on the network, but not against someone with read access to the binary, <em>if</em> she has caught the e-mail.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p><em>/etc/samhainrc</em></p><p><em>/usr/local/man/man8/samhain.8</em></p><p><em>/usr/local/man/man5/samhainrc.5</em></p><p><em>/var/log/samhain_log</em></p><p><em>/var/lib/samhain/samhain_file</em></p><p><em>/var/lib/samhain/samhain.html</em></p><p><em>/var/run/samhain.pid</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO samhain&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/samhainrc.5.html"><strong>samhainrc</strong>(5)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Rainer Wichmann (http://la-samhna.de)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUG REPORTS</h2>
        <div class="sectioncontent">
<p>If you find a bug in <strong>samhain</strong>, please send electronic mail to <em>support@la-samhna.de</em>. Please include your operating system and its revision, the version of <strong>samhain</strong>, what C compiler you used to compile it, your 'configure' options, and any information that you deem helpful.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYING PERMISSIONS</h2>
        <div class="sectioncontent">
<p>Copyright (&copy;) 1999, 2004 Rainer Wichmann</p><p>Permission is granted to make and distribute verbatim copies of this manual page provided the copyright notice and this permission notice are preserved on all copies.</p><p>Permission is granted to copy and distribute modified versions of this manual page under the conditions for verbatim copying, provided that the entire resulting derived work is distributed under the terms of a permission notice identical to this one.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="samba-tool.8.html"><span aria-hidden="true">&larr;</span> samba-tool.8: Main samba administration tool.</a></li>
   <li class="next"><a href="sampasswd.8.html">sampasswd.8: Reset passwords of users in the sam user database <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
