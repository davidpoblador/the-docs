<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>qtool: Manipulate sendmail queues</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Manipulate sendmail queues">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="qtool (8) manual">
  <meta name="twitter:description" content="Manipulate sendmail queues">
  <meta name="twitter:image" content="https://www.carta.tech/images/sendmail-base-qtool-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/qtool.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="qtool (8) manual" />
  <meta property="og:description" content="Manipulate sendmail queues" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/sendmail-base-qtool-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">qtool<small> (8)</small></h1>
        <p class="lead">Manipulate sendmail queues</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/qtool.8.html">
      <span itemprop="name">qtool: Manipulate sendmail queues</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/sendmail-base/">
      <span itemprop="name">sendmail-base</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/qtool.8.html">
      <span itemprop="name">qtool: Manipulate sendmail queues</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>qtool.pl</strong> [options] target_directory source [source ...]</p><p><strong>qtool.pl [-Q][-d|-b]</strong> [options] source [source ...]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>Qtool</strong> moves the queue files used by sendmail between queues. It uses the same locking mechanism as sendmail so can be safely used while sendmail is running. However, it should not be used when queue groups have been configured to move queue files into directories to which they do not belong according to the queue group selections made in the sendmail.cf file. Unless you are absolutely sure you do not interfere with the queue group selection mechanism, do not move queue files around.</p><p>With no options, <strong>qtool</strong> will move any queue files as specified by <em>source</em> into <em>target_directory</em>. <em>Source</em> can be either an individual queue control file, a queue file id, or a queue directory.</p><p>If the -d option is specified, qtool will delete the messages specified by source instead of moving them.</p><p>If the -b option is specified, the selected messages will be bounced by running sendmail with the -OTimeout.queuereturn=now option.</p><h3>Options</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>-b</strong></p>
  </dt>
  <dd>
    <p>Bounce all of the messages specified by source. The messages will be bounced immediately. No attempt will be made to deliver the messages.</p>
  </dd>
  <dt>
    <p><strong>-C</strong> configfile</p>
  </dt>
  <dd>
    <p>Specify the sendmail config file. Defaults to /etc/mail/sendmail.cf.</p>
  </dd>
  <dt>
    <p><strong>-d</strong></p>
  </dt>
  <dd>
    <p>Delete all of the messages specified by source.</p>
  </dd>
  <dt>
    <p><strong>-e</strong> <em>perl_expression</em></p>
  </dt>
  <dd>
    <p>Evaluate <em>perl_expression</em> for each queue file as specified by <em>source</em>. If <em>perl_expression</em> evaluates to true, then that queue file is moved. See below for more detail on <em>perl_expression</em>.</p>
  </dd>
  <dt>
    <p><strong>-Q</strong></p>
  </dt>
  <dd>
    <p>Operate on quarantined items (queue control file begins with hf instead of qf).</p>
  </dd>
  <dt>
    <p><strong>-s</strong> <em>seconds</em></p>
  </dt>
  <dd>
    <p>Move only the queue files specified by <em>source</em> that have a modification time older than <em>seconds</em>.</p>
  </dd>

</dl>

<h3>Perl Expressions</h3>
<p>You can use any valid perl expression. Inside the expression you have access to a hash that contains many of the fields in the control file as well as some other data about that queued message. The hash is called <em>%msg</em>. If a field has multiple values (e.g. 'Recipient'), it will be returned as an array, otherwise it will be returned as a scalar. Through <em>%msg</em>, you can access the following variables:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>auth</strong></p>
  </dt>
  <dd>
    <p>AUTH= parameter.</p>
  </dd>
  <dt>
    <p><strong>body_type</strong></p>
  </dt>
  <dd>
    <p>Body type (<strong>8BITMIME</strong>, <strong>7BIT</strong>, or undefined).</p>
  </dd>
  <dt>
    <p><strong>body_last_mod_time</strong></p>
  </dt>
  <dd>
    <p>The last time the body was modified since the epoch in seconds.</p>
  </dd>
  <dt>
    <p><strong>body_size</strong></p>
  </dt>
  <dd>
    <p>The size of the body file in bytes.</p>
  </dd>
  <dt>
    <p><strong>content-length</strong></p>
  </dt>
  <dd>
    <p>Content-Length: header value (Solaris sendmail only).</p>
  </dd>
  <dt>
    <p><strong>controlling_user</strong></p>
  </dt>
  <dd>
    <p>The controlling user.</p>
  </dd>
  <dt>
    <p><strong>control_last_mod_time</strong></p>
  </dt>
  <dd>
    <p>The last time the control file was modified since the epoch in seconds.</p>
  </dd>
  <dt>
    <p><strong>control_size</strong></p>
  </dt>
  <dd>
    <p>The size of the control file in bytes.</p>
  </dd>
  <dt>
    <p><strong>creation_time</strong></p>
  </dt>
  <dd>
    <p>The time when the control file was created.</p>
  </dd>
  <dt>
    <p><strong>data_file_name</strong></p>
  </dt>
  <dd>
    <p>The data file name (deprecated).</p>
  </dd>
  <dt>
    <p><strong>deliver_by</strong></p>
  </dt>
  <dd>
    <p>Deliver by flag and deadline for DELIVERBY ESMTP extension.</p>
  </dd>
  <dt>
    <p><strong>envid</strong></p>
  </dt>
  <dd>
    <p>Original envelope id form ESMTP.</p>
  </dd>
  <dt>
    <p><strong>error_recipient</strong></p>
  </dt>
  <dd>
    <p>The error recipient (deprecated).</p>
  </dd>
  <dt>
    <p><strong>final_recipient</strong></p>
  </dt>
  <dd>
    <p>Final recipient (for DSNs).</p>
  </dd>
  <dt>
    <p><strong>flags</strong></p>
  </dt>
  <dd>
    <p>Array of characters that can be the following values:</p>
<dl class='dl-vertical'>
  <dt>
    <p>w</p>
  </dt>
  <dd>
    <p>warning message has been sent</p>
  </dd>
  <dt>
    <p>r</p>
  </dt>
  <dd>
    <p>This is an error response or DSN</p>
  </dd>
  <dt>
    <p>8</p>
  </dt>
  <dd>
    <p>has 8 bit data in body</p>
  </dd>
  <dt>
    <p>b</p>
  </dt>
  <dd>
    <p>delete Bcc: headers</p>
  </dd>
  <dt>
    <p>d</p>
  </dt>
  <dd>
    <p>envelope has DSN RET= parameter</p>
  </dd>
  <dt>
    <p>n</p>
  </dt>
  <dd>
    <p>don't return body</p>
  </dd>

</dl>

  </dd>
  <dt>
    <p><strong>headers</strong></p>
  </dt>
  <dd>
    <p>This is a Perl hash where the keys are rfc822 field names and the values are rfc822 field values. If a field has only one value it will be returned as a string. If a field has more than one value (e.g. 'Received') it will be returned as a list of strings.</p>
  </dd>
  <dt>
    <p><strong>inode_number</strong></p>
  </dt>
  <dd>
    <p>The inode number for the data (body) file.</p>
  </dd>
  <dt>
    <p><strong>next_delivery_time</strong></p>
  </dt>
  <dd>
    <p>Earliest time of next delivery attempt.</p>
  </dd>
  <dt>
    <p><strong>num_delivery_attempts</strong></p>
  </dt>
  <dd>
    <p>Number of delivery attempts that have been made.</p>
  </dd>
  <dt>
    <p><strong>macro</strong></p>
  </dt>
  <dd>
    <p>Defined macro.</p>
  </dd>
  <dt>
    <p><strong>message</strong></p>
  </dt>
  <dd>
    <p>Envelope status message.</p>
  </dd>
  <dt>
    <p><strong>original_recipient</strong></p>
  </dt>
  <dd>
    <p>Original recipient (ORCPT= parameter).</p>
  </dd>
  <dt>
    <p><strong>priority</strong></p>
  </dt>
  <dd>
    <p>Adjusted priority of message.</p>
  </dd>
  <dt>
    <p><strong>quarantine_reason</strong></p>
  </dt>
  <dd>
    <p>Quarantine reason for quarantined (held) envelopes.</p>
  </dd>
  <dt>
    <p><strong>recipient</strong></p>
  </dt>
  <dd>
    <p>Array of character flags followed by colon and recipient name. Flags:</p>
<dl class='dl-vertical'>
  <dt>
    <p>N</p>
  </dt>
  <dd>
    <p>Has NOTIFY= parameter.</p>
  </dd>
  <dt>
    <p>S</p>
  </dt>
  <dd>
    <p>Success DSN requested.</p>
  </dd>
  <dt>
    <p>F</p>
  </dt>
  <dd>
    <p>Failure DSN requested.</p>
  </dd>
  <dt>
    <p>D</p>
  </dt>
  <dd>
    <p>Delay DSN requested.</p>
  </dd>
  <dt>
    <p>P</p>
  </dt>
  <dd>
    <p>Primary address (not the result of alias/forward expansion).</p>
  </dd>

</dl>

  </dd>
  <dt>
    <p><strong>sender</strong></p>
  </dt>
  <dd>
    <p>Sender</p>
  </dd>
  <dt>
    <p><strong>version</strong></p>
  </dt>
  <dd>
    <p>Version of control file.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>qtool.pl q2 q1</strong></p>
  </dt>
  <dd>
    <p>Moves all of the queue files in queue q1 to queue q2.</p>
  </dd>
  <dt>
    <p><strong>qtool.pl q2 q1/d6CLQh100847</strong></p>
  </dt>
  <dd>
    <p>Moves the message with id d6CLQh100847 in queue q1 to queue q2.</p>
  </dd>
  <dt>
    <p><strong>qtool.pl q2 q1/qfd6CLQh100847</strong></p>
  </dt>
  <dd>
    <p>Moves the message with id d6CLQh100847 in queue q1 to queue q2.</p>
  </dd>
  <dt>
    <p><strong>qtool.pl -e '$msg{num_delivery_attempts} == 3' /q2 /q1</strong></p>
  </dt>
  <dd>
    <p>Moves all of the queue files that have had three attempted deliveries from queue q1 to queue q2.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>In sendmail 8.12, it is possible for a message's queue and data files (df) to be stored in different queues. In this situation, you must give qtool the pathname of the queue file, not of the data file (df). To be safe, never feed qtool the pathname of a data file (df).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO qtool&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/sendmail.8.html"><strong>sendmail</strong>(8)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">
<p>The <strong>qtool</strong> command appeared in sendmail 8.10.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="qpsmtpd-prefork.8.html"><span aria-hidden="true">&larr;</span> qpsmtpd-prefork.8: Preforkin server for qpsmtpd</a></li>
   <li class="next"><a href="quagga-babeld.8.html">quagga-babeld.8: A babel ad-hoc network routing engine for use with quagga routing software. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
