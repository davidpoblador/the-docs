<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>amvault: Copy amanda dumps from one volume to another</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Copy amanda dumps from one volume to another">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="amvault (8) manual">
  <meta name="twitter:description" content="Copy amanda dumps from one volume to another">
  <meta name="twitter:image" content="https://www.carta.tech/images/amanda-common-amvault-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/amvault.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="amvault (8) manual" />
  <meta property="og:description" content="Copy amanda dumps from one volume to another" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/amanda-common-amvault-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">amvault<small> (8)</small></h1>
        <p class="lead">Copy amanda dumps from one volume to another</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/amvault.8.html">
      <span itemprop="name">amvault: Copy amanda dumps from one volume to another</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/amanda-common/">
      <span itemprop="name">amanda-common</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/amvault.8.html">
      <span itemprop="name">amvault: Copy amanda dumps from one volume to another</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>amvault</strong> [<strong>-o</strong>&nbsp;<em>configoption</em>...] [--dry-run | -n] [--quiet | -q] [--fulls-only] [--latest-fulls] [--incrs-only] [--exact-match] [--export] [<strong>--src-timestamp</strong>&nbsp;<em>src-timestamp</em>]</p><p><strong>--label-template</strong>&nbsp;<em>label-template</em> <strong>--dst-changer</strong>&nbsp;<em>dst-changer</em> [<strong>--autolabel</strong>&nbsp;<em>autolabel-arg</em>...]</p><p><em>config</em> [<em>hostname</em>&nbsp;[&nbsp;<em>disk</em>&nbsp;[&nbsp;<em>date</em>&nbsp;[&nbsp;<em>level</em>&nbsp;[&nbsp;<em>hostname</em>&nbsp;[...]&nbsp;]&nbsp;]&nbsp;]&nbsp;]]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">WARNING</h2>
        <div class="sectioncontent">
<p>This application is not yet in its final form, and is subject to major revision in subsequent versions of Amanda. Backward compatibility is not guaranteed.</p><p>Note that Amanda restore/recover operations will request tertiary media by label when dumpfiles are not found on secondary media, but there is no provision to automatically fetch such media from a different changer</p><p>Feedback on and patches to this application are invited and encouraged!</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Amvault is conceptually equivalent to "amfetchdump | taper". That is, it reads specified dumps from secondary media and re-writes them on tertiary media.</p><p><strong>Amvault</strong> Copies data from the run with timestamp <strong>src-timestamp</strong> onto volumes using the changer <strong>dst-changer</strong>, and labeling new volumes with <strong>label-template</strong>.</p><h3>Secondary Media</h3>
<p>The dumps to be read from secondary media can be specified by any combination of dump specifications, <strong>--fulls-only</strong>, <strong>--incrs-only</strong>, and <strong>--src-timestamp</strong>. At least one must be specified, lest amvault attempt to vault all dumps in the catalog. See <a href="../man7/amanda-match.7.html"><strong>amanda-match</strong>(7)</a> for more information on dump specifications.</p><p>Note that the datestamp given in the dumpspec is the <em>dump</em> datestamp - the run in which the backup was taken on the Amanda client. The <strong>--src-timestamp</strong>, on the other hand, is the <em>write</em> timestamp - the run in which the dump was written to secondary media. The latter option facilitates duplicating the results of an entire backup run, including any dumps that might have been flushed from holding disk.</p>
<h3>Tertiary Media</h3>
<p>The <strong>--dst-changer</strong> must be specified, and names the changer in which tertiary media are stored.</p><p>If <a href="../man5/amanda.conf.5.html"><strong>amanda.conf</strong>(5)</a> contains the new <strong>part-size</strong> splitting parameters, then amvault will use them without any additional configuration. However, if the configuration still uses the old splitting parameters (<strong>tape_splitsize</strong>, <strong>split_diskbuffer</strong>, and <strong>fallback_splitsize</strong>), then amvault will need some additional configuration in order to properly split dumps to tertiary media. To do so, specify a new tapetype in <a href="../man5/amanda.conf.5.html"><strong>amanda.conf</strong>(5)</a>, say "TERTIARY", and set the <strong>part-size</strong> and other appropriate parameters there. Then reference that tapetype in the amvault invocation:</p>
<pre>
    amvault -otapetype=TERTIARY ...
</pre>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p><strong>--autolabel</strong> [any] [other-config] [non-amanda] [volume-error] [empty]</p><p>Works just like the <strong>autolabel</strong> parameter in <a href="../man5/amanda.conf.5.html"><strong>amanda.conf</strong>(5)</a>, and can be specified multiple times if necessary. The default is &apos;empty&apos;.</p><p><strong>--dst-changer</strong> <em>dst-changer</em></p><p>Specifies the changer in which tertiary media are stored. In general, this should be different from the secondary changer, to eliminate the possibility of overwriting secondary media with tertiary data.</p><p>The <strong>dst-changer</strong> parameter should specify the name of a changer defined in <a href="../man5/amanda.conf.5.html"><strong>amanda.conf</strong>(5)</a>. For example:</p>
<pre>
define changer vaulting_tape {
    tapedev "/dev/rmt/1n"
    tpchanger "chg-zd-mtx"
    changerdev "/dev/sg0"
    changerfile "vaulting-changer.conf"
}
</pre>
<p><strong>--dry-run</strong>, <strong>-n</strong></p><p>Cause amvault to print the dumps it would vault, but not actually perform any vaulting operations.</p><p><strong>--exact-match</strong></p><p>The host and disk are parsed as exact values</p><p><strong>--export</strong></p><p>Cause amvault to attempt to move completed tertiary volumes to import/export slots, where they can be more easily removed by an operator.</p><p><strong>--fulls-only</strong></p><p>Only full (level-0) dumps are copied.</p><p><strong>--incrs-only</strong></p><p>Only incremental (level &gt; 0) dumps are copied.</p><p><strong>--label-template</strong> <em>label-template</em></p><p>Specifies a label template which is used to generate new labels for tertiary volumes.</p><p><strong>--latest-fulls</strong></p><p>The latest full of every DLE in the disklist that do not have the <strong>skip</strong> <strong>strategy</strong>.</p><p><strong>--quiet</strong>, <strong>-q</strong></p><p>Eliminate non-error messages, and is useful when running amvault from cron.</p><p><strong>--src-timestamps</strong> <em>src-timestamps</em></p><p>Specifies the timestamps in the format &apos;YYYYMMDDHHMMSS&apos; of the run to vault, can be "latest", then the most recent amdump or amflush run will be used.</p><p><strong>-o</strong> <em>configoption</em></p><p>See the "<strong>CONFIGURATION OVERRIDE</strong>" section in <a href="../man8/amanda.8.html"><strong>amanda</strong>(8)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Vault all dump written to tape in the latest amdump or amflush run:</p>
<pre>
$ amvault --src-timestamps latest --label-template "CONF-%%%" --dst-changer vault-changer CONF
</pre>
<p>Vault all dump written on the run of December 7 2011 12:13:14 :</p>
<pre>
$ amvault --src-timestamps 20111207121314 --label-template "CONF-%%%" --dst-changer vault-changer CONF
</pre>
<p>Vault all dump dumped on any run of December 7 2011:</p>
<pre>
$ amvault --label-template "CONF-%%%" --dst-changer vault-changer CONF &#92;* &#92;* 20111207
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO amvault&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/amanda.8.html"><strong>amanda</strong>(8)</a>, <a href="../man7/amanda-changers.7.html"><strong>amanda-changers</strong>(7)</a>, <a href="../man8/amfetchdump.8.html"><strong>amfetchdump</strong>(8)</a></p><p>The Amanda Wiki: : http://wiki.zmanda.com/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p><strong>Dustin J. Mitchell</strong> &lt;dustin@zmanda.com&gt;</p><p>Zmanda, Inc. (http://www.zmanda.com)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="amtoc.8.html"><span aria-hidden="true">&larr;</span> amtoc.8: Generate toc (table of contents) for an amanda run</a></li>
   <li class="next"><a href="amzfs-sendrecv.8.html">amzfs-sendrecv.8: Amanda script to create zfs sendrecv <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
