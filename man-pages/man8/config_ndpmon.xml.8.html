<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>config_ndpmon.xml: Configuration file for ndpmon</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Configuration file for ndpmon">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="config_ndpmon.xml (8) manual">
  <meta name="twitter:description" content="Configuration file for ndpmon">
  <meta name="twitter:image" content="https://www.carta.tech/images/ndpmon-config_ndpmon.xml-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/config_ndpmon.xml.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="config_ndpmon.xml (8) manual" />
  <meta property="og:description" content="Configuration file for ndpmon" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/ndpmon-config_ndpmon.xml-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">config_ndpmon.xml<small> (8)</small></h1>
        <p class="lead">Configuration file for ndpmon</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/config_ndpmon.xml.8.html">
      <span itemprop="name">config_ndpmon.xml: Configuration file for ndpmon</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/ndpmon/">
      <span itemprop="name">ndpmon</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/config_ndpmon.xml.8.html">
      <span itemprop="name">config_ndpmon.xml: Configuration file for ndpmon</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This manual page documents briefly the various options for configuring ndpmon.</p><p>NDPMon uses two configuration files, whose locations are:</p><p><em>/etc/ndpmon/config_ndpmon.xml</em></p><p><em>/var/lib/ndpmon/neighbor_list.xml</em></p><p>DTDs have been written for these two files:</p><p><em>config_ndpmon.dtd</em></p><p><em>neighbor_list.dtd</em></p><p>The Neighbor List is filled by the program itself, while running or during a learning period.  The configuration file itself has to be filled in by the administrator.</p><p><strong>Basic configuration example</strong></p><p>Here is an example of a configuration file for NDPMON:</p>
<pre>
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;!DOCTYPE config_ndpmon SYSTEM "/etc/ndpmon/config_ndpmon.dtd"&gt;
&lt;config_ndpmon&gt;
   &lt;ignor_autoconf&gt;1&lt;/ignor_autoconf&gt;
   &lt;syslog_facility&gt;LOG_LOCAL1&lt;/syslog_facility&gt;
   &lt;admin_mail&gt;frederic.beck@loria.fr&lt;/admin_mail&gt;
   &lt;actions_low_pri&gt;
      &lt;sendmail&gt;1&lt;/sendmail&gt;
      &lt;syslog&gt;1&lt;/syslog&gt;
      &lt;exec_pipe_program&gt;/usr/lib/ndpmon/demopipeprogram.pl&lt;/exec_pipe_program&gt;
   &lt;/actions_low_pri&gt;
   &lt;actions_high_pri&gt;
      &lt;sendmail&gt;1&lt;/sendmail&gt;
      &lt;syslog&gt;1&lt;/syslog&gt;
      &lt;exec_pipe_program&gt;/usr/lib/ndpmon/demopipeprogram.pl&lt;/exec_pipe_program&gt;
   &lt;/actions_high_pri&gt;
   &lt;use_reverse_hostlookups&gt;1&lt;/use_reverse_hostlookups&gt;
   &lt;routers&gt;
      &lt;router&gt;
         &lt;mac&gt;00:13:72:14:C4:58&lt;/mac&gt;
         &lt;lla&gt;fe80:213:72ff:fe14:c458&lt;/lla&gt;
         &lt;prefixes&gt;
            &lt;prefix&gt;
               &lt;address&gt;2001:660:4501:32:&lt;/address&gt;
               &lt;mask&gt;64&lt;/mask&gt;
            &lt;/prefix&gt;
         &lt;/prefixes&gt;
         &lt;addresses&gt;
            &lt;address&gt;2001:660:4501:32::1&lt;/address&gt;
         &lt;/addresses&gt;
      &lt;/router&gt;
   &lt;/routers&gt;
&lt;/config_ndpmon&gt;


</pre>
<p><strong>ignor_autoconf</strong></p><p><em>/proc/sys/net/ipv6/conf/all/autoconf</em></p><p><em>/proc/sys/net/ipv6/conf/all/accept_ra</em></p><p><em>/proc/sys/net/ipv6/conf/all/accept_ra_defrtr</em></p><p><em>/proc/sys/net/ipv6/conf/all/ra_pinfo</em></p><p><em>/proc/sys/net/ipv6/conf/all/accept-ra_redirects</em></p><p>By setting this parameter to 0, the host will ignore all Router Advertisements or ICMPv6 Redirects, and will thus not be sensitive to attacks on these messages, but should still be able to send the alerts to the monitoring station.  Caution: the administrator must be aware that this will disable the possibility for the host to use IPv6 Address Autoconfiguration, which could cause trouble in case of a renumbering or a modification in the network's topology.</p><p><strong>syslog_facility</strong></p><p>This parameter sets the facility Syslog will use for logging.  To redirect messages to a dedicated log file, reconfigure the syslog daemon itself.</p><p><strong>admin_mail</strong></p><p>The email address to which the ndpmon daemon will send alerts. The default is set to root@localhost.</p><p><strong>actions_low_pri/actions_high_pri</strong></p><p>Enable or disable the alerts</p><p>	sendmail: send an email to the administrator email address</p><p>	syslog: syslog the message</p><p>	exec_pipe_program: the program to call to capture the reports and 	 	do whatever you want with it (see demopipeprogram.pl</p>
<pre>
   		in the source code)
</pre>
<p><strong>routers</strong></p><p>A router is defined with its MAC and Link Local addresses.  It also contains the list of prefixes advertised by this router, and eventually the global addresses set on its interfaces.  This new definition makes possible to check the tuple (MAC, LLA, PREFIX) in the received Router Advertisements, instead of checking them separately in version 0.1.</p><p>In version 1.4.0, additional tags were introduced to check the parameters of a Router Advertisement.  For details see below.</p><p><strong>Configuring the Router Advertisement parameter check</strong></p><p>In version 1.4.0, further checks for Router Advertisements (RAs) were introduced which assume that the RA parameters do not change during operation.  Those values may be learned during the learning phase of NDPMon or they may be configured manually.  This behavior is optional.  If you do not include the additional parameters, no checks will be performed.</p><p>Below you will find an example of a more complex router definition:</p>
<pre>
	&lt;router&gt;
	   &lt;mac&gt;00:11:22:33:44:55&lt;/mac&gt;
	   &lt;lla&gt;fe80:0:0:0:211:22ff:fe33:4455&lt;/lla&gt;
	   &lt;param_curhoplimit&gt;64&lt;/param_curhoplimit&gt;
	   &lt;param_flags_reserved&gt;0&lt;/param_flags_reserved&gt;
	   &lt;param_router_lifetime&gt;10800&lt;/param_router_lifetime&gt;
	   &lt;param_reachable_timer&gt;0&lt;/param_reachable_timer&gt;
	   &lt;param_retrans_timer&gt;0&lt;/param)retrans_timer&gt;
	   &lt;param_mtu&gt;0&lt;/param_mtu&gt;
	   &lt;params_volatile&gt;0&lt;/params_volatile&gt;
	   &lt;prefixes&gt;
	      &lt;prefix&gt;
	         &lt;address&gt;2001:db8:1234:5678:0:0:0:0&lt;/address&gt;
	         &lt;mask&gt;64&lt;/mask&gt;
	         &lt;param_flags_reserved&gt;224&lt;/param_flags_reserved&gt;
	         &lt;param_valid_time&gt;2592000&lt;/param_valid_time&gt;
	         &lt;param_preferred_time&gt;604800&lt;/param_preferred_time&gt;
	      &lt;/prefix&gt;
	   &lt;/prefixes&gt;
	   &lt;addresses/&gt;
	&lt;/router&gt;
</pre>
<p><strong>params_volatile</strong></p><p>Indicates if the router params may change during operation.  A value of 0 means that values do not change, a non-zero values means parameters may change.  If this tag is not present, its value is assumed to be non-zer0 (1).  If you want NDPMon to check RA parameters for this router, include the tag param_voltile with a value of zero.  If param_volatile is set to zero, you should at least include the router param_flags_reserved tag and the param_tags for each prefix.</p><p><strong>param_flags_reserved</strong></p><p>The flags of a RA or a RA prefix information option, stored as an unsigned integer.  If this tag is not present, it does not indicate that this is unspecified, but that no flags are set!</p><p><strong>param_curhoplimit, param_router_lifetime, param_reachable_timer,</strong> <strong>param_retrans_timer, param_mtu</strong></p><p>Contains the values of the corresponding RA fields (or the MTU option).  If those tags are not present, this indicates that they are not specified, and the corresponding value of a RA will not be checked.</p><p><strong>prefix: param_flags_reserved, param_valid_time, param_preferred_time</strong></p><p>The parameters of prefixes advertised.  These tags should be present for each prefix if parameters are checked, because prefix parameters cannot be unspecified.  If they are not present, their value is assumed to be zero (which is, concerning the prefix lifetimes, usually not desired).</p><p><strong>Configuring the countermeasures plugin</strong></p><p>Below you will find an example configuration for the countermeasures plugin.  If the tag countermeasures is not present, all countermeasures are suppressed.</p>
<pre>
	&lt;countermeasures&gt;
	   &lt;kill_illegitimate_router&gt;RESPOND&lt;/kill_illegitimate_router&gt;
	   &lt;kill_wrong_prefix&gt;LAUNCH AFTER 10&lt;/kill_wrong_prefix&gt;
	   &lt;propagate_router_params&gt;CEASE AFTER 10&lt;/propagate_router_params&gt;
	   &lt;indicate_ndpmon_presence&gt;SUPPRESS&lt;/indicate_ndpmon_presence&gt;
	&lt;/countermeasures&gt;
</pre>
<p><strong>SUPPRESS</strong></p><p>The countermeasure is turned off (default value for each configuration tag not present).</p><p><strong>RESPOND</strong></p><p>Each call to this countermeasure result in a reaction.</p><p><strong>CEASE AFTER max</strong></p><p>For max calls, each call to this countermeasure results in a reaction.  After the max'th call, the countermeasure is suppressed.  max may be a number up to 255.  This may be used to precent NDPMon from contributing to a Denial of Service attack, but to have a "first response" countermeasure.</p><p><strong>LAUNCH AFTER min</strong></p><p>For min calls, this countermeasure is suppressed.  After the min'th call, each call to the countermeasure results in a reaction.  min may be a number up to 255.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>ndpmon was written by Thibault Cholez.</p><p>This manual page was copied from the configuration web page (http://ndpmon.sourceforge.net/configuration.html) by John R. Baskwill &lt;jrb28@psu.edu&gt;, for the Debian project (and may be used by others).</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="config_list.8.html"><span aria-hidden="true">&larr;</span> config_list.8: Configure a mailman mailing list from a text file description</a></li>
   <li class="next"><a href="configure-debian.8.html">configure-debian.8: Central configuration program for packages using debconf <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
