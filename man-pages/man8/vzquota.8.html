<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>vzquota: Manipulate containers disk quotas</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Manipulate containers disk quotas">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="vzquota (8) manual">
  <meta name="twitter:description" content="Manipulate containers disk quotas">
  <meta name="twitter:image" content="https://www.carta.tech/images/vzquota-vzquota-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/vzquota.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="vzquota (8) manual" />
  <meta property="og:description" content="Manipulate containers disk quotas" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/vzquota-vzquota-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">vzquota<small> (8)</small></h1>
        <p class="lead">Manipulate containers disk quotas</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/vzquota.8.html">
      <span itemprop="name">vzquota: Manipulate containers disk quotas</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/vzquota/">
      <span itemprop="name">vzquota</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/vzquota.8.html">
      <span itemprop="name">vzquota: Manipulate containers disk quotas</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>vzquota</strong> [<em>quota_options</em>] <em>command quota_id</em> [<em>command_options</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>vzquota</strong> controls disk quotas for Virtuozzo/OpenVZ container. These are per-container disk quotas set from Virtuozzo/OpenVZ host system.</p><p>The <em>command</em> can be one of the following: <strong>init</strong>, <strong>drop</strong>, <strong>on</strong>, <strong>off</strong>, <strong>setlimit</strong>, <strong>setlimit2</strong>, <strong>reload2</strong>, <strong>stat</strong>, <strong>show</strong>.</p><p>The <em>quota_id</em> must be numeric-only identifier. Note, that quota ID is not the same as container ID (CTID). One container can mount several filesystems and each of them can have its own quotas.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<h3>General</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>-h</strong></p>
  </dt>
  <dd>
    <p>Print usage information.</p>
  </dd>
  <dt>
    <p><strong>-V</strong></p>
  </dt>
  <dd>
    <p>Print utility version.</p>
  </dd>
  <dt>
    <p><strong>-q</strong></p>
  </dt>
  <dd>
    <p>Quiet mode. Causes all warning and diagnostic messages to be suppressed. Only fatal errors are displayed.</p>
  </dd>
  <dt>
    <p><strong>-v</strong></p>
  </dt>
  <dd>
    <p>Verbose mode. Causes <strong>vzquota</strong> to print debugging messages about its progress. Multiple <strong>-v</strong> options increase verbosity. Maximum is 2.</p>
  </dd>
  <dt>
    <p><strong>-b</strong></p>
  </dt>
  <dd>
    <p>Batch mode. in this mode outputs (usually on <strong>stat</strong> and <strong>show</strong> commands) will be in format better suitable for parsing by a script.</p>
  </dd>

</dl>

<h3>Quota Commands</h3>
<p>The following commands are available:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>init</strong></p>
  </dt>
  <dd>
    <p>A necessary preliminary for any other quota command work: create a new quota file, calculating current disk usage from given path. This command requires full set of quota soft- and hardlimits given as command-line options. Limits are also stored in quota file, so subsequent <strong>vzquota on</strong> doesn't requires any quota limit as command-line parameter, although accepts them as well. New specified limits and flags will also be stored in the quota file.</p><p>You can also create your own quota files for arbitrary quota accounting points. Quota file location and path to quota accounting point can be specified via <strong>-c</strong> and <strong>-p</strong> options (see below). You can use also <strong>-R</strong> option instead of <strong>-c</strong> option, to set relative quota file location. In this case quota file resides one dirrectory upper than quota accounting point and has special name (see below).</p>
  </dd>
  <dt>
    <p><strong>drop</strong></p>
  </dt>
  <dd>
    <p>Remove quota file. Command checks if quota is running and refuses to remove file in this case, option <strong>-f</strong> allows to override that rule.</p>
  </dd>
  <dt>
    <p><strong>on</strong></p>
  </dt>
  <dd>
    <p>Turn quota on. If previous quota session wasn't switched off properly (quota is not running, but quota file indicates it is), initialization procedure will be performed. <strong>-f</strong> option allow to force initialization procedure regardless of the shutdown status. Command <strong>on</strong> doesn't work in case specified quota id is running.</p>
  </dd>
  <dt>
    <p><strong>off</strong></p>
  </dt>
  <dd>
    <p>Turn quota off, write usage statistic back to the quota file. Doesn't work if quota file cannot be accessed, also accepts <strong>-f</strong> option (force switching off, even if usage statistic will be lost). This is possible that quota will still be in a stopped state, even if <strong>-f</strong> flag is used.</p>
  </dd>
  <dt>
    <p><strong>setlimit</strong></p>
  </dt>
  <dd>
    <p>Set new quota parameters. Requires at least one quota parameter or flag specified. Applies new parameters immediately if quota with given quota_id is running. Stores new limits and flags in the quota file. Option <strong>-f</strong> specifies to mark quota as dirty, so at the next quota start, disk will be rescanned and usage updated.</p>
  </dd>
  <dt>
    <p><strong>setlimit2</strong></p>
  </dt>
  <dd>
    <p>Set second-level quota parameters. Applies new parameters immediately if quota with given quota_id is running and second-level quota is on. Stores new limits in the quota file.</p>
  </dd>
  <dt>
    <p><strong>reload2</strong></p>
  </dt>
  <dd>
    <p>Reload second-level quota limits from quota file for given quota_id.</p>
  </dd>
  <dt>
    <p><strong>stat</strong></p>
  </dt>
  <dd>
    <p>Show usage statistics and update it in quota file. Option <strong>-f</strong> causes to do not read and update quota file, just print statistics from kernel. Option <strong>-t</strong> specifies to show and update user/group based quota statistics for a container. Works on running containers only. The command with <strong>-t</strong> option flushes all quota statistics from kernel to file and thus may be used for backup purposes.</p>
  </dd>
  <dt>
    <p><strong>show</strong></p>
  </dt>
  <dd>
    <p>Show usage and limits info from quota file. Option <strong>-t</strong> specifies to show user/group quota information as well.</p>
  </dd>

</dl>

<h3>Setting quota limits</h3>
<p>All these options are required in <strong>init</strong> command, and optionally accepted in <strong>on</strong> and <strong>setlimit</strong> commands.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-s</strong>,<strong>--sub-quotas</strong>1<strong>|</strong>0</p>
  </dt>
  <dd>
    <p>Enables or disables user/group based quota inside the container. Here <strong>1</strong> means to enable, and <strong>0</strong> - to disable. By default user/group quota is disabled. This option is accepted by <strong>init</strong>, <strong>on</strong> and <strong>setlimit</strong> commands.</p>
  </dd>
  <dt>
    <p><strong>-u</strong><em>user_id</em></p>
  </dt>
  <dd>
    <p>For <strong>setlimit2</strong> command only. Limits will be applied to the specified <em>user_id</em>.</p>
  </dd>
  <dt>
    <p><strong>-g</strong><em>group_id</em></p>
  </dt>
  <dd>
    <p>For <strong>setlimit2</strong> command only. Limits will be applied to the specified <em>group_id</em>.</p>
  </dd>
  <dt>
    <p><strong>-u</strong>, <strong>--ugid-limit</strong> <em>limit</em></p>
  </dt>
  <dd>
    <p>For <strong>on</strong> and <strong>setlimit</strong> commands only. Specifies maximum number of user and group IDs allowed in the container. If the value is <strong>0</strong>, user/group quota will not be accounted. Default value is <em>0</em>. There is one note concerning <strong>setlimit</strong> command. If first-level quota is running, second-level quota is active and not all ugid objects were loaded into kernel by <strong>on</strong> command due to insufficient <em>ugid_limit</em> value (this can be checked by issuing <strong>stat -t</strong> command and observing whether ugid limit was exceeded), then <strong>setlimit</strong> with new <em>limit</em> value updates it in kernel and file but this change does not take immediate effect. Modification will be applied after quota restart.</p>
  </dd>
  <dt>
    <p><strong>-b</strong>, <strong>--block-softlimit</strong> <em>bsl</em></p>
  </dt>
  <dd>
    <p>Disk quota block soft limit. Soft limit is amount of blocks which excess is allowed in time equal <em>exptime</em>. On the expiration of this time soft limit becomes hard limit. Block limits are set in 1k sized blocks.</p>
  </dd>
  <dt>
    <p><strong>-B</strong>, <strong>--block-hardlimit</strong> <em>bhl</em></p>
  </dt>
  <dd>
    <p>Disk quota block hard limit. Hard limit is amount of blocks which excess is not allowed.</p>
  </dd>
  <dt>
    <p><strong>-e</strong>, <strong>--block-exptime</strong> <em>bet</em></p>
  </dt>
  <dd>
    <p>Disk quota expiration time for excess of a block soft limit. Time can be given in two different formats:</p><p>1. <em>dd:hh:mm:ss</em></p><p>For instance: <em>30</em> - 30 seconds; <em>12:00</em> - 12 minutes; <em>20:15:11:00</em> - 20 days, 15 hours, 11 minutes</p><p>2. <em>xxA</em>, where <em>A</em> - h/H(hour); d/D(day); w/W(week); m/M(month); y/Y(year).</p><p>For instance: <em>7D</em> - 7 days; <em>01w</em> - 1 week; <em>3m</em> - 3 months</p>
  </dd>
  <dt>
    <p><strong>-i</strong>, <strong>--inode-softlimit</strong> <em>isl</em></p>
  </dt>
  <dd>
    <p>Disk quota inode soft limit. Similarly to block soft limit.</p>
  </dd>
  <dt>
    <p><strong>-I</strong>, <strong>--inode-hardlimit</strong> <em>ihl</em></p>
  </dt>
  <dd>
    <p>Disk quota inode hard limit.</p>
  </dd>
  <dt>
    <p><strong>-n</strong>, <strong>--inode-exptime</strong> <em>iet</em></p>
  </dt>
  <dd>
    <p>Disk quota expiration time for excess of a inode soft limit.</p>
  </dd>

</dl>

<h3>Other options</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>-p</strong><em>path</em></p>
  </dt>
  <dd>
    <p>Point of quota accounting for given <em>quota_id</em>. This option required for <strong>init</strong> command and can be used also with any another command to override quota path obtained from quota file. For <strong>on</strong> and <strong>setlimit</strong> commands, this option can be used to set and save new quota accounting path for given <em>quota_id</em></p>
  </dd>
  <dt>
    <p><strong>-R</strong></p>
  </dt>
  <dd>
    <p>Set special relative path to <em>quota_file</em>. If this option is specified, quota file location will depends on path to quota accounting dir: if your quota accounting path is /path/to/<em>somewhere</em>/ than quota file will be /path/to/quota.<em>somewhere</em>. If this option is not specified, quota file location is /var/lib/vzquota/quota.<em>quota_id</em>. All commands accept this option.</p>
  </dd>
  <dt>
    <p><strong>-c</strong><em>quota_file</em></p>
  </dt>
  <dd>
    <p>This option allows to specify a <em>quota_file</em> to work with. All commands accept this option. If this option is not specified, default file location depends on whether <strong>-R</strong> option is specified or not (see above).</p>
  </dd>
  <dt>
    <p><strong>-f</strong></p>
  </dt>
  <dd>
    <p>Force option. Accepted by <strong>drop</strong>, <strong>on</strong>, <strong>off</strong>, <strong>stat</strong>, <strong>setlimit</strong> and <strong>setlimit2</strong> commands. Action of this option differs for different commands and is described above for each command separately.</p>
  </dd>
  <dt>
    <p><strong>-t</strong></p>
  </dt>
  <dd>
    <p>For <strong>stat</strong> and <strong>show</strong> commands only. Processes user/group quota statistics. Specifies whether to show (update in file) user/group quota information.</p>
  </dd>
  <dt>
    <p><strong>-t</strong></p>
  </dt>
  <dd>
    <p>For <strong>setlimit2</strong> command. Set second-level quota time grace parameters.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LIMITATIONS</h2>
        <div class="sectioncontent">
<p>It is impossible to start or stop quota accounting if the directory given by <strong>-p</strong> option is busy. This is rather limitation of kernel part of disk quota implementation.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DISPLAY</h2>
        <div class="sectioncontent">
<p><strong>vzquota stat</strong> and <strong>vzquota show</strong> display the following information:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>resource</strong></p>
  </dt>
  <dd>
    <p>Either 1k-blocks or inodes.</p>
  </dd>
  <dt>
    <p><strong>usage</strong></p>
  </dt>
  <dd>
    <p>Current usage of resource.</p>
  </dd>
  <dt>
    <p><strong>softlimit</strong></p>
  </dt>
  <dd>
    <p>Resource limit. Current usage can exceed this limit up to hard limit during grace time.</p>
  </dd>
  <dt>
    <p><strong>hardlimit</strong></p>
  </dt>
  <dd>
    <p>Resource limit. Current usage can't exceed this limit.</p>
  </dd>
  <dt>
    <p><strong>grace</strong></p>
  </dt>
  <dd>
    <p>During this amount of time usage can exceed softlimit. If a soft limit has not been exceeded the grace column is blank. If the grace period has expired, the grace column contain special <strong>none</strong> value.</p>
  </dd>

</dl>
<p>In case option <strong>-t</strong> is specified, the following information is also displayed:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>User/group quota:</strong></p>
  </dt>
  <dd>
    <p>Status of the 2nd level quota. This can be <strong>on</strong> or <strong>off</strong>, <strong>active</strong> or <strong>inactive</strong>. Values <strong>on</strong>/<strong>off</strong> define the state of the 2nd level quota at the next start of container quota. Values <strong>active</strong>/<strong>inactive</strong> indicate the current state of the 2nd level quota in the kernel.</p>
  </dd>
  <dt>
    <p><strong>Ugids:</strong></p>
  </dt>
  <dd>
    <p>Three values are shown: <em>loaded</em>, <em>total</em> and <em>limit</em>. <em>loaded</em> is the number of records (uids or gids) in the kernel. <em>total</em> is the number of unique records located in the kernel and quota file. <em>limit</em> is the current kernel limit of records amount. Note that <em>loaded</em> and <em>total</em> may be greater then <em>limit</em>.</p>
  </dd>
  <dt>
    <p><strong>Ugid limit was exceeded:</strong></p>
  </dt>
  <dd>
    <p>Can be <strong>yes</strong> or <strong>no</strong>. <strong>yes</strong> indicates that vzquota did not loaded all records into the kernel. In this case you should reduce the number of unique records (remove files which belong to unnecessary users) or increase the ugid limit. After that you should restart quota.</p>
  </dd>
  <dt>
    <p><strong>User/group grace times and quotafile flags:</strong></p>
  </dt>
  <dd>
    <p>Grace times and quota file flags (internal parameters of standard linux kernel quota v.3).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>0</strong></p>
  </dt>
  <dd>
    <p>Command executed successfully</p>
  </dd>
  <dt>
    <p><strong>1</strong></p>
  </dt>
  <dd>
    <p>System error</p>
  </dd>
  <dt>
    <p><strong>2</strong></p>
  </dt>
  <dd>
    <p>Usage error</p>
  </dd>
  <dt>
    <p><strong>3</strong></p>
  </dt>
  <dd>
    <p>Virtuozzo syscall error</p>
  </dd>
  <dt>
    <p><strong>4</strong></p>
  </dt>
  <dd>
    <p>Quota file error</p>
  </dd>
  <dt>
    <p><strong>5</strong></p>
  </dt>
  <dd>
    <p>Quota is already running</p>
  </dd>
  <dt>
    <p><strong>6</strong></p>
  </dt>
  <dd>
    <p>Quota is not running</p>
  </dd>
  <dt>
    <p><strong>7</strong></p>
  </dt>
  <dd>
    <p>Can not get lock on this quota id</p>
  </dd>
  <dt>
    <p><strong>8</strong></p>
  </dt>
  <dd>
    <p>Directory tree crosses mount points</p>
  </dd>
  <dt>
    <p><strong>9</strong></p>
  </dt>
  <dd>
    <p>Quota is running but user/group quota is inactive; this status is returned by <strong>stat -t</strong> command for information purposes and does not indicate a error</p>
  </dd>
  <dt>
    <p><strong>10</strong></p>
  </dt>
  <dd>
    <p>Quota is marked as dirty in file; this status is returned by <strong>show</strong> command for information purposes and does not indicate a error</p>
  </dd>
  <dt>
    <p><strong>11</strong></p>
  </dt>
  <dd>
    <p>Quota file does not exist</p>
  </dd>
  <dt>
    <p><strong>12</strong></p>
  </dt>
  <dd>
    <p>Internal error</p>
  </dd>
  <dt>
    <p><strong>13</strong></p>
  </dt>
  <dd>
    <p>Can't obtain mount point</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (C) 2000-2011, Parallels, Inc. Licensed under GNU GPL.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="vzpid.8.html"><span aria-hidden="true">&larr;</span> vzpid.8: Display the ct id given the process id</a></li>
   <li class="next"><a href="vzsplit.8.html">vzsplit.8: Generate a sample container configuration file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
