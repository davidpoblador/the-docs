<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>sam_overview: Overview of the simple availability manager</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Overview of the simple availability manager">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="sam_overview (8) manual">
  <meta name="twitter:description" content="Overview of the simple availability manager">
  <meta name="twitter:image" content="https://www.carta.tech/images/corosync-sam_overview-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/sam_overview.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="sam_overview (8) manual" />
  <meta property="og:description" content="Overview of the simple availability manager" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/corosync-sam_overview-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">sam_overview<small> (8)</small></h1>
        <p class="lead">Overview of the simple availability manager</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/sam_overview.8.html">
      <span itemprop="name">sam_overview: Overview of the simple availability manager</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/corosync/">
      <span itemprop="name">corosync</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/sam_overview.8.html">
      <span itemprop="name">sam_overview: Overview of the simple availability manager</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">OVERVIEW</h2>
        <div class="sectioncontent">
<p>The SAM library provide a tool to check the health of an application. The main purpose of SAM is to restart a local process when it fails to respond to a healthcheck request in a configured time interval.</p><p>During <a href="../man3/sam_initialize.3.html"><strong>sam_initialize</strong>(3)</a></strong>, a duplicate copy of the process is created using the <strong>fork</strong>(3)</strong> system call.  This duplicate process copy contains the logic for executing the SAM server.  The SAM server is responsible for requesting healthchecks from the active process, and controlling the lifecycle of the active process when it fails.  If the active process fails to respond to the healthcheck request sent by the SAM server, it will be sent a user configurable signal (default SIGTERM) to request shutdown of the application.  After a configured time interval, the process will be forcibly killed by being sent a SIGKILL signal.  Once the active process terminates, the SAM server will create a new active process.</p><p>The Simple Availability Manager is meant to be used in conjunction with the cpg service.  Used together, it is possible to restart a cpg process that fails healthchecking during operation.</p><p>The main features of SAM include:</p><ul>
<li><p>A configurable recovery policy.</p></li><li><p>A configurable time interval for health check operations.</p></li><li><p>A notification via signal before recovery action is taken.</p></li><li><p>A mechanism to indicate to the application the number of times an active process has been created by the SAM server.</p></li><li><p>Both application driven health checking and event driven health checking.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Initializing SAM</h2>
        <div class="sectioncontent">
<p>The SAM library is initialized by <a href="../man3/sam_initialize.3.html"><strong>sam_initialize</strong>(3)</a></strong>. <strong>sam_initalize</strong>(3)</strong> may only be called once per process.  Calling it more then once has undefined results and is not recommended or tested.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Setting warning callback</h2>
        <div class="sectioncontent">
<p>User configurable signal (default <em>SIGTERM</em>) is sent to the application when a recovery action is planned.  The application can use the <strong>signal</strong>(3)</strong> system call to monitor for this signal.</p><p>There are no special constraints on what SAM apis may be called in a warning callback.  After <em>time_interval</em> expires, a SIGKILL signal is sent to the active process to force its termination.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Registering the active process</h2>
        <div class="sectioncontent">
<p>The active process is registered with SAM by calling <a href="../man3/sam_register.3.html"><strong>sam_register</strong>(3)</a></strong>. This function should only be called one time in a process.  After a recovery action is taken, the new active process will begin execution at the next line of code in a user process after <a href="../man3/sam_register.3.html"><strong>sam_register</strong>(3)</a></strong>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Enabling event driven healthchecking</h2>
        <div class="sectioncontent">
<p>Two types of healthchecking are available to the user.  The first model is one where the user application healthchecks during its normal operation.  It is never requested to healtcheck, and if the active process doesn't respond within the time interval, the process will be restarted.</p><p>A more useful mechanism for healthchecking is event driven healthchecking. Because this model is directed by the SAM server, It isn't necessary to guess or add timers to the active process to signal a healthcheck operation is successful.  To use event driven healthchecking, the <a href="../man3/sam_hc_callback_register.3.html"><strong>sam_hc_callback_register</strong>(3)</a></strong> function should be executed.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO sam_overview&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man3/sam_initialize.3.html"><strong>sam_initialize</strong>(3)</a>, <a href="../man3/sam_finalize.3.html"><strong>sam_finalize</strong>(3)</a>, <a href="../man3/sam_start.3.html"><strong>sam_start</strong>(3)</a>, <a href="../man3/sam_stop.3.html"><strong>sam_stop</strong>(3)</a>, <a href="../man3/sam_register.3.html"><strong>sam_register</strong>(3)</a>, <a href="../man3/sam_warn_signal_set.3.html"><strong>sam_warn_signal_set</strong>(3)</a>, <a href="../man3/sam_hc_send.3.html"><strong>sam_hc_send</strong>(3)</a>, <a href="../man3/sam_hc_callback_register.3.html"><strong>sam_hc_callback_register</strong>(3)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="safenet.8.html"><span aria-hidden="true">&larr;</span> safenet.8: Driver for safenet compatible ups equipment</a></li>
   <li class="next"><a href="samba.8.html">samba.8: Server to provide ad and smb/cifs services to clients <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
