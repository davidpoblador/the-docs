<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>rbd: Manage rados block device (rbd) images</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Manage rados block device (rbd) images">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="rbd (8) manual">
  <meta name="twitter:description" content="Manage rados block device (rbd) images">
  <meta name="twitter:image" content="https://www.carta.tech/images/ceph-common-rbd-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/rbd.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="rbd (8) manual" />
  <meta property="og:description" content="Manage rados block device (rbd) images" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/ceph-common-rbd-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">rbd<small> (8)</small></h1>
        <p class="lead">Manage rados block device (rbd) images</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/rbd.8.html">
      <span itemprop="name">rbd: Manage rados block device (rbd) images</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/ceph-common/">
      <span itemprop="name">ceph-common</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/rbd.8.html">
      <span itemprop="name">rbd: Manage rados block device (rbd) images</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>rbd</strong> [ -c <em>ceph.conf</em> ] [ -m <em>monaddr</em> ] [ -p | --pool <em>pool</em> ] [
--size <em>size</em> ] [ --order <em>bits</em> ] [ <em>command</em> ... ]
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>rbd</strong> is a utility for manipulating rados block device (RBD) images, used by the Linux rbd driver and the rbd storage driver for Qemu/KVM. RBD images are simple block devices that are striped over objects and stored in a RADOS object store. The size of the objects the image is striped over must be a power of two.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-c ceph.conf, --conf ceph.conf</strong></p>
  </dt>
  <dd>
    <p>Use ceph.conf configuration file instead of the default /etc/ceph/ceph.conf to determine monitor addresses during startup.</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    <p><strong>-m monaddress[:port]</strong></p>
  </dt>
  <dd>
    <p>Connect to specified monitor (instead of looking through ceph.conf).</p>
  </dd>
  <dt>
    <p><strong>-p pool, --pool pool</strong></p>
  </dt>
  <dd>
    <p>Interact with the given pool. Required by most commands.</p>
  </dd>
  <dt>
    <p><strong>--no-progress</strong></p>
  </dt>
  <dd>
    <p>Do not output progress information (goes to standard error by default for some commands).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PARAMETERS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>--image-format format</strong></p>
  </dt>
  <dd>
    <p>Specifies which object layout to use. The default is 1.</p><ul>
<li><p>format 1 - Use the original format for a new rbd image. This format is understood by all versions of librbd and the kernel rbd module, but does not support newer features like cloning.</p></li><li><p>format 2 - Use the second rbd format, which is supported by librbd (but not the kernel rbd module) at this time. This adds support for cloning and is more easily extensible to allow more features in the future.</p></li>
</ul>
  </dd>
  <dt>
    <p><strong>--size size-in-mb</strong></p>
  </dt>
  <dd>
    <p>Specifies the size (in megabytes) of the new rbd image.</p>
  </dd>
  <dt>
    <p><strong>--order bits</strong></p>
  </dt>
  <dd>
    <p>Specifies the object size expressed as a number of bits, such that the object size is <strong>1 &lt;&lt; order</strong>. The default is 22 (4 MB).</p>
  </dd>
  <dt>
    <p><strong>--stripe-unit size-in-bytes</strong></p>
  </dt>
  <dd>
    <p>Specifies the stripe unit size in bytes.  See striping section (below) for more details.</p>
  </dd>
  <dt>
    <p><strong>--stripe-count num</strong></p>
  </dt>
  <dd>
    <p>Specifies the number of objects to stripe over before looping back to the first object.  See striping section (below) for more details.</p>
  </dd>
  <dt>
    <p><strong>--snap snap</strong></p>
  </dt>
  <dd>
    <p>Specifies the snapshot name for the specific operation.</p>
  </dd>
  <dt>
    <p><strong>--id username</strong></p>
  </dt>
  <dd>
    <p>Specifies the username (without the <strong>client.</strong> prefix) to use with the map command.</p>
  </dd>
  <dt>
    <p><strong>--keyfile filename</strong></p>
  </dt>
  <dd>
    <p>Specifies a file containing the secret to use with the map command. If not specified, <strong>client.admin</strong> will be used by default.</p>
  </dd>
  <dt>
    <p><strong>--keyring filename</strong></p>
  </dt>
  <dd>
    <p>Specifies a keyring file containing a secret for the specified user to use with the map command.  If not specified, the default keyring locations will be searched.</p>
  </dd>
  <dt>
    <p><strong>--shared tag</strong></p>
  </dt>
  <dd>
    <p>Option for <em>lock add</em> that allows multiple clients to lock the same image if they use the same tag. The tag is an arbitrary string. This is useful for situations where an image must be open from more than one client at once, like during live migration of a virtual machine, or for use underneath a clustered filesystem.</p>
  </dd>
  <dt>
    <p><strong>--format format</strong></p>
  </dt>
  <dd>
    <p>Specifies output formatting (default: plain, json, xml)</p>
  </dd>
  <dt>
    <p><strong>--pretty-format</strong></p>
  </dt>
  <dd>
    <p>Make json or xml formatted output more human-readable.</p>
  </dd>
  <dt>
    <p><strong>-o map-options, --options map-options</strong></p>
  </dt>
  <dd>
    <p>Specifies which options to use when mapping an image.  map-options is a comma-separated string of options (similar to <a href="../man8/mount.8.html"><strong>mount</strong>(8)</a> mount options). See map options section below for more details.</p>
  </dd>
  <dt>
    <p><strong>--read-only</strong></p>
  </dt>
  <dd>
    <p>Map the image read-only.  Equivalent to -o ro.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMMANDS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong></strong><strong>ls</strong><strong> [-l | --long] [pool-name]</strong></p>
  </dt>
  <dd>
    <p>Will list all rbd images listed in the rbd_directory object.  With -l, also show snapshots, and use longer-format output including size, parent (if clone), format, etc.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>info</strong><strong> [</strong><em>image-name</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Will dump information (such as size and order) about a specific rbd image. If image is a clone, information about its parent is also displayed. If a snapshot is specified, whether it is protected is shown as well.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>create</strong><strong> [</strong><em>image-name</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Will create a new rbd image. You must also specify the size via --size.  The --stripe-unit and --stripe-count arguments are optional, but must be used together.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>clone</strong><strong> [</strong><em>parent-snapname</em><strong>] [</strong><em>image-name</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Will create a clone (copy-on-write child) of the parent snapshot. Object order will be identical to that of the parent image unless specified. Size will be the same as the parent snapshot.</p><p>The parent snapshot must be protected (see <em>rbd snap protect</em>). This requires image format 2.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>flatten</strong><strong> [</strong><em>image-name</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>If image is a clone, copy all shared blocks from the parent snapshot and make the child independent of the parent, severing the link between parent snap and child.  The parent snapshot can be unprotected and deleted if it has no further dependent clones.</p><p>This requires image format 2.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>children</strong><strong> [</strong><em>image-name</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>List the clones of the image at the given snapshot. This checks every pool, and outputs the resulting poolname/imagename.</p><p>This requires image format 2.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>resize</strong><strong> [</strong><em>image-name</em><strong>] [--allow-shrink]</strong></p>
  </dt>
  <dd>
    <p>Resizes rbd image. The size parameter also needs to be specified. The --allow-shrink option lets the size be reduced.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>rm</strong><strong> [</strong><em>image-name</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Deletes an rbd image (including all data blocks). If the image has snapshots, this fails and nothing is deleted.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>export</strong><strong> [</strong><em>image-name</em><strong>] [</strong><em>dest-path</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Exports image to dest path (use - for stdout).</p>
  </dd>
  <dt>
    <p><strong></strong><strong>import</strong><strong> [</strong><em>path</em><strong>] [</strong><em>dest-image</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Creates a new image and imports its data from path (use - for stdin).  The import operation will try to create sparse rbd images if possible.  For import from stdin, the sparsification unit is the data block size of the destination image (1 &lt;&lt; order).</p>
  </dd>
  <dt>
    <p><strong></strong><strong>export-diff</strong><strong> [</strong><em>image-name</em><strong>] [</strong><em>dest-path</em><strong>] [--from-snap </strong><em>snapname</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Exports an incremental diff for an image to dest path (use - for stdout).  If an initial snapshot is specified, only changes since that snapshot are included; otherwise, any regions of the image that contain data are included.  The end snapshot is specified using the standard --snap option or @snap syntax (see below).  The image diff format includes metadata about image size changes, and the start and end snapshots.  It efficiently represents discarded or &apos;zero&apos; regions of the image.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>import-diff</strong><strong> [</strong><em>src-path</em><strong>] [</strong><em>image-name</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Imports an incremental diff of an image and applies it to the current image.  If the diff was generated relative to a start snapshot, we verify that snapshot already exists before continuing.  If there was an end snapshot we verify it does not already exist before applying the changes, and create the snapshot when we are done.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>diff</strong><strong> [</strong><em>image-name</em><strong>] [--from-snap </strong><em>snapname</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Dump a list of byte extents in the image that have changed since the specified start snapshot, or since the image was created.  Each output line includes the starting offset (in bytes), the length of the region (in bytes), and either &apos;zero&apos; or &apos;data&apos; to indicate whether the region is known to be zeros or may contain other data.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>cp</strong><strong> [</strong><em>src-image</em><strong>] [</strong><em>dest-image</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Copies the content of a src-image into the newly created dest-image. dest-image will have the same size, order, and image format as src-image.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>mv</strong><strong> [</strong><em>src-image</em><strong>] [</strong><em>dest-image</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Renames an image.  Note: rename across pools is not supported.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>snap</strong><strong> ls [</strong><em>image-name</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Dumps the list of snapshots inside a specific image.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>snap</strong><strong> create [</strong><em>image-name</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Creates a new snapshot. Requires the snapshot name parameter specified.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>snap</strong><strong> rollback [</strong><em>image-name</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Rollback image content to snapshot. This will iterate through the entire blocks array and update the data head content to the snapshotted version.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>snap</strong><strong> rm [</strong><em>image-name</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Removes the specified snapshot.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>snap</strong><strong> purge [</strong><em>image-name</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Removes all snapshots from an image.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>snap</strong><strong> protect [</strong><em>image-name</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Protect a snapshot from deletion, so that clones can be made of it (see <em>rbd clone</em>).  Snapshots must be protected before clones are made; protection implies that there exist dependent cloned children that refer to this snapshot.  <em>rbd clone</em> will fail on a nonprotected snapshot.</p><p>This requires image format 2.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>snap</strong><strong> unprotect [</strong><em>image-name</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Unprotect a snapshot from deletion (undo <em>snap protect</em>).  If cloned children remain, <em>snap unprotect</em> fails.  (Note that clones may exist in different pools than the parent snapshot.)</p><p>This requires image format 2.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>map</strong><strong> [</strong><em>image-name</em><strong>] [-o | --options </strong><em>map-options</em><strong> ] [--read-only]</strong></p>
  </dt>
  <dd>
    <p>Maps the specified image to a block device via the rbd kernel module.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>unmap</strong><strong> [</strong><em>device-path</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Unmaps the block device that was mapped via the rbd kernel module.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>showmapped</strong><strong></strong></p>
  </dt>
  <dd>
    <p>Show the rbd images that are mapped via the rbd kernel module.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>lock</strong><strong> list [</strong><em>image-name</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Show locks held on the image. The first column is the locker to use with the <em>lock remove</em> command.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>lock</strong><strong> add [</strong><em>image-name</em><strong>] [</strong><em>lock-id</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Lock an image. The lock-id is an arbitrary name for the user&apos;s convenience. By default, this is an exclusive lock, meaning it will fail if the image is already locked. The --shared option changes this behavior. Note that locking does not affect any operation other than adding a lock. It does not protect an image from being deleted.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>lock</strong><strong> remove [</strong><em>image-name</em><strong>] [</strong><em>lock-id</em><strong>] [</strong><em>locker</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Release a lock on an image. The lock id and locker are as output by lock ls.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>bench-write</strong><strong> [</strong><em>image-name</em><strong>] --io-size [</strong><em>io-size-in-bytes</em><strong>] --io-threads [</strong><em>num-ios-in-flight</em><strong>] --io-total [</strong><em>total-bytes-to-write</em><strong>]</strong></p>
  </dt>
  <dd>
    <p>Generate a series of sequential writes to the image and measure the write throughput and latency.  Defaults are: --io-size 4096, --io-threads 16, --io-total 1GB</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">IMAGE NAME</h2>
        <div class="sectioncontent">
<p>In addition to using the --pool and the --snap options, the image name can include both the pool name and the snapshot name. The image name format is as follows:</p>
<pre>
[pool/]image-name[@snap]
</pre>
<p>Thus an image name that contains a slash character (&apos;/&apos;) requires specifying the pool name explicitly.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">STRIPING</h2>
        <div class="sectioncontent">
<p>RBD images are striped over many objects, which are then stored by the Ceph distributed object store (RADOS).  As a result, read and write requests for the image are distributed across many nodes in the cluster, generally preventing any single node from becoming a bottleneck when individual images get large or busy.</p><p>The striping is controlled by three parameters:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>order</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>The size of objects we stripe over is a power of two, specifially 2^[*order*] bytes. The default</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>is 22, or 4 MB.</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>stripe_unit</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>Each [*stripe_unit*] contiguous bytes are stored adjacently in the same object, before we move on</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>to the next object.</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>stripe_count</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>After we write [*stripe_unit*] bytes to [*stripe_count*] objects, we loop back to the initial object</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>and write another stripe, until the object reaches its maximum size (as specified by [*order*]. At that</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>point, we move on to the next [*stripe_count*] objects.</strong></p>
  </dt>
  <dd>
    <p>By default, [<em>stripe_unit</em>] is the same as the object size and [<em>stripe_count</em>] is 1.  Specifying a different [<em>stripe_unit</em>] requires that the STRIPINGV2 feature be supported (added in Ceph v0.53) and format 2 images be used.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MAP OPTIONS</h2>
        <div class="sectioncontent">
<p>Most of these options are useful mainly for debugging and benchmarking.  The default values are set in the kernel and may therefore depend on the version of the running kernel.</p><ul>
<li><p>fsid=aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee - FSID that should be assumed by the client.</p></li><li><p>ip=a.b.c.d[:p] - IP and, optionally, port the client should use.</p></li><li><p>share - Enable sharing of client instances with other mappings (default).</p></li><li><p>noshare - Disable sharing of client instances with other mappings.</p></li><li><p>crc - Enable CRC32C checksumming for data writes (default).</p></li><li><p>nocrc - Disable CRC32C checksumming for data writes.</p></li><li><p>osdkeepalive=x - OSD keepalive timeout (default is 5 seconds).</p></li><li><p>osd_idle_ttl=x - OSD idle TTL (default is 60 seconds).</p></li><li><p>rw - Map the image read-write (default).</p></li><li><p>ro - Map the image read-only.  Equivalent to --read-only.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>To create a new rbd image that is 100 GB:</p>
<pre>
rbd -p mypool create myimage --size 102400
</pre>
<p>or alternatively:</p>
<pre>
rbd create mypool/myimage --size 102400
</pre>
<p>To use a non-default object size (8 MB):</p>
<pre>
rbd create mypool/myimage --size 102400 --order 23
</pre>
<p>To delete an rbd image (be careful!):</p>
<pre>
rbd rm mypool/myimage
</pre>
<p>To create a new snapshot:</p>
<pre>
rbd snap create mypool/myimage@mysnap
</pre>
<p>To create a copy-on-write clone of a protected snapshot:</p>
<pre>
rbd clone mypool/myimage@mysnap otherpool/cloneimage
</pre>
<p>To see which clones of a snapshot exist:</p>
<pre>
rbd children mypool/myimage@mysnap
</pre>
<p>To delete a snapshot:</p>
<pre>
rbd snap rm mypool/myimage@mysnap
</pre>
<p>To map an image via the kernel with cephx enabled:</p>
<pre>
rbd map mypool/myimage --id admin --keyfile secretfile
</pre>
<p>To unmap an image:</p>
<pre>
rbd unmap /dev/rbd0
</pre>
<p>To create an image and a clone from it:</p>
<pre>
rbd import --image-format 2 image mypool/parent
rbd snap create --snap snapname mypool/parent
rbd snap protect mypool/parent@snap
rbd clone mypool/parent@snap otherpool/child
</pre>
<p>To create an image with a smaller stripe_unit (to better distribute small writes in some workloads):</p>
<pre>
rbd -p mypool create myimage --size 102400 --stripe-unit 65536 --stripe-count 16
</pre>
<p>To change an image from one image format to another, export it and then import it as the desired image format:</p>
<pre>
rbd export mypool/myimage@snap /tmp/img
rbd import --image-format 2 /tmp/img mypool/myimage2
</pre>
<p>To lock an image for exclusive use:</p>
<pre>
rbd lock add mypool/myimage mylockid
</pre>
<p>To release a lock:</p>
<pre>
rbd lock remove mypool/myimage mylockid client.2485
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AVAILABILITY</h2>
        <div class="sectioncontent">
<p><strong>rbd</strong> is part of the Ceph distributed storage system. Please refer to the Ceph documentation at <em>http://ceph.com/docs</em> for more information.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO rbd&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/ceph.8.html"><strong>ceph</strong>(8)</a>, <a href="../man8/rados.8.html"><strong>rados</strong>(8)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>2010-2014, Inktank Storage, Inc. and contributors. Licensed under Creative Commons BY-SA</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="raw.8.html"><span aria-hidden="true">&larr;</span> raw.8: Bind a linux raw character device</a></li>
   <li class="next"><a href="rbd-fuse.8.html">rbd-fuse.8: Expose rbd images as files <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
