<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>staprun: Systemtap runtime</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Systemtap runtime">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="staprun (8) manual">
  <meta name="twitter:description" content="Systemtap runtime">
  <meta name="twitter:image" content="https://www.carta.tech/images/systemtap-runtime-staprun-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/staprun.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="staprun (8) manual" />
  <meta property="og:description" content="Systemtap runtime" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/systemtap-runtime-staprun-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">staprun<small> (8)</small></h1>
        <p class="lead">Systemtap runtime</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/staprun.8.html">
      <span itemprop="name">staprun: Systemtap runtime</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/systemtap-runtime/">
      <span itemprop="name">systemtap-runtime</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/staprun.8.html">
      <span itemprop="name">staprun: Systemtap runtime</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>staprun</strong> [ <em>OPTIONS</em> ] <em>MODULE</em> [ <em>MODULE-OPTIONS</em> ]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <em>staprun</em> program is the back-end of the Systemtap tool.  It expects a kernel module produced by the front-end <em>stap</em> tool.</p><p>Splitting the systemtap tool into a front-end and a back-end allows a user to compile a systemtap script on a development machine that has the kernel development tools (needed to compile the script) and then transfer the resulting kernel module to a production machine that doesn't have any development tools installed.</p><p>Please refer to stappaths (7) for the version number, or run rpm -q systemtap (fedora/red hat) apt-get -v systemtap (ubuntu)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>The <em>staprun</em> program supports the following options.  Any other option prints a list of supported options.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-v</strong></p>
  </dt>
  <dd>
    <p>Verbose mode. The level of verbosity is also set in the <em>SYSTEMTAP_VERBOSE</em> environment variable.</p>
  </dd>
  <dt>
    <p><strong>-V</strong></p>
  </dt>
  <dd>
    <p>Print version number and exit.</p>
  </dd>
  <dt>
    <p><strong>-w</strong></p>
  </dt>
  <dd>
    <p>Suppress warnings from the script.</p>
  </dd>
  <dt>
    <p><strong>-u</strong></p>
  </dt>
  <dd>
    <p>Load the uprobes.ko module.</p>
  </dd>
  <dt>
    <p><strong>-c CMD</strong></p>
  </dt>
  <dd>
    <p>Command CMD will be run and the <em>staprun</em> program will exit when CMD does.  The '_stp_target' variable will contain the pid for CMD.</p>
  </dd>
  <dt>
    <p><strong>-x PID</strong></p>
  </dt>
  <dd>
    <p>The '_stp_target' variable will be set to PID.</p>
  </dd>
  <dt>
    <p><strong>-o FILE</strong></p>
  </dt>
  <dd>
    <p>Send output to FILE. If the module uses bulk mode, the output will be in percpu files FILE_x(FILE_cpux in background and bulk mode) where 'x' is the cpu number. This supports <a href="../man3/strftime.3.html"><strong>strftime</strong>(3)</a> formats for FILE.</p>
  </dd>
  <dt>
    <p><strong>-b BUFFER_SIZE</strong></p>
  </dt>
  <dd>
    <p>The systemtap module will specify a buffer size. Setting one here will override that value. The value should be an integer between 1 and 4095 which be assumed to be the buffer size in MB. That value will be per-cpu if bulk mode is used.</p>
  </dd>
  <dt>
    <p><strong>-L</strong></p>
  </dt>
  <dd>
    <p>Load module and start probes, then detach from the module leaving the probes running.  The module can be attached to later by using the <strong>-A</strong> option.</p>
  </dd>
  <dt>
    <p><strong>-A</strong></p>
  </dt>
  <dd>
    <p>Attach to loaded systemtap module.</p>
  </dd>
  <dt>
    <p><strong>-C WHEN</strong></p>
  </dt>
  <dd>
    <p>Control coloring of error messages. WHEN must be either "never", "always", or "auto" (i.e. enable only if at a terminal). If the option is missing, then "auto" is assumed. Colors can be modified using the SYSTEMTAP_COLORS environment variable. See the <a href="../man1/stap.1.html"><strong>stap</strong>(1)</a> manual page for more information on syntax and behaviour.</p>
  </dd>
  <dt>
    <p><strong>-d</strong></p>
  </dt>
  <dd>
    <p>Delete a module.  Only detached or unused modules the user has permission to access will be deleted. Use "*" (quoted) to delete all unused modules.</p>
  </dd>
  <dt>
    <p><strong>-D</strong></p>
  </dt>
  <dd>
    <p>Run staprun in background as a daemon and show it's pid.</p>
  </dd>
  <dt>
    <p><strong>-R</strong></p>
  </dt>
  <dd>
    <p>Rename the module to a unique name before inserting it.</p>
  </dd>
  <dt>
    <p><strong>-r N:URI</strong></p>
  </dt>
  <dd>
    <p>Pass the given number and URI data to the tapset functions remote_id() and remote_uri().</p>
  </dd>
  <dt>
    <p><strong>-S</strong><em> size[,N]</em></p>
  </dt>
  <dd>
    <p>Sets the maximum size of output file and the maximum number of output files. If the size of output file will exceed <strong>size</strong> , systemtap switches output file to the next file. And if the number of output files exceed <strong>N</strong> , systemtap removes the oldest output file. You can omit the second argument.</p>
  </dd>
  <dt>
    <p><strong>-T timeout</strong></p>
  </dt>
  <dd>
    <p>Sets maximum time reader thread will wait before dumping trace buffer. Value is in ms, default is 200ms. Setting this to a high value decreases number of stapio wake-ups, allowing deeper sleep for embedded platforms. But it impacts interactivity on terminal as traces are dumped less often in case of low throughput. There is no interactivity or performance impact for high throughput as trace is dumped when buffer is full, before this timeout expires.</p>
  </dd>
  <dt>
    <p><strong>var1=val</strong></p>
  </dt>
  <dd>
    <p>Sets the value of global variable var1 to val. Global variables contained within a module are treated as module options and can be set from the staprun command line.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ARGUMENTS</h2>
        <div class="sectioncontent">
<p><strong>MODULE</strong> is either a module path or a module name.  If it is a module name, the module will be looked for in the following directory (where 'VERSION' is the output of "uname -r"):</p><ul>
<li><p>/lib/modules/VERSION/systemtap</p></li>
</ul><p>Any additional arguments on the command line are passed to the module.  One use of these additional module arguments is to set the value of global variables declared within the module.</p><p> $ stap -p4 -m mod1 -e&nbsp;\[aq]global var1="foo"; probe begin{printf("%s&#92;n", var1); exit()}\[aq]</p><p>Running this with an additional module argument:</p><p> $ staprun mod1.ko var1="HelloWorld"</p><p> HelloWorld</p><p>Spaces and exclamation marks currently cannot be passed into global variables this way.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>See the <em>stapex</em>(3stap) manual page for a collection of sample scripts.</p><p>Here is a very basic example of how to use <em>staprun.</em> First, use <em>stap</em> to compile a script.  The <em>stap</em> program will report the pathname to the resulting module.</p><p> $ stap -p4 -e \[aq]probe begin { printf("Hello World!&#92;n"); exit() }\[aq]</p><p> /home/user/.systemtap/cache/85/stap_8553d83f78c_265.ko</p><p>Run <em>staprun</em> with the pathname to the module as an argument.</p><p> $ staprun /home/user/.systemtap/cache/85/stap_8553d83f78c_265.ko</p><p> Hello World!</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MODULE DETACHING AND ATTACHING</h2>
        <div class="sectioncontent">
<p>After the <em>staprun</em> program installs a Systemtap kernel module, users can detach from the kernel module and reattach to it later.  The <strong>-L</strong> option loads the module and automatically detaches.  Users can also detach from the kernel module interactively by sending the SIGQUIT signal from the keyboard (typically by typing Ctrl-&#92;).</p><p>To reattach to a kernel module, the <em>staprun</em> <strong>-A</strong> option would be used.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILE SWITCHING BY SIGNAL</h2>
        <div class="sectioncontent">
<p>After <em>staprun</em> launched the <em>stapio</em> program, users can command it to switch output file to next file when it outputs to file(s) (running staprun with <strong>-o</strong> option) by sending a <strong>SIGUSR2</strong> signal to the <em>stapio</em> process. When it receives SIGUSR2, it will switch output file to new file with suffix <em>.N</em> where N is the sequential number. For example,</p><p> $ staprun -o foo ...</p><p>outputs trace logs to <em>foo</em> and if it receives <strong>SIGUSR2</strong> signal, it switches output to <em>foo.1</em> file. And receiving <strong>SIGUSR2</strong> again, it switches to <em>foo.2</em> file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SAFETY AND SECURITY</h2>
        <div class="sectioncontent">
<p>Systemtap, in the default kernel-module runtime mode, is an administrative tool.  It exposes kernel internal data structures and potentially private user information.  See the <a href="../man1/stap.1.html"><strong>stap</strong>(1)</a> manual page for additional information on safety and security.</p><p>To increase system security, users of systemtap must be root, or in the <em>staprun</em> group in order to execute this setuid <em>staprun</em> program. A user may select a particular privilege level with the stap <em>--privilege=</em> option, which <em>staprun</em> will later enforce.</p>
<dl class='dl-vertical'>
  <dt>
    <p>stapdev</p>
  </dt>
  <dd>
    <p>Members of the <em>stapdev</em> group can write and load script modules with root-equivalent privileges, without particular security constraints.  (Many safety constraints remain.)</p>
  </dd>
  <dt>
    <p>stapsys</p>
  </dt>
  <dd>
    <p>Members of the <em>stapsys</em> group have almost all the privileges of <em>stapdev</em>, except for guru mode constructs.</p>
  </dd>
  <dt>
    <p>staprun</p>
  </dt>
  <dd>
    <p>Members only of the <em>stapusr</em> group may any-privileged modules placed into the /lib/modules/VERSION/systemtap by the system administrator.</p>
  </dd>
  <dt>
    <p>staprun</p>
  </dt>
  <dd>
    <p>Members only of the <em>stapusr</em> group may also write and load low-privilege script modules, which are normally limited to manipulating their own processes (and not the kernel nor other users' processes).</p>
  </dd>

</dl>
<p>Part of the privilege enforcement mechanism may require using a stap-server and administrative trust in its cryptographic signer; see the <a href="../man8/stap-server.8.html"><strong>stap-server</strong>(8)</a> manual page for a for more information.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>/lib/modules/VERSION/systemtap</p>
  </dt>
  <dd>
    <p>If MODULE is a module name, the module will be looked for in this directory. Users who are only in the <em>'stapusr'</em> group can install modules located in this directory.  This directory must be owned by the root user and not be world writable.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO staprun&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/stap.1.html"><strong>stap</strong>(1)</a>, <em>stapprobes</em>(3stap), <a href="../man8/stap-server.8.html"><strong>stap-server</strong>(8)</a>, <strong>stapdyn</strong>(8), <em>stapex</em>(3stap)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Use the Bugzilla link of the project web page or our mailing list. <strong>http://sourceware.org/systemtap/</strong>, <strong>&lt;systemtap@sourceware.org&gt;</strong>.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="stap-server.8.html"><span aria-hidden="true">&larr;</span> stap-server.8: Systemtap compile server management</a></li>
   <li class="next"><a href="starfire-diag.8.html">starfire-diag.8: Eeprom setup and diagnostic program for ethernet cards based on the adaptec 6915 "starfire" chip. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
