<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>chiark-named-conf: Check and generate nameserver configuration</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Check and generate nameserver configuration">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="chiark-named-conf (8) manual">
  <meta name="twitter:description" content="Check and generate nameserver configuration">
  <meta name="twitter:image" content="https://www.carta.tech/images/chiark-scripts-chiark-named-conf-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/chiark-named-conf.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="chiark-named-conf (8) manual" />
  <meta property="og:description" content="Check and generate nameserver configuration" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/chiark-scripts-chiark-named-conf-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">chiark-named-conf<small> (8)</small></h1>
        <p class="lead">Check and generate nameserver configuration</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/chiark-named-conf.8.html">
      <span itemprop="name">chiark-named-conf: Check and generate nameserver configuration</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/chiark-scripts/">
      <span itemprop="name">chiark-scripts</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/chiark-named-conf.8.html">
      <span itemprop="name">chiark-named-conf: Check and generate nameserver configuration</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>chiark-named-conf</strong> [<em>options</em>] <strong>-n</strong>|<strong>-y</strong>|<strong>-f</strong></p><p><strong>chiark-named-conf</strong> [<em>options</em>] <em>zone ...</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>chiark-named-conf</strong> is a tool for managing nameserver configurations and checking for suspected DNS problems.  Its main functions are to check that delegations are appropriate and working, that secondary zones are slaved from the right places, and to generate a configuration for <strong>BIND</strong>, from its own input file.</p><p>By default, for each zone, in addition to any warnings, the output lists the zone's configuration type.  If the zone is checked, the serial number at each of the nameservers is shown, with any unpublished primary having <strong>*</strong> after the serial number.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<h3>MODE OPTIONS</h3>
<p>If one of the options <strong>-n</strong>, <strong>-y</strong>, or <strong>-f</strong> is supplied then chiark-named-conf will read its main configuration file for the list of relevant zones.  It will then check the configuration and delegation for each zone and/or generate and install a new configuration file for the nameserver:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-y</strong>|<strong>--yes</strong></p>
  </dt>
  <dd>
    <p>Generate and install new nameserver config, as well as checking configuration, for all listed zones.</p>
  </dd>
  <dt>
    <p><strong>-n</strong>|<strong>--no</strong></p>
  </dt>
  <dd>
    <p>Check configuration, for all listed zones, but do not generate new nameserver config.</p>
  </dd>
  <dt>
    <p><strong>-f</strong>|<strong>--force</strong></p>
  </dt>
  <dd>
    <p>Generate and install new nameserver config, without doing any configuration cross-checking.  (Syntax errors in our input configuration will still abort this operation.)</p>
  </dd>
  <dt>
    <p><strong>--nothing</strong></p>
  </dt>
  <dd>
    <p>Do nothing: do no checks, and don't write a new config.  This can be used to get a list of the zones being processed.</p>
  </dd>
  <dt>
    <p><strong>--mail-first</strong> | <strong>--mail-middle</strong> | <strong>--mail-final</strong></p>
  </dt>
  <dd>
    <p>Send mails to zone SOA MNAMEs reporting zones with problems.  You must call chiark-named-conf at least twice, once with --mail-first, and later with --mail-final, and preferably with one or more calls to --mail-middle in between.  All three options carry out a check and store the results; --mail-final also sends a mail to the zone SOA MNAME or local administrator, if too many of the calls had errors or warnings (calls before the most recent --mail-first being ignored).</p>
  </dd>
  <dt>
    <p><strong>-mail-final-test</strong></p>
  </dt>
  <dd>
    <p>just like --mail-final except that it always sends mail to the local server admin and never to remote zone contacts, adding <strong>(testing!)</strong> to the start of the To: field.</p>
  </dd>

</dl>
<p>Alternatively, one or more zone names may be supplied as arguments, in which case their delegations will be checked, and compared with the data for that zone in the main configuration (if any).  In this case no new configuration file for the nameserver will be made.</p>
<h3>ADDITIONAL OPTIONS</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>-A</strong>|<strong>--all</strong></p>
  </dt>
  <dd>
    <p>Checks even zones known to be broken.  Ie, ignores the <strong>?</strong> zone style modifier in the configuration.</p>
  </dd>
  <dt>
    <p><strong>-C</strong>|<strong>--config</strong> <em>config-file</em></p>
  </dt>
  <dd>
    <p>Use <em>config-file</em> instead of <strong>/etc/bind/chiark-conf-gen.zones</strong>. Also changes the default directory.</p>
  </dd>
  <dt>
    <p><strong>-D</strong></p>
  </dt>
  <dd>
    <p>Enables debugging.  Useful for debugging chiark-named-conf, but probably not useful for debugging your DNS configuration.  Repeat to increase the debugging level.  (Maximum is <strong>-DD</strong>.)</p>
  </dd>
  <dt>
    <p><strong>-g</strong>|<strong>--glueless</strong></p>
  </dt>
  <dd>
    <p>Do not warn about glueless referrals (strictly, makes the zone style modifier <strong>~</strong> the default).  Not recommended - see the section GLUELESSNESS, below.</p>
  </dd>
  <dt>
    <p><strong>-l</strong>|<strong>--local</strong></p>
  </dt>
  <dd>
    <p>Only checks for mistakes which are the responsibility of the local administrator (to fix or get fixed).  This means that for published and stealth zones we only check that we're slaving from the right place and that any names and addresses for ourself are right.  For primary zones all checks are still done.  It is a mistake to specify <strong>-l</strong> with foreign zones (zones supplied explictly on the command line but not relevant to the local server); doing so produces a warning.</p>
  </dd>
  <dt>
    <p><strong>-m</strong><em>group</em><strong>!*$@~?</strong></p>
  </dt>
  <dd>
    <p>Overrides a <strong>modifiers</strong> directive in the configuration file.  The modifiers specified in the directive are completely replaced by those specified in this command line option.  (Note that modifiers specified in per-zone directives still override these per-group settings.)  If more than one <strong>modifiers</strong> directive specifies the same group, they are all affected. <strong>modifiers</strong> directives which don't specify a group cannot be affected.  It is an error if the group does not appear in the config file.  See ZONE STYLE MODIFIERS, below.</p>
  </dd>

</dl>
<p>The special group <strong>foreign</strong> is used for zones which don't appear in the configuration file.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-q</strong>|<strong>--quiet</strong></p>
  </dt>
  <dd>
    <p>Suppress the usual report of the list of nameservers for each zone and the serial number from each.  When specified twice, do not print any information except warnings.</p>
  </dd>
  <dt>
    <p><strong>-r</strong>|<strong>--repeat</strong></p>
  </dt>
  <dd>
    <p>When a problem is detected, warn for all sources of the same imperfect data, rather than only the first we come across</p>
  </dd>
  <dt>
    <p><strong>-v</strong>|<strong>--verbose</strong></p>
  </dt>
  <dd>
    <p>Print additional information about what is being checked, as we go along.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE</h2>
        <div class="sectioncontent">
<p>The file <strong>/etc/bind/chiark-conf-gen.zones</strong> (or other file specified with the <strong>-C</strong> option) contains a sequence of directives, one per line.  Blank lines are permitted.  Leading and trailing whitespace on each line is ignored.  Comments are lines starting with <strong>#</strong>. Ending a line with a <strong>&#92;</strong> joins it to the next line, so that long directives can be split across several physical lines.</p><h3>GENERAL DIRECTIVES</h3>
<p>These directives specify general configuration details.  They should appear before directives specifying zones, as each will affect only later zone directives.  Foreign zones (zones explicitly specified on the command line but not mentioned in the configuration) use the configuration settings prevailing at the end of the config file.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>admin</strong> <em>email-address</em></p>
  </dt>
  <dd>
    <p>Specifies the email address of the local administrator.  This is used in the From: line of mails sent out, and will also receive copies of the reports.  There is no default.</p>
  </dd>
  <dt>
    <p><strong>default-dir</strong> <em>directory</em></p>
  </dt>
  <dd>
    <p>Makes <em>directory</em> be the default directory (which affects the interpretation of relative filenames).  The default is the directory containing the main configuration file, ie <strong>/etc/bind</strong> if no <strong>-C</strong> option is specified.</p>
  </dd>
  <dt>
    <p><strong>forbid-addr</strong> [<em>ip-address ...</em>]</p>
  </dt>
  <dd>
    <p>Specifies the list of addresses that are forbidden as any nameserver for any zone.  The default is no such addresses.</p>
  </dd>
  <dt>
    <p><strong>forbid-addr</strong> [<em>ip-address ...</em>]</p>
  </dt>
  <dd>
    <p>Specifies the list of addresses that are forbidden as a nameserver for a zone for which we are the primary - ie, the list of our old or to-be-obsoleted slaves.  The default is no such addresses.</p>
  </dd>
  <dt>
    <p><strong>serverless-glueless</strong> <em>domain ...</em></p>
  </dt>
  <dd>
    <p>Specifies a list of domains under which we do not expect to find any nameservers without glue; for these zones it is OK to find glueless referrals. Each domain listed names a complete subtree of the DNS, starting at the named point.  The default is <strong>in-addr.arpa ip6.arpa ip6.int</strong>.</p><p>To avoid indefinitely long or even circularly glueless referrals (which delay or prevent lookups) it is necessary for all sites to effectively implement similar conventions; currently the author believes that only the reverse lookup namespaces are conventionally devoid of (glueless) nameservers, and therefore fine to provide glueless referrals for.  See GLUELESSNESS below.</p>
  </dd>
  <dt>
    <p><strong>allow--indirect-glue</strong> <em>nameserver-superdomain ...</em></p>
  </dt>
  <dd>
    <p>Specifies a list of domains under which we expect to find glueless nameservers, with up to one layer of indirection. For nameservers under these domains it is OK to to find glueless referrals, but only when listed as a nameserver for a zone which is not itself a subdomain of an <strong>allow-indirect-glue</strong> <em>nameserver-superdomain</em>.</p><p>This supports to common configuration style where DNS operator(s) set up all of their nameservers with names within a small subsection of the DNS (the portions under <em>nameserver-superdomain</em>s), and provide glueless referrals naming these nameservers for all other zones.  This provides at most one level of missing glue.</p><p>Note that if the DNS administrators collectively able to influence the service for some zone (including the admins for its superzones, the zones containing its nameservers, and their superzones and so forth) are not in sufficiently close communication do not all agree on the proper set of <em>nameserver-superdomain</em> then they might still set up circular glue and <strong>chiark-named-conf</strong> would not necessarily be able to detect this even if it was run on every relevant nameserver.</p>
  </dd>
  <dt>
    <p><strong>mail-state-dir</strong> <em>directory</em></p>
  </dt>
  <dd>
    <p>Uses <em>directory</em> for storing information about recent failures for mailing to zone admins.  See --mail-first et al.  Old files in here should be cleaned up periodically out of cron.  There is no default.</p>
  </dd>
  <dt>
    <p><strong>mail-max-warnfreq</strong> <em>percentage</em></p>
  </dt>
  <dd>
    <p>When --mail-final is used, a mail will be sent to all zones which had warnings or errors more than <em>percentage</em>% of the times --mail-* was used (since the last --mail-first). The default is 50%.</p>
  </dd>
  <dt>
    <p><strong>modifiers</strong> <strong>!*$@~?</strong>] [<em>group</em>]</p>
  </dt>
  <dd>
    <p>Applies the specified zone style modifiers (see below) to subsequently declared zones (until the next <strong>modifiers</strong> directive), as if the modifiers specified were written out for each zone.  You must specify at least one character for the modifiers; if you want to reset everything to the default, just say <strong>!</strong>. If style modifiers specified in the zone directive conflict with the <strong>modifiers</strong> directive, those specified in the zone directive take effect. <em>group</em> may contain alphanumerics and underscores, and is used for the <strong>-m</strong> command-line option.</p>
  </dd>
  <dt>
    <p><strong>self-addr</strong> <em>ip-address ...</em></p>
  </dt>
  <dd>
    <p>Specifies the list of addresses that this server may be known by in A records.  There is no default.</p>
  </dd>
  <dt>
    <p><strong>output</strong> <em>format</em> <em>filename</em> [<em>format</em> <em>filename ...</em>]</p>
  </dt>
  <dd>
    <p>Arranges that each <em>filename</em> will be overwritten when <strong>-y</strong> or <strong>-f</strong> are used; its new contents will be configuration directives for the zones which follow for the nameserver in question.  Currently the only <em>format</em> supported is <strong>bind8</strong> which indicates new-style BIND 8.  If no zones follow, then each file will still be overwritten, by an effectively empty file. Default: if there is no <strong>output</strong> directive in the configuration then the default is to use <strong>bind8</strong> <strong>chiark-conf-gen.bind8</strong>; otherwise it is an error for there to be any zones in the configuration before the first <strong>output</strong> directive.</p>
  </dd>
  <dt>
    <p><strong>self-ns</strong> <em>fqdn ...</em></p>
  </dt>
  <dd>
    <p>Specifies the list of names that this server may be known by in NS records.  There is no default.  Any trailing * is replaced by the name of the zone being checked, so for example <strong>self-ns isp.ns.*</strong> before the zone example.com would mean to expect us to be listed as isp.ns.example.com in the NS RRset.</p>
  </dd>
  <dt>
    <p><strong>self-soa</strong> <em>fqdn ...</em></p>
  </dt>
  <dd>
    <p>Specifies the list of names that this server may be known by in the ORIGIN field of SOA records.  There is no default.  Any trailing * is replaced by the name of the zone, as for <strong>self-ns</strong>.</p>
  </dd>
  <dt>
    <p><strong>self</strong><em> fqdn ...</em></p>
  </dt>
  <dd>
    <p>Equivalent to both <strong>self-ns  and  self-soa</strong> with the same set of names.</p>
  </dd>
  <dt>
    <p><strong>slave-dir</strong> <em>directory</em> [[<em>prefix</em>] <em>suffix</em>]</p>
  </dt>
  <dd>
    <p>Specifies the directory in which slave (published and stealth) zonefiles should be placed.  The default <em>directory</em> is <strong>/var/cache/bind/chiark-slave</strong>. The default <em>suffix</em> and <em>prefix</em> are empty; they also will be reset to these defaults by a <strong>slave-dir</strong> directive which does not specify them.</p>
  </dd>

</dl>

<h3>ZONE DIRECTIVES</h3>
<p>These directives specify one or more zones.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>primary</strong>[<strong>!*$@~?</strong>] <em>zone filename</em></p>
  </dt>
  <dd>
    <p>Specifies that this server is supposed to be the primary nameserver for <em>zone</em> and that the zone data is to be found in <em>filename</em>.</p>
  </dd>
  <dt>
    <p><strong>primary-dir</strong>[<strong>!*$@~?</strong>] <em>directory</em>[<strong>/</strong><em>prefix</em>] [<em>suffix</em>[<strong>/</strong><em>subfile</em>]]</p>
  </dt>
  <dd>
    <p>Search <em>directory</em> for files whose names start with <em>prefix</em> and end with <em>suffix</em>. Each such file is taken to represent a zone file for which this server is supposed to be the primary; the part of the filename between <em>prefix</em> and <em>suffix</em> is the name of the zone.</p><p>If <strong>/</strong><em>subfile</em> is specified, then instead of looking for files, we search for directories containing <em>subfile</em>; directories which do not contain the subfile are simply skipped.</p><p>If <em>directory</em>[<strong>/</strong><em>prefix</em>] exists as specified and is a directory then it is interpreted as <em>directory</em> with an empty prefix; otherwise the final path component is assumed to be the prefix.  If no <em>suffix</em><strong>/</strong><em>subfile</em> is specified then the default is <strong>_db</strong>.</p>
  </dd>
  <dt>
    <p><strong>published</strong>[<strong>!*$@~?</strong>] <em>zone origin-addr</em></p>
  </dt>
  <dd>
    <p>Specifies that this server is supposed to be a published slave nameserver for the zone in question.</p>
  </dd>
  <dt>
    <p><strong>stealth</strong>[<strong>!*$@~?</strong>] <em>zone server-addr ...</em></p>
  </dt>
  <dd>
    <p>Specifies that this server is supposed to be an unpublished secondary (aka stealth secondary) for the zone in question.</p>
  </dd>

</dl>

<h3>ZONE STYLE MODIFIERS</h3>
<p>Each of the zone directives may optionally be followed by one or more of the following characters (each at most once):</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>!</strong></p>
  </dt>
  <dd>
    <p>Reverses the meaning of all style modifiers after the <strong>!</strong>. Only one <strong>!</strong> must appear in the modifier list.  In this list, other modifiers which default to `enabled' are described by describing the effect of their inverse - see the description for <strong>!@</strong> below.</p>
  </dd>
  <dt>
    <p><strong>*</strong></p>
  </dt>
  <dd>
    <p>Indicates that the zone is unofficial, ie that it is not delegated as part of the global Internet DNS and that no attempt should be made to find the superzone and check delegations.  Note that unofficial, local zones should be created with caution.  They should be in parts of the namespace which are reserved for private use, or belong to the actual zone maintainer.</p>
  </dd>
  <dt>
    <p><strong>$</strong></p>
  </dt>
  <dd>
    <p>Indicates that any mails should be sent about the zone to the nameserver admin rather than to the zone SOA MNAME.  This is the default unless we are supposedly a published server for the zone.</p>
  </dd>
  <dt>
    <p><strong>!@</strong></p>
  </dt>
  <dd>
    <p>Indicates that no mails should be sent about the zone to anyone.</p>
  </dd>
  <dt>
    <p><strong>~</strong></p>
  </dt>
  <dd>
    <p>Indicates that the zone's delegation is known to be glueless, and that lack of glue should not be flagged.  Not recommended - see the section GLUELESSNESS, below.</p>
  </dd>
  <dt>
    <p><strong>?</strong></p>
  </dt>
  <dd>
    <p>Indicates that the zone is known to be broken and no checks should be carried out on it, unless the <strong>-A</strong> option is specified.</p>
  </dd>

</dl>

<h3>OTHER DIRECTIVES</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>include</strong> <em>file</em></p>
  </dt>
  <dd>
    <p>Reads <em>file</em> as if it were included here.</p>
  </dd>
  <dt>
    <p><strong>end</strong></p>
  </dt>
  <dd>
    <p>Ends processing of this file; any data beyond this point is ignored.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CHECKS</h2>
        <div class="sectioncontent">
<p>chiark-named-conf makes the following checks:</p><p>Delegations: Each delegation from a server for the superzone should contain the same set of nameservers.  None of the delegations should lack glue.  The glue addresses should be the same in each delegation, and agree with the local default nameserver.</p><p>Delegated servers: Each server mentioned in the delegation should have the same SOA record (and obviously, should be authoritative).</p><p>All published nameservers - including delegated servers and servers named in the zone's nameserver set: All nameservers for the zone should supply the same list of nameservers for the zone, and none of this authority information should be glueless.  All the glue should always give the same addresses.</p><p>Origin server's data: The set of nameservers in the origin server's version of the zone should be a superset of those in the delegations.</p><p>Our zone configuration: For primary zones, the SOA origin should be one of the names specified with <strong>self-soa</strong> (or <strong>self</strong>). For published zones, the address should be that of the SOA origin. For stealth zones, the address should be that of the SOA origin or one of the published nameservers.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">GLUELESSNESS</h2>
        <div class="sectioncontent">
<p>Glue is the name given for the addresses of nameservers which are often supplied in a referral.  In fact, it turns out that it is important for the reliability and performance of the DNS that referrals, in general, always come with glue.</p><p>Firstly, glueless referrals usually cause extra delays looking up names.  BIND 8, when it receives a completely glueless referral and does not have the nameservers' addresses in its cache, will start queries for the nameserver addresses; but it will throw the original client's question away, so that when these queries arrive, it won't restart the query from where it left off.  This means that the client won't get its answer until it retries, typically at least 1 second later - longer if you have more than one nameserver listed.  Worse, if the nameserver to which the glueless referral points is itself under another glueless referral, another retry will be required.</p><p>Even for better resolvers than BIND 8, long chains of glueless referrals can cause performance and reliability problems, turning a simple two or three query exchange into something needing more than a dozen queries.</p><p>Even worse, one might accidentally create a set of circularly glueless referrals such as</p><p><strong>example.com NS ns0.example.net.uk</strong></p><p><strong>example.com NS ns1.example.net.uk</strong></p><p><strong>example.net.uk NS ns0.example.com</strong></p><p><strong>example.net.uk NS ns1.example.com</strong></p><p>Here it is impossible to look up anything in either example.com or example.net.uk.</p><p>There are, as far as the author is aware, no generally agreed conventions or standards for avoiding unreasonably long glueless chains, or even circular glueless situations.  The only way to guarantee that things will work properly is therefore to always supply glue.</p><p>However, the situation is further complicated by the fact that many implementations (including BIND 8.2.3, and many registry systems), will refuse to accept glue RRs for delegations in a parent zonefile unless they are under the parent's zone apex.  In these cases it can be necessary to create names for the child's nameservers which are underneath the child's apex, so that the glue records are both in the parent's bailiwick and obviously necessary.</p><p>In the past, the `shared registry system' managing .com, .net and .org did not allow a single IPv4 address to be used for more than one nameserver name.  However, at the time of writing (October 2002) this problem seems to have been fixed, and the workaround I previously recommended (creating a single name for your nameserver somewhere in .com, .net or .org, and using that for all the delegations from .com, .net and .org) should now be avoided.</p><p>Finally, a note about `reverse' zones, such as those in in-addr.arpa: It does not seem at all common practice to create nameservers in in-addr.arpa zones (ie, no NS RRs seem to point into in-addr.arpa, even those for in-addr.arpa zones).  Current practice seems to be to always use nameservers for in-addr.arpa which are in the normal, forward, address space.  If everyone sticks to the rule of always publishing nameservers names in the `main' part of the namespace, and publishing glue for them, there is no chance of anything longer than a 1-step glueless chain might occur for a in-addr.arpa zone.  It is probably best to maintain this as the status quo, despite the performance problem this implies for BIND 8 caches.  This is what the serverless-glueless directive is for.</p><p>Dan Bernstein has some information and examples about this at</p><p>http://cr.yp.to/djbdns/notes.html#gluelessness</p><p>but be warned that it is rather opinionated.</p><h3>GLUELESSNESS SUMMARY</h3>
<p>I recommend that every nameserver should have its own name in every forward zone that it serves.  For example:</p><p><strong>zone.example.com NS servus.ns.example.com</strong></p><p><strong>servus.ns.example.com A 127.0.0.2</strong></p><p><strong>2.0.0.127.in-addr.arpa PTR servus.example.net</strong></p><p><strong>servus.example.net A 127.0.0.2</strong></p><p>Domain names in <strong>in-addr.arpa</strong> should not be used in the right hand side of NS records.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SECURITY</h2>
        <div class="sectioncontent">
<p>chiark-named-conf is supposed to be resistant to malicious data in the DNS.  It is not resistant to malicious data in its own options, configuration file or environment.  It is not supposed to read its stdin, but is not guaranteed to be safe if stdin is dangerous.</p><p>Killing chiark-named-conf suddenly should be safe, even with <strong>-y</strong> or <strong>-f</strong> (though of course it may not complete its task if killed), provided that only one invocation is made at once.</p><p>Slow remote nameservers will cause chiark-named-conf to take excessively long.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>0</strong></p>
  </dt>
  <dd>
    <p>All went well and there were no warnings.</p>
  </dd>
  <dt>
    <p>any other</p>
  </dt>
  <dd>
    <p>There were warnings or errors.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>/etc/bind/chiark-conf-gen.zones</strong></p>
  </dt>
  <dd>
    <p>Default input configuration file.  (Override with <strong>-C</strong>.)</p>
  </dd>
  <dt>
    <p><strong>/etc/bind</strong></p>
  </dt>
  <dd>
    <p>Default directory.  (Override with <strong>-C</strong> or <strong>default-dir</strong>.)</p>
  </dd>
  <dt>
    <p><em>dir</em><strong>/chiark-conf-gen.bind8</strong></p>
  </dt>
  <dd>
    <p>Default output file.</p>
  </dd>
  <dt>
    <p><strong>/var/cache/bind/chiark-slave</strong></p>
  </dt>
  <dd>
    <p>Default location for slave zones.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">
<p>Setting variables used by <a href="../man1/dig.1.html"><strong>dig</strong>(1)</a> and <strong>adnshost</strong>(1) will affect the operation of chiark-named-conf. Avoid messing with these if possible.</p><p><strong>PATH</strong> is used to find subprograms such as <strong>dig</strong> and <strong>adnshost</strong>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>The determination of the parent zone for each zone to be checked, and its nameservers, is done simply using the system default nameserver.</p><p>The processing of output from <strong>dig</strong> is not very reliable or robust, but this is mainly the fault of dig. This can lead to somewhat unhelpful error reporting for lookup failures.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p><strong>chiark-named-conf</strong> and this manpage were written by Ian Jackson &lt;ian@chiark.greenend.org.uk&gt;.  They are Copyright 2002 Ian Jackson.</p><p>chiark-named-conf and this manpage are free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2, or (at your option) any later version.</p><p>This is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.</p><p>You should have received a copy of the GNU General Public License along with this program; if not, consult the Free Software Foundation's website at www.fsf.org, or the GNU Project website at www.gnu.org.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="chgpasswd.8.html"><span aria-hidden="true">&larr;</span> chgpasswd.8: Update group passwords in batch mode</a></li>
   <li class="next"><a href="chkcon.8.html">chkcon.8: Determine if a security context is valid for a given binary policy <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
