<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>watchquagga: A program to monitor the status of quagga daemons</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A program to monitor the status of quagga daemons">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="watchquagga (8) manual">
  <meta name="twitter:description" content="A program to monitor the status of quagga daemons">
  <meta name="twitter:image" content="https://www.carta.tech/images/quagga-watchquagga-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/watchquagga.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="watchquagga (8) manual" />
  <meta property="og:description" content="A program to monitor the status of quagga daemons" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/quagga-watchquagga-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">watchquagga<small> (8)</small></h1>
        <p class="lead">A program to monitor the status of quagga daemons</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/watchquagga.8.html">
      <span itemprop="name">watchquagga: A program to monitor the status of quagga daemons</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/quagga/">
      <span itemprop="name">quagga</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/watchquagga.8.html">
      <span itemprop="name">watchquagga: A program to monitor the status of quagga daemons</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>watchquagga</strong> [<em>option</em>...] <em>daemon</em>...</p><p><strong>watchquagga</strong> <strong>-h</strong> | <strong>-v</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>watchquagga</strong> is a watchdog program that monitors the status of supplied quagga <em>daemon</em>s and tries to restart them in case they become unresponsive or shut down.</p><p>To determine whether a daemon is running, it tries to connect to the daemon's VTY UNIX stream socket, and send echo commands to ensure the daemon responds. When the daemon crashes, EOF is received from the socket, so that watchquagga can react immediately.</p><p>This program can run in one of the following 5 modes:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>Mode 0: monitor</strong></p>
  </dt>
  <dd>
    <p>In this mode, the program serves as a monitor and reports status changes.</p><ul>
<li><p>Example usage: watchquagga -d zebra ospfd bgpd</p></li>
</ul>
  </dd>
  <dt>
    <p><strong>Mode 1: global restart</strong></p>
  </dt>
  <dd>
    <p>In this mode, whenever a daemon hangs or crashes, the given command is used to restart all watched daemons.</p><ul>
<li><p>Example usage: watchquagga -dz &#92;</p><p>-R '/sbin/service zebra restart; /sbin/service ospfd restart' &#92;</p><p>zebra ospfd</p></li>
</ul>
  </dd>
  <dt>
    <p><strong>Mode 2: individual daemon restart</strong></p>
  </dt>
  <dd>
    <p>In this mode, whenever a single daemon hangs or crashes, the given command is used to restart this daemon only.</p><ul>
<li><p>Example usage: watchquagga -dz -r '/sbin/service %s restart' &#92;</p><p>zebra ospfd bgpd</p></li>
</ul>
  </dd>
  <dt>
    <p><strong>Mode 3: phased zebra restart</strong></p>
  </dt>
  <dd>
    <p>In this mode, whenever a single daemon hangs or crashes, the given command is used to restart this daemon only. The only exception is the zebra daemon; in this case, the following steps are taken: (1) all other daemons are stopped, (2) zebra is restarted, and (3) other daemons are started again.</p><ul>
<li><p>Example usage: watchquagga -adz -r '/sbin/service %s restart' &#92;</p><p>-s '/sbin/service %s start' &#92;</p><p>-k '/sbin/service %s stop' zebra ospfd bgpd</p></li>
</ul>
  </dd>
  <dt>
    <p><strong>Mode 4: phased global restart for any failure</strong></p>
  </dt>
  <dd>
    <p>In this mode, whenever a single daemon hangs or crashes, the following steps are taken: (1) all other daemons are stopped, (2) zebra is restarted, and (3) other daemons are started again.</p><ul>
<li><p>Example usage: watchquagga -Adz -r '/sbin/service %s restart' &#92;</p><p>-s '/sbin/service %s start' &#92;</p><p>-k '/sbin/service %s stop' zebra ospfd bgpd</p></li>
</ul>
  </dd>

</dl>
<p>Important: It is believed that mode 2 (individual daemon restart) is not safe, and mode 3 (phased zebra restart) may not be safe with certain routing daemons.</p><p>In order to avoid restarting the daemons in quick succession, you can supply the <strong>-m</strong> and <strong>-M</strong> options to set the minimum and maximum delay between the restart commands. The minimum restart delay is recalculated each time a restart is attempted. If the time since the last restart attempt exceeds twice the value of <strong>-M</strong>, the restart delay is set to the value of <strong>-m</strong>, otherwise the interval is doubled (but capped at the value of <strong>-M</strong>).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>-d</strong>, <strong>--daemon</strong></p>
  </dt>
  <dd>
    <p>Run in daemon mode. When supplied, error messages are sent to Syslog instead of standard output (stdout).</p>
  </dd>
  <dt>
    <p><strong>-S</strong><em> directory</em><strong></strong>, <strong>--statedir </strong><em>directory</em></p>
  </dt>
  <dd>
    <p>Set the VTY socket <em>directory</em> (the default value is "/var/run/quagga").</p>
  </dd>
  <dt>
    <p><strong>-e</strong>, <strong>--no-echo</strong></p>
  </dt>
  <dd>
    <p>Do not ping the daemons to test whether they respond. This option is necessary if one or more daemons do not support the echo command.</p>
  </dd>
  <dt>
    <p><strong>-l</strong><em> level</em><strong></strong>, <strong>--loglevel </strong><em>level</em></p>
  </dt>
  <dd>
    <p>Set the logging <em>level</em> (the default value is "6"). The value should range from 0 (LOG_EMERG) to 7 (LOG_DEBUG), but higher number can be supplied if extra debugging messages are required.</p>
  </dd>
  <dt>
    <p><strong>-m</strong><em> number</em><strong></strong>, <strong>--min-restart-interval </strong><em>number</em></p>
  </dt>
  <dd>
    <p>Set the minimum <em>number</em> of seconds to wait between invocations of the daemon restart commands (the default value is "60").</p>
  </dd>
  <dt>
    <p><strong>-M</strong><em> number</em><strong></strong>, <strong>--max-restart-interval </strong><em>number</em></p>
  </dt>
  <dd>
    <p>Set the maximum <em>number</em> of seconds to wait between invocations of the daemon restart commands (the default value is "600").</p>
  </dd>
  <dt>
    <p><strong>-i</strong><em> number</em><strong></strong>, <strong>--interval </strong><em>number</em></p>
  </dt>
  <dd>
    <p>Set the status polling interval in seconds (the default value is "5").</p>
  </dd>
  <dt>
    <p><strong>-t</strong><em> number</em><strong></strong>, <strong>--timeout </strong><em>number</em></p>
  </dt>
  <dd>
    <p>Set the unresponsiveness timeout in seconds (the default value is "10").</p>
  </dd>
  <dt>
    <p><strong>-T</strong><em> number</em><strong></strong>, <strong>--restart-timeout </strong><em>number</em></p>
  </dt>
  <dd>
    <p>Set the restart (kill) timeout in seconds (the default value is "20"). If any background jobs are still running after this period has elapsed, they will be killed.</p>
  </dd>
  <dt>
    <p><strong>-r</strong><em> command</em><strong></strong>, <strong>--restart </strong><em>command</em></p>
  </dt>
  <dd>
    <p>Supply a Bourne shell <em>command</em> to restart a single daemon. The command string should contain the '%s' placeholder to be substituted with the daemon name.</p><ul>
<li><p>Note that <strong>-r</strong> and <strong>-R</strong> options are not compatible.</p></li>
</ul>
  </dd>
  <dt>
    <p><strong>-s</strong><em> command</em><strong></strong>, <strong>--start-command </strong><em>command</em></p>
  </dt>
  <dd>
    <p>Supply a Bourne shell <em>command</em> to start a single daemon. The command string should contain the '%s' placeholder to be substituted with the daemon name.</p>
  </dd>
  <dt>
    <p><strong>-k</strong><em> command</em><strong></strong>, <strong>--kill-command </strong><em>command</em></p>
  </dt>
  <dd>
    <p>Supply a Bourne shell <em>command</em> to stop a single daemon. The command string should contain the '%s' placeholder to be substituted with the daemon name.</p>
  </dd>
  <dt>
    <p><strong>-R</strong>, <strong>--restart-all</strong></p>
  </dt>
  <dd>
    <p>When one or more daemons are shut down, try to restart them using the Bourne shell command supplied on the command line.</p><ul>
<li><p>Note that <strong>-r</strong> and <strong>-R</strong> options are not compatible.</p></li>
</ul>
  </dd>
  <dt>
    <p><strong>-z</strong>, <strong>--unresponsive-restart</strong></p>
  </dt>
  <dd>
    <p>When a daemon is in an unresponsive state, treat it as being shut down for the restart purposes.</p>
  </dd>
  <dt>
    <p><strong>-a</strong>, <strong>--all-restart</strong></p>
  </dt>
  <dd>
    <p>When zebra hangs or crashes, restart all daemons taking the following steps: (1) stop all other daemons, (2) restart zebra, and (3) start other daemons again.</p><ul>
<li><p>Note that this option also requires <strong>-r</strong>, <strong>-s</strong>, and <strong>-k</strong> options to be specified.</p></li>
</ul>
  </dd>
  <dt>
    <p><strong>-A</strong>, <strong>--always-all-restart</strong></p>
  </dt>
  <dd>
    <p>When any daemon (i.e., not just zebra) hangs or crashes, restart all daemons taking the following steps: (1) stop all other daemons, (2) restart zebra, and (3) start other daemons again.</p><ul>
<li><p>Note that this option also requires <strong>-r</strong>, <strong>-s</strong>, and <strong>-k</strong> options to be specified.</p></li>
</ul>
  </dd>
  <dt>
    <p><strong>-p</strong><em> filename</em><strong></strong>, <strong>--pid-file </strong><em>filename</em></p>
  </dt>
  <dd>
    <p>Set the process identifier <em>filename</em> (the default value is "/var/run/quagga/watchquagga.pid").</p>
  </dd>
  <dt>
    <p><strong>-b</strong><em> string</em><strong></strong>, <strong>--blank-string </strong><em>string</em></p>
  </dt>
  <dd>
    <p>When the supplied <em>string</em> is found in any of the command line option arguments (i.e., <strong>-r</strong>, <strong>-s</strong>, <strong>-k</strong>, or <strong>-R</strong>), replace it with a space.</p><ul>
<li><p>This is an ugly hack to circumvent problems with passing the command line arguments containing embedded spaces.</p></li>
</ul>
  </dd>
  <dt>
    <p><strong>-v</strong>, <strong>--version</strong></p>
  </dt>
  <dd>
    <p>Display the version information and exit.</p>
  </dd>
  <dt>
    <p><strong>-h</strong>, <strong>--help</strong></p>
  </dt>
  <dd>
    <p>Display the usage information and exit.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO watchquagga&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/zebra.8.html"><strong>zebra</strong>(8)</a>, <a href="../man8/bgpd.8.html"><strong>bgpd</strong>(8)</a>, <a href="../man8/isisd.8.html"><strong>isisd</strong>(8)</a>, <a href="../man8/ospfd.8.html"><strong>ospfd</strong>(8)</a>, <a href="../man8/ospf6d.8.html"><strong>ospf6d</strong>(8)</a>, <a href="../man8/ripd.8.html"><strong>ripd</strong>(8)</a>, <a href="../man8/ripngd.8.html"><strong>ripngd</strong>(8)</a></p><p>See the project homepage at &lt;http://www.quagga.net/&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Copyright 2004 Andrew J. Schorr</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="watchdog.8.html"><span aria-hidden="true">&larr;</span> watchdog.8: A software watchdog daemon</a></li>
   <li class="next"><a href="wd_identify.8.html">wd_identify.8: A simplified software watchdog daemon <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
