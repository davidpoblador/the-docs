<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ibportstate: Handle port (physical) state and link speed of an infiniband port</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Handle port (physical) state and link speed of an infiniband port">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="ibportstate (8) manual">
  <meta name="twitter:description" content="Handle port (physical) state and link speed of an infiniband port">
  <meta name="twitter:image" content="https://www.carta.tech/images/infiniband-diags-ibportstate-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/ibportstate.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ibportstate (8) manual" />
  <meta property="og:description" content="Handle port (physical) state and link speed of an infiniband port" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/infiniband-diags-ibportstate-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">ibportstate<small> (8)</small></h1>
        <p class="lead">Handle port (physical) state and link speed of an infiniband port</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/ibportstate.8.html">
      <span itemprop="name">ibportstate: Handle port (physical) state and link speed of an infiniband port</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/infiniband-diags/">
      <span itemprop="name">infiniband-diags</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/ibportstate.8.html">
      <span itemprop="name">ibportstate: Handle port (physical) state and link speed of an infiniband port</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>ibportstate [options] &lt;dest dr_path|lid|guid&gt; &lt;portnum&gt; [&lt;op&gt;]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>ibportstate allows the port state and port physical state of an IB port to be queried (in addition to link width and speed being validated relative to the peer port when the port queried is a switch port), or a switch port to be disabled, enabled, or reset. It also allows the link speed/width enabled on any IB port to be adjusted.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong></strong><strong>&lt;op&gt;</strong><strong></strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>Supported ops: enable, disable, reset, speed, espeed, fdr10, width, query,</strong></p>
  </dt>
  <dd>
    <p>on, off, down, arm, active, vls, mtu, lid, smlid, lmc, mkey, mkeylease, mkeyprot (Default is query)</p>
  </dd>

</dl>
<p><strong>enable, disable, and reset</strong> are only allowed on switch ports (An error is indicated if attempted on CA or router ports)</p><p><strong>off</strong> change the port state to disable.</p><p><strong>on</strong> change the port state to enable(only when the current state is disable).</p><p><strong>speed and width</strong> are allowed on any port</p><p><strong>speed</strong> values are the legal values for PortInfo:LinkSpeedEnabled (An error is indicated if PortInfo:LinkSpeedSupported does not support this setting)</p><p><strong>espeed</strong> is allowed on any port supporting extended link speeds</p><p><strong>fdr10</strong> is allowed on any port supporting fdr10 (An error is indicated if port&apos;s capability mask indicates extended link speeds are not supported or if PortInfo:LinkSpeedExtSupported does not support this setting)</p><p><strong>width</strong> values are legal values for PortInfo:LinkWidthEnabled (An error is indicated if PortInfo:LinkWidthSupported does not support this setting) (NOTE: Speed and width changes are not effected until the port goes through link renegotiation)</p><p><strong>query</strong> also validates port characteristics (link width, speed, espeed, and fdr10) based on the peer port. This checking is done when the port queried is a switch port as it relies on combined routing (an initial LID route with directed routing to the peer) which can only be done on a switch. This peer port validation feature of query op requires LID routing to be functioning in the subnet.</p><p><strong>mkey, mkeylease, and mkeyprot</strong> are only allowed on CAs, routers, or switch port 0 (An error is generated if attempted on external switch ports).  Hexadecimal and octal mkeys may be specified by prepending the key with &apos;0x&apos; or &apos;0&apos;, respectively.  If a non-numeric value (like &apos;x&apos;) is specified for the mkey, then ibportstate will prompt for a value.</p><h3>Addressing Flags</h3>
<p><strong>-L, --Lid</strong>   The address specified is a LID</p><p><strong>-G, --Guid</strong>     The address specified is a Port GUID</p><p><strong>-D, --Direct</strong>     The address specified is a directed route</p>
<pre>
Examples:
   [options] -D [options] "0"          # self port
   [options] -D [options] "0,1,2,1,4"  # out via port 1, then 2, ...

   (Note the second number in the path specified must match the port being
   used.  This can be specified using the port selection flag &apos;-P&apos; or the
   port found through the automatic selection process.)
</pre>
<p><strong>-s, --sm_port &lt;smlid&gt;</strong>     use &apos;smlid&apos; as the target lid for SA queries.</p>
<h3>Port Selection flags</h3>
<p><strong>-C, --Ca &lt;ca_name&gt;</strong>    use the specified ca_name.</p><p><strong>-P, --Port &lt;ca_port&gt;</strong>    use the specified ca_port.</p>
<h3>Local port Selection</h3>
<p>Multiple port/Multiple CA support: when no IB device or port is specified (see the "local umad parameters" below), the libibumad library selects the port to use by the following criteria:</p>
<dl class='dl-vertical'>
  <dt>
    1.
  </dt>
  <dd>
    <p>the first port that is ACTIVE.</p>
  </dd>
  <dt>
    2.
  </dt>
  <dd>
    <p>if not found, the first port that is UP (physical link up).</p><p>If a port and/or CA name is specified, the libibumad library attempts to fulfill the user request, and will fail if it is not possible.</p><p>For example:</p>
<pre>
ibaddr                 # use the first port (criteria #1 above)
ibaddr -C mthca1       # pick the best port from "mthca1" only.
ibaddr -P 2            # use the second (active/up) port from the first available IB device.
ibaddr -C mthca0 -P 2  # use the specified port only.
</pre>

  </dd>

</dl>

<h3>Configuration flags</h3>
<p><strong>--config, -z  &lt;config_file&gt;</strong> Specify alternate config file. Default: /etc/infiniband-diags/ibdiag.conf</p><p><strong>-t, --timeout &lt;timeout_ms&gt;</strong> override the default timeout for the solicited mads.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong></strong><strong>-y, --m_key &lt;key&gt;</strong><strong></strong></p>
  </dt>
  <dd>
    <p>use the specified M_key for requests. If non-numeric value (like &apos;x&apos;) is specified then a value will be prompted for.</p>
  </dd>

</dl>

<h3>Debugging flags</h3>
<p><strong>-h, --help</strong>      show the usage message</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>-d</strong></p>
  </dt>
  <dd>
    <p>raise the IB debugging level. May be used several times (-ddd or -d -d -d).</p>
  </dd>
  <dt>
    <p><strong>-e</strong></p>
  </dt>
  <dd>
    <p>show send and receive errors (timeouts and others)</p>
  </dd>
  <dt>
    <p><strong></strong><strong>-K, --show_keys</strong><strong></strong></p>
  </dt>
  <dd>
    <p>show security keys (mkey, smkey, etc.) associated with the request.</p>
  </dd>
  <dt>
    <p><strong></strong><strong>-v, --verbose</strong><strong></strong></p>
  </dt>
  <dd>
    <p>increase the application verbosity level. May be used several times (-vv or -v -v -v)</p><p><strong>-V, --version</strong>     show the version info.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<h3>CONFIG FILE</h3>
<p>/etc/infiniband-diags/ibdiag.conf</p><p>A global config file is provided to set some of the common options for all tools.  See supplied config file for details.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>::</strong></p>
  </dt>
  <dd>
    <p>ibportstate 3 1 disable                  # by lid ibportstate -G 0x2C9000100D051 1 enable  # by guid ibportstate -D 0 1                       # (query) by direct route ibportstate 3 1 reset                    # by lid ibportstate 3 1 speed 1                  # by lid ibportstate 3 1 width 1                  # by lid ibportstate -D 0 1 lid 0x1234 arm        # by direct route</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>Hal Rosenstock</strong></p>
  </dt>
  <dd>
    <p>&lt; <em>hal.rosenstock@gmail.com</em> &gt;</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="ibping.8.html"><span aria-hidden="true">&larr;</span> ibping.8: Ping an infiniband address</a></li>
   <li class="next"><a href="ibqueryerrors.8.html">ibqueryerrors.8: Query and report ib port counters <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
