<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>exim_dumpdb: Exim's hint databases maintenance (exim_dumpdb, exim_fixdb, exim_tidydb)</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Exim's hint databases maintenance (exim_dumpdb, exim_fixdb, exim_tidydb)">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="exim_dumpdb (8) manual">
  <meta name="twitter:description" content="Exim's hint databases maintenance (exim_dumpdb, exim_fixdb, exim_tidydb)">
  <meta name="twitter:image" content="https://www.carta.tech/images/exim4-base-exim_dumpdb-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/exim_dumpdb.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="exim_dumpdb (8) manual" />
  <meta property="og:description" content="Exim's hint databases maintenance (exim_dumpdb, exim_fixdb, exim_tidydb)" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/exim4-base-exim_dumpdb-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">exim_dumpdb<small> (8)</small></h1>
        <p class="lead">Exim's hint databases maintenance (exim_dumpdb, exim_fixdb, exim_tidydb)</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/exim_dumpdb.8.html">
      <span itemprop="name">exim_dumpdb: Exim's hint databases maintenance (exim_dumpdb, exim_fixdb, exim_tidydb)</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/exim4-base/">
      <span itemprop="name">exim4-base</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/exim_dumpdb.8.html">
      <span itemprop="name">exim_dumpdb: Exim's hint databases maintenance (exim_dumpdb, exim_fixdb, exim_tidydb)</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>exim_dumpdb</strong> <em>spooldir database</em></p><p><strong>exim_fixdb</strong> <em>spooldir database</em></p><p><strong>exim_tidydb</strong> <em>[-f] [-t time] spooldir database</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Three utility programs are provided for maintaining the DBM files that Exim uses to contain its delivery hint information. Each program requires two arguments. The first specifies the name of Exim's spool directory, and the second is the name of the database it is to operate on. These are as follows:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>retry</strong></p>
  </dt>
  <dd>
    <p>the database of retry information</p>
  </dd>
  <dt>
    <p><strong>wait-&lt;transport name&gt;</strong></p>
  </dt>
  <dd>
    <p>databases of information about messages waiting for remote hosts</p>
  </dd>
  <dt>
    <p><strong>callout</strong></p>
  </dt>
  <dd>
    <p>the callout cache</p>
  </dd>
  <dt>
    <p><strong>ratelimit</strong></p>
  </dt>
  <dd>
    <p>the data for implementing the ratelimit ACL condition</p>
  </dd>
  <dt>
    <p><strong>misc</strong></p>
  </dt>
  <dd>
    <p>other hints data (for example, for serializing ETRN runs)</p>
  </dd>

</dl>
<p>The entire contents of a database are written to the standard output by the <strong>exim_dumpdb</strong> program, which has no options or arguments other than the spool and database names. For example, to dump the retry database:</p><p><em>exim_dumpdb /var/spool/exim4 retry</em></p><p>Two lines of output are produced for each entry:</p>
<pre>
    T:mail.ref.example:192.168.242.242 146 77 Connection refused
  31-Oct-1995 12:00:12  02-Nov-1995 12:21:39  02-Nov-1995 20:21:39 *

</pre>
<p>The first item on the first line is the key of the record. It starts with one of the letters R, or T, depending on whether it refers to a routing or transport retry. For a local delivery, the next part is the local address; for a remote delivery it is the name of the remote host, followed by its failing IP address (unless &ldquo;retry_include_ip_address&rdquo; is set false on the smtp transport). If the remote port is not the standard one (port 25), it is added to the IP address. Then there follows an error code, an additional error code, and a textual description of the error.</p><p>The three times on the second line are the time of first failure, the time of the last delivery attempt, and the computed time for the next attempt. The line ends with an asterisk if the cutoff time for the last retry rule has been exceeded.</p><p>Each output line from <strong>exim_dumpdb</strong> for the <em>wait-xxx</em> databases consists of a host name followed by a list of ids for messages that are or were waiting to be delivered to that host. If there are a very large number for any one host, continuation records, with a sequence number added to the host name, may be seen. The data in these records is often out of date, because a message may be routed to several alternative hosts, and Exim makes no effort to keep cross-references.</p><p>The <strong>exim_tidydb</strong> utility program is used to tidy up the contents of a hints database. If run with no options, it removes all records that are more than 30 days old.  The age is calculated from the date and time that the record was last updated.  Note that, in the case of the retry database, it is not the time since the first delivery failure. Information about a host that has been down for more than 30 days will remain in the database, provided that the record is updated sufficiently often.</p><p>The cutoff date can be altered by means of the -t option, which must be followed by a time. For example, to remove all records older than a week from the retry database:</p><p><em>exim_tidydb -t 7d /var/spool/exim4 retry</em></p><p>Both the <em>wait-xxx</em> and <em>retry</em> databases contain items that involve message ids. In the former these appear as data in records keyed by host - they were messages that were waiting for that host - and in the latter they are the keys for retry information for messages that have suffered certain types of error. When &ldquo;exim_tidydb&rdquo; is run, a check is made to ensure that message ids in database records are those of messages that are still on the queue. Message ids for messages that no longer exist are removed from &ldquo;wait-&rdquo;xxx records, and if this leaves any records empty, they are deleted. For the &ldquo;retry&rdquo; database, records whose keys are non-existent message ids are removed. The <strong>exim_tidydb</strong> utility outputs comments on the standard output whenever it removes information from the database.</p><p>Certain records are automatically removed by Exim when they are no longer needed, but others are not. For example, if all the MX hosts for a domain are down, a retry record is created for each one. If the primary MX host comes back first, its record is removed when Exim successfully delivers to it, but the records for the others remain because Exim has not tried to use those hosts.</p><p>It is important, therefore, to run &ldquo;exim_tidydb&rdquo; periodically on all the hints databases. You should do this at a quiet time of day, because it requires a database to be locked (and therefore inaccessible to Exim) while it does its work. Removing records from a DBM file does not normally make the file smaller, but all the common DBM libraries are able to re-use the space that is released. After an initial phase of increasing in size, the databases normally reach a point at which they no longer get any bigger, as long as they are regularly tidied.</p><p>Warning: If you never run &ldquo;exim_tidydb&rdquo;, the space used by the hints databases is likely to keep on increasing.</p><p>The <strong>exim_fixdb</strong> program is a utility for interactively modifying databases. Its main use is for testing Exim, but it might also be occasionally useful for getting round problems in a live system. It has no options, and its interface is somewhat crude. On entry, it prompts for input with a right angle-bracket. A key of a database record can then be entered, and the data for that record is displayed.</p><p>If \(oqd\(cq is typed at the next prompt, the entire record is deleted. For all except the <em>retry</em> database, that is the only operation that can be carried out. For the <em>retry</em> database, each field is output preceded by a number, and data for individual fields can be changed by typing the field number followed by new data, for example:</p>
<pre>
  &gt; 4 951102:1000
</pre>
<p>resets the time of the next delivery attempt. Time values are given as a sequence of digit pairs for year, month, day, hour, and minute. Colons can be used as optional separators.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>This manual page needs a major re-work. If somebody knows better groff than us and has more experience in writing manual pages, any patches would be greatly appreciated.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO exim_dumpdb&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/exim.8.html"><strong>exim</strong>(8)</a>, /usr/share/doc/exim4-base/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>This manual page was stitched together from spec.txt by Andreas Metzler &lt;ametzler at downhill.at.eu.org&gt;, for the Debian GNU/Linux system (but may be used by others).</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="exim_dbmbuild.8.html"><span aria-hidden="true">&larr;</span> exim_dbmbuild.8: Build a dbm file.</a></li>
   <li class="next"><a href="exim_fixdb.8.html">exim_fixdb.8: Exim's hint databases maintenance (exim_dumpdb, exim_fixdb, exim_tidydb) <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
