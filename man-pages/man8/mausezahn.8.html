<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>mausezahn - a fast versatile packet generator with Cisco-cli</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A fast versatile packet generator with cisco-cli">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">mausezahn<small> (8)</small></h1>
        <p class="lead">A fast versatile packet generator with cisco-cli</p>
      </div>

    <ol class="breadcrumb">
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="https://www.carta.tech/man-pages/"><span itemprop="title">Linux Man Pages</span></a>
	</li>
	<li id="breadcrumb_section" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_page" itemprop="child">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man8/"><span itemprop="title">System administration commands</span></a>
	</li>
	<li id="breadcrumb_page" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="active">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man8/mausezahn.8.html"><span itemprop="title">mausezahn</span></a>
	</li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p><strong>mausezahn</strong> { [<em>options</em>] "&lt;arg-string&gt; | &lt;hex-string&gt;" }</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>mausezahn is a fast traffic generator which allows you to send nearly every possible and impossible packet. In contrast to <a href="../man8/trafgen.8.html"><strong>trafgen</strong>(8)</a>, mausezahn's packet configuration is on a protocol-level instead of byte-level and mausezahn also comes with a built-in Cisco-like command-line interface, making it suitable as a network traffic generator box in your network lab.</p>
<p class='spacer'>

<p>Next to network labs, it can also be used as a didactical tool and for security audits including penetration and DoS testing. As a traffic generator, mausezahn is also able to test IP multicast or VoIP networks. Packet rates close to the physical limit are reachable, depending on the hardware platform.</p>
<p class='spacer'>

<p>mausezahn supports two modes, ''direct mode'' and a multi-threaded ''interactive mode''.</p>
<p class='spacer'>

<p>The ''direct mode'' allows you to create a packet directly on the command line and every packet parameter is specified in the argument list when calling mausezahn.</p>
<p class='spacer'>

<p>The ''interactive mode'' is an advanced multi-threaded configuration mode with its own command line interface (CLI). This mode allows you to create an arbitrary number of packet types and streams in parallel, each with different parameters.</p>
<p class='spacer'>

<p>The interactive mode utilizes a completely redesigned and more flexible protocol framework called ''mops'' (mausezahn's own packet system). The look and feel of the CLI is very close to the Cisco IOS^tm command line interface.</p>
<p class='spacer'>

<p>You can start the interactive mode by executing mausezahn with the ''-x'' argument (an optional port number may follow, otherwise it is 25542). Then use <strong>telnet</strong>(1) to connect to this mausezahn instance. If not otherwise specified, the default login and password combination is mz:mz and the enable password is: mops. This can be changed in /etc/netsniff-ng/mausezahn.conf.</p>
<p class='spacer'>

<p>The direct mode supports two specification schemes: The ''raw-layer-2'' scheme, where every single byte to be sent can be specified, and ''higher-layer'' scheme, where packet builder interfaces are used (using the ''-t'' option).</p>
<p class='spacer'>

<p>To use the ''raw-layer-2'' scheme, simply specify the desired frame as a hexadecimal sequence (the ''hex-string''), such as:</p>
<p class='spacer'>

<pre>  mausezahn eth0 "00:ab:cd:ef:00 00:00:00:00:00:01 08:00 ca:fe:ba:be"</pre>

<p class='spacer'>

<p>In this example, whitespaces within the byte string are optional and separate the Ethernet fields (destination and source address, type field, and a short payload). The only additional options supported are ''-a'', ''-b'', ''-c'', and ''-p''. The frame length must be greater than or equal to 15 bytes.</p>
<p class='spacer'>

<p>The ''higher-layer'' scheme is enabled using the ''-t &lt;packet-type&gt;'' option. This option activates a packet builder, and besides the ''packet-type'', an optional ''arg-string'' can be specified. The ''arg-string'' contains packet- specific parameters, such as TCP flags, port numbers, etc. (see example section).</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>mausezahn provides a built-in context-specific help. Append the keyword</p>
<pre> ''help'' after the configuration options. The most important options</pre>

<p>are:</p>
<p class='spacer'>

  <h3>-x [&lt;port&gt;]</h3>
<p>Start mausezahn in interactive mode with a Cisco-like CLI. Use telnet to log into the local mausezahn instance. If no port has been specified, port 25542 is used by default.</p>
<p class='spacer'>

  <h3>-l &lt;IP&gt;</h3>
<p>Specify the IP address mausezahn should bind to when in interactive mode, default: 0.0.0.0.</p>
<p class='spacer'>

  <h3>-v</h3>
<p>Verbose mode. Capital -V is even more verbose.</p>
<p class='spacer'>

  <h3>-S</h3>
<p>Simulation mode, i.e. don't put anything on the wire. This is typically combined with the verbose mode.</p>
<p class='spacer'>

  <h3>-q</h3>
<p>Quiet mode where only warnings and errors are displayed.</p>
<p class='spacer'>

  <h3>-c &lt;count&gt;</h3>
<p>Send the packet count times (default: 1, infinite: 0).</p>
<p class='spacer'>

  <h3>-d &lt;delay&gt;</h3>
<p>Apply delay between transmissions. The delay value can be specified in usec (default, no additional unit needed), or in msec (e.g. 100m or 100msec), or in seconds (e.g. 100s or 100sec). Note: mops also supports nanosecond delay resolution if you need it (see interactive mode).</p>
<p class='spacer'>

  <h3>-p &lt;length&gt;</h3>
<p>Pad the raw frame to specified length using zero bytes. Note that for raw layer 2 frames the specified length defines the whole frame length, while for higher layer packets the number of additional padding bytes are specified.</p>
<p class='spacer'>

  <h3>-a &lt;src-mac|keyword&gt;</h3>
<p>Use specified source MAC address with hexadecimal notation such as 00:00:aa:bb:cc:dd. By default the interface MAC address will be used. The keywords ''rand'' and</p>
<pre> ''own'' refer to a random MAC address (only unicast addresses are created)</pre>

<p>and the own address, respectively. You can also use the keywords mentioned below although broadcast-type source addresses are officially invalid.</p>
<p class='spacer'>

  <h3>-b &lt;dst-mac|keyword&gt;</h3>
<p>Use specified destination MAC address. By default, a broadcast is sent in raw layer 2 mode or to the destination hosts or gateway interface MAC address in normal (IP) mode. You can use the same keywords as mentioned above, as well as</p>
<pre> ''bc'' or ''bcast'', ''cisco'', and ''stp''. Please note that for the destination</pre>

<p>MAC address the ''rand'' keyword is supported but creates a random address only once, even when you send multiple packets.</p>
<p class='spacer'>

  <h3>-A &lt;src-ip|range|rand&gt;</h3>
<p>Use specified source IP address, default is own interface address. Optionally, the keyword ''rand'' can again be used for a random source IP address or a range can be specified, such as ''192.168.1.1-192.168.1.100'' or ''10.1.0.0/16''. Also, a DNS name can be specified for which mausezahn tries to determine the corresponding IP address automatically.</p>
<p class='spacer'>

  <h3>-B &lt;dst-ip|range&gt;</h3>
<p>Use specified destination IP address (default is broadcast i.e. 255.255.255.255). As with the source address (see above) you can also specify a range or a DNS name.</p>
<p class='spacer'>

  <h3>-t &lt;packet-type [help] | help&gt;</h3>
<p>Create the specified packet type using the built-in packet builder. Currently, supported packet types are: ''arp'', ''bpdu'', ''ip'', ''udp'', ''tcp'', ''rtp'', and ''dns''. Currently, there is also limited support for ''icmp''. Type</p>
<pre> ''-t help'' to verify which packet builders your actual mausezahn version</pre>

<p>supports. Also, for any particular packet type, for example ''tcp'' type</p>
<pre> ''mausezahn -t tcp help'' to receive a more in-depth context specific help.</pre>

<p class='spacer'>

  <h3>-T &lt;packet-type&gt;</h3>
<p>Make this mausezahn instance the receiving station. Currently, only ''rtp'' is an option here and provides precise jitter measurements. For this purpose, start another mausezahn instance on the sending station and the local receiving station will output jitter statistics. See ''mausezahn -T rtp help'' for a detailed help.</p>
<p class='spacer'>

  <h3>-Q &lt;[CoS:]vlan&gt; [, &lt;[CoS:]vlan&gt;, ...]</h3>
<p>Specify 802.1Q VLAN tag and optional Class of Service. An arbitrary number of VLAN tags can be specified (that is, you can simulate QinQ or even QinQinQinQ..). Multiple tags must be separated via a comma or a period (e.g. "5:10,20,2:30"). VLAN tags are not supported for ARP and BPDU packets (in which case you could specify the whole frame in hexadecimal using the raw layer 2 interface of mausezahn).</p>
<p class='spacer'>

  <h3>-M &lt;label[:cos[:ttl]][bos]&gt; [, &lt;label...&gt;]</h3>
<p>Specify a MPLS label or even a MPLS label stack. Optionally, for each label the experimental bits (usually the Class of Service, CoS) and the Time To Live (TTL) can be specified. If you are really crazy you can set and unset the Bottom of Stack (BoS) bit for each label using the ''S'' (set) and ''s'' (unset) option. By default, the BoS is set automatically and correctly. Any other setting will lead to invalid frames. Enter ''-M help'' for detailed instructions and examples.</p>
<p class='spacer'>

  <h3>-P &lt;ascii-payload&gt;</h3>
<p>Specify a cleartext payload. Alternatively, each packet type supports a hexadecimal specification of the payload (see for example ''-t udp help'').</p>
<p class='spacer'>

  <h3>-f &lt;filename&gt;</h3>
<p>Read the ASCII payload from the specified file.</p>
<p class='spacer'>

  <h3>-F &lt;filename&gt;</h3>
<p>Read the hexadecimal payload from the specified file. Actually, this file must be also an ASCII text file, but must contain hexadecimal digits, e.g. "aa:bb:cc:0f:e6...". You can use also spaces as separation characters.</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE EXAMPLE</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>For more comprehensive examples, have a look at the two following HOWTO sections.</p>
<p class='spacer'>

  <h3>mausezahn eth0 -c 0 -d 2s -t bpdu vlan=5</h3>
<p>Send BPDU frames for VLAN 5 as used with Cisco's PVST+ type of STP. By default mausezahn assumes that you want to become the root bridge.</p>
<p class='spacer'>

  <h3>mausezahn eth0 -c 128000 -a rand -p 64</h3>
<p>Perform a CAM table overflow attack.</p>
<p class='spacer'>

  <h3>mausezahn eth0 -c 0 -Q 5,100 -t tcp flags=syn,dp=1-1023 -p 20 -A rand -B 10.100.100.0/24</h3>
<p>Perform a SYN flood attack to another VLAN using VLAN hopping. This only works if you are connected to the same VLAN which is configured as native VLAN on the trunk. We assume that the victim VLAN is VLAN 100 and the native VLAN is VLAN 5. Lets attack every host in VLAN 100 which use an IP prefix of 10.100.100.0/24, also try out all ports between 1 and 1023 and use a random source IP address.</p>
<p class='spacer'>

  <h3>mausezahn eth0 -c 0 -d 10msec -B 230.1.1.1 -t udp dp=32000,dscp=46 -P Multicast test packet</h3>
<p>Send IP multicast packets to the multicast group 230.1.1.1 using a UDP header with destination port 32000 and set the IP DSCP field to EF (46). Send one frame every 10 msec.</p>
<p class='spacer'>

  <h3>mausezahn eth0 -Q 6:420 -M 100,200,300:5 -A 172.30.0.0/16 -B target.anynetwork.foo -t udp sp=666,dp=1-65535 -p 1000 -c 10</h3>
<p>Send UDP packets to the destination host target.anynetwork.foo using all possible destination ports and send every packet with all possible source addresses of the range 172.30.0.0/16; additionally use a source port of 666 and three MPLS labels, 100, 200, and 300, the outer (300) with QoS field 5. Send the frame with a VLAN tag 420 and CoS 6; eventually pad with 1000 bytes and repeat the whole thing 10 times.</p>
<p class='spacer'>

  <h3>mausezahn -t syslog sev=3 -P Main reactor reached critical temperature. -A 192.168.33.42 -B 10.1.1.9 -c 6 -d 10s</h3>
<p>Send six forged syslog messages with severity 3 to a Syslog server 10.1.1.9; use a forged source IP address 192.168.33.42 and let mausezahn decide which local interface to use. Use an inter-packet delay of 10 seconds.</p>
<p class='spacer'>

  <h3>mausezahn -t tcp flags=syn|urg|rst, sp=145, dp=145, win=0, s=0-4294967295, ds=1500, urg=666 -a bcast -b bcast -A bcast -B 10.1.1.6 -p 5</h3>
<p>Send an invalid TCP packet with only a 5 byte payload as layer-2 broadcast and also use the broadcast MAC address as source address. The target should be 10.1.1.6 but use a broadcast source address. The source and destination port shall be 145 and the window size 0. Set the TCP flags SYN, URG, and RST simultaneously and sweep through the whole TCP sequence number space with an increment of 1500. Finally set the urgent pointer to 666, i.e. pointing to nowhere.</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION FILE</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>When mausezahn is run in interactive mode it automatically looks for and reads a configuration file located at /etc/netsniff-ng/mausezahn.conf for custom options if the file is available, otherwise it uses defaults set at compile time.</p>
  <h3>Config file: /etc/netsniff-ng/mausezahn.conf</h3>
<p class='spacer'>

<p>The configuration file contains lines of the form:</p>
<p class='spacer'>

<p>	option = value</p>
<p class='spacer'>

<p>Options supported in the configuration file are:</p>
<pre>   Option: 	 	Description:</pre>

<p class='spacer'>

<pre>   user			Username for authentication (default: mz)
   password		Password for authentication (default: mz)
   enable		     Password to enter privilege mode (default: mops)
   port			The listening port for the CLI (default: 25542)
   listen-addr		IP address to bind CLI to (default: 0.0.0.0)
   management-only	Set management interface (no data traffic is allowed to pass through)
   cli-device		Interface to bind CLI to (default: all) *not fully implemented*
   automops         Path to automops file (contains XML data describing protocols) *in development*</pre>

<p class='spacer'>

  <h3>Example:</h3>
<p class='spacer'>

<pre> $ cat /etc/netsniff-ng/mausezahn.conf
 user = mzadmin
 password = mzpasswd
 enable = privilege-mode-passwd
 port = 65000
 listen-addr = 127.0.0.1</pre>

<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INTERACTIVE MODE HOWTO</h2>
        <div class="sectioncontent">

<p class='spacer'>

  <h3>Telnet:</h3>
<p class='spacer'>

<p>Using the interactive mode requires starting mausezahn as a server:</p>
<p class='spacer'>

<pre>  # mausezahn -x</pre>

<p class='spacer'>

<p>Now you can <strong>telnet</strong>(1) to that server using the default port number 25542, but also an arbitrary port number can be specified:</p>
<p class='spacer'>

<pre>  # mausezahn -x 99
  mausezahn accepts incoming telnet connections on port 99.
  mz: Problems opening config file. Will use defaults</pre>

<p class='spacer'>

<p class='spacer'>

<p>Either from another terminal or from another host try to telnet to the mausezahn server:</p>
<p class='spacer'>

<pre>  caprica$ telnet galactica 99
  Trying 192.168.0.4...
  Connected to galactica.
  Escape character is '^]'.
  mausezahn &lt;version&gt;</pre>

<p class='spacer'>

<pre>  Username: mz
  Password: mz</pre>

<p class='spacer'>

<pre>  mz&gt; enable
  Password: mops
  mz#</pre>

<p class='spacer'>

<p>It is recommended to configure your own login credentials in /etc/netsniff-ng/mausezahn.conf, (see configuration file section)</p>
  <h3>Basics:</h3>
<p class='spacer'>

<p>Since you reached the mausezahn prompt, lets try some common commands. You can use the '?' character at any time for context-specific help. Note that Cisco-like short form of commands are accepted in interactive mode. For example, one can use "sh pac" instead of "show packet"; another common example is to use "config t" in place of "configure terminal". For readability, this manual will continue with the full commands.</p>
<p class='spacer'>

<p>First try out the show command:</p>
<p class='spacer'>

<pre>  mz# show ?</pre>

<p class='spacer'>

<p>mausezahn maintains its own ARP table and observes anomalies. There is an entry for every physical interface (however this host has only one):</p>
<p class='spacer'>

<pre>  mz# show arp
  Intf    Index     IP address     MAC address       last       Ch  UCast BCast Info
  ----------------------------------------------------------------------------------
  eth0    [1] D     192.168.0.1  00:09:5b:9a:15:84  23:44:41     1     1     0  0000</pre>

<p class='spacer'>

<p>The column Ch tells us that the announced MAC address has only changed one time (= when it was learned). The columns Ucast and BCast tell us how often this entry was announced via unicast or broadcast respectively.</p>
<p class='spacer'>

<p>Let's check our interfaces:</p>
<p class='spacer'>

<pre>  mz# show interface
  Available network interfaces:
                 real             real                  used (fake)      used (fake)
   device        IPv4 address     MAC address           IPv4 address     MAC address
  ---------------------------------------------------------------------------------------
  &gt; eth0         192.168.0.4      00:30:05:76:2e:8d     192.168.0.4      00:30:05:76:2e:8d
    lo           127.0.0.1        00:00:00:00:00:00     127.0.0.1        00:00:00:00:00:00
  2 interfaces found.
  Default interface is eth0.</pre>

<p class='spacer'>

  <h3>Defining packets:</h3>
<p class='spacer'>

<p>Let's check the current packet list:</p>
<p class='spacer'>

<pre>  mz# show packet
  Packet layer flags: E=Ethernet, S=SNAP, Q=802.1Q, M=MPLS, I/i=IP/delivery_off, U=UDP, T=TCP
  PktID  PktName           Layers  Proto    Size  State      Device      Delay       Count/CntX
      1  sysARP_servic...  E-----  ARP        60  config     lo          100 msec        1/0 (100%)
  1 packets defined, 0 active.</pre>

<p class='spacer'>

<p>We notice that there is already one system-defined packet process; it has been created and used only once (during startup) by mausezahn's ARP service. Currently, its state is config which means that the process is sleeping.</p>
<p class='spacer'>

  <h3>General packet options:</h3>
<p class='spacer'>

<p>Now let's create our own packet process and switch into the global configuration mode:</p>
<p class='spacer'>

<pre>  mz# configure terminal
  mz(config)# packet
  Allocated new packet PKT0002 at slot 2
  mz(config-pkt-2)# ?
  ...
  name                 Assign a unique name
  description          Assign a packet description text
  bind                 Select the network interface
  count                Configure the packet count value
  delay                Configure the inter-packet delay
  interval             Configure a greater interval
  type                 Specify packet type
  mac                  Configure packet's MAC addresses
  tag                  Configure tags
  payload              Configure a payload
  port                 Configure packet's port numbers
  end                  End packet configuration mode
  ethernet             Configure frame's Ethernet, 802.2, 802.3, or SNAP settings
  ip                   Configure packet's IP settings
  udp                  Configure packet's UDP header parameters
  tcp                  Configure packet's TCP header parameters</pre>

<p class='spacer'>

<p>Here are a lot of options but normally you only need a few of them. When you configure lots of different packets you might assign a reasonable name and description for them:</p>
<p class='spacer'>

<pre>  mz(config-pkt-2)# name Test
  mz(config-pkt-2)# description This is just a test</pre>

<p class='spacer'>

<p>You can, for example, change the default settings for the source and destination MAC or IP addresses using the mac and ip commands:</p>
<p class='spacer'>

<pre>  mz(config-pkt-2)# ip address destination 10.1.1.0 /24
  mz(config-pkt-2)# ip address source random</pre>

<p class='spacer'>

<p>In the example above, we configured a range of addresses (all hosts in the network 10.1.1.0 should be addressed). Additionally we spoof our source IP address. Of course, we can also add one or more VLAN and, or, MPLS tag(s):</p>
<p class='spacer'>

<pre>  mz(config-pkt-2)# tag ?
  dot1q                Configure 802.1Q (and 802.1P) parameters
  mpls                 Configure MPLS label stack
  mz(config-pkt-2)# tag dot ?
  Configure 802.1Q tags:
  VLAN[:CoS] [VLAN[:CoS]] ...   The leftmost tag is the outer tag in the frame
  remove &lt;tag-nr&gt; | all         Remove one or more tags (&lt;tag-nr&gt; starts with 1),
                                by default the first (=leftmost,outer) tag is removed,
                                keyword 'all' can be used instead of tag numbers.
  cfi | nocfi [&lt;tag-nr&gt;]        Set or unset the CFI-bit in any tag (by default
                                assuming the first tag).
  mz(config-pkt-2)# tag dot 1:7 200:5</pre>

<p class='spacer'>

  <h3>Configure count and delay:</h3>
<p class='spacer'>

<pre>  mz(config-pkt-2)# count 1000
  mz(config-pkt-2)# delay ?
  delay &lt;value&gt; [hour | min | sec | msec | usec | nsec]</pre>

<p class='spacer'>

<p>Specify the inter-packet delay in hours, minutes, seconds, milliseconds, microseconds or nanoseconds. The default unit is milliseconds (i.e. when no unit is given).</p>
<p class='spacer'>

<pre>  mz(config-pkt-2)# delay 1 msec
  Inter-packet delay set to 0 sec and 1000000 nsec
  mz(config-pkt-2)#</pre>

<p class='spacer'>

  <h3>Configuring protocol types:</h3>
<p class='spacer'>

<p>mausezahn's interactive mode supports a growing list of protocols and only relies on the MOPS architecture (and not on libnet as is the case with the legacy direct mode):</p>
<p class='spacer'>

<pre>  mz(config-pkt-2)# type
  Specify a packet type from the following list:
  arp
  bpdu
  igmp
  ip
  lldp
  tcp
  udp
  mz(config-pkt-2)# type tcp
  mz(config-pkt-2-tcp)#
  ....
  seqnr                Configure the TCP sequence number
  acknr                Configure the TCP acknowledgement number
  hlen                 Configure the TCP header length
  reserved             Configure the TCP reserved field
  flags                Configure a combination of TCP flags at once
  cwr                  Set or unset the TCP CWR flag
  ece                  Set or unset the TCP ECE flag
  urg                  Set or unset the TCP URG flag
  ack                  set or unset the TCP ACK flag
  psh                  set or unset the TCP PSH flag
  rst                  set or unset the TCP RST flag
  syn                  set or unset the TCP SYN flag
  fin                  set or unset the TCP FIN flag
  window               Configure the TCP window size
  checksum             Configure the TCP checksum
  urgent-pointer       Configure the TCP urgent pointer
  options              Configure TCP options
  end                  End TCP configuration mode
  mz(config-pkt-2-tcp)# flags syn fin rst
  Current setting is: --------------------RST-SYN-FIN
  mz(config-pkt-2-tcp)# end
  mz(config-pkt-2)# payload ascii This is a dummy payload for my first packet
  mz(config-pkt-2)# end</pre>

<p class='spacer'>

<p>Now configure another packet, for example let's assume we want an LLDP process:</p>
<p class='spacer'>

<pre>  mz(config)# packet
  Allocated new packet PKT0003 at slot 3
  mz(config-pkt-3)# type lldp
  mz(config-pkt-3-lldp)# exit
  mz(config)# exit</pre>

<p class='spacer'>

<p>In the above example we only use the default LLDP settings and don't configure further LLDP options or TLVs. Back in the top level of the CLI let's verify what we had done:</p>
<p class='spacer'>

<pre>  mz# show packet
  Packet layer flags: E=Ethernet, S=SNAP, Q=802.1Q, M=MPLS, I/i=IP/delivery_off, U=UDP, T=TCP
  PktID  PktName            Layers  Proto    Size  State      Device   Delay      Count/CntX
     1   sysARP_servic...   E-----  ARP        60  config     lo       100 msec       1/0 (100%)
     2   Test               E-Q-IT            125  config     eth0    1000 usec    1000/1000 (0%)
     3   PKT0003            E-----  LLDP       36  config     eth0      30 sec        0/0 (0%)
  3 packets defined, 0 active.</pre>

<p class='spacer'>

<p>The column Layers indicates which major protocols have been combined. For example the packet with packet-id 2 ("Test") utilizes Ethernet (E), IP (I), and TCP (T). Additionally an 802.1Q tag (Q) has been inserted. Now start one of these packet processes:</p>
<p class='spacer'>

<pre>  mz# start slot 3
  Activate [3]
  mz# show packet
  Packet layer flags: E=Ethernet, S=SNAP, Q=802.1Q, M=MPLS, I/i=IP/delivery_off, U=UDP, T=TCP
  PktID  PktName            Layers  Proto    Size  State      Device   Delay      Count/CntX
     1   sysARP_servic...   E-----  ARP        60  config     lo       100 msec       1/0 (100%)
     2   Test               E-Q-IT            125  config     eth0    1000 usec    1000/1000 (0%)
     3   PKT0003            E-----  LLDP       36  config     eth0      30 sec        0/1 (0%)
  3 packets defined, 1 active.</pre>

<p class='spacer'>

<p>Let's have a more detailed look at a specific packet process:</p>
<p class='spacer'>

<pre>  mz# show packet 2
  Packet [2] Test
  Description: This is just a test
  State: config, Count=1000, delay=1000 usec (0 s 1000000 nsec), interval= (undefined)
  Headers:
   Ethernet: 00-30-05-76-2e-8d =&gt; ff-ff-ff-ff-ff-ff  [0800 after 802.1Q tag]
   Auto-delivery is ON (that is, the actual MAC is adapted upon transmission)
   802.1Q: 0 tag(s);  (VLAN:CoS)
   IP:  SA=192.168.0.4 (not random) (no range)
        DA=255.255.255.255 (no range)
        ToS=0x00  proto=17  TTL=255  ID=0  offset=0  flags: -|-|-
        len=49664(correct)  checksum=0x2e8d(correct)
   TCP: 83 bytes segment size (including TCP header)
        SP=0 (norange) (not random), DP=0 (norange) (not random)
        SQNR=3405691582 (start 0, stop 4294967295, delta 0) -- ACKNR=0 (invalid)
        Flags: ------------------------SYN----, reserved field is 00, urgent pointer= 0
        Announced window size= 100
        Offset= 0 (times 32 bit; value is valid), checksum= ffff (valid)
        (No TCP options attached) - 0 bytes defined
   Payload size: 43 bytes
   Frame size: 125 bytes
    1  ff:ff:ff:ff:ff:ff:00:30  05:76:2e:8d:81:00:e0:01  81:00:a0:c8:08:00:45:00  00:67:00:00:00:00:ff:06
   33  fa:e4:c0:a8:00:04:ff:ff  ff:ff:00:00:00:00:ca:fe  ba:be:00:00:00:00:a0:07  00:64:f7:ab:00:00:02:04
   65  05:ac:04:02:08:0a:19:35  90:c3:00:00:00:00:01:03  03:05:54:68:69:73:20:69  73:20:61:20:64:75:6d:6d
   97  79:20:70:61:79:6c:6f:61  64:20:66:6f:72:20:6d:79  20:66:69:72:73:74:20:70  61:63:6b:65:74
  mz#</pre>

<p class='spacer'>

<p>If you want to stop one or more packet processes, use the stop command. The "emergency stop" is when you use stop all:</p>
<p class='spacer'>

<pre>  mz# stop all
  Stopping
  [3] PKT0003
  Stopped 1 transmission processe(s)</pre>

<p class='spacer'>

<p>The launch command provides a shortcut for commonly used packet processes. For example to behave like a STP-capable bridge we want to start an BPDU process with typical parameters:</p>
<p class='spacer'>

<pre>  mz# launch bpdu
  Allocated new packet sysBPDU at slot 5
  mz# show packet
  Packet layer flags: E=Ethernet, S=SNAP, Q=802.1Q, M=MPLS, I/i=IP/delivery_off, U=UDP, T=TCP
  PktID  PktName           Layers  Proto    Size  State      Device      Delay       Count/CntX
      1  sysARP_servic...  E-----  ARP        60  config     lo          100 msec        1/0 (100%)
      2  Test              E-Q-IT            125  config     eth0       1000 usec     1000/1000 (0%)
      3  PKT0003           E-----  LLDP       36  config     eth0          30 sec        0/12 (0%)
      4  PKT0004           E---I-  IGMP       46  config     eth0        100 msec        0/0 (0%)
      5  sysBPDU           ES----  BPDU       29  active     eth0           2 sec        0/1 (0%)
  5 packets defined, 1 active.</pre>

<p class='spacer'>

<p>Now a Configuration BPDU is sent every 2 seconds, claiming to be the root bridge (and usually confusing the LAN. Note that only packet 5 (i.e. the last row) is active and therefore sending packets while all other packets are in state config (i.e. they have been configured but they are not doing anything at the moment).</p>
<p class='spacer'>

  <h3>Configuring a greater interval:</h3>
<p class='spacer'>

<p>Sometimes you may want to send a burst of packets at a greater interval:</p>
<p class='spacer'>

<pre>  mz(config)# packet 2
  Modify packet parameters for packet Test [2]
  mz(config-pkt-2)# interval
  Configure a greater packet interval in days, hours, minutes, or seconds
  Arguments: &lt;value&gt;  &lt;days | hours | minutes | seconds&gt;
  Use a zero value to disable an interval.
  mz(config-pkt-2)# interval 1 hour
  mz(config-pkt-2)# count 10
  mz(config-pkt-2)# delay 15 usec
  Inter-packet delay set to 0 sec and 15000 nsec</pre>

<p class='spacer'>

<p>Now this packet is sent ten times with an inter-packet delay of 15 microseconds and this is repeated every hour. When you look at the packet list, an interval is indicated with the additional flag 'i' when inactive or 'I' when active:</p>
<p class='spacer'>

<pre>  mz# show packet
  Packet layer flags: E=Ethernet, S=SNAP, Q=802.1Q, M=MPLS, I/i=IP/delivery_off, U=UDP, T=TCP
  PktID  PktName           Layers  Proto    Size  State      Device      Delay       Count/CntX
      1  sysARP_servic...  E-----  ARP        60  config     lo          100 msec        1/0 (100%)
      2  Test              E-Q-IT            125  config-i   eth0         15 usec       10/10 (0%)
      3  PKT0003           E-----  LLDP       36  config     eth0          30 sec        0/12 (0%)
      4  PKT0004           E---I-  IGMP       46  config     eth0        100 msec        0/0 (0%)
      5  sysBPDU           ES----  BPDU       29  active     eth0           2 sec        0/251 (0%)
  5 packets defined, 1 active.
  mz# start slot 2
  Activate [2]
  mz# show packet
  Packet layer flags: E=Ethernet, S=SNAP, Q=802.1Q, M=MPLS, I/i=IP/delivery_off, U=UDP, T=TCP
  PktID  PktName           Layers  Proto    Size  State      Device      Delay       Count/CntX
      1  sysARP_servic...  E-----  ARP        60  config     lo          100 msec        1/0 (100%)
      2  Test              E-Q-IT            125  config+I   eth0         15 usec       10/0 (100%)
      3  PKT0003           E-----  LLDP       36  config     eth0          30 sec        0/12 (0%)
      4  PKT0004           E---I-  IGMP       46  config     eth0        100 msec        0/0 (0%)
      5  sysBPDU           ES----  BPDU       29  active     eth0           2 sec        0/256 (0%)
  5 packets defined, 1 active.</pre>

<p class='spacer'>

<p>Note that the flag 'I' indicates that an interval has been specified for packet 2. The process is not active at the moment (only packet 5 is active here) but it will become active at a regular interval. You can verify the actual interval when viewing the packet details via the 'show packet 2' command.</p>
<p class='spacer'>

  <h3>Load prepared configurations:</h3>
<p class='spacer'>

<p>You can prepare packet configurations using the same commands as you would type them in on the CLI and then load them to the CLI. For example, assume we have prepared a file 'test.mops' containing:</p>
<p class='spacer'>

<pre>  configure terminal
  packet
  name IGMP_TEST
  desc This is only a demonstration how to load a file to mops
  type igmp</pre>

<p class='spacer'>

<p>Then we can add this packet configuration to our packet list using the load command:</p>
<p class='spacer'>

<pre>  mz# load test.mops
  Read commands from test.mops...
  Allocated new packet PKT0002 at slot 2
  mz# show packet
  Packet layer flags: E=Ethernet, S=SNAP, Q=802.1Q, M=MPLS, I/i=IP/delivery_off, U=UDP, T=TCP
  PktID  PktName           Layers  Proto    Size  State      Device      Delay       Count/CntX
      1  sysARP_servic...  E-----  ARP        60  config     lo          100 msec        1/0 (100%)
      2  IGMP_TEST         E---I-  IGMP       46  config     eth0        100 msec        0/0 (0%)
  2 packets defined, 0 active.</pre>

<p class='spacer'>

<p>The file src/examples/mausezahn/example_lldp.conf contains another example list of commands to create a bogus LLDP packet. You can load this configuration from the mausezahn command line as follows:</p>
<p class='spacer'>

<pre>  mz# load /home/hh/tmp/example_lldp.conf</pre>

<p class='spacer'>

<p>In case you copied the file in that path. Now when you enter 'show packet' you will see a new packet entry in the packet list. Use the 'start slot &lt;nr&gt;' command to activate this packet.</p>
<p class='spacer'>

<p>You can store your own packet creations in such a file and easily load them when you need them. Every command within such configuration files is executed on the command line interface as if you had typed it in -- so be careful about the order and don't forget to use 'configure terminal' as first command.</p>
<p class='spacer'>

<p>You can even load other files from within a central config file.</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIRECT MODE HOWTO</h2>
        <div class="sectioncontent">

<p class='spacer'>

  <h3>How to specify hexadecimal digits:</h3>
<p class='spacer'>

<p>Many arguments allow direct byte input. Bytes are represented as two hexadecimal digits. Multiple bytes must be separated either by spaces, colons, or dashes - whichever you prefer. The following byte strings are equivalent:</p>
<p class='spacer'>

<pre>  "aa:bb cc-dd-ee ff 01 02 03-04 05"
  "aa bb cc dd ee ff:01:02:03:04 05"</pre>

<p class='spacer'>

<p>To begin with, you may want to send an arbitrary fancy (possibly invalid) frame right through your network card:</p>
<p class='spacer'>

<pre>  mausezahn ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:08:00:ca:fe:ba:be</pre>

<p class='spacer'>

<pre> or equivalent but more readable:</pre>

<p class='spacer'>

<pre>  mausezahn ff:ff:ff:ff:ff:ff-ff:ff:ff:ff:ff:ff-08:00-ca:fe:ba:be</pre>

<p class='spacer'>

  <h3>Basic operations:</h3>
<p class='spacer'>

<p>All major command line options are listed when you execute mausezahn without arguments. For practical usage, keep the following special (not so widely known) options in mind:</p>
<p class='spacer'>

<pre>  -r                    Multiplies the specified delay with a random value.
  -p &lt;length&gt;           Pad the raw frame to specified length (using random bytes).
  -P &lt;ASCII Payload&gt;    Use the specified ASCII payload.
  -f &lt;filename&gt;         Read the ASCII payload from a file.
  -F &lt;filename&gt;         Read the hexadecimal payload from a file.
  -S                    Simulation mode: DOES NOT put anything on the wire.
                        This is typically combined with one of the verbose
                        modes (-v or V).</pre>

<p class='spacer'>

<p>Many options require a keyword or a number but the -t option is an exception since it requires both a packet type (such as ip, udp, dns, etc) and an argument string which is specific for that packet type. Here are some simple examples:</p>
<p class='spacer'>

<pre>  mausezahn -t help
  mausezahn -t tcp help
  mausezahn eth3 -t udp sp=69,dp=69,p=ca:fe:ba:be</pre>

<p class='spacer'>

<p>Note: Don't forget that on the CLI the Linux shell (usually the Bash) interprets spaces as a delimiting character. That is, if you are specifying an argument that consists of multiple words with spaces in between, you MUST group these within quotes. For example, instead of</p>
<p class='spacer'>

<pre>  mausezahn eth0 -t udp sp=1,dp=80,p=00:11:22:33</pre>

<p class='spacer'>

<pre> you could either omit the spaces</pre>

<p class='spacer'>

<pre>  mausezahn eth0 -t udp sp=1,dp=80,p=00:11:22:33</pre>

<p class='spacer'>

<pre> or, for greater safety, use quotes:</pre>

<p class='spacer'>

<pre>  mausezahn eth0 -t udp "sp=1,dp=80,p=00:11:22:33"</pre>

<p class='spacer'>

<p>In order to monitor what's going on, you can enable the verbose mode using the -v option. The opposite is the quiet mode (-q) which will keep mausezahn absolutely quiet (except for error messages and warnings.)</p>
<p class='spacer'>

<p>Don't confuse the payload argument p=... with the padding option -p. The latter is used outside the quotes!</p>
<p class='spacer'>

  <h3>The automatic packet builder:</h3>
<p class='spacer'>

<p>An important argument is -t which invokes a packet builder. Currently there are packet builders for ARP, BPDU, CDP, IP, partly ICMP, UDP, TCP, RTP, DNS, and SYSLOG. (Additionally you can insert a VLAN tag or a MPLS label stack but this works independently of the packet builder.)</p>
<p class='spacer'>

<p>You get context specific help for every packet builder using the help keyword, such as:</p>
<p class='spacer'>

<pre>  mausezahn -t bpdu help
  mausezahn -t tcp help</pre>

<p class='spacer'>

<p>For every packet you may specify an optional payload. This can be done either via hexadecimal notation using the payload (or short p) argument or directly as ASCII text using the -P option:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -t ip -P "Hello World"                        # ASCII payload
  mausezahn eth0 -t ip p=68:65:6c:6c:6f:20:77:6f:72:6c:64       # hex payload
  mausezahn eth0 -t ip "proto=89,                           &#92;
                        p=68:65:6c:6c:6f:20:77:6f:72:6c:64, nbsp;  # same with other
                        ttl=1"                                   # IP arguments</pre>

<p class='spacer'>

<p>Note: The raw link access mode only accepts hexadecimal payloads (because you specify everything in hexadecimal here.)</p>
<p class='spacer'>

  <h3>Packet count and delay:</h3>
<p class='spacer'>

<p>By default only one packet is sent. If you want to send more packets then use the count option -c &lt;count&gt;. When count is zero then mausezahn will send forever. By default, mausezahn sends at maximum speed (and this is really fast ;-)). If you don't want to overwhelm your network devices or have other reasons to send at a slower rate then you might want to specify a delay using the -d &lt;delay&gt; option.</p>
<p class='spacer'>

<p>If you only specify a numeric value it is interpreted in microsecond units. Alternatively, for easier use, you might specify units such as seconds, sec, milliseconds, or msec. (You can also abbreviate this with s or m.) Note: Don't use spaces between the value and the unit! Here are typical examples:</p>
<p class='spacer'>

<p>Send an infinite number of frames as fast as possible:</p>
<p class='spacer'>

<pre>  mausezahn -c 0  "aa bb cc dd ...."</pre>

<p class='spacer'>

<p>Send 100,000 frames with a 50 msec interval:</p>
<p class='spacer'>

<pre>  mausezahn -c 100000 -d 50msec "aa bb cc dd ...."</pre>

<p class='spacer'>

<p>Send an unlimited number of BPDU frames in a 2 second interval:</p>
<p class='spacer'>

<pre>  mausezahn -c 0 -d 2s -t bpdu conf</pre>

<p class='spacer'>

<p>Note: mausezahn does not support fractional numbers. If you want to specify for example 2.5 seconds then express this in milliseconds (2500 msec).</p>
<p class='spacer'>

  <h3>Source and destination addresses:</h3>
<p class='spacer'>

<p>As a mnemonic trick keep in mind that all packets run from "A" to "B". You can always specify source and destination MAC addresses using the -a and -b options, respectively. These options also allow keywords such as rand, own, bpdu, cisco, and others.</p>
<p class='spacer'>

<p>Similarly, you can specify source and destination IP addresses using the -A and -B options, respectively. These options also support FQDNs (i.e. domain names) and ranges such as 192.168.0.0/24 or 10.0.0.11-10.0.3.22. Additionally, the source address option supports the rand keyword (ideal for "attacks").</p>
<p class='spacer'>

<p>Note: When you use the packet builder for IP-based packets (e.g. UDP or TCP) then mausezahn automatically cares about correct MAC and IP addresses (i.e. it performs ARP, DHCP, and DNS for you). But when you specify at least a single link-layer address (or any other L2 option such as a VLAN tag or MPLS header) then ARP is disabled and you must care for the Ethernet destination address for yourself.</p>
<p class='spacer'>

  <h3>Layer-2:</h3>
<p class='spacer'>

  <h3>`-- Direct link access:</h3>
<p class='spacer'>

<p>mausezahn allows you to send ANY chain of bytes directly through your Ethernet interface:</p>
<p class='spacer'>

<pre>  mausezahn eth0 "ff:ff:ff:ff:ff:ff ff:ff:ff:ff:ff:ff 00:00 ca:fe:ba:be"</pre>

<p class='spacer'>

<p>This way you can craft every packet you want but you must do it by hand. Note: On Wi-Fi interfaces the header is much more complicated and automatically created by the Wi-Fi driver. As an example to introduce some interesting options, lets continuously send frames at max speed with random source MAC address and broadcast destination address, additionally pad the frame to 1000 bytes:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -c 0 -a rand -b bcast -p 1000 "08 00 aa bb cc dd"</pre>

<p class='spacer'>

<p>The direct link access supports automatic padding using the -p &lt;total frame length&gt; option. This allows you to pad a raw L2 frame to the desired length. You must specify the total length, and the total frame length must have at least 15 bytes for technical reasons. Zero bytes are used for padding.</p>
<p class='spacer'>

  <h3>`-- ARP:</h3>
<p class='spacer'>

<p>mausezahn provides a simple interface to the ARP packet. You can specify the ARP method (request|reply) and up to four arguments: sendermac, targetmac, senderip, targetip, or short smac, tmac, sip, tip. By default, an ARP reply is sent with your own interface addresses as source MAC and IP address, and a broadcast destination MAC and IP address. Send a gratuitous ARP request (as used for duplicate IP address detection):</p>
<p class='spacer'>

<pre>  mausezahn eth0 -t arp</pre>

<p class='spacer'>

<p>ARP cache poisoning:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -t arp "reply, senderip=192.168.0.1, targetmac=00:00:0c:01:02:03, &#92;
                          targetip=172.16.1.50"</pre>

<p class='spacer'>

<pre> where by default your interface MAC address will be used as sendermac,</pre>

<p>senderip denotes the spoofed IP address, targetmac and targetip identifies the receiver. By default, the Ethernet source address is your interface MAC and the destination address is the broadcast address. You can change this using the flags -a and -b.</p>
<p class='spacer'>

  <h3>`-- BPDU:</h3>
<p class='spacer'>

<p>mausezahn provides a simple interface to the 802.1D BPDU frame format (used to create the Spanning Tree in bridged networks). By default, standard IEEE 802.1D BPDUs are sent and it is assumed that your computer wants to become the root bridge (rid=bid). Optionally the 802.3 destination address can be a specified MAC address, broadcast, own MAC, or Cisco's PVST+ MAC address. The destination MAC can be specified using the -b command which, besides MAC addresses, accepts keywords such as bcast, own, pvst, or stp (default). PVST+ is supported as well. Simply specify the VLAN for which you want to send a BPDU:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -t bpdu "vlan=123, rid=2000"</pre>

<p class='spacer'>

<p>See mausezahn -t bpdu help for more details.</p>
<p class='spacer'>

  <h3>`-- CDP:</h3>
<p class='spacer'>

<p>mausezahn can send Cisco Discovery Protocol (CDP) messages since this protocol has security relevance. Of course lots of dirty tricks are possible; for example arbitrary TLVs can be created (using the hex-payload argument for example p=00:0e:00:07:01:01:90) and if you want to stress the CDP database of some device, mausezahn can send each CDP message with another system-id using the change keyword:</p>
<p class='spacer'>

<pre>  mausezahn -t cdp change -c 0</pre>

<p class='spacer'>

<p>Some routers and switches may run into deep problems ;-) See mausezahn -t cdp help for more details.</p>
<p class='spacer'>

  <h3>`-- 802.1Q VLAN Tags:</h3>
<p class='spacer'>

<p>mausezahn allows simple VLAN tagging for IP (and other higher layer) packets. Simply use the option -Q &lt;[CoS:]VLAN&gt;, such as -Q 10 or -Q 3:921. By default CoS=0. For example send a TCP packet in VLAN 500 using CoS=7:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -t tcp -Q 7:500 "dp=80, flags=rst, p=aa:aa:aa"</pre>

<p class='spacer'>

<p>You can create as many VLAN tags as you want! This is interesting to create QinQ encapsulations or VLAN hopping: Send a UDP packet with VLAN tags 100 (outer) and 651 (inner):</p>
<p class='spacer'>

<pre>  mausezahn eth0 -t udp "dp=8888, sp=13442" -P "Mausezahn is great" -Q 100,651</pre>

<p class='spacer'>

<p>Don't know if this is useful anywhere but at least it is possible:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -t udp "dp=8888, sp=13442" -P "Mausezahn is great"  &#92;
                 -Q 6:5,7:732,5:331,5,6</pre>

<p class='spacer'>

<p>Mix it with MPLS:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -t udp "dp=8888, sp=13442" -P "Mausezahn is great" -Q 100,651 -M 314</pre>

<p class='spacer'>

<p>When in raw Layer 2 mode you must create the VLAN tag completely by yourself. For example if you want to send a frame in VLAN 5 using CoS 0 simply specify 81:00 as type field and for the next two bytes the CoS (PCP), DEI (CFI), and VLAN ID values (all together known as TCI):</p>
<p class='spacer'>

<pre>  mausezahn eth0 -b bc -a rand "81:00 00:05 08:00 aa-aa-aa-aa-aa-aa-aa-aa-aa"</pre>

<p class='spacer'>

  <h3>`-- MPLS labels:</h3>
<p class='spacer'>

<p>mausezahn allows you to insert one or more MPLS headers. Simply use the option -M &lt;label:CoS:TTL:BoS&gt; where only the label is mandatory. If you specify a second number it is interpreted as the experimental bits (the CoS usually). If you specify a third number it is interpreted as TTL. By default the TTL is set to 255. The Bottom of Stack flag is set automatically, otherwise the frame would be invalid, but if you want you can also set or unset it using the S (set) and s (unset) argument. Note that the BoS must be the last argument in each MPLS header definition. Here are some examples:</p>
<p class='spacer'>

<p>Use MPLS label 214:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -M 214 -t tcp "dp=80" -P "HTTP..." -B myhost.com</pre>

<p class='spacer'>

<p>Use three labels (the 214 is now the outer):</p>
<p class='spacer'>

<pre>  mausezahn eth0 -M 9999,51,214 -t tcp "dp=80" -P "HTTP..." -B myhost.com</pre>

<p class='spacer'>

<p>Use two labels, one with CoS=5 and TTL=1, the other with CoS=7:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -M 100:5:1,500:7 -t tcp "dp=80" -P "HTTP..." -B myhost.com</pre>

<p class='spacer'>

<p>Unset the BoS flag (which will result in an invalid frame):</p>
<p class='spacer'>

<pre>  mausezahn eth0 -M 214:s -t tcp "dp=80" -P "HTTP..." -B myhost.com</pre>

<p class='spacer'>

  <h3>Layer 3-7:</h3>
<p class='spacer'>

<p>IP, UDP, and TCP packets can be padded using the -p option. Currently 0x42 is used as padding byte ('the answer'). You cannot pad DNS packets (would be useless anyway).</p>
<p class='spacer'>

  <h3>`-- IP:</h3>
<p class='spacer'>

<p>mausezahn allows you to send any malformed or correct IP packet. Every field in the IP header can be manipulated. The IP addresses can be specified via the -A and -B options, denoting the source and destination address, respectively. You can also specify an address range or a host name (FQDN). Additionally, the source address can also be random. By default the source address is your interface IP address and the destination address is a broadcast address. Here are some examples:</p>
<p class='spacer'>

<p>ASCII payload:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -t ip -A rand -B 192.168.1.0/24  -P "hello world"</pre>

<p class='spacer'>

<p>Hexadecimal payload:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -t ip -A 10.1.0.1-10.1.255.254 -B 255.255.255.255 p=ca:fe:ba:be</pre>

<p class='spacer'>

<p>Will use correct source IP address:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -t ip -B www.xyz.com</pre>

<p class='spacer'>

<p>The Type of Service (ToS) byte can either be specified directly by two hexadecimal digits, which means you can also easily set the Explicit Congestion Notification (ECN) bits (LSB 1 and 2), or you may only want to specify a common DSCP value (bits 3-8) using a decimal number (0..63):</p>
<p class='spacer'>

<p>Packet sent with DSCP = Expedited Forwarding (EF):</p>
<p class='spacer'>

<pre>  mausezahn eth0 -t ip dscp=46,ttl=1,proto=1,p=08:00:5a:a2:de:ad:be:af</pre>

<p class='spacer'>

<p>If you leave the checksum as zero (or unspecified) the correct checksum will be automatically computed. Note that you can only use a wrong checksum when you also specify at least one L2 field manually.</p>
<p class='spacer'>

  <h3>`-- UDP:</h3>
<p class='spacer'>

<p>mausezahn supports easy UDP datagram generation. Simply specify the destination address (-B option) and optionally an arbitrary source address (-A option) and as arguments you may specify the port numbers using the dp (destination port) and sp (source port) arguments and a payload. You can also easily specify a whole port range which will result in sending multiple packets. Here are some examples:</p>
<p class='spacer'>

<p>Send test packets to the RTP port range:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -B 192.168.1.1 -t udp "dp=16384-32767, &#92;
                   p=A1:00:CC:00:00:AB:CD:EE:EE:DD:DD:00"</pre>

<p class='spacer'>

<p>Send a DNS request as local broadcast (often a local router replies):</p>
<p class='spacer'>

<pre>  mausezahn eth0 -t udp dp=53,p=c5-2f-01-00-00-01-00-00-00-00-00-00-03-77-77-&#92;
                                 77-03-78-79-7a-03-63-6f-6d-00-00-01-00-01"</pre>

<p class='spacer'>

<p>Additionally you may specify the length and checksum using the len and sum arguments (will be set correctly by default). Note: several protocols have same arguments such as len (length) and sum (checksum). If you specified a UDP type packet (via -t udp) and want to modify the IP length, then use the alternate keyword iplen and ipsum. Also note that you must specify at least one L2 field which tells mausezahn to build everything without the help of your kernel (the kernel would not allow modifying the IP checksum and the IP length).</p>
<p class='spacer'>

  <h3>`-- ICMP:</h3>
<p class='spacer'>

<p>mausezahn currently only supports the following ICMP methods: PING (echo request), Redirect (various types), Unreachable (various types). Additional ICMP types will be supported in future. Currently you would need to tailor them by yourself, e.g. using the IP packet builder (setting proto=1). Use the mausezahn -t icmp help for help on currently implemented options.</p>
<p class='spacer'>

  <h3>`-- TCP:</h3>
<p class='spacer'>

<p>mausezahn allows you to easily tailor any TCP packet. Similarly as with UDP you can specify source and destination port (ranges) using the sp and dp arguments. Then you can directly specify the desired flags using an "|" as delimiter if you want to specify multiple flags. For example, a SYN-Flood attack against host 1.1.1.1 using a random source IP address and periodically using all 1023 well-known ports could be created via:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -A rand -B 1.1.1.1 -c 0 -t tcp "dp=1-1023, flags=syn"  &#92;
                 -P "Good morning! This is a SYN Flood Attack.             &#92;
                     We apologize for any inconvenience."</pre>

<p class='spacer'>

<p>Be careful with such SYN floods and only use them for firewall testing. Check your legal position! Remember that a host with an open TCP session only accepts packets with correct socket information (addresses and ports) and a valid TCP sequence number (SQNR). If you want to try a DoS attack by sending a RST-flood and you do NOT know the target's initial SQNR (which is normally the case) then you may want to sweep through a range of sequence numbers:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -A legal.host.com -B target.host.com &#92;
                 -t tcp "sp=80,dp=80,s=1-4294967295"</pre>

<p class='spacer'>

<p>Fortunately, the SQNR must match the target host's acknowledgement number plus the announced window size. Since the typical window size is something between 40000 and 65535 you are MUCH quicker when using an increment via the ds argument:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -A legal.host.com -B target.host.com &#92;
                 -t tcp "sp=80, dp=80, s=1-4294967295, ds=40000"</pre>

<p class='spacer'>

<p>In the latter case mausezahn will only send 107375 packets instead of 4294967295 (which results in a duration of approximately 1 second compared to 11 hours!). Of course you can tailor any TCP packet you like. As with other L4 protocols mausezahn builds a correct IP header but you can additionally access every field in the IP packet (also in the Ethernet frame).</p>
<p class='spacer'>

  <h3>`-- DNS:</h3>
<p class='spacer'>

<p>mausezahn supports UDP-based DNS requests or responses. Typically you may want to send a query or an answer. As usual, you can modify every flag in the header. Here is an example of a simple query:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -B mydns-server.com -t dns "q=www.ibm.com"</pre>

<p class='spacer'>

<p>You can also create server-type messages:</p>
<p class='spacer'>

<pre>  mausezahn eth0 -A spoofed.dns-server.com -B target.host.com &#92;
                 "q=www.topsecret.com, a=172.16.1.1"</pre>

<p class='spacer'>

<p>The syntax according to the online help (-t dns help) is:</p>
<p class='spacer'>

<pre>  query|q = &lt;name&gt;[:&lt;type&gt;]  ............. where type is per default "A"
                                           (and class is always "IN")
  answer|a = [&lt;type&gt;:&lt;ttl&gt;:]&lt;rdata&gt; ...... ttl is per default 0.
           = [&lt;type&gt;:&lt;ttl&gt;:]&lt;rdata&gt;/[&lt;type&gt;:&lt;ttl&gt;:]&lt;rdata&gt;/...</pre>

<p class='spacer'>

<p>Note: If you only use the 'query' option then a query is sent. If you additionally add an 'answer' then an answer is sent. Examples:</p>
<p class='spacer'>

<pre>  q = www.xyz.com
  q = www.xyz.com, a=192.168.1.10
  q = www.xyz.com, a=A:3600:192.168.1.10
  q = www.xyz.com, a=CNAME:3600:abc.com/A:3600:192.168.1.10</pre>

<p class='spacer'>

<p>Please try out mausezahn -t dns help to see the many other optional command line options.</p>
<p class='spacer'>

  <h3>`-- RTP and VoIP path measurements:</h3>
<p class='spacer'>

<p>mausezahn can send arbitrary Real Time Protocol (RTP) packets. By default a classical G.711 codec packet of 20 ms segment size and 160 bytes is assumed. You can measure jitter, packet loss, and reordering along a path between two hosts running mausezahn. The jitter measurement is either done following the variance low-pass filtered estimation specified in RFC 3550 or using an alternative "real-time" method which is even more precise (the RFC-method is used by default). For example on Host1 you start a transmission process:</p>
<p class='spacer'>

<pre>  mausezahn -t rtp -B 192.168.1.19</pre>

<p class='spacer'>

<p>And on Host2 (192.168.1.19) a receiving process which performs the measurement:</p>
<p class='spacer'>

<pre>  mausezahn -T rtp</pre>

<p class='spacer'>

<p>Note that the option flag with the capital "T" means that it is a server RTP process, waiting for incoming RTP packets from any mausezahn source. In case you want to restrict the measurement to a specific source or you want to perform a bidirectional measurement, you must specify a stream identifier. Here is an example for bidirectional measurements which logs the running jitter average in a file:</p>
<p class='spacer'>

<pre>  Host1# mausezahn -t rtp id=11:11:11:11 -B 192.168.2.2 &
  Host1# mausezahn -T rtp id=22:22:22:22 "log, path=/tmp/mz/"</pre>

<p class='spacer'>

<pre>  Host2# mausezahn -t rtp id=22:22:22:22 -B 192.168.1.1 &
  Host2# mausezahn -T rtp id=11:11:11:11 "log, path=/tmp/mz/"</pre>

<p class='spacer'>

<p>In any case the measurements are printed continuously onto the screen; by default it looks like this:</p>
<p class='spacer'>

<pre>  0.00                     0.19                      0.38                      0.57
  |-------------------------|-------------------------|-------------------------|
  #########                                                                      0.07 msec
  ####################                                                           0.14 msec
  ##                                                                             0.02 msec
  ###                                                                            0.02 msec
  #########                                                                      0.07 msec
  ####                                                                           0.03 msec
  #########                                                                      0.07 msec
  #############                                                                  0.10 msec
  ##                                                                             0.02 msec
  ###########################################                                    0.31 msec
  #########                                                                      0.07 msec
  ##############################################                                 0.33 msec
  ###############                                                                0.11 msec
  ##########                                                                     0.07 msec
  ###############                                                                0.11 msec
  ##########################################################                     0.42 msec
  #####                                                                          0.04 msec</pre>

<p class='spacer'>

<p>More information is shown using the txt keyword:</p>
<p class='spacer'>

<pre>  mausezahn -T rtp txt
  Got 100 packets from host 192.168.0.3: 0 lost (0 absolute lost), 1 out of order
    Jitter_RFC (low pass filtered) = 30 usec
    Samples jitter (min/avg/max)   = 1/186/2527 usec
    Delta-RX (min/avg/max)         = 2010/20167/24805 usec
  Got 100 packets from host 192.168.0.3: 0 lost (0 absolute lost), 1 out of order
    Jitter_RFC (low pass filtered) = 17 usec
    Samples jitter (min/avg/max)   = 1/53/192 usec
    Delta-RX (min/avg/max)         = 20001/20376/20574 usec
  Got 100 packets from host 192.168.0.3: 0 lost (0 absolute lost), 1 out of order
    Jitter_RFC (low pass filtered) = 120 usec
    Samples jitter (min/avg/max)   = 0/91/1683 usec
    Delta-RX (min/avg/max)         = 18673/20378/24822 usec</pre>

<p class='spacer'>

<p>See mausezahn -t rtp help and mz -T rtp help for more details.</p>
<p class='spacer'>

  <h3>`-- Syslog:</h3>
<p class='spacer'>

<p>The traditional Syslog protocol is widely used even in professional networks and is sometimes vulnerable. For example you might insert forged Syslog messages by spoofing your source address (e.g. impersonate the address of a legit network device):</p>
<p class='spacer'>

<pre>  mausezahn -t syslog sev=3 -P "You have been mausezahned." -A 10.1.1.109 -B 192.168.7.7</pre>

<p class='spacer'>

<p>See mausezahn -t syslog help for more details.</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTE</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>When multiple ranges are specified, e.g. destination port ranges and destination address ranges, then all possible combinations of ports and addresses are used for packet generation. Furthermore, this can be mixed with other ranges e.g. a TCP sequence number range. Note that combining ranges can lead to a very huge number of frames to be sent. As a rule of thumb you can assume that about 100,000 frames and more are sent in a fraction of one second, depending on your network interface.</p>
<p class='spacer'>

<p>mausezahn has been designed as a fast traffic generator so you might easily overwhelm a LAN segment with myriads of packets. And because mausezahn could also support security audits it is possible to create malicious or invalid packets, SYN floods, port and address sweeps, DNS and ARP poisoning, etc.</p>
<p class='spacer'>

<p>Therefore, don't use this tool when you are not aware of the possible consequences or have only a little knowledge about networks and data communication. If you abuse mausezahn for 'unallowed' attacks and get caught, or damage something of your own, then this is completely your fault. So the safest solution is to try it out in a lab environment.</p>
<p class='spacer'>

<p>Also have a look at the <a href="../man8/netsniff-ng.8.html"><strong>netsniff-ng</strong>(8)</a> note section on how you can properly setup and tune your system.</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LEGAL</h2>
        <div class="sectioncontent">

<p>mausezahn is licensed under the GNU GPL version 2.0.</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">

<p><strong>mausezahn</strong> was originally written by Herbert Haas. According to his website [1], he unfortunately passed away in 2011 thus leaving this tool unmaintained. It has been adopted and integrated into the netsniff-ng toolkit and is further being maintained and developed from there. Maintainers are Tobias Klauser &lt;tklauser@distanz.ch&gt; and Daniel Borkmann &lt;dborkma@tik.ee.ethz.ch&gt;.</p>
<p class='spacer'>

<pre>  [1] http://www.perihel.at/</pre>

<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<p><a href="../man8/netsniff-ng.8.html"><strong>netsniff-ng</strong>(8)</a>, <a href="../man8/trafgen.8.html"><strong>trafgen</strong>(8)</a>, <a href="../man8/ifpps.8.html"><strong>ifpps</strong>(8)</a>, <a href="../man8/bpfc.8.html"><strong>bpfc</strong>(8)</a>, <a href="../man8/flowtop.8.html"><strong>flowtop</strong>(8)</a>, <a href="../man8/astraceroute.8.html"><strong>astraceroute</strong>(8)</a>, <a href="../man8/curvetun.8.html"><strong>curvetun</strong>(8)</a></p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">

<p>Manpage was written by Herbert Haas and modified by Daniel Borkmann.</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COLOPHON</h2>
        <div class="sectioncontent">

<p>This page is part of the Linux netsniff-ng toolkit project. A description of the project, and information about reporting bugs, can be found at http://netsniff-ng.org/.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="matchpathcon.8.html"><span aria-hidden="true">&larr;</span> matchpathcon.8: get the default SELinux security context for the specified path from the file contexts configuration .</a></li>
   <li class="next"><a href="mcs.8.html">mcs.8: Multi-Category System <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
