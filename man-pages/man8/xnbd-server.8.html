<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>xnbd-server: Serve a file as a block device to other computers via the nbd protocol</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Serve a file as a block device to other computers via the nbd protocol">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="xnbd-server (8) manual">
  <meta name="twitter:description" content="Serve a file as a block device to other computers via the nbd protocol">
  <meta name="twitter:image" content="https://www.carta.tech/images/xnbd-server-xnbd-server-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/xnbd-server.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="xnbd-server (8) manual" />
  <meta property="og:description" content="Serve a file as a block device to other computers via the nbd protocol" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/xnbd-server-xnbd-server-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">xnbd-server<small> (8)</small></h1>
        <p class="lead">Serve a file as a block device to other computers via the nbd protocol</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/xnbd-server.8.html">
      <span itemprop="name">xnbd-server: Serve a file as a block device to other computers via the nbd protocol</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/xnbd-server/">
      <span itemprop="name">xnbd-server</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/xnbd-server.8.html">
      <span itemprop="name">xnbd-server: Serve a file as a block device to other computers via the nbd protocol</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>xnbd-server</strong> --target [options] <em>DISK_IMAGE</em></p><p><strong>xnbd-server</strong> --cow-target [options] <em>BASE_DISK_IMAGE</em></p><p><strong>xnbd-server</strong> --proxy [options] [--target-exportname <em>NAME</em>] <em>REMOTE_HOST</em> <em>REMOTE_PORT</em> <em>CACHE_IMAGE</em> <em>CACHE_BITMAP_IMAGE</em> <em>CONTROL_SOCKET_PATH</em></p><p><strong>xnbd-server</strong> --help</p><p><strong>xnbd-server</strong> --version</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>xnbd-server</strong> is a server program of the Network Block Device (NBD) protocol. It exports an image file to the clients of the NBD protocol over network. A client node can access to the exported file through a block-level I/O interface; it is possible to create swap areas on it or create file systems on it.</p><p>The xNBD (i.e. extended NBD) programs offer several advantages over the original NBD implementation. In addition to the original features, xNBD is intended to achieve better performance. It supports (distributed) copy-on-write, (basic) snapshot support, live storage migration for virtual machines, and IPv6 networking.</p><p><strong>xnbd-server</strong> can operate in three modes (i.e., the target mode, the copy-on-write target mode, and the proxy mode).</p><p><strong>xnbd-server</strong> <strong>--target</strong> exports <em>DISK_IMAGE</em> to clients.</p><p><strong>xnbd-server</strong> <strong>--cow-target</strong> exports <em>BASE_DISK_IMAGE</em> to clients. Write operations are not committed to the exported disk image, but to a separate file. This separate file is removed when the server instance is shutdown, and all changes are lost.</p><p><strong>xnbd-server</strong> <strong>--proxy</strong> provides the image server of the NBD protocol, but it actually works as a proxy to a remote <strong>xnbd-server</strong> specified with <em>REMOTE_HOST</em> and <em>REMOTE_PORT</em>.</p><p>The proxy server receives read/write requests from clients as a normal image server does. But, it locally caches disk blocks, and retrieves disk blocks from the remote server if necessary. No write operation does not happen at the remote server.</p><p>Cached blocks are saved in <em>CACHE_DISK_IMAGE</em>. The block numbers of cached blocks are saved in <em>CACHE_BITMAP_IMAGE</em>. The proxy server is controlled by <a href="../man1/xnbd-bgctl.1.html"><strong>xnbd-bgctl</strong>(1)</a> through <em>CONTROL_SOCKET_PATH</em>.</p><p>The proxy server can be used to speed up remote access, share a read-only disk image among multiple servers and clients, and replicate an exported image to another node transparently. It also works for live storage migration of virtual machines.</p><p><strong>Warning</strong></p><p>Multiple clients can concurrently access to a single server instance. Yet <strong>xnbd-server</strong> does not offer any locking or synchronization mechanism among concurrent clients. In most cases you WILL need a cluster file system on the exported image to avoid damage to your data.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>The following options are supported:</p><p><strong>--daemonize</strong></p><p>Run <strong>xnbd-server</strong> in the background</p><p><strong>--inetd</strong></p><p>Run <strong>xnbd-server</strong> for an Internet super-server daemon (e.g., inetd). All network I/O is redirected to the stdin descriptor.</p><p><strong>--logpath</strong> <em>FILE</em></p><p>Log informational messages to file <em>FILE</em> rather than stderr/syslog.</p><p><strong>--syslog</strong></p><p>Log informational messages to syslog.</p><p><strong>--lport</strong> <em>PORT</em></p><p>Listen incoming connections on the given PORT. If this argument is not given, <strong>xnbd-server</strong> will listen on port 8520 by default.</p><p><strong>--readonly</strong></p><p>Export the image file as read-only. If receiving a write request from a client, the server disconnects the client immediately. If this option is used in the proxy mode, <strong>xnbd-server</strong> rejects write requests from clients, but accepts read requests and may cache new blocks. The cache image file is updated if new blocks are cached.</p><p><strong>--connected-fd</strong> <em>NUMBER</em></p><p>Use file descriptor <em>NUMBER</em> as a bi-directional, pre-negotiated channel to a single client. Used by <a href="../man8/xnbd-wrapper.8.html"><strong>xnbd-wrapper</strong>(8)</a> on invocation of xnbd-server, internally. The file descriptor is turned to blocking mode by xnbd-server before usage.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS (PROXY MODE ONLY)</h2>
        <div class="sectioncontent">
<p><strong>--target-exportname</strong> <em>NAME</em></p><p>Set the export name to request from an xnbd-wrapper target.</p><p><strong>--clear-bitmap</strong></p><p>Clear an existing bitmap file. By default, previous state is re-used.</p><p><strong>--max-queue-size</strong> <em>NUMBER</em></p><p>Limit the total number of queued requests to <em>NUMBER</em>. If the current number of queued requests reaches this limitation, the server delays receiving new requests. By default (i.e., 0), there is no limitation. Use this option to keep memory usage in a safe level if a client asynchronously sends a large number of requests.</p><p><strong>--max-buf-size</strong> <em>NUMBER</em></p><p>Limit the usage of internal buffer to approximately <em>NUMBER</em> bytes. If the current buffer usage reaches this limitation, the server delays receiving new requests. By default (i.e., 0), there is no limitation. Use this option to keep memory usage in a safe level if a client asynchronously sends a large number of requests.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SIGNALS</h2>
        <div class="sectioncontent">
<p><strong>SIGUSR1</strong></p><p>Take a snapshot of the image file. Currently, this feature works only in the target mode.</p><p><strong>SIGUSR2</strong></p><p>Change the proxy mode to the target mode. Use xnbd-bgctl --switch instead of sending this signal.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO xnbd-server&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/xnbd-client.1.html"><strong>xnbd-client</strong>(1)</a>, <a href="../man1/xnbd-bgctl.1.html"><strong>xnbd-bgctl</strong>(1)</a>, <a href="../man8/xnbd-wrapper.8.html"><strong>xnbd-wrapper</strong>(8)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>The NBD kernel module and the NBD tools have been written by Pavel Macheck (pavel@ucw.cz) and is now maintained by Paul Clements (Paul.Clements@steeleye.com).</p><p>The xNBD userland programs have been written by Takahiro Hirofuchi (t.hirofuchi@aist.go.jp).</p><p>This manual page was written by Arno Toell (arno@debian.org) for the Debian GNU/Linux system (but may be used by others). Large parts are verbatim copies of the original nbd-server and nbd-client manual pages written by Wouter Verhelst (wouter@debian.org). Permission is granted to copy, distribute and/or modify this document under the terms of the GNU General Public License, version 2, as published by the Free Software Foundation.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="xnbd-register.8.html"><span aria-hidden="true">&larr;</span> xnbd-register.8: Restore xnbd sessions upon boot</a></li>
   <li class="next"><a href="xnbd-wrapper.8.html">xnbd-wrapper.8: Manage multiple files to be exported as a block device to other computers running the gnu/linux(tm) operating system <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
