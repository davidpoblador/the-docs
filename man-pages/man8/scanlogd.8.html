<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>scanlogd: Detects and logs tcp port scans</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Detects and logs tcp port scans">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="scanlogd (8) manual">
  <meta name="twitter:description" content="Detects and logs tcp port scans">
  <meta name="twitter:image" content="https://www.carta.tech/images/scanlogd-scanlogd-8.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man8/scanlogd.8.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="scanlogd (8) manual" />
  <meta property="og:description" content="Detects and logs tcp port scans" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/scanlogd-scanlogd-8.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">scanlogd<small> (8)</small></h1>
        <p class="lead">Detects and logs tcp port scans</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/">
      <span itemprop="name">System administration commands</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/scanlogd.8.html">
      <span itemprop="name">scanlogd: Detects and logs tcp port scans</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/scanlogd/">
      <span itemprop="name">scanlogd</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man8/scanlogd.8.html">
      <span itemprop="name">scanlogd: Detects and logs tcp port scans</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>scanlogd</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>scanlogd</strong> detects port scans and writes one line per scan via the <a href="../man3/syslog.3.html"><strong>syslog</strong>(3)</a> mechanism. If a source address sends multiple packets to different ports in a short time, the event will be logged. The format of the messages is:</p><p><strong>saddr</strong>[:<strong>sport</strong>] to <strong>daddr</strong> [and others,] ports <strong>port</strong>[, <strong>port</strong>...], ..., <strong>flags</strong>[, TOS <strong>TOS</strong>][, TTL <strong>TTL</strong>] @<strong>HH:MM:SS</strong></p><p>The fields in square brackets are optional; <strong>sport</strong>, <strong>TOS</strong>, and <strong>TTL</strong> will only be displayed if they were constant during the scan.</p><p>The <strong>flags</strong> field represents TCP control bits seen in packets coming to the system from the address of the scan. It is a combination of eight characters, with each corresponding to one of the six defined and two reserved TCP control bits (see RFC 793). Control bits that were always set are encoded with an uppercase letter, and a lowercase letter is used if the bit was always clear. A question mark is used to indicate bits that changed from packet to packet.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INTERFACES</h2>
        <div class="sectioncontent">
<p>In order to do its job, <strong>scanlogd</strong> needs a way to obtain raw IP packets that either come to the system <strong>scanlogd</strong> is running on, or travel across a network segment that is directly connected to the system. Current versions of <strong>scanlogd</strong> can be built with support for one of several packet capture interfaces.</p><p><strong>scanlogd</strong> is aware of the <strong>raw socket</strong> interface on Linux, <strong>libnids</strong>, and <strong>libpcap</strong>.</p><p>The use of <strong>libpcap</strong> alone is discouraged. If you're on a system other than Linux and/or want to monitor the traffic of an entire network at once, you should be using <strong>libnids</strong> in order to handle fragmented IP packets.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMPILE-TIME DEFAULTS</h2>
        <div class="sectioncontent">
<p>At least 7 different privileged or 21 non-privileged ports, or a weighted combination of those, have to be accessed with no longer than 3 seconds between the accesses to be treated as a scan. If more than 5 scans are detected within 20 seconds, that event will be logged and logging will be stopped temporarily.</p><p>Logging is done with a facility of <strong>daemon</strong> and a priority level <strong>alert</strong>.</p><p><strong>scanlogd</strong> should be started as root since it needs access to a packet capture interface. By default, it chroots to <em>/var/empty</em> and switches to running as user <strong>scanlogd</strong> after the packet capture interface is initialized.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">
<p>If the daemon couldn't start up successfully, it will exit with a status of 1.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE</h2>
        <div class="sectioncontent">
<p>You're expected to create a dummy user for <strong>scanlogd</strong> to run as. Make sure you allocate unique UID and GID to the user.</p><p>In most cases, <strong>scanlogd</strong> should be started from a rc.d script on system startup.</p><p>In /etc/syslog.conf you may use something like:</p><p>daemon.alert	/var/log/alert</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SECURITY NOTES</h2>
        <div class="sectioncontent">
<p>As the name indicates, <strong>scanlogd</strong> only logs port scans. <strong>It does not prevent them.</strong> You will only receive summarized information in the system's log.</p><p>Obviously, the source address of port scans can be spoofed. <strong>Don't take any action against the source of attacks</strong> <strong>unless other evidence is available.</strong> Sometimes IP addresses are shared between many people; this is the case for ISP shell servers, dynamic dialup pools, and corporate networks behind NAT (masquerading).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Due to the nature of port scans, both false positives (detecting a scan when there isn't one) and false negatives (not detecting a scan when there's one) are possible. In particular, false positives occur when many small files are transferred rapidly with passive mode FTP.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">

<pre>
Solar Designer &lt;solar at openwall.com&gt;
</pre>
<p>Steffen Dettmer &lt;steffen at dett.de&gt; wrote the initial version of this manual page.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO scanlogd&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man3/syslog.3.html"><strong>syslog</strong>(3)</a>, <strong>syslog.conf</strong>(5), <a href="../man3/libnids.3.html"><strong>libnids</strong>(3)</a>, <strong>pcap</strong>(3)</p>
<pre>
<strong>scanlogd</strong> home page: http://www.openwall.com/scanlogd/
<strong>Phrack Magazine</strong>, issue 53, article 13
</pre>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="scanbm.8.html"><span aria-hidden="true">&larr;</span> scanbm.8: Scanbm- user scanning support daemon for scanbd / scanbd manager</a></li>
   <li class="next"><a href="scanlogs.8.html">scanlogs.8: Summarize inn log files. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
