<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>lseek - reposition read/write file offset</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Reposition read/write file offset">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">lseek<small> (2)</small></h1>
        <p class="lead">Reposition read/write file offset</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man2/">
      <span itemprop="name">System calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man2/lseek.2.html">
      <span itemprop="name">lseek</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/man-pages/">
      <span itemprop="name">man-pages</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p><strong>#include &lt;sys/types.h&gt;</strong></p>
<p class='spacer'>

<p><strong>#include &lt;unistd.h&gt;</strong></p>
<p class='spacer'>

<p><strong>off_t lseek(int </strong><em>fd</em><strong>, off_t </strong><em>offset</em><strong>, int </strong><em>whence</em><strong>);</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

  <p>The <strong>lseek</strong>() function repositions the file offset of the open file description associated with the file descriptor <em>fd</em> to the argument <em>offset</em> according to the directive <em>whence</em> as follows:</p>
  <dl class='dl-vertical'>
    <dt><strong>SEEK_SET</strong></dt>
    <dd>
  <p>The file offset is set to <em>offset</em> bytes.</p>
    </dd>
    <dt><strong>SEEK_CUR</strong></dt>
    <dd>
  <p>The file offset is set to its current location plus <em>offset</em> bytes.</p>
    </dd>
    <dt><strong>SEEK_END</strong></dt>
    <dd>
  <p>The file offset is set to the size of the file plus <em>offset</em> bytes.</p>
    </dd>
  </dl>
<p class='spacer'>

<p>The <strong>lseek</strong>() function allows the file offset to be set beyond the end of the file (but this does not change the size of the file). If data is later written at this point, subsequent reads of the data in the gap (a "hole") return null bytes (&apos;nbsp;&apos;) until data is actually written into the gap.</p>
  <h3>Seeking file data and holes</h3>
  <p>Since version 3.1, Linux supports the following additional values for <em>whence</em>:</p>
  <dl class='dl-vertical'>
    <dt><strong>SEEK_DATA</strong></dt>
    <dd>
  <p>Adjust the file offset to the next location in the file greater than or equal to <em>offset</em> containing data. If <em>offset</em> points to data, then the file offset is set to <em>offset</em>.</p>
    </dd>
    <dt><strong>SEEK_HOLE</strong></dt>
    <dd>
  <p>Adjust the file offset to the next hole in the file greater than or equal to <em>offset</em>. If <em>offset</em> points into the middle of a hole, then the file offset is set to <em>offset</em>. If there is no hole past <em>offset</em>, then the file offset is adjusted to the end of the file (i.e., there is an implicit hole at the end of any file).</p>
    </dd>
  </dl>
<p class='spacer'>

<p>In both of the above cases, <strong>lseek</strong>() fails if <em>offset</em> points past the end of the file.</p>
<p class='spacer'>

<p>These operations allow applications to map holes in a sparsely allocated file. This can be useful for applications such as file backup tools, which can save space when creating backups and preserve holes, if they have a mechanism for discovering holes.</p>
<p class='spacer'>

<p>For the purposes of these operations, a hole is a sequence of zeros that (normally) has not been allocated in the underlying file storage. However, a filesystem is not obliged to report holes, so these operations are not a guaranteed mechanism for mapping the storage space actually allocated to a file. (Furthermore, a sequence of zeros that actually has been written to the underlying storage may not be reported as a hole.) In the simplest implementation, a filesystem can support the operations by making <strong>SEEK_HOLE</strong> always return the offset of the end of the file, and making <strong>SEEK_DATA</strong> always return <em>offset</em> (i.e., even if the location referred to by <em>offset</em> is a hole, it can be considered to consist of data that is a sequence of zeros).</p>
<p class='spacer'>

<p>The <strong>_GNU_SOURCE</strong> feature test macro must be defined in order to obtain the definitions of <strong>SEEK_DATA</strong> and <strong>SEEK_HOLE</strong> from <em>&lt;unistd.h&gt;</em>.</p>
<p class='spacer'>

  <p>The <strong>SEEK_HOLE</strong> and <strong>SEEK_DATA</strong> operations are supported for the following filesystems:</p>
  <dl class='dl-horizontal'>
    <dt>*</dt>
    <dd>
  <p>Btrfs (since Linux 3.1)</p>
    </dd>
    <dt>*</dt>
    <dd>
  <p>OCFS (since Linux 3.2)</p>
    </dd>
    <dt>*</dt>
    <dd>
  <p>XFS (since Linux 3.5)</p>
    </dd>
    <dt>*</dt>
    <dd>
  <p>ext4 (since Linux 3.8)</p>
    </dd>
    <dt>*</dt>
    <dd>
  <p>tmpfs (since Linux 3.8)</p>
    </dd>
    <dt>*</dt>
    <dd>
  <p>NFS (since Linux 3.18)</p>
    </dd>
    <dt>*</dt>
    <dd>
  <p>FUSE (since Linux 4.5)</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">

<p>Upon successful completion, <strong>lseek</strong>() returns the resulting offset location as measured in bytes from the beginning of the file. On error, the value <em>(off_t)&nbsp;-1</em> is returned and <em>errno</em> is set to indicate the error.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">

  <dl class='dl-vertical'>
    <dt><strong>EBADF</strong></dt>
    <dd>
  <p><em>fd</em> is not an open file descriptor.</p>
    </dd>
    <dt><strong>EINVAL</strong></dt>
    <dd>
  <p><em>whence</em> is not valid. Or: the resulting file offset would be negative, or beyond the end of a seekable device.</p>
    </dd>
    <dt><strong>EOVERFLOW</strong></dt>
    <dd>
  <p>The resulting file offset cannot be represented in an <em>off_t</em>.</p>
    </dd>
    <dt><strong>ESPIPE</strong></dt>
    <dd>
  <p><em>fd</em> is associated with a pipe, socket, or FIFO.</p>
    </dd>
    <dt><strong>ENXIO</strong></dt>
    <dd>
  <p><em>whence</em> is <strong>SEEK_DATA</strong> or <strong>SEEK_HOLE</strong>, and the file offset is beyond the end of the file.</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFORMING TO</h2>
        <div class="sectioncontent">

<p>POSIX.1-2001, POSIX.1-2008, SVr4, 4.3BSD.</p>
<p class='spacer'>

<p><strong>SEEK_DATA</strong> and <strong>SEEK_HOLE</strong> are nonstandard extensions also present in Solaris, FreeBSD, and DragonFly BSD; they are proposed for inclusion in the next POSIX revision (Issue 8).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<p>See <a href="../man2/open.2.html"><strong>open</strong>(2)</a> for a discussion of the relationship between file descriptors, open file descriptions, and files.</p>
<p class='spacer'>

<p>The <em>off_t</em> data type is a signed integer data type specified by POSIX.1.</p>
<p class='spacer'>

<p>Some devices are incapable of seeking and POSIX does not specify which devices must support <strong>lseek</strong>().</p>
<p class='spacer'>

<p>On Linux, using <strong>lseek</strong>() on a terminal device returns <strong>ESPIPE</strong>.</p>
<p class='spacer'>

<p>When converting old code, substitute values for <em>whence</em> with the following macros:</p>
<table class="table table-striped">
<tr>
<th>old</th>
<th>new</th></tr>

<tr>
<td>0</td>
<td>SEEK_SET</td></tr>

<tr>
<td>1</td>
<td>SEEK_CUR</td></tr>

<tr>
<td>2</td>
<td>SEEK_END</td></tr>

<tr>
<td>L_SET</td>
<td>SEEK_SET</td></tr>

<tr>
<td>L_INCR</td>
<td>SEEK_CUR</td></tr>

<tr>
<td>L_XTND</td>
<td>SEEK_END</td></tr>
</table>

<p class='spacer'>

<p>Note that file descriptors created by <a href="../man2/dup.2.html"><strong>dup</strong>(2)</a> or <a href="../man2/fork.2.html"><strong>fork</strong>(2)</a> refer to the same open file descriptions (and thus file offsets), so seeking on such files may be subject to race conditions.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<p><a href="../man2/dup.2.html"><strong>dup</strong>(2)</a>, <a href="../man2/fork.2.html"><strong>fork</strong>(2)</a>, <a href="../man2/open.2.html"><strong>open</strong>(2)</a>, <a href="../man3/fseek.3.html"><strong>fseek</strong>(3)</a>, <a href="../man3/lseek64.3.html"><strong>lseek64</strong>(3)</a>, <a href="../man3/posix_fallocate.3.html"><strong>posix_fallocate</strong>(3)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="lremovexattr.2.html"><span aria-hidden="true">&larr;</span> lremovexattr.2: remove an extended attribute</a></li>
   <li class="next"><a href="lsetxattr.2.html">lsetxattr.2: set an extended attribute value <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
