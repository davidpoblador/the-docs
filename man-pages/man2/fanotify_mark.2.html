<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>fanotify_mark: Add, remove, or modify an fanotify mark on a filesystem object</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Add, remove, or modify an fanotify mark on a filesystem object">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="fanotify_mark (2) manual">
  <meta name="twitter:description" content="Add, remove, or modify an fanotify mark on a filesystem object">
  <meta name="twitter:image" content="https://www.carta.tech/images/manpages-dev-fanotify_mark-2.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man2/fanotify_mark.2.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="fanotify_mark (2) manual" />
  <meta property="og:description" content="Add, remove, or modify an fanotify mark on a filesystem object" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/manpages-dev-fanotify_mark-2.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">fanotify_mark<small> (2)</small></h1>
        <p class="lead">Add, remove, or modify an fanotify mark on a filesystem object</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man2/">
      <span itemprop="name">System calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man2/fanotify_mark.2.html">
      <span itemprop="name">fanotify_mark: Add, remove, or modify an fanotify mark on a filesystem object</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/manpages-dev/">
      <span itemprop="name">manpages-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man2/fanotify_mark.2.html">
      <span itemprop="name">fanotify_mark: Add, remove, or modify an fanotify mark on a filesystem object</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>#include &lt;sys/fanotify.h&gt;</strong>

<strong>int fanotify_mark(int </strong><em>fanotify_fd</em><strong>, unsigned int </strong><em>flags</em><strong>,</strong>
<strong>                  uint64_t </strong><em>mask</em><strong>, int </strong><em>dirfd</em><strong>, const char *</strong><em>pathname</em><strong>);</strong>
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>For an overview of the fanotify API, see <a href="../man7/fanotify.7.html"><strong>fanotify</strong>(7)</a>.</p><p><a href="../man2/fanotify_mark.2.html"><strong>fanotify_mark</strong>(2)</a> adds, removes, or modifies an fanotify mark on a filesystem object. The caller must have read permission on the filesystem object that is to be marked.</p><p>The <em>fanotify_fd</em> argument is a file descriptor returned by <a href="../man2/fanotify_init.2.html"><strong>fanotify_init</strong>(2)</a>.</p><p><em>flags</em> is a bit mask describing the modification to perform. It must include exactly one of the following values:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>FAN_MARK_ADD</strong></p>
  </dt>
  <dd>
    <p>The events in <em>mask</em> will be added to the mark mask (or to the ignore mask). <em>mask</em> must be nonempty or the error <strong>EINVAL</strong> will occur.</p>
  </dd>
  <dt>
    <p><strong>FAN_MARK_REMOVE</strong></p>
  </dt>
  <dd>
    <p>The events in argument <em>mask</em> will be removed from the mark mask (or from the ignore mask). <em>mask</em> must be nonempty or the error <strong>EINVAL</strong> will occur.</p>
  </dd>
  <dt>
    <p><strong>FAN_MARK_FLUSH</strong></p>
  </dt>
  <dd>
    <p>Remove either all mount or all non-mount marks from the fanotify group. If <em>flag</em> contains <strong>FAN_MARK_MOUNT</strong>, all marks for mounts are removed from the group. Otherwise, all marks for directories and files are removed. No flag other than <strong>FAN_MARK_MOUNT</strong> can be used in conjunction with <strong>FAN_MARK_FLUSH</strong>. <em>mask</em> is ignored.</p>
  </dd>

</dl>
<p>If none of the values above is specified, or more than one is specified, the call fails with the error <strong>EINVAL</strong>.</p><p>In addition, zero or more of the following values may be ORed into <em>flags</em>:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>FAN_MARK_DONT_FOLLOW</strong></p>
  </dt>
  <dd>
    <p>If <em>pathname</em> is a symbolic link, mark the link itself, rather than the file to which it refers. (By default, <strong>fanotify_mark</strong>() dereferences <em>pathname</em> if it is a symbolic link.)</p>
  </dd>
  <dt>
    <p><strong>FAN_MARK_ONLYDIR</strong></p>
  </dt>
  <dd>
    <p>If the filesystem object to be marked is not a directory, the error <strong>ENOTDIR</strong> shall be raised.</p>
  </dd>
  <dt>
    <p><strong>FAN_MARK_MOUNT</strong></p>
  </dt>
  <dd>
    <p>Mark the mount point specified by <em>pathname</em>. If <em>pathname</em> is not itself a mount point, the mount point containing <em>pathname</em> will be marked. All directories, subdirectories, and the contained files of the mount point will be monitored.</p>
  </dd>
  <dt>
    <p><strong>FAN_MARK_IGNORED_MASK</strong></p>
  </dt>
  <dd>
    <p>The events in <em>mask</em> shall be added to or removed from the ignore mask.</p>
  </dd>
  <dt>
    <p><strong>FAN_MARK_IGNORED_SURV_MODIFY</strong></p>
  </dt>
  <dd>
    <p>The ignore mask shall survive modify events. If this flag is not set, the ignore mask is cleared when a modify event occurs for the ignored file or directory.</p>
  </dd>

</dl>
<p><em>mask</em> defines which events shall be listened for (or which shall be ignored). It is a bit mask composed of the following values:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>FAN_ACCESS</strong></p>
  </dt>
  <dd>
    <p>Create an event when a file or directory (but see BUGS) is accessed (read).</p>
  </dd>
  <dt>
    <p><strong>FAN_MODIFY</strong></p>
  </dt>
  <dd>
    <p>Create an event when a file is modified (write).</p>
  </dd>
  <dt>
    <p><strong>FAN_CLOSE_WRITE</strong></p>
  </dt>
  <dd>
    <p>Create an event when a writable file is closed.</p>
  </dd>
  <dt>
    <p><strong>FAN_CLOSE_NOWRITE</strong></p>
  </dt>
  <dd>
    <p>Create an event when a read-only file or directory is closed.</p>
  </dd>
  <dt>
    <p><strong>FAN_OPEN</strong></p>
  </dt>
  <dd>
    <p>Create an event when a file or directory is opened.</p>
  </dd>
  <dt>
    <p><strong>FAN_OPEN_PERM</strong></p>
  </dt>
  <dd>
    <p>Create an event when a permission to open a file or directory is requested. An fanotify file descriptor created with <strong>FAN_CLASS_PRE_CONTENT</strong> or <strong>FAN_CLASS_CONTENT</strong> is required.</p>
  </dd>
  <dt>
    <p><strong>FAN_ACCESS_PERM</strong></p>
  </dt>
  <dd>
    <p>Create an event when a permission to read a file or directory is requested. An fanotify file descriptor created with <strong>FAN_CLASS_PRE_CONTENT</strong> or <strong>FAN_CLASS_CONTENT</strong> is required.</p>
  </dd>
  <dt>
    <p><strong>FAN_ONDIR</strong></p>
  </dt>
  <dd>
    <p>Create events for directories&ndash;for example, when <strong>opendir</strong>(2), <a href="../man2/readdir.2.html"><strong>readdir</strong>(2)</a> (but see BUGS), and <strong>closedir</strong>(2) are called. Without this flag, only events for files are created.</p>
  </dd>
  <dt>
    <p><strong>FAN_EVENT_ON_CHILD</strong></p>
  </dt>
  <dd>
    <p>Events for the immediate children of marked directories shall be created. The flag has no effect when marking mounts. Note that events are not generated for children of the subdirectories of marked directories. To monitor complete directory trees it is necessary to mark the relevant mount.</p>
  </dd>

</dl>
<p>The following composed value is defined:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>FAN_CLOSE</strong></p>
  </dt>
  <dd>
    <p>A file is closed (<strong>FAN_CLOSE_WRITE</strong>|<strong>FAN_CLOSE_NOWRITE</strong>).</p>
  </dd>

</dl>
<p>The filesystem object to be marked is determined by the file descriptor <em>dirfd</em> and the pathname specified in <em>pathname</em>:</p><ul>
<li><p>If <em>pathname</em> is NULL, <em>dirfd</em> defines the filesystem object to be marked.</p></li><li><p>If <em>pathname</em> is NULL, and <em>dirfd</em> takes the special value <strong>AT_FDCWD</strong>, the current working directory is to be marked.</p></li><li><p>If <em>pathname</em> is absolute, it defines the filesystem object to be marked, and <em>dirfd</em> is ignored.</p></li><li><p>If <em>pathname</em> is relative, and <em>dirfd</em> does not have the value <strong>AT_FDCWD</strong>, then the filesystem object to be marked is determined by interpreting <em>pathname</em> relative the directory referred to by <em>dirfd</em>.</p></li><li><p>If <em>pathname</em> is relative, and <em>dirfd</em> has the value <strong>AT_FDCWD</strong>, then the filesystem object to be marked is determined by interpreting <em>pathname</em> relative the current working directory.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>On success, <strong>fanotify_mark</strong>() returns 0. On error, -1 is returned, and <em>errno</em> is set to indicate the error.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>EBADF</strong></p>
  </dt>
  <dd>
    <p>An invalid file descriptor was passed in <em>fanotify_fd</em>.</p>
  </dd>
  <dt>
    <p><strong>EINVAL</strong></p>
  </dt>
  <dd>
    <p>An invalid value was passed in <em>flags</em> or <em>mask</em>, or <em>fanotify_fd</em> was not an fanotify file descriptor.</p>
  </dd>
  <dt>
    <p><strong>EINVAL</strong></p>
  </dt>
  <dd>
    <p>The fanotify file descriptor was opened with <strong>FAN_CLASS_NOTIF</strong> and mask contains a flag for permission events (<strong>FAN_OPEN_PERM</strong> or <strong>FAN_ACCESS_PERM</strong>).</p>
  </dd>
  <dt>
    <p><strong>ENOENT</strong></p>
  </dt>
  <dd>
    <p>The filesystem object indicated by <em>dirfd</em> and <em>pathname</em> does not exist. This error also occurs when trying to remove a mark from an object which is not marked.</p>
  </dd>
  <dt>
    <p><strong>ENOMEM</strong></p>
  </dt>
  <dd>
    <p>The necessary memory could not be allocated.</p>
  </dd>
  <dt>
    <p><strong>ENOSPC</strong></p>
  </dt>
  <dd>
    <p>The number of marks exceeds the limit of 8192 and the <strong>FAN_UNLIMITED_MARKS</strong> flag was not specified when the fanotify file descriptor was created with <a href="../man2/fanotify_init.2.html"><strong>fanotify_init</strong>(2)</a>.</p>
  </dd>
  <dt>
    <p><strong>ENOSYS</strong></p>
  </dt>
  <dd>
    <p>This kernel does not implement <strong>fanotify_mark</strong>(). The fanotify API is available only if the kernel was configured with <strong>CONFIG_FANOTIFY</strong>.</p>
  </dd>
  <dt>
    <p><strong>ENOTDIR</strong></p>
  </dt>
  <dd>
    <p><em>flags</em> contains <strong>FAN_MARK_ONLYDIR</strong>, and <em>dirfd</em> and <em>pathname</em> do not specify a directory.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VERSIONS</h2>
        <div class="sectioncontent">
<p><strong>fanotify_mark</strong>() was introduced in version 2.6.36 of the Linux kernel and enabled in version 2.6.37.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFORMING TO</h2>
        <div class="sectioncontent">
<p>This system call is Linux-specific.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>The following bugs were present in Linux kernels before version 3.16:</p><ul>
<li><p>If <em>flags</em> contains <strong>FAN_MARK_FLUSH</strong>, <em>dirfd</em> and <em>pathname</em> must specify a valid filesystem object, even though this object is not used.</p></li><li><p><a href="../man2/readdir.2.html"><strong>readdir</strong>(2)</a> does not generate a <strong>FAN_ACCESS</strong> event.</p></li><li><p>If <a href="../man2/fanotify_mark.2.html"><strong>fanotify_mark</strong>(2)</a> is called with <strong>FAN_MARK_FLUSH</strong>, <em>flags</em> is not checked for invalid values.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO fanotify_mark&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man2/fanotify_init.2.html"><strong>fanotify_init</strong>(2)</a>, <a href="../man7/fanotify.7.html"><strong>fanotify</strong>(7)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COLOPHON</h2>
        <div class="sectioncontent">
<p>This page is part of release 3.74 of the Linux <em>man-pages</em> project. A description of the project, information about reporting bugs, and the latest version of this page, can be found at http://www.kernel.org/doc/man-pages/.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="fanotify_init.2.html"><span aria-hidden="true">&larr;</span> fanotify_init.2: Create and initialize fanotify group</a></li>
   <li class="next"><a href="fattach.2.html">fattach.2: Unimplemented system calls <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
