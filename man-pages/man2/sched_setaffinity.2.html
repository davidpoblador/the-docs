<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>sched_setaffinity: Set and get a thread's cpu affinity mask</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Set and get a thread's cpu affinity mask">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="sched_setaffinity (2) manual">
  <meta name="twitter:description" content="Set and get a thread's cpu affinity mask">
  <meta name="twitter:image" content="https://www.carta.tech/images/manpages-dev-sched_setaffinity-2.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man2/sched_setaffinity.2.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="sched_setaffinity (2) manual" />
  <meta property="og:description" content="Set and get a thread's cpu affinity mask" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/manpages-dev-sched_setaffinity-2.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">sched_setaffinity<small> (2)</small></h1>
        <p class="lead">Set and get a thread's cpu affinity mask</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man2/">
      <span itemprop="name">System calls</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man2/sched_setaffinity.2.html">
      <span itemprop="name">sched_setaffinity: Set and get a thread's cpu affinity mask</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/manpages-dev/">
      <span itemprop="name">manpages-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man2/sched_setaffinity.2.html">
      <span itemprop="name">sched_setaffinity: Set and get a thread's cpu affinity mask</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
<strong>#define _GNU_SOURCE</strong>             /* See <a href="../man7/feature_test_macros.7.html"><strong>feature_test_macros</strong>(7)</a> */
<strong>#include &lt;sched.h&gt;</strong>

<strong>int sched_setaffinity(pid_t </strong><em>pid</em><strong>, size_t </strong><em>cpusetsize</em><strong>,</strong>
<strong>                      const cpu_set_t *</strong><em>mask</em><strong>);</strong>

<strong>int sched_getaffinity(pid_t </strong><em>pid</em><strong>, size_t </strong><em>cpusetsize</em><strong>,</strong>
<strong>                      cpu_set_t *</strong><em>mask</em><strong>);</strong>
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>A thread's CPU affinity mask determines the set of CPUs on which it is eligible to run. On a multiprocessor system, setting the CPU affinity mask can be used to obtain performance benefits. For example, by dedicating one CPU to a particular thread (i.e., setting the affinity mask of that thread to specify a single CPU, and setting the affinity mask of all other threads to exclude that CPU), it is possible to ensure maximum execution speed for that thread. Restricting a thread to run on a single CPU also avoids the performance cost caused by the cache invalidation that occurs when a thread ceases to execute on one CPU and then recommences execution on a different CPU.</p><p>A CPU affinity mask is represented by the <em>cpu_set_t</em> structure, a "CPU set", pointed to by <em>mask</em>. A set of macros for manipulating CPU sets is described in <a href="../man3/CPU_SET.3.html"><strong>CPU_SET</strong>(3)</a>.</p><p><strong>sched_setaffinity</strong>() sets the CPU affinity mask of the thread whose ID is <em>pid</em> to the value specified by <em>mask</em>. If <em>pid</em> is zero, then the calling thread is used. The argument <em>cpusetsize</em> is the length (in bytes) of the data pointed to by <em>mask</em>. Normally this argument would be specified as <em>sizeof(cpu_set_t)</em>.</p><p>If the thread specified by <em>pid</em> is not currently running on one of the CPUs specified in <em>mask</em>, then that thread is migrated to one of the CPUs specified in <em>mask</em>.</p><p><strong>sched_getaffinity</strong>() writes the affinity mask of the thread whose ID is <em>pid</em> into the <em>cpu_set_t</em> structure pointed to by <em>mask</em>. The <em>cpusetsize</em> argument specifies the size (in bytes) of <em>mask</em>. If <em>pid</em> is zero, then the mask of the calling thread is returned.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RETURN VALUE</h2>
        <div class="sectioncontent">
<p>On success, <strong>sched_setaffinity</strong>() and <strong>sched_getaffinity</strong>() return 0. On error, -1 is returned, and <em>errno</em> is set appropriately.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ERRORS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>EFAULT</strong></p>
  </dt>
  <dd>
    <p>A supplied memory address was invalid.</p>
  </dd>
  <dt>
    <p><strong>EINVAL</strong></p>
  </dt>
  <dd>
    <p>The affinity bit mask <em>mask</em> contains no processors that are currently physically on the system and permitted to the thread according to any restrictions that may be imposed by the "cpuset" mechanism described in <a href="../man7/cpuset.7.html"><strong>cpuset</strong>(7)</a>.</p>
  </dd>
  <dt>
    <p><strong>EINVAL</strong></p>
  </dt>
  <dd>
    <p>(<strong>sched_getaffinity</strong>() and, in kernels before 2.6.9, <strong>sched_setaffinity</strong>()) <em>cpusetsize</em> is smaller than the size of the affinity mask used by the kernel.</p>
  </dd>
  <dt>
    <p><strong>EPERM</strong></p>
  </dt>
  <dd>
    <p>(<strong>sched_setaffinity</strong>()) The calling thread does not have appropriate privileges. The caller needs an effective user ID equal to the real user ID or effective user ID of the thread identified by <em>pid</em>, or it must possess the <strong>CAP_SYS_NICE</strong> capability.</p>
  </dd>
  <dt>
    <p><strong>ESRCH</strong></p>
  </dt>
  <dd>
    <p>The thread whose ID is <em>pid</em> could not be found.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VERSIONS</h2>
        <div class="sectioncontent">
<p>The CPU affinity system calls were introduced in Linux kernel 2.5.8. The system call wrappers were introduced in glibc 2.3. Initially, the glibc interfaces included a <em>cpusetsize</em> argument, typed as <em>unsigned int</em>. In glibc 2.3.3, the <em>cpusetsize</em> argument was removed, but was then restored in glibc 2.3.4, with type <em>size_t</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFORMING TO</h2>
        <div class="sectioncontent">
<p>These system calls are Linux-specific.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>After a call to <strong>sched_setaffinity</strong>(), the set of CPUs on which the thread will actually run is the intersection of the set specified in the <em>mask</em> argument and the set of CPUs actually present on the system. The system may further restrict the set of CPUs on which the thread runs if the "cpuset" mechanism described in <a href="../man7/cpuset.7.html"><strong>cpuset</strong>(7)</a> is being used. These restrictions on the actual set of CPUs on which the thread will run are silently imposed by the kernel.</p><p><a href="../man7/sched.7.html"><strong>sched</strong>(7)</a> has a description of the Linux scheduling scheme.</p><p>The affinity mask is a per-thread attribute that can be adjusted independently for each of the threads in a thread group. The value returned from a call to <a href="../man2/gettid.2.html"><strong>gettid</strong>(2)</a> can be passed in the argument <em>pid</em>. Specifying <em>pid</em> as 0 will set the attribute for the calling thread, and passing the value returned from a call to <a href="../man2/getpid.2.html"><strong>getpid</strong>(2)</a> will set the attribute for the main thread of the thread group. (If you are using the POSIX threads API, then use <a href="../man3/pthread_setaffinity_np.3.html"><strong>pthread_setaffinity_np</strong>(3)</a> instead of <strong>sched_setaffinity</strong>().)</p><p>A child created via <a href="../man2/fork.2.html"><strong>fork</strong>(2)</a> inherits its parent's CPU affinity mask. The affinity mask is preserved across an <a href="../man2/execve.2.html"><strong>execve</strong>(2)</a>.</p><h3>C library/kernel ABI differences</h3>
<p>This manual page describes the glibc interface for the CPU affinity calls. The actual system call interface is slightly different, with the <em>mask</em> being typed as <em>unsigned long&nbsp;*</em>, reflecting the fact that the underlying implementation of CPU sets is a simple bit mask. On success, the raw <strong>sched_getaffinity</strong>() system call returns the size (in bytes) of the <em>cpumask_t</em> data type that is used internally by the kernel to represent the CPU set bit mask.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO sched_setaffinity&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/taskset.1.html"><strong>taskset</strong>(1)</a>, <a href="../man2/clone.2.html"><strong>clone</strong>(2)</a>, <a href="../man2/getcpu.2.html"><strong>getcpu</strong>(2)</a>, <a href="../man2/getpriority.2.html"><strong>getpriority</strong>(2)</a>, <a href="../man2/gettid.2.html"><strong>gettid</strong>(2)</a>, <a href="../man2/nice.2.html"><strong>nice</strong>(2)</a>, <a href="../man2/sched_get_priority_max.2.html"><strong>sched_get_priority_max</strong>(2)</a>, <a href="../man2/sched_get_priority_min.2.html"><strong>sched_get_priority_min</strong>(2)</a>, <a href="../man2/sched_getscheduler.2.html"><strong>sched_getscheduler</strong>(2)</a>, <a href="../man2/sched_setscheduler.2.html"><strong>sched_setscheduler</strong>(2)</a>, <a href="../man2/setpriority.2.html"><strong>setpriority</strong>(2)</a>, <a href="../man3/CPU_SET.3.html"><strong>CPU_SET</strong>(3)</a>, <a href="../man3/pthread_setaffinity_np.3.html"><strong>pthread_setaffinity_np</strong>(3)</a>, <a href="../man3/sched_getcpu.3.html"><strong>sched_getcpu</strong>(3)</a>, <a href="../man7/capabilities.7.html"><strong>capabilities</strong>(7)</a>, <a href="../man7/cpuset.7.html"><strong>cpuset</strong>(7)</a>, <a href="../man7/sched.7.html"><strong>sched</strong>(7)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COLOPHON</h2>
        <div class="sectioncontent">
<p>This page is part of release 3.74 of the Linux <em>man-pages</em> project. A description of the project, information about reporting bugs, and the latest version of this page, can be found at http://www.kernel.org/doc/man-pages/.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="sched_rr_get_interval.2.html"><span aria-hidden="true">&larr;</span> sched_rr_get_interval.2: Get the sched_rr interval for the named process</a></li>
   <li class="next"><a href="sched_setattr.2.html">sched_setattr.2: Set and get scheduling policy and attributes <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
