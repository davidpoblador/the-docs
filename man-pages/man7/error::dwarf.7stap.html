<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>error::dwarf: Dwarf debuginfo quality problems</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Dwarf debuginfo quality problems">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="error::dwarf (7stap) manual">
  <meta name="twitter:description" content="Dwarf debuginfo quality problems">
  <meta name="twitter:image" content="https://www.carta.tech/images/systemtap-doc-error::dwarf-7stap.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man7stap/error::dwarf.7stap.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="error::dwarf (7stap) manual" />
  <meta property="og:description" content="Dwarf debuginfo quality problems" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/systemtap-doc-error::dwarf-7stap.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">error::dwarf<small> (7stap)</small></h1>
        <p class="lead">Dwarf debuginfo quality problems</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7stap/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7stap/error::dwarf.7stap.html">
      <span itemprop="name">error::dwarf: Dwarf debuginfo quality problems</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/systemtap-doc/">
      <span itemprop="name">systemtap-doc</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7stap/error::dwarf.7stap.html">
      <span itemprop="name">error::dwarf: Dwarf debuginfo quality problems</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Systemtap sometimes relies on ELF/DWARF debuginfo for programs being instrumented to locate places to probe, or context variables to read/write, just like a symbolic debugger does.  Even though examination of the program's source code may show variables or lines where probes may be desired, the compiler must preserve information about them for systemtap (or a debugger such as gdb) to get pinpoint access to the desired information.  If a script requires such data, but the compiler did not preserve enough of it, pass-2 errors may result.</p><p>Common conditions that trigger these problems include;</p>
<dl class='dl-vertical'>
  <dt>
    <p>compiler version</p>
  </dt>
  <dd>
    <p>Prior to GCC version 4.5, debuginfo quality was fairly limited. Often developers were advised to build their programs with <em>-O0 -g</em> flags to disable optimization.  GCC version 4.5 introduced a facility called "variable-tracking assignments" that allows it to generate high-quality debuginfo under full <em>-O2 -g</em> optimization.  It is not perfect, but much better than before. Note that, due to another gcc bug (PR51358) <em>-O0 -g</em> can actually sometimes make debuginfo quality worse than for <em>-O2 -g</em>.</p><p>Another related problem involves debuginfo quality for the prologue area of a function (PR15123), wherein a program compiled with CFLAGS=-mfentry (especially the kernel, for ftrace) may lack accurate debuginfo for the entry instructions for gcc prior to version 4.8.  If able, arrange to compile your programs with <em>-grecord-gcc-switches</em> CFLAGS, and/or try rerunning systemtap with <em>$PR15123_ASSUME_MFENTRY=1</em>.</p>
  </dd>
  <dt>
    <p>function inlining</p>
  </dt>
  <dd>
    <p>Even modern gcc sometimes has problems with parameters for inlined functions. It may be necessary to change the script to probe at a slightly different place (try a <em>.statement()</em> probe, instead of a <em>.function()</em> probe, somewhere a few source lines into the body of the inlined function.  Or try putting a probe at the call site of the inlined function.  Or use the <em>if @defined($var) { ... }</em> script language construct to test for the resolvability of the context variable before using it.</p>
  </dd>
  <dt>
    <p>instruction reordering</p>
  </dt>
  <dd>
    <p>Heavily optimized code often smears the instructions from multiple source statements together.  This can leave systemtap with no place to choose to place a probe, especially a statement probe specified by line number.  Systemtap may advise to try a nearby line number, but these may not work well either.  Consider placing a probe by a statement wildcard or line number range.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ALTERNATIVES</h2>
        <div class="sectioncontent">
<p>In order to reduce reliance on ELF/DWARF debuginfo, consider the use of statically compiled-in instrumentation, such as kernel tracepoints, or <em>&lt;sys/sdt.h&gt;</em> userspace markers.  Such instrumentation hook sites are relatively low cost (just one NOP instruction for sdt.h), and nearly guarantee the availability of parameter data and a reliable probe site, all without reliance on debuginfo.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO error::dwarf&hellip;</h2>
        <div class="sectioncontent">

<pre>
<a href="../man1/stap.1.html"><strong>stap</strong>(1)</a>,
<em>http://dwarfstd.org/</em>,
<em>http://sourceware.org/systemtap/wiki/TipContextVariables</em>,
<em>http://gcc.gnu.org/wiki/Var_Tracking_Assignments</em>,
<em>warning::debuginfo</em>(7stap),
<em>error::reporting</em>(7stap)
</pre>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="error::buildid.7stap.html"><span aria-hidden="true">&larr;</span> error::buildid.7stap: Build-id verification failures</a></li>
   <li class="next"><a href="error::fault.7stap.html">error::fault.7stap: Memory access faults <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
