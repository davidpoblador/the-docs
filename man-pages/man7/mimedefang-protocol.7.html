<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>mimedefang-protocol: Conventions used by mimedefang(8) to communicate with filter programs.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Conventions used by mimedefang(8) to communicate with filter programs.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="mimedefang-protocol (7) manual">
  <meta name="twitter:description" content="Conventions used by mimedefang(8) to communicate with filter programs.">
  <meta name="twitter:image" content="https://www.carta.tech/images/mimedefang-mimedefang-protocol-7.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man7/mimedefang-protocol.7.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="mimedefang-protocol (7) manual" />
  <meta property="og:description" content="Conventions used by mimedefang(8) to communicate with filter programs." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/mimedefang-mimedefang-protocol-7.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">mimedefang-protocol<small> (7)</small></h1>
        <p class="lead">Conventions used by mimedefang(8) to communicate with filter programs.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/">
      <span itemprop="name">Miscellaneous</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/mimedefang-protocol.7.html">
      <span itemprop="name">mimedefang-protocol: Conventions used by mimedefang(8) to communicate with filter programs.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/mimedefang/">
      <span itemprop="name">mimedefang</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/mimedefang-protocol.7.html">
      <span itemprop="name">mimedefang-protocol: Conventions used by mimedefang(8) to communicate with filter programs.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><a href="../man8/mimedefang.8.html"><strong>mimedefang</strong>(8)</a> and <a href="../man8/mimedefang-multiplexor.8.html"><strong>mimedefang-multiplexor</strong>(8)</a> provide a simplified mechanism for hooking scripts and programs into Sendmail's milter API.</p><p>The milter API is multi-threaded and written in C; <strong>mimedefang</strong> lets you write single-threaded filters written in the language of your choice.  Some of the flexibility and speed of milter is sacrificed, but the ease of writing filters more than compensates for this slight loss.</p><p>This manual describes how <strong>mimedefang</strong> communicates with the filter program, and gives you enough information to write your own filter program as a replacement for <strong>mimedefang.pl</strong> if you wish.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PROTOCOL OVERVIEW</h2>
        <div class="sectioncontent">
<p>The protocol is a simple file-based protocol.  For each invocation of a filter, <strong>mimedefang</strong> creates a unique working directory and populates it with files.  It calls the filter, which is expected to populate the working directory with more files, which communicate the scan results back to <strong>mimedefang</strong>.  This simple mechanism allows you to easily write filters in scripting languages without worrying about C-level details.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILTER INVOCATION</h2>
        <div class="sectioncontent">
<p>The filter program may be invoked in one of five ways:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>filter_prog</em> <em>directory</em></p>
  </dt>
  <dd>
    <p>If the program is invoked with a single argument which is an absolute path name (called the <strong>working directory</strong>, the program is expected to perform filtering in that directory and then exit.</p>
  </dd>
  <dt>
    <p><em>filter_prog</em> <strong>-server</strong></p>
  </dt>
  <dd>
    <p>If the program is invoked with the single argument <strong>-server</strong>, it is expected to run as a server.  See SERVER MODE for details.</p>
  </dd>
  <dt>
    <p><em>filter_prog</em> <strong>-serveru</strong></p>
  </dt>
  <dd>
    <p>If the program is invoked with the single argument <strong>-serveru</strong>, it is expected to run as a server.  In addition, anything it prints to file descriptor 3 is used to update the "slave status" field in the multiplexor.  This lets the filter inform administrators exactly what it is doing.  (See the <strong>-Z</strong> option to <strong>mimedefang-multiplexor</strong>.)</p>
  </dd>
  <dt>
    <p><em>filter_prog</em> <strong>-embserver</strong></p>
  </dt>
  <dd>
    <p>Similar to <strong>-server</strong>, but used by the embedded Perl code. The program should run any initialization routines and then exit. The multiplexor will subsequently call the Perl routine <strong>do_main_loop</strong> when it is time for the slave to begin running in server mode.</p>
  </dd>
  <dt>
    <p><em>filter_prog</em> <strong>-embserveru</strong></p>
  </dt>
  <dd>
    <p>Similar to <strong>-embserver</strong> with the additional magic of updating the slave status from data written to file descriptor 3.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INITIAL FILE LAYOUT</h2>
        <div class="sectioncontent">
<p>When the filter begins a scan, it should change directories to the working directory.  In that directory, it will find the following files.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>INPUTMSG</strong></p>
  </dt>
  <dd>
    <p>A file containing the complete input e-mail message, including headers.</p>
  </dd>
  <dt>
    <p><strong>HEADERS</strong></p>
  </dt>
  <dd>
    <p>A file containing just the headers, one per line.  Headers which are continued over several lines in the original message are collapsed into a single line in this file.</p>
  </dd>
  <dt>
    <p><strong>COMMANDS</strong></p>
  </dt>
  <dd>
    <p>A file containing a list of commands.  Each command is a single letter and may be followed by arguments.  Each command is on its own line.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THE COMMANDS FILE</h2>
        <div class="sectioncontent">
<p>All commands have their arguments encoded as follows: All characters outside the range 33 to 126 ASCII, as well as the characters "%", " "'" and double-quote, are replaced by a percent sign followed by two hex digits specifying the character's numerical value.  The filter must un-escape the arguments when it reads the COMMANDS file.</p><p>The commands from the C to Perl filters are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>S</strong><em>sender</em></p>
  </dt>
  <dd>
    <p>The sender of the message.</p>
  </dd>
  <dt>
    <p><strong>s</strong><em>esmtp_arg</em></p>
  </dt>
  <dd>
    <p>An ESMTP argument associated with the sender (such as SIZE=54432).  There is one <strong>s</strong> line for each ESMTP argument.</p>
  </dd>
  <dt>
    <p><strong>U</strong><em>subject</em></p>
  </dt>
  <dd>
    <p>The message subject.</p>
  </dd>
  <dt>
    <p><strong>X</strong><em>message_id</em></p>
  </dt>
  <dd>
    <p>The Message-ID.</p>
  </dd>
  <dt>
    <p><strong>R</strong><em>recipient</em> <em>mailer</em> <em>host</em> <em>addr</em></p>
  </dt>
  <dd>
    <p>A recipient.  There is one <strong>R</strong> line for each recipient.  The <em>mailer</em>, <em>host</em> and <em>addr</em> parts of the line are the values of the Sendmail {rcpt_mailer}, {rcpt_host} and {rcpt_addr} macros if they are available, or "?" if not.</p>
  </dd>
  <dt>
    <p><strong>r</strong><em>esmtp_arg</em></p>
  </dt>
  <dd>
    <p>An ESMTP argument associated with the <em>most recent</em> recipient (such as NOTIFY=never).  There is one <strong>r</strong> line for each SMTP argument.</p>
  </dd>
  <dt>
    <p><strong>!</strong></p>
  </dt>
  <dd>
    <p>If this command is present, there are suspicious characters in the message headers.</p>
  </dd>
  <dt>
    <p><strong>?</strong></p>
  </dt>
  <dd>
    <p>If this command is present, there are suspicious characters in the message body.</p>
  </dd>
  <dt>
    <p><strong>I</strong><em>host_addr</em></p>
  </dt>
  <dd>
    <p>The SMTP relay host's IP address in dotted-quad notation.</p>
  </dd>
  <dt>
    <p><strong>i</strong><em>identifier</em></p>
  </dt>
  <dd>
    <p>An identifier generated by MIMEDefang.  On a given host, this identifier is very likely to be unique over a timespan of about 24 years.</p>
  </dd>
  <dt>
    <p><strong>J</strong><em>host_addr</em></p>
  </dt>
  <dd>
    <p>The "real" SMTP relay host's IP address in dotted-quad notation. Multi-stage MIMEDefang relays can use a special IP validation header so that even the innermost MIMEDefang relay can see the "original" relay's IP address.</p>
  </dd>
  <dt>
    <p><strong>H</strong><em>host_name</em></p>
  </dt>
  <dd>
    <p>The SMTP relay host name.</p>
  </dd>
  <dt>
    <p><strong>E</strong><em>argument</em></p>
  </dt>
  <dd>
    <p>The argument to the SMTP "EHLO" or "HELO" command.</p>
  </dd>
  <dt>
    <p><strong>Q</strong><em>qid</em></p>
  </dt>
  <dd>
    <p>The message's Sendmail queue-ID.</p>
  </dd>
  <dt>
    <p><strong>=</strong><em>macro</em> <em>val</em></p>
  </dt>
  <dd>
    <p>Set the value of the specified Sendmail macro to <em>val</em>.  Both <em>macro</em> and <em>val</em> are percent-encoded, but the single space character between them is not.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILTER OPERATION</h2>
        <div class="sectioncontent">
<p>When the filter performs a scan, it can make use of all the information in the files mentioned previously.  If the filter needs temporary working files, it should create a subdirectory under the working directory for its own use.  In this case, you do not have to clean up your working files, because <strong>mimedefang</strong> deletes the working directory when the filter returns.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FINAL FILE LAYOUT</h2>
        <div class="sectioncontent">
<p>The filter communicates the results of the scan back to <strong>mimedefang</strong> by creating additional files in the working directory.  The most important file is called RESULTS, and it contains a list of one-letter, one-line commands back to the filter.  As usual, command arguments are percent-escaped.  The commands from the filter back to <strong>mimedefang</strong> are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>B</strong><em>code</em> <em>dsn</em> <em>reply_text</em></p>
  </dt>
  <dd>
    <p>Bounce (reject) the message with the specified SMTP reply code, DSN code and reply text.</p>
  </dd>
  <dt>
    <p><strong>D</strong></p>
  </dt>
  <dd>
    <p>Silently discard the message and pretend it was delivered.</p>
  </dd>
  <dt>
    <p><strong>T</strong><em>code</em> <em>dsn</em> <em>reply_text</em></p>
  </dt>
  <dd>
    <p>Return an SMTP temporary failure code with the specified SMTP code, DSN and reply text.</p>
  </dd>
  <dt>
    <p><strong>C</strong></p>
  </dt>
  <dd>
    <p>Replace the message body.  If this command is present, the file NEWBODY must contain the new message body.</p>
  </dd>
  <dt>
    <p><strong>M</strong><em>header_val</em></p>
  </dt>
  <dd>
    <p>Replace the MIME Content-Type header with a new value.  Used to change MIME boundaries or convert non-MIME to MIME messages.</p>
  </dd>
  <dt>
    <p><strong>H</strong><em>header</em> <em>val</em></p>
  </dt>
  <dd>
    <p>Add a new header <em>header</em> with value <em>val</em>.  The <em>header</em> should not contain a colon.  Each of <em>header</em> and <em>val</em> is percent-escaped, but the single space between them is not.</p>
  </dd>
  <dt>
    <p><strong>N</strong><em>header</em> <em>index</em> <em>val</em></p>
  </dt>
  <dd>
    <p>Adds a new header <em>header</em> with value <em>val</em> in position <em>index</em>.  An index of zero specifies that the new header should be prepended before all existing headers.</p>
  </dd>
  <dt>
    <p><strong>I</strong><em>header</em> <em>index</em> <em>val</em></p>
  </dt>
  <dd>
    <p>Replace the <em>index'th</em> occurrence of <em>header</em> with value <em>val</em>.  The <em>index</em> is 1-based.  The <em>header</em> should not contain a colon.  Each of <em>header</em>, <em>index</em> and <em>val</em> is percent-escaped, but the single space between them is not.</p>
  </dd>
  <dt>
    <p><strong>J</strong><em>header</em> <em>index</em></p>
  </dt>
  <dd>
    <p>Delete the <em>index</em>'th occurrence of <em>header</em>.</p>
  </dd>
  <dt>
    <p><strong>R</strong><em>recip</em></p>
  </dt>
  <dd>
    <p>Add a new recipient <em>recip</em> to the message.</p>
  </dd>
  <dt>
    <p><strong>S</strong><em>recip</em></p>
  </dt>
  <dd>
    <p>Delete <em>recip</em> from the list of message recipients.</p>
  </dd>
  <dt>
    <p><strong>f</strong><em>sender</em></p>
  </dt>
  <dd>
    <p>Change the envelope sender to <em>sender</em>.  This is only supported by Sendmail 8.14.0 and higher.</p>
  </dd>
  <dt>
    <p><strong>F</strong></p>
  </dt>
  <dd>
    <p>Indicate that we have finished issuing commands.  Anything after an F line is ignored.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SERVER MODE</h2>
        <div class="sectioncontent">
<p>In server mode, <strong>mimedefang-multiplexor</strong> runs the filter program continuously in a server loop.  The filter program reads commands from standard input, and writes results to standard output.  The filter program <em>must</em> exit shortly after it sees EOF on its standard input.  If it does not exit within 10 seconds, it will be terminated with SIGTERM.  If that still does not work, then after a further 10 seconds, it is killed with SIGKILL.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>SERVER COMMANDS</strong></p>
  </dt>
  <dd>
    <p>All server commands are single line commands.  Each command is followed by a space-separated list of arguments; each argument is percent-encoded.  The commands defined are:</p>
  </dd>
  <dt>
    <p><strong>ping</strong></p>
  </dt>
  <dd>
    <p>Elicits a reply of "PONG" from the server.</p>
  </dd>
  <dt>
    <p><strong>scan </strong><em>queue_id</em> <em>dir</em></p>
  </dt>
  <dd>
    <p>Run a scan for the mail identiefied by the Sendmail queue-ID <em>queue_id</em> in the directory <em>dir</em>.  The command is terminated with a newline. The server must write a newline-terminated "ok" if the scan completed successfully, or "error: msg" if something went wrong.</p>
  </dd>
  <dt>
    <p><strong>relayok </strong><em>ip_addr</em> <em>hostname</em> <em>client_port</em> <em>daemon_ip</em> <em>daemon_port</em></p>
  </dt>
  <dd>
    <p>Test whether or not to accept a connection from the specified host. The server must write "ok 1" if we will accept the connection, or "ok 0 error_message code dsn" if not.  It can indicate a temporary failure by writing "ok -1 error_message code dsn".  Note that even if the connection is accepted, a later scan can still reject the message based on other criteria.  "ip_addr" is the IP address of the relay and "hostname" is the hostname (if it could be determined; otherwise, the IP address in square brackets).</p>
  </dd>
  <dt>
    <p><strong>helook </strong><em>ip_addr</em> <em>hostname</em> <em>helo_string</em> <em>client_port</em> <em>daemon_ip</em> <em>daemon_port</em></p>
  </dt>
  <dd>
    <p>Test whether or not to accept the HELO/EHLO command.  The server must write "ok 1" if we will accept the mail attempt, or "ok 0 error_message code dsn" if not.  "ok -1 error_message code dsn" indicates a temporary failure. <em>helo_string</em> is the argument to the HELO/EHLO command.  The remaining arguments have the same meaning as in <strong>relayok</strong>.</p>
  </dd>
  <dt>
    <p><strong>senderok </strong><em>sender_addr</em> <em>ip_addr</em> <em>hostname</em> <em>helo_string</em> <em>dir</em> <em>queue_id</em> [<em>esmtp_args</em>...]</p>
  </dt>
  <dd>
    <p>Test whether or not to accept mail from the specified sender.  The server must write "ok 1" if we will accept the mail attempt, or "ok 0 error_message code dsn" if not.  "ok -1 error_message code dsn" indicates a temporary failure.  Note that even if the sender is accepted, a later scan can still reject the message based on other criteria.  "sender_addr" is the sender's e-mail address. The "ip_addr" and "hostname" arguments are as in <strong>relayok</strong>. "helo_string" is the argument to the SMTP HELO/EHLO command. "dir" is the MIMEDefang spool directory, and "queue_id" is the Sendmail queue identifier.</p><p>The optional "esmtp_args" are space-separated, percent-encoded ESMTP arguments supplied with the MAIL FROM: command.</p>
  </dd>
  <dt>
    <p><strong>recipok </strong><em>recip_addr</em> <em>sender_addr</em> <em>ip_addr</em> <em>hostname</em> <em>first_recip</em> <em>helo_string</em> <em>dir</em> <em>queue_id</em> [<em>esmtp_args</em>...]</p>
  </dt>
  <dd>
    <p>Test whether or not to accept mail for the specified recipient.  The server must write "ok 1" if we will accept it, or "ok 0 error_message code dsn" if not.  ok -1 error_message code dsn" indicates a temporary-failure.</p><p>"recip_addr" is the argument to the RCPT TO: command, and "first_recip" is the argument to the first RCPT TO: command for this message.  Other arguments are as in <strong>senderok</strong>.</p>
  </dd>
  <dt>
    <p><strong>map </strong><em>map_name</em> <em>key</em></p>
  </dt>
  <dd>
    <p>If you are using a map socket (the <strong>-N</strong> option to <strong>mimedefang-multiplexor</strong>), then the server should look up the key <em>key</em> in the map <em>map_name</em>.  The server should print a single line to standard output.  The first word on the line should be one of OK, NOTFOUND, TEMP, TIMEOUT or PERM, indicating a successful lookup, absence of the key, a temporary failure, a timeout or a permanent failure, respectively.  This should be followed by a space and a percent-encoded string representing the value of the key (if it was found) or an optional error message (if something went wrong.)</p>
  </dd>
  <dt>
    <p><strong>tick </strong><em>band</em></p>
  </dt>
  <dd>
    <p>The filter should run <strong>filter_tick</strong> with the specified <em>band</em> argument.  It should print a single line to standard output:</p><p>tock <em>band</em></p>
  </dd>
  <dt>
    <p><strong>Additional Commands</strong></p>
  </dt>
  <dd>
    <p>The filter can define a function <strong>filter_unknown_cmd</strong> that can extend the list of server commands.  If you do this, make sure all of your commands start with an upper-case letter to avoid conflicts if more built-in commands are defined in the future.</p>
  </dd>
  <dt>
    <p><strong>SERVER REPLIES</strong></p>
  </dt>
  <dd>
    <p>The reply codes are:</p>
  </dd>
  <dt>
    <p><strong>ok [</strong><em>return_code</em>] [<em>parameters</em>]</p>
  </dt>
  <dd>
    <p>The operation completed successfully.  Some operations have an associated return code, and possibly other parameters as well. See the source code for the gory details.</p>
  </dd>
  <dt>
    <p><strong>error: </strong><em>Message</em></p>
  </dt>
  <dd>
    <p>The operation failed.  <em>Message</em> may give additional details.</p>
  </dd>

</dl>
<p>In server mode, you should <em>not</em> write anything to standard output except reply codes, or the multiplexor will become confused.  You should <em>not</em> terminate the program in server mode; simply echo an <strong>error:</strong> reply and return to the server loop.</p><p>When you send a reply code back to the multiplexor, be sure to terminate it with a newline, and to flush standard output.  If your program uses the Standard I/O library, standard output may not be flushed immediately, and <strong>mimedefang-multiplexor</strong> will wait forever for the filter's reply, and eventually kill the filter on the assumption it has hung up.</p><p>In server mode, if the filter program receives a SIGINT signal, it must terminate.  This is used by <strong>mimedefang-multiplexor</strong> to terminate slaves after they have processed a given number of e-mail messages.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p><strong>mimedefang</strong> was written by David F. Skoll &lt;dfs@roaringpenguin.com&gt;. The <strong>mimedefang</strong> home page is <em>http://www.mimedefang.org/</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO mimedefang-protocol&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/mimedefang.pl.8.html"><strong>mimedefang.pl</strong>(8)</a>, <a href="../man8/mimedefang.8.html"><strong>mimedefang</strong>(8)</a>, <a href="../man8/mimedefang-multiplexor.8.html"><strong>mimedefang-multiplexor</strong>(8)</a>, <a href="../man5/mimedefang-filter.5.html"><strong>mimedefang-filter</strong>(5)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="mimedefang-notify.7.html"><span aria-hidden="true">&larr;</span> mimedefang-notify.7: Conventions used by mimedefang-multiplexor(8) to notify an external program of state changes.</a></li>
   <li class="next"><a href="missing.7.html">missing.7: Missing manual pages <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
