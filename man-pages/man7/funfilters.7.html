<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>funfilters: Filtering rows in a table</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Filtering rows in a table">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="funfilters (7) manual">
  <meta name="twitter:description" content="Filtering rows in a table">
  <meta name="twitter:image" content="https://www.carta.tech/images/libfuntools-dev-funfilters-7.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man7/funfilters.7.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="funfilters (7) manual" />
  <meta property="og:description" content="Filtering rows in a table" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libfuntools-dev-funfilters-7.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">funfilters<small> (7)</small></h1>
        <p class="lead">Filtering rows in a table</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/">
      <span itemprop="name">Miscellaneous</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/funfilters.7.html">
      <span itemprop="name">funfilters: Filtering rows in a table</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libfuntools-dev/">
      <span itemprop="name">libfuntools-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/funfilters.7.html">
      <span itemprop="name">funfilters: Filtering rows in a table</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>This document contains a summary of the user interface for filtering rows in binary tables.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Table filtering allows a program to select rows from an table (e.g., X\-ray event list) by checking each row against one or more expressions involving the columns in the table. When a table is filtered, only valid rows satisfying these expressions are passed through for processing.</p><p>A filter expression is specified using bracket notation appended to the filename of the data being processed:</p>
<pre>
  foo.fits[pha==1&&pi==2]
</pre>
<p>It is also possible to put region specification inside a file and then pass the filename in bracket notation:</p><p>  foo.fits[@my.reg]</p><p>Filters must be placed after the extension and image section information, when such information is present. The correct order is:</p><ul>
<li><p>file[fileinfo,sectioninfo][filters]</p></li><li><p>file[fileinfo,sectioninfo,filters]</p></li>
</ul><p>where:</p><ul>
<li><p><strong>file</strong> is the Funtools file name</p></li><li><p><strong>fileinfo</strong> is an \s-1ARRAY\s0, \s-1EVENT\s0, \s-1FITS\s0 extension, or \s-1FITS\s0 index</p></li><li><p><strong>sectioninfo</strong> is the image section to extract</p></li><li><p><strong>filters</strong> are spatial region and table (row) filters to apply</p></li>
</ul><p>See Funtools Files for more information on file and image section specifications.</p><p><strong>Filter Expressions</strong></p><p>Table filtering can be performed on columns of data in a \s-1FITS\s0 binary table or a raw event file.  Table filtering is accomplished by means of <strong>table filter specifications</strong>.  An table filter specification consists of one or more <strong>filter expressions</strong> Filter specifications also can contain comments and local/global processing directives.</p><p>More specifically, a filter specification consist of one or more lines containing:</p><p>  # comment until end of line   # include the following file in the table descriptor   @file   # each row expression can contain filters separated by operators   [filter_expression] BOOLOP [filter_expression2], ...   # each row expression can contain filters separated by the comma operator   [filter_expression1], [filter_expression2], ...   # the special row# keyword allows a range of rows to be processed   row#=m:n   # or a single row   row#=m   # regions are supported -- but are described elsewhere   [spatial_region_expression]</p><p>A single filter expression consists of an arithmetic, logical, or other operations involving one or more column values from a table. Columns can be compared to other columns, to header values, or to numeric constants. Standard math functions can be applied to columns. Separate filter expressions can be combined using boolean operators. Standard C semantics can be used when constructing expressions, with the usual precedence and associativity rules holding sway:</p><p>  Operator                                Associativity   --------                                -------------   ()                                      left to right   !! (logical not)                        right to left   !  (bitwise not) - (unary minus)        right to left   *  /                                    left to right   +  -                                    left to right   &lt; &lt;= &gt; &gt;=                               left to right   == !=                                   left to right   &  (bitwise and)                        left to right   ^  (bitwise exclusive or)               left to right   |  (bitwise inclusive or)               left to right   && (logical and)                        left to right   || (logical or)                         left to right   =                                       right to left</p><p>For example, if energy and pha are columns in a table, then the following are valid expressions:</p><p>  pha&gt;1   energy == pha   (pha&gt;1) && (energy&lt;=2)   max(pha,energy)&gt;=2.5</p><p>Comparison values can be integers or floats. Integer comparison values can be specified in decimal, octal (using '0' as prefix), hex (using '0x' as prefix) or binary (using '0b' as prefix). Thus, the following all specify the same comparison test of a status mask:</p><p>  (status & 15) == 8           # decimal   (status & 017) == 010        # octal   (status & 0xf) == 0x8        # hex   (status & 0b1111) == 0b1000  # binary</p><p>The special keyword row# allows you to process a range of rows. When row# is specified, the filter code skips to the designated row  and only processes the specified number of rows. The \*(L"*\*(R" character can be utilized as the high limit value to denote processing of the remaining rows. Thus:</p><p>  row#=100:109</p><p>processes 10 rows, starting with row 100 (counting from 1), while:</p><p>  row#=100:*</p><p>specifies that all but the first 99 rows are to be processed.</p><p>Spatial region filtering allows a program to select regions of an image or rows of a table (e.g., X\-ray events) using simple geometric shapes and boolean combinations of shapes.  For a complete description of regions, see Spatial Region Filtering.</p><p><strong>Separators Also Are Operators</strong></p><p>As mentioned previously, multiple filter expressions can be specified in a filter descriptor, separated by commas or new\-lines. When such a comma or new-line separator is used, the boolean \s-1AND\s0 operator is automatically generated in its place. Thus and expression such as:</p><p>  pha==1,pi=2:4</p><p>is equivalent to:</p><p>  (pha==1) && (pi&gt;=2&&pi&lt;=4)</p><p>[Note that the behavior of separators is different for filter expressions and spatial region expressions.  The former uses \s-1AND\s0 as the operator, while the latter user \s-1OR\s0. See Combining Region and Table Filters for more information about these conventions and how they are treated when combined.]</p><p><strong>Range Lists</strong></p><p>Aside from the standard C syntax, filter expressions can make use of IRAF-style <strong>range lists</strong> which specify a range of values. The syntax requires that the column name be followed by an '=' sign, which is followed by one or more comma-delimited range expressions of the form:</p><p>  col = vv              # col == vv in range   col = :vv             # col &lt;= vv in range   col = vv:             # col &gt;= vv in range   col = vv1:vv2         # vv1 &lt;= col &lt;= vv2 in range</p><p>The vv's above must be numeric constants; the right hand side of a range list cannot contain a column name or header value.</p><p>Note that, unlike an ordinary comma separator, the comma separator used between two or more range expressions denotes \s-1OR\s0.  Thus, when two or more range expressions are combined with a comma separator, the resulting expression is a shortcut for more complicated boolean logic. For example:</p><p>  col = :3,6:8,10:</p><p>is equivalent to:</p><p>  (col=6 && col =10)</p><p>Note also that the single-valued rangelist:</p><p>  col = val</p><p>is equivalent to the C\-based filter expression:</p><p>  col == val</p><p>assuming, of course, that val is a numeric constant.</p><p><strong>Math Operations and Functions</strong></p><p>It is permissible to specify C math functions as part of the filter syntax. When the filter parser recognizes a function call, it automatically includes the math.h and links in the C math library.  Thus, it is possible to filter rows by expressions such as these:</p><ul>
<li><p>(pi+pha)&gt;(2+log(pi)\-pha)</p></li><li><p>min(pi,pha)*14&gt;x</p></li><li><p>max(pi,pha)==(pi+1)</p></li><li><p>feq(pi,pha)</p></li><li><p>div(pi,pha)&gt;0</p></li>
</ul><p>The function feq(a,b) returns true (1) if the difference between a and b (taken as double precision values) is less than approximately 10E\-15. The function div(a,b) divides a by b, but returns NaN (not a number) if b is 0. It is a safe way to avoid floating point errors when dividing one column by another.</p><p><strong>Include Files</strong></p><p>The special <strong>@filename</strong> directive specifies an include file containing filter expressions. This file is processed as part of the overall filter descriptor:</p><p>  foo.fits[pha==1,@foo]</p><p><strong>Header Parameters</strong></p><p>The filter syntax supports comparison between a column value and a header parameter value of a \s-1FITS\s0 binary tables (raw event files have no such header).  The header parameters can be taken from the binary table header or the primary header.  For example, assuming there is a header value \s-1MEAN_PHA\s0 in one of these headers, you can select photons having exactly this value using:</p><ul>
<li><p>pha==MEAN_PHA</p></li>
</ul><p>Table filtering is more easily described by means of examples. Consider data containing the following table structure:</p><ul>
<li><p>double \s-1TIME\s0</p></li><li><p>int X</p></li><li><p>int Y</p></li><li><p>short \s-1PI\s0</p></li><li><p>short \s-1PHA\s0</p></li><li><p>int \s-1DX\s0</p></li><li><p>int \s-1DY\s0</p></li>
</ul><p>Tables can be filtered on these columns using \s-1IRAF/QPOE\s0 range syntax or any valid C syntax.  The following examples illustrate the possibilities:</p><ul>
<li><p>pha=10</p></li><li><p>pha==10 select rows whose pha value is exactly 10</p></li><li><p>pha=10:50 select rows whose pha value is in the range of 10 to 50</p></li><li><p>pha=10:50,100 select rows whose pha value is in the range of 10 to 50 or is equal to 100</p></li><li><p>pha&gt;=10 && pha&lt;=50 select rows whose pha value is in the range of 10 to 50</p></li><li><p>pi=1,2&&pha&gt;3 select rows whose pha value is 1 or 2 and whose pi value is 3</p></li><li><p>pi=1,2 || pha&gt;3 select rows whose pha value is 1 or 2 or whose pi value is 3</p></li><li><p>pha==pi+1 select rows whose pha value is 1 less than the pi value</p></li><li><p>(pha==pi+1) && (time&gt;50000.0) select rows whose pha value is 1 less than the pi value and whose time value is greater than 50000</p></li><li><p>(pi+pha)&gt;20 select rows in which the sum of the pi and pha values is greater than 20</p></li><li><p>pi%2==1 select rows in which the pi value is odd</p></li>
</ul><p>Currently, integer range list limits cannot be specified in binary notation (use decimal, hex, or octal instead). Please contact us if this is a problem.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO funfilters&hellip;</h2>
        <div class="sectioncontent">
<p>See <a href="../man7/funtools.7.html"><strong>funtools</strong>(7)</a> for a list of Funtools help pages</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="funfiles.7.html"><span aria-hidden="true">&larr;</span> funfiles.7: Funtools data files</a></li>
   <li class="next"><a href="funidx.7.html">funidx.7: Using indexes to filter rows in a table <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
