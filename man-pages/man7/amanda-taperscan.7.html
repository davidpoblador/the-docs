<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>amanda-taperscan: Amanda taperscan algorithms</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Amanda taperscan algorithms">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="amanda-taperscan (7) manual">
  <meta name="twitter:description" content="Amanda taperscan algorithms">
  <meta name="twitter:image" content="https://www.carta.tech/images/amanda-common-amanda-taperscan-7.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man7/amanda-taperscan.7.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="amanda-taperscan (7) manual" />
  <meta property="og:description" content="Amanda taperscan algorithms" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/amanda-common-amanda-taperscan-7.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">amanda-taperscan<small> (7)</small></h1>
        <p class="lead">Amanda taperscan algorithms</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/">
      <span itemprop="name">Miscellaneous</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/amanda-taperscan.7.html">
      <span itemprop="name">amanda-taperscan: Amanda taperscan algorithms</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/amanda-common/">
      <span itemprop="name">amanda-common</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/amanda-taperscan.7.html">
      <span itemprop="name">amanda-taperscan: Amanda taperscan algorithms</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Amanda uses a <em>taperscan algorithm</em> to select volumes on which to store dumps. Historically Amanda has provided only one, fairly complex taperscan algorithm, but this algorithm did not suit the needs of all users. Now Amanda offers a wide array of algorithms to suit varied needs. Adding new algorithms is not difficult.</p><p>The taperscan algorithm is specified with the <strong>taperscan</strong> parameter, which has a default value of <strong>traditional</strong>.</p><p>Taperscan algorithms are implemented as perl packages with the prefix Amanda::Taper::Scan::. See the perl documentation for Amanda::Taper::Scan for more information.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DEFINING A TAPERSCAN</h2>
        <div class="sectioncontent">
<p>An taperscan is defined in <a href="../man5/amanda.conf.5.html"><strong>amanda.conf</strong>(5)</a> as follows:</p>
<pre>
define taperscan $taperscan_name {
   comment "$comment"
   plugin "$pluginname"
   property "$PROPERTY_NAME" "$PROPERTY_VALUE"
   ...
}
</pre>
<p>and then referenced in the global section as</p>
<pre>
  taperscan "$taperscan_name"
</pre>
<p>Taperscan properties, like Amanda configuration parameters, are insensitive to case, and - (dash) and _ (underscore) may be used interchangeably.</p><p>See the individual plugin documentation below for properties applicable to each plugin.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TAPERSCAN ALGORITHMS</h2>
        <div class="sectioncontent">
<p>In general, these algorithms will only select reusable volumes. These are volumes which are listed in the <a href="../man5/tapelist.5.html"><strong>tapelist</strong>(5)</a> with the <em>reuse</em> flag, and which are not among the <em>tapecycle-1</em> most recent volumes in the list. Put another way, reusable volumes do not contain data that must be retained. Note that if fewer than <em>tapecycle-1</em> volumes have been written then there are no reusable volumes. Newly labeled volumes (volumes that have been labeled with <strong>amlabel</strong> but never used) are considered reusable.</p><p>Many of these algorithms look for the oldest reusable volume. In most cases, this is the best volume to overwrite, as the data it contains is older than that on any other volume. If there are no reusable volumes, then there is no oldest reusable volume.</p><h3>traditional</h3>
<p>This algorithm duplicates Amanda&apos;s historical behavior, and it operates in two stages.</p><p>First, if there is an oldest reusable volume and if the changer supports "fast" searches, then the algorithm uses the changer to search for that volume. Newly labeled volumes are not considered when calculating the oldest reusable volume. Consequently, this taperscan algorithm prefers volumes which have been used before to newly-labeled volumes when a fast-searchable changer is in use.</p><p>Second, if there is no oldest reusable volume, or if that volume is not available in the changer, then the algorithm begins a sequential scan of the changer, starting at the current slot. It selects the first suitable volume it finds: a reusable volume (perhaps newly-labeled) or, if <strong>autolabel</strong> includes <strong>empty</strong>, a blank volume. Even across multiple invocations (when <em>runtapes &gt; 1</em>), it will not return the same slot twice.</p><p><strong>Note</strong></p><p>This algorithm shows an undue preference for volumes already containing data, by omitting newly-labeled volumes from its first stage.  Historically, many Amanda changer scripts were not fast-searchable (including <em>chg-multi</em>, <em>chg-disk</em> and, if <em>havereader=0</em>, <em>chg-zd-mtx</em>), and thus skipped the first stage, allowing new volumes to find their way into the tape cycle.  New changers are almost all fast-searchable, so both stages of the algorithm are used and new tapes may be unexpectedly excluded.  If this causes an undesirable change in behavior, consider one of the other taperscan algorithms..sp .5v</p>
<h3>oldest</h3>
<p>This algorithm works with the Changer API (see <a href="../man7/amanda-changers.7.html"><strong>amanda-changers</strong>(7)</a>), using the inventory returned by the changer to locate the oldest acceptable volume available. Note that this will not work with changers that do not support inventory (old changers). The algorithms scans unknown slots only if no known usable volume is found in the inventory.</p><p>An acceptable volume is a reusable volume, a new labeled volume or an unlabeled volume that can be labeled according to <strong>autolabel</strong>. Note that changers do not always know the contents of every slot - for example, a tape with an unknown barcode will not be considered usable.</p><p>Use <strong>amtape CONF inventory</strong> to see the changer&apos;s inventory, and use <strong>amtape CONF update</strong> to update it.</p>
<h3>lexical</h3>
<p>This algorithm also works with the Changer API, using the inventory to determine the acceptable volumes; it then uses the volume which follows the last-used volume in lexical order. For volume labels containing leading zeros, e.g., CORP-010, this algorithm will run through the volumes in the natural order.</p><p>It scans unknown slots only if no usable volume is found in the inventory.</p><p>See <strong>oldest</strong>, above, for a definition of acceptable volumes.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO amanda-taperscan&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/amanda.8.html"><strong>amanda</strong>(8)</a>, <a href="../man5/amanda.conf.5.html"><strong>amanda.conf</strong>(5)</a>, <a href="../man5/tapelist.5.html"><strong>tapelist</strong>(5)</a>, <a href="../man7/amanda-changers.7.html"><strong>amanda-changers</strong>(7)</a>, <a href="../man7/amanda-interactivity.7.html"><strong>amanda-interactivity</strong>(7)</a></p><p>The Amanda Wiki: : http://wiki.zmanda.com/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p><strong>Dustin J. Mitchell</strong> &lt;dustin@zmanda.com&gt;</p><p>Zmanda, Inc. (http://www.zmanda.com)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="amanda-scripts.7.html"><span aria-hidden="true">&larr;</span> amanda-scripts.7: Configuring and using the script api</a></li>
   <li class="next"><a href="amber_BeamPos.7.html">amber_BeamPos.7: Amber beam monitoring recipe <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
