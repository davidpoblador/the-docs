<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>grokevt: A collection of scripts built for reading windows event log files.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="A collection of scripts built for reading windows event log files.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="grokevt (7) manual">
  <meta name="twitter:description" content="A collection of scripts built for reading windows event log files.">
  <meta name="twitter:image" content="https://www.carta.tech/images/grokevt-grokevt-7.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man7/grokevt.7.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="grokevt (7) manual" />
  <meta property="og:description" content="A collection of scripts built for reading windows event log files." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/grokevt-grokevt-7.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">grokevt<small> (7)</small></h1>
        <p class="lead">A collection of scripts built for reading windows event log files.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/">
      <span itemprop="name">Miscellaneous</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/grokevt.7.html">
      <span itemprop="name">grokevt: A collection of scripts built for reading windows event log files.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/grokevt/">
      <span itemprop="name">grokevt</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/grokevt.7.html">
      <span itemprop="name">grokevt: A collection of scripts built for reading windows event log files.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This document serves as an overview to using the GrokEVT suite of tools. Please see the man pages for each tool for specific command-line options.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USING</h2>
        <div class="sectioncontent">
<p>Using GrokEVT on a set of windows partitions is a three stage process. One must first mount the partitions and configure the system's profile. Next, <a href="../man1/grokevt-builddb.1.html"><strong>grokevt-builddb</strong>(1)</a> must be run to extract the necessary information from these partitions. Finally, <a href="../man1/grokevt-parselog.1.html"><strong>grokevt-parselog</strong>(1)</a> may be run to use this information to convert the logs to something useful.</p><p><em>Mounting and configuration:</em></p><p>This is the most labor-intensive step of the process. There are several technical reasons why this cannot be simpler, and it is unlikely many will be resolved anytime soon. (Sorry, blame the vendor who produced these logs that you wish to convert.)</p><p>First mount the partitions used by your windows system. Specifically, mount any partition that has software installed on it. (You can probably get away with not mounting ones with no software, or no software that produces events in the event log.) This includes windows shares, if you have any with software installed on them.</p><p>The key point when mounting partitions or shares, is that you must mount them with case-insensitive filenames. To do this in Linux, you should be able to use the NTFS option 'posix=0', or with type vfat this appears to be the default. On FreeBSD, one can use the -i option with NTFS and mount_ntfs, but this hasn't been tested. (More research is necessary in this area. Please let me know if case-insensitivity is available on other *NIXes and what the options are.) All of this, of course, depends on your version of mount and related software. See <a href="../man8/mount.8.html"><strong>mount</strong>(8)</a> for more information.</p><p>Once you have all necessary filesystems mounted for your windows image, you need to configure GrokEVT so it knows where everything is. If you look in the main configuration directory, (by default at '/usr/local/etc/grokevt') you'll find a sub-directory called 'systems'. In there is a set of system configuration profiles. Each directory under 'systems' represents the configuration for a single windows host. You may create directories here of any name. It is suggested you use the host name of the system you wish to extract logs from.</p><p>By default, there will be one system configuration there already, named 'example'. I suggest you make a full copy of this, and edit it from there to create your own configuration:</p>
<pre>
\*(T&lt;
	  # cd /usr/local/etc/grokevt/systems
	  # cp -r example mysystem
     \*(T&gt;
</pre>
<p>Now that you have your own configuration, take a look at the files under this directory:</p>
<pre>
\*(T&lt;
	  path-vars/%SystemRoot%
	  system-registry
	  drives/c:
	  drives/d:
     \*(T&gt;
</pre>
<p>Each file represents a single configuration setting. The first line of every file is the setting, all others are ignored. You should start by configuring your drive letters. These drive letters need to map to the *NIX path of the drives. So, if you mounted your C: partition under '/mnt/win/c', then you should do the following:</p>
<pre>
\*(T&lt;
	  echo /mnt/win/c &gt; drives/c:
     \*(T&gt;
</pre>
<p>This will of course, overwrite that file with your actual mount point for the C: drive. Do this for all drives mounted on your windows system.</p><p>Next, you need to configure your %SystemRoot% path variable. Since the registry often references files in relation to this variable, we need to know where it is on your system. Typically, on W2K this should be 'C:&#92;WINNT'. On other windows systems it is often 'C:&#92;Windows'. This path may be referenced as a full windows path (with drive letters) or as a *NIX path.</p><p>Finally, you need to set the path of the system registry. This path <em>must</em> be a *NIX path, and not a windows path. It should be located under your %SystemRoot%. For instance, if you mount a W2K machine's C: on '/mnt/win/c', this path will probably be: /mnt/win/c/WINNT/system32/config/system</p><p>This will vary from system to system, but if you have ever done any forensics, you should be able to find the correct path pretty quickly.</p><p><em>Using <a href="../man1/grokevt-builddb.1.html"><strong>grokevt-builddb</strong>(1)</a>:</em></p><p>Once you get past the mounting and configuration step, you're in good shape. To extract the necessary information from the system you just mounted, you just need to decide where you want to store the output database. Based on the example paths above, one could run <a href="../man1/grokevt-builddb.1.html"><strong>grokevt-builddb</strong>(1)</a> like so:</p>
<pre>
\*(T&lt;
	  grokevt-builddb mysystem /var/db/grokevt/mysystem
     \*(T&gt;
</pre>
<p>Or something similar. This step will take some time, as a lot of files need to be parsed. You will likely get some warnings about missing DLLs and possibly service removals. This is normal if software on the windows system failed to clean up the registry correctly when it was un-installed. You might want to record this information though, if later you find you are missing a lot of message templates in your log output.</p><p>Now that you have finished this step, you have fully extracted all information needed to interpret the event logs.</p><p><em>Using <a href="../man1/grokevt-parselog.1.html"><strong>grokevt-parselog</strong>(1)</a>:</em></p><p>To run <a href="../man1/grokevt-parselog.1.html"><strong>grokevt-parselog</strong>(1)</a>, you must specify the database directory that you generated with <a href="../man1/grokevt-builddb.1.html"><strong>grokevt-builddb</strong>(1)</a>. Initially, you will want to find out what event logs were extracted by running:</p>
<pre>
\*(T&lt;
	  grokevt-parselog -l /var/db/grokevt/mysystem
     \*(T&gt;
</pre>
<p>This will print out all available event log types, based on information found previously in the system's registry. Then you may view one of those logs simply by dropping the -l option, and adding it's name as the second parameter. For instance, to view the 'System' log:</p>
<pre>
\*(T&lt;
	  grokevt-parselog /var/db/grokevt/mysystem System
     \*(T&gt;
</pre>
<p>See the <a href="../man1/grokevt-parselog.1.html"><strong>grokevt-parselog</strong>(1)</a> man page for further options.</p><p><em>Finding and Parsing Log Fragments:</em></p><p>One may find it useful to parse deleted log files or fragments of log files found in a system's RAM dump. A special-purpose tool, <a href="../man1/grokevt-findlogs.1.html"><strong>grokevt-findlogs</strong>(1)</a> is included in this distribution which makes finding log fragments easy. It can find even a single log record by itself with a relatively low rate of false positives.</p><p>Suppose one has a file, dump.img, which contains an image of a system's RAM, or perhaps the unallocated blocks of a filesystem (as might be produced by The SleuthKit's <strong>dls</strong>(1)). One could search this dump by running:</p>
<pre>
\*(T&lt;
	  grokevt-findlogs dump.img
     \*(T&gt;
</pre>
<p>This will produce a listing of all hits in the file, which may include header records, cursor records, or log records, offsets and contiguity information to help one eliminate any false positives.</p><p>Supposing we found a log fragment in this dump that we're interested in, we could simply use dd(1) or some other tool to carve out the relevant data in to a file named fragment.evt. We'd then need to find a way to associate this log with a set of message templates. This is what <a href="../man1/grokevt-addlog.1.html"><strong>grokevt-addlog</strong>(1)</a> is for. Let's take a guess that the fragment.evt was originally a part of System log. We would add the log into our previously built message database by running:</p>
<pre>
\*(T&lt;
	  grokevt-addlog /var/db/grokevt/mysystem fragment.evt System-fragment System
     \*(T&gt;
</pre>
<p>Finally, we can parse the log by simply specifying the newly imported name with <a href="../man1/grokevt-parselog.1.html"><strong>grokevt-parselog</strong>(1)</a>:</p>
<pre>
\*(T&lt;
	  grokevt-parselog /var/db/grokevt/mysystem System-fragment
     \*(T&gt;
</pre>
<p>If we found that most of the log entries didn't have associated message templates (which would result in lots of warnings to stderr), we would be pretty that fragment.evt really wasn't based on a System log. Simply re-importing it as another log type (and a different name) would let us parse it again as if it were of another type.</p><p>Please see the <a href="../man1/grokevt-findlogs.1.html"><strong>grokevt-findlogs</strong>(1)</a> and <a href="../man1/grokevt-addlog.1.html"><strong>grokevt-addlog</strong>(1)</a> man pages for more information.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CREDITS</h2>
        <div class="sectioncontent">
<p>This man page written by Timothy D. Morgan</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LICENSE</h2>
        <div class="sectioncontent">
<p>Please see the file "LICENSE" included with this software distribution.</p><p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License version 2 for more details.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO grokevt&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/grokevt-addlog.1.html"><strong>grokevt-addlog</strong>(1)</a> <a href="../man1/grokevt-builddb.1.html"><strong>grokevt-builddb</strong>(1)</a> <a href="../man1/grokevt-findlogs.1.html"><strong>grokevt-findlogs</strong>(1)</a> <a href="../man1/grokevt-parselog.1.html"><strong>grokevt-parselog</strong>(1)</a> <a href="../man1/grokevt-ripdll.1.html"><strong>grokevt-ripdll</strong>(1)</a> <a href="../man1/reglookup.1.html"><strong>reglookup</strong>(1)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="groff_mm.7.html"><span aria-hidden="true">&larr;</span> groff_mm.7: Groff mm macros</a></li>
   <li class="next"><a href="gromacs.7.html">gromacs.7: Molecular dynamics simulation suite <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
