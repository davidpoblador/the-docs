<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>runlevel: Event signalling change of system runlevel</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Event signalling change of system runlevel">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="runlevel (7) manual">
  <meta name="twitter:description" content="Event signalling change of system runlevel">
  <meta name="twitter:image" content="https://www.carta.tech/images/upstart-runlevel-7.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man7/runlevel.7.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="runlevel (7) manual" />
  <meta property="og:description" content="Event signalling change of system runlevel" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/upstart-runlevel-7.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">runlevel<small> (7)</small></h1>
        <p class="lead">Event signalling change of system runlevel</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/">
      <span itemprop="name">Miscellaneous</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/runlevel.7.html">
      <span itemprop="name">runlevel: Event signalling change of system runlevel</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/upstart/">
      <span itemprop="name">upstart</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/runlevel.7.html">
      <span itemprop="name">runlevel: Event signalling change of system runlevel</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>runlevel</strong> <strong>RUNLEVEL</strong>=<em>RUNLEVEL</em> <strong>PREVLEVEL</strong>=<em>PREVLEVEL</em> [<em>ENV</em>]...</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This page describes the <strong>runlevel</strong> Upstart event, and the general implementation of runlevels in the Upstart system.  For the runlevel tool, see <a href="../man8/runlevel.8.html"><strong>runlevel</strong>(8)</a></p><h3>The runlevel event</h3>
<p>The <strong>runlevel</strong> event signals a change of system runlevel.  The new system runlevel is given in the <strong>RUNLEVEL</strong> argument, and the previous system runlevel in the <strong>PREVLEVEL</strong> argument (which may be empty).</p><p>Additional environment may follow these depending on the runlevel, and the tool that emitted the event.  The <a href="../man8/shutdown.8.html"><strong>shutdown</strong>(8)</a> tool will supply an <strong>INIT_HALT</strong> variable set to either <em>HALT</em> or <em>POWEROFF</em> when called with <strong>-H</strong> or <strong>-P</strong> respectively.</p>
<h3>Runlevels</h3>
<p>Runlevels are a concept from UNIX\*R System V used by the <a href="../man8/init.8.html"><strong>init</strong>(8)</a> daemon or other system initialisation system to define modes of system operation.</p><p>Eight runlevels are permitted, the first seven are numbered <strong>0</strong>-<strong>6</strong> and the eighth is named <strong>S</strong> or <strong>s</strong> (both are permitted).</p><p>Services and other system components are said to exist in one or more runlevels.  When switching from one runlevel to another, the services that should not exist in the new runlevel are stopped and the services that only exist in the new runlevel are started.</p><p>This is performed by the <strong>/etc/init.d/rc</strong> script executed on a change of runlevel (by jobs run on the <strong>runlevel</strong> event in the Upstart system).  This script examines symlinks in the <em>/etc/rc?.d</em> directories, symlinks beginning <strong>K</strong> are services to be stopped and symlinks beginning <strong>S</strong> are services to be started.</p><p>The authoritative documentation for this process can be found in the <em>System run levels and init.d scripts</em> section of the <em>Debian Policy Manual. This may be currently found at</em> &lt;<strong>http://www.debian.org/doc/debian-policy/ch-opersys.html#s-sysvinit</strong>&gt;</p><p>Runlevels <strong>0</strong>, <strong>1</strong> and <strong>6</strong> are reserved.  Runlevel <strong>0</strong> is used to halt the system and <strong>6</strong> to reboot the system.  Runlevel <strong>1</strong> is used to bring the system back down into single-user mode, after which the runlevel will be <strong>S</strong>.</p>
<h3>System V initialisation in Upstart</h3>
<p>The compatible implementation of runlevels permits Upstart jobs to be run on the <strong>runlevel</strong> event that perform the same functionality as the original System V <a href="../man8/init.8.html"><strong>init</strong>(8)</a> daemon.</p><p>The <em>/etc/init/rc.conf</em> job is run on the <strong>runlevel</strong> event, thus receiving the <strong>RUNLEVEL</strong> and <strong>PREVLEVEL</strong> environment variables.  Its sole job is to execute the <strong>/etc/init.d/rc</strong> script, passing the new runlevel as an argument.</p><p>Initial system startup is provided by the <em>/etc/init/rc-sysinit.conf</em> job.  This is run on the <a href="../man7/startup.7.html"><strong>startup</strong>(7)</a> event, and is primarily responsible for running the <strong>/etc/init.d/rc</strong> script with the special <strong>S</strong> argument and calling <a href="../man8/telinit.8.html"><strong>telinit</strong>(8)</a> to switch into the default runlevel when done.  This also handles the <strong>-b</strong>, <strong>emergency</strong>, <strong>-s</strong> and <strong>single</strong> kernel command-line options as well as specifying an alternate runlevel on the kernel command-line.</p><p>Finally the <em>/etc/init/rcS.conf</em> job handles the special case of entering the single-user runlevel and providing a login shell.  Once that shell terminates, this restarts the <em>rc-sysinit</em> job to re-enter the default runlevel.</p>
<h3>Implementation of runlevels in Upstart</h3>
<p>The Upstart <a href="../man8/init.8.html"><strong>init</strong>(8)</a> daemon has no native concepts of runlevel, and unlike the System V daemon, makes no attempt to keep track of the current runlevel.</p><p>Instead a compatible implementation is provided by the <a href="../man8/runlevel.8.html"><strong>runlevel</strong>(8)</a>, <a href="../man8/telinit.8.html"><strong>telinit</strong>(8)</a> and <a href="../man8/shutdown.8.html"><strong>shutdown</strong>(8)</a> tools supplied with Upstart.</p><p>The <a href="../man8/telinit.8.html"><strong>telinit</strong>(8)</a> and <a href="../man8/shutdown.8.html"><strong>shutdown</strong>(8)</a> tools are used by system administrators to change the runlevel, thus they both generate this <strong>runlevel</strong> event obtaining the value for the <strong>PREVLEVEL</strong> environment variable from their own environment (the <strong>RUNLEVEL</strong> variable) or the <em>/var/run/utmp</em> file.</p><p>Additionally they update the <em>/var/run/utmp</em> file with the new runlevel, and append a log entry to the <em>/var/log/wtmp</em> file.</p><p>The <a href="../man8/runlevel.8.html"><strong>runlevel</strong>(8)</a> tool may be used by system administrators to obtain the current runlevel, this reads the <strong>RUNLEVEL</strong> and <strong>PREVLEVEL</strong> variables from its own environment or reads the current and previous runlevel from <em>/var/run/utmp</em>.</p><p>The <a href="../man1/who.1.html"><strong>who</strong>(1)</a> <strong>-r</strong> command may also be used to read the current runlevel from <em>/var/run/utmp</em>.</p><p>This provides full compatibility with System V.</p><p>During the boot scripts, where the <em>/var/run/utmp</em> file may not yet be writable, the <strong>RUNLEVEL</strong> and <strong>PREVLEVEL</strong> environment variables will be available so <a href="../man8/telinit.8.html"><strong>telinit</strong>(8)</a> will still provide the correct values.</p><p>Once the boot scripts have finished, while the environment variables may no longer be available, the <em>/var/run/utmp</em> file will be and the most recent <a href="../man8/telinit.8.html"><strong>telinit</strong>(8)</a> invocation should have successfully written to it.</p>
<h3>Boot time records</h3>
<p>The <a href="../man8/telinit.8.html"><strong>telinit</strong>(8)</a> tool also takes care of writing the boot time record to both <em>/var/run/utmp</em> and <em>/var/log/wtmp</em>.</p><p>This is written if the previous runlevel in these files does not match the previous runlevel obtained from its environment.  In general this occurs when switching from runlevel <strong>S</strong> to the default runlevel, at which point the <em>/var/run/utmp</em> and <em>/var/log/wtmp</em> files are both writable, and the <a href="../man8/telinit.8.html"><strong>telinit</strong>(8)</a> invocation to do the switch has <strong>RUNLEVEL</strong>=<em>S</em> in its environment.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>A service running in the typical multi-user runlevels might use:</p>
<pre>
start on runlevel [2345]
stop on runlevel [!2345]
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO runlevel&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/runlevel.8.html"><strong>runlevel</strong>(8)</a> <a href="../man8/init.8.html"><strong>init</strong>(8)</a> <a href="../man8/telinit.8.html"><strong>telinit</strong>(8)</a> <a href="../man8/shutdown.8.html"><strong>shutdown</strong>(8)</a> <a href="../man1/who.1.html"><strong>who</strong>(1)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="rtnetlink.7.html"><span aria-hidden="true">&larr;</span> rtnetlink.7: Linux ipv4 routing socket</a></li>
   <li class="next"><a href="runtime_tools.7.html">runtime_tools.7: The runtime tools application <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
