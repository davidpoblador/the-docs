<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>rdup-backups: Introduction into making backups with rdup</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Introduction into making backups with rdup">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="rdup-backups (7) manual">
  <meta name="twitter:description" content="Introduction into making backups with rdup">
  <meta name="twitter:image" content="https://www.carta.tech/images/rdup-rdup-backups-7.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man7/rdup-backups.7.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="rdup-backups (7) manual" />
  <meta property="og:description" content="Introduction into making backups with rdup" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/rdup-rdup-backups-7.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">rdup-backups<small> (7)</small></h1>
        <p class="lead">Introduction into making backups with rdup</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/">
      <span itemprop="name">Miscellaneous</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/rdup-backups.7.html">
      <span itemprop="name">rdup-backups: Introduction into making backups with rdup</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/rdup/">
      <span itemprop="name">rdup</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/rdup-backups.7.html">
      <span itemprop="name">rdup-backups: Introduction into making backups with rdup</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">INTRODUCTION</h2>
        <div class="sectioncontent">
<p><strong>rdup</strong> is a simple program that prints out a list of files and directories that are changed changed on a filesystem. It is more sophisticated than for instance <em>find</em>, because <strong>rdup</strong> will find files that are removed or directories that are renamed.</p><p>A long time ago <strong>rdup</strong> included a bunch of shell and Perl scripts that implemented a backup policy. These could be used in a pipeline to perform a backup.</p><p>Currently <strong>rdup</strong> consists out of three basic utilities:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>rdup</strong></p>
  </dt>
  <dd>
    <p>With <strong>rdup</strong> you create the file list on which later programs in the pipeline can work. The default output format also includes the files' content. <strong>rdup</strong> can be seen as a tar replacement in this respect, but <strong>rdup</strong> also allows for all kinds of transformations of the content (encryption, compression, reversal), see the -P switch in <a href="../man1/rdup.1.html"><strong>rdup</strong>(1)</a> for more information.</p>
  </dd>
  <dt>
    <p><strong>rdup-tr</strong></p>
  </dt>
  <dd>
    <p>With <strong>rdup-tr</strong> you can transform the files rdup delivers to you. You can create tar, cpio or pax files. You can encrypt pathnames. <strong>rdup-tr</strong> is filter that reads from standard input and writes to standard output. See <a href="../man1/rdup-tr.1.html"><strong>rdup-tr</strong>(1)</a> for more information. With <strong>rdup</strong> and <strong>rdup-tr</strong> you can create an encrypted archive which is put in a directory structure that is also encrypted.</p>
  </dd>
  <dt>
    <p><strong>rdup-up</strong></p>
  </dt>
  <dd>
    <p>With <strong>rdup-up</strong> you can update an existing directory structure with the updates as described by rdup.</p><p><strong>rdup-up</strong> reads <strong>rdup</strong> input and will create the files, symbolic links, hard links and directories (and sockets, pipes and devices) in the file system. See <a href="../man1/rdup-up.1.html"><strong>rdup-up</strong>(1)</a> for more information.</p>
  </dd>

</dl>
<p>So the general backup pipeline for <strong>rdup</strong> will look something like this:</p>
<pre>
    create filelist  |  transform |  update filesystem
    ( rdup           |  rdup-tr   |  rdup-up )
</pre>

<dl class='dl-vertical'>
  <dt>
    <p><strong>Note 1:</strong></p>
  </dt>
  <dd>
    <p>The same sequence is used for restoring. In both cases you want to move files from location A to B. The only difference is that the transformation is reversed when you restore.</p>
  </dd>
  <dt>
    <p><strong>Note 2:</strong></p>
  </dt>
  <dd>
    <p>The use of <strong>rdup-tr</strong> is optional.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BACKUPS AND RESTORES</h2>
        <div class="sectioncontent">
<p>For <strong>rdup</strong> there is <em>no</em> difference between backups and restores. If you think about this for a minute you understand why.</p><p>Making a backup means copying a list of files somewhere else. Restoring files is copying a list of files back to the place they came from. Same difference. So <strong>rdup</strong> can be used for both, if you did any transformation with <strong>rdup</strong> during the backup you just need to reverse those operations during the restore.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BACKUPS</h2>
        <div class="sectioncontent">
<p>It is always best to backup to <em>another</em> medium, be it a different local harddisk or a NFS/CIFS mounted filesystem. You can also use <em>ssh</em> to store file on a remote server, ala rsync (although not as network efficient).</p><p>If you backup to a local disk you can just as well use <strong>rsync</strong> or plain old tar, but if you store your files at somebody else's disk you will need encryption. This is where you go beyond <strong>rsync</strong> and <strong>rdup</strong> comes in. Rsync cannot do per-file encryption, sure you can encrypt the network traffic with ssh, but at the remote side your files are kept in plain view.</p><p>If you implement remote backups, the easy route is to allow root access on the backup medium. If the backup runs without root access the created files will not have their original ownership. For NFS this can be achieved by using <strong>no_root_squash</strong>, for <strong>ssh</strong> you could enable <em>PermitRootLogin</em>. Note that this may be a security risk.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SNAPSHOT BACKUPS</h2>
        <div class="sectioncontent">
<p>We need a little help here in the form of the <strong>rdup-simple</strong> script. Keep in mind that the following scripts can also be run remotely with the help of <strong>ssh</strong>.</p><p>The following script implements the algorithm of <strong>rdup-simple</strong>.</p>
<pre>
#!/bin/bash
# some tmp files are saved in ~/.rdup. This directory must exist
DIR=/home	    # what to backup
BACKUP=/vol/backup
TODAY=$(date +%Y%m/%d)
LIST=~/.rdup/list-$HOSTNAME
STAMP=~/.rdup/timestamp-$HOSTNAME

# for remote backup, this has to run on the remote host!
BUGBUG
RET=$?

case $RET in
    2|*)
	echo Error &gt;&2
	exit 1
	;;
    1)
	# full dump, remove file-list and time-stamp file
	rm $LIST $STAMP
	;;
    0)
	# inc dump
	# do nothing here
	;;
esac
# this is the place where you want to modify the command line
# right now, nothing is translated we just use 'cat'
rdup -N $STAMP -Pcat $LIST $DIR | rdup-up $BACKUP/$HOSTNAME/$TODAY

# or do a remote backup
#rdup -N $STAMP -Pcat $LIST $DIR | ssh root@remotehost &#92;
#	rdup-up $BACKUP/$HOSTNAME/$TODAY
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOCAL BACKUPS</h2>
        <div class="sectioncontent">
<p>With <strong>rdup-simple</strong> you can easily create backups. Backing up my home directory to a backup directory:</p><p>rdup-simple ~ /vol/backup/$HOSTNAME</p><p>This will create a backup in /vol/backup/$HOSTNAME/200705/15. So each day will have its own directory. Multiple sources are allowed, so:</p><p>rdup-simple ~ /etc/ /var/lib /vol/backup/$HOSTNAME</p><p>Will backup your home directory, /etc and /var/lib to the backup location. Also if you need to compress your backup, simple add a '-z' switch:</p><p>rdup-simple -z ~ /etc/ /var/lib /vol/backup/$HOSTNAME</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REMOTE BACKUPS</h2>
        <div class="sectioncontent">
<p>For a remote backup to work, both the sending machine and the receiving machine must have <strong>rdup</strong> installed. The currently implemented protocol is <em>ssh</em>.</p><p>Dumping my homedir to the remote server:</p><p>rdup-simple ~ ssh://miekg@remote/vol/backup/$HOSTNAME</p><p>The syntax is almost identical, only the destination starts with the magic string 'ssh://'. Compression and encryption are just as easily enabled as with a local backup, just add '-z' and/or a '-k keyfile' argument:</p><p>rdup-simple -z -k 'secret-file' ~ ssh://miekg@remote/vol/backup/$HOSTNAME</p><p>Remember though, that because of these advanced features (compression, encryption, etc, ...) the network transfer can never be as efficient as <strong>rsync</strong>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ALSO SEE</h2>
        <div class="sectioncontent">
<p><a href="../man1/rdup.1.html"><strong>rdup</strong>(1)</a>, <a href="../man1/rdup-tr.1.html"><strong>rdup-tr</strong>(1)</a>, <a href="../man1/rdup-up.1.html"><strong>rdup-up</strong>(1)</a> and http://www.miek.nl/projects/rdup/</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="rdma_cm.7.html"><span aria-hidden="true">&larr;</span> rdma_cm.7: Rdma communication manager.</a></li>
   <li class="next"><a href="re_format.7.html">re_format.7: Posix.2 regular expressions <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
