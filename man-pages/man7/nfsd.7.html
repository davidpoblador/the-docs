<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>nfsd: Special filesystem for controlling linux nfs server</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Special filesystem for controlling linux nfs server">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="nfsd (7) manual">
  <meta name="twitter:description" content="Special filesystem for controlling linux nfs server">
  <meta name="twitter:image" content="https://www.carta.tech/images/nfs-kernel-server-nfsd-7.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man7/nfsd.7.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="nfsd (7) manual" />
  <meta property="og:description" content="Special filesystem for controlling linux nfs server" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/nfs-kernel-server-nfsd-7.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">nfsd<small> (7)</small></h1>
        <p class="lead">Special filesystem for controlling linux nfs server</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/">
      <span itemprop="name">Miscellaneous</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/nfsd.7.html">
      <span itemprop="name">nfsd: Special filesystem for controlling linux nfs server</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/nfs-kernel-server/">
      <span itemprop="name">nfs-kernel-server</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/nfsd.7.html">
      <span itemprop="name">nfsd: Special filesystem for controlling linux nfs server</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNPOSIS</h2>
        <div class="sectioncontent">
<p><strong>mount -t nfsd nfsd /proc/fs/nfsd</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <strong>nfsd</strong> filesystem is a special filesystem which provides access to the Linux NFS server.  The filesystem consists of a single directory which contains a number of files.  These files are actually gateways into the NFS server.  Writing to them can affect the server.  Reading from them can provide information about the server.</p><p>This file system is only available in Linux 2.6 and later series kernels (and in the later parts of the 2.5 development series leading up to 2.6).  This man page does not apply to 2.4 and earlier.</p><p>As well as this filesystem, there are a collection of files in the <strong>procfs</strong> filesystem (normally mounted at <strong>/proc</strong>) which are used to control the NFS server. This manual page describes all of these files.</p><p>The <em>exportfs</em> and <em>mountd</em> programs (part of the nfs-utils package) expect to find this filesystem mounted at <strong>/proc/fs/nfsd</strong> or <strong>/proc/fs/nfs</strong>. If it is not mounted, they will fall-back on 2.4 style functionality. This involves accessing the NFS server via a systemcall.  This systemcall is scheduled to be removed after the 2.6 kernel series.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DETAILS</h2>
        <div class="sectioncontent">
<p>The three files in the <strong>nfsd</strong> filesystem are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>exports</strong></p>
  </dt>
  <dd>
    <p>This file contains a list of filesystems that are currently exported and clients that each filesystem is exported to, together with a list of export options for that client/filesystem pair.  This is similar to the <strong>/proc/fs/nfs/exports</strong> file in 2.4. One difference is that a client doesn't necessarily correspond to just one host.  It can respond to a large collection of hosts that are being treated identically.</p><p>Each line of the file contains a path name, a client name, and a number of options in parentheses.  Any space, tab, newline or back-slash character in the path name or client name will be replaced by a backslash followed by the octal ASCII code for that character.</p>
  </dd>
  <dt>
    <p><strong>threads</strong></p>
  </dt>
  <dd>
    <p>This file represents the number of <strong>nfsd</strong> thread currently running.  Reading it will show the number of threads.  Writing an ASCII decimal number will cause the number of threads to be changed (increased or decreased as necessary) to achieve that number.</p>
  </dd>
  <dt>
    <p><strong>filehandle</strong></p>
  </dt>
  <dd>
    <p>This is a somewhat unusual file  in that what is read from it depends on what was just written to it.  It provides a transactional interface where a program can open the file, write a request, and read a response.  If two separate programs open, write, and read at the same time, their requests will not be mixed up.</p><p>The request written to <strong>filehandle</strong> should be a client name, a path name, and a number of bytes.  This should be followed by a newline, with white-space separating the fields, and octal quoting of special characters.</p><p>On writing this, the program will be able to read back a filehandle for that path as exported to the given client.  The filehandle's length will be at most the number of bytes given.</p><p>The filehandle will be represented in hex with a leading '&#92;x'.</p>
  </dd>

</dl>
<p>The directory <strong>/proc/net/rpc</strong> in the <strong>procfs</strong> filesystem contains a number of files and directories. The files contain statistics that can be display using the <em>nfsstat</em> program. The directories contain information about various caches that the NFS server maintains to keep track of access permissions that different clients have for different filesystems. The caches are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>auth.domain</strong></p>
  </dt>
  <dd>
    <p>This cache maps the name of a client (or domain) to an internal data structure.  The only access that is possible is to flush the cache.</p>
  </dd>
  <dt>
    <p><strong>auth.unix.ip</strong></p>
  </dt>
  <dd>
    <p>This cache contains a mapping from IP address to the name of the authentication domain that the ipaddress should be treated as part of.</p>
  </dd>
  <dt>
    <p><strong>nfsd.export</strong></p>
  </dt>
  <dd>
    <p>This cache contains a mapping from directory and domain to export options.</p>
  </dd>
  <dt>
    <p><strong>nfsd.fh</strong></p>
  </dt>
  <dd>
    <p>This cache contains a mapping from domain and a filesystem identifier to a directory.   The filesystem identifier is stored in the filehandles and consists of a number indicating the type of identifier and a number of hex bytes indicating the content of the identifier.</p>
  </dd>

</dl>
<p>Each directory representing a cache can hold from 1 to 3 files.  They are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>flush</strong></p>
  </dt>
  <dd>
    <p>When a number of seconds since epoch (1 Jan 1970) is written to this file, all entries in the cache that were last updated before that file become invalidated and will be flushed out.  Writing 1 will flush everything.  This is the only file that will always be present.</p>
  </dd>
  <dt>
    <p><strong>content</strong></p>
  </dt>
  <dd>
    <p>This file, if present, contains a textual representation of ever entry in the cache, one per line.  If an entry is still in the cache (because it is actively being used) but has expired or is otherwise invalid, it will be presented as a comment (with a leading hash character).</p>
  </dd>
  <dt>
    <p><strong>channel</strong></p>
  </dt>
  <dd>
    <p>This file, if present, acts a channel for request from the kernel-based nfs server to be passed to a user-space program for handling.</p><p>When the kernel needs some information which isn't in the cache, it makes a line appear in the <strong>channel</strong> file giving the key for the information.  A user-space program should read this, find the answer, and write a line containing the key, an expiry time, and the content. For example the kernel might make nfsd 127.0.0.1</p><p>appear in the <strong>auth.unix.ip/content</strong> file.  The user-space program might then write nfsd 127.0.0.1 1057206953 localhost</p><p>to indicate that 127.0.0.1 should map to localhost, at least for now.</p><p>If the program uses <a href="../man2/select.2.html"><strong>select</strong>(2)</a> or <a href="../man2/poll.2.html"><strong>poll</strong>(2)</a> to discover if it can read from the <strong>channel</strong> then it will never see and end-of-file but when all requests have been answered, it will block until another request appears.</p>
  </dd>

</dl>
<p>In the <strong>/proc</strong> filesystem there are 4 files that can be used to enabled extra tracing of nfsd and related code.  They are: <strong>/proc/sys/sunrpc/nfs_debug</strong></p><p><strong>/proc/sys/sunrpc/nfsd_debug</strong></p><p><strong>/proc/sys/sunrpc/nlm_debug</strong></p><p><strong>/proc/sys/sunrpc/rpc_debug</strong></p><p>They control tracing for the NFS client, the NFS server, the Network Lock Manager (lockd) and the underlying RPC layer respectively. Decimal numbers can be read from or written to these files.  Each number represents a bit-pattern where bits that are set cause certain classes of tracing to be enabled.  Consult the kernel header files to find out what number correspond to what tracing.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO nfsd&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/nfsd.8.html"><strong>nfsd</strong>(8)</a>, <a href="../man8/rpc.nfsd.8.html"><strong>rpc.nfsd</strong>(8)</a>, <a href="../man5/exports.5.html"><strong>exports</strong>(5)</a>, <a href="../man8/nfsstat.8.html"><strong>nfsstat</strong>(8)</a>, <a href="../man8/mountd.8.html"><strong>mountd</strong>(8)</a> <a href="../man8/exportfs.8.html"><strong>exportfs</strong>(8)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>NeilBrown</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="netlink.7.html"><span aria-hidden="true">&larr;</span> netlink.7: Communication between kernel and user space (af_netlink)</a></li>
   <li class="next"><a href="notmuch-search-terms.7.html">notmuch-search-terms.7: Syntax for notmuch queries <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
