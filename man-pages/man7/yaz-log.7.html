<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>yaz-log: Log handling in all yaz-based programs</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Log handling in all yaz-based programs">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="yaz-log (7) manual">
  <meta name="twitter:description" content="Log handling in all yaz-based programs">
  <meta name="twitter:image" content="https://www.carta.tech/images/yaz-yaz-log-7.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man7/yaz-log.7.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="yaz-log (7) manual" />
  <meta property="og:description" content="Log handling in all yaz-based programs" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/yaz-yaz-log-7.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">yaz-log<small> (7)</small></h1>
        <p class="lead">Log handling in all yaz-based programs</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/">
      <span itemprop="name">Miscellaneous</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/yaz-log.7.html">
      <span itemprop="name">yaz-log: Log handling in all yaz-based programs</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/yaz/">
      <span itemprop="name">yaz</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/yaz-log.7.html">
      <span itemprop="name">yaz-log: Log handling in all yaz-based programs</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>yaz-XXXX</strong> [<strong>-v&nbsp;</strong><strong></strong><em>loglevel,...</em>] [<strong>-l&nbsp;</strong><strong></strong><em>logfile</em>]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>All YAZ-based programs use a common log subsystem, and should support common command line options for controlling it. This man page documents those.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>-l<em> logfile</em></p><p>Specify the file where the log is to be written. If none is specified, stderr is used. The log is appended to this file. If the file grows overly large, it is silently rotated: It is renamed to <em>logfile</em>.1, <em>logfile</em>.2, .., 9 (old such file is deleted), and a new file is opened. The limit defaults to 1GB, but can be set by the program. The rotating limit can be specified with option -r for the YAZ frontend server (yaz-ztest).</p><p>Rotation can also be implicitly enabled by using a filename which gets changed for a given date, due to substitutions as given by the <a href="../man3/strftime.3.html"><strong>strftime</strong>(3)</a> function.</p><p>-v<em> loglevel</em></p><p>Specify the logging level. The argument is a set of log level names, separated by commas (no whitespace!), optionally preceded by a &apos;-&apos; to negate that level. Most programs have their own default, often containing fatal,warn,log, and some application-specific values. The default list can be cleared with the word none, or individual bits can be removed by prefixing them with a dash &apos;-&apos;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOG LEVELS TO CONTROL LOGGING</h2>
        <div class="sectioncontent">
<p>Some of the log levels control the way the log is written.</p><p>flush causes the log to be flushed after every write. This can have serious implications to performance, and should not be used in production. On the other hand, when debugging a program crash, this can be extremely useful. The option debug implies flush as well.</p><p>notime prevents the writing of time stamps. This is intended for automatic test scripts, which should produce predictable log files that are easy to compare.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">GENERAL LOG LEVELS IN YAZ ITSELF</h2>
        <div class="sectioncontent">
<p>YAZ itself uses the following log levels:</p><p>fatal for fatal errors, that prevent further execution of the program.</p><p>warn for warnings about things that should be corrected.</p><p>debug for debugging. This flag may be used temporarily when developing or debugging yaz, or a program that uses yaz. It is practically deprecated, you should be defining and using your own log levels (see below).</p><p>all turns on almost all hard-coded log levels.</p><p>loglevel logs information about the log levels used by the program. Every time the log level is changed, lists all bits that are on. Every time a module asks for its log bits, this is logged. This can be used for getting an idea of what log levels are available in any program that uses yaz-log. Start the program with -v none,loglevel, and do some common operations with it. Another way is to grep for <strong>yaz_log_module_level</strong> in the source code, as in</p>
<pre>
      find . -name &apos;*.[ch]&apos; -print |
         xargs grep yaz_log_module_level |
         grep &apos;"&apos; |
         cut -d&apos;"&apos; -f2 |
         sort -u

</pre>
<p>eventl, malloc, nmem, odr are used internally for debugging yaz.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOG LEVELS FOR CLIENTS</h2>
        <div class="sectioncontent">
<p>zoom logs the calls to the zoom API, which may be useful in debugging client applications.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOG LEVELS FOR SERVERS</h2>
        <div class="sectioncontent">
<p>server logs the server functions on a high level, starting up, listening on a port, etc.</p><p>session logs individual sessions (connections).</p><p>request logs a one-liner for each request (init, search, etc).</p><p>requestdetail logs the details of every request, before it is passed to the back-end, and the results received from it.</p><p>Each server program (zebra, etc) is supposed to define its own log levels in addition to these. As they depend on the server in question, they can not be described here. See above how to find out about them.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOGGING EXAMPLES</h2>
        <div class="sectioncontent">
<p>See what log levels yaz-ztest is using:</p>
<pre>
    yaz-ztest -1 -v none,loglevel
    14:43:29-23/11 [loglevel] Setting log level to 4096 = 0x00001000
    14:43:29-23/11 [loglevel] Static  log bit 00000001 &apos;fatal&apos; is off
    14:43:29-23/11 [loglevel] Static  log bit 00000002 &apos;debug&apos; is off
    14:43:29-23/11 [loglevel] Static  log bit 00000004 &apos;warn&apos; is off
    14:43:29-23/11 [loglevel] Static  log bit 00000008 &apos;log&apos; is off
    14:43:29-23/11 [loglevel] Static  log bit 00000080 &apos;malloc&apos; is off
    14:43:29-23/11 [loglevel] Static  log bit 00000800 &apos;flush&apos; is off
    14:43:29-23/11 [loglevel] Static  log bit 00001000 &apos;loglevel&apos; is ON
    14:43:29-23/11 [loglevel] Static  log bit 00002000 &apos;server&apos; is off
    14:43:29-23/11 [loglevel] Dynamic log bit 00004000 &apos;session&apos; is off
    14:43:29-23/11 [loglevel] Dynamic log bit 00008000 &apos;request&apos; is off
    14:44:13-23/11 yaz-ztest [loglevel] returning log bit 0x4000 for &apos;session&apos;
    14:44:13-23/11 yaz-ztest [loglevel] returning log bit 0x2000 for &apos;server&apos;
    14:44:13-23/11 yaz-ztest [loglevel] returning NO log bit for &apos;eventl&apos;
    14:44:20-23/11 yaz-ztest [loglevel] returning log bit 0x4000 for &apos;session&apos;
    14:44:20-23/11 yaz-ztest [loglevel] returning log bit 0x8000 for &apos;request&apos;
    14:44:20-23/11 yaz-ztest [loglevel] returning NO log bit for &apos;requestdetail&apos;
    14:44:20-23/11 yaz-ztest [loglevel] returning NO log bit for &apos;odr&apos;
    14:44:20-23/11 yaz-ztest [loglevel] returning NO log bit for &apos;ztest&apos;

</pre>
<p>See the details of the requests for yaz-ztest</p>
<pre>
   ./yaz-ztest -1 -v requestdetail
   14:45:35-23/11 yaz-ztest [server] Adding static Z3950 listener on tcp:@:9999
   14:45:35-23/11 yaz-ztest [server] Starting server ./yaz-ztest pid=32200
   14:45:38-23/11 yaz-ztest [session] Starting session from tcp:127.0.0.1 (pid=32200)
   14:45:38-23/11 yaz-ztest [requestdetail] Got initRequest
   14:45:38-23/11 yaz-ztest [requestdetail] Id:        81
   14:45:38-23/11 yaz-ztest [requestdetail] Name:      YAZ
   14:45:38-23/11 yaz-ztest [requestdetail] Version:   2.0.28
   14:45:38-23/11 yaz-ztest [requestdetail] Negotiated to v3: srch prst del extendedServices namedresults scan sort
   14:45:38-23/11 yaz-ztest [request] Init from &apos;YAZ&apos; (81) (ver 2.0.28) OK
   14:45:39-23/11 yaz-ztest [requestdetail] Got SearchRequest.
   14:45:39-23/11 yaz-ztest [requestdetail] ResultSet &apos;1&apos;
   14:45:39-23/11 yaz-ztest [requestdetail] Database &apos;Default&apos;
   14:45:39-23/11 yaz-ztest [requestdetail] RPN query. Type: Bib-1
   14:45:39-23/11 yaz-ztest [requestdetail]  term &apos;foo&apos; (general)
   14:45:39-23/11 yaz-ztest [requestdetail] resultCount: 7
   14:45:39-23/11 yaz-ztest [request] Search Z: @attrset Bib-1 foo  OK:7 hits
   14:45:41-23/11 yaz-ztest [requestdetail] Got PresentRequest.
   14:45:41-23/11 yaz-ztest [requestdetail] Request to pack 1+1 1
   14:45:41-23/11 yaz-ztest [requestdetail] pms=1048576, mrs=1048576
   14:45:41-23/11 yaz-ztest [request] Present: [1] 1+1  OK 1 records returned

</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOG FILENAME EXAMPLES</h2>
        <div class="sectioncontent">
<p>A file with format my_YYYYMMDD.log is where Y, M, D is year, month, and day digits is given as follows -l my_%Y%m%d.log . And since the filename is depending on day, rotaion will occur on midnight.</p><p>A weekly log could be specified as -l my_%Y%U.log.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p><em>prefix</em>/include/yaz/log.h<em>prefix</em>/src/log.c</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO yaz-log&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man7/yaz.7.html"><strong>yaz</strong>(7)</a><a href="../man8/yaz-ztest.8.html"><strong>yaz-ztest</strong>(8)</a><a href="../man1/yaz-client.1.html"><strong>yaz-client</strong>(1)</a><a href="../man3/strftime.3.html"><strong>strftime</strong>(3)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="yaz.7.html"><span aria-hidden="true">&larr;</span> yaz.7: Z39.50 toolkit.</a></li>
   <li class="next"><a href="libzmq-dev-zmq.7.html">zmq.7: 0mq lightweight messaging kernel <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
