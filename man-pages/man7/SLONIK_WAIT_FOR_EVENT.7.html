<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SLONIK_WAIT_FOR_EVENT: Have slonik script wait for previous event to complete</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Have slonik script wait for previous event to complete">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="SLONIK_WAIT_FOR_EVENT (7) manual">
  <meta name="twitter:description" content="Have slonik script wait for previous event to complete">
  <meta name="twitter:image" content="https://www.carta.tech/images/slony1-2-doc-SLONIK_WAIT_FOR_EVENT-7.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man7/SLONIK_WAIT_FOR_EVENT.7.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="SLONIK_WAIT_FOR_EVENT (7) manual" />
  <meta property="og:description" content="Have slonik script wait for previous event to complete" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/slony1-2-doc-SLONIK_WAIT_FOR_EVENT-7.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">SLONIK_WAIT_FOR_EVENT<small> (7)</small></h1>
        <p class="lead">Have slonik script wait for previous event to complete</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/">
      <span itemprop="name">Miscellaneous</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/SLONIK_WAIT_FOR_EVENT.7.html">
      <span itemprop="name">SLONIK_WAIT_FOR_EVENT: Have slonik script wait for previous event to complete</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/slony1-2-doc/">
      <span itemprop="name">slony1-2-doc</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/SLONIK_WAIT_FOR_EVENT.7.html">
      <span itemprop="name">SLONIK_WAIT_FOR_EVENT: Have slonik script wait for previous event to complete</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>WAIT FOR EVENT (options);</strong> \kx</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Waits for event Confirmation.</p><p>Slonik remembers the last event generated on every node during script execution (events generated by earlier calls are currently not checked). In certain situations it is necessary that events generated on one node (such as <strong>CREATE SET</strong>) are processed on another node before issuing more commands (for instance, <strong>SLONIK SUBSCRIBE <a href="../man7/SET.7.html"><strong>SET</strong>(7)</a></strong>). <strong>WAIT FOR EVENT</strong> may be used to cause the slonik script to wait for confirmation of an event, which hopefully means that the subscriber node is ready for the next action.</p><p><strong>WAIT FOR EVENT</strong> must be called outside of any <strong>try</strong> block in order to work, since new confirm messages don't become visible within a transaction.</p>
<dl class='dl-vertical'>
  <dt>
    <p>\*(T&lt;ORIGIN = ival | ALL \*(T&gt;</p>
  </dt>
  <dd>
    <p>The origin of the event(s) to wait for.</p>
  </dd>
  <dt>
    <p>\*(T&lt;CONFIRMED = ival | ALL \*(T&gt;</p>
  </dt>
  <dd>
    <p>The node ID of the receiver that must confirm the event(s).</p>
  </dd>
  <dt>
    <p>\*(T&lt;WAIT ON = ival \*(T&gt;</p>
  </dt>
  <dd>
    <p>The ID of the node where the &ldquo;sl_confirm&rdquo; [not available as a man page] table is to be checked.</p>
  </dd>
  <dt>
    <p>\*(T&lt;TIMEOUT = ival \*(T&gt;</p>
  </dt>
  <dd>
    <p>The number of seconds to wait. Default is 600 (10 minutes). <strong>TIMEOUT = 0</strong> causes the script to wait indefinitely.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<pre>
\*(T&lt;WAIT FOR EVENT (
  ORIGIN = ALL,
  CONFIRMED = ALL,
  WAIT ON = 1
);
    \*(T&gt;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOCKING BEHAVIOUR </h2>
        <div class="sectioncontent">
<p>No application-visible locking should take place.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VERSION INFORMATION </h2>
        <div class="sectioncontent">
<p>This command was introduced in Slony-I 1.0</p><p>In version 2.0, the default value for <strong>WAIT ON</strong> was removed, so a node must be specified.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ODDITIES </h2>
        <div class="sectioncontent">
<p>Not all events return interesting results. For instance, many people have run afoul of problems with <strong>SLONIK SUBSCRIBE <a href="../man7/SET.7.html"><strong>SET</strong>(7)</a></strong>, when subscribing a new set. Be aware (and beware!) that a <strong>SLONIK SUBSCRIBE <a href="../man7/SET.7.html"><strong>SET</strong>(7)</a></strong> request will return the event confirmation almost immediately, even though there might be several hours of work to do before the subscription is ready. The trouble with <strong>SLONIK SUBSCRIBE <a href="../man7/SET.7.html"><strong>SET</strong>(7)</a></strong> is that it is processed as <em>two</em> events, one on the origin node, with a second event, to enable the subscription, on the subscriber.</p><p>In order to more reliably monitor from within a <a href="../man1/slonik.1.html"><strong>slonik</strong>(1)</a> script that <strong>SLONIK SUBSCRIBE <a href="../man7/SET.7.html"><strong>SET</strong>(7)</a></strong> is complete, you may submit a <strong>SLONIK <strong>SYNC</strong>(7)</strong> event after the subscription, and have the WAIT request wait on the <strong>SYNC</strong> event, as follows.</p>
<pre>
\*(T&lt;     # Assuming that node 1 is the origin for set 999 that has direct subscribers 2 and 3
     SUBSCRIBE SET (ID = 999, PROVIDER = 1, RECEIVER = 2);
     WAIT FOR EVENT (ORIGIN = 1, CONFIRMED = ALL, WAIT ON=1);
     SUBSCRIBE SET (ID = 999, PROVIDER = 1, RECEIVER = 3);
     WAIT FOR EVENT (ORIGIN = 1, CONFIRMED = ALL, WAIT ON=1);
     MERGE SET ( ID = 1, ADD ID = 999, ORIGIN = 1 );
    \*(T&gt;
</pre>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="SLONIK_UPDATE_FUNCTIONS.7.html"><span aria-hidden="true">&larr;</span> SLONIK_UPDATE_FUNCTIONS.7: Reload stored functions</a></li>
   <li class="next"><a href="SNMP-COMMUNITY-MIB.7.html">SNMP-COMMUNITY-MIB.7: The erlang/otp mib module for supporting coexistence between snmpv1, snmpv2, and snmpv3 <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
