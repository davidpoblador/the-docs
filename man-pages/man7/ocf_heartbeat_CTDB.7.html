<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ocf_heartbeat_CTDB: Ctdb resource agent</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Ctdb resource agent">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="ocf_heartbeat_CTDB (7) manual">
  <meta name="twitter:description" content="Ctdb resource agent">
  <meta name="twitter:image" content="https://www.carta.tech/images/resource-agents-ocf_heartbeat_CTDB-7.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man7/ocf_heartbeat_CTDB.7.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ocf_heartbeat_CTDB (7) manual" />
  <meta property="og:description" content="Ctdb resource agent" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/resource-agents-ocf_heartbeat_CTDB-7.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">ocf_heartbeat_CTDB<small> (7)</small></h1>
        <p class="lead">Ctdb resource agent</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/">
      <span itemprop="name">Miscellaneous</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/ocf_heartbeat_CTDB.7.html">
      <span itemprop="name">ocf_heartbeat_CTDB: Ctdb resource agent</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/resource-agents/">
      <span itemprop="name">resource-agents</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/ocf_heartbeat_CTDB.7.html">
      <span itemprop="name">ocf_heartbeat_CTDB: Ctdb resource agent</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>CTDB</strong> [start | stop | monitor | meta-data | validate-all]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This resource agent manages CTDB, allowing one to use Clustered Samba in a Linux-HA/Pacemaker cluster. You need a shared filesystem (e.g. OCFS2) on which the CTDB lock will be stored. Create /etc/ctdb/nodes containing a list of private IP addresses of each node in the cluster, then configure this RA as a clone. To have CTDB manage Samba, set ctdb_manages_samba="yes". Note that this option will be deprecated in future, in favour of configuring a separate Samba resource.</p><p>For more information see http://linux-ha.org/wiki/CTDB_(resource_agent)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SUPPORTED PARAMETERS</h2>
        <div class="sectioncontent">
<p><strong>ctdb_recovery_lock</strong></p><p>The location of a shared lock file, common across all nodes. This must be on shared storage, e.g.: /shared-fs/samba/ctdb.lock</p><p>(unique, required, string, no default)</p><p><strong>ctdb_manages_samba</strong></p><p>Should CTDB manage starting/stopping the Samba service for you? This will be deprecated in future, in favor of configuring a separate Samba resource.</p><p>(optional, boolean, default no)</p><p><strong>ctdb_manages_winbind</strong></p><p>Should CTDB manage starting/stopping the Winbind service for you? This will be deprecated in future, in favor of configuring a separate Winbind resource.</p><p>(optional, boolean, default no)</p><p><strong>ctdb_service_smb</strong></p><p>Name of smb init script. Only necessary if CTDB is managing Samba directly. Will usually be auto-detected.</p><p>(optional, string, no default)</p><p><strong>ctdb_service_nmb</strong></p><p>Name of nmb init script. Only necessary if CTDB is managing Samba directly. Will usually be auto-detected.</p><p>(optional, string, no default)</p><p><strong>ctdb_service_winbind</strong></p><p>Name of winbind init script. Only necessary if CTDB is managing Winbind directly. Will usually be auto-detected.</p><p>(optional, string, no default)</p><p><strong>ctdb_samba_skip_share_check</strong></p><p>If there are very many shares it may not be feasible to check that all of them are available during each monitoring interval. In that case this check can be disabled.</p><p>(optional, boolean, default yes)</p><p><strong>ctdb_monitor_free_memory</strong></p><p>If the amount of free memory drops below this value the node will become unhealthy and ctdb and all managed services will be shutdown. Once this occurs, the administrator needs to find the reason for the OOM situation, rectify it and restart ctdb with "service ctdb start".</p><p>(optional, integer, default 100)</p><p><strong>ctdb_start_as_disabled</strong></p><p>When set to yes, the CTDB node will start in DISABLED mode and not host any public ip addresses.</p><p>(optional, boolean, default no)</p><p><strong>ctdb_config_dir</strong></p><p>The directory containing various CTDB configuration files. The "nodes" and "notify.sh" scripts are expected to be in this directory, as is the "events.d" subdirectory.</p><p>(optional, string, default "/etc/ctdb")</p><p><strong>ctdb_binary</strong></p><p>Full path to the CTDB binary.</p><p>(optional, string, default "/usr/bin/ctdb")</p><p><strong>ctdbd_binary</strong></p><p>Full path to the CTDB cluster daemon binary.</p><p>(optional, string, default "/usr/sbin/ctdbd")</p><p><strong>ctdb_socket</strong></p><p>Full path to the domain socket that ctdbd will create, used for local clients to attach and communicate with the ctdb daemon.</p><p>(unique, optional, string, default "/var/lib/ctdb/ctdb.socket")</p><p><strong>ctdb_dbdir</strong></p><p>The directory to put the local CTDB database files in. Persistent database files will be put in ctdb_dbdir/persistent.</p><p>(unique, optional, string, default "/var/lib/ctdb")</p><p><strong>ctdb_logfile</strong></p><p>Full path to log file. To log to syslog instead, use the value "syslog".</p><p>(optional, string, default "/var/log/ctdb/log.ctdb")</p><p><strong>ctdb_debuglevel</strong></p><p>What debug level to run at (0-10). Higher means more verbose.</p><p>(optional, integer, default 2)</p><p><strong>smb_conf</strong></p><p>Path to default samba config file. Only necessary if CTDB is managing Samba.</p><p>(optional, string, default "/etc/samba/smb.conf")</p><p><strong>smb_private_dir</strong></p><p>The directory for smbd to use for storing such files as smbpasswd and secrets.tdb. Old versions of CTBD (prior to 1.0.50) required this to be on shared storage. This parameter should not be set for current versions of CTDB, and only remains in the RA for backwards compatibility.</p><p>(unique, optional, string, no default)</p><p><strong>smb_passdb_backend</strong></p><p>Which backend to use for storing user and possibly group information. Only necessary if CTDB is managing Samba.</p><p>(optional, string, default "tdbsam")</p><p><strong>smb_idmap_backend</strong></p><p>Which backend to use for SID/uid/gid mapping. Only necessary if CTDB is managing Samba.</p><p>(optional, string, default "tdb2")</p><p><strong>smb_fileid_algorithm</strong></p><p>Which fileid:algorithm to use with vfs_fileid. The correct value depends on which clustered filesystem is in use, e.g.: for OCFS2, this should be set to "fsid". Only necessary if CTDB is managing Samba.</p><p>(optional, string, no default)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SUPPORTED ACTIONS</h2>
        <div class="sectioncontent">
<p>This resource agent supports the following actions (operations):</p><p><strong>start</strong></p><p>Starts the resource. Suggested minimum timeout: 90.</p><p><strong>stop</strong></p><p>Stops the resource. Suggested minimum timeout: 100.</p><p><strong>monitor</strong></p><p>Performs a detailed status check. Suggested minimum timeout: 20. Suggested interval: 10.</p><p><strong>meta-data</strong></p><p>Retrieves resource agent metadata (internal use only). Suggested minimum timeout: 5.</p><p><strong>validate-all</strong></p><p>Performs a validation of the resource configuration. Suggested minimum timeout: 30.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>The following is an example configuration for a CTDB resource using the <strong>crm</strong>(8) shell:</p>
<pre>
primitive p_CTDB ocf:heartbeat:CTDB &#92;
  params &#92;
    ctdb_recovery_lock=<em>string</em> &#92;
  op monitor timeout="20" interval="10" depth="0"
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO ocf_heartbeat_CTDB&hellip;</h2>
        <div class="sectioncontent">
<p>\m[blue]<strong>http://www.linux-ha.org/wiki/CTDB_(resource_agent)</strong>\m[]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p><strong>Linux-HA contributors (see the resource agent source for information about individual authors)</strong></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="ocf_heartbeat_AudibleAlarm.7.html"><span aria-hidden="true">&larr;</span> ocf_heartbeat_AudibleAlarm.7: Emits audible beeps at a configurable interval</a></li>
   <li class="next"><a href="ocf_heartbeat_ClusterMon.7.html">ocf_heartbeat_ClusterMon.7: Runs crm_mon in the background, recording the cluster status to an html file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
