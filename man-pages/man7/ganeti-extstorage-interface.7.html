<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ganeti-extstorage-interface: None</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="None">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="ganeti-extstorage-interface (7) manual">
  <meta name="twitter:description" content="None">
  <meta name="twitter:image" content="https://www.carta.tech/images/ganeti-2.12-ganeti-extstorage-interface-7.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man7/ganeti-extstorage-interface.7.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ganeti-extstorage-interface (7) manual" />
  <meta property="og:description" content="None" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/ganeti-2.12-ganeti-extstorage-interface-7.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">ganeti-extstorage-interface<small> (7)</small></h1>
        <p class="lead">None</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/">
      <span itemprop="name">Miscellaneous</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/ganeti-extstorage-interface.7.html">
      <span itemprop="name">ganeti-extstorage-interface: None</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/ganeti-2.12/">
      <span itemprop="name">ganeti-2.12</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/ganeti-extstorage-interface.7.html">
      <span itemprop="name">ganeti-extstorage-interface: None</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">Name</h2>
        <div class="sectioncontent">
<p>ganeti-extstorage-interface - Specifications for ExtStorage providers</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The method for supporting external shared storage in Ganeti is to have an ExtStorage provider for each external shared storage hardware type. The ExtStorage provider is a set of files (executable scripts and text files), contained inside a directory which is named after the provider. This directory must be present across all nodes of a nodegroup (Ganeti doesn\[aq]t replicate it), in order for the provider to be usable by Ganeti for this nodegroup (valid). The external shared storage hardware should also be accessible by all nodes of this nodegroup too.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REFERENCE</h2>
        <div class="sectioncontent">
<p>There are eight required files: <em>create</em>, <em>attach</em>, <em>detach</em>, <em>remove</em>, <em>grow</em>, <em>setinfo</em>, <em>verify</em> (executables) and <em>parameters.list</em> (text file).</p><h3>Common environment</h3>
<p>All commands will get their input via environment variables. A common set of variables will be exported for all commands, and some of them might have extra ones. Note that all counts are zero-based.</p><p>Since Ganeti version 2.5, the environment will be cleaned up before being passed to scripts, therefore they will not inherit the environment in with which the ganeti node daemon was started. If you depend on any environment variables (non-Ganeti), then you will need to define or source them appropriately.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>VOL_NAME</strong></p>
  </dt>
  <dd>
    <p>The name of the volume. This is unique for Ganeti and it uses it to refer to a specific volume inside the external storage. Its format is UUID.ext.diskX where UUID is produced by Ganeti and is unique inside the Ganeti context. X is the number of the disk count.</p>
  </dd>
  <dt>
    <p><strong>VOL_SIZE</strong></p>
  </dt>
  <dd>
    <p>The volume\[aq]s size in mebibytes.</p>
  </dd>
  <dt>
    <p><strong>VOL_NEW_SIZE</strong></p>
  </dt>
  <dd>
    <p>Available only to the <strong>grow</strong> script. It declares the new size of the volume after grow (in mebibytes). To find the amount of grow, the scipt should calculate the number VOL_NEW_SIZE - VOL_SIZE.</p>
  </dd>
  <dt>
    <p><strong>EXTP_</strong><em>name</em></p>
  </dt>
  <dd>
    <p>Each ExtStorage parameter (see below) will be exported in its own variable, prefixed with EXTP_, and upper-cased. For example, a fromsnap parameter will be exported as EXTP_FROMSNAP.</p>
  </dd>
  <dt>
    <p><strong>VOL_METADATA</strong></p>
  </dt>
  <dd>
    <p>Available only to the <strong>setinfo</strong> script. A string containing metadata to be associated with the volume. Currently, Ganeti sets this value to originstname+X where X is the instance\[aq]s name.</p>
  </dd>
  <dt>
    <p><strong>VOL_CNAME</strong></p>
  </dt>
  <dd>
    <p>The name of the Disk config object (optional).</p>
  </dd>
  <dt>
    <p><strong>VOL_UUID</strong></p>
  </dt>
  <dd>
    <p>The uuid of the Disk config object.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXECUTABLE SCRIPTS</h2>
        <div class="sectioncontent">
<h3>create</h3>
<p>The <strong>create</strong> command is used for creating a new volume inside the external storage. The VOL_NAME denotes the volume\[aq]s name, which should be unique. After creation, Ganeti will refer to this volume by this name for all other actions.</p><p>Ganeti produces this name dynamically and ensures its uniqueness inside the Ganeti context. Therefore, you should make sure not to provision manually additional volumes inside the external storage with this type of name, because this will lead to conflicts and possible loss of data.</p><p>The VOL_SIZE variable denotes the size of the new volume to be created in mebibytes.</p><p>If the script ends successfully, a new volume of size VOL_SIZE should exist inside the external storage. e.g:: a lun inside a NAS appliance.</p><p>The script returns 0 on success.</p>
<h3>attach</h3>
<p>This command is used in order to make an already created volume visible to the physical node which will host the instance. This is done by mapping the already provisioned volume to a block device inside the host node.</p><p>The VOL_NAME variable denotes the volume to be mapped.</p><p>After successful attachment the script returns to its stdout a string, which is the full path of the block device to which the volume is mapped. e.g:: /dev/dummy1</p><p>When attach returns, this path should be a valid block device on the host node.</p><p>The attach script should be idempotent if the volume is already mapped. If the requested volume is already mapped, then the script should just return to its stdout the path which is already mapped to.</p>
<h3>detach</h3>
<p>This command is used in order to unmap an already mapped volume from the host node. Detach undoes everything attach did. This is done by unmapping the requested volume from the block device it is mapped to.</p><p>The VOL_NAME variable denotes the volume to be unmapped.</p><p>detach doesn\[aq]t affect the volume itself. It just unmaps it from the host node. The volume continues to exist inside the external storage. It\[aq]s just not accessible by the node anymore. This script doesn\[aq]t return anything to its stdout.</p><p>The detach script should be idempotent if the volume is already unmapped. If the volume is not mapped, the script doesn\[aq]t perform any action at all.</p><p>The script returns 0 on success.</p>
<h3>remove</h3>
<p>This command is used to remove an existing volume from the external storage. The volume is permanently removed from inside the external storage along with all its data.</p><p>The VOL_NAME variable denotes the volume to be removed.</p><p>The script returns 0 on success.</p>
<h3>grow</h3>
<p>This command is used to grow an existing volume of the external storage.</p><p>The VOL_NAME variable denotes the volume to grow.</p><p>The VOL_SIZE variable denotes the current volume\[aq]s size (in mebibytes). The VOL_NEW_SIZE variable denotes the final size after the volume has been grown (in mebibytes).</p><p>The amount of grow can be easily calculated by the scipt and is:</p><p>grow_amount = VOL_NEW_SIZE - VOL_SIZE (in mebibytes)</p><p>Ganeti ensures that: VOL_NEW_SIZE &gt; VOL_SIZE</p><p>If the script returns successfully, then the volume inside the external storage will have a new size of VOL_NEW_SIZE. This isn\[aq]t immediately reflected to the instance\[aq]s disk. See gnt-instance&nbsp;grow for more details on when the running instance becomes aware of its grown disk.</p><p>The script returns 0 on success.</p>
<h3>setinfo</h3>
<p>This script is used to add metadata to an existing volume. It is helpful when we need to keep an external, Ganeti-independent mapping between instances and volumes; primarily for recovery reasons. This is provider specific and the author of the provider chooses whether/how to implement this. You can just exit with 0, if you do not want to implement this feature, without harming the overall functionality of the provider.</p><p>The VOL_METADATA variable contains the metadata of the volume.</p><p>Currently, Ganeti sets this value to originstname+X where X is the instance\[aq]s name.</p><p>The script returns 0 on success.</p>
<h3>verify</h3>
<p>The <em>verify</em> script is used to verify consistency of the external parameters (ext-params) (see below). The command should take one or more arguments denoting what checks should be performed, and return a proper exit code depending on whether the validation failed or succeeded.</p><p>Currently, the script is not invoked by Ganeti, but should be present for future use and consistency with gnt-os-interface\[aq]s verify script.</p><p>The script should return 0 on success.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">TEXT FILES</h2>
        <div class="sectioncontent">
<h3>parameters.list</h3>
<p>This file declares the parameters supported by the ExtStorage provider, one parameter per line, with name and description (space and/or tab separated). For example:</p><ul>
<li>
<pre>
fromsnap&nbsp;Snapshot&nbsp;name&nbsp;to&nbsp;create&nbsp;the&nbsp;volume&nbsp;from
nas_ip&nbsp;The&nbsp;IP&nbsp;of&nbsp;the&nbsp;NAS&nbsp;appliance

</pre>
</li>
</ul><p>The parameters can then be used during instance add as follows:</p><ul>
<li>
<pre>
#&nbsp;gnt-instance&nbsp;add&nbsp;--disk=0:fromsnap="file_name",nas_ip="1.2.3.4"&nbsp;...

</pre>
</li>
</ul>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>In the following examples we assume that you have already installed successfully two ExtStorage providers: pvdr1 and pvdr2</p><p>Add a new instance with a 10G first disk provided by pvdr1 and a 20G second disk provided by pvdr2:</p><ul>
<li>
<pre>
#&nbsp;gnt-instance&nbsp;add&nbsp;-t&nbsp;ext&nbsp;--disk=0:size=10G,provider=pvdr1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--disk=1:size=20G,provider=pvdr2

</pre>
</li>
</ul><p>Add a new instance with a 5G first disk provided by provider pvdr1 and also pass the prm1, prm2 parameters to the provider, with the corresponding values val1, val2:</p><ul>
<li>
<pre>
#&nbsp;gnt-instance&nbsp;add&nbsp;-t&nbsp;ext
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--disk=0:size=5G,provider=pvdr1,prm1=val1,prm2=val2

</pre>
</li>
</ul><p>Modify an existing instance of disk type ext by adding a new 30G disk provided by provider pvdr2:</p><ul>
<li>
<pre>
#&nbsp;gnt-instance&nbsp;modify&nbsp;--disk&nbsp;1:add,size=30G,provider=pvdr2&nbsp;&lt;instance&gt;

</pre>
</li>
</ul><p>Modify an existing instance of disk type ext by adding 2 new disks, of different providers, passing one parameter for the first one:</p><ul>
<li>
<pre>
#&nbsp;gnt-instance&nbsp;modify&nbsp;--disk&nbsp;2:add,size=3G,provider=pvdr1,prm1=val1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--disk&nbsp;3:add,size=5G,provider=pvdr2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;instance&gt;

</pre>
</li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<h3>Backwards compatibility</h3>
<p>The ExtStorage Interface was introduced in Ganeti 2.7. Ganeti 2.7 and up is compatible with the ExtStorage Interface.</p>
<h3>Common behaviour</h3>
<p>All the scripts should display an usage message when called with a wrong number of arguments or when the first argument is -h or --help.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">
<p>Report bugs to project website (http://code.google.com/p/ganeti/) or contact the developers using the Ganeti mailing list (ganeti@googlegroups.com).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO ganeti-extstorage-interface&hellip;</h2>
        <div class="sectioncontent">
<p>Ganeti overview and specifications: <a href="../man7/ganeti.7.html"><strong>ganeti</strong>(7)</a> (general overview), <a href="../man7/ganeti-os-interface.7.html"><strong>ganeti-os-interface</strong>(7)</a> (guest OS definitions), <a href="../man7/ganeti-extstorage-interface.7.html"><strong>ganeti-extstorage-interface</strong>(7)</a> (external storage providers).</p><p>Ganeti commands: <a href="../man8/gnt-cluster.8.html"><strong>gnt-cluster</strong>(8)</a> (cluster-wide commands), <a href="../man8/gnt-job.8.html"><strong>gnt-job</strong>(8)</a> (job-related commands), <a href="../man8/gnt-node.8.html"><strong>gnt-node</strong>(8)</a> (node-related commands), <a href="../man8/gnt-instance.8.html"><strong>gnt-instance</strong>(8)</a> (instance commands), <a href="../man8/gnt-os.8.html"><strong>gnt-os</strong>(8)</a> (guest OS commands), <a href="../man8/gnt-storage.8.html"><strong>gnt-storage</strong>(8)</a> (storage commands), <a href="../man8/gnt-group.8.html"><strong>gnt-group</strong>(8)</a> (node group commands), <a href="../man8/gnt-backup.8.html"><strong>gnt-backup</strong>(8)</a> (instance import/export commands), <a href="../man8/gnt-debug.8.html"><strong>gnt-debug</strong>(8)</a> (debug commands).</p><p>Ganeti daemons: <a href="../man8/ganeti-watcher.8.html"><strong>ganeti-watcher</strong>(8)</a> (automatic instance restarter), <a href="../man8/ganeti-cleaner.8.html"><strong>ganeti-cleaner</strong>(8)</a> (job queue cleaner), <a href="../man8/ganeti-noded.8.html"><strong>ganeti-noded</strong>(8)</a> (node daemon), <strong>ganeti-masterd</strong>(8) (master daemon), <a href="../man8/ganeti-rapi.8.html"><strong>ganeti-rapi</strong>(8)</a> (remote API daemon).</p><p>Ganeti htools: <a href="../man1/htools.1.html"><strong>htools</strong>(1)</a> (generic binary), <a href="../man1/hbal.1.html"><strong>hbal</strong>(1)</a> (cluster balancer), <a href="../man1/hspace.1.html"><strong>hspace</strong>(1)</a> (capacity calculation), <a href="../man1/hail.1.html"><strong>hail</strong>(1)</a> (IAllocator plugin), <a href="../man1/hscan.1.html"><strong>hscan</strong>(1)</a> (data gatherer from remote clusters), <a href="../man1/hinfo.1.html"><strong>hinfo</strong>(1)</a> (cluster information printer), <a href="../man7/mon-collector.7.html"><strong>mon-collector</strong>(7)</a> (data collectors interface).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright (C) 2006-2014 Google Inc. All rights reserved.</p><p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p><p>1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</p><p>2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</p><p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="ganeti.7.html"><span aria-hidden="true">&larr;</span> ganeti.7: None</a></li>
   <li class="next"><a href="ganeti-os-interface.7.html">ganeti-os-interface.7: None <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
