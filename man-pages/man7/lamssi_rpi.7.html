<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>lamssi_rpi: Overview of lam's rpi ssi modules</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Overview of lam's rpi ssi modules">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="lamssi_rpi (7) manual">
  <meta name="twitter:description" content="Overview of lam's rpi ssi modules">
  <meta name="twitter:image" content="https://www.carta.tech/images/lam-runtime-lamssi_rpi-7.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man7/lamssi_rpi.7.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="lamssi_rpi (7) manual" />
  <meta property="og:description" content="Overview of lam's rpi ssi modules" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/lam-runtime-lamssi_rpi-7.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">lamssi_rpi<small> (7)</small></h1>
        <p class="lead">Overview of lam's rpi ssi modules</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/">
      <span itemprop="name">Miscellaneous</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/lamssi_rpi.7.html">
      <span itemprop="name">lamssi_rpi: Overview of lam's rpi ssi modules</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/lam-runtime/">
      <span itemprop="name">lam-runtime</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/lamssi_rpi.7.html">
      <span itemprop="name">lamssi_rpi: Overview of lam's rpi ssi modules</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The "kind" for RPI SSI modules is "rpi".  Specifically, the string "rpi" (without the quotes) should be used to specify which RPI should be used on the <em>mpirun</em> command line with the <em>-ssi</em> switch.  For example:</p>
<dl class='dl-vertical'>
  <dt>
    <p>mpirun -ssi rpi tcp C my_mpi_program</p>
  </dt>
  <dd>
    <p>Specifies to use the tcp RPI (and to launch a single copy of the executable "foo" on each node).</p>
  </dd>

</dl>
<p>The "rpi" string is also used as a prefix send parameters to specific RPI modules.  For example:</p>
<dl class='dl-vertical'>
  <dt>
    <p>mpirun -ssi rpi tcp -ssi rpi_tcp_short 131072 C my_mpi_program</p>
  </dt>
  <dd>
    <p>Specifies to use the tcp RPI, and to pass in the value of 131072 (128K) as the short message length for TCP messages.  See each RPI section below for a full description of parameters that are accepted by each RPI.</p>
  </dd>

</dl>
<p>LAM currently supports five different RPI SSI modules: gm, lamd, tcp, sysv, usysv.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SELECTING AN RPI MODULE</h2>
        <div class="sectioncontent">
<p>Only one RPI module may be selected per command execution.  The selection of which module occurs during MPI_INIT, and is used for the duration of the MPI process.  It is erroneous to select different RPI modules for different processes.</p><p>The kind for selecting an RPI is "rpi".  For example:</p>
<dl class='dl-vertical'>
  <dt>
    <p>mpriun -ssi rpi tcp C my_mpi_program</p>
  </dt>
  <dd>
    <p>Selects to use the tcp RPI and run a single copy of the foo exectuable on each node.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AVAILABLE MODULES</h2>
        <div class="sectioncontent">
<p>As with all SSI modules, it is possible to pass parameters at run time.  This section discusses the built-in LAM RPI modules, as well as the run-time parameters that they accept.</p><p>In the discussion below, the parameters are discussed in terms of <em>kind</em> and <em>name</em>. The <em>kind</em> and <em>name</em> may be specified as command line arguments to the <em>mpirun</em> command with the <em>-ssi</em> switch, or they may be set in environment variables of the form LAM_MPI_SSI_<em>name</em>=<em>value</em>. Note that using the <em>-ssi</em> command line switch will take precendence over any environment variables.</p><p>If the RPI that is selected is unable to run (e.g., attempting to use the gm RPI when gm support was not compiled into LAM, or if no gm hardware is available on the nodes), an appropriate error message will be printed and execution will abort.</p><h3>crtcp RPI</h3>
<p>The crtcp RPI is a checkpoint/restart-able version of the tcp RPI (see below).  It is separate from the tcp RPI because the current implementation imposes a slight performance penalty to enable the ability to checkpoint and restart MPI jobs.  Its tunable parameters are the same as the tcp RPI.  This RPI probably only needs to be used when the ability to checkpoint and restart MPI jobs is required.</p><p>See the LAM/MPI User's Guide for more details on the crtcp RPI as well as the checkpoint/restart capabilities of LAM/MPI.  The <a href="../man7/lamssi_cr.7.html"><strong>lamssi_cr</strong>(7)</a> manual page also contains additional information.</p>
<h3>gm RPI</h3>
<p>The gm RPI is used with native Myrinet networks.  Please note that the gm RPI exists, but has not yet been optimized.  It gives significantly better performance than TCP over Myrinet networks, but has not yet been properly tuned and instrumented in LAM.</p><p>That being said, there are several tunable parameters in the gm RPI:</p>
<dl class='dl-vertical'>
  <dt>
    <p>rpi_gm_maxport N</p>
  </dt>
  <dd>
    <p>If <em>rpi_gm_port</em> is not specified, LAM will attempt to find an open GM port to use for MPI communications starting with port 1 and ending with the <em>N</em> value speified by the <em>rpi_gm_maxport</em> parameter.  If unspecified, LAM will try all existing GM ports.</p>
  </dd>
  <dt>
    <p>rpi_gm_port N</p>
  </dt>
  <dd>
    <p>LAM will attempt to use gm port <em>N</em> for MPI communications.</p>
  </dd>
  <dt>
    <p>rpi_gm_tinymsglen N</p>
  </dt>
  <dd>
    <p>Specifies the maximum message size (in bytes) for "tiny" messages (i.e., messages that are sent entirely in one gm message).  Tiny messages are memcpy'ed into the header before it is sent to the destination, and memcpy'ed out of the header into the destination buffer on the receiver.  Hence, it is not advisable to make this value too large.</p>
  </dd>
  <dt>
    <p>rpi_gm_fast 1</p>
  </dt>
  <dd>
    <p>Specifies to use the "fast" protocol for sending short gm messages. Unreliable in the presence of GM errors or timeouts; this parameter is not advised for MPI applications that essentially do not make continual progress within MPI.</p>
  </dd>
  <dt>
    <p>rpi_gm_cr 1</p>
  </dt>
  <dd>
    <p>Enable checkpoint/restart behavior for gm.  This can <em>only</em> be enabled if the gm rpi module was compiled with support for the <em>gm_get()</em> function, which is disabled by default.  See the LAM Installation and User's Guides for more information on this parameter before you use it.</p>
  </dd>

</dl>

<h3>lamd RPI</h3>
<p>The lamd RPI uses LAM's "out-of-band" communication mechanism for passing MPI messages.  Specifically, MPI messages are sent from the user process to the local LAM daemon, then to the remote LAM daemon (if the destination process is on a different node), and then to the destination process.</p><p>While this adds latency to message passing because of the extra hops that each message must travel, it allows for true asynchronous message passing.  Since the LAM daemon is running in its own execution space, it can make progress on message passing regardless of the state / status of the user's program.  This can be an overall net savings in performance and execution time for some classes of MPI programs.</p><p>It is expected that this RPI will someday become obsolete when LAM becomes multi-threaded and allows progress to be made on message passing in separate threads rather than in separate processes.</p><p>The lamd RPI has no tunable parameters.</p>
<h3>tcp RPI</h3>
<p>The tcp RPI uses pure TCP for all MPI message passing.  TCP sockets are opened between MPI processes and are used for all MPI traffic.</p><p>The tcp RPI has one tunable parameter:</p>
<dl class='dl-vertical'>
  <dt>
    <p>rpi_tcp_short &lt;bytes&gt;</p>
  </dt>
  <dd>
    <p>Tells the tcp RPI the smallest size (in bytes) for a message to be considered "long".  Short messages are sent eagerly (even if the receiving side is not expecting them).  Long messages use a rendevouz protocol (i.e., a three-way handshake) such that the message is not actually sent until the receiver is expecting it.  This value defaults to 64k.</p>
  </dd>

</dl>

<h3>sysv RPI</h3>
<p>The sysv RPI uses shared memory for communication between MPI processes on the same node, and TCP sockets for communication between MPI processes on different nodes.  System V semaphores are used to lock the shared memory pools.  This RPI is best used when running multiple MPI processes on uniprocessors (or oversubscribed SMPs) because of the blocking / yielding nature of semaphores.</p><p>The sysv RPI has the following tunable parameters:</p>
<dl class='dl-vertical'>
  <dt>
    <p>rpi_tcp_short &lt;bytes&gt;</p>
  </dt>
  <dd>
    <p>Since the sysv RPI uses parts of the tcp RPI for off-node communication, this parameter also has relevance to the sysv RPI.  The meaning of this parameter is discussed in the tcp RPI section.</p>
  </dd>
  <dt>
    <p>rpi_sysv_short &lt;bytes&gt;</p>
  </dt>
  <dd>
    <p>Tells the sysv RPI the smallest size (in bytes) for a message to be considered "long".  Short shared memory messages are sent using a small "postbox" protocol; long messages use a more general shared memory pool method.  This value defaults to 8k.</p>
  </dd>
  <dt>
    <p>rpi_sysv_pollyield &lt;bool&gt;</p>
  </dt>
  <dd>
    <p>If set to a nonzero number, force the use of a system call to yield the processor.  The system call will be yield(), sched_yield(), or select() (with a 1ms timeout), depending what LAM's configure script finds at configuration time.  This value defaults to 1.</p>
  </dd>
  <dt>
    <p>rpi_sysv_shmpoolsize &lt;bytes&gt;</p>
  </dt>
  <dd>
    <p>The size of the shared memory pool that is used for long message transfers.  It is allocated once on each node for each MPI parallel job.  Specifically, if multiple MPI processes from the same parallel job are spawned on a single node, this pool will only be allocated once.</p><p>The configure script will try to determine a default size for the pool if none is explicitly specified (you should always check this to see if it is reasonable).  Larger values should improve performance especially when an application passes large messages, but will also increase the system resources used by each task.</p>
  </dd>
  <dt>
    <p>rpi_sysv_shmmaxalloc &lt;bytes&gt;</p>
  </dt>
  <dd>
    <p>To prevent a single large message transfer from monopolizing the global pool, allocations from the pool are actually restricted to a maximum of <em>rpi_sysv_shmmaxalloc</em> bytes each.  Even with this restriction, it is possible for the global pool to temporarily become exhausted. In this case, the transport will fall back to using the postbox area to transfer the message. Performance will be degraded, but the application will progress.</p><p>The configure script will try to determine a default size for the maximum atomic transfer size if none is explicitly specified (you should always check this to see if it is reasonable).  Larger values should improve performance especially when an application passes large messages, but will also increase the system resources used by each task.</p>
  </dd>

</dl>

<h3>usysv RPI</h3>
<p>The usysv RPI uses shared memory for communication between MPI processes on the same node, and TCP sockets for communication between MPI processes on different nodes.  Spin locks are used to lock the shared memory pools.  This RPI is best used when the multiple of MPI processes on a single node is less than or equal to the number of processors because it allows LAM to fully occupy the processor while waiting for a message and never be swapped out.</p><p>The usysv RPI has many of the same tunable parameters as the sysv RPI:</p>
<dl class='dl-vertical'>
  <dt>
    <p>rpi_tcp_short &lt;bytes&gt;</p>
  </dt>
  <dd>
    <p>Same meaning as in the sysv RPI.</p>
  </dd>
  <dt>
    <p>rpi_usysv_short &lt;bytes&gt;</p>
  </dt>
  <dd>
    <p>Same meaning as <em>rpi_sysv_short</em> in the sysv RPI.</p>
  </dd>
  <dt>
    <p>rpi_usysv_pollyield &lt;bool&gt;</p>
  </dt>
  <dd>
    <p>Same meaning as <em>rpi_sysv_pollyield</em> in the sysv RPI.</p>
  </dd>
  <dt>
    <p>rpi_usysv_shmpoolsize &lt;bytes&gt;</p>
  </dt>
  <dd>
    <p>Same meaning as <em>rpi_sysv_shmpoolsize</em> in the sysv RPI.</p>
  </dd>
  <dt>
    <p>rpi_usysv_shmmaxalloc &lt;bytes&gt;</p>
  </dt>
  <dd>
    <p>Same meaning as <em>rpi_sysv_shmmaxalloc</em> in the sysv RPI.</p>
  </dd>
  <dt>
    <p>rpi_usysv_readlockpoll &lt;iterations&gt;</p>
  </dt>
  <dd>
    <p>Number of iterations to spin before yielding the processor while waiting to read.  This value defaults to 10,000.</p>
  </dd>
  <dt>
    <p>rpi_usysv_writelockpoll &lt;iterations&gt;</p>
  </dt>
  <dd>
    <p>Number of iterations to spin before yielding the processor while waiting to write.  This value defaults to 10.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO lamssi_rpi&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man7/lamssi.7.html"><strong>lamssi</strong>(7)</a>, <a href="../man7/lamssi_cr.7.html"><strong>lamssi_cr</strong>(7)</a>, <strong>mpirun</strong>(1), LAM User's Guide</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="lamssi_cr.7.html"><span aria-hidden="true">&larr;</span> lamssi_cr.7: Overview of lam's mpi checkpoint / restart ssi modules</a></li>
   <li class="next"><a href="latin1.7.html">latin1.7: Iso 8859-1 character set encoded in octal, decimal, and hexadecimal <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
