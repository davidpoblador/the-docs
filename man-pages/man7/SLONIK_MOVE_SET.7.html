<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SLONIK_MOVE_SET: Change origin of a slony-i replication set</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Change origin of a slony-i replication set">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="SLONIK_MOVE_SET (7) manual">
  <meta name="twitter:description" content="Change origin of a slony-i replication set">
  <meta name="twitter:image" content="https://www.carta.tech/images/slony1-2-doc-SLONIK_MOVE_SET-7.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man7/SLONIK_MOVE_SET.7.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="SLONIK_MOVE_SET (7) manual" />
  <meta property="og:description" content="Change origin of a slony-i replication set" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/slony1-2-doc-SLONIK_MOVE_SET-7.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">SLONIK_MOVE_SET<small> (7)</small></h1>
        <p class="lead">Change origin of a slony-i replication set</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/">
      <span itemprop="name">Miscellaneous</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/SLONIK_MOVE_SET.7.html">
      <span itemprop="name">SLONIK_MOVE_SET: Change origin of a slony-i replication set</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/slony1-2-doc/">
      <span itemprop="name">slony1-2-doc</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man7/SLONIK_MOVE_SET.7.html">
      <span itemprop="name">SLONIK_MOVE_SET: Change origin of a slony-i replication set</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>MOVE SET (options);</strong> \kx</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Changes the origin of a set from one node to another. The new origin must be a current subscriber of the set. The set must currently be locked on the old origin.</p><p>After this command, the set cannot be unlocked on the old origin any more. The old origin will continue as a forwarding subscriber of the set and the subscription chain from the old origin to the new origin will be reversed, hop by hop. As soon as the new origin has finished processing the event (that includes any outstanding sync events that happened before, <em>i.e.</em> fully catching up), the new origin will take over and open all tables in the set for client application update activity.</p><p>This is <em>not</em> failover, as it requires a functioning old origin node (you needed to lock the set on the old origin). You would probably prefer to <strong>MOVE SET</strong> instead of <strong>FAILOVER</strong>, if at all possible, as <strong>FAILOVER</strong> winds up discarding the old origin node as being corrupted. Before <strong>MOVE SET</strong> will function a <strong>LOCK SET</strong> is needed.</p><p>Note that this is a locking operation, which means that it can get stuck behind other database activity.</p>
<dl class='dl-vertical'>
  <dt>
    <p>\*(T&lt;ID = ival \*(T&gt;</p>
  </dt>
  <dd>
    <p>ID of the set to transfer</p>
  </dd>
  <dt>
    <p>\*(T&lt;OLD ORIGIN = ival \*(T&gt;</p>
  </dt>
  <dd>
    <p>Node ID of the current set origin</p>
  </dd>
  <dt>
    <p>\*(T&lt;NEW ORIGIN = ival \*(T&gt;</p>
  </dt>
  <dd>
    <p>Node ID of the new set origin</p>
  </dd>

</dl>
<p>This uses &ldquo;schemadocmoveset(p_new_origin integer, p_set_id integer)&rdquo; [not available as a man page].</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<pre>
\*(T&lt;LOCK SET (
   ID = 1,
   ORIGIN = 1
);
MOVE SET (
   ID = 1,
   OLD ORIGIN = 1,
   NEW ORIGIN = 3
);
    \*(T&gt;
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOCKING BEHAVIOUR </h2>
        <div class="sectioncontent">
<p>Exclusive locks on each replicated table will be taken out on both the old origin node and the new origin node, as replication triggers are changed on both nodes: on the former origin, each table has two triggers (logtrigger and lockset) dropped and a denyaccess trigger added; on the new origin, the denyaccess trigger is dropped and a logtrigger trigger added.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SLONIK EVENT CONFIRMATION BEHAVIOUR </h2>
        <div class="sectioncontent">
<p>Slonik waits for the command submitted to the previous event node to be confirmed on the specified event node before submitting this command.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VERSION INFORMATION </h2>
        <div class="sectioncontent">
<p>This command was introduced in Slony-I 1.0</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="SLONIK_MERGE_SET.7.html"><span aria-hidden="true">&larr;</span> SLONIK_MERGE_SET.7: Merge slony-i replication sets together</a></li>
   <li class="next"><a href="SLONIK_REPAIR_CONFIG.7.html">SLONIK_REPAIR_CONFIG.7: Resets the name-to-oid mapping of tables in a replication set, useful for restoring a node after a pg_dump. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
