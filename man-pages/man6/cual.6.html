<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>cual: Cuyo animation language  cual is the main language used to describe the animations in cuyo. strictly speaking it's the stuff between the   brackets in the level description files (xxx.ld).  on the other hand this man page aims at being a complete description of how to write levels for cuyo. but it's still under construction. see the file "example.ld" to get an idea of how the rest of the level description works. there's also a bit of example cual code in "example.ld". and of course, all the existing levels are examples.  note that cual is probably still very buggy. so if strange things happen and you're sure it's not your fault, tell me (cuyo@karimmi.de).</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Cuyo animation language  cual is the main language used to describe the animations in cuyo. strictly speaking it's the stuff between the   brackets in the level description files (xxx.ld).  on the other hand this man page aims at being a complete description of how to write levels for cuyo. but it's still under construction. see the file "example.ld" to get an idea of how the rest of the level description works. there's also a bit of example cual code in "example.ld". and of course, all the existing levels are examples.  note that cual is probably still very buggy. so if strange things happen and you're sure it's not your fault, tell me (cuyo@karimmi.de).">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="cual (6) manual">
  <meta name="twitter:description" content="Cuyo animation language  cual is the main language used to describe the animations in cuyo. strictly speaking it's the stuff between the   brackets in the level description files (xxx.ld).  on the other hand this man page aims at being a complete description of how to write levels for cuyo. but it's still under construction. see the file "example.ld" to get an idea of how the rest of the level description works. there's also a bit of example cual code in "example.ld". and of course, all the existing levels are examples.  note that cual is probably still very buggy. so if strange things happen and you're sure it's not your fault, tell me (cuyo@karimmi.de).">
  <meta name="twitter:image" content="https://www.carta.tech/images/cuyo-data-cual-6.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man6/cual.6.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="cual (6) manual" />
  <meta property="og:description" content="Cuyo animation language  cual is the main language used to describe the animations in cuyo. strictly speaking it's the stuff between the   brackets in the level description files (xxx.ld).  on the other hand this man page aims at being a complete description of how to write levels for cuyo. but it's still under construction. see the file "example.ld" to get an idea of how the rest of the level description works. there's also a bit of example cual code in "example.ld". and of course, all the existing levels are examples.  note that cual is probably still very buggy. so if strange things happen and you're sure it's not your fault, tell me (cuyo@karimmi.de)." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/cuyo-data-cual-6.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">cual<small> (6)</small></h1>
        <p class="lead">Cuyo animation language  cual is the main language used to describe the animations in cuyo. strictly speaking it's the stuff between the   brackets in the level description files (xxx.ld).  on the other hand this man page aims at being a complete description of how to write levels for cuyo. but it's still under construction. see the file "example.ld" to get an idea of how the rest of the level description works. there's also a bit of example cual code in "example.ld". and of course, all the existing levels are examples.  note that cual is probably still very buggy. so if strange things happen and you're sure it's not your fault, tell me (cuyo@karimmi.de).</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man6/">
      <span itemprop="name">Games</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man6/cual.6.html">
      <span itemprop="name">cual: Cuyo animation language  cual is the main language used to describe the animations in cuyo. strictly speaking it's the stuff between the   brackets in the level description files (xxx.ld).  on the other hand this man page aims at being a complete description of how to write levels for cuyo. but it's still under construction. see the file "example.ld" to get an idea of how the rest of the level description works. there's also a bit of example cual code in "example.ld". and of course, all the existing levels are examples.  note that cual is probably still very buggy. so if strange things happen and you're sure it's not your fault, tell me (cuyo@karimmi.de).</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/cuyo-data/">
      <span itemprop="name">cuyo-data</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man6/cual.6.html">
      <span itemprop="name">cual: Cuyo animation language  cual is the main language used to describe the animations in cuyo. strictly speaking it's the stuff between the   brackets in the level description files (xxx.ld).  on the other hand this man page aims at being a complete description of how to write levels for cuyo. but it's still under construction. see the file "example.ld" to get an idea of how the rest of the level description works. there's also a bit of example cual code in "example.ld". and of course, all the existing levels are examples.  note that cual is probably still very buggy. so if strange things happen and you're sure it's not your fault, tell me (cuyo@karimmi.de).</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">HOW IT WORKS</h2>
        <div class="sectioncontent">
<p>The level description is organized in sections. There is a global section and every level has its own section, which is a subsection of the global section. It is common practice to place each level in a separate file, which then basically starts by opening its section and ends by closing it.</p><p>A section is defined by <em>name</em><strong> = {</strong><em>contents</em><strong>}</strong>. <em>name</em> is the name of the new section and <em>contents</em> contains the definitions that pertain to that section. This is a sequence of definitions of the form <em>name</em><strong> = </strong><em>stuff</em>. Here <em>stuff</em> can be <strong>{</strong><em>contents</em><strong>}</strong> as above, or it can be a single datum, or it can be a comma-separated list of data. Inside such a list, <em>datum</em><strong> * </strong><em>number</em> can be used as a shorthand for <em>datum</em><strong>, </strong>...<strong>, </strong><em>datum</em>, i.e. a <em>number</em>-fold repetition of <em>datum</em>. A datum can be an identifier, a string (enclosed by '"'), a word, or a number. In place of a number <strong>&lt;</strong><em>expression</em><strong>&gt;</strong> can be used, where <em>expression</em> is an arbitrary expression made up from literal numbers, previously defined numeric data, and the operators <strong>+</strong>, <strong>-</strong>, <strong>*</strong>, <strong>/</strong> and <strong>%</strong>.</p><p>Definitions can also depend on versions. See section <strong>VERSIONING</strong> below.</p><p>Apart from definitions, a section can also contain cual definitions (see below). These have to be enclosed in <strong>&lt;&lt;</strong> and <strong>&gt;&gt;</strong>.</p><p>Each blob has its own (main) Cual procedure which does the drawing and the animation stuff. The procedure only depends on the kind of the blob, that is, it is the same for blobs of the same kind. However each blob has its own instance of the variables.</p><p>In every game step, the procedure of each of the blobs is called once. (There are 12.5 game steps per second.) It has to draw the blob each time, even if nothing has changed. (However, there's an internal routine in cuyo which checks if the same is drawn as in the last step and which then supresses the drawing.)</p><p>There may be other procedures associated to a kind of blob, which are executed at special events, for example when a falling blob lands. In contrast to the main procedure, these event handlers are not allowed to draw anything. See section <strong>EVENT HANDLERS</strong> for a list of the existing events.</p><p>The name of the main procedure of a blob (the one which draws the blob) is the name of the kind of the blob. Normally, that name is the word listed after <em>pics=</em> entry in the .ld file; but if that "word" contains a dot, only the part before the dot makes up the name. (E. g. with <strong>pics=redblob.xpm,greenblob.xpm</strong>, the names are "redblob" and "greenblob".)</p><p>The name of an event handler procedure is the name of the kind, followed by a dot, followed by the event name. (E.g. "redblob.land" for the landing event of the redblob from above.)</p><p>[Explain the default procedures.]</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LEVEL DATA</h2>
        <div class="sectioncontent">
<h3>String valued data</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>name</strong></p>
  </dt>
  <dd>
    <p>The name of the level. This appears in the list of levels as well as in the level intro.</p>
  </dd>
  <dt>
    <p><strong>description</strong></p>
  </dt>
  <dd>
    <p>This is an optional further description of the level in its intro.</p>
  </dd>
  <dt>
    <p><strong>author</strong></p>
  </dt>
  <dd>
    <p>The name of the level author(s) for credit at the beginning of a level.</p>
  </dd>

</dl>

<h3>Identifier valued data</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>bgpic</strong></p>
  </dt>
  <dd>
    <p>Background picture (file name). If too small, placed at bottom. Defaults to none.</p>
  </dd>
  <dt>
    <p><strong>toppic</strong></p>
  </dt>
  <dd>
    <p>Appearance of the top border coming down (file name). Defaults to none.</p>
  </dd>
  <dt>
    <p><strong>explosionpic</strong></p>
  </dt>
  <dd>
    <p>Appearance of the explosions (file name). Has a default.</p>
  </dd>

</dl>

<h3>Number valued data</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>numexplode</strong></p>
  </dt>
  <dd>
    <p>The size that a group of blobs has to reach in order to explode. This is only the level-wide default. Each kind can override this. Whether the group does explode is also controlled by <strong>behaviour</strong>. See section <strong>VARIABLES AND CONSTANTS</strong> for details.</p>
  </dd>
  <dt>
    <p><strong>toptime</strong></p>
  </dt>
  <dd>
    <p>Time the border takes to come down, in number of game steps. Each game step lasts 80ms. The default value is 50 (i.e. one pixel every four seconds).</p>
  </dd>
  <dt>
    <p><strong>topoverlap</strong></p>
  </dt>
  <dd>
    <p>Placement of <strong>toppic</strong> relative to the actual border. More precisely, number of pixels the lower border of the picture is below the actual border. Defaults to the height of the picture.</p>
  </dd>
  <dt>
    <p><strong>topstop</strong></p>
  </dt>
  <dd>
    <p>When the border comes down at the end of the level, number of pixels it should stop before the bottom. Set this to the same value as topoverlap if you want your toppic to be comletely visible at the end. Defaults to 0.</p>
  </dd>
  <dt>
    <p><strong>chaingrass</strong></p>
  </dt>
  <dd>
    <p>Must be 0 or 1. If set to 1, chain reactions are necessary to kill the grass. Defaults to 0. More precisely, <strong>chaingrass</strong> only controls the default for <strong>behaviour</strong> for grass blobs. See section <strong>VARIABLES AND CONSTANTS</strong> for details.</p>
  </dd>
  <dt>
    <p><strong>mirror</strong></p>
  </dt>
  <dd>
    <p>Must be 0 or 1. If set to 1, the level appears upside-down. Defaults to 0.</p>
  </dd>
  <dt>
    <p><strong>randomfallpos</strong></p>
  </dt>
  <dd>
    <p>Must be 0 or 1. If set to 1, the initial fall position is randomized horizontally. Defaults to 0.</p>
  </dd>
  <dt>
    <p><strong>neighbours</strong></p>
  </dt>
  <dd>
    <p>Determines in which directions the blobs can connect to each other in order to form groups. This is only the level-wide default. Each kind can override this. See section <strong>VARIABLES AND CONSTANTS</strong> for values. Defaults to <strong>neighbours_rect</strong>.</p>
  </dd>
  <dt>
    <p><strong>randomgreys</strong></p>
  </dt>
  <dd>
    <p>The expected time between two randomly appearing greys in game steps (80ms). Use -1 for none at all, which is the default.</p>
  </dd>
  <dt>
    <p><strong>nogreyprob</strong></p>
  </dt>
  <dd>
    <p>The probability that a grey does not appear. See <strong>greyprob</strong> and <strong>colourprob</strong> in section <strong>KIND DATA</strong> for details. The default is 0.</p>
  </dd>
  <dt>
    <p><strong>aiu_color, aiu_grass, aiu_grey, aiu_two_above, aiu_monochromic_vertical, aiu_height</strong></p>
  </dt>
  <dd>
    <p>Parameters for the AI player's utility function. Default respectively to &lt;10*(number of kinds)&gt;, 20, 10, &lt;aiu_color/2&gt;, &lt;aiu_color&gt;, and 10. See section <strong>THE AI UTILITY FUNCTION</strong> for details.</p>
  </dd>

</dl>

<h3>Colour valued data</h3>
<p>(A colour is an RGB triple of numbers between 0 and 255.)</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>bgcolor</strong></p>
  </dt>
  <dd>
    <p>The background colour. Defaults to white.</p>
  </dd>
  <dt>
    <p><strong>textcolor</strong></p>
  </dt>
  <dd>
    <p>Colour of any text. This includes the beginning-of-level information, message()s, and score. Defaults to a certain shade of dark grey.</p>
  </dd>
  <dt>
    <p><strong>topcolor</strong></p>
  </dt>
  <dd>
    <p>The colour of the top border comming down (where not determined by <strong>toppic</strong>). Defaults to a certain shade of light grey.</p>
  </dd>

</dl>

<h3>Other data</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>startdist</strong></p>
  </dt>
  <dd>
    <p>Distribution of blobs at the beginning of the level. It is a list of strings, the format of which is described in the section <strong>STARTDIST</strong>.</p>
  </dd>
  <dt>
    <p><strong>pics, greypic, startpic, emptypic</strong></p>
  </dt>
  <dd>
    <p>Lists of kinds. These can be either file names referring to the picture to be used, or declarations of kinds that have to be defined later on. The different keywords (e.g. pics, emptypic) define different defaults. In fact, only the first three may be real lists, <strong>emptypic</strong> is limited to exactly one entry. In these lists, it is advisable to use <strong>*</strong> whenever possible. Besides being shorter to write, it also speeds up loading of the level and cuts down memory usage. This is because cuyo does some initializations only once for each entry with multiplier.</p><p>The intentions of these lists are normal blob kinds resp. grey blob kind resp. grass blob kind resp. nothing-blob. However, the only differences between <strong>pics</strong>, <strong>greypic</strong> and <strong>startpic</strong> are the default values for <strong>behaviour</strong>, <strong>colourprob</strong>, <strong>goalprob</strong>, <strong>greyprob</strong>, <strong>versions</strong> and <strong>distkey</strong> (see there). All of these can also be overridden individually. Also, the default drawing code is different. (The default drawing code for <strong>startpic</strong> does not draw connections.)</p>
  </dd>
  <dt>
    <p><strong></strong><em>kind</em></p>
  </dt>
  <dd>
    <p>Each kind can have its own section. See <strong>KIND DATA</strong> below for the entries of that section.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">KIND DATA</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>numexplode, neighbours</strong></p>
  </dt>
  <dd>
    <p>Defining these data in the section of a kind overrides the level-wide value for the kind. See section <strong>LEVEL DATA</strong> for a description of these data.</p>
  </dd>
  <dt>
    <p><strong>pics</strong></p>
  </dt>
  <dd>
    <p>A list of file names of pictures to be used for this kind. The <em>n</em>th entry can later be accessed in cual with <strong>file=</strong><em>n-1</em>.</p>
  </dd>
  <dt>
    <p><strong>colourprob</strong></p>
  </dt>
  <dd>
    <p>The probability that this kind appears as one of the two steered falling blobs. More precisely, this is a nonnegative integer weight. For determining the actual probability, the value is divided by the sum of the <strong>colourprob</strong>s of all kinds. This sum must be positive. The default is 1 for kinds declared with <strong>pics=</strong> and 0 for all other kinds. The probability is also used for <strong>+</strong> in <strong>startdist</strong>. For more details see section <strong>STARTDIST</strong>.</p>
  </dd>
  <dt>
    <p><strong>goalprob</strong></p>
  </dt>
  <dd>
    <p>This affects the semantics of <strong>*</strong> in <strong>startdist</strong> in the same way, as <strong>colourprob</strong> does for <strong>+</strong>. The default is 1 for kinds declared with <strong>startpic=</strong> and 0 for all other kinds.</p>
  </dd>
  <dt>
    <p><strong>greyprob</strong></p>
  </dt>
  <dd>
    <p>The probability that this kind appears as a grey blob. This is similar to <strong>colourprob</strong>, but there is a difference: For greyprob, <strong>nogreyprob</strong> is included in the sum, so that it might happen that no blob appears at all. There is a notable difference between a positive <strong>nogreyprob</strong> and a positive <strong>greyprob</strong> in kind <strong>nothing</strong>, when several lines of grey blobs appear: In the latter case, empty blobs appear in the wall of greys, making holes. In the former case, the wall is made less high. Usually this is preferable. The default is 1 for kinds declared with <strong>greypic=</strong> and 0 for all other kinds. The value also affects the semantics of <strong>-</strong> in <strong>startdist</strong>. In this case, <strong>nogreyprob</strong> is not included in the sum.</p>
  </dd>
  <dt>
    <p><strong>versions</strong></p>
  </dt>
  <dd>
    <p>At the creation of a blob, its <strong>version</strong> variable is initialized. Usually, it is chosen at random from <strong>0</strong> to <strong>versions-1</strong>, but <strong>startdist</strong> provides the possibility to specify it exactly. See section <strong>STARTDIST</strong> for details. The default is 52 for kinds declared with <strong>startpic</strong> and 1 for all other kinds.</p>
  </dd>
  <dt>
    <p><strong>distkey</strong></p>
  </dt>
  <dd>
    <p>An alphanumerical key, which is used in <strong>startdist</strong> to identify this kind of blob. The default is <strong>A</strong> for kinds declared with <strong>startpic</strong> and undefined for all other kinds. See section <strong>STARTDIST</strong> for details.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CUAL DEFINITIONS</h2>
        <div class="sectioncontent">
<p>Inside &lt;&lt; &gt;&gt;, variable and procedure definitions are expected.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong></strong><em>procname</em><strong> = </strong><em>code</em><strong> ;</strong></p>
  </dt>
  <dd>
    <p>Defines a "procedure". The next section describes how <em>code</em> looks like. Example:</p>
<pre>
  redblob = {
</pre>

<pre>
    schema16; 0*;
</pre>

<pre>
    1; A,B,C; *;
</pre>

<pre>
  };
</pre>

  </dd>
  <dt>
    <p><strong>var </strong><em>varname1</em> [<strong>= </strong><em>def1</em> [<strong>: reapply</strong>]]<strong>, </strong><em>varname2</em> [<strong>= </strong><em>def2</em> [<strong>: reapply</strong>]]<strong>, </strong>...<strong> ;</strong></p>
  </dt>
  <dd>
    <p>Defines variables with default values. If no default is specified, zero is used. See section <strong>VARIABLES AND CONSTANTS</strong> about the meaning of the default value and the optional suffix <strong>: reapply</strong>.</p>
  </dd>
  <dt>
    <p><strong>default </strong><em>varname1</em><strong> = </strong><em>def1</em> [<strong>: reapply</strong>]<strong>, </strong><em>varname2</em><strong> = </strong><em>def2</em> [<strong>: reapply</strong>]<strong>, </strong>...<strong> ;</strong></p>
  </dt>
  <dd>
    <p>Changes the default for already defined variables. Again, the suffix <strong>: reapply</strong> is optional. This is useful to give to a single kind a different default for a variable than to the other kinds. Also, the default of a system variable can be changed this way.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CODE</h2>
        <div class="sectioncontent">
<p>A code fragment can be one of the following:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>{ </strong><em>code</em><strong>; </strong><em>code</em><strong>; ...}</strong></p>
  </dt>
  <dd>
    <p>Executes one command after the other.</p>
  </dd>
  <dt>
    <p><strong></strong><em>code</em><strong>, </strong><em>code</em><strong>, ...</strong></p>
  </dt>
  <dd>
    <p>This is useful for simple animations. Executes exactly one of the commands: In the n-th call, the n-th command is executed. After the last command, the first one is executed again. However, if one of the commands is "busy" (see section <strong>BUSIENESS</strong>), this one will be executed until it stops being busy, and only after that, the next command will be executed.</p>
  </dd>
  <dt>
    <p><strong></strong><em>procname</em><strong></strong></p>
  </dt>
  <dd>
    <p>Executes the procedure <em>procname</em>, which has to be already defined. The result is the same as if the code from procname would have been inserted in that place.</p>
  </dd>
  <dt>
    <p><strong>&</strong><em>procname</em><strong></strong></p>
  </dt>
  <dd>
    <p>Executes the procedure <em>procname</em>; however, every instance of such a procname is the same. This concerns busieness and the state of an animation sequence. (See sections <strong>BUSIENESS</strong> and <strong>AMPERSAND-CALL</strong>.)</p>
  </dd>
  <dt>
    <p><strong>busy</strong></p>
  </dt>
  <dd>
    <p>Does nothing except being busy. (See section <strong>BUSIENESS</strong>.)</p>
  </dd>
  <dt>
    <p><strong></strong><em>varname</em><strong> = </strong><em>expr</em><strong></strong></p>
  </dt>
  <dd>
    <p>Sets the variable. See section <strong>VARIABLES AND CONSTANTS</strong> for details.</p>
  </dd>
  <dt>
    <p>The same with <strong>+=</strong>, <strong>-=</strong>, <strong>*=</strong>, <strong>/=</strong>, <strong>%=</strong>, <strong>.+=</strong>, <strong>.-=</strong>.</p>
  </dt>
  <dd>
    <p>Does what you would expect.</p>
  </dd>
  <dt>
    <p><strong>[ </strong><em>varname</em><strong> = </strong><em>expr</em><strong> ] </strong><em>code</em><strong></strong></p>
  </dt>
  <dd>
    <p>Sets the variable <em>varname</em> to <em>expr</em>, executes <em>code</em> and then resets the variable to the old value.</p>
  </dd>
  <dt>
    <p><strong></strong><em>number</em><strong></strong></p>
  </dt>
  <dd>
    <p>A shortcut for <strong>file = </strong><em>number</em>.</p>
  </dd>
  <dt>
    <p><strong></strong><em>letter</em><strong></strong></p>
  </dt>
  <dd>
    <p>A shortcut for <strong>pos = </strong><em>number</em>, where different letters mean different numbers: A: 0, B: 1, ..., Z: 25, a: 26, ..., z: 51</p>
  </dd>
  <dt>
    <p><strong>*</strong></p>
  </dt>
  <dd>
    <p>Draw the icon specified by the variables <em>kind</em>, <em>file</em> and <em>pos</em>. May also draw only a part of the icon, if specified by the variable <em>qu</em> (see section <strong>VARIABLES AND CONSTANTS</strong>).</p>
  </dd>
  <dt>
    <p><strong>*@(</strong><em>position</em><strong>)</strong></p>
  </dt>
  <dd>
    <p>Like <strong>*</strong>, but draws the icon at some other position. This drawing is performed <em>after</em> all drawing by *. If <strong>*@</strong> is used from several blobs, the further order of drawing is not specified. It is guaranteed, however, that at any given time this order is the same for all positions. (See section <strong>VARIABLES AND CONSTANTS</strong> for more details about @.)</p>
  </dd>
  <dt>
    <p><strong>@(</strong><em>position</em><strong>)*</strong></p>
  </dt>
  <dd>
    <p>Like <strong>*</strong>, but draws the icon at some other position. This drawing is performed <em>before</em> all drawing by *. If <strong>@*</strong> is used from several blobs, the further order of drawing is not specified. It is guaranteed, however, that at any given time this order is the same for all positions. (See section <strong>VARIABLES AND CONSTANTS</strong> for more details about @.)</p>
  </dd>
  <dt>
    <p><strong>if </strong><em>expr</em><strong> </strong><em>if-arrow</em><strong> </strong><em>if-code</em><strong> ;</strong></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>if </strong><em>expr</em><strong> </strong><em>if-arrow</em><strong> </strong><em>if-code</em><strong> else </strong>[<em>else-arrow</em>]<strong> </strong><em>else-code</em><strong> ;</strong></p>
  </dt>
  <dd>
    <p>The arrows can be either "-&gt;" or "=&gt;". If you use "-&gt;" arrows, it does exactly what you would expect. If the if-arrow  is "=&gt;", then once the expression gets true, the if-code will be executed every subsequent time (without testing the condition), as long as it is "busy". For more details see section <strong>BUSIENESS</strong>. If the else-arrow is "=&gt;", then once the expression gets false, the else-code will be executed every subsequent time as long as it is busy. The else-arrow may only be omitted, if the if-arrow is "-&gt;". Then the else-arrow also is "-&gt;". (But this might change in the future.)</p>
  </dd>
  <dt>
    <p><strong>switch {</strong></p>
  </dt>
  <dd>
    <p><strong>&nbsp;</strong><em>expr1</em><strong> </strong><em>arrow1</em><strong> </strong><em>code1</em><strong> ;</strong> <strong>&nbsp;</strong><em>expr2</em><strong> </strong><em>arrow2</em><strong> </strong><em>code2</em><strong> ;</strong> <strong>&nbsp;...</strong> <strong>}</strong> The arrows can be either "-&gt;" or "=&gt;". Does the same as:</p>
<pre>
  if <em>expr1</em> <em>arrow1</em> <em>code1</em>
</pre>

<pre>
  else =&gt; if <em>expr2</em> <em>arrow2</em> <em>code2</em>
</pre>

<pre>
  ...
</pre>
<p>The last <em>expr</em> may be omitted. This is equivalent to setting it to true.</p>
  </dd>
  <dt>
    <p><strong>bonus(</strong><em>expr</em><strong>)</strong></p>
  </dt>
  <dd>
    <p>The player gets <em>expr</em> bonus points.</p>
  </dd>
  <dt>
    <p><strong>message(</strong><em>String</em><strong>)</strong></p>
  </dt>
  <dd>
    <p>The string is displayed (blinking) on the screen. To be used together with bonus(...). Example:</p>
<pre>
  bonus(50);
</pre>

<pre>
  message("You get 50 bonus points");
</pre>

  </dd>
  <dt>
    <p><strong>explode</strong></p>
  </dt>
  <dd>
    <p>Makes the blob explode. For the next 8 steps or so, the blob is still what it was before, but the explosion is drawn over the graphics. After that, it's changed to a nothing-blob.</p>
  </dd>
  <dt>
    <p><strong>lose</strong></p>
  </dt>
  <dd>
    <p>The players immediately lose the level.</p>
  </dd>
  <dt>
    <p><strong>sound(</strong><em>Filename</em><strong>)</strong></p>
  </dt>
  <dd>
    <p>Plays the given sound file.</p>
  </dd>

</dl>
<p>You can also omit the code completely. Then, of course, it does not do anything. This can be useful as part of <strong>,</strong>-sequences.</p><p>There's a shortcut for drawing: You may omit the ";" between a number, a letter and the "*".</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXPRESSIONS</h2>
        <div class="sectioncontent">
<p>The only data type in cual is int. Bools are represented by 0 and 1, like in C. (And any number other than 0 is interpreted as true, if a boolean is expected.)</p><p>Of course, variables, constants and numbers are expressions, and you can use parentheses. There are the following operators (listed here in order of increasing precedence):</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>||</strong></p>
  </dt>
  <dd>
    <p>Boolean or</p>
  </dd>
  <dt>
    <p><strong>&&</strong></p>
  </dt>
  <dd>
    <p>Boolean and</p>
  </dd>
  <dt>
    <p><strong>==</strong>, <strong>!=</strong>, <strong>&lt;</strong>, <strong>&gt;</strong>, <strong>&lt;=</strong>, <strong>&gt;=</strong></p>
  </dt>
  <dd>
    <p>Comparison</p>
  </dd>
  <dt>
    <p><strong>==..</strong></p>
  </dt>
  <dd>
    <p>A special comparison</p>
  </dd>
  <dt>
    <p><strong>!</strong></p>
  </dt>
  <dd>
    <p>Boolean not</p>
  </dd>
  <dt>
    <p><strong>+</strong>, <strong>-</strong></p>
  </dt>
  <dd>
    <p>Add, substract</p>
  </dd>
  <dt>
    <p><strong>:</strong></p>
  </dt>
  <dd>
    <p>Special operator</p>
  </dd>
  <dt>
    <p><strong>*</strong>, <strong>/</strong>, <strong>%</strong></p>
  </dt>
  <dd>
    <p>Multiply, divide, modulo</p>
  </dd>
  <dt>
    <p><strong>&</strong>, <strong>|</strong>, <strong>.+</strong>, <strong>.-</strong></p>
  </dt>
  <dd>
    <p>Bitwise and, bitwise or, setting of bits (same as bitwise or), unsetting of bits</p>
  </dd>
  <dt>
    <p><strong>-</strong></p>
  </dt>
  <dd>
    <p>Unary minus</p>
  </dd>
  <dt>
    <p><strong>.</strong></p>
  </dt>
  <dd>
    <p>Testing of bits (<em>a</em><strong>.</strong><em>b</em> is the same as <em>a</em><strong>&</strong><em>b</em><strong> != 0</strong>)</p>
  </dd>

</dl>
<p><strong>/</strong> and <strong>%</strong> work mathematically correct and do not make funny changes when the sign of the numerator changes. More specifically, if <em>b</em> is positive, then <em>a</em><strong>/</strong><em>b</em> is the largest integer <em>n</em> such that <em>n</em><strong>*</strong><em>b</em><strong>&lt;=</strong><em>a</em>. If <em>b</em> is negative, then <em>a</em><strong>/</strong><em>b</em> is the largest integer <em>n</em> such that <em>n</em><strong>*</strong><em>b</em><strong>&gt;=</strong><em>a</em>. In both cases <em>a</em><strong>%</strong><em>b</em> is such that <strong>(</strong><em>a</em><strong>/</strong><em>b</em><strong>)*</strong><em>b</em><strong>+</strong><em>a</em><strong>%</strong><em>b</em><strong> = </strong><em>a</em>. Examples:</p><table class="table table-striped">
<tr>
<th></th>
<th></th>
<th></th></tr>

<tr>
<td>13/5=2 # 13%5=3</td>
<td></td>
<td></td></tr>

<tr>
<td>-13/5=-3 # -13%5=2</td>
<td></td>
<td></td></tr>

<tr>
<td>13/-5=-3 # 13%-5=-2</td>
<td></td>
<td></td></tr>

<tr>
<td>-13/-5=2 # -13%-5=-3</td>
<td></td>
<td></td></tr>
</table><p>The following are the special operators:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong></strong><em>expr1</em><strong> == </strong><em>expr2</em><strong> .. </strong><em>expr3</em><strong></strong></p>
  </dt>
  <dd>
    <p>Is true, if <em>expr1</em> lies between <em>expr2</em> and <em>expr3</em>. You may also omit one of <em>expr2</em> and <em>expr3</em>. (Then, it does the same as &lt;= resp. &gt;=.) The precedence implies that <strong>x==y==2..3</strong> is the same as <strong>x==(y==2..3)</strong> and is neither <strong>(x==y)==2..3</strong> nor <strong>x==(y==2)..3</strong>. Note that this operator might change in the future. (I plan to make something like "<em>expr</em> in <em>set</em>" in Pascal.)</p>
  </dd>
  <dt>
    <p><strong></strong><em>expr1</em><strong> : </strong><em>expr2</em><strong></strong></p>
  </dt>
  <dd>
    <p>Is true (that is, 1) with probability <em>expr1</em>/<em>expr2</em></p>
  </dd>
  <dt>
    <p><strong></strong><em>neighbour_pattern</em><strong></strong></p>
  </dt>
  <dd>
    <p><em>neighbour_pattern</em> is a sequence of six or eight characters <strong>0</strong>, <strong>1</strong> and <strong>?</strong>. It is true if the sequence fits to the neighbour sequence of the blob. The neighbour sequence is a string of "0"s and "1"s with a "1" for each neighbour of the same kind, starting above and going clockwise. This way, you get a string of "0"s and "1"s (six or eight, depending on wether this level is in hex mode).</p><p>Example: <strong>1???0???</strong> is true iff the blob above this blob is of the same kind and the blob below it is of different kind.</p><p>For an empty blob the semantics is slightly different: If in some direction there is no neighbour, because the field ends there, the entry in the neighbour sequence is 1 nevertheless. So for an empty blob <strong>1???0???</strong> is true, iff the blob above this blob does not exist or is empty as well, and the blob below this blob exists and is not empty.</p><p>If some blob changes its kind during a step, the expression will still test the neighbours as they were at the beginning of the step. (See the section <strong>VARIABLES AND CONSTANTS</strong> for details.)</p>
  </dd>

</dl>
<p>The following functions exist:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>rnd(</strong><em>expr</em><strong>)</strong></p>
  </dt>
  <dd>
    <p>Returns a random value between 0 and <em>expr</em>-1</p>
  </dd>
  <dt>
    <p><strong>gcd(</strong><em>expr1</em><strong>, </strong><em>expr2</em><strong>)</strong></p>
  </dt>
  <dd>
    <p>Returns the greatest common divisor of <em>expr1</em> and <em>expr2</em></p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VARIABLES AND CONSTANTS</h2>
        <div class="sectioncontent">
<p>The following kinds of variables and constants exist:</p>
<dl class='dl-vertical'>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>User defined variables (see section <strong>CUAL DEFINITIONS</strong>). At the start of the level (or at the creation of the blob) the value is the default value you provided. If you supplied the default with <strong>: reapply</strong>, whenever a blob's kind changes, the value of the variable is also set to the default of the new kind. There is a subtlety: This only happens if the new value of kind is in fact different from the old one.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>System variables. These variables are always defined and have special meanings, e.g. <strong>file</strong> and <strong>pos</strong>. Some of them are read-only.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>User defined constants. These are defined in the main .ld part, not in cual (not inside &lt;&lt; &gt;&gt;).</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>System constants. Some of them depend on properties of the level, some are really constant.</p>
  </dd>

</dl>
<p>Of each variable, there's one instance in each blob. Normally, you access the instance in your own blob, but with the following syntax, you can access variables of other blops:</p>
<pre>
  <em>varname</em><strong>@@(</strong><em>x</em><strong>, </strong><em>y</em><strong>; </strong><em>side</em><strong>)</strong>
</pre>

<pre>
  <em>varname</em><strong>@@(</strong><em>x</em><strong>; </strong><em>side</em><strong>)</strong>
</pre>

<pre>
  <em>varname</em><strong>@@(; </strong><em>side</em><strong>)</strong>
</pre>

<pre>
  <em>varname</em><strong>@(</strong><em>dx</em><strong>, </strong><em>dy</em><strong>; </strong><em>side</em><strong>)</strong>
</pre>

<pre>
  <em>varname</em><strong>@(</strong><em>dx</em><strong>; </strong><em>side</em><strong>)</strong>
</pre>

<pre>
  <em>varname</em><strong>@()</strong>
</pre>
<p>If <em>x</em> and <em>y</em> are given, these are absolute coordinates in the grid of blops, that is the variable is taken from the blob with loc_x=x and loc_y=y (see under <strong>The system variables</strong>). If only <em>x</em> is given, it specifies one of the two blobs that are currently falling. If there is only one such blob left, because the other one got stuck on some tower, the remaining blob's coordinate is 0. Otherwise one of the two has coordinate 0, the other 1.</p><p>In the <strong>@</strong> variants, the coordinates are relative to the current blob. The variant <strong>@@(; </strong><em>side</em><strong>)</strong> refers to the semiglobal blob, the variant <strong>@()</strong> to the global blob (See section <strong>THE GLOBAL BLOB</strong>). The extra part <strong>; </strong><em>side</em> is optional and specifies the side of the game. This is only meaningful in two-player mode. <em>side</em> = <strong>&lt;</strong> specifies the left player, <em>side</em> = <strong>&gt;</strong> the right player, <em>side</em> = <strong>=</strong> the player to which the current blob pertains, and <em>side</em> = <strong>!</strong> the other player. <strong>@()</strong> and <strong>@@()</strong> can also be given as <strong>@</strong> respectively <strong>@@</strong>.</p><p>This can be done for both, reading and writing variables. It also works for system variables (but not for constants).</p><p>In hex mode levels, for odd <em>dx</em>, <em>dy</em> should be a "half integer", that is a number ending in ".5". This is the only place in Cual where non-integers appear. Especially, ".5" is not allowed in composite expressions. Therefore, also integer <em>dy</em> is always allowed. If a half-integer is expected and an integer is given, it is assumed to be rounded to above, that is 5 then represents 4.5 and -5 represents -5.5.</p><p>Caution: With <strong>mirror=1</strong> the absolute and the relative coordinates use different coordinate systems. Handle with extreme care.</p><p>Accessing foreign variables is not as easy as it might look at first glance; it might easily introduce a dependence of the internal order of execution of the blob codes. For this reason,</p>
<dl class='dl-vertical'>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>reading variables with <strong>@</strong> or <strong>@@</strong> always returns the value of the variable it had at the <em>beginning</em> of the current step, that is, before any of the blob codes has been executed.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>when writing variables with <strong>@</strong> or <strong>@@</strong>, the write operation will only be executed at the <em>end</em> of the current step. (The write operations are stored in a kind of queue.)</p>
  </dd>

</dl>
<p>This is also true if a blob accesses its own variables with <strong>@(0,0)</strong>.</p><p>The operators <strong>+=</strong>, <strong>-=</strong>, etc. are also performed in the future if the left hand side is an <strong>@</strong>-variable. (To be more precice, the right hand side is calculated instantanousely.)</p><p>For illustration, look at the following six statements:</p><table class="table table-striped">
<tr>
<th>1)</th>
<th>X += 1</th></tr>

<tr>
<td>2)</td>
<td>X@(0, 0) += 1</td></tr>

<tr>
<td>3)</td>
<td>X = X + 1</td></tr>

<tr>
<td>4)</td>
<td>X = X@(0, 0) + 1</td></tr>

<tr>
<td>5)</td>
<td>X@(0, 0) = X + 1</td></tr>

<tr>
<td>6)</td>
<td>X@(0, 0) = X@(0, 0) + 1</td></tr>
</table><p>Only 1) and 3) do the same; they simply increment X by 1. Statement 4) sets X to one more than it was at the beginning of the step. Statements 2), 5) and 6) cause the value of X to be changed in the future (after the current step): X is set to one more than:</p>
<dl class='dl-vertical'>
  <dt>
    <p>2)</p>
  </dt>
  <dd>
    <p>the value of X just before the change (that is, X is incremented in the future),</p>
  </dd>
  <dt>
    <p>5)</p>
  </dt>
  <dd>
    <p>the current value of X,</p>
  </dd>
  <dt>
    <p>6)</p>
  </dt>
  <dd>
    <p>the value of X at the beginning of the step.</p>
  </dd>

</dl>
<h3>Some more details</h3>

<dl class='dl-vertical'>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>Whenever you try to access a variable at a location which doesn't exist, you will get the default value. If default values depend on the kind, the default pertaining to the blob executing the code is used. This may change in the future.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>Changing a variable which doesn't exist does nothing (and does not result in an error).</p>
  </dd>
  <dt>
    <p>[Add explanation of <em>time slices</em>; roughly:</p>
  </dt>
  <dd>
    <p>@-access of variables in reality don't access the value at the beginning/end of the game step, but of the time slice. The call of the main procedure of all blobs happens in the same time slice, but each other kind of event has its own time slice.]</p>
  </dd>

</dl>

<h3>The system variables</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>file</strong></p>
  </dt>
  <dd>
    <p>Specifies the file number from which to take the icon that is drawn by "*". This variable is reset to 0 before the drawing procedure is executed.</p>
  </dd>
  <dt>
    <p><strong>pos</strong></p>
  </dt>
  <dd>
    <p>Specifies the position in the file of the icon that is drawn by "*". This variable is reset to 0 before the drawing procedure is executed.</p>
  </dd>
  <dt>
    <p><strong>kind</strong></p>
  </dt>
  <dd>
    <p>The kind of the blob. There are constants for the possible values of this variable. If you change the kind, you should be aware of three things:</p>
<dl class='dl-vertical'>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>Expressions like "001???01" test the neighbour pattern at the <em>beginning</em> of the current step. So the change of the variable <em>kind</em> will not be reflected.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>In the current step, the program to draw the blob has already been invoked (it might even be the program which changed this variable); so in this step, the blob will still look like one of the old kind. However, if things are drawn after the kind has been changed, icons from the new kind are taken.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>Defaults of the new kind that are declared with <strong>: reapply</strong> are applied. This happens at the same time that kind changed, but only if the new kind is different from the old one.</p>
  </dd>

</dl>

  </dd>
  <dt>
    <p><strong>version</strong></p>
  </dt>
  <dd>
    <p>Is assigned a hopefully distinctive value at the blob's creation. See <strong>versions</strong> in section <strong>KIND DATA</strong> for details.</p>
  </dd>
  <dt>
    <p><strong>qu</strong></p>
  </dt>
  <dd>
    <p>Tells "*" which part of the icon to draw. It's possible to draw the whole icon, or only one of its quarters. If a quarter is drawn, you may specify independently which of the quarters to take and at which position to draw it. Use the constants (see below). This variable is reset to "draw all" before the drawing procedure is executed.</p>
  </dd>
  <dt>
    <p><strong>out1, out2</strong></p>
  </dt>
  <dd>
    <p>Set these Variables for debug output. The values will be printed on top of the blob. These variable are reset to "output nothing" before the drawing procedure is executed. (In fact, "output nothing" is one special big value.)</p>
  </dd>
  <dt>
    <p><strong>inhibit</strong></p>
  </dt>
  <dd>
    <p>Set this variable to a sum of the constants DIR_...; this will inhibit that this blob connects into the given directions. This is <em>not</em> for the graphics but for the calculation of the connected components and the explosions.</p>
  </dd>
  <dt>
    <p><strong>behaviour</strong></p>
  </dt>
  <dd>
    <p>This is a bit field. Refer to <strong>The Constants</strong> below for the meaningful of its bits. The default is <strong>calculate_size</strong>+<strong>explodes_on_size</strong> for normal blobs, <strong>explodes_on_explosion</strong>+<strong>explodes_on_chainreaction</strong> for grey blobs, <strong>floats</strong> for the empty blob and <strong>goalblob</strong>+<strong>explodes_on_explosion</strong>+<strong>explodes_on_chainreaction</strong> or <strong>goalblob</strong>+<strong>explodes_on_chainreaction</strong> (depending on whether chaingrass is set) for grass blobs.</p>
  </dd>
  <dt>
    <p><strong>falling_speed, falling_fast_speed</strong></p>
  </dt>
  <dd>
    <p>These variables are only used in the semiglobal blobs. They define the vertical speed of the steered falling blobs. The unit is pixels per game step. The defaults are 6 and 32.</p>
  </dd>

</dl>

<h3>The system read-only variables</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>time</strong></p>
  </dt>
  <dd>
    <p>The number of time steps since the level was started.</p>
  </dd>
  <dt>
    <p><strong>turn</strong></p>
  </dt>
  <dd>
    <p>Is 1 resp. 2 if the blob is falling and just being turned by the user and 0 otherwise. (1 in the first turning step, 2 in the second one.) Be aware that if the user presses the turn key fast several times, some of these steps may be omitted. (Use the turn event if you want to be sure that a program block is executed once for every turn.)</p>
  </dd>
  <dt>
    <p><strong>connect</strong></p>
  </dt>
  <dd>
    <p>Contains internal data. Will be removed. Probably.</p>
  </dd>
  <dt>
    <p><strong>size</strong></p>
  </dt>
  <dd>
    <p>The size of the component of the blob. (That is, how many blobs are connected.)</p>
  </dd>
  <dt>
    <p><strong>basekind</strong></p>
  </dt>
  <dd>
    <p>The value of the constant generated for the name of the kind of the blop. Example:</p>
<pre>
  <strong>pics = orange, pear, apple * 3, banana, apple</strong>
</pre>
<p>Here, all four kinds <strong>apple</strong> have the same value for basekind, and this value is <strong>apple</strong>.</p>
  </dd>
  <dt>
    <p><strong>loc_x, loc_y</strong></p>
  </dt>
  <dd>
    <p>The absolute coordinates of the blob. (0,0) = top left corner</p>
  </dd>
  <dt>
    <p><strong>loc_xx, loc_yy</strong></p>
  </dt>
  <dd>
    <p>The absolute coordinates of the blob in pixels. This is not always the same as loc_x*32 and loc_y*32, particularly for the steered falling blobs.</p>
  </dd>
  <dt>
    <p><strong>loc_p</strong></p>
  </dt>
  <dd>
    <p>The player of the blob (1 or 2)</p>
  </dd>
  <dt>
    <p><strong>falling</strong></p>
  </dt>
  <dd>
    <p>true, if the blob is falling. (Falling in the sense of steered by the player. Grey blobs are not falling in that sense.)</p>
  </dd>
  <dt>
    <p><strong>falling_fast</strong></p>
  </dt>
  <dd>
    <p>true, if the blob is falling fast, that is, the user pressed the down key.</p>
  </dd>
  <dt>
    <p><strong>players</strong></p>
  </dt>
  <dd>
    <p>The number of players.</p>
  </dd>
  <dt>
    <p><strong>exploding</strong></p>
  </dt>
  <dd>
    <p>When the blob is exploding, the position in the explosion animation (1 to 8); 0 else.</p><p>Currently, there is one exception: if the explosion has been triggered by the <strong>explode</strong> command, then <strong>exploding</strong> will have value 1 only <em>after</em> the current game step [more precisely: time slice; fix that]. Reason: when reading <strong>exploding@(x,y)</strong>, we maybe don't know yet that the other blob calls <strong>explode</strong>.</p>
  </dd>

</dl>

<h3>The Constants:</h3>
<p><strong>Constants for behaviour:</strong></p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>goalblob</strong></p>
  </dt>
  <dd>
    <p>Set goalblob if this blob should act like grass: You will have to get rid of it to win the level and making this blob explode will give more points.</p>
  </dd>
  <dt>
    <p><strong>calculate_size</strong></p>
  </dt>
  <dd>
    <p>When this bit is set, <strong>size</strong> will be regularly updated to the sum of <strong>weight</strong> in the connected component.</p>
  </dd>
  <dt>
    <p><strong>explodes_on_size</strong></p>
  </dt>
  <dd>
    <p>When this bit is set, a connected component explodes, when it has <strong>size</strong>&gt;=<strong>numexplode</strong>.</p>
  </dd>
  <dt>
    <p><strong>explodes_on_explosion, explodes_on_chainreaction</strong></p>
  </dt>
  <dd>
    <p>When these bits are set, the blob explodes whenever an explosion that was triggered by <strong>explodes_on_size</strong> happens in its neighbourhood. <strong>explodes_on_chainreaction</strong> refers to those triggering explosions that are the second or later part of a chain reaction. <strong>explodes_on_explosion</strong> refers to the other ones.</p>
  </dd>
  <dt>
    <p><strong>floats</strong></p>
  </dt>
  <dd>
    <p>When this bit is set, the blob keeps its vertical position even if there is an empty blob below. This bit has no effect on the steered falling blobs.</p>
  </dd>

</dl>
<p><strong>Constants for kind:</strong></p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>&lt;name of kind of blob&gt;</strong></p>
  </dt>
  <dd>
    <p>For each kind of blob, there's one constant with the name of that kind. Use it to check if a blob is of that kind using <strong>kind@(</strong><em>x</em><strong>,</strong><em>y</em><strong>) == </strong><em>aKind</em> or to change to that kind using <strong>kind = </strong><em>aKind</em>. See <strong>kind</strong> under <strong>The system variables</strong> for the side-effects of setting <strong>kind</strong>.</p><p>Sometimes it is necessary to perform arithmetic on kinds, for example when several have been declared using the <strong>*</strong> multiplier. The values of the constants are successive in the order, in which the kinds have been declared. When a name is used several times, the first use defines the value. Example:</p>
<pre>
  <strong>startpic = apple, orange</strong>
</pre>

<pre>
  pics = orange, pear, apple * 3, banana
</pre>

<pre>
  greypic = pineapple
</pre>
<p>This initializes 2 kinds with the defaults for startpic, 6 kinds with the defaults for pics, and 1 kind with the defaults for greypic. The value of the constant <strong>orange</strong> is 1 more than that of <strong>apple</strong>, <strong>pear</strong> is 2 more than <strong>orange</strong>, <strong>banana</strong> is 4 more than <strong>pear</strong> and <strong>pineapple</strong> is 1 more than <strong>banana</strong>. We do not specify what these values actually are.</p><p>This constant also exists for the empty kind, if one has been declared using <strong>emptypic</strong>. In this case the value's relation to the other values is not specified at all.</p>
  </dd>
  <dt>
    <p><strong>global, semiglobal</strong></p>
  </dt>
  <dd>
    <p>Denote the kind of the global, respectively semiglobal, blob.</p>
  </dd>
  <dt>
    <p><strong>nothing</strong></p>
  </dt>
  <dd>
    <p>Is the same as the constant for the empty kind. Is provided, because sometimes, you don't have an empty kind, but you still need to test if a blob is empty.</p>
  </dd>
  <dt>
    <p><strong>outside</strong></p>
  </dt>
  <dd>
    <p>The value of kind if the coordinates are outside of the game board.</p>
  </dd>

</dl>
<p><strong>Constants for neighbours:</strong></p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>neighbours_rect</strong></p>
  </dt>
  <dd>
    <p>A blob connects up, down, left, and right. This is the default.</p>
  </dd>
  <dt>
    <p><strong>neighbours_diagonal</strong></p>
  </dt>
  <dd>
    <p>A blob connects diagonally.</p>
  </dd>
  <dt>
    <p><strong>neighbours_hex6</strong></p>
  </dt>
  <dd>
    <p>When used in the level-wide <strong>neighbours</strong>, this sets hex mode. A blob connects up, down, left with a slight upwards shift, left with a slight downwards shift, right with a slight upwards shift, and right with a slight downwards shift.</p>
  </dd>
  <dt>
    <p><strong>neighbours_hex4</strong></p>
  </dt>
  <dd>
    <p>When used in the level-wide <strong>neighbours</strong>, this sets hex mode. A blob connects left with a slight upwards shift, left with a slight downwards shift, right with a slight upwards shift, and right with a slight downwards shift.</p>
  </dd>
  <dt>
    <p><strong>neighbours_knight</strong></p>
  </dt>
  <dd>
    <p>A blob connects in knight moves (Two forward and then one sideways. Forward is one of up, down, left or right. Sideways is perpendicular to forward. This makes a total of eight directions.).</p>
  </dd>
  <dt>
    <p><strong>neighbours_eight</strong></p>
  </dt>
  <dd>
    <p>Combines <strong>neighbours_rect</strong> with <strong>neighbours_diagonal</strong>.</p>
  </dd>
  <dt>
    <p><strong>neighbours_3D</strong></p>
  </dt>
  <dd>
    <p>A more obscure mode created especially for 3d.ld. When used in the level-wide <strong>neighbours</strong>, this sets hex mode. A blob connects up, down, two (but not one) to the left, and two to the right. In even columns it also connects right with a slight upwards shift. In odd columns it also connects left with a slight downwards shift.</p>
  </dd>
  <dt>
    <p><strong>neighbours_none</strong></p>
  </dt>
  <dd>
    <p>A blob does not connect at all.</p>
  </dd>

</dl>
<p><strong>Constants for qu:</strong></p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>Q_ALL</strong></p>
  </dt>
  <dd>
    <p>Value for qu, which means "draw the complete picture".</p>
  </dd>
  <dt>
    <p><strong>Q_TL, Q_TR, Q_BL, Q_BR</strong></p>
  </dt>
  <dd>
    <p>Values for qu. "TL" means draw top-left quarter, etc. (See the "*" command in the Code section.)</p>
  </dd>
  <dt>
    <p><strong>Q_SRC_DST</strong></p>
  </dt>
  <dd>
    <p>SRC and DST may be TL, TR, BL, BR. Take quarter SRC and draw it at position DST.</p>
  </dd>

</dl>
<p><strong>Miscellanious constants:</strong></p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>DIR_XX</strong></p>
  </dt>
  <dd>
    <p>To be used with the variable inhibit to prevent the blob connecting in the given directions. XX can be U, D, L, R (horizontal and vertical); UL, UR, DL, DR (diagonal); UUL, UUR, DDL, DDR, LLU, LLD, RRU, RRD (knight); F, B (3d)</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VERSIONING</h2>
        <div class="sectioncontent">
<p>Sometimes it is necessary to define a level slightly differently for different purposes. For example you might need to decrease <strong>numexplode</strong> for the two-player version lest it becomes unplayable. The difficulty settings from cuyo's main menu provide another example.</p><p>This is done by qualifiing a definition with the versions it should apply to. It is best explained by an example:</p>
<pre>
  numexplode = 8
</pre>

<pre>
  numexplode[2] = 6
</pre>

<pre>
  numexplode[1,hard] = 10
</pre>
<p>This specifies that normally numexplode should be 8. In two-player mode it should be 6. In one-player hard mode it should be 10. Here the specifiers <strong>2</strong> for two-player mode, <strong>1</strong> for one-player mode and <strong>hard</strong> for hard mode are used. Along with <strong>easy</strong> for easy mode these are all predefined specifiers intended for levels. Additionally (and for internal purposes), there are specifiers for the level tracks: <strong>main</strong>, <strong>all</strong>, <strong>game</strong>, <strong>extreme</strong>, <strong>nofx</strong>, <strong>weird</strong>, and <strong>contrib</strong>.</p><p>Furthermore, you can make up and use your own specifiers. In order for them to take effect, though, you have to give cuyo additional information about the current version. This is done on the command line using the <strong>--version</strong> option. For example</p>
<pre>
  cuyo --version=hard,geek
</pre>
<p>Specifies both hard version (you can change that in the menu) and version "geek", which is not predefined.</p><p>There are several constraints to be observed:</p>
<dl class='dl-vertical'>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>All versions of a definition must be made before the first use of the thing defined. As sometimes it is not obvious where the defined thing is used (for example startpic uses a previous greypic by assigning successive numbers to kinds), it is best to group all these versions into one block.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>A given version also applies to every more specialized version, for which no definition is given. In the above example, <strong>numexplode</strong> is set to <strong>6</strong> in two-player hard mode and in two-player easy mode as well.</p><p>All resulting conflicts must be resolved. For example, if you make a definition for <strong>[2]</strong> and one for <strong>[hard]</strong>, you must also make a definition for <strong>[2,hard]</strong> (or, equivalently, for <strong>[hard,2]</strong>), because otherwise it would be ambiguous which of the two former should apply in two-player hard mode.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>Cuyo knows that <strong>easy</strong> and <strong>hard</strong> exclude each other. Consequently, it is unnecessary (and indeed prohibited) to give an <strong>[easy,hard]</strong> definition, even if both <strong>[easy]</strong> and <strong>[hard]</strong> are given. The same holds for <strong>1</strong> and <strong>2</strong>, and for level tracks.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>Furthermore, cuyo knows that <strong>1</strong> and <strong>2</strong> are exhaustive: There is no mode which is neither single-player nor two-player. (The human-versus-AI mode counts as two-player as far as cual is concerned.) Therefore, if there are definitions for both, it is unnecessary, (and again illegal) also to define a version without any of both. For example, if <strong>[1,de]</strong> and <strong>[2,de]</strong> are given, <strong>[de]</strong> must be omitted. Alternatively, you could of course give <strong>[1,de]</strong> and <strong>[de]</strong> or <strong>[de]</strong> and <strong>[de,2]</strong>. The level track specifiers are exhaustive as well.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUSIENESS</h2>
        <div class="sectioncontent">
<p>(No, not Business ;-)</p><p>Busieness is a concept to make it easier to implement simple animated sequences which are triggered by certain events. Each code fragment has an internal state which tells if it is busy.</p>
<dl class='dl-vertical'>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>Normal statements like assignments are never busy.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>A chain of commands separated by "," is busy as long as not all of the commands have been executed.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p><em>code1</em> ; <em>code2</em> is busy as long as at least one of <em>code1</em> and <em>code2</em> are busy.</p>
  </dd>

</dl>
<p>Here's an example of how to use busieness for an animation which appears at random intervals:</p>
<pre>
  <strong>switch {</strong>
</pre>

<pre>
    1:100 =&gt; {B*, C*, D*, E*};
</pre>

<pre>
    -&gt; A*;
</pre>

<pre>
  };
</pre>
<p>This code fragment normally draws the icon at position A (0). But in each step, with a probability of 1/100, an animation sequence consisting of icons B, C, D and E is started. With a normal arrow ("-&gt;") after the "1:100", after the step in which B has been drawn, the probability would be 99/100 that A is drawn again. But with the double arrow, the switch statement won't switch back to A until the animation has terminated.</p><p>(Btw: It doesn't matter if there's a "-&gt;" or a "=&gt;" before the "A*"; A* isn't busy anyway.)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THE GLOBAL BLOB</h2>
        <div class="sectioncontent">
<p>Apart from the normal blobs which you can see on screen, there's one global blob (for the whole game, not one for each player), which, well, isn't really a blob, but behaves a bit like it. It has its own set of variables, and it can have a program which is run once every step. To define such a global program, use <strong>global=</strong><em>code</em>. However, the global variables do exist even if you don't define global code. See section <strong>VARIABLES AND CONSTANTS</strong> on how to access them. Note that the global blob is always executed before any of the normal blobs.</p><p>There are also semiglobal blobs. There is one for each player. These are programmed with <strong>semiglobal=</strong><em>code</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EVENT HANDLERS</h2>
        <div class="sectioncontent">
<p>The following events exist:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>init</strong></p>
  </dt>
  <dd>
    <p>Is called only once, when the blob gets into life, just before the first time its main drawing routine is called.</p>
  </dd>
  <dt>
    <p><strong>turn</strong></p>
  </dt>
  <dd>
    <p>Is called for falling blobs each time the user presses the turn key.</p>
  </dd>
  <dt>
    <p><strong>land</strong></p>
  </dt>
  <dd>
    <p>Is called when the steered blob lands.</p>
  </dd>
  <dt>
    <p><strong>changeside</strong></p>
  </dt>
  <dd>
    <p>Is called when a blob moves from one player to the other, just after the blob has arrived at the new player.</p>
  </dd>
  <dt>
    <p><strong>connect</strong></p>
  </dt>
  <dd>
    <p>Is called when the connection of blobs is recalculated.</p>
  </dd>
  <dt>
    <p><strong>row_up</strong></p>
  </dt>
  <dd>
    <p>Is called when a player gets a row from the other side. Is only called for the semiglobal blob, though.</p>
  </dd>
  <dt>
    <p><strong>row_down</strong></p>
  </dt>
  <dd>
    <p>Is called when a player gives a row to the other side. Is only called for the semiglobal blob, though.</p>
  </dd>
  <dt>
    <p><strong>keyleft, keyright, keyturn, keyfall</strong></p>
  </dt>
  <dd>
    <p>Are called when the player presses the left, right, turn or fall key. Are only called for the steered falling blobs and the semiglobal blob, though.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THE LIFE OF A BLOB</h2>
        <div class="sectioncontent">
<p>Normal blobs come into life at the beginning of the game, or they fall into life: either as colored blobs, steered by the user, or as grey blobs. When a blob moves (by gravitiy or when rows go from one player to another), it takes its variables with it. When a blob explodes, it does not stop existing. Rather, it transforms into an empty blob. That's important for the variables: The empty blob still has all the variables set to the values they had before; only its kind is different. Empty blobs are everywhere where there's no other blob. (However, the falling blobs steered by the user are in some sense "above" everything else; there are empty blobs beneath them.)</p><p>The life of empty blobs is different from the one of normal blobs. Empty blobs are not affected by gravity, and they often start or stop existing. For example, when a single grey blob is falling down, the empty blob below it stops existing when the grey blob arrives and a new empty blob starts existing when the grey blob moves on. There is only one situation in which empty blobs move: When a row moves from one player to the other, and everything moves up resp. down, the empty blobs move, too.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">STARTDIST</h2>
        <div class="sectioncontent">
<p>The format of the startdist field is rather complicated. On the plus side, this means that many things can be done with little effort. We first describe the single-character format, which, at the time of this writing, has sufficed for all needs. After that, we describe the general format as an extension.</p><p>Every line of the startdist describes one row of blobs in the level's initial state. The lines are aligned to the bottom and the topmost lines come first (normal reading order). Each line must contain exactly 10 or exactly 20 characters. In a line of length 20 the first 10 characters describe the left player, the second 10 characters describe the right player. A line of length 10 describes both players. Hence, each character describes one blob. The semantics are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>.</strong></p>
  </dt>
  <dd>
    <p>An empty blop.</p>
  </dd>
  <dt>
    <p><strong>+, -, *</strong></p>
  </dt>
  <dd>
    <p>A blop chosen at random according to <strong>colourprob</strong>, respectively <strong>greyprob</strong>, respectively <strong>goalprob</strong>. The value of <strong>nogreyprob</strong> has no influence.</p>
  </dd>
  <dt>
    <p><strong>0..9, A..Z, a..z</strong></p>
  </dt>
  <dd>
    <p>These characters denote a specific kind. If the character matches the <strong>distkey</strong> of some kinds, the first of these is chosen. More generally, these characters are ordered such that <strong>"9"</strong> comes before <strong>"A"</strong> and <strong>"Z"</strong> comes before <strong>"a"</strong>. In this order, the maximal <strong>distkey</strong>, which does not come after the character, specifies the blob's <strong>kind</strong>. The difference between the character and the <strong>distkey</strong> then specifies the blob's <strong>version</strong>.</p><p>Example 1: In the special case, where the character exactly matches a <strong>distkey</strong>, <strong>version</strong> is set to 0.</p><p>Example 2: Suppose kind <strong>apple</strong> has <strong>distkey = "A"</strong>, kind <strong>orange</strong> has <strong>distkey = "O"</strong> and no further <strong>distkey</strong>s exist. Then the character <strong>"C"</strong> denotes an apple with <strong>version=2</strong>, the character <strong>"N"</strong> denotes an apple with <strong>version=13</strong>, the character <strong>"O"</strong> denotes an orange with <strong>version=0</strong>, the character <strong>"S"</strong> denotes an orange with <strong>version=4</strong>, the character <strong>"a"</strong> denotes an orange with <strong>version=12</strong>, and the character <strong>"8"</strong> does not denote anything (and hence is illegal).</p>
  </dd>

</dl>
<p>In this way, startdist can reference 62 kind/version combinations directly (and more at random). Because this might at some time not be enough, the multichar extension has been introduced. In this case, each blob is described by more than one character. However, the number of characters per blob must be the same for all keys. Hence, the lengths of <strong>startdist</strong> lines then must be this number multiplied by 10 or by 20. Every multicharacter combination starting with <strong>"."</strong>, <strong>"+"</strong>, <strong>"-"</strong>, or <strong>"*"</strong> is treated as the corresponding character in single-character format. All other character combinations are treated as numbers in base 62 representation. Here, <strong>"A"</strong> to <strong>"Z"</strong> are digits with decimal value 10 to 35, and <strong>"a"</strong> to <strong>"z"</strong> are digits with decimal value 36 to 61. Leading spaces are allowed instead of zeroes (however, the all-space string is forbidden). The maximal <strong>distkey</strong> which (as a number) is not larger than the number given in <strong>startdist</strong>, specifies the blob's <strong>kind</strong>. The difference between the <strong>startdist</strong> number and the <strong>distkey</strong> then specifies the blob's <strong>version</strong>. In the case of multichar <strong>distkey</strong>s, the default for <strong>distkey</strong>s of kinds declared by <strong>startpic=</strong> is 10 in decimal.</p><p>For blops whose kinds are chosen at random (i.e. characters <strong>"+"</strong>, <strong>"-"</strong>, <strong>"*"</strong> in single-character <strong>startdist</strong>s), cuyo tries to make these as different as possible. That means, by a certain heuristic, cuyo minimizes the number of neighbouring blobs of the same kind. "Neighbouring", of course, refers to the <strong>neighbours</strong> entry. <strong>inhibit</strong> and the <strong>calculate_size</strong> bit of <strong>behaviour</strong> have no effect (these are mutable during the lifetime of blobs, while at the time of <strong>startdist</strong> processing, no blob's lifetime has started yet). So the only way to influence the unneighbouring (if you really wish to do so), is by setting <strong>neighbours</strong> appropriately. (Of course, this possibility is even more limited, when you intend to set the <strong>calculate_size</strong> bit during the blob's lifetime.)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">WHERE DO I PUT THE CUAL CODE?</h2>
        <div class="sectioncontent">
<p>Cual procedures and variables can be defined in different sections of the .ld files:</p>
<dl class='dl-vertical'>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>Outside of everything; that code is accessible from every level coming after that definition.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>In the section of a level.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>In the section of a kind.</p>
  </dd>

</dl>
<p>This basically does what you expect. However, there's one thing you might want to know: Even if you define a variable inside a kind, <em>every</em> blob in that level will have that variable. The only effect of defining the variable in the section of a kind is that this kind is the only one which can access it.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AMPERSAND-CALL</h2>
        <div class="sectioncontent">
<p>To explain a bit what calling a procecure with an & means, here two examples:</p><p><em>Example 1:</em></p><p>&lt;&lt;</p><p>myblob = {</p>
<pre>
  ...
</pre>

<pre>
  switch {
</pre>

<pre>
    myvar -&gt; { 0A*; 1; A,B,C,D; *; 2A*};
</pre>

<pre>
          -&gt; { 0B*; 1; A,B,C,D; *; 2B*};
</pre>

<pre>
  };
</pre>
<p>};</p><p>&gt;&gt;</p><p><em>Example 2:</em></p><p>&lt;&lt;</p><p>anim = {1; A,B,C,D; *};</p><p>myblob = {</p>
<pre>
  ...
</pre>

<pre>
  switch {
</pre>

<pre>
    myvar -&gt; { 0A*; &anim; 2A*};
</pre>

<pre>
          -&gt; { 0B*; &anim; 2B*};
</pre>

<pre>
  };
</pre>
<p>};</p><p>&gt;&gt;</p><p>The difference between these examples is what happens when myvar changes. In example 1, the animation "A, B, C, D" will restart at the beginning (because the two animations are different ones); in example 2, the "same" animation is used in both cases, so the animation will simply continue. (Removing the ampersands from example 2 will turn the behaviour to the one of example 1.)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THE AI UTILITY FUNCTION</h2>
        <div class="sectioncontent">
<p>When deciding how to place the steered falling blobs, the AI player tries to maximize a certain utility function. Its value is the sum of the values for both steered falling blobs plus <strong>aiu_monochromic_vertical</strong> in case both blobs have the same color and they get placed vertically. The value for a single blob is the sum of the following:</p>
<dl class='dl-vertical'>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p>For each new neighbour of blob, the neighbour utility.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p><strong>aiu_two_above</strong>, if the blob is two above a blob of same kind.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p><strong>aiu_height*20/</strong>(the blob's <strong>y</strong> coordinate).</p>
  </dd>

</dl>
<p>The neighbour utility for a single new blob and a single one of its new neighbours is the sum of the following:</p>
<dl class='dl-vertical'>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p><strong>aiu_color</strong>, if the neighbour has the same kind as the blob.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p><strong>aiu_grass</strong>, if the neighbour fulfills <strong>behaviour.goalblob</strong>.</p>
  </dd>
  <dt>
    <p>&ndash;</p>
  </dt>
  <dd>
    <p><strong>aiu_grey</strong>, if the neighbour fulfills <strong>behaviour.explodes_on_explosion</strong>.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO cual&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man6/cuyo.6.html"><strong>cuyo</strong>(6)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Probably a lot. The following are just a few known ones:</p><p>There are several problems with busieness and that stuff. There are several situations in which Cual doesn't behave in the way I would like, and in other situations I don't know how Cual should behave.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="csmash.6.html"><span aria-hidden="true">&larr;</span> csmash.6: A table tennis simulation game</a></li>
   <li class="next"><a href="cube2.6.html">cube2.6: A 3d first-person shooter engine <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
