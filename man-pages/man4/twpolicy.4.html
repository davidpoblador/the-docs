<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>twpolicy: Tripwire policy file reference</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Tripwire policy file reference">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="twpolicy (4) manual">
  <meta name="twitter:description" content="Tripwire policy file reference">
  <meta name="twitter:image" content="https://www.carta.tech/images/tripwire-twpolicy-4.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man4/twpolicy.4.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="twpolicy (4) manual" />
  <meta property="og:description" content="Tripwire policy file reference" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/tripwire-twpolicy-4.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">twpolicy<small> (4)</small></h1>
        <p class="lead">Tripwire policy file reference</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man4/">
      <span itemprop="name">Special files</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man4/twpolicy.4.html">
      <span itemprop="name">twpolicy: Tripwire policy file reference</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/tripwire/">
      <span itemprop="name">tripwire</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man4/twpolicy.4.html">
      <span itemprop="name">twpolicy: Tripwire policy file reference</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The policy file describes system objects to be monitored by <em>Tripwire</em>, and specifies what properties for each object should be collected and stored in the database file.  Each object in the policy file is associated with a property mask, which describes what changes to the file or directory <em>Tripwire</em> should monitor, and which ones can safely be ignored.  By customizing the various aspects of the policy file, the system administrator can very closely control how <em>Tripwire</em> checks the integrity of any system.</p><p>During installation, an encoded and signed policy file (<em>tw.pol</em>) will be created in the <em>/etc/tripwire</em> directory, and a plain text copy of this policy file (<em>twpol.txt</em>) will be generated in the same directory.  An additional text file (<em>policyguide.txt</em>) illustrates all of the features of the policy language.  Both of the text files are heavily commented and can be used as a reference during policy file creation.</p><p>A new policy file is first created using the <strong>twadmin&nbsp;--create-polfile</strong> command.  With this command, the user can designate an existing plain text file as the current policy file.  Using the current site key and passphrase, the new configuration file is encoded, signed and saved.</p><p>Once the initial policy file has been generated, any changes should be made with the <strong>tripwire&nbsp;--update-policy</strong> command, rather than by simply overwriting the policy file with the <strong>twadmin&nbsp;--create-polfile</strong> command.  This is an important a new policy file is created, the <em>Tripwire</em> database must be re-initialized.  If an intruder has modified files since the last integrity check, these changes will not be detected, and will be included as part of the new "baseline" database.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMPONENTS OF THE POLICY FILE</h2>
        <div class="sectioncontent">
<p>The basic components of policy files are comments, rules, directives, and variables.  Each of these components is described in greater detail below.</p><h3>Comments</h3>
<p>In a policy file, any text following a '#', up to the next line break, is considered a comment.  Example:</p>
<pre>
# This is a comment.
/bin  -&gt;  $(ReadOnly);  # A comment can go here, too.
</pre>

<h3>Rules</h3>
<p>Policy rules determine whether and to what extent <em>Tripwire</em> will check particular files and directories.  There are two kinds of policy rules recognized by <em>Tripwire</em>:</p><p>1) Normal rules define which properties of a particular file or directory tree <em>Tripwire</em> scans.</p><p>2) Stop points tell <em>Tripwire</em> not to scan a particular file or directory.</p>
<h3>Normal Rules</h3>
<p>The format for a normal rule is:</p><p><em>object_name</em>    -&gt;    <em>property_mask</em>;</p><p>where the <em>object_name</em> is the fully qualified pathname for a directory or file, and <em>property_mask</em> specifies what properties of an object to examine or ignore. The '-&gt;' token separates the pathname and the property mask. Whitespace must separate the object name and '-&gt;' token. A semicolon must terminate the rule.  If the pathname specified is a directory, the directory and all of its descendants will be scanned with the indicated property mask.  If the pathname refers to an individual file, only that file will be scanned with the specified property mask.  Examples:</p><p># Defines Tripwire behavior for entire /bin directory tree. /bin   -&gt;   $(ReadOnly);</p><p># Defines Tripwire behavior for a single file.  In this case, # Tripwire watches for all properties of hostname.hme0. /etc/hostname.hme0    -&gt;    $(IgnoreNone) -ar;</p><p># Scan the entire /etc directory tree using mask1, except the # file /etc/passwd, which should be scanned using mask2. /etc        -&gt;  $(mask1); /etc/passwd -&gt;  $(mask2);</p><p>Only one rule may be associated with any given object.  If any object has more than one rule in a policy file, <em>Tripwire</em> will print an error message and exit without scanning any files.  For example:</p><p># This is an example of an illegal construct. /usr/bin   -&gt;   $(mask3); /usr/bin   -&gt;   $(mask4);</p>
<h3>Object Names</h3>
<p>In this document, policy file objects are fully qualified pathnames of files and directories.  Environment variables are not allowed for security reasons.  Examples:</p><p>/etc         # valid object name. /etc/passwd  # valid object name. $HOME        # not valid.</p>
<h3>Property Masks</h3>
<p>Property masks designate which <em>Tripwire</em> properties of a given object should be examined.  A property mask consists of a series of single-character symbols, each of which may be preceded by an optional plus or minus sign.  Each character symbol stands for a particular <em>Tripwire</em> property to be examined during integrity checking.  If the character is preceded by a plus, checking is done for that property; if preceded by a minus, checking is not done for that property.  For example:</p><p>\+p          # compare permissions. -p          # ignore permissions.</p><p>Each rule in the policy file must have a property mask.  Examples:</p><p>/etc        -&gt;    $(IgnoreAll);     #valid property mask. /etc        -&gt;    +p-p;             #valid property mask. /etc        -&gt;    ;                 #invalid property mask.</p><p>Characters in a property mask without a preceding plus or minus sign are assumed to be plus.  If a property is not specified in the property mask, it is ignored, which is equivalent to turning it off with the minus sign.  Examples:</p><p># Examine permissions and link count. # All three of the following are equivalent. +p+n pn pn-g</p><p>Characters used in property masks, with descriptions:</p><p>-     Ignore the following properties \+     Record and check the following properties a     Access timestamp b     Number of blocks allocated c     Inode timestamp (create/modify) d     ID of device on which inode resides g     File owner's group ID i     Inode number l     File is increasing in size (a "growing file") m     Modification timestamp n     Number of links (inode reference count) p     Permissions and file mode bits s     File size t     File type u     File owner's user ID C     CRC-32 hash value H     Haval hash value M     MD5 hash value S     SHA hash value</p>
<h3>Stop Points</h3>
<p>Stop points are used to specify specific files or directories that <em>Tripwire</em> should not scan.  The syntax for stop points is:</p>
<pre>
!  <em>object_name</em>  ;
</pre>
<p>For example: !/etc/init.d; # The directory /etc/init.d will not be scanned.</p><p>/etc   -&gt;   $(ReadOnly); !/etc/rc.d; !/etc/mnttab; # Scan all of /etc, but do not scan two particular # files in the /etc hierarchy.</p>
<h3>Rule Attributes</h3>
<p>Rule attributes work with normal rules to modify their behavior or provide additional information.  Multiple attributes can be assigned to each rule.  Rule attributes are not case-sensitive. Rule attributes may be applied to a single rule using the following syntax:</p><p><em>object_name</em> -&gt; <em>property_mask</em> (<em>rule attribute</em> = <em>value</em>); For example: /usr/lib -&gt; $(ReadOnly) (emailto = admin@foo.com, severity = 80); #This rule will notify the admin if any violations of the #rule occur and designate the severity as 80.</p><p>Rule attributes can also be specified for a group of rules, using the format:</p><p>(<em>attribute list</em>)</p><p>{ <em>rule list</em>; } For example: (emailto = admin@foo.com, severity = 80) {</p>
<pre>
     /usr/lib  -&gt;  $(ReadOnly);
</pre>
<p>} is equivalent to the attribute example above.</p><p>The following four rule attributes are supported by <em>Tripwire</em>:</p>
<dl class='dl-vertical'>
  <dt>
    rulename
  </dt>
  <dd>
    <p>The rulename attribute is used to associate a rule or set of rules with a specific name.  In a report file, this name will be associated with violations to the specified rule.  This feature is useful if you want to track certain objects within a large <em>Tripwire</em> database.  For instance, if you associate the rule name "watchme" with important files, you can sort through the <em>Tripwire</em> report using "watchme" as a sorting key.</p><p>Example: /etc -&gt; +ug (rulename=watchme);</p>
  </dd>
  <dt>
    emailto
  </dt>
  <dd>
    <p>The emailto attribute associates one or more email addresses with a rule or group of rules.  When an integrity check is run with the <strong>--email-report</strong> option and a rule is violated, a report of that violation will be sent to the specified email address(es), using the report format specified by the EMAILREPORTLEVEL variable in the configuration file.</p><p>Example: /etc -&gt; +ug (emailto=admin@domain.com);</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>To specify multiple email addresses, include them as a quoted, semicolon-delimited list. /etc -&gt; +ug (emailto="admin@foo.com;admin2@foo.com");</p>
  </dd>
  <dt>
    severity
  </dt>
  <dd>
    <p>The severity attribute associates a numeric severity level with a rule.  When <em>Tripwire</em> is run in Integrity Checking mode, it is possible to specify that only rules exceeding a certain severity level are used.  The default severity level is 0, and values can range from 0 to 1,000,000.</p><p>Example: /etc -&gt; +ug (severity=50);</p>
  </dd>
  <dt>
    recurse
  </dt>
  <dd>
    <p>The recurse attribute specifies how a rule will scan directories. Valid values for recurse are <em>true</em>, <em>false</em>, or a number from -1 to 1,000,000. If recurse is set to <em>true</em> (or -1), tripwire will recursively scan the entire contents of the directory (both files and subdirectories). When recurse is set to <em>false</em> (or&nbsp;0), and the rule refers to a directory, <em>Tripwire</em> will scan the inode of the directory but none of the files or subdirectories contained therein.  For positive recurse value <em>n</em>, the rule will monitor all objects up to <em>n</em> levels below the start point. Stop points within the recursed directory still apply, and will prevent the specified file or directory from being scanned.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>When a rule refers to a file, specifying the recurse attribute has no will be scanned no matter what value is given for recurse. The default value for recurse is <em>true</em>.</p><p>Example: /etc -&gt; +ug (recurse=2);</p>
  </dd>

</dl>

<h3>Directives</h3>
<p><em>Tripwire</em> supports a small number of directives that allow conditional interpretation of the policy file and certain diagnostic and debugging operations.  The primary purpose of directives is to support sharing of a policy file among multiple machines.  Directives use the following syntax:</p>
<pre>
@@  <em>directive_name</em>  [<em>arguments</em>]
</pre>
<p>Where the directive name is one of the directives listed below:</p><p>@@section  # Designates a section of the policy file.</p><p>@@ifhost   # Allow conditional interpretation @@else     # of the policy file. @@endif</p><p>@@print    # Print a message to standard output. @@error    # Print a message to standard output and then exit.</p><p>@@end      # Marks the logical end-of-file.</p><p>The @@section directive is used to designate sections of the policy file that are OS-specific.  With <em>Tripwire 2.4</em>, valid arguments for the @@section directive are FS and GLOBAL. If no @@section directive is specified, FS will be assumed. If the argument to the @@section directive is either NTFS or NTREG (which have meaning only on Windows NT systems), <em>Tripwire</em> will skip all policy file text down to the next valid @@section directive.  Any other argument will cause an error.</p><p>The @@ifhost, @@else, and @@endif directives are used to allow conditional interpretation of the policy file. With the @@ifhost directive, multiple hostnames can be expressed as arguments, but they must be separated by an '||', interpreted as the logical 'OR'.  This example illustrates how one might employ directives to use one policy file with multiple hosts.</p><p>@@ifhost spock || kirk</p>
<pre>
   /bin   -&gt;   $(ReadOnly);
</pre>
<p>@@endif</p><p>@@ifhost chekov || uhura</p>
<pre>
   /usr/bin   -&gt;   +pinug;
</pre>
<p>@@else</p>
<pre>
   /usr/bin   -&gt;   +pinugsmC;
</pre>
<p>@@endif</p><p>The @@print and @@error directives are intended for debugging and remote diagnostics.  The syntax for these commands is:</p>
<pre>
@@print  "<em>string</em>"
@@error  "<em>string</em>"
</pre>
<p>The @@print directive prints <em>string</em> to <em>stdout</em>, while the @@error directive prints <em>string</em> to <em>stdout</em> and causes the calling program to exit with a non-zero status.</p><p>The @@end directive marks the end of the policy file.  Any text appearing after this directive will be ignored by <em>Tripwire</em>.</p>
<h3>Variables</h3>
<p>For user convenience, <em>Tripwire</em>'s policy file supports variables for string substitution.  Variables can be defined anywhere between rules.  The syntax for variable definition is:</p>
<pre>
<em>variable</em>  =  <em>value</em>;
</pre>
<p>Variable substitution is legal anywhere that a string could appear. The syntax for variable substitution is:</p>
<pre>
$(  <em>variable</em>  )
</pre>
<p>Examples of variable definition and variable substitution on the left, right, and both sides of rules.  Note that variable names are case sensitive.</p><p>param1 = +SMCH;         	# Set variable param1. dir1   = /etc/inet;     	# Set variable dir1. DIR1   = /etc/init.d;   	# Variables are case sensitive. $(dir1)   -&gt; +tbamc;    	# Left hand substitution. /etc/inet -&gt; $(param1); 	# Right hand substitution. $(DIR1)   -&gt; $(param1); 	# Double substitution.</p><p>A number of variables are predefined by <em>Tripwire</em> and may not be changed.  These variables represent different ways that files can change, and can be used on the right side of rules to design a policy file quickly.</p>
<dl class='dl-vertical'>
  <dt>
    ReadOnly
  </dt>
  <dd>
    <p>ReadOnly is good for files that are widely available but are intended to be read-only.</p><p>Value: \+pinugtsdbmCM-rlacSH</p>
  </dd>
  <dt>
    Dynamic
  </dt>
  <dd>
    <p>Dynamic is good for monitoring user directories and files that tend to be dynamic in behavior.</p><p>Value: +pinugtd-srlbamcCMSH</p>
  </dd>
  <dt>
    Growing
  </dt>
  <dd>
    <p>The Growing variable is intended for files that should only get larger.</p><p>Value: \+pinugtdl-srbamcCMSH</p>
  </dd>
  <dt>
    Device
  </dt>
  <dd>
    <p>Device is good for devices or other files that <em>Tripwire</em> should not attempt to open.</p><p>Value: \+pugsdr-intlbamcCMSH</p>
  </dd>
  <dt>
    IgnoreAll
  </dt>
  <dd>
    <p>IgnoreAll tracks a file's presence or absence, but doesn't check any other properties.</p><p>Value: -pinugtsdrlbamcCMSH</p>
  </dd>
  <dt>
    IgnoreNone
  </dt>
  <dd>
    <p>IgnoreNone turns on all properties and provides a convenient starting point for defining your own property masks.  (For&nbsp;example,&nbsp;mymask&nbsp;=&nbsp;$(IgnoreNone)&nbsp;-ar;)</p><p>Value: \+pinugtsdrbamcCMSH-l</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VERSION INFORMATION</h2>
        <div class="sectioncontent">
<p>This man page describes <em>Tripwire 2.4</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Tripwire, Inc.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYING PERMISSIONS</h2>
        <div class="sectioncontent">
<p>Permission is granted to make and distribute verbatim copies of this man page provided the copyright notice and this permission notice are preserved on all copies.</p><p>Permission is granted to copy and distribute modified versions of this man page under the conditions for verbatim copying, provided that the entire resulting derived work is distributed under the terms of a permission notice identical to this one.</p><p>Permission is granted to copy and distribute translations of this man page into another language, under the above conditions for modified versions, except that this permission notice may be stated in a translation approved by Tripwire, Inc.</p><p>Copyright 2000 Tripwire, Inc. Tripwire is a registered trademark of Tripwire, Inc. in the United States and other countries. All rights reserved.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO twpolicy&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/twintro.8.html"><strong>twintro</strong>(8)</a>, <a href="../man8/tripwire.8.html"><strong>tripwire</strong>(8)</a>, <a href="../man8/twadmin.8.html"><strong>twadmin</strong>(8)</a>, <a href="../man8/twprint.8.html"><strong>twprint</strong>(8)</a>, <a href="../man8/siggen.8.html"><strong>siggen</strong>(8)</a>, <a href="../man4/twconfig.4.html"><strong>twconfig</strong>(4)</a>, <a href="../man5/twfiles.5.html"><strong>twfiles</strong>(5)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="twconfig.4.html"><span aria-hidden="true">&larr;</span> twconfig.4: Tripwire configuration file reference</a></li>
   <li class="next"><a href="urandom.4.html">urandom.4: Kernel random number source devices <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
