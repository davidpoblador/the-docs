<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>m-gif: Gif87a and annimated gif89a format (medcon)</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Gif87a and annimated gif89a format (medcon)">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="m-gif (4) manual">
  <meta name="twitter:description" content="Gif87a and annimated gif89a format (medcon)">
  <meta name="twitter:image" content="https://www.carta.tech/images/libmdc2-dev-m-gif-4.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man4/m-gif.4.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="m-gif (4) manual" />
  <meta property="og:description" content="Gif87a and annimated gif89a format (medcon)" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libmdc2-dev-m-gif-4.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">m-gif<small> (4)</small></h1>
        <p class="lead">Gif87a and annimated gif89a format (medcon)</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man4/">
      <span itemprop="name">Special files</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man4/m-gif.4.html">
      <span itemprop="name">m-gif: Gif87a and annimated gif89a format (medcon)</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libmdc2-dev/">
      <span itemprop="name">libmdc2-dev</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man4/m-gif.4.html">
      <span itemprop="name">m-gif: Gif87a and annimated gif89a format (medcon)</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The Graphics Interchange Format from CompuServe allows between 1 and 8 bits of color information with an RGB color palette. The image arrays are compressed with an LZW coding. The extension of the file is `.gif'.</p><p>The basic defines for the format:</p>
<pre>
---------------------------------------------------------------------------

typedef struct {
        char sig[6];                       /* GIF87a or GIF89a         */
        Uint16 screenwidth,screenheight;   /* screen dimensions        */
        Uint8  flags,background,aspect;    /* background color, ratio  */

} MDC_GIFHEADER;

#define MDC_GIF_GH_SIZE 13

typedef struct {
        Uint16 left,top,width,height;       /* image dimensions         */
        Uint8  flags;
} MDC_GIFIMAGEBLOCK;

#define MDC_GIF_IBLK_SIZE  9

typedef struct {                           /* display information      */
        Uint8 blocksize;
        Uint8 flags;
        Uint16 delay;
        Uint8 transparent_colour;
        Uint8 terminator;
} MDC_GIFCONTROLBLOCK;

#define MDC_GIF_CBLK_SIZE 6

typedef struct {                           /* plain text block         */
        Uint8 blocksize;
        Uint16 left,top;
        Uint16 gridwidth,gridheight;
        Uint8 cellwidth,cellheight;
        Uint8 forecolour,backcolour;
} MDC_GIFPLAINTEXT;

#define MDC_GIF_TBLK_SIZE 13

typedef struct {                           /* application block        */
        Uint8 blocksize;
        char applstring[8];
        char authentication[3];
} MDC_GIFAPPLICATION;

#define MDC_GIF_ABLK_SIZE 12

---------------------------------------------------------------------------
</pre>
<p>What does the format support or not support:</p>
<pre>
===========================================================================
Item            Supported                             Not Supported
===========================================================================
Color Map     : max 256 RGB colors                          -
File Endian   : little                                     big
Pixeltypes    : Uint8                                       -
===========================================================================
Scaling factors  : quantify & calibrate factors/image  are NOT supported
---------------------------------------------------------------------------
Dimensions/Image : different dimensions for each image are supported
---------------------------------------------------------------------------
Pixeltypes/Image : different pixeltypes for each image are NOT supported
===========================================================================
</pre>
<p>Because of the flexible nature of the GIF format it could be possible to include scaling factors per image with the  GIF extension blocks, but more about this later. The image is stored from left to right and from top to bottom, unless the images are interlaced.</p><p>First some explanation on the GIF format and its different structures.</p><p>=======================</p><p>The <strong>GIFHEADER</strong> structure</p><p>=======================</p><p>This data structure is the very first information in a GIF file:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>sig[6]</strong></p>
  </dt>
  <dd>
    <p>Holds the signature of the file "GIF87a" or "GIF89a".</p>
  </dd>
  <dt>
    <p><strong>screenwidth, screenheight</strong></p>
  </dt>
  <dd>
    <p>The required screen dimensions in pixels to display the images.</p>
  </dd>
  <dt>
    <p><strong>background</strong></p>
  </dt>
  <dd>
    <p>This represents the background color. It is in fact an index entry in the color palette.</p>
  </dd>
  <dt>
    <p><strong>aspect</strong></p>
  </dt>
  <dd>
    <p>The aspect ratio of the pixels in the image. If this field is not 0 the aspect ratio is: ((gh.aspect + 15) / 64). This entry is always 0 for the GIF87a format.</p>
  </dd>
  <dt>
    <p><strong>flags</strong></p>
  </dt>
  <dd>
    <p>This fields contains a number of bits of information.</p><p>if (gh.flags & 0x0080) is true, a global color map will follow.</p>
<pre>
     The number of color bits: ((gh.flags & 0x0007) + 1)
     The number of colors    : (1 &lt;&lt; ((gh.flags & 0x0007) + 1)
</pre>
<p>if (gh.flags &gt; 0x0008) is true, the color palette is sorted with the most important colors first. This bit is low in GIF87a.</p><p>Finally (1 &lt;&lt; ((gh.flags &gt;&gt; 4) + 1) represents the number of color bits in the original image. This bit is low in GIF87a.</p>
  </dd>

</dl>
<p>After reading the GIFHEADER and any global colormap, there should be a `block separator' which introduce the following block of GIF information. There are three kind of <strong>`block separators'</strong> : a comma, an exclamation mark and a semicolon.</p>
<pre>
                     ','  =&gt;  the next block will be an image
                     '!'  =&gt;  the next block will be an extension
                     ';'  =&gt;  the end of the GIF file
</pre>
<p>The image block after a comma consists of the IMAGEBLOCK structure and the compressed image. The IMAGEBLOCK structure defines the nature of the image and supersedes the global definitions.</p><p>========================</p><p>The <strong>IMAGEBLOCK</strong> extension</p><p>========================</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>left, top</strong></p>
  </dt>
  <dd>
    <p>The upper left coordinate of the image  relative to the screen.</p>
  </dd>
  <dt>
    <p><strong>width, height</strong></p>
  </dt>
  <dd>
    <p>The image dimensions. Width is the number of pixels in a line. Depth represents the number of rows.</p>
  </dd>
  <dt>
    <p><strong>flags</strong></p>
  </dt>
  <dd>
    <p>This field is similar to the global flags in the GIFHEADER structure. Number of colors in the image is ((iblk.flags & 0x0007) + 1).</p><p>If (iblk.flags & 0x0040) is true, the image is <strong>interlaced.</strong> In this case the image is split into four passes instead of sequential lines:</p><p>1st pass: lines 0  8 16 24 ... (+8) 2nd pass: lines 4 12 20 28 ... (+8) 3rd pass: lines 2  6 10 14 ... (+4) 4th pass: lines 1  3  5  7 ... (+2) If (iblk.flags & 0x0080) is true, there is a local color map.</p><p>If (iblk.flags & 0x0020) is true, the color map is sorted.</p>
  </dd>

</dl>
<p>The next byte, after the IMAGEBLOCK should be the <strong>initial image code size</strong> The compressed image consists of <strong>subblocks</strong> of code, of which the first byte gives the amount of code bytes that follow. The last block is a zero-length block. This is how you could skip an image:</p>
<pre>
     FILE *fp;
     int i,n;

     do {
       n = fgetc(fp);                     /* get code size               */
       if (n != EOF) {
         for (i=0; i&lt;n; i++) fgetc(fp);   /* skip the block              */
       }
     }while( (n != 0) && (n != EOF))      /* read the next block, if any */
</pre>
<p>After reading this hole image block, the next byte should be again a `block separator'. If this separator is an exclamation mark, the following block is an extension. The GIF <strong>extension blocks</strong> allow additional features.</p><p>=====================</p><p>The <strong>COMMENT</strong> extension</p><p>=====================</p><p>This is a very simple extension. The byte <strong>0xfe</strong> after a block separator, introduces a comment block. It contains text that does not make part of the image. The comment block is stored as subblocks, ending with a zero-length subblock (or endblock).</p><p>=======================</p><p>The <strong>PLAINTEXT</strong> extension</p><p>=======================</p><p>This is identified by the byte <strong>0x01</strong> after the block separator. The data structure follows this byte.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>left, top</strong></p>
  </dt>
  <dd>
    <p>The items give the starting position of the displayed text.</p>
  </dd>
  <dt>
    <p><strong>gridwidth, gridheight</strong></p>
  </dt>
  <dd>
    <p>Two elements that specify the distance in pixels from one character to the next.</p>
  </dd>
  <dt>
    <p><strong>cellwidth, cellheight</strong></p>
  </dt>
  <dd>
    <p>These fields represent the actual dimensions in pixels of the characters to be displayed.</p>
  </dd>
  <dt>
    <p><strong>forecolor, backcolor</strong></p>
  </dt>
  <dd>
    <p>Color map indices for the foreground and background respectively.</p>
  </dd>

</dl>
<p>The next data after this structure is the text itself, stored in data subblocks just like the comment block is.</p><p>==========================</p><p>The <strong>CONTROLBLOCK</strong> extension</p><p>==========================</p><p>A GIF file with more then one picture also contains a CONTROLBLOCK extension. The byte <strong>0xf9</strong> after the block separator, represents this graphics control block. Following this byte is the data structure.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>blocksize</strong></p>
  </dt>
  <dd>
    <p>This field always contains the value 0x04.</p>
  </dd>
  <dt>
    <p><strong>flags</strong></p>
  </dt>
  <dd>
    <p>if (cb.flags & 0x01) is true, cb.transparent_color will contain a valid transparent color index.</p><p>if (cb.flags & 0x02) is true, the viewing program should wait for user input before displaying the next image. if (cb.delay) is greater than zero, the viewer should at least wait for the number of seconds specified in the delay data field.</p><p>The value ((cb.flags &gt;&gt; 2) & 0x0007) tells the method to remove the present image from the screen:</p>
  </dd>

</dl>

<pre>
          0 = do nothing
          1 = leave it
          2 = restore with the background color
          3 = restore with the previous graphic
</pre>

<dl class='dl-vertical'>
  <dt>
    <p><strong>delay</strong></p>
  </dt>
  <dd>
    <p>The delay in 1/100ths of a second to dispose the present graphic.</p>
  </dd>
  <dt>
    <p><strong>transparant_color</strong></p>
  </dt>
  <dd>
    <p>This fields represents the color index of the transparant color.</p>
  </dd>
  <dt>
    <p><strong>terminator</strong></p>
  </dt>
  <dd>
    <p>Any clues on this?</p>
  </dd>

</dl>
<p>=========================</p><p>The <strong>APPLICATION</strong> extension</p><p>=========================</p><p>The final extension is the APPLICATION block. The application data structure is identified by the byte <strong>0xff</strong> just after the block separator.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>blocksize</strong></p>
  </dt>
  <dd>
    <p>This contains the value 0x0b.</p>
  </dd>
  <dt>
    <p><strong>applstring</strong></p>
  </dt>
  <dd>
    <p>An 8-byte string that specifies the creator software.</p>
  </dd>
  <dt>
    <p><strong>authentication</strong></p>
  </dt>
  <dd>
    <p>This field should contain 3 bytes based on the applstring field to check the integrity of the applstring field.</p>
  </dd>

</dl>
<p>The APPLICATION block extension can be followed by subblocks, ending with a zero-length subblock.</p><p>A special kind of APPLICATION block extension is the <strong>LOOPBLOCK</strong> extension used for annimated GIF files in concern to Netscape Navigator. This block comes between the GIFHEADER and IMAGEBLOCK data structures. It contains the following items:</p>
<pre>
       1. An application block
                ap.blocksize      = 0x0b;
                ap.applstring     = "NETSCAPE";
                ap.authentication = "2.0";
       2. subblock of 3 bytes: 0x03
                0x01,0xe8,0x03
       3. endblock of 0 bytes: 0x00
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>For complete information on the GIF format, we liked reading this book:</p><p><strong>``Supercharged Bitmapped Graphics''</strong></p><p>written by Steve Rimmer</p><p>published by Windcrest/McGraw-Hill</p><p>ISBN: 0-8306-3788-5</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<pre>
/usr/local/xmedcon/source/m-gif.h     The header file.
/usr/local/xmedcon/source/m-gif.c     The source file.
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO m-gif&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/medcon.1.html"><strong>medcon</strong>(1)</a>, <a href="../man1/xmedcon.1.html"><strong>xmedcon</strong>(1)</a>, <a href="../man1/xmedcon-config.1.html"><strong>xmedcon-config</strong>(1)</a></p><p><a href="../man4/m-acr.4.html"><strong>m-acr</strong>(4)</a>, <a href="../man4/m-anlz.4.html"><strong>m-anlz</strong>(4)</a>, <a href="../man4/m-inw.4.html"><strong>m-inw</strong>(4)</a>, <a href="../man4/m-intf.4.html"><strong>m-intf</strong>(4)</a>, <a href="../man4/m-ecat.4.html"><strong>m-ecat</strong>(4)</a></p><p><a href="../man3/medcon.3.html"><strong>medcon</strong>(3)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p><em>(X)MedCon</em> project was originally written by Erik Nolf (eNlf) for the former PET-Centre at Ghent University (Belgium).</p><table class="table table-striped">
<tr>
<th>e-mail:</th>
<th>enlf-at-users.sourceforge.net</th>
<th>www:</th>
<th>http://xmedcon.sourceforge.net</th></tr>
</table>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="m-ecat.4.html"><span aria-hidden="true">&larr;</span> m-ecat.4: Cti ecat 6/7 medical image format (medcon)</a></li>
   <li class="next"><a href="m-intf.4.html">m-intf.4: Interfile 3.3 medical image format (medcon) <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
