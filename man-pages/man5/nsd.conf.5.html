<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>nsd.conf: Nsd configuration file</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Nsd configuration file">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="nsd.conf (5) manual">
  <meta name="twitter:description" content="Nsd configuration file">
  <meta name="twitter:image" content="https://www.carta.tech/images/nsd-nsd.conf-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/nsd.conf.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="nsd.conf (5) manual" />
  <meta property="og:description" content="Nsd configuration file" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/nsd-nsd.conf-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">nsd.conf<small> (5)</small></h1>
        <p class="lead">Nsd configuration file</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/nsd.conf.5.html">
      <span itemprop="name">nsd.conf: Nsd configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/nsd/">
      <span itemprop="name">nsd</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/nsd.conf.5.html">
      <span itemprop="name">nsd.conf: Nsd configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>nsd.conf</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>Nsd.conf</strong> is used to configure <a href="../man8/nsd.8.html"><strong>nsd</strong>(8)</a>. The file format has attributes and values. Some attributes have attributes inside them. The notation is: attribute: value.</p><p>Comments start with # and last to the end of line. Empty lines are ignored as is whitespace at the beginning of a line. Quotes can be used, for names with spaces, eg. "file name.zone".</p><p><strong>Nsd.conf</strong> specifies options for the nsd server, zone files, primaries and secondaries.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>An example of a short nsd.conf file is below.</p><p># Example.com nsd.conf file</p><p># This is a comment.</p>
<dl class='dl-vertical'>
  <dt>
    <p>server:</p>
  </dt>
  <dd>
    <p>server-count: 1 # use this number of cpu cores</p><p>database: ""  # or use "/var/lib/nsd/nsd.db"</p><p>zonelistfile: "/var/lib/nsd/zone.list"</p><p>username: nsd</p><p>logfile: "/var/log/nsd.log"</p><p>pidfile: "/run/nsd/nsd.pid"</p><p>xfrdfile: "/var/lib/nsd/xfrd.state"</p>
  </dd>
  <dt>
    <p>zone:</p>
  </dt>
  <dd>
    <p>name: example.com</p><p>zonefile: /etc/nsd/example.com.zone</p>
  </dd>
  <dt>
    <p>zone:</p>
  </dt>
  <dd>
    <p># this server is master, 192.0.2.1 is the secondary.</p><p>name: masterzone.com</p><p>zonefile: /etc/nsd/masterzone.com.zone</p><p>notify: 192.0.2.1 NOKEY</p><p>provide-xfr: 192.0.2.1 NOKEY</p>
  </dd>
  <dt>
    <p>zone:</p>
  </dt>
  <dd>
    <p># this server is secondary, 192.0.2.2 is master.</p><p>name: secondzone.com</p><p>zonefile: /etc/nsd/secondzone.com.zone</p><p>allow-notify: 192.0.2.2 NOKEY</p><p>request-xfr: 192.0.2.2 NOKEY</p>
  </dd>

</dl>
<p>Then, use kill -HUP to reload changes from master zone files. And use kill -TERM to stop the server.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILE FORMAT</h2>
        <div class="sectioncontent">
<p>There must be whitespace between keywords. Attribute keywords end with a colon ':'. An attribute is followed by its containing attributes, or a value.</p><p>At the top level only <strong>server:</strong> and <strong>key:</strong> and <strong>pattern:</strong> and <strong>zone:</strong> are allowed. These are followed by their attributes or the start of a new <strong>server:</strong> or <strong>key:</strong> or <strong>pattern:</strong> or <strong>zone:</strong> clause. The <strong>zone:</strong> attribute is followed by zone options. The <strong>server:</strong> attribute is followed by global options for the <strong>NSD</strong> server. A <strong>key:</strong> attribute is used to define keys for authentication. The <strong>pattern:</strong> attribute is followed by the zone options for zones that use the pattern.</p><p>Files can be included using the <strong>include:</strong> directive. It can appear anywhere, and takes a single filename as an argument. Processing continues as if the text from the included file was copied into the config file at that point.  If a chroot is used an absolute filename is needed (with the chroot prepended), so that the include can be parsed before and after application of the chroot (and the knowledge of what that chroot is).  You can use '*' to include a wildcard match of files, eg. "foo/nsd.d/*.conf".  Also '?', '{}', '[]', and '~' work, see <a href="../man7/glob.7.html"><strong>glob</strong>(7)</a>.  If no files match the pattern, this is not an error.</p><h3>Server Options</h3>
<p>The global options (if not overridden from the NSD commandline) are taken from the <strong>server:</strong> clause. There may only be one <strong>server:</strong> clause.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>ip-address:</strong> &lt;ip4 or ip6&gt;[@port]</p>
  </dt>
  <dd>
    <p>NSD will bind to the listed ip-address. Can be give multiple times to bind multiple ip-addresses. Optionally, a port number can be given. If none are given NSD listens to the wildcard interface. Same as commandline option <strong>-a.</strong></p>
  </dd>
  <dt>
    <p><strong>interface:</strong> &lt;ip4 or ip6&gt;[@port]</p>
  </dt>
  <dd>
    <p>Same as ip-address (for easy of compatibility with unbound.conf).</p>
  </dd>
  <dt>
    <p><strong>ip-transparent:</strong> &lt;yes or no&gt;</p>
  </dt>
  <dd>
    <p>Allows NSD to bind to non local addresses. This is useful to have NSD listen to IP addresses that are not (yet) added to the network interface, so that it can answer immediately when the address is added. Default is no.</p>
  </dd>
  <dt>
    <p><strong>debug-mode:</strong> &lt;yes or no&gt;</p>
  </dt>
  <dd>
    <p>Turns on debugging mode for nsd, does not fork a daemon process. Default is no. Same as commandline option <strong>-d.</strong></p>
  </dd>
  <dt>
    <p><strong>do-ip4:</strong> &lt;yes or no&gt;</p>
  </dt>
  <dd>
    <p>If yes, NSD listens to IPv4 connections.  Default yes.</p>
  </dd>
  <dt>
    <p><strong>do-ip6:</strong> &lt;yes or no&gt;</p>
  </dt>
  <dd>
    <p>If yes, NSD listens to IPv6 connections.  Default yes.</p>
  </dd>
  <dt>
    <p><strong>database:</strong> &lt;filename&gt;</p>
  </dt>
  <dd>
    <p>By default <em>/var/lib/nsd/nsd.db</em> is used. The specified file is used to store the compiled zone information. Same as commandline option <strong>-f.</strong> If set to "" then no database is used.  This uses less memory but zone updates are not (immediately) spooled to disk.</p>
  </dd>
  <dt>
    <p><strong>zonelistfile:</strong> &lt;filename&gt;</p>
  </dt>
  <dd>
    <p>By default <em>/var/lib/nsd/zone.list</em> is used. The specified file is used to store the dynamically added list of zones.  The list is written to by NSD to add and delete zones. It is a text file with a zone-name and pattern-name on each line. This file is used for the nsd-control addzone and delzone commands.</p>
  </dd>
  <dt>
    <p><strong>identity:</strong> &lt;string&gt;</p>
  </dt>
  <dd>
    <p>Returns the specified identity when asked for CH TXT ID.SERVER. Default is the name as returned by <strong>gethostname</strong>(3). Same as commandline option <strong>-i</strong>.</p>
  </dd>
  <dt>
    <p><strong>nsid:</strong> &lt;string&gt;</p>
  </dt>
  <dd>
    <p>Add the specified nsid to the EDNS section of the answer when queried with an NSID EDNS enabled packet.  As a sequence of hex characters or with ascii_ prefix and then an ascii string.  Same as commandline option <strong>-I</strong>.</p>
  </dd>
  <dt>
    <p><strong>logfile:</strong> &lt;filename&gt;</p>
  </dt>
  <dd>
    <p>Log messages to the logfile. The default is to log to stderr and syslog (with facility LOG_DAEMON). Same as commandline option <strong>-l</strong>.</p>
  </dd>
  <dt>
    <p><strong>server-count:</strong> &lt;number&gt;</p>
  </dt>
  <dd>
    <p>Start this many NSD servers. Default is 1. Same as commandline option <strong>-N</strong>.</p>
  </dd>
  <dt>
    <p><strong>tcp-count:</strong> &lt;number&gt;</p>
  </dt>
  <dd>
    <p>The maximum number of concurrent, active TCP connections by each server. Default is 100. Same as commandline option <strong>-n</strong>.</p>
  </dd>
  <dt>
    <p><strong>tcp-query-count:</strong> &lt;number&gt;</p>
  </dt>
  <dd>
    <p>The maximum number of queries served on a single TCP connection. Default is 0, meaning there is no maximum.</p>
  </dd>
  <dt>
    <p><strong>tcp-timeout:</strong> &lt;number&gt;</p>
  </dt>
  <dd>
    <p>Overrides the default TCP timeout. This also affects zone transfers over TCP.</p>
  </dd>
  <dt>
    <p><strong>ipv4-edns-size:</strong> &lt;number&gt;</p>
  </dt>
  <dd>
    <p>Preferred EDNS buffer size for IPv4.</p>
  </dd>
  <dt>
    <p><strong>ipv6-edns-size:</strong> &lt;number&gt;</p>
  </dt>
  <dd>
    <p>Preferred EDNS buffer size for IPv6.</p>
  </dd>
  <dt>
    <p><strong>pidfile:</strong> &lt;filename&gt;</p>
  </dt>
  <dd>
    <p>Use the pid file instead of the platform specific default, usually <em>/run/nsd/nsd.pid.</em> Same as commandline option <strong>-P</strong>.</p>
  </dd>
  <dt>
    <p><strong>port:</strong> &lt;number&gt;</p>
  </dt>
  <dd>
    <p>Answer queries on the specified port. Default is 53. Same as commandline option <strong>-p</strong>.</p>
  </dd>
  <dt>
    <p><strong>statistics:</strong> &lt;number&gt;</p>
  </dt>
  <dd>
    <p>If not present no statistics are dumped. Statistics are produced every number seconds. Same as commandline option <strong>-s</strong>.</p>
  </dd>
  <dt>
    <p><strong>chroot:</strong> &lt;directory&gt;</p>
  </dt>
  <dd>
    <p>NSD will chroot on startup to the specified directory. Note that if elsewhere in the configuration you specify an absolute pathname to a file inside the chroot, you have to prepend the <strong>chroot</strong> path. That way, you can switch the chroot option on and off without having to modify anything else in the configuration. Set the value to "" (the empty string) to disable the chroot. By default "<em></em>" is used. Same as commandline option <strong>-t</strong>.</p>
  </dd>
  <dt>
    <p><strong>username:</strong> &lt;username&gt;</p>
  </dt>
  <dd>
    <p>After binding the socket, drop user privileges and assume the username. Can be username, id or id.gid. Same as commandline option <strong>-u</strong>.</p>
  </dd>
  <dt>
    <p><strong>zonesdir:</strong> &lt;directory&gt;</p>
  </dt>
  <dd>
    <p>Change the working directory to the specified directory before accessing zone files. Also, NSD will access <strong>database</strong>, <strong>zonelistfile</strong>, <strong>logfile</strong>, <strong>pidfile</strong>, <strong>xfrdfile</strong>, <strong>xfrdir</strong>, <strong>server-key-file</strong>, <strong>server-cert-file</strong>, <strong>control-key-file</strong> and <strong>control-cert-file</strong> relative to this directory. Set the value to "" (the empty string) to disable the change of working directory. By default "<em>/etc/nsd</em>" is used.</p>
  </dd>
  <dt>
    <p><strong>difffile:</strong> &lt;filename&gt;</p>
  </dt>
  <dd>
    <p>Ignored, for compatibility with NSD3 config files.</p>
  </dd>
  <dt>
    <p><strong>xfrdfile:</strong> &lt;filename&gt;</p>
  </dt>
  <dd>
    <p>The soa timeout and zone transfer daemon in NSD will save its state to this file. State is read back after a restart. The state file can be deleted without too much harm, but timestamps of zones will be gone. If it is configured as "", the state file is not used, all slave zones are checked for updates upon startup.  For more details see the section on zone expiry behavior of NSD. Default is <em>/var/lib/nsd/xfrd.state</em>.</p>
  </dd>
  <dt>
    <p><strong>xfrdir:</strong> &lt;directory&gt;</p>
  </dt>
  <dd>
    <p>The zone transfers are stored here before they are processed.  A directory is created here that is removed when NSD exits.  Default is <em>/tmp</em>.</p>
  </dd>
  <dt>
    <p><strong>xfrd-reload-timeout:</strong> &lt;number&gt;</p>
  </dt>
  <dd>
    <p>If this value is -1, xfrd will not trigger a reload after a zone transfer. If positive xfrd will trigger a reload after a zone transfer, then it will wait for the number of seconds before it will trigger a new reload. Setting this value throttles the reloads to once per the number of seconds. The default is 1 second.</p>
  </dd>
  <dt>
    <p><strong>verbosity:</strong> &lt;level&gt;</p>
  </dt>
  <dd>
    <p>This value specifies the verbosity level for (non-debug) logging. Default is 0. 1 gives more information about incoming notifies and zone transfers. 2 lists soft warnings that are encountered.</p>
  </dd>
  <dt>
    <p><strong>hide-version:</strong> &lt;yes or no&gt;</p>
  </dt>
  <dd>
    <p>Prevent NSD from replying with the version string on CHAOS class queries.</p>
  </dd>
  <dt>
    <p><strong>log-time-ascii:</strong> &lt;yes or no&gt;</p>
  </dt>
  <dd>
    <p>Log time in ascii, if "no" then in seconds epoch.  Default is yes. This chooses the format when logging to file.  The printout via syslog has a timestamp formatted by syslog.</p>
  </dd>
  <dt>
    <p><strong>round-robin:</strong> &lt;yes or no&gt;</p>
  </dt>
  <dd>
    <p>Enable round robin rotation of records in the answer.  This changes the order of records in the answer and this may balance load across them. The default is off.</p>
  </dd>
  <dt>
    <p><strong>zonefiles-check:</strong> &lt;yes or no&gt;</p>
  </dt>
  <dd>
    <p>Make NSD check the mtime of zone files on start and sighup.  If you disable it it starts faster (less disk activity in case of a lot of zones). The default is enabled.  The nsd-control reload command reloads zone files regardless of this option.</p>
  </dd>
  <dt>
    <p><strong>zonefiles-write:</strong> &lt;seconds&gt;</p>
  </dt>
  <dd>
    <p>Write changed secondary zones to their zonefile every N seconds.  If the zone (pattern) configuration has "" zonefile, it is not written.  Zones that have received zone transfer updates are written to their zonefile. Default is 0 (disabled) when there is a database, and 3600 (1 hour) when database is "".  The database also commits zone transfer contents. You can configure it away from the default by putting the config statement for zonefiles-write: after the database: statement in the config file.</p>
  </dd>
  <dt>
    <p><strong>rrl-size:</strong> &lt;numbuckets&gt;</p>
  </dt>
  <dd>
    <p>This option gives the size of the hashtable. Default 1000000. More buckets use more memory, and reduce the chance of hash collisions.</p>
  </dd>
  <dt>
    <p><strong>rrl-ratelimit:</strong> &lt;qps&gt;</p>
  </dt>
  <dd>
    <p>The max qps allowed (from one query source). Default 200 qps. If set to 0 then it is disabled (unlimited rate), also set the whilelist-ratelimit to 0 to disable ratelimit processing.  If you set verbosity to 2 the blocked and unblocked subnets are logged.  Blocked queries are blocked and some receive TCP fallback replies.</p>
  </dd>
  <dt>
    <p><strong>rrl-slip:</strong> &lt;numpackets&gt;</p>
  </dt>
  <dd>
    <p>This option controls the number of packets discarded before we send back a SLIP response (a response with "truncated" bit set to one). 0 disables the sending of SLIP packets, 1 means every query will get a SLIP response.</p>
  </dd>
  <dt>
    <p><strong>rrl-ipv4-prefix-length:</strong> &lt;subnet&gt;</p>
  </dt>
  <dd>
    <p>IPv4 prefix length. Addresses are grouped by netblock.</p>
  </dd>
  <dt>
    <p><strong>rrl-ipv6-prefix-length:</strong> &lt;subnet&gt;</p>
  </dt>
  <dd>
    <p>IPv6 prefix length. Addresses are grouped by netblock.</p>
  </dd>
  <dt>
    <p><strong>rrl-whitelist-ratelimit:</strong> &lt;qps&gt;</p>
  </dt>
  <dd>
    <p>The max qps for query sorts for a source, which have been whitelisted. Default 2000 qps. With the rrl-whitelist option you can set specific queries to receive this qps limit instead of the normal limit. With the value 0 the rate is unlimited.</p>
  </dd>

</dl>

<h3>Remote Control</h3>
<p>The <strong>remote-control:</strong> clause is used to set options for using the <a href="../man8/nsd-control.8.html"><strong>nsd-control</strong>(8)</a> tool to give commands to the running NSD server.  It is disabled by default, and listens for localhost by default.  It uses TLS over TCP where the server and client authenticate to each other with self-signed certificates.  The self-signed certificates can be generated with the <em>nsd-control-setup</em> tool.  The key files are read by NSD before the chroot and before dropping user permissions, so they can be outside the chroot and readable by the superuser only.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>control-enable:</strong> &lt;yes or no&gt;</p>
  </dt>
  <dd>
    <p>Enable remote control, default is no.</p>
  </dd>
  <dt>
    <p><strong>control-interface:</strong> &lt;ip4 or ip6&gt;</p>
  </dt>
  <dd>
    <p>NSD will bind to the listed addresses to service control requests (on TCP).  Can be given multiple times to bind multiple ip-addresses. Use 0.0.0.0 and ::0 to service the wildcard interface.  If none are given NSD listens to the localhost 127.0.0.1 and ::1 interfaces for control, if control is enabled with control-enable.</p>
  </dd>
  <dt>
    <p><strong>control-port:</strong> &lt;number&gt;</p>
  </dt>
  <dd>
    <p>The port number for remote control service. 8952 by default.</p>
  </dd>
  <dt>
    <p><strong>server-key-file:</strong> &lt;filename&gt;</p>
  </dt>
  <dd>
    <p>Path to the server private key, by default <em>/etc/nsd/nsd_server.key</em>. This file is generated by the <em>nsd-control-setup</em> utility. This file is used by the nsd server, but not by <em>nsd-control</em>.</p>
  </dd>
  <dt>
    <p><strong>server-cert-file:</strong> &lt;filename&gt;</p>
  </dt>
  <dd>
    <p>Path to the server self signed certificate, by default <em>/etc/nsd/nsd_server.pem</em>. This file is generated by the <em>nsd-control-setup</em> utility. This file is used by the nsd server, and also by <em>nsd-control</em>.</p>
  </dd>
  <dt>
    <p><strong>control-key-file:</strong> &lt;filename&gt;</p>
  </dt>
  <dd>
    <p>Path to the control client private key, by default <em>/etc/nsd/nsd_control.key</em>. This file is generated by the <em>nsd-control-setup</em> utility. This file is used by <em>nsd-control</em>.</p>
  </dd>
  <dt>
    <p><strong>control-cert-file:</strong> &lt;filename&gt;</p>
  </dt>
  <dd>
    <p>Path to the control client certificate, by default <em>/etc/nsd/nsd_control.pem</em>. This certificate has to be signed with the server certificate. This file is generated by the <em>nsd-control-setup</em> utility. This file is used by <em>nsd-control</em>.</p>
  </dd>

</dl>

<h3>Pattern Options</h3>
<p>The <strong>pattern:</strong> clause is used to denote a set of options to apply to some zones. The same zone options as for a zone are allowed.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>name:</strong> &lt;string&gt;</p>
  </dt>
  <dd>
    <p>The name of the pattern.  This is a (case sensitive) string.  The pattern names that start with "_implicit_" are used internally for zones that have no pattern (they are defined in nsd.conf directly).</p>
  </dd>
  <dt>
    <p><strong>include-pattern:</strong> &lt;pattern-name&gt;</p>
  </dt>
  <dd>
    <p>The options from the given pattern are included at this point in this pattern.  The referenced pattern must be defined above this one.</p>
  </dd>
  <dt>
    <p><strong>&lt;zone option&gt;:</strong> &lt;value&gt;</p>
  </dt>
  <dd>
    <p>The zone options such as <strong>zonefile</strong>, <strong>allow-notify</strong>, <strong>request-xfr</strong>, <strong>allow-axfr-fallback</strong>, <strong>notify</strong>, <strong>notify-retry</strong>, <strong>provide-xfr</strong>, and <strong>outgoing-interface</strong> can be given.  They are applied to the patterns and zones that include this pattern.</p>
  </dd>

</dl>

<h3>Zone Options</h3>
<p>For every zone the options need to be specified in one <strong>zone:</strong> clause. The access control list elements can be given multiple times to add multiple servers. These elements need to be added explicitly.</p><p>For zones that are configured in the <em>nsd.conf</em> config file their settings are hardcoded (in an implicit pattern for themselves only) and they cannot be deleted via delzone, but remove them from the config file and repattern.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>name:</strong> &lt;string&gt;</p>
  </dt>
  <dd>
    <p>The name of the zone. This is the domain name of the apex of the zone. May end with a '.' (in FQDN notation). For example "example.com", "sub.example.net.". This attribute must be present in each zone.</p>
  </dd>
  <dt>
    <p><strong>zonefile:</strong> &lt;filename&gt;</p>
  </dt>
  <dd>
    <p>The file containing the zone information. If this attribute is present it is used to read and write the zone contents. If the attribute is absent it prevents writing out of the zone.</p><ul>
<li><p>The string is processed so that one string can be used (in a pattern) for a lot of different zones.  If the label or character does not exist the percent-character is replaced with a period for output (i.e. for the third character in a two letter domain name).</p></li><li><p><strong>%s</strong> is replaced with the zone name.</p></li><li><p><strong>%1</strong> is replaced with the first character of the zone name.</p></li><li><p><strong>%2</strong> is replaced with the second character of the zone name.</p></li><li><p><strong>%3</strong> is replaced with the third character of the zone name.</p></li><li><p><strong>%z</strong> is replaced with the toplevel domain name of the zone.</p></li><li><p><strong>%y</strong> is replaced with the next label under the toplevel domain.</p></li><li><p><strong>%x</strong> is replaced with the next-next label under the toplevel domain.</p></li>
</ul>
  </dd>
  <dt>
    <p><strong>allow-notify:</strong> &lt;ip-spec&gt; &lt;key-name | NOKEY | BLOCKED&gt;</p>
  </dt>
  <dd>
    <p>Access control list. The listed (primary) address is allowed to send notifies to this (secondary) server. Notifies from unlisted or specifically BLOCKED addresses are discarded. If NOKEY is given no TSIG signature is required. BLOCKED supersedes other entries, other entries are scanned for a match in the order of the statements.</p>
  </dd>

</dl>
<p>The ip-spec is either a plain IP address (IPv4 or IPv6), or can be a subnet of the form 1.2.3.4/24, or masked like 1.2.3.4&255.255.255.0 or a range of the form 1.2.3.4-1.2.3.25. A port number can be added using a suffix of @number, for example 1.2.3.4@5300 or 1.2.3.4/24@5300 for port 5300. Note the ip-spec ranges do not use spaces around the /, &, @ and - symbols.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>request-xfr:</strong> [AXFR|UDP] &lt;ip-address&gt; &lt;key-name | NOKEY&gt;</p>
  </dt>
  <dd>
    <p>Access control list. The listed address (the master) is queried for AXFR/IXFR on update. A port number can be added using a suffix of @number, for example 1.2.3.4@5300. The specified key is used during AXFR/IXFR.</p>
  </dd>

</dl>
<p>If the AXFR option is given, the server will not be contacted with IXFR queries but only AXFR requests will be made to the server. This allows an NSD secondary to have a master server that runs NSD. If the AXFR option is left out then both IXFR and AXFR requests are made to the master server.</p><p>If the UDP option is given, the secondary will use UDP to transmit the IXFR requests. You should deploy TSIG when allowing UDP transport, to authenticate notifies and zone transfers. Otherwise, NSD is more vulnerable for Kaminsky-style attacks. If the UDP option is left out then IXFR will be transmitted using TCP.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>allow-axfr-fallback:</strong> &lt;yes or no&gt;</p>
  </dt>
  <dd>
    <p>This option should be accompanied by request-xfr. It (dis)allows NSD (as secondary) to fallback to AXFR if the primary name server does not support IXFR. Default is yes.</p>
  </dd>
  <dt>
    <p><strong>notify:</strong> &lt;ip-address&gt; &lt;key-name | NOKEY&gt;</p>
  </dt>
  <dd>
    <p>Access control list. The listed address (a secondary) is notified of updates to this zone. A port number can be added using a suffix of @number, for example 1.2.3.4@5300. The specified key is used to sign the notify. Only on secondary configurations will NSD be able to detect zone updates (as it gets notified itself, or refreshes after a time).</p>
  </dd>
  <dt>
    <p><strong>notify-retry:</strong> &lt;number&gt;</p>
  </dt>
  <dd>
    <p>This option should be accompanied by notify. It sets the number of retries when sending notifies.</p>
  </dd>
  <dt>
    <p><strong>provide-xfr:</strong> &lt;ip-spec&gt; &lt;key-name | NOKEY | BLOCKED&gt;</p>
  </dt>
  <dd>
    <p>Access control list. The listed address (a secondary) is allowed to request AXFR from this server. Zone data will be provided to the address. The specified key is used during AXFR. For unlisted or BLOCKED addresses no data is provided, requests are discarded. BLOCKED supersedes other entries, other entries are scanned for a match in the order of the statements. NSD provides AXFR for its secondaries, but IXFR is not implemented (IXFR is implemented for request-xfr, but not for provide-xfr).</p>
  </dd>

</dl>
<p>The ip-spec is either a plain IP address (IPv4 or IPv6), or can be a subnet of the form 1.2.3.4/24, or masked like 1.2.3.4&255.255.255.0 or a range of the form 1.2.3.4-1.2.3.25. A port number can be added using a suffix of @number, for example 1.2.3.4@5300 or 1.2.3.4/24@5300 for port 5300. Note the ip-spec ranges do not use spaces around the /, &, @ and - symbols.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>outgoing-interface:</strong> &lt;ip-address&gt;</p>
  </dt>
  <dd>
    <p>Access control list. The listed address is used to request AXFR|IXFR (in case of a secondary) or used to send notifies (in case of a primary).</p>
  </dd>

</dl>
<p>The ip-address is a plain IP address (IPv4 or IPv6). A port number can be added using a suffix of @number, for example 1.2.3.4@5300.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>include-pattern:</strong> &lt;pattern-name&gt;</p>
  </dt>
  <dd>
    <p>The options from the given pattern are included at this point. The referenced pattern must be defined above this zone.</p>
  </dd>
  <dt>
    <p><strong>rrl-whitelist:</strong> &lt;rrltype&gt;</p>
  </dt>
  <dd>
    <p>This option causes queries of this rrltype to be whitelisted, for this zone. They receive the whitelist-ratelimit. You can give multiple lines, each enables a new rrltype to be whitelisted for the zone. Default has none whitelisted. The rrltype is the query classification that the NSD RRL employs to make different types not interfere with one another.  The types are logged in the loglines when a subnet is blocked (in verbosity 2). The RRL classification types are: nxdomain, error, referral, any, rrsig, wildcard, nodata, dnskey, positive, all.</p>
  </dd>

</dl>

<h3>Key Declarations</h3>
<p>The <strong>key:</strong> clause establishes a key for use in access control lists. It has the following attributes.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>name:</strong> &lt;string&gt;</p>
  </dt>
  <dd>
    <p>The key name. Used to refer to this key in the access control list.</p>
  </dd>
  <dt>
    <p><strong>algorithm:</strong> &lt;string&gt;</p>
  </dt>
  <dd>
    <p>Authentication algorithm for this key.</p>
  </dd>
  <dt>
    <p><strong>secret:</strong> &lt;base64 blob&gt;</p>
  </dt>
  <dd>
    <p>The base64 encoded shared secret. It is possible to put the <strong>secret:</strong> declaration (and base64 blob) into a different file, and then to <strong>include:</strong> that file. In this way the key secret and the rest of the configuration file, which may have different security policies, can be split apart.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NSD CONFIGURATION FOR BIND9 HACKERS</h2>
        <div class="sectioncontent">
<p>BIND9 is a name server implementation with its own configuration file format, <a href="../man5/named.conf.5.html"><strong>named.conf</strong>(5)</a>. BIND9 types zones as 'Master' or 'Slave'.</p><h3>Slave zones</h3>
<p>For a slave zone, the master servers are listed. The master servers are queried for zone data, and are listened to for update notifications. In NSD these two properties need to be configured separately, by listing the master address in allow-notify and request-xfr statements.</p><p>In BIND9 you only need to provide allow-notify elements for any extra sources of notifications (i.e. the operators), NSD needs to have allow-notify for both masters and operators. BIND9 allows additional transfer sources, in NSD you list those as request-xfr.</p><p>Here is an example of a slave zone in BIND9 syntax.</p><p># Config file for example.org options {</p><p>dnssec-enable yes;</p><p>};</p><p>key tsig.example.org. {</p><p>algorithm hmac-md5;</p><p>secret "aaaaaabbbbbbccccccdddddd";</p><p>};</p><p>server 162.0.4.49 {</p><p>keys { tsig.example.org. ; };</p><p>};</p><p>zone "example.org" {</p><p>type slave;</p><p>file "secondary/example.org.signed";</p><p>masters { 162.0.4.49; };</p><p>};</p><p>For NSD, DNSSEC is enabled automatically for zones that are signed. The dnssec-enable statement in the options clause is not needed. In NSD keys are associated with an IP address in the access control list statement, therefore the server{} statement is not needed. Below is the same example in an NSD config file.</p><p># Config file for example.org</p><p>key:</p><p>name: tsig.example.org.</p><p>algorithm: hmac-md5</p><p>secret: "aaaaaabbbbbbccccccdddddd"</p><p>zone:</p><p>name: "example.org"</p><p>zonefile: "secondary/example.org.signed"</p><p># the master is allowed to notify and will provide zone data.</p><p>allow-notify: 162.0.4.49 NOKEY</p><p>request-xfr: 162.0.4.49 tsig.example.org.</p><p>Notice that the master is listed twice, once to allow it to send notifies to this slave server and once to tell the slave server where to look for updates zone data. More allow-notify and request-xfr lines can be added to specify more masters.</p><p>It is possible to specify extra allow-notify lines for addresses that are also allowed to send notifications to this slave server.</p>
<h3>Master zones</h3>
<p>For a master zone in BIND9, the slave servers are listed. These slave servers are sent notifications of updated and are allowed to request transfer of the zone data. In NSD these two properties need to be configured separately.</p><p>Here is an example of a master zone in BIND9 syntax.</p><p>zone "example.nl" {</p><p>type master;</p><p>file "example.nl";</p><p>};</p><p>In NSD syntax this becomes:</p><p>zone:</p><p>name: "example.nl"</p><p>zonefile: "example.nl"</p><p># allow anybody to request xfr.</p><p>provide-xfr: 0.0.0.0/0 NOKEY</p><p>provide-xfr: ::0/0 NOKEY</p><p># to list a slave server you would in general give</p><p># provide-xfr: 1.2.3.4 tsig-key.name.</p><p># notify: 1.2.3.4 NOKEY</p>
<h3>Other</h3>
<p>NSD is an authoritative only DNS server. This means that it is meant as a primary or secondary server for zones, providing DNS data to DNS resolvers and caches. BIND9 can function as an authoritative DNS server, the configuration options for that are compared with those for NSD in this section. However, BIND9 can also function as a resolver or cache. The configuration options that BIND9 has for the resolver or caching thus have no equivalents for NSD.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p>/var/lib/nsd/nsd.db</p>
  </dt>
  <dd>
    <p>default <strong>NSD</strong> database</p>
  </dd>
  <dt>
    <p>/etc/nsd/nsd.conf</p>
  </dt>
  <dd>
    <p>default <strong>NSD</strong> configuration file</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO nsd.conf&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/nsd.8.html"><strong>nsd</strong>(8)</a>, <a href="../man8/nsd-checkconf.8.html"><strong>nsd-checkconf</strong>(8)</a>, <a href="../man8/nsd-control.8.html"><strong>nsd-control</strong>(8)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p><strong>NSD</strong> was written by NLnet Labs and RIPE NCC joint team. Please see CREDITS file in the distribution for further details.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p><strong>nsd.conf</strong> is parsed by a primitive parser, error messages may not be to the point.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="nscd-nscd.conf.5.html"><span aria-hidden="true">&larr;</span> nscd.conf.5: Configuration file for name service caching daemon</a></li>
   <li class="next"><a href="nslcd-nslcd.conf.5.html">nslcd.conf.5: Configuration file for ldap nameservice daemon <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
