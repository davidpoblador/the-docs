<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>labrea.conf: Labrea(1) configuration file</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Labrea(1) configuration file">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="labrea.conf (5) manual">
  <meta name="twitter:description" content="Labrea(1) configuration file">
  <meta name="twitter:image" content="https://www.carta.tech/images/labrea-labrea.conf-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/labrea.conf.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="labrea.conf (5) manual" />
  <meta property="og:description" content="Labrea(1) configuration file" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/labrea-labrea.conf-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">labrea.conf<small> (5)</small></h1>
        <p class="lead">Labrea(1) configuration file</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/labrea.conf.5.html">
      <span itemprop="name">labrea.conf: Labrea(1) configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/labrea/">
      <span itemprop="name">labrea</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/labrea.conf.5.html">
      <span itemprop="name">labrea.conf: Labrea(1) configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>nnn.nnn.nnn.nnn [- nnn.nnn.nnn.nnn] EXC</strong></p><p><strong>nnn.nnn.nnn.nnn [- nnn.nnn.nnn.nnn] HAR</strong></p><p><strong>nnn.nnn.nnn.nnn[/nn] IPI</strong></p><p><strong>nnnnn [- nnnnn] POR</strong></p><p><strong>nnnnn [- nnnnn] PMN</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<h3>Generalities</h3>
<p><em>labrea.conf</em> is the configuration file for the <a href="../man1/labrea.1.html"><strong>labrea</strong>(1)</a></strong> program.</p><p>Each line consists of a selector field, followed by an action verb.</p><p>Whitespace is suppressed. Blank lines are ignored, as are lines beginning with "#".</p>
<h3>Selectors</h3>
<p>IPs can be specified as either a single address (e.g. "192.168.0.4") or as a range of addresses (e.g. "192.168.0.1 - 192.168.0.50").</p><p>Ports can be specified as either a single port (e.g. 12345) or as a range of ports (e.g. 1-65535).</p>
<h3>IP Capturing</h3>
<p>When labrea sees an ARP request for an unused IP, it does the following:</p><p>On an IP by IP basis, store a time and an originating IP address:</p>
<dl class='dl-vertical'>
  <dt>
    1.
  </dt>
  <dd>
    <p>For an incoming ARP request, check the current time:</p>
<dl class='dl-vertical'>
  <dt>
    a.
  </dt>
  <dd>
    <p>If currently stored time is 0 or the arp comes from a different address than the one stored, then store the current time and the requesting IP and return.</p>
  </dd>
  <dt>
    b.
  </dt>
  <dd>
    <p>If the stored time is less than "-r" seconds ago, ignore it and return.</p>
  </dd>
  <dt>
    c.
  </dt>
  <dd>
    <p>If currently stored time is more than a minute ago, store 0, return. (Max timeout)</p>
  </dd>
  <dt>
    d.
  </dt>
  <dd>
    <p>Otherwise, grab the IP.</p>
  </dd>

</dl>

  </dd>
  <dt>
    2.
  </dt>
  <dd>
    <p>See an ARP reply, set stored time to 0.</p>
  </dd>

</dl>
<p>When an ARP request for a particular IP goes unanswered for longer than its "rate" setting (default: 3 seconds), labrea crafts an ARP reply that routes all traffic destined for the IP to a "bogus" MAC address.  labrea listens for TCP/IP traffic routed to that MAC address and then responds to any SYN packet (ie incoming connection) with a SYN/ACK packet.</p>
<h3>Explanation of terms</h3>
<p><strong>Excluded IPs:</strong> Are those IPs that labrea should never capture. Note that automatic mechanisms are also used to prevent capturing IPs with an active machine on it. See <a href="../man1/labrea.1.html"><strong>labrea</strong>(1)</a></strong> for more details.</p><p><strong>Hard captured IPs:</strong> The -h --hard-capture option instructs labrea that once it captures an IP address, then it needn't wait for a "-r" timeout the next time around.  These IPs are said to be "hard" captured.</p><p><strong>Hard excluded IPS:</strong> These are IPs that should never be "hard" captured. In other words, each time there is an ARP request for this IP, then labrea will always wait for the timeout -r secs before responding.</p><p><strong>Tarpitting:</strong> On a captured IP, labrea responds to an incoming SYN connection attempt with a SYN/ACK. This causes the remote machine's stack to initiate the Tcp connection and then waste time fruitlessly trying to continue the conversation.</p><p><strong>Persist state capture:</strong> labrea can permanently capture connect attempts by closing the TCP window to force the connection into "persist" state. In this state, the connection never times out, and labrea hangs on to the incoming connection until it is closed from the other end.</p><p>To accomplish this, short packets are sent every so often to say "keep waiting, my Tcp window is still closed". So a maximum b/w control is implemented to limit the total b/w consumption. (see the <strong>-p --max-rate</strong> startup option)</p><p><strong>Auto hard capturing:</strong> This is a startup option that says that unless an IP is excluded or hard-excluded, then mark it as being hard captured. This is normally a risky thing to do and should be used with caution.</p>
<h3>Normal virtual machine behaviour</h3>
<p><strong>Default port behaviour:</strong> Incoming connections on any port will be subject to tarpitting / persist capturing.</p><p>Since all connections are inbound, there should be no incoming SYN/ACKs. Labrea will respond RST to an incoming SYN/ACK unless the startup option <strong>-a --no-resp-synack</strong> disables this behaviour.</p><p><strong>Excluded ports:</strong> Ports that are specifically excluded will not be tarpitted or persist captured.</p><p>Incoming connection attempts on an excluded port will receive a RST.</p>
<h3>Virtual machine behaviour when firewalling:</h3>
<p><strong>Active ports:</strong> When firewalling (i.e. <strong>-f --no-resp-excluded-ports)</strong> is active, then by default only the most widely used ports are active at startup.</p><p>Incoming connections on these active ports will be tarpitted and/or persist captured as usual.</p><p><strong>Excluded ports:</strong> When firewalling is active, incoming connections on excluded ports will not receive a response. The packets will be dropped.</p><p>Among other things, this means that nmap scans take much more time to complete.</p><p><strong>Other ports:</strong> Ports that are neither active nor excluded are <em>passively monitored</em> for incoming SYN activity. At startup, they behave as an excluded port (i.e. packets are dropped).</p><p>However, if there is enough activity on a given port, it will dynamically become active. The threshold is more than 6 SYNs for a given port in an hour. However every 15 minutes, the port's SYN count is reduced by 1 to eliminate noise.</p><p>If the SYN count for a port finally reaches 255, then the port is considered permanently active.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE</h2>
        <div class="sectioncontent">
<p>This section describes the configuration statements and their usage:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>nnn.nnn.nnn.nnn [- nnn.nnn.nnn.nnn] EXC</strong></p>
  </dt>
  <dd>
    <p>Never capture the specified IP addresses. This applies to local IP addresses (i.e. on the local capture netblock) only.</p>
  </dd>
  <dt>
    <p><strong>nnn.nnn.nnn.nnn [- nnn.nnn.nnn.nnn] HAR</strong></p>
  </dt>
  <dd>
    <p>WHen "hard capturing" is in effect ("-h"), then never hard capture the specified IP addresses. (i.e. Always wait for the ARP timeout before responding.) Applies to local IP addresses only.</p>
  </dd>
  <dt>
    <p><strong>nnn.nnn.nnn.nnn[/nn] IPI</strong></p>
  </dt>
  <dd>
    <p>Ignore any packets with source IP address in the specified netblock. labrea will not tarpit or persist capture connections from the specified IP addresses.</p><p>Note that this statement can apply to <em>any</em> IP address.</p><p>Note also that the netblock is specified in <em>CIDR notation</em> (ie nnn.nnn.nnn.nnn/nn) and not as a range of IP addresses.</p>
  </dd>
  <dt>
    <p><strong>nnnnn [- nnnnn] POR</strong></p>
  </dt>
  <dd>
    <p>These ports are excluded. labrea will not tarpit / persist capture incoming connections on these ports. A RST will be returned unless firewalling is active. In that case, the incoming packet will be dropped.</p>
  </dd>
  <dt>
    <p><strong>nnnnn [- nnnnn] PMN</strong></p>
  </dt>
  <dd>
    <p>At startup, mark the indicated ports as being active. Incoming connections to these ports are subject to tarpitting / persist capturing.</p><p>This configuration statement is useful only when firewalling is active. The port becomes immediately active, instead of waiting for enough SYNs to bump the port's SYN count above the activity threshold.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Suppose that the capture subnet is 192.168.10.0/24.</p><p>Exclude 192.168.10.5 through .7 from being captured:</p><ul>
<li><p>192.168.10.5 - 192.168.10.7 EXC</p></li>
</ul><p>"Hard exclude" 192.168.10.100:</p><ul>
<li><p>192.168.10.100 HAR</p></li>
</ul><p>Do not attempt to tarpit / persist capture packets from the class C subnet 10.2.3.x:</p><ul>
<li><p>10.2.3.0/24 IPI</p></li>
</ul><p>Put in some comments:</p><ul>
<li>
<pre>
#
#	This is a comment
#
</pre>
</li>
</ul><p>Do not tarpit / persist capture on ports 21-25:</p><ul>
<li><p>21-25 POR</p></li>
</ul><p>When firewalling, make port 12345 active at startup:</p><ul>
<li><p>12345 PMN</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>/usr/local/etc/labrea.conf</em></p>
  </dt>
  <dd>
    <p>Default configuration file on unix systems</p>
  </dd>
  <dt>
    <p><em>(current directory) LaBrea.cfg</em></p>
  </dt>
  <dd>
    <p>Default configuration file on Windows systems</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO labrea.conf&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/labrea.1.html"><strong>labrea</strong>(1)</a></strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Tom Liston &lt;tliston@hackbusters.net&gt; Bugs: lorgor@users.sourceforge.net or http://labrea.sourceforge.net</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="l2tp-secrets.5.html"><span aria-hidden="true">&larr;</span> l2tp-secrets.5: L2tpd secrets file</a></li>
   <li class="next"><a href="lam-helpfile.5.html">lam-helpfile.5: Lam help message file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
