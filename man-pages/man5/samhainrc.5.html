<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>samhainrc: Samhain(8) configuration file</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Samhain(8) configuration file">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="samhainrc (5) manual">
  <meta name="twitter:description" content="Samhain(8) configuration file">
  <meta name="twitter:image" content="https://www.carta.tech/images/samhain-samhainrc-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/samhainrc.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="samhainrc (5) manual" />
  <meta property="og:description" content="Samhain(8) configuration file" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/samhain-samhainrc-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">samhainrc<small> (5)</small></h1>
        <p class="lead">Samhain(8) configuration file</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/samhainrc.5.html">
      <span itemprop="name">samhainrc: Samhain(8) configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/samhain/">
      <span itemprop="name">samhain</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/samhainrc.5.html">
      <span itemprop="name">samhainrc: Samhain(8) configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">WARNING</h2>
        <div class="sectioncontent">
<p>The information in this man page is not always up to date. The authoritative documentation is the user manual.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The configuration file for <a href="../man8/samhain.8.html"><strong>samhain</strong>(8)</a> is named <em>samhainrc</em> and located in <em>/etc</em> by default.</p><p>It contains several sections, indicated by headings in square brackets. Each section may hold zero or more <strong>key=</strong><em>value</em> pairs. Blank lines and lines starting with '#' are comments. Everything before the first section and after an <em>[EOF]</em> is ignored. The file may be (clear text) signed by PGP/GnuPG, and <strong>samhain</strong> may invoke GnuPG to check the signature if compiled with support for it.</p><p>Conditional inclusion of entries for some host(s) is supported via any number of <strong>@</strong><em>hostname</em><strong>/@</strong><em>end</em> directives. <strong>@</strong><em>hostname</em> and <strong>@</strong><em>end</em> must each be on separate lines. Lines in between will only be read if <em>hostname</em> (which may be a regular expression) matches the local host.</p><p>Likewise, conditional inclusion of entries based on system type is supported via any number of <strong>$</strong><em>sysname:release:machine</em><strong>/$</strong><em>end</em> directives.</p><p><em>sysname:release:machine</em> can be inferred from <em>uname -srm</em> and may be a regular expression.</p><p>Filenames/directories to check may be wildcard patterns.</p><p>Options given on the command line will override those in the configuration file. The recognized sections in the configuration file are as follows:</p><p>Boolean options can be set with any of 1|true|yes or 0|false|no.</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>[ReadOnly]</em></p>
  </dt>
  <dd>
    <p>This section may contain</p><p><strong>file=</strong><em>PATH</em> and</p><p><strong>dir=</strong><em>[depth]PATH</em> entries for files and directories to check. All modifications except access times will be reported for these files. <em>[depth] (use without brackets)</em> is an optional parameter to define a per-directory recursion depth.</p>
  </dd>
  <dt>
    <p><em>[LogFiles]</em></p>
  </dt>
  <dd>
    <p>As above, but modifications of timestamps, file size, and signature will be ignored.</p>
  </dd>
  <dt>
    <p><em>[GrowingLogFiles]</em></p>
  </dt>
  <dd>
    <p>As above, but modifications of file size will only be ignored if the size has <em>increased</em>.</p>
  </dd>
  <dt>
    <p><em>[Attributes]</em></p>
  </dt>
  <dd>
    <p>As above, but only modifications of ownership and access permissions will be checked.</p>
  </dd>
  <dt>
    <p><em>[IgnoreAll]</em></p>
  </dt>
  <dd>
    <p>As above, but report no modifications for these files/directories. Access failures will still be reported.</p>
  </dd>
  <dt>
    <p><em>[IgnoreNone]</em></p>
  </dt>
  <dd>
    <p>As above, but report all modifications for these files/directories, including access time.</p>
  </dd>
  <dt>
    <p><em>[User0]</em></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><em>[User1]</em></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><em>[User2]</em></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><em>[User3]</em></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><em>[User4]</em></p>
  </dt>
  <dd>
    <p>These are reserved for user-defined policies.</p>
  </dd>
  <dt>
    <p><em>[Prelink]</em></p>
  </dt>
  <dd>
    <p>For prelinked executables / libraries or directories holding them.</p>
  </dd>
  <dt>
    <p><em>[Log]</em></p>
  </dt>
  <dd>
    <p>This section defines the filtering rules for logging. It may contain the following entries:</p><p><strong>MailSeverity=</strong><em>val</em> where the threshold value <em>val</em> may be one of <em>debug</em>, <em>info</em>, <em>notice</em>, <em>warn</em>, <em>mark</em>, <em>err</em>, <em>crit</em>, <em>alert</em>, or <em>none</em>. By default, everything equal to and above the threshold will be logged. The specifiers <em>*</em>, <em>!</em>, and <em>=</em> are interpreted as 'all', 'all but', and 'only', respectively (like in the Linux version of <strong>syslogd</strong>(8)). Time stamps have the priority <em>warn</em>, system-level errors have the priority <em>err</em>, and important start-up messages the priority <em>alert</em>. The signature key for the log file will never be logged to syslog or the log file itself. For failures to verify file integrity, error levels are defined in the next section.</p><p><strong>PrintSeverity=</strong><em>val,</em></p><p><strong>LogSeverity=</strong><em>val,</em></p><p><strong>ExportSeverity=</strong><em>val,</em></p><p><strong>ExternalSeverity=</strong><em>val,</em></p><p><strong>PreludeSeverity=</strong><em>val,</em></p><p><strong>DatabaseSeverity=</strong><em>val,</em> and</p><p><strong>SyslogSeverity=</strong><em>val</em> set the thresholds for logging via stdout (or <em>/dev/console</em>), log file, TCP forwarding, calling external programs, and <a href="../man3/syslog.3.html"><strong>syslog</strong>(3)</a>.</p>
  </dd>
  <dt>
    <p><em>[EventSeverity]</em></p>
  </dt>
  <dd>
    <p><strong>SeverityReadOnly=</strong><em>val,</em></p><p><strong>SeverityLogFiles=</strong><em>val,</em></p><p><strong>SeverityGrowingLogs=</strong><em>val,</em></p><p><strong>SeverityIgnoreNone=</strong><em>val,</em></p><p><strong>SeverityIgnoreAll=</strong><em>val,</em></p><p><strong>SeverityPrelink=</strong><em>val,</em></p><p><strong>SeverityUser0=</strong><em>val,</em></p><p><strong>SeverityUser1=</strong><em>val,</em></p><p><strong>SeverityUser2=</strong><em>val,</em></p><p><strong>SeverityUser3=</strong><em>val,</em> and</p><p><strong>SeverityUser4=</strong><em>val</em> define the error levels for failures to verify the integrity of files/directories of the respective types. I.e. if such a file shows unexpected modifications, an error of level <em>val</em> will be generated, and logged to all facilities with a threshold of at least <em>val</em>.</p><p><strong>SeverityFiles=</strong><em>val</em> sets the error level for file access problems, and</p><p><strong>SeverityDirs=</strong><em>val</em> for directory access problems.</p><p><strong>SeverityNames=</strong><em>val</em> sets the error level for obscure file names (e.g. non-printable characters), and for files with invalid UIDs/GIDs.</p>
  </dd>
  <dt>
    <p><em>[External]</em></p>
  </dt>
  <dd>
    <p><strong>OpenCommand=</strong><em>path</em> Start the definition of an external logging program|script.</p><p><strong>SetType=</strong><em>log|srv</em> Type/purpose of program (log for logging).</p><p><strong>SetCommandline=</strong><em>list</em> Command line options.</p><p><strong>SetEnviron=</strong><em>KEY=val</em> Environment for external program.</p><p><strong>SetChecksum=</strong><em>val</em> Checksum of the external program (checked before invoking).</p><p><strong>SetCredentials=</strong><em>username</em> User as who the program will run.</p><p><strong>SetFilterNot=</strong><em>list</em> Words not allowed in message.</p><p><strong>SetFilterAnd=</strong><em>list</em> Words required (ALL) in message.</p><p><strong>SetFilterOr=</strong><em>list</em> Words required (at least one) in message.</p><p><strong>SetDeadtime=</strong><em>seconds</em> Time between consecutive calls.</p>
  </dd>
  <dt>
    <p><em>[Utmp]</em></p>
  </dt>
  <dd>
    <p>Configuration for watching login/logout events.</p><p><strong>LoginCheckActive=</strong><em>0|1</em> Switch off/on login/logout reporting.</p><p><strong>LoginCheckInterval=</strong><em>val</em> Interval (seconds) between checks for login/logout events.</p><p><strong>SeverityLogin=</strong><em>val</em></p><p><strong>SeverityLoginMulti=</strong><em>val</em></p><p><strong>SeverityLogout=</strong><em>val</em> Severity levels for logins, multiple logins by same user, and logouts.</p>
  </dd>
  <dt>
    <p><em>[Kernel]</em></p>
  </dt>
  <dd>
    <p>Configuration for detecting kernel rootkits.</p><p><strong>KernelCheckActive=</strong><em>0|1</em> Switch off/on checking of kernel syscalls to detect kernel module rootkits.</p><p><strong>KernelCheckInterval=</strong><em>val</em> Interval (seconds) between checks.</p><p><strong>SeverityKernel=</strong><em>val</em> Severity level for clobbered kernel syscalls.</p><p><strong>KernelCheckIDT=</strong><em>0|1</em> Whether to check the interrrupt descriptor table.</p><p><strong>KernelSystemCall=</strong><em>address</em> The address of system_call (grep system_call System.map). Required after a kernel update.</p><p><strong>KernelProcRoot=</strong><em>address</em> The address of proc_root (grep ' proc_root$' System.map). Required after a kernel update.</p><p><strong>KernelProcRootIops=</strong><em>address</em> The address of proc_root_inode_operations (grep proc_root_inode_operations System.map). Required after a kernel update.</p><p><strong>KernelProcRootLookup=</strong><em>address</em> The address of proc_root_lookup (grep proc_root_lookup System.map). Required after a kernel update.</p>
  </dd>
  <dt>
    <p><em>[SuidCheck]</em></p>
  </dt>
  <dd>
    <p>Settings for finding SUID/SGID files on disk.</p><p><strong>SuidCheckActive=</strong><em>0|1</em> Switch off/on the check.</p><p><strong>SuidCheckExclude=</strong><em>path</em></p>
<pre>
  A directory (and its subdirectories)
  to exclude from the check. Only one directory can be specified this way.
</pre>
<p><strong>SuidCheckSchedule=</strong><em>schedule</em> Crontab-like schedule for checks.</p><p><strong>SeveritySuidCheck=</strong><em>severity</em> Severity for events.</p><p><strong>SuidCheckFps=</strong><em>fps</em> Limit files per seconds for SUID check.</p><p><strong>SuidCheckNosuid=</strong><em>0|1</em> Check filesystems mounted as nosuid. Defaults to not.</p><p><strong>SuidCheckQuarantineFiles=</strong><em>0|1</em> Whether to quarantine files. Defaults to not.</p><p><strong>SuidCheckQuarantineMethod=</strong><em>0|1|2</em> Quarantine method. Delete = 1, remove suid/sgid flags = 1, move to quarantine directory = 2. Defaults to 1 (remove suid/sgid flags).</p>
  </dd>
  <dt>
    <p><em>[Mounts]</em></p>
  </dt>
  <dd>
    <p>Configuration for checking mounts.</p><p><strong>MountCheckActive=</strong><em>0|1</em> Switch off/on this module.</p><p><strong>MountCheckInterval=</strong><em>seconds</em></p>
<pre>
  The interval between checks (default 300).
</pre>
<p><strong>SeverityMountMissing=</strong><em>severity</em> Severity for reports on missing mounts.</p><p><strong>SeverityOptionMissing=</strong><em>severity</em> Severity for reports on missing mount options.</p><p><strong>CheckMount=</strong><em>path</em> [mount_options]</p><p>Mount point to check. Mount options must be given as comma-separated list, separated by a blank from the preceding mount point.</p>
  </dd>
  <dt>
    <p><em>[UserFiles]</em></p>
  </dt>
  <dd>
    <p>Configuration for checking paths relative to user home directories.</p><p><strong>UserFilesActive=</strong><em>0|1</em> Switch off/on this module.</p><p><strong>UserFilesName=</strong><em>filename</em> policy</p><p>Files to check for under each $HOME. Allowed values for 'policy' are: allignore, attributes, logfiles, loggrow, noignore (default), readonly, user0, user1, user2, user3, and user4.</p><p><strong>UserFilesCheckUids=</strong><em>uid_list</em> A list of UIDs where we want to check. The default is all. Ranges (e.g. 100-500) are allowed. If there is an open range (e.g. 1000-), it must be last in the list.</p>
  </dd>
  <dt>
    <p><em>[ProcessCheck]</em></p>
  </dt>
  <dd>
    <p>Settings for finding hidden/fake,required processes on the local host.</p><p><strong>ProcessCheckActive=</strong><em>0|1</em> Switch off/on the check.</p><p><strong>ProcessCheckInterval=</strong><em>seconds</em></p>
<pre>
  The interval between checks (default 300).
</pre>
<p><strong>SeverityProcessCheck=</strong><em>severity</em> Severity for events (default crit).</p><p><strong>ProcessCheckMinPID=</strong><em>pid</em> The minimum PID to check (default 0).</p><p><strong>ProcessCheckMaxPID=</strong><em>pid</em> The maximum PID to check (default 32767).</p><p><strong>ProcessCheckPSPath=</strong><em>path</em> The path to ps (autodetected at compile time).</p><p><strong>ProcessCheckPSArg=</strong><em>argument</em> The argument to ps (autodetected at compile time). Must yield PID in first column.</p><p><strong>ProcessCheckExists=</strong><em>regular_expression</em> Check for existence of a process matching the given regular expression.</p>
  </dd>
  <dt>
    <p><em>[PortCheck]</em></p>
  </dt>
  <dd>
    <p>Settings for checking open ports on the local host.</p><p><strong>PortCheckActive=</strong><em>0|1</em> Switch off/on the check.</p><p><strong>PortCheckInterval=</strong><em>seconds</em></p>
<pre>
  The interval between checks (default 300).
</pre>
<p><strong>PortCheckUDP=</strong><em>yes|no</em> Whether to check UPD ports as well (default yes).</p><p><strong>SeverityPortCheck=</strong><em>severity</em> Severity for events (default crit).</p><p><strong>PortCheckInterface=</strong><em>ip_address</em> Additional interface to check.</p><p><strong>PortCheckOptional=</strong><em>ip_address:list</em> Ports that may, but need not be open. The ip_address is the one of the interface, the list must be comma or whitespace separated, each item must be (port|service)/protocol, e.g. 22/tcp,nfs/tcp/nfs/udp.</p><p><strong>PortCheckRequired=</strong><em>ip_address:list</em> Ports that are required to be open. The ip_address is the one of the interface, the list must be comma or whitespace separated, each item must be (port|service)/protocol, e.g. 22/tcp,nfs/tcp/nfs/udp.</p>
  </dd>
  <dt>
    <p><em>[Database]</em></p>
  </dt>
  <dd>
    <p>Settings for <em>logging</em> to a database.</p><p><strong>SetDBHost=</strong><em>db_host</em> Host where the DB server runs (default: localhost). Should be a numeric IP address for PostgreSQL.</p><p><strong>SetDBName=</strong><em>db_name</em> Name of the database (default: samhain).</p><p><strong>SetDBTable=</strong><em>db_table</em> Name of the database table (default: log).</p><p><strong>SetDBUser=</strong><em>db_user</em> Connect as this user (default: samhain).</p><p><strong>SetDBPassword=</strong><em>db_password</em> Use this password (default: none).</p><p><strong>SetDBServerTstamp=</strong><em>true|false</em> Log server timestamp for client messages (default: true).</p><p><strong>UsePersistent=</strong><em>true|false</em> Use a persistent connection (default: true).</p>
  </dd>
  <dt>
    <p><em>[Misc]</em></p>
  </dt>
  <dd>
    <p><strong>Daemon=</strong><em>no|yes</em> Detach from controlling terminal to become a daemon.</p><p><strong>MessageHeader=</strong><em>format</em> Costom format for message header. Replacements: <em>%F</em> source file name, <em>%L</em> source file line, <em>%S</em> severity, <em>%T</em> timestamp, <em>%C</em> message class.</p><p><strong>VersionString=</strong><em>string</em> Set version string to include in file signature database (along with hostname and date).</p><p><strong>SetReverseLookup=</strong><em>true|false</em> If false, skip reverse lookups when connecting to a host known by name rather than IP address.</p><p><strong>HideSetup=</strong><em>yes|no</em> Don't log name of config/database files on startup.</p><p><strong>SyslogFacility=</strong><em>facility</em> Set the syslog facility to use. Default is LOG_AUTHPRIV.</p><p><strong>MACType=</strong><em>HASH-TIGER|HMAC-TIGER</em> Set type of message authentication code (HMAC). Must be identical on client and server.</p><p><strong>SetLoopTime=</strong><em>val</em> Defines the interval (in seconds) for timestamps.</p><p><strong>SetConsole=</strong><em>device</em> Set the console device (default /dev/console).</p><p><strong>MessageQueueActive=</strong><em>1|0</em> Whether to use a SysV IPC message queue.</p><p><strong>PreludeMapToInfo=</strong><em>list</em><strong>of</strong><em>severities</em> The severities (see section <em>[Log]</em>) that should be mapped to impact severity <em>info</em> in prelude.</p><p><strong>PreludeMapToLow=</strong><em>list</em><strong>of</strong><em>severities</em> The severities (see section <em>[Log]</em>) that should be mapped to impact severity <em>low</em> in prelude.</p><p><strong>PreludeMapToMedium=</strong><em>list</em><strong>of</strong><em>severities</em> The severities (see section <em>[Log]</em>) that should be mapped to impact severity <em>medium</em> in prelude.</p><p><strong>PreludeMapToHigh=</strong><em>list</em><strong>of</strong><em>severities</em> The severities (see section <em>[Log]</em>) that should be mapped to impact severity <em>high</em> in prelude.</p><p><strong>SetMailTime=</strong><em>val</em> defines the maximum interval (in seconds) between succesive e-mail reports. Mail might be empty if there are no events to report.</p><p><strong>SetMailNum=</strong><em>val</em> defines the maximum number of messages that are stored before e-mailing them. Messages of highest priority are always sent immediately.</p><p><strong>SetMailAddress=</strong><em>username</em><strong>@</strong><em>host</em> sets the recipient address for mailing. <em>No aliases should be used.</em> For security, you should prefer a numerical host address.</p><p><strong>SetMailRelay=</strong><em>server</em> sets the hostname for the mail relay server (if you need one). If no relay server is given, mail is sent directly to the host given in the mail address, otherwise it is sent to the relay server, who should forward it to the given address.</p><p><strong>SetMailSubject=</strong><em>val</em> defines a custom format for the subject of an email message.</p><p><strong>SetMailSender=</strong><em>val</em> defines the sender for the 'From:' field of a message.</p><p><strong>SetMailFilterAnd=</strong><em>list</em> defines a list of strings all of which must match a message, otherwise it will not be mailed.</p><p><strong>SetMailFilterOr=</strong><em>list</em> defines a list of strings at least one of which must match a message, otherwise it will not be mailed.</p><p><strong>SetMailFilterNot=</strong><em>list</em> defines a list of strings none of which should match a message, otherwise it will not be mailed.</p><p><strong>SamhainPath=</strong><em>/path/to/binary</em> sets the path to the samhain binary. If set, samhain will checksum its own binary both on startup and termination, and compare both.</p><p><strong>SetBindAddress=</strong><em>IP_address</em> The IP address (i.e. interface on multi-interface box) to use for outgoing connections.</p><p><strong>SetTimeServer=</strong><em>server</em> sets the hostname for the time server.</p><p><strong>TrustedUser=</strong><em>name|uid</em> Add a user to the set of trusted users (root and the effective user are always trusted. You can add up to 7 more users).</p><p><strong>SetLogfilePath=</strong><em>AUTO|/path</em> Path to logfile (AUTO to tack hostname on compiled-in path).</p><p><strong>SetLockfilePath=</strong><em>AUTO|/path</em> Path to lockfile (AUTO to tack hostname on compiled-in path).</p>
  </dd>
  <dt>
    <p><strong>Standalone or client only</strong></p>
  </dt>
  <dd>
    <p><strong>SetNiceLevel=</strong><em>-19..19</em> Set scheduling priority during file check.</p><p><strong>SetIOLimit=</strong><em>bps</em> Set IO limits (kilobytes per second) for file check.</p><p><strong>SetFilecheckTime=</strong><em>val</em> Defines the interval (in seconds) between succesive file checks.</p><p><strong>FileCheckScheduleOne=</strong><em>schedule</em> Crontab-like schedule for file checks. If used, <em>SetFilecheckTime</em> is ignored.</p><p><strong>UseHardlinkCheck=</strong><em>yes|no</em> Compare number of hardlinks to number of subdirectories for directories.</p><p><strong>HardlinkOffset=</strong><em>N:/path</em> Exception (use multiple times for multiple exceptions). N is offset (actual - expected hardlinks) for /path.</p><p><strong>AddOKChars=</strong><em>N1,N2,..</em> List of additional acceptable characters (byte value(s)) for the check for weird filenames. Nn may be hex (leading '0x': 0xNN), octal (leading zero: 0NNN), or decimal. Use <em>all</em> for all.</p><p><strong>FilenamesAreUTF8=</strong><em>yes|no</em> Whether filenames are UTF-8 encoded (defaults to no). If yes, filenames are checked for invalid UTF-8 encoding and for ending in invisible characters.</p><p><strong>IgnoreAdded=</strong><em>path_regex</em> Ignore if this file/directory is added/created.</p><p><strong>IgnoreMissing=</strong><em>path_regex</em> Ignore if this file/directory is missing/deleted.</p><p><strong>ReportOnlyOnce=</strong><em>yes|no</em> Report only once on a modified file (default yes).</p><p><strong>ReportFullDetail=</strong><em>yes|no</em> Report in full detail on modified files (not only modified items).</p><p><strong>UseLocalTime=</strong><em>yes|no</em> Report file timestamps in local time rather than GMT (default no). Do not use this with Beltane.</p><p><strong>ChecksumTest=</strong><em>{init|update|check|none}</em> defines whether to initialize/update the database or verify files against it. If 'none', you should supply the required option on the command line.</p><p><strong>SetPrelinkPath=</strong><em>path</em> Path of the prelink executable (default /usr/sbin/prelink).</p><p><strong>SetPrelinkChecksum=</strong><em>checksum</em> TIGER192 checksum of the prelink executable (no default).</p><p><strong>SetLogServer=</strong><em>server</em> sets the hostname for the log server.</p><p><strong>SetServerPort=</strong><em>portnumber</em> sets the port on the server to connect to.</p><p><strong>SetDatabasePath=</strong><em>AUTO|/path</em> Path to database (AUTO to tack hostname on compiled-in path).</p><p><strong>DigestAlgo=</strong><em>SHA1|MD5</em> Use SHA1 or MD5 instead of the TIGER checksum (default: TIGER192).</p><p><strong>RedefReadOnly=</strong><em>+/-XXX,+/-YYY,...</em> Add or subtract tests XXX from the ReadOnly policy. Tests are: CHK (checksum), TXT (store literal content), LNK (link), HLN (hardlink), INO (inode), USR (user), GRP (group), MTM (mtime), ATM (atime), CTM (ctime), SIZ (size), RDEV (device numbers) and/or MOD (file mode).</p><p><strong>RedefAttributes=</strong><em>+/-XXX,+/-YYY,...</em> Add or subtract tests XXX from the Attributes policy.</p><p><strong>RedefLogFiles=</strong><em>+/-XXX,+/-YYY,...</em> Add or subtract tests XXX from the LogFiles policy.</p><p><strong>RedefGrowingLogFiles=</strong><em>+/-XXX,+/-YYY,...</em> Add or subtract tests XXX from the GrowingLogFiles policy.</p><p><strong>RedefIgnoreAll=</strong><em>+/-XXX,+/-YYY,...</em> Add or subtract tests XXX from the IgnoreAll policy.</p><p><strong>RedefIgnoreNone=</strong><em>+/-XXX,+/-YYY,...</em> Add or subtract tests XXX from the IgnoreNone policy.</p><p><strong>RedefUser0=</strong><em>+/-XXX,+/-YYY,...</em> Add or subtract tests XXX from the User0 policy.</p><p><strong>RedefUser1=</strong><em>+/-XXX,+/-YYY,...</em> Add or subtract tests XXX from the User1 policy.</p><p><strong>RedefUser2=</strong><em>+/-XXX,+/-YYY,...</em> Add or subtract tests XXX from the User2 policy.</p><p><strong>RedefUser3=</strong><em>+/-XXX,+/-YYY,...</em> Add or subtract tests XXX from the User3 policy.</p><p><strong>RedefUser4=</strong><em>+/-XXX,+/-YYY,...</em> Add or subtract tests XXX from the User4 policy.</p>
  </dd>
  <dt>
    <p><strong>Server Only</strong></p>
  </dt>
  <dd>
    <p><strong>SetUseSocket=</strong><em>yes|no</em> If unset, do not open the command socket. The default is no.</p><p><strong>SetSocketAllowUid=</strong><em>UID</em> Which user can connect to the command socket. The default is 0 (root).</p><p><strong>SetSocketPassword=</strong><em>password</em> Password (max. 14 chars, no '@') for password-based authentication on the command socket (only if the OS does not support passing credentials via sockets).</p><p><strong>SetChrootDir=</strong><em>path</em> If set, chroot to this directory after startup.</p><p><strong>SetStripDomain=</strong><em>yes|no</em> Whether to strip the domain from the client hostname when logging client messages (default: yes).</p><p><strong>SetClientFromAccept=</strong><em>true|false</em> If true, use client address as known to the communication layer. Else (default) use client name as claimed by the client, try to verify against the address known to the communication layer, and accept (with a warning message) even if this fails.</p><p><strong>UseClientSeverity=</strong><em>yes|no</em> Use the severity of client messages.</p><p><strong>UseClientClass=</strong><em>yes|no</em> Use the class of client messages.</p><p><strong>SetServerPort=</strong><em>number</em> The port that the server should use for listening (default is 49777).</p><p><strong>SetServerInterface=</strong><em>IPaddress</em> The IP address (i.e. interface on multi-interface box) that the server should use for listening (default is all). Use INADDR_ANY to reset to all.</p><p><strong>SeverityLookup=</strong><em>severity</em> Severity of the message on client address != socket peer.</p><p><strong>UseSeparateLogs=</strong><em>true|false</em> If true, messages from different clients will be logged to separate log files (the name of the client will be appended to the name of the main log file to construct the logfile name).</p><p><strong>SetClientTimeLimit=</strong><em>seconds</em> The maximum time between client messages. If exceeded, a warning will be issued (the default is 86400 sec = 1 day).</p><p><strong>SetUDPActive=</strong><em>yes|no</em> yule 1.2.8+: Also listen on 514/udp (syslog).</p>
  </dd>
  <dt>
    <p><em>[Clients]</em></p>
  </dt>
  <dd>
    <p>This section is only relevant if <strong>samhain</strong> is run as a log server for clients running on another (or the same) machine.</p><p><strong>Client=</strong><em>hostname</em><strong>@</strong><em>salt</em><strong>@</strong><em>verifier</em> registers a client at host <em>hostname</em> (fully qualified hostname required) for access to the log server. Log entries from unregistered clients will not be accepted. To generate a salt and a valid verifier, use the command <strong>samhain -P</strong> <em>password</em>, where <em>password</em> is the password of the client. A simple utility program <strong>samhain_setpwd</strong> is provided to re-set the compiled-in default password of the client executable to a user-defined value.</p>
  </dd>
  <dt>
    <p><em>[EOF]</em></p>
  </dt>
  <dd>
    <p>An optional end marker. Everything below is ignored.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO samhainrc&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/samhain.8.html"><strong>samhain</strong>(8)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Rainer Wichmann (http://la-samhna.de)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUG REPORTS</h2>
        <div class="sectioncontent">
<p>If you find a bug in <strong>samhain</strong>, please send electronic mail to <em>support@la-samhna.de</em>. Please include your operating system and its revision, the version of <strong>samhain</strong>, what C compiler you used to compile it, your 'configure' options, and anything else you deem helpful.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYING PERMISSIONS</h2>
        <div class="sectioncontent">
<p>Copyright (&copy;) 2000, 2004, 2005 Rainer Wichmann</p><p>Permission is granted to make and distribute verbatim copies of this manual page provided the copyright notice and this permission notice are preserved on all copies.</p><p>Permission is granted to copy and distribute modified versions of this manual page under the conditions for verbatim copying, provided that the entire resulting derived work is distributed under the terms of a permission notice identical to this one.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="sam.5.html"><span aria-hidden="true">&larr;</span> sam.5: Sequence alignment/map file format</a></li>
   <li class="next"><a href="sane-abaton.5.html">sane-abaton.5: Sane backend for abaton flatbed scanners <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
