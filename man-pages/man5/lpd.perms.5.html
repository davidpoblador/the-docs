<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>lpd.perms: Permissions control file for the lprng line printer spooler system</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Permissions control file for the lprng line printer spooler system">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="lpd.perms (5) manual">
  <meta name="twitter:description" content="Permissions control file for the lprng line printer spooler system">
  <meta name="twitter:image" content="https://www.carta.tech/images/lprng-lpd.perms-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/lpd.perms.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="lpd.perms (5) manual" />
  <meta property="og:description" content="Permissions control file for the lprng line printer spooler system" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/lprng-lpd.perms-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">lpd.perms<small> (5)</small></h1>
        <p class="lead">Permissions control file for the lprng line printer spooler system</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/lpd.perms.5.html">
      <span itemprop="name">lpd.perms: Permissions control file for the lprng line printer spooler system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/lprng/">
      <span itemprop="name">lprng</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/lpd.perms.5.html">
      <span itemprop="name">lpd.perms: Permissions control file for the lprng line printer spooler system</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The file <strong>lpd.perms</strong> is used to provide permission information for the LPRng Printer spooler system. Blank lines and all characters after a hash sign (``#'') to the end of line are ignored. If a hash sign is desired in the permission information, it should be escaped with a backslash (``&#92;''). All other lines specify permissions entry and should be of the following form:</p><p>ACCEPT [[not] key = value[,value]* ]*</p><p>REJECT [[not] key = value[,value]* ]*</p><p>DEFAULT ACCEPT</p><p>DEFAULT REJECT</p><p>Each LPD service request is checked against the entries in the permissions database or file. The following is a typical permissions file:</p>
<pre>
# Set default permissions
DEFAULT ACCEPT
# Reject any connections from outside our subnet
REJECT SERVICE=X NOT REMOTEIP=130.191.0.0/255.255.0.0
# Only accept spooling (LPR) from
# Engineering Lab or the Dean's office
REJECT SERVICE=R NOT REMOTEHOST=*.eng.sdsu.edu,dean.sdsu.edu
# Do not accept forwarded jobs for printing
REJECT SERVICE=R FORWARD
# Allow only the administrators control access
ACCEPT SERVICE=C,M REMOTEHOST=spooler.eng.sdsu.edu REMOTEUSER=root,papowell
ACCEPT SERVICE=C,M SERVER REMOTEUSER=root,papowell
# Allow only the user on the same host who spooled job to remove it
ACCEPT SERVICE=M SAMEUSER SAMEHOST
# Allow users to check status
ACCEPT SERVICE=C LPC=status
# Require connection for other operations over UNIX socket
# not TCP/IP port.  Effectively requiring them to be made from the
# localhost
ACCEPT SERVICE=C UNIXSOCKET
REJECT SERVICE=C

# Variation - accept all spooled jobs,  but then apply
#  permissions checking when job is printed.  Allows
#  prevents remote spoolers from locking up trying resend
#  same request
ACCEPT SERVICE=R
REJECT SERVICE=P NOT REMOTEHOST=*.eng.sdsu.edu,dean.sdsu.edu
</pre>
<p>Permission checking is done by using a set of keys (or fields) with associated values to check for permission. The SERVICE key has value P for printing (i.e.- unspooling), R for spooling (i.e.- LPR request), P for printing (i.e., after job has been spooled), C printer control (i.e. - LPC), M for removal (i.e.- LPRM request), and Q for queue information (i.e.- LPQ request). The <strong>X</strong> key is used when checking for connection information.</p><p>Initially, all of the keys have undefined or NULL values, and are assigned values during the permissions checking process. When a connection is made to the server, it assigns The REMOTEHOST (alias REMOTEIP) key the list of IP addresses and hostnames determined by doing a reverse Domain Name Service (DNS) lookup on the remote host's IP address. If the reverse DNS fails, then only the IP address will be used. The REMOTEPORT (PORT is an alias for REMOTEPORT) is assigned the port number of the connection origination. The UNIXSOCKET key will match (be true) if the connection is over a UNIX socket. By convention, this is from the localhost. Finally, the SERVICE value is assigned X, and the lpd server will check the database to see if the connection is accepted or rejected.</p><p>The server will then read the request information from the connection. If the request is for an authenticated data transfer, the server will invoke the appropriate authentication mechanism which will assign AUTH a true (or matching) value, AUTHTYPE the type of authentication, AUTHUSER the authenticated user id value, which may differ from the actual user name, and AUTHFROM the authenticated identification of the originator of the request, which may be a server if the request is forwarded.</p><p>Next, the SERVICE value is set to R, C, M, or Q depending on whether it is an LPR, LPC, LPRM, or LPQ request, and the LPC value set to the requested LPC command if it was an LPC request. If the request contained a user name, then REMOTEUSER is set to this name. If the request contained a printer name, then PRINTER is set to the printer name. If the request is a print request, then the HOST value is set to the list of host names and IP addresses given by a DNS lookup of the value in the H field of the job. The database is scanned again to determine if the operation can be performed on the requested queue. To simplify the rule writing, if the operation requires modification or checking of individual jobs, such as the LPC, LPQ, or LPRM commands, then the various checks that depend on jobs will succeed in this step.</p><p>Finally, if the operation requires modification or checking of individual jobs, such as the LPC, LPQ, or LPRM commands, then the specified print queue is scanned, and for each job in the print queue, the HOST and USER values are set to the host and user values in the control file for the job.</p><p>The database is checked as follows. Each line of the permissions file is scanned for key names and values, and these are matched against the request keys information. When all matches on a line are made, then search terminates with the specified action (ACCEPT/REJECT). If no match is found the default permission value is used. The DEFAULT key is used to specify the current default permission to be used for successful matches or if there is no match after scanning the entire permissions database.</p><p>The following keys provide some additional checking capabilities. The REMOTEGROUP entry checks that the REMOTEUSER value appears in a group or netgroup entry in the system database, and the GROUP entry for the USER value. For example, GROUP=student*,staff* would check to see if any of the group names matching student* or staff* have the specified user name in them. If a system has the <em>netgroups</em> capability, a printer, group, or remotegroup name starting with a @ will be treated as a netgroup name, and specified user name or printer will be checked to see if it is in the group.</p><p>The SERVER entry will be true (match) if the request originated from the print server. The SAMEHOST is true (matches) if the REMOTEHOST and HOST values have a common entry, i.e. - are the same host. The SAMEUSER is true (matches) if the REMOTEUSER and USER values are identical. The AUTHSAMEUSER is true (matches) if the AUTHUSER value that originated the request and the AUTHUSER which was used to transfer a job are identical. AUTHJOB is true (matches) if the job was transferred using authentication. The FORWARD value is an alias for NOT SAMEHOST.</p><p>The CONTROLLINE value can be used to determine if there is a matching line in the control file. This facility has been used to ensure that jobs contain various information fields in order to be printed.</p>
<pre>
Key	Match	Connect	Job	Job	LPQ	LPRM	LPC
&nbsp;	&nbsp;	&nbsp;	Spool	Print
SERVICE	S	'X'	'R'	'P'	'Q'	'M'	'C,S'
USER	S	-	JUSR	JUSR	JUSR	JUSR	JUSR
HOST	S	RH	JH	JH	JH	JH	JH
GROUP	S	-	JUSR	JUSR	JUSR	JUSR	JUSR
REMOTEPORT	N	PORT	PORT	-	PORT	PORT	PORT
REMOTEUSER	S	-	JUSR	JUSR	JUSR	CUSR	CUSR
REMOTEHOST	S	RH	RH	JH	RH	RH	RH
UNIXSOCKET	V	SK	SK	SK	SK	SK	SK
REMOTEGROUP	S	-	JUSR	JUSR	JUSR	CUSR	CUSR
CONTROLLINE	S	-	CL	CL	CL	CL	CL
PRINTER	S	-	PR	PR	PR	PR	PR
FORWARD	V	-	SA	-	-	SA	SA
SAMEHOST	V	-	SA	-	SA	SA	SA
SAMEUSER	V	-	-	-	SU	SU	SU
SERVER	V	-	SV	-	SV	SV	SV
AUTH	V	-	AU	-	AU	AU	AU
AUTHTYPE	S	-	AU	-	AU	AU	AU
AUTHUSER	S	-	AU	-	AU	AU	AU
AUTHSAMEUSER	S	-	AU	-	AU	AU	AU
AUTHFROM	S	-	AU	-	AU	AU	AU
AUTHJOB	V	-	AU	-	AU	AU	AU
  PORT is alias for REMOTEPORT
  REMOTEIP is alias for REMOTEHOST
  IP is alias for HOST

KEY:
	JH = HOST	host in control file
	RH = REMOTEHOST	connecting host name/IP
	JUSR = USER	user in control file
	CUSR = REMOTEUSER	user from control request
	JIP= IP	host/IP addr of host in control file
	RIP= REMOTEIP	host/IP addr of requesting host
	PORT=	connecting host origination port
    SK=  match if connection over a UNIX socket
	CONTROLLINE=	pattern match of control line in control file
	FW= IP of source of request == IP of host in control file
	SA= IP of source of request == IP of host in control file
	SU= user from request == user in control file
	SA= IP of source of request == IP of server host
	SV= matches if from same address as server
	AU= value determined by server authentication operation
		AUTH is true if authenticated transfer,
		TYPE is set to the type of authentication (kerberos, etc)
		AUTHUSER is user authentication id
		AUTHFROM is sender authentication id (can be remote server)
		AUTHSAMEUSER matches if remote user authentication id matches original
			user authentication id
		AUTHJOB it true if print job has authentication
Match: S = string with wild card, IP = IP address[/netmask],
	N = low[-high] number range, V = exact value match
SERVICE: 'X' - Connection request; 'R' - lpr request from remote host;
    'P' - print job in queue; 'Q' - lpq request, 'M' - lprm request;
    'C' - lpc spool control request; 'S' - lpc spool status request
	'U' - administratively allowed user operation
NOTE: when printing (P action), the remote and job check values
	(i.e. - RUSR, JUSR) are identical.
</pre>
<p>The special key <em>letter=patterns</em> searches the control file line starting with the (upper case) letter, and is usually used with printing and spooling checks. For example, C=A*,B* would check that the class information (i.e.- line in the control file starting with C) had a value starting with A or B.</p><p>A permission line consists of a list of tests and a result value. If all of the tests succeed, then a match has been found and the permission testing completes with the result value.  You use the DEFAULT reserved word to set the default ACCEPT/DENY result. The NOT keyword will reverse the sense of a test.</p><p>Each test can have one or more optional values separated by commas. For example USER=john,paul,mark has 3 test values. The Match value specifies how the matching is done.</p>
<pre>
S = string type match - string match with glob.
	Format:  string with wildcards (*)
		* matches 0 or more chars
	Character comparison is case insensitive.
	For example - USER=th*s matches uTHS, This, This, Theses

IP = IP address and submask.  IP address must be in dotted form.
	Format: x.x.x.x[/y.y.y.y or /z]
		x.x.x.x is IP address
	    y.y.y.y is optional submask, default is 255.255.255.255
        z is a netmask with most significant z bits set.
	Match is done by IP address to a 32 bit value and using:
		success = ((x ^ IP ) & y) == 0   (C language notation)
	i.e.- only bits where mask is non-zero are used in comparison.
	For example - IP=130.191.0.0/255.255.0.0 matches all address 130.191.X.X
	IP=130.191.0.0/16 has the same value.

N = numerical range  -  low-high integer range.
	Format: low[-high]
	Example: PORT=0-1023 matches a port in range 0 - 1023 (privileged)
</pre>
<p>The authentication entries AUTH, AUTHTYPE, AUTHUSER, AUTHSAMEUSER and AUTHFROM can be used to check permissions for authenticated operations. AUTH is set (true) if authentication was done. We can use this to reject non-authenticated transfers:</p><p>REJECT NOT AUTH</p><p>The AUTHTYPE will match the authentication type being used or requested by the remote client or server. The AUTHUSER matches the original client authentication information used by the client to make a request to the server, and the AUTHFROM matches the sender authentication information. The AUTHSAMEUSER will match if the remote client or user authentication id is the same as that used for the job generation.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LPC=OP</h2>
        <div class="sectioncontent">
<p>The LPC=op entry is useful to allow various users to perform administration operations. The following permissions entry would allows users to hold or release their own jobs:</p><p>ACCEPT SERVICE=C SAMEUSER SAMEHOST LPC=release</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DNS, IPV6, AND MULTIHOMED HOSTS</h2>
        <div class="sectioncontent">
<p>There is a subtle problem with names and IP addresses which are obtained for 'multi-homed hosts', i.e. - those with multiple Ethernet interfaces,  and for IPV6 (IP Version 6),  in which a host can have multiple addresses,  and for the normal host which can have both a short name and a fully qualified domain name.</p><p>When performing an IP address match,  the entire list of IP addresses for a system will now be checked.  If one of these matches, then success is reported.  Similarly,  the entire list of host names and aliases will be checked.  If one of these matches,  then success will be reported.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>The files used by LPRng are set by values in the printer configuration file. The following are a commonly used set of default values.</p>
<pre>
/etc/lprng/lpd.conf	LPRng configuration file
${HOME}/.printcap	user printer description file
/etc/printcap	printer description file
/etc/lprng/lpd.perms	permissions
/var/run/lprng/lpd	lock file for queue control
/var/spool/lpd		spool directories
/var/spool/lpd/QUEUE/control	queue control
/var/spool/lpd/QUEUE/log	trace or debug log file
/var/spool/lpd/QUEUE/acct	accounting file
/var/spool/lpd/QUEUE/status	status file
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO lpd.perms&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/lpd.conf.5.html"><strong>lpd.conf</strong>(5)</a>, <a href="../man8/lpc.8.html"><strong>lpc</strong>(8)</a>, <strong>lpd</strong>(8), <a href="../man8/checkpc.8.html"><strong>checkpc</strong>(8)</a>, <a href="../man1/lpr.1.html"><strong>lpr</strong>(1)</a>, <a href="../man1/lpq.1.html"><strong>lpq</strong>(1)</a>, <a href="../man1/lprm.1.html"><strong>lprm</strong>(1)</a>, <a href="../man5/printcap.5.html"><strong>printcap</strong>(5)</a>, pr(1), <a href="../man1/lprng_certs.1.html"><strong>lprng_certs</strong>(1)</a>, <a href="../man1/lprng_index_certs.1.html"><strong>lprng_index_certs</strong>(1)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Patrick Powell &lt;papowell@lprng.com&gt;.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">
<p>LPRng is a enhanced printer spooler system with functionality similar to the Berkeley LPR software. The LPRng developer mailing list is lprng-devel@lists.sourceforge.net; subscribe by visiting <strong>https://lists.sourceforge.net/lists/listinfo/lprng-devel</strong> or sending mail to <strong>lprng-request@lists.sourceforge.net</strong> with the word <em>subscribe</em> in the body.</p><p>The software is available via <strong>http://lprng.sourceforge.net</strong></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="lpd.conf.5.html"><span aria-hidden="true">&larr;</span> lpd.conf.5: </a></li>
   <li class="next"><a href="lrzip.conf.5.html">lrzip.conf.5: Configuration file for lrzip <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
