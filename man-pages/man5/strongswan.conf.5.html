<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>strongswan.conf: Strongswan configuration file</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Strongswan configuration file">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="strongswan.conf (5) manual">
  <meta name="twitter:description" content="Strongswan configuration file">
  <meta name="twitter:image" content="https://www.carta.tech/images/strongswan-starter-strongswan.conf-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/strongswan.conf.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="strongswan.conf (5) manual" />
  <meta property="og:description" content="Strongswan configuration file" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/strongswan-starter-strongswan.conf-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">strongswan.conf<small> (5)</small></h1>
        <p class="lead">Strongswan configuration file</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/strongswan.conf.5.html">
      <span itemprop="name">strongswan.conf: Strongswan configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/strongswan-starter/">
      <span itemprop="name">strongswan-starter</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/strongswan.conf.5.html">
      <span itemprop="name">strongswan.conf: Strongswan configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>While the <a href="../man5/ipsec.conf.5.html"><strong>ipsec.conf</strong>(5)</a> configuration file is well suited to define IPsec related configuration parameters, it is not useful for other strongSwan applications to read options from this file. The file is hard to parse and only <em>ipsec starter</em> is capable of doing so. As the number of components of the strongSwan project is continually growing, a more flexible configuration file was needed, one that is easy to extend and can be used by all components. With strongSwan 4.2.1 <a href="../man5/strongswan.conf.5.html"><strong>strongswan.conf</strong>(5)</a> was introduced which meets these requirements.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNTAX</h2>
        <div class="sectioncontent">
<p>The format of the strongswan.conf file consists of hierarchical <strong>sections</strong> and a list of <strong>key/value pairs</strong> in each section. Each section has a name, followed by C-Style curly brackets defining the section body. Each section body contains a set of subsections and key/value pairs:</p>
<pre>
	settings := (section|keyvalue)*
	section  := name { settings }
	keyvalue := key = value&#92;n
</pre>
<p>Values must be terminated by a newline.</p><p>Comments are possible using the <strong>#</strong>-character, but be careful: The parser implementation is currently limited and does not like brackets in comments.</p><p>Section names and keys may contain any printable character except:</p>
<pre>
	. { } # &#92;n &#92;t space
</pre>
<p>An example file in this format might look like this:</p>
<pre>
	a = b
	section-one {
		somevalue = asdf
		subsection {
			othervalue = xxx
		}
		# yei, a comment
		yetanother = zz
	}
	section-two {
		x = 12
	}
</pre>
<p>Indentation is optional, you may use tabs or spaces.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">INCLUDING FILES</h2>
        <div class="sectioncontent">
<p>Using the <strong>include</strong> statement it is possible to include other files into strongswan.conf, e.g.</p>
<pre>
	include /some/path/*.conf
</pre>
<p>If the file name is not an absolute path, it is considered to be relative to the directory of the file containing the include statement. The file name may include shell wildcards (see <em>sh</em>(1)). Also, such inclusions can be nested.</p><p>Sections loaded from included files <em>extend</em> previously loaded sections; already existing values are <em>replaced</em>. It is important to note that settings are added relative to the section the include statement is in.</p><p>As an example, the following three files result in the same final config as the one given above:</p>
<pre>
	a = b
	section-one {
		somevalue = before include
		include include.conf
	}
	include other.conf

include.conf:
	# settings loaded from this file are added to section-one
	# the following replaces the previous value
	somevalue = asdf
	subsection {
		othervalue = yyy
	}
	yetanother = zz

other.conf:
	# this extends section-one and subsection
	section-one {
		subsection {
			# this replaces the previous value
			othervalue = xxx
		}
	}
	section-two {
		x = 12
	}
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">READING VALUES</h2>
        <div class="sectioncontent">
<p>Values are accessed using a dot-separated section list and a key. With reference to the example above, accessing <strong>section-one.subsection.othervalue</strong> will return <strong>xxx</strong>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DEFINED KEYS</h2>
        <div class="sectioncontent">
<p>The following keys are currently defined (using dot notation). The default value (if any) is listed in brackets after the key.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>aikgen.load</strong> []</p>
  </dt>
  <dd>
    <p>Plugins to load in ipsec aikgen tool.</p>
  </dd>
  <dt>
    <p><strong>attest.database</strong> []</p>
  </dt>
  <dd>
    <p>File measurement information database URI. If it contains a password, make sure to adjust the permissions of the config file accordingly.</p>
  </dd>
  <dt>
    <p><strong>attest.load</strong> []</p>
  </dt>
  <dd>
    <p>Plugins to load in ipsec attest tool.</p>
  </dd>
  <dt>
    <p><strong>charon</strong></p>
  </dt>
  <dd>
    <p>Options for the charon IKE daemon.</p><p><strong>Note</strong>: Many of the options in this section also apply to <strong>charon-cmd</strong> and other <strong>charon</strong> derivatives.  Just use their respective name (e.g. <strong>charon-cmd</strong> instead of <strong>charon</strong>). For many options defaults can be defined in the <strong>libstrongswan</strong> section.</p>
  </dd>
  <dt>
    <p><strong>charon.accept_unencrypted_mainmode_messages</strong> [no]</p>
  </dt>
  <dd>
    <p>Accept unencrypted ID and HASH payloads in IKEv1 Main Mode.</p><p>Some implementations send the third Main Mode message unencrypted, probably to find the PSKs for the specified ID for authentication. This is very similar to Aggressive Mode, and has the same security implications: A passive attacker can sniff the negotiated Identity, and start brute forcing the PSK using the HASH payload.</p><p>It is recommended to keep this option to no, unless you know exactly what the implications are and require compatibility to such devices (for example, some SonicWall boxes).</p>
  </dd>
  <dt>
    <p><strong>charon.block_threshold</strong> [5]</p>
  </dt>
  <dd>
    <p>Maximum number of half-open IKE_SAs for a single peer IP.</p>
  </dd>
  <dt>
    <p><strong>charon.cert_cache</strong> [yes]</p>
  </dt>
  <dd>
    <p>Whether relations in validated certificate chains should be cached in memory.</p>
  </dd>
  <dt>
    <p><strong>charon.cisco_unity</strong> [no]</p>
  </dt>
  <dd>
    <p>Send Cisco Unity vendor ID payload (IKEv1 only).</p>
  </dd>
  <dt>
    <p><strong>charon.close_ike_on_child_failure</strong> [no]</p>
  </dt>
  <dd>
    <p>Close the IKE_SA if setup of the CHILD_SA along with IKE_AUTH failed.</p>
  </dd>
  <dt>
    <p><strong>charon.cookie_threshold</strong> [10]</p>
  </dt>
  <dd>
    <p>Number of half-open IKE_SAs that activate the cookie mechanism.</p>
  </dd>
  <dt>
    <p><strong>charon.crypto_test.bench</strong> [no]</p>
  </dt>
  <dd>
    <p>Benchmark crypto algorithms and order them by efficiency.</p>
  </dd>
  <dt>
    <p><strong>charon.crypto_test.bench_size</strong> [1024]</p>
  </dt>
  <dd>
    <p>Buffer size used for crypto benchmark.</p>
  </dd>
  <dt>
    <p><strong>charon.crypto_test.bench_time</strong> [50]</p>
  </dt>
  <dd>
    <p>Number of iterations to test each algorithm.</p>
  </dd>
  <dt>
    <p><strong>charon.crypto_test.on_add</strong> [no]</p>
  </dt>
  <dd>
    <p>Test crypto algorithms during registration (requires test vectors provided by the <em>test-vectors</em> plugin).</p>
  </dd>
  <dt>
    <p><strong>charon.crypto_test.on_create</strong> [no]</p>
  </dt>
  <dd>
    <p>Test crypto algorithms on each crypto primitive instantiation.</p>
  </dd>
  <dt>
    <p><strong>charon.crypto_test.required</strong> [no]</p>
  </dt>
  <dd>
    <p>Strictly require at least one test vector to enable an algorithm.</p>
  </dd>
  <dt>
    <p><strong>charon.crypto_test.rng_true</strong> [no]</p>
  </dt>
  <dd>
    <p>Whether to test RNG with TRUE quality; requires a lot of entropy.</p>
  </dd>
  <dt>
    <p><strong>charon.dh_exponent_ansi_x9_42</strong> [yes]</p>
  </dt>
  <dd>
    <p>Use ANSI X9.42 DH exponent size or optimum size matched to cryptographic strength.</p>
  </dd>
  <dt>
    <p><strong>charon.dns1</strong> []</p>
  </dt>
  <dd>
    <p>DNS server assigned to peer via configuration payload (CP).</p>
  </dd>
  <dt>
    <p><strong>charon.dns2</strong> []</p>
  </dt>
  <dd>
    <p>DNS server assigned to peer via configuration payload (CP).</p>
  </dd>
  <dt>
    <p><strong>charon.dos_protection</strong> [yes]</p>
  </dt>
  <dd>
    <p>Enable Denial of Service protection using cookies and aggressiveness checks.</p>
  </dd>
  <dt>
    <p><strong>charon.ecp_x_coordinate_only</strong> [yes]</p>
  </dt>
  <dd>
    <p>Compliance with the errata for RFC 4753.</p>
  </dd>
  <dt>
    <p><strong>charon.filelog</strong></p>
  </dt>
  <dd>
    <p>Section to define file loggers, see LOGGER CONFIGURATION in <a href="../man5/strongswan.conf.5.html"><strong>strongswan.conf</strong>(5)</a>.</p>
  </dd>
  <dt>
    <p><strong>charon.filelog.&lt;filename&gt;</strong></p>
  </dt>
  <dd>
    <p>&lt;filename&gt; is the full path to the log file.</p>
  </dd>
  <dt>
    <p><strong>charon.filelog.&lt;filename&gt;.&lt;subsystem&gt;</strong> [&lt;default&gt;]</p>
  </dt>
  <dd>
    <p>Loglevel for a specific subsystem.</p>
  </dd>
  <dt>
    <p><strong>charon.filelog.&lt;filename&gt;.append</strong> [yes]</p>
  </dt>
  <dd>
    <p>If this option is enabled log entries are appended to the existing file.</p>
  </dd>
  <dt>
    <p><strong>charon.filelog.&lt;filename&gt;.default</strong> [1]</p>
  </dt>
  <dd>
    <p>Specifies the default loglevel to be used for subsystems for which no specific loglevel is defined.</p>
  </dd>
  <dt>
    <p><strong>charon.filelog.&lt;filename&gt;.flush_line</strong> [no]</p>
  </dt>
  <dd>
    <p>Enabling this option disables block buffering and enables line buffering.</p>
  </dd>
  <dt>
    <p><strong>charon.filelog.&lt;filename&gt;.ike_name</strong> [no]</p>
  </dt>
  <dd>
    <p>Prefix each log entry with the connection name and a unique numerical identifier for each IKE_SA.</p>
  </dd>
  <dt>
    <p><strong>charon.filelog.&lt;filename&gt;.time_format</strong> []</p>
  </dt>
  <dd>
    <p>Prefix each log entry with a timestamp. The option accepts a format string as passed to <a href="../man3/strftime.3.html"><strong>strftime</strong>(3)</a>.</p>
  </dd>
  <dt>
    <p><strong>charon.flush_auth_cfg</strong> [no]</p>
  </dt>
  <dd>
    <p>If enabled objects used during authentication (certificates, identities etc.) are released to free memory once an IKE_SA is established. Enabling this might conflict with plugins that later need access to e.g. the used certificates.</p>
  </dd>
  <dt>
    <p><strong>charon.fragment_size</strong> [0]</p>
  </dt>
  <dd>
    <p>Maximum size (complete IP datagram size in bytes) of a sent IKE fragment when using proprietary IKEv1 or standardized IKEv2 fragmentation (0 for address family specific        default values). If specified this limit is used for both IPv4 and IPv6.</p>
  </dd>
  <dt>
    <p><strong>charon.group</strong> []</p>
  </dt>
  <dd>
    <p>Name of the group the daemon changes to after startup.</p>
  </dd>
  <dt>
    <p><strong>charon.half_open_timeout</strong> [30]</p>
  </dt>
  <dd>
    <p>Timeout in seconds for connecting IKE_SAs (also see IKE_SA_INIT DROPPING).</p>
  </dd>
  <dt>
    <p><strong>charon.hash_and_url</strong> [no]</p>
  </dt>
  <dd>
    <p>Enable hash and URL support.</p>
  </dd>
  <dt>
    <p><strong>charon.host_resolver.max_threads</strong> [3]</p>
  </dt>
  <dd>
    <p>Maximum number of concurrent resolver threads (they are terminated if unused).</p>
  </dd>
  <dt>
    <p><strong>charon.host_resolver.min_threads</strong> [0]</p>
  </dt>
  <dd>
    <p>Minimum number of resolver threads to keep around.</p>
  </dd>
  <dt>
    <p><strong>charon.i_dont_care_about_security_and_use_aggressive_mode_psk</strong> [no]</p>
  </dt>
  <dd>
    <p>If enabled responders are allowed to use IKEv1 Aggressive Mode with pre-shared keys, which is discouraged due to security concerns (offline attacks on the openly transmitted hash of the PSK).</p>
  </dd>
  <dt>
    <p><strong>charon.ignore_routing_tables</strong> []</p>
  </dt>
  <dd>
    <p>A space-separated list of routing tables to be excluded from route lookups.</p>
  </dd>
  <dt>
    <p><strong>charon.ikesa_limit</strong> [0]</p>
  </dt>
  <dd>
    <p>Maximum number of IKE_SAs that can be established at the same time before new connection attempts are blocked.</p>
  </dd>
  <dt>
    <p><strong>charon.ikesa_table_segments</strong> [1]</p>
  </dt>
  <dd>
    <p>Number of exclusively locked segments in the hash table.</p>
  </dd>
  <dt>
    <p><strong>charon.ikesa_table_size</strong> [1]</p>
  </dt>
  <dd>
    <p>Size of the IKE_SA hash table.</p>
  </dd>
  <dt>
    <p><strong>charon.imcv</strong></p>
  </dt>
  <dd>
    <p>Defaults for options in this section can be configured in the <em>libimcv</em> section.</p>
  </dd>
  <dt>
    <p><strong>charon.imcv.assessment_result</strong> [yes]</p>
  </dt>
  <dd>
    <p>Whether IMVs send a standard IETF Assessment Result attribute.</p>
  </dd>
  <dt>
    <p><strong>charon.imcv.database</strong> []</p>
  </dt>
  <dd>
    <p>Global IMV policy database URI. If it contains a password, make sure to adjust the permissions of the config file accordingly.</p>
  </dd>
  <dt>
    <p><strong>charon.imcv.os_info.name</strong> []</p>
  </dt>
  <dd>
    <p>Manually set the name of the client OS (e.g. Ubuntu).</p>
  </dd>
  <dt>
    <p><strong>charon.imcv.os_info.version</strong> []</p>
  </dt>
  <dd>
    <p>Manually set the version of the client OS (e.g. 12.04 i686).</p>
  </dd>
  <dt>
    <p><strong>charon.imcv.policy_script</strong> [ipsec _imv_policy]</p>
  </dt>
  <dd>
    <p>Script called for each TNC connection to generate IMV policies.</p>
  </dd>
  <dt>
    <p><strong>charon.inactivity_close_ike</strong> [no]</p>
  </dt>
  <dd>
    <p>Whether to close IKE_SA if the only CHILD_SA closed due to inactivity.</p>
  </dd>
  <dt>
    <p><strong>charon.init_limit_half_open</strong> [0]</p>
  </dt>
  <dd>
    <p>Limit new connections based on the current number of half open IKE_SAs, see IKE_SA_INIT DROPPING in <a href="../man5/strongswan.conf.5.html"><strong>strongswan.conf</strong>(5)</a>.</p>
  </dd>
  <dt>
    <p><strong>charon.init_limit_job_load</strong> [0]</p>
  </dt>
  <dd>
    <p>Limit new connections based on the number of jobs currently queued for processing (see IKE_SA_INIT DROPPING).</p>
  </dd>
  <dt>
    <p><strong>charon.initiator_only</strong> [no]</p>
  </dt>
  <dd>
    <p>Causes charon daemon to ignore IKE initiation requests.</p>
  </dd>
  <dt>
    <p><strong>charon.install_routes</strong> [yes]</p>
  </dt>
  <dd>
    <p>Install routes into a separate routing table for established IPsec tunnels.</p>
  </dd>
  <dt>
    <p><strong>charon.install_virtual_ip</strong> [yes]</p>
  </dt>
  <dd>
    <p>Install virtual IP addresses.</p>
  </dd>
  <dt>
    <p><strong>charon.install_virtual_ip_on</strong> []</p>
  </dt>
  <dd>
    <p>The name of the interface on which virtual IP addresses should be installed. If not specified the addresses will be installed on the outbound interface.</p>
  </dd>
  <dt>
    <p><strong>charon.integrity_test</strong> [no]</p>
  </dt>
  <dd>
    <p>Check daemon, libstrongswan and plugin integrity at startup.</p>
  </dd>
  <dt>
    <p><strong>charon.interfaces_ignore</strong> []</p>
  </dt>
  <dd>
    <p>A comma-separated list of network interfaces that should be ignored, if <strong>interfaces_use</strong> is specified this option has no effect.</p>
  </dd>
  <dt>
    <p><strong>charon.interfaces_use</strong> []</p>
  </dt>
  <dd>
    <p>A comma-separated list of network interfaces that should be used by charon. All other interfaces are ignored.</p>
  </dd>
  <dt>
    <p><strong>charon.keep_alive</strong> [20s]</p>
  </dt>
  <dd>
    <p>NAT keep alive interval.</p>
  </dd>
  <dt>
    <p><strong>charon.leak_detective.detailed</strong> [yes]</p>
  </dt>
  <dd>
    <p>Includes source file names and line numbers in leak detective output.</p>
  </dd>
  <dt>
    <p><strong>charon.leak_detective.usage_threshold</strong> [10240]</p>
  </dt>
  <dd>
    <p>Threshold in bytes for leaks to be reported (0 to report all).</p>
  </dd>
  <dt>
    <p><strong>charon.leak_detective.usage_threshold_count</strong> [0]</p>
  </dt>
  <dd>
    <p>Threshold in number of allocations for leaks to be reported (0 to report all).</p>
  </dd>
  <dt>
    <p><strong>charon.load</strong> []</p>
  </dt>
  <dd>
    <p>Plugins to load in the IKE daemon charon.</p>
  </dd>
  <dt>
    <p><strong>charon.load_modular</strong> [no]</p>
  </dt>
  <dd>
    <p>If enabled, the list of plugins to load is determined via the value of the <em>charon.plugins.&lt;name&gt;.load</em> options.  In addition to a simple boolean flag that option may take an integer value indicating the priority of a plugin, which would influence the order of a plugin in the plugin list (the default is 1). If two plugins have the same priority their order in the default plugin list is preserved. Enabled plugins not found in that list are ordered alphabetically before other plugins with the same priority.</p>
  </dd>
  <dt>
    <p><strong>charon.max_packet</strong> [10000]</p>
  </dt>
  <dd>
    <p>Maximum packet size accepted by charon.</p>
  </dd>
  <dt>
    <p><strong>charon.multiple_authentication</strong> [yes]</p>
  </dt>
  <dd>
    <p>Enable multiple authentication exchanges (RFC 4739).</p>
  </dd>
  <dt>
    <p><strong>charon.nbns1</strong> []</p>
  </dt>
  <dd>
    <p>WINS servers assigned to peer via configuration payload (CP).</p>
  </dd>
  <dt>
    <p><strong>charon.nbns2</strong> []</p>
  </dt>
  <dd>
    <p>WINS servers assigned to peer via configuration payload (CP).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.android_log.loglevel</strong> [1]</p>
  </dt>
  <dd>
    <p>Loglevel for logging to Android specific logger.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.attr</strong></p>
  </dt>
  <dd>
    <p>Section to specify arbitrary attributes that are assigned to a peer via configuration payload (CP).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.attr.&lt;attr&gt;</strong> []</p>
  </dt>
  <dd>
    <p><strong>&lt;attr&gt;</strong> can be either <em>address</em>, <em>netmask</em>, <em>dns</em>, <em>nbns</em>, <em>dhcp</em>, <em>subnet</em>, <em>split-include</em>, <em>split-exclude</em> or the numeric identifier of the attribute type. The assigned value can be an IPv4/IPv6 address, a subnet in CIDR notation or an arbitrary value depending on the attribute type.  For some attribute types multiple values may be specified as a comma separated list.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.attr-sql.database</strong> []</p>
  </dt>
  <dd>
    <p>Database URI for attr-sql plugin used by charon. If it contains a password, make sure to adjust the permissions of the config file accordingly.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.attr-sql.lease_history</strong> [yes]</p>
  </dt>
  <dd>
    <p>Enable logging of SQL IP pool leases.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.certexpire.csv.cron</strong> []</p>
  </dt>
  <dd>
    <p>Cron style string specifying CSV export times.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.certexpire.csv.empty_string</strong> []</p>
  </dt>
  <dd>
    <p>String to use in empty intermediate CA fields.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.certexpire.csv.fixed_fields</strong> [yes]</p>
  </dt>
  <dd>
    <p>Use a fixed intermediate CA field count.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.certexpire.csv.force</strong> [yes]</p>
  </dt>
  <dd>
    <p>Force export of all trustchains we have a private key for.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.certexpire.csv.format</strong> [%d:%m:%Y]</p>
  </dt>
  <dd>
    <p><a href="../man3/strftime.3.html"><strong>strftime</strong>(3)</a> format string to export expiration dates as.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.certexpire.csv.local</strong> []</p>
  </dt>
  <dd>
    <p><a href="../man3/strftime.3.html"><strong>strftime</strong>(3)</a> format string for the CSV file name to export local certificates to.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.certexpire.csv.remote</strong> []</p>
  </dt>
  <dd>
    <p><a href="../man3/strftime.3.html"><strong>strftime</strong>(3)</a> format string for the CSV file name to export remote certificates to.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.certexpire.csv.separator</strong> [,]</p>
  </dt>
  <dd>
    <p>CSV field separator.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.coupling.file</strong> []</p>
  </dt>
  <dd>
    <p>File to store coupling list to.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.coupling.hash</strong> [sha1]</p>
  </dt>
  <dd>
    <p>Hashing algorithm to fingerprint coupled certificates.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.coupling.max</strong> [1]</p>
  </dt>
  <dd>
    <p>Maximum number of coupling entries to create.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.dhcp.force_server_address</strong> [no]</p>
  </dt>
  <dd>
    <p>Always use the configured server address. This might be helpful if the DHCP server runs on the same host as strongSwan, and the DHCP daemon does not listen on the loopback interface.  In that case the server cannot be reached via unicast (or even 255.255.255.255) as that would be routed via loopback. Setting this option to yes and configuring the local broadcast address (e.g. 192.168.0.255) as server address might work.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.dhcp.identity_lease</strong> [no]</p>
  </dt>
  <dd>
    <p>Derive user-defined MAC address from hash of IKE identity.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.dhcp.interface</strong> []</p>
  </dt>
  <dd>
    <p>Interface name the plugin uses for address allocation. The default is to bind to any (0.0.0.0) and let the system decide which way to route the packets to the DHCP server.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.dhcp.server</strong> [255.255.255.255]</p>
  </dt>
  <dd>
    <p>DHCP server unicast or broadcast IP address.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.dnscert.enable</strong> [no]</p>
  </dt>
  <dd>
    <p>Enable fetching of CERT RRs via DNS.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.duplicheck.enable</strong> [yes]</p>
  </dt>
  <dd>
    <p>Enable duplicheck plugin (if loaded).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.duplicheck.socket</strong> [unix://${piddir}/charon.dck]</p>
  </dt>
  <dd>
    <p>Socket provided by the duplicheck plugin.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-aka.request_identity</strong> [yes]</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-aka-3ggp2.seq_check</strong> []</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-dynamic.prefer_user</strong> [no]</p>
  </dt>
  <dd>
    <p>If enabled the EAP methods proposed in an EAP-Nak message sent by the peer are preferred over the methods registered locally.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-dynamic.preferred</strong> []</p>
  </dt>
  <dd>
    <p>The preferred EAP method(s) to be used.  If it is not given the first registered method will be used initially.  If a comma separated list is given the methods are tried in the given order before trying the rest of the registered methods.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-gtc.backend</strong> [pam]</p>
  </dt>
  <dd>
    <p>XAuth backend to be used for credential verification.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-peap.fragment_size</strong> [1024]</p>
  </dt>
  <dd>
    <p>Maximum size of an EAP-PEAP packet.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-peap.include_length</strong> [no]</p>
  </dt>
  <dd>
    <p>Include length in non-fragmented EAP-PEAP packets.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-peap.max_message_count</strong> [32]</p>
  </dt>
  <dd>
    <p>Maximum number of processed EAP-PEAP packets (0 = no limit).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-peap.phase2_method</strong> [mschapv2]</p>
  </dt>
  <dd>
    <p>Phase2 EAP client authentication method.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-peap.phase2_piggyback</strong> [no]</p>
  </dt>
  <dd>
    <p>Phase2 EAP Identity request piggybacked by server onto TLS Finished message.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-peap.phase2_tnc</strong> [no]</p>
  </dt>
  <dd>
    <p>Start phase2 EAP TNC protocol after successful client authentication.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-peap.request_peer_auth</strong> [no]</p>
  </dt>
  <dd>
    <p>Request peer authentication based on a client certificate.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.accounting</strong> [no]</p>
  </dt>
  <dd>
    <p>Send RADIUS accounting information to RADIUS servers.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.accounting_close_on_timeout</strong> [yes]</p>
  </dt>
  <dd>
    <p>Close the IKE_SA if there is a timeout during interim RADIUS accounting updates.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.accounting_interval</strong> [0]</p>
  </dt>
  <dd>
    <p>Interval for interim RADIUS accounting updates, if not specified by the RADIUS server in the Access-Accept message.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.accounting_requires_vip</strong> [no]</p>
  </dt>
  <dd>
    <p>If enabled, accounting is disabled unless an IKE_SA has at least one virtual IP.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.class_group</strong> [no]</p>
  </dt>
  <dd>
    <p>Use the <em>class</em> attribute sent in the RADIUS-Accept message as group membership information that is compared to the groups specified in the <strong>rightgroups</strong> option in <a href="../man5/ipsec.conf.5.html"><strong>ipsec.conf</strong>(5)</a>.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.close_all_on_timeout</strong> [no]</p>
  </dt>
  <dd>
    <p>Closes all IKE_SAs if communication with the RADIUS server times out. If it is not set only the current IKE_SA is closed.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.dae.enable</strong> [no]</p>
  </dt>
  <dd>
    <p>Enables support for the Dynamic Authorization Extension (RFC 5176).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.dae.listen</strong> [0.0.0.0]</p>
  </dt>
  <dd>
    <p>Address to listen for DAE messages from the RADIUS server.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.dae.port</strong> [3799]</p>
  </dt>
  <dd>
    <p>Port to listen for DAE requests.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.dae.secret</strong> []</p>
  </dt>
  <dd>
    <p>Shared secret used to verify/sign DAE messages. If set, make sure to adjust the permissions of the config file accordingly.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.eap_start</strong> [no]</p>
  </dt>
  <dd>
    <p>Send EAP-Start instead of EAP-Identity to start RADIUS conversation.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.filter_id</strong> [no]</p>
  </dt>
  <dd>
    <p>If the RADIUS <em>tunnel_type</em> attribute with value <strong>ESP</strong> is received, use the <em>filter_id</em> attribute sent in the RADIUS-Accept message as group membership information that is compared to the groups specified in the <strong>rightgroups</strong> option in <a href="../man5/ipsec.conf.5.html"><strong>ipsec.conf</strong>(5)</a>.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.forward.ike_to_radius</strong> []</p>
  </dt>
  <dd>
    <p>RADIUS attributes to be forwarded from IKEv2 to RADIUS (can be defined by name or attribute number, a colon can be used to specify vendor-specific attributes, e.g. Reply-Message, or 11, or 36906:12).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.forward.radius_to_ike</strong> []</p>
  </dt>
  <dd>
    <p>Same as <em>charon.plugins.eap-radius.forward.ike_to_radius</em> but from RADIUS to IKEv2, a strongSwan specific private notify (40969) is used to transmit the attributes.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.id_prefix</strong> []</p>
  </dt>
  <dd>
    <p>Prefix to EAP-Identity, some AAA servers use a IMSI prefix to select the EAP method.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.nas_identifier</strong> [strongSwan]</p>
  </dt>
  <dd>
    <p>NAS-Identifier to include in RADIUS messages.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.port</strong> [1812]</p>
  </dt>
  <dd>
    <p>Port of RADIUS server (authentication).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.secret</strong> []</p>
  </dt>
  <dd>
    <p>Shared secret between RADIUS and NAS. If set, make sure to adjust the permissions of the config file accordingly.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.server</strong> []</p>
  </dt>
  <dd>
    <p>IP/Hostname of RADIUS server.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.servers</strong></p>
  </dt>
  <dd>
    <p>Section to specify multiple RADIUS servers. The <strong>nas_identifier</strong>, <strong>secret</strong>, <strong>sockets</strong> and <strong>port</strong> (or <strong>auth_port</strong>) options can be specified for each server. A server's IP/Hostname can be configured using the <strong>address</strong> option. The <strong>acct_port</strong> [1813] option can be used to specify the port used for RADIUS accounting. For each RADIUS server a priority can be specified using the <strong>preference</strong> [0] option.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.sockets</strong> [1]</p>
  </dt>
  <dd>
    <p>Number of sockets (ports) to use, increase for high load.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-radius.xauth</strong></p>
  </dt>
  <dd>
    <p>Section to configure multiple XAuth authentication rounds via RADIUS. The subsections define so called authentication profiles with arbitrary names. In each profile section one or more XAuth types can be configured, with an assigned message. For each type a separate XAuth exchange will be initiated and all replies get concatenated into the User-Password attribute, which then gets verified over RADIUS.</p><p>Available XAuth types are <strong>password</strong>, <strong>passcode</strong>, <strong>nextpin</strong>, and <strong>answer</strong>. This type is not relevant to strongSwan or the AAA server, but the client may show a different dialog (along with the configured message).</p><p>To use the configured profiles, they have to be configured in the respective connection in <a href="../man5/ipsec.conf.5.html"><strong>ipsec.conf</strong>(5)</a> by appending the profile name, separated by a colon, to the <strong>xauth-radius</strong> XAauth backend configuration in <em>rightauth</em> or <em>rightauth2</em>, for instance, <em>rightauth2=xauth-radius:profile</em>.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-sim.request_identity</strong> [yes]</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-simaka-sql.database</strong> []</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-simaka-sql.remove_used</strong> [no]</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-tls.fragment_size</strong> [1024]</p>
  </dt>
  <dd>
    <p>Maximum size of an EAP-TLS packet.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-tls.include_length</strong> [yes]</p>
  </dt>
  <dd>
    <p>Include length in non-fragmented EAP-TLS packets.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-tls.max_message_count</strong> [32]</p>
  </dt>
  <dd>
    <p>Maximum number of processed EAP-TLS packets (0 = no limit).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-tnc.max_message_count</strong> [10]</p>
  </dt>
  <dd>
    <p>Maximum number of processed EAP-TNC packets (0 = no limit).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-tnc.protocol</strong> [tnccs-2.0]</p>
  </dt>
  <dd>
    <p>IF-TNCCS protocol version to be used (<em>tnccs-1.1</em>, <em>tnccs-2.0</em>, <em>tnccs-dynamic</em>).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-ttls.fragment_size</strong> [1024]</p>
  </dt>
  <dd>
    <p>Maximum size of an EAP-TTLS packet.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-ttls.include_length</strong> [yes]</p>
  </dt>
  <dd>
    <p>Include length in non-fragmented EAP-TTLS packets.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-ttls.max_message_count</strong> [32]</p>
  </dt>
  <dd>
    <p>Maximum number of processed EAP-TTLS packets (0 = no limit).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-ttls.phase2_method</strong> [md5]</p>
  </dt>
  <dd>
    <p>Phase2 EAP client authentication method.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-ttls.phase2_piggyback</strong> [no]</p>
  </dt>
  <dd>
    <p>Phase2 EAP Identity request piggybacked by server onto TLS Finished message.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-ttls.phase2_tnc</strong> [no]</p>
  </dt>
  <dd>
    <p>Start phase2 EAP TNC protocol after successful client authentication.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-ttls.phase2_tnc_method</strong> [pt]</p>
  </dt>
  <dd>
    <p>Phase2 EAP TNC transport protocol (<em>pt</em> as IETF standard or legacy <em>tnc</em>)</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.eap-ttls.request_peer_auth</strong> [no]</p>
  </dt>
  <dd>
    <p>Request peer authentication based on a client certificate.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.error-notify.socket</strong> [unix://${piddir}/charon.enfy]</p>
  </dt>
  <dd>
    <p>Socket provided by the error-notify plugin.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.ext-auth.script</strong> []</p>
  </dt>
  <dd>
    <p>Command to pass to the system shell for peer authorization. Authorization is considered successful if the command executes normally with an exit code of zero. For all other exit codes IKE_SA authorization is rejected.</p><p>The following environment variables get passed to the script: <em>IKE_UNIQUE_ID</em>: The IKE_SA numerical unique identifier. <em>IKE_NAME</em>: The peer configuration connection name. <em>IKE_LOCAL_HOST</em>: Local IKE IP address. <em>IKE_REMOTE_HOST</em>: Remote IKE IP address. <em>IKE_LOCAL_ID</em>: Local IKE identity. <em>IKE_REMOTE_ID</em>: Remote IKE identity. <em>IKE_REMOTE_EAP_ID</em>: Remote EAP or XAuth identity, if used.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.gcrypt.quick_random</strong> [no]</p>
  </dt>
  <dd>
    <p>Use faster random numbers in gcrypt; for testing only, produces weak keys!</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.ha.autobalance</strong> [0]</p>
  </dt>
  <dd>
    <p>Interval in seconds to automatically balance handled segments between nodes. Set to 0 to disable.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.ha.fifo_interface</strong> [yes]</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.ha.heartbeat_delay</strong> [1000]</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.ha.heartbeat_timeout</strong> [2100]</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.ha.local</strong> []</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.ha.monitor</strong> [yes]</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.ha.pools</strong> []</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.ha.remote</strong> []</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.ha.resync</strong> [yes]</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.ha.secret</strong> []</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.ha.segment_count</strong> [1]</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.ipseckey.enable</strong> [no]</p>
  </dt>
  <dd>
    <p>Enable fetching of IPSECKEY RRs via DNS.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.kernel-libipsec.allow_peer_ts</strong> [no]</p>
  </dt>
  <dd>
    <p>Allow that the remote traffic selector equals the IKE peer. The route installed for such traffic (via TUN device) usually prevents further IKE traffic. The fwmark options for the <em>kernel-netlink</em> and <em>socket-default</em> plugins can be used to circumvent that problem.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.kernel-netlink.fwmark</strong> []</p>
  </dt>
  <dd>
    <p>Firewall mark to set on the routing rule that directs traffic to our routing table. The format is [!]mark[/mask], where the optional exclamation mark inverts the meaning (i.e. the rule only applies to packets that don't match the mark).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.kernel-netlink.mss</strong> [0]</p>
  </dt>
  <dd>
    <p>MSS to set on installed routes, 0 to disable.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.kernel-netlink.mtu</strong> [0]</p>
  </dt>
  <dd>
    <p>MTU to set on installed routes, 0 to disable.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.kernel-netlink.roam_events</strong> [yes]</p>
  </dt>
  <dd>
    <p>Whether to trigger roam events when interfaces, addresses or routes change.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.kernel-netlink.set_proto_port_transport_sa</strong> [no]</p>
  </dt>
  <dd>
    <p>Whether to set protocol and ports in the selector installed on transport mode IPsec SAs in the kernel. While doing so enforces policies for inbound traffic, it also prevents the use of a single IPsec SA by more than one traffic selector.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.kernel-netlink.xfrm_acq_expires</strong> [165]</p>
  </dt>
  <dd>
    <p>Lifetime of XFRM acquire state in kernel. The value gets written to /proc/sys/net/core/xfrm_acq_expires. Indirectly controls the delay of XFRM acquire messages sent.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.kernel-pfroute.vip_wait</strong> [1000]</p>
  </dt>
  <dd>
    <p>Time in ms to wait until virtual IP addresses appear/disappear before failing.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.led.activity_led</strong> []</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.led.blink_time</strong> [50]</p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester</strong></p>
  </dt>
  <dd>
    <p>Section to configure the load-tester plugin, see LOAD TESTS in <a href="../man5/strongswan.conf.5.html"><strong>strongswan.conf</strong>(5)</a> for details.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.addrs</strong></p>
  </dt>
  <dd>
    <p>Section that contains key/value pairs with address pools (in CIDR notation) to use for a specific network interface e.g. eth0 = 10.10.0.0/16.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.addrs_keep</strong> [no]</p>
  </dt>
  <dd>
    <p>Whether to keep dynamic addresses even after the associated SA got terminated.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.addrs_prefix</strong> [16]</p>
  </dt>
  <dd>
    <p>Network prefix length to use when installing dynamic addresses. If set to -1 the full address is used (i.e. 32 or 128).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.ca_dir</strong> []</p>
  </dt>
  <dd>
    <p>Directory to load (intermediate) CA certificates from.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.child_rekey</strong> [600]</p>
  </dt>
  <dd>
    <p>Seconds to start CHILD_SA rekeying after setup.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.crl</strong> []</p>
  </dt>
  <dd>
    <p>URI to a CRL to include as certificate distribution point in generated certificates.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.delay</strong> [0]</p>
  </dt>
  <dd>
    <p>Delay between initiatons for each thread.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.delete_after_established</strong> [no]</p>
  </dt>
  <dd>
    <p>Delete an IKE_SA as soon as it has been established.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.digest</strong> [sha1]</p>
  </dt>
  <dd>
    <p>Digest algorithm used when issuing certificates.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.dpd_delay</strong> [0]</p>
  </dt>
  <dd>
    <p>DPD delay to use in load test.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.dynamic_port</strong> [0]</p>
  </dt>
  <dd>
    <p>Base port to be used for requests (each client uses a different port).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.eap_password</strong> [default-pwd]</p>
  </dt>
  <dd>
    <p>EAP secret to use in load test.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.enable</strong> [no]</p>
  </dt>
  <dd>
    <p>Enable the load testing plugin. <strong>WARNING</strong>: Never enable this plugin on productive systems. It provides preconfigured credentials and allows an attacker to authenticate as any user.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.esp</strong> [aes128-sha1]</p>
  </dt>
  <dd>
    <p>CHILD_SA proposal to use for load tests.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.fake_kernel</strong> [no]</p>
  </dt>
  <dd>
    <p>Fake the kernel interface to allow load-testing against self.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.ike_rekey</strong> [0]</p>
  </dt>
  <dd>
    <p>Seconds to start IKE_SA rekeying after setup.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.init_limit</strong> [0]</p>
  </dt>
  <dd>
    <p>Global limit of concurrently established SAs during load test.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.initiator</strong> [0.0.0.0]</p>
  </dt>
  <dd>
    <p>Address to initiate from.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.initiator_auth</strong> [pubkey]</p>
  </dt>
  <dd>
    <p>Authentication method(s) the intiator uses.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.initiator_id</strong> []</p>
  </dt>
  <dd>
    <p>Initiator ID used in load test.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.initiator_match</strong> []</p>
  </dt>
  <dd>
    <p>Initiator ID to match against as responder.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.initiator_tsi</strong> []</p>
  </dt>
  <dd>
    <p>Traffic selector on initiator side, as proposed by initiator.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.initiator_tsr</strong> []</p>
  </dt>
  <dd>
    <p>Traffic selector on responder side, as proposed by initiator.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.initiators</strong> [0]</p>
  </dt>
  <dd>
    <p>Number of concurrent initiator threads to use in load test.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.issuer_cert</strong> []</p>
  </dt>
  <dd>
    <p>Path to the issuer certificate (if not configured a hard-coded default value is used).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.issuer_key</strong> []</p>
  </dt>
  <dd>
    <p>Path to private key that is used to issue certificates (if not configured a hard-coded default value is used).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.iterations</strong> [1]</p>
  </dt>
  <dd>
    <p>Number of IKE_SAs to initiate by each initiator in load test.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.mode</strong> [tunnel]</p>
  </dt>
  <dd>
    <p>IPsec mode to use, one of <em>tunnel</em>, <em>transport</em>, or <em>beet</em>.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.pool</strong> []</p>
  </dt>
  <dd>
    <p>Provide INTERNAL_IPV4_ADDRs from a named pool.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.preshared_key</strong> [&lt;default-psk&gt;]</p>
  </dt>
  <dd>
    <p>Preshared key to use in load test.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.proposal</strong> [aes128-sha1-modp768]</p>
  </dt>
  <dd>
    <p>IKE proposal to use in load test.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.request_virtual_ip</strong> [no]</p>
  </dt>
  <dd>
    <p>Request an INTERNAL_IPV4_ADDR from the server.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.responder</strong> [127.0.0.1]</p>
  </dt>
  <dd>
    <p>Address to initiation connections to.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.responder_auth</strong> [pubkey]</p>
  </dt>
  <dd>
    <p>Authentication method(s) the responder uses.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.responder_id</strong> []</p>
  </dt>
  <dd>
    <p>Responder ID used in load test.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.responder_tsi</strong> [initiator_tsi]</p>
  </dt>
  <dd>
    <p>Traffic selector on initiator side, as narrowed by responder.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.responder_tsr</strong> [initiator_tsr]</p>
  </dt>
  <dd>
    <p>Traffic selector on responder side, as narrowed by responder.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.shutdown_when_complete</strong> [no]</p>
  </dt>
  <dd>
    <p>Shutdown the daemon after all IKE_SAs have been established.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.socket</strong> [unix://${piddir}/charon.ldt]</p>
  </dt>
  <dd>
    <p>Socket provided by the load-tester plugin.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.load-tester.version</strong> [0]</p>
  </dt>
  <dd>
    <p>IKE version to use (0 means use IKEv2 as initiator and accept any version as responder).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.lookip.socket</strong> [unix://${piddir}/charon.lkp]</p>
  </dt>
  <dd>
    <p>Socket provided by the lookip plugin.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.ntru.max_drbg_requests</strong> [4294967294]</p>
  </dt>
  <dd>
    <p>Number of pseudo-random bit requests from the DRBG before an automatic reseeding occurs.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.ntru.parameter_set</strong> [optimum]</p>
  </dt>
  <dd>
    <p>The following parameter sets are available: <strong>x9_98_speed</strong>, <strong>x9_98_bandwidth</strong>, <strong>x9_98_balance</strong> and <strong>optimum</strong>, the last set not being part of the X9.98 standard but having the best performance.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.openssl.engine_id</strong> [pkcs11]</p>
  </dt>
  <dd>
    <p>ENGINE ID to use in the OpenSSL plugin.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.openssl.fips_mode</strong> [0]</p>
  </dt>
  <dd>
    <p>Set OpenSSL FIPS mode: <strong>disabled</strong>(0), <strong>enabled</strong>(1), Suite B <strong>enabled</strong>(2).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.pkcs11.load_certs</strong> [yes]</p>
  </dt>
  <dd>
    <p>Whether to load certificates from tokens.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.pkcs11.modules</strong></p>
  </dt>
  <dd>
    <p>List of available PKCS#11 modules.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.pkcs11.reload_certs</strong> [no]</p>
  </dt>
  <dd>
    <p>Reload certificates from all tokens if charon receives a SIGHUP.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.pkcs11.use_dh</strong> [no]</p>
  </dt>
  <dd>
    <p>Whether the PKCS#11 modules should be used for DH and ECDH (see <em>use_ecc</em> option).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.pkcs11.use_ecc</strong> [no]</p>
  </dt>
  <dd>
    <p>Whether the PKCS#11 modules should be used for ECDH and ECDSA public key operations. ECDSA private keys can be used regardless of this option.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.pkcs11.use_hasher</strong> [no]</p>
  </dt>
  <dd>
    <p>Whether the PKCS#11 modules should be used to hash data.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.pkcs11.use_pubkey</strong> [no]</p>
  </dt>
  <dd>
    <p>Whether the PKCS#11 modules should be used for public key operations, even for keys not stored on tokens.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.pkcs11.use_rng</strong> [no]</p>
  </dt>
  <dd>
    <p>Whether the PKCS#11 modules should be used as RNG.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.radattr.dir</strong> []</p>
  </dt>
  <dd>
    <p>Directory where RADIUS attributes are stored in client-ID specific files.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.radattr.message_id</strong> [-1]</p>
  </dt>
  <dd>
    <p>Attributes are added to all IKE_AUTH messages by default (-1), or only to the IKE_AUTH message with the given IKEv2 message ID.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.random.random</strong> [${random_device}]</p>
  </dt>
  <dd>
    <p>File to read random bytes from.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.random.strong_equals_true</strong> [no]</p>
  </dt>
  <dd>
    <p>If set to yes the RNG_STRONG class reads random bytes from the same source as the RNG_TRUE class.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.random.urandom</strong> [${urandom_device}]</p>
  </dt>
  <dd>
    <p>File to read pseudo random bytes from.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.resolve.file</strong> [/etc/resolv.conf]</p>
  </dt>
  <dd>
    <p>File where to add DNS server entries.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.resolve.resolvconf.iface_prefix</strong> [lo.inet.ipsec.]</p>
  </dt>
  <dd>
    <p>Prefix used for interface names sent to <a href="../man8/resolvconf.8.html"><strong>resolvconf</strong>(8)</a>. The nameserver address is appended to this prefix to make it unique.  The result has to be a valid interface name according to the rules defined by resolvconf.  Also, it should have a high priority according to the order defined in <a href="../man5/interface-order.5.html"><strong>interface-order</strong>(5)</a>.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.socket-default.fwmark</strong> []</p>
  </dt>
  <dd>
    <p>Firewall mark to set on outbound packets.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.socket-default.set_source</strong> [yes]</p>
  </dt>
  <dd>
    <p>Set source address on outbound packets, if possible.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.socket-default.use_ipv4</strong> [yes]</p>
  </dt>
  <dd>
    <p>Listen on IPv4, if possible.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.socket-default.use_ipv6</strong> [yes]</p>
  </dt>
  <dd>
    <p>Listen on IPv6, if possible.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.sql.database</strong> []</p>
  </dt>
  <dd>
    <p>Database URI for charon's SQL plugin. If it contains a password, make sure to adjust the permissions of the config file accordingly.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.sql.loglevel</strong> [-1]</p>
  </dt>
  <dd>
    <p>Loglevel for logging to SQL database.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.stroke.ignore_missing_ca_basic_constraint</strong> [no]</p>
  </dt>
  <dd>
    <p>Treat certificates in ipsec.d/cacerts and ipsec.conf ca sections as CA certificates even if they don't contain a CA basic constraint.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.stroke.max_concurrent</strong> [4]</p>
  </dt>
  <dd>
    <p>Maximum number of stroke messages handled concurrently.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.stroke.prevent_loglevel_changes</strong> [no]</p>
  </dt>
  <dd>
    <p>If enabled log level changes via stroke socket are not allowed.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.stroke.secrets_file</strong> [${sysconfdir}/ipsec.secrets]</p>
  </dt>
  <dd>
    <p>Location of the ipsec.secrets file</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.stroke.socket</strong> [unix://${piddir}/charon.ctl]</p>
  </dt>
  <dd>
    <p>Socket provided by the stroke plugin.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.stroke.timeout</strong> [0]</p>
  </dt>
  <dd>
    <p>Timeout in ms for any stroke command. Use 0 to disable the timeout.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.systime-fix.interval</strong> [0]</p>
  </dt>
  <dd>
    <p>Interval in seconds to check system time for validity. 0 disables the check.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.systime-fix.reauth</strong> [no]</p>
  </dt>
  <dd>
    <p>Whether to use reauth or delete if an invalid cert lifetime is detected.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.systime-fix.threshold</strong> []</p>
  </dt>
  <dd>
    <p>Threshold date where system time is considered valid. Disabled if not specified.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.systime-fix.threshold_format</strong> [%Y]</p>
  </dt>
  <dd>
    <p><a href="../man3/strptime.3.html"><strong>strptime</strong>(3)</a> format used to parse threshold option.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-ifmap.client_cert</strong> []</p>
  </dt>
  <dd>
    <p>Path to X.509 certificate file of IF-MAP client.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-ifmap.client_key</strong> []</p>
  </dt>
  <dd>
    <p>Path to private key file of IF-MAP client.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-ifmap.device_name</strong> []</p>
  </dt>
  <dd>
    <p>Unique name of strongSwan server as a PEP and/or PDP device.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-ifmap.renew_session_interval</strong> [150]</p>
  </dt>
  <dd>
    <p>Interval in seconds between periodic IF-MAP RenewSession requests.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-ifmap.server_cert</strong> []</p>
  </dt>
  <dd>
    <p>Path to X.509 certificate file of IF-MAP server.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-ifmap.server_uri</strong> [https://localhost:8444/imap]</p>
  </dt>
  <dd>
    <p>URI of the form [https://]servername[:port][/path].</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-ifmap.username_password</strong> []</p>
  </dt>
  <dd>
    <p>Credentials of IF-MAP client of the form username:password. If set, make sure to adjust the permissions of the config file accordingly.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-imc.dlclose</strong> [yes]</p>
  </dt>
  <dd>
    <p>Unload IMC after use.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-imc.preferred_language</strong> [en]</p>
  </dt>
  <dd>
    <p>Preferred language for TNC recommendations.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-imv.dlclose</strong> [yes]</p>
  </dt>
  <dd>
    <p>Unload IMV after use.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-imv.recommendation_policy</strong> [default]</p>
  </dt>
  <dd>
    <p>TNC recommendation policy, one of <em>default</em>, <em>any</em>, or <em>all</em>.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-pdp.pt_tls.enable</strong> [yes]</p>
  </dt>
  <dd>
    <p>Enable PT-TLS protocol on the strongSwan PDP.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-pdp.pt_tls.port</strong> [271]</p>
  </dt>
  <dd>
    <p>PT-TLS server port the strongSwan PDP is listening on.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-pdp.radius.enable</strong> [yes]</p>
  </dt>
  <dd>
    <p>Enable RADIUS protocol on the strongSwan PDP.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-pdp.radius.method</strong> [ttls]</p>
  </dt>
  <dd>
    <p>EAP tunnel method to be used.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-pdp.radius.port</strong> [1812]</p>
  </dt>
  <dd>
    <p>RADIUS server port the strongSwan PDP is listening on.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-pdp.radius.secret</strong> []</p>
  </dt>
  <dd>
    <p>Shared RADIUS secret between strongSwan PDP and NAS. If set, make sure to adjust the permissions of the config file accordingly.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-pdp.server</strong> []</p>
  </dt>
  <dd>
    <p>Name of the strongSwan PDP as contained in the AAA certificate.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnc-pdp.timeout</strong> []</p>
  </dt>
  <dd>
    <p>Timeout in seconds before closing incomplete connections.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnccs-11.max_message_size</strong> [45000]</p>
  </dt>
  <dd>
    <p>Maximum size of a PA-TNC message (XML & Base64 encoding).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnccs-20.max_batch_size</strong> [65522]</p>
  </dt>
  <dd>
    <p>Maximum size of a PB-TNC batch (upper limit via PT-EAP = 65529).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.tnccs-20.max_message_size</strong> [65490]</p>
  </dt>
  <dd>
    <p>Maximum size of a PA-TNC message (upper limit via PT-EAP = 65497).</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.unbound.dlv_anchors</strong> []</p>
  </dt>
  <dd>
    <p>File to read trusted keys for DLV (DNSSEC Lookaside Validation) from. It uses the same format as <em>trust_anchors</em>. Only one DLV can be configured, which is then used as a root trusted DLV, this means that it is a lookaside for the root.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.unbound.resolv_conf</strong> [/etc/resolv.conf]</p>
  </dt>
  <dd>
    <p>File to read DNS resolver configuration from.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.unbound.trust_anchors</strong> [/etc/ipsec.d/dnssec.keys]</p>
  </dt>
  <dd>
    <p>File to read DNSSEC trust anchors from (usually root zone KSK). The format of the file is the standard DNS Zone file format, anchors can be stored as DS or DNSKEY entries in the file.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.updown.dns_handler</strong> [no]</p>
  </dt>
  <dd>
    <p>Whether the updown script should handle DNS servers assigned via IKEv1 Mode Config or IKEv2 Config Payloads (if enabled they can't be handled by other plugins, like resolve)</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.vici.socket</strong> [unix://${piddir}/charon.vici]</p>
  </dt>
  <dd>
    <p>Socket the vici plugin serves clients.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.whitelist.enable</strong> [yes]</p>
  </dt>
  <dd>
    <p>Enable loaded whitelist plugin.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.whitelist.socket</strong> [unix://${piddir}/charon.wlst]</p>
  </dt>
  <dd>
    <p>Socket provided by the whitelist plugin.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.xauth-eap.backend</strong> [radius]</p>
  </dt>
  <dd>
    <p>EAP plugin to be used as backend for XAuth credential verification.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.xauth-pam.pam_service</strong> [login]</p>
  </dt>
  <dd>
    <p>PAM service to be used for authentication.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.xauth-pam.session</strong> [no]</p>
  </dt>
  <dd>
    <p>Open/close a PAM session for each active IKE_SA.</p>
  </dd>
  <dt>
    <p><strong>charon.plugins.xauth-pam.trim_email</strong> [yes]</p>
  </dt>
  <dd>
    <p>If an email address is received as an XAuth username, trim it to just the username part.</p>
  </dd>
  <dt>
    <p><strong>charon.port</strong> [500]</p>
  </dt>
  <dd>
    <p>UDP port used locally. If set to 0 a random port will be allocated.</p>
  </dd>
  <dt>
    <p><strong>charon.port_nat_t</strong> [4500]</p>
  </dt>
  <dd>
    <p>UDP port used locally in case of NAT-T. If set to 0 a random port will be allocated.  Has to be different from <strong>charon.port</strong>, otherwise a random port will be allocated.</p>
  </dd>
  <dt>
    <p><strong>charon.prefer_temporary_addrs</strong> [no]</p>
  </dt>
  <dd>
    <p>By default public IPv6 addresses are preferred over temporary ones (RFC 4941), to make connections more stable. Enable this option to reverse this.</p>
  </dd>
  <dt>
    <p><strong>charon.process_route</strong> [yes]</p>
  </dt>
  <dd>
    <p>Process RTM_NEWROUTE and RTM_DELROUTE events.</p>
  </dd>
  <dt>
    <p><strong>charon.processor.priority_threads</strong></p>
  </dt>
  <dd>
    <p>Section to configure the number of reserved threads per priority class see JOB PRIORITY MANAGEMENT in <a href="../man5/strongswan.conf.5.html"><strong>strongswan.conf</strong>(5)</a>.</p>
  </dd>
  <dt>
    <p><strong>charon.receive_delay</strong> [0]</p>
  </dt>
  <dd>
    <p>Delay in ms for receiving packets, to simulate larger RTT.</p>
  </dd>
  <dt>
    <p><strong>charon.receive_delay_request</strong> [yes]</p>
  </dt>
  <dd>
    <p>Delay request messages.</p>
  </dd>
  <dt>
    <p><strong>charon.receive_delay_response</strong> [yes]</p>
  </dt>
  <dd>
    <p>Delay response messages.</p>
  </dd>
  <dt>
    <p><strong>charon.receive_delay_type</strong> [0]</p>
  </dt>
  <dd>
    <p>Specific IKEv2 message type to delay, 0 for any.</p>
  </dd>
  <dt>
    <p><strong>charon.replay_window</strong> [32]</p>
  </dt>
  <dd>
    <p>Size of the AH/ESP replay window, in packets.</p>
  </dd>
  <dt>
    <p><strong>charon.retransmit_base</strong> [1.8]</p>
  </dt>
  <dd>
    <p>Base to use for calculating exponential back off, see IKEv2 RETRANSMISSION in <a href="../man5/strongswan.conf.5.html"><strong>strongswan.conf</strong>(5)</a>.</p>
  </dd>
  <dt>
    <p><strong>charon.retransmit_timeout</strong> [4.0]</p>
  </dt>
  <dd>
    <p>Timeout in seconds before sending first retransmit.</p>
  </dd>
  <dt>
    <p><strong>charon.retransmit_tries</strong> [5]</p>
  </dt>
  <dd>
    <p>Number of times to retransmit a packet before giving up.</p>
  </dd>
  <dt>
    <p><strong>charon.retry_initiate_interval</strong> [0]</p>
  </dt>
  <dd>
    <p>Interval to use when retrying to initiate an IKE_SA (e.g. if DNS resolution failed), 0 to disable retries.</p>
  </dd>
  <dt>
    <p><strong>charon.reuse_ikesa</strong> [yes]</p>
  </dt>
  <dd>
    <p>Initiate CHILD_SA within existing IKE_SAs.</p>
  </dd>
  <dt>
    <p><strong>charon.routing_table</strong> []</p>
  </dt>
  <dd>
    <p>Numerical routing table to install routes to.</p>
  </dd>
  <dt>
    <p><strong>charon.routing_table_prio</strong> []</p>
  </dt>
  <dd>
    <p>Priority of the routing table.</p>
  </dd>
  <dt>
    <p><strong>charon.send_delay</strong> [0]</p>
  </dt>
  <dd>
    <p>Delay in ms for sending packets, to simulate larger RTT.</p>
  </dd>
  <dt>
    <p><strong>charon.send_delay_request</strong> [yes]</p>
  </dt>
  <dd>
    <p>Delay request messages.</p>
  </dd>
  <dt>
    <p><strong>charon.send_delay_response</strong> [yes]</p>
  </dt>
  <dd>
    <p>Delay response messages.</p>
  </dd>
  <dt>
    <p><strong>charon.send_delay_type</strong> [0]</p>
  </dt>
  <dd>
    <p>Specific IKEv2 message type to delay, 0 for any.</p>
  </dd>
  <dt>
    <p><strong>charon.send_vendor_id</strong> [no]</p>
  </dt>
  <dd>
    <p>Send strongSwan vendor ID payload</p>
  </dd>
  <dt>
    <p><strong>charon.start-scripts</strong></p>
  </dt>
  <dd>
    <p>Section containing a list of scripts (name = path) that are executed when the daemon is started.</p>
  </dd>
  <dt>
    <p><strong>charon.stop-scripts</strong></p>
  </dt>
  <dd>
    <p>Section containing a list of scripts (name = path) that are executed when the daemon is terminated.</p>
  </dd>
  <dt>
    <p><strong>charon.syslog</strong></p>
  </dt>
  <dd>
    <p>Section to define syslog loggers, see LOGGER CONFIGURATION in <a href="../man5/strongswan.conf.5.html"><strong>strongswan.conf</strong>(5)</a>.</p>
  </dd>
  <dt>
    <p><strong>charon.syslog.&lt;facility&gt;</strong></p>
  </dt>
  <dd>
    <p>&lt;facility&gt; is one of the supported syslog facilities, see LOGGER CONFIGURATION in <a href="../man5/strongswan.conf.5.html"><strong>strongswan.conf</strong>(5)</a>.</p>
  </dd>
  <dt>
    <p><strong>charon.syslog.&lt;facility&gt;.&lt;subsystem&gt;</strong> [&lt;default&gt;]</p>
  </dt>
  <dd>
    <p>Loglevel for a specific subsystem.</p>
  </dd>
  <dt>
    <p><strong>charon.syslog.&lt;facility&gt;.default</strong> [1]</p>
  </dt>
  <dd>
    <p>Specifies the default loglevel to be used for subsystems for which no specific loglevel is defined.</p>
  </dd>
  <dt>
    <p><strong>charon.syslog.&lt;facility&gt;.ike_name</strong> [no]</p>
  </dt>
  <dd>
    <p>Prefix each log entry with the connection name and a unique numerical identifier for each IKE_SA.</p>
  </dd>
  <dt>
    <p><strong>charon.syslog.identifier</strong> []</p>
  </dt>
  <dd>
    <p>Global identifier used for an <a href="../man3/openlog.3.html"><strong>openlog</strong>(3)</a> call, prepended to each log message by syslog.  If not configured, <a href="../man3/openlog.3.html"><strong>openlog</strong>(3)</a> is not called, so the value will depend on system defaults (often the program name).</p>
  </dd>
  <dt>
    <p><strong>charon.threads</strong> [16]</p>
  </dt>
  <dd>
    <p>Number of worker threads in charon. Several of these are reserved for long running tasks in internal modules and plugins. Therefore, make sure you don't set this value too low. The number of idle worker threads listed in <em>ipsec statusall</em> might be used as indicator on the number of reserved threads.</p>
  </dd>
  <dt>
    <p><strong>charon.tls.cipher</strong> []</p>
  </dt>
  <dd>
    <p>List of TLS encryption ciphers.</p>
  </dd>
  <dt>
    <p><strong>charon.tls.key_exchange</strong> []</p>
  </dt>
  <dd>
    <p>List of TLS key exchange methods.</p>
  </dd>
  <dt>
    <p><strong>charon.tls.mac</strong> []</p>
  </dt>
  <dd>
    <p>List of TLS MAC algorithms.</p>
  </dd>
  <dt>
    <p><strong>charon.tls.suites</strong> []</p>
  </dt>
  <dd>
    <p>List of TLS cipher suites.</p>
  </dd>
  <dt>
    <p><strong>charon.tnc.tnc_config</strong> [/etc/tnc_config]</p>
  </dt>
  <dd>
    <p>TNC IMC/IMV configuration file.</p>
  </dd>
  <dt>
    <p><strong>charon.user</strong> []</p>
  </dt>
  <dd>
    <p>Name of the user the daemon changes to after startup.</p>
  </dd>
  <dt>
    <p><strong>charon.x509.enforce_critical</strong> [yes]</p>
  </dt>
  <dd>
    <p>Discard certificates with unsupported or unknown critical extensions.</p>
  </dd>
  <dt>
    <p><strong>charon-systemd.journal</strong></p>
  </dt>
  <dd>
    <p>Section to configure native systemd journal logger, very similar to the syslog logger as described in LOGGER CONFIGURATION in <a href="../man5/strongswan.conf.5.html"><strong>strongswan.conf</strong>(5)</a>.</p>
  </dd>
  <dt>
    <p><strong>charon-systemd.journal.&lt;subsystem&gt;</strong> [&lt;default&gt;]</p>
  </dt>
  <dd>
    <p>Loglevel for a specific subsystem.</p>
  </dd>
  <dt>
    <p><strong>charon-systemd.journal.default</strong> [1]</p>
  </dt>
  <dd>
    <p>Specifies the default loglevel to be used for subsystems for which no specific loglevel is defined.</p>
  </dd>
  <dt>
    <p><strong>libimcv.debug_level</strong> [1]</p>
  </dt>
  <dd>
    <p>Debug level for a stand-alone <em>libimcv</em> library.</p>
  </dd>
  <dt>
    <p><strong>libimcv.load</strong> [random nonce gmp pubkey x509]</p>
  </dt>
  <dd>
    <p>Plugins to load in IMC/IMVs with stand-alone <em>libimcv</em> library.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-attestation.aik_blob</strong> []</p>
  </dt>
  <dd>
    <p>AIK encrypted private key blob file.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-attestation.aik_cert</strong> []</p>
  </dt>
  <dd>
    <p>AIK certificate file.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-attestation.aik_pubkey</strong> []</p>
  </dt>
  <dd>
    <p>AIK public key file.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-attestation.mandatory_dh_groups</strong> [yes]</p>
  </dt>
  <dd>
    <p>Enforce mandatory Diffie-Hellman groups.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-attestation.nonce_len</strong> [20]</p>
  </dt>
  <dd>
    <p>DH nonce length.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-attestation.pcr17_after</strong> []</p>
  </dt>
  <dd>
    <p>Dummy data if the TBOOT log is not retrieved.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-attestation.pcr17_before</strong> []</p>
  </dt>
  <dd>
    <p>Dummy data if the TBOOT log is not retrieved.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-attestation.pcr17_meas</strong> []</p>
  </dt>
  <dd>
    <p>Dummy data if the TBOOT log is not retrieved.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-attestation.pcr18_after</strong> []</p>
  </dt>
  <dd>
    <p>Dummy data if the TBOOT log is not retrieved.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-attestation.pcr18_before</strong> []</p>
  </dt>
  <dd>
    <p>Dummy data if the TBOOT log is not retrieved.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-attestation.pcr18_meas</strong> []</p>
  </dt>
  <dd>
    <p>Dummy data if the TBOOT log is not retrieved.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-attestation.pcr_info</strong> [no]</p>
  </dt>
  <dd>
    <p>Whether to send pcr_before and pcr_after info.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-attestation.use_quote2</strong> [yes]</p>
  </dt>
  <dd>
    <p>Use Quote2 AIK signature instead of Quote signature.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-os.device_cert</strong> []</p>
  </dt>
  <dd>
    <p>Manually set the path to the client device certificate (e.g. /etc/pts/aikCert.der)</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-os.device_id</strong> []</p>
  </dt>
  <dd>
    <p>Manually set the client device ID in hexadecimal format (e.g. 1083f03988c9762703b1c1080c2e46f72b99cc31)</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-os.device_pubkey</strong> []</p>
  </dt>
  <dd>
    <p>Manually set the path to the client device public key (e.g. /etc/pts/aikPub.der)</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-os.push_info</strong> [yes]</p>
  </dt>
  <dd>
    <p>Send operating system info without being prompted.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-scanner.push_info</strong> [yes]</p>
  </dt>
  <dd>
    <p>Send open listening ports without being prompted.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-swid.swid_directory</strong> [${prefix}/share]</p>
  </dt>
  <dd>
    <p>Directory where SWID tags are located.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-swid.swid_full</strong> [FALSE]</p>
  </dt>
  <dd>
    <p>Include file information in the XML-encoded SWID tags.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-swid.swid_generator</strong> [/usr/local/bin/swid_generator]</p>
  </dt>
  <dd>
    <p>SWID generator command to be executed.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-swid.swid_pretty</strong> [FALSE]</p>
  </dt>
  <dd>
    <p>Generate XML-encoded SWID tags with pretty indentation.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-test.additional_ids</strong> [0]</p>
  </dt>
  <dd>
    <p>Number of additional IMC IDs.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-test.command</strong> [none]</p>
  </dt>
  <dd>
    <p>Command to be sent to the Test IMV.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-test.dummy_size</strong> [0]</p>
  </dt>
  <dd>
    <p>Size of dummy attribute to be sent to the Test IMV (0 = disabled).</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-test.retry</strong> [no]</p>
  </dt>
  <dd>
    <p>Do a handshake retry.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imc-test.retry_command</strong> []</p>
  </dt>
  <dd>
    <p>Command to be sent to the Test IMV in the handshake retry.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imv-attestation.cadir</strong> []</p>
  </dt>
  <dd>
    <p>Path to directory with AIK cacerts.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imv-attestation.dh_group</strong> [ecp256]</p>
  </dt>
  <dd>
    <p>Preferred Diffie-Hellman group.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imv-attestation.hash_algorithm</strong> [sha256]</p>
  </dt>
  <dd>
    <p>Preferred measurement hash algorithm.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imv-attestation.mandatory_dh_groups</strong> [yes]</p>
  </dt>
  <dd>
    <p>Enforce mandatory Diffie-Hellman groups.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imv-attestation.min_nonce_len</strong> [0]</p>
  </dt>
  <dd>
    <p>DH minimum nonce length.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imv-os.remediation_uri</strong> []</p>
  </dt>
  <dd>
    <p>URI pointing to operating system remediation instructions.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imv-scanner.remediation_uri</strong> []</p>
  </dt>
  <dd>
    <p>URI pointing to scanner remediation instructions.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imv-swid.rest_api_timeout</strong> [120]</p>
  </dt>
  <dd>
    <p>Timeout of SWID REST API HTTP POST transaction.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imv-swid.rest_api_uri</strong> []</p>
  </dt>
  <dd>
    <p>HTTP URI of the SWID REST API.</p>
  </dd>
  <dt>
    <p><strong>libimcv.plugins.imv-test.rounds</strong> [0]</p>
  </dt>
  <dd>
    <p>Number of IMC-IMV retry rounds.</p>
  </dd>
  <dt>
    <p><strong>libimcv.stderr_quiet</strong> [no]</p>
  </dt>
  <dd>
    <p>Disable output to stderr with a stand-alone <em>libimcv</em> library.</p>
  </dd>
  <dt>
    <p><strong>manager.database</strong> []</p>
  </dt>
  <dd>
    <p>Credential database URI for manager. If it contains a password, make sure to adjust the permissions of the config file accordingly.</p>
  </dd>
  <dt>
    <p><strong>manager.debug</strong> [no]</p>
  </dt>
  <dd>
    <p>Enable debugging in manager.</p>
  </dd>
  <dt>
    <p><strong>manager.load</strong> []</p>
  </dt>
  <dd>
    <p>Plugins to load in manager.</p>
  </dd>
  <dt>
    <p><strong>manager.socket</strong> []</p>
  </dt>
  <dd>
    <p>FastCGI socket of manager, to run it statically.</p>
  </dd>
  <dt>
    <p><strong>manager.threads</strong> [10]</p>
  </dt>
  <dd>
    <p>Threads to use for request handling.</p>
  </dd>
  <dt>
    <p><strong>manager.timeout</strong> [15m]</p>
  </dt>
  <dd>
    <p>Session timeout for manager.</p>
  </dd>
  <dt>
    <p><strong>medsrv.database</strong> []</p>
  </dt>
  <dd>
    <p>Mediation server database URI. If it contains a password, make sure to adjust the permissions of the config file accordingly.</p>
  </dd>
  <dt>
    <p><strong>medsrv.debug</strong> [no]</p>
  </dt>
  <dd>
    <p>Debugging in mediation server web application.</p>
  </dd>
  <dt>
    <p><strong>medsrv.dpd</strong> [5m]</p>
  </dt>
  <dd>
    <p>DPD timeout to use in mediation server plugin.</p>
  </dd>
  <dt>
    <p><strong>medsrv.load</strong> []</p>
  </dt>
  <dd>
    <p>Plugins to load in mediation server plugin.</p>
  </dd>
  <dt>
    <p><strong>medsrv.password_length</strong> [6]</p>
  </dt>
  <dd>
    <p>Minimum password length required for mediation server user accounts.</p>
  </dd>
  <dt>
    <p><strong>medsrv.rekey</strong> [20m]</p>
  </dt>
  <dd>
    <p>Rekeying time on mediation connections in mediation server plugin.</p>
  </dd>
  <dt>
    <p><strong>medsrv.socket</strong> []</p>
  </dt>
  <dd>
    <p>Run Mediation server web application statically on socket.</p>
  </dd>
  <dt>
    <p><strong>medsrv.threads</strong> [5]</p>
  </dt>
  <dd>
    <p>Number of thread for mediation service web application.</p>
  </dd>
  <dt>
    <p><strong>medsrv.timeout</strong> [15m]</p>
  </dt>
  <dd>
    <p>Session timeout for mediation service.</p>
  </dd>
  <dt>
    <p><strong>pacman.database</strong> []</p>
  </dt>
  <dd>
    <p>Database URI for the database that stores the package information. If it contains a password, make sure to adjust the permissions of the config file accordingly.</p>
  </dd>
  <dt>
    <p><strong>pacman.load</strong> []</p>
  </dt>
  <dd>
    <p>Plugins to load in package manager.</p>
  </dd>
  <dt>
    <p><strong>pki.load</strong> []</p>
  </dt>
  <dd>
    <p>Plugins to load in ipsec pki tool.</p>
  </dd>
  <dt>
    <p><strong>pool.database</strong> []</p>
  </dt>
  <dd>
    <p>Database URI for the database that stores IP pools and configuration attributes. If it contains a password, make        sure to adjust the permissions of the config file accordingly.</p>
  </dd>
  <dt>
    <p><strong>pool.load</strong> []</p>
  </dt>
  <dd>
    <p>Plugins to load in ipsec pool tool.</p>
  </dd>
  <dt>
    <p><strong>scepclient.load</strong> []</p>
  </dt>
  <dd>
    <p>Plugins to load in ipsec scepclient tool.</p>
  </dd>
  <dt>
    <p><strong>starter.config_file</strong> [${sysconfdir}/ipsec.conf]</p>
  </dt>
  <dd>
    <p>Location of the ipsec.conf file</p>
  </dd>
  <dt>
    <p><strong>starter.load</strong> []</p>
  </dt>
  <dd>
    <p>Plugins to load in starter.</p>
  </dd>
  <dt>
    <p><strong>starter.load_warning</strong> [yes]</p>
  </dt>
  <dd>
    <p>Disable charon plugin load option warning.</p>
  </dd>
  <dt>
    <p><strong>swanctl.load</strong> []</p>
  </dt>
  <dd>
    <p>Plugins to load in swanctl.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOGGER CONFIGURATION</h2>
        <div class="sectioncontent">
<p>Options in <a href="../man5/strongswan.conf.5.html"><strong>strongswan.conf</strong>(5)</a> provide a much more flexible way to configure loggers for the IKE daemon charon than using the <strong>charondebug</strong> option in <a href="../man5/ipsec.conf.5.html"><strong>ipsec.conf</strong>(5)</a>.</p><p><strong>Note</strong>: If any loggers are specified in strongswan.conf, <strong>charondebug</strong> does not have any effect.</p><p>There are currently two types of loggers:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>File loggers</strong></p>
  </dt>
  <dd>
    <p>Log directly to a file and are defined by specifying the full path to the file as subsection in the <strong>charon.filelog</strong> section. To log to the console the two special filenames <strong>stdout</strong> and <strong>stderr</strong> can be used.</p>
  </dd>
  <dt>
    <p><strong>Syslog loggers</strong></p>
  </dt>
  <dd>
    <p>Log into a syslog facility and are defined by specifying the facility to log to as the name of a subsection in the <strong>charon.syslog</strong> section. The following facilities are currently supported: <strong>daemon</strong> and <strong>auth</strong>.</p>
  </dd>

</dl>
<p>Multiple loggers can be defined for each type with different log verbosity for the different subsystems of the daemon.</p><h3>Subsystems</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>dmn</strong></p>
  </dt>
  <dd>
    <p>Main daemon setup/cleanup/signal handling</p>
  </dd>
  <dt>
    <p><strong>mgr</strong></p>
  </dt>
  <dd>
    <p>IKE_SA manager, handling synchronization for IKE_SA access</p>
  </dd>
  <dt>
    <p><strong>ike</strong></p>
  </dt>
  <dd>
    <p>IKE_SA</p>
  </dd>
  <dt>
    <p><strong>chd</strong></p>
  </dt>
  <dd>
    <p>CHILD_SA</p>
  </dd>
  <dt>
    <p><strong>job</strong></p>
  </dt>
  <dd>
    <p>Jobs queueing/processing and thread pool management</p>
  </dd>
  <dt>
    <p><strong>cfg</strong></p>
  </dt>
  <dd>
    <p>Configuration management and plugins</p>
  </dd>
  <dt>
    <p><strong>knl</strong></p>
  </dt>
  <dd>
    <p>IPsec/Networking kernel interface</p>
  </dd>
  <dt>
    <p><strong>net</strong></p>
  </dt>
  <dd>
    <p>IKE network communication</p>
  </dd>
  <dt>
    <p><strong>asn</strong></p>
  </dt>
  <dd>
    <p>Low-level encoding/decoding (ASN.1, X.509 etc.)</p>
  </dd>
  <dt>
    <p><strong>enc</strong></p>
  </dt>
  <dd>
    <p>Packet encoding/decoding encryption/decryption operations</p>
  </dd>
  <dt>
    <p><strong>tls</strong></p>
  </dt>
  <dd>
    <p>libtls library messages</p>
  </dd>
  <dt>
    <p><strong>esp</strong></p>
  </dt>
  <dd>
    <p>libipsec library messages</p>
  </dd>
  <dt>
    <p><strong>lib</strong></p>
  </dt>
  <dd>
    <p>libstrongwan library messages</p>
  </dd>
  <dt>
    <p><strong>tnc</strong></p>
  </dt>
  <dd>
    <p>Trusted Network Connect</p>
  </dd>
  <dt>
    <p><strong>imc</strong></p>
  </dt>
  <dd>
    <p>Integrity Measurement Collector</p>
  </dd>
  <dt>
    <p><strong>imv</strong></p>
  </dt>
  <dd>
    <p>Integrity Measurement Verifier</p>
  </dd>
  <dt>
    <p><strong>pts</strong></p>
  </dt>
  <dd>
    <p>Platform Trust Service</p>
  </dd>

</dl>

<h3>Loglevels</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>-1</strong></p>
  </dt>
  <dd>
    <p>Absolutely silent</p>
  </dd>
  <dt>
    <p><strong>0</strong></p>
  </dt>
  <dd>
    <p>Very basic auditing logs, (e.g. SA up/SA down)</p>
  </dd>
  <dt>
    <p><strong>1</strong></p>
  </dt>
  <dd>
    <p>Generic control flow with errors, a good default to see whats going on</p>
  </dd>
  <dt>
    <p><strong>2</strong></p>
  </dt>
  <dd>
    <p>More detailed debugging control flow</p>
  </dd>
  <dt>
    <p><strong>3</strong></p>
  </dt>
  <dd>
    <p>Including RAW data dumps in Hex</p>
  </dd>
  <dt>
    <p><strong>4</strong></p>
  </dt>
  <dd>
    <p>Also include sensitive material in dumps, e.g. keys</p>
  </dd>

</dl>

<h3>Example</h3>

<pre>
	charon {
		filelog {
			/var/log/charon.log {
				time_format = %b %e %T
				append = no
				default = 1
			}
			stderr {
				ike = 2
				knl = 3
				ike_name = yes
			}
		}
		syslog {
			# enable logging to LOG_DAEMON, use defaults
			daemon {
			}
			# minimalistic IKE auditing logging to LOG_AUTHPRIV
			auth {
				default = -1
				ike = 0
			}
		}
	}
</pre>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">JOB PRIORITY MANAGEMENT</h2>
        <div class="sectioncontent">
<p>Some operations in the IKEv2 daemon charon are currently implemented synchronously and blocking. Two examples for such operations are communication with a RADIUS server via EAP-RADIUS, or fetching CRL/OCSP information during certificate chain verification. Under high load conditions, the thread pool may run out of available threads, and some more important jobs, such as liveness checking, may not get executed in time.</p><p>To prevent thread starvation in such situations job priorities were introduced. The job processor will reserve some threads for higher priority jobs, these threads are not available for lower priority, locking jobs.</p><h3>Implementation</h3>
<p>Currently 4 priorities have been defined, and they are used in charon as follows:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>CRITICAL</strong></p>
  </dt>
  <dd>
    <p>Priority for long-running dispatcher jobs.</p>
  </dd>
  <dt>
    <p><strong>HIGH</strong></p>
  </dt>
  <dd>
    <p>INFORMATIONAL exchanges, as used by liveness checking (DPD).</p>
  </dd>
  <dt>
    <p><strong>MEDIUM</strong></p>
  </dt>
  <dd>
    <p>Everything not HIGH/LOW, including IKE_SA_INIT processing.</p>
  </dd>
  <dt>
    <p><strong>LOW</strong></p>
  </dt>
  <dd>
    <p>IKE_AUTH message processing. RADIUS and CRL fetching block here</p>
  </dd>

</dl>
<p>Although IKE_SA_INIT processing is computationally expensive, it is explicitly assigned to the MEDIUM class. This allows charon to do the DH exchange while other threads are blocked in IKE_AUTH. To prevent the daemon from accepting more IKE_SA_INIT requests than it can handle, use IKE_SA_INIT DROPPING.</p><p>The thread pool processes jobs strictly by priority, meaning it will consume all higher priority jobs before looking for ones with lower priority. Further, it reserves threads for certain priorities. A priority class having reserved <em>n</em> threads will always have <em>n</em> threads available for this class (either currently processing a job, or waiting for one).</p>
<h3>Configuration</h3>
<p>To ensure that there are always enough threads available for higher priority tasks, threads must be reserved for each priority class.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>charon.processor.priority_threads.critical</strong> [0]</p>
  </dt>
  <dd>
    <p>Threads reserved for CRITICAL priority class jobs</p>
  </dd>
  <dt>
    <p><strong>charon.processor.priority_threads.high</strong> [0]</p>
  </dt>
  <dd>
    <p>Threads reserved for HIGH priority class jobs</p>
  </dd>
  <dt>
    <p><strong>charon.processor.priority_threads.medium</strong> [0]</p>
  </dt>
  <dd>
    <p>Threads reserved for MEDIUM priority class jobs</p>
  </dd>
  <dt>
    <p><strong>charon.processor.priority_threads.low</strong> [0]</p>
  </dt>
  <dd>
    <p>Threads reserved for LOW priority class jobs</p>
  </dd>

</dl>
<p>Let's consider the following configuration:</p>
<pre>
	charon {
		processor {
			priority_threads {
				high = 1
				medium = 4
			}
		}
	}
</pre>
<p>With this configuration, one thread is reserved for HIGH priority tasks. As currently only liveness checking and stroke message processing is done with high priority, one or two threads should be sufficient.</p><p>The MEDIUM class mostly processes non-blocking jobs. Unless your setup is experiencing many blocks in locks while accessing shared resources, threads for one or two times the number of CPU cores is fine.</p><p>It is usually not required to reserve threads for CRITICAL jobs. Jobs in this class rarely return and do not release their thread to the pool.</p><p>The remaining threads are available for LOW priority jobs. Reserving threads does not make sense (until we have an even lower priority).</p>
<h3>Monitoring</h3>
<p>To see what the threads are actually doing, invoke <em>ipsec statusall</em>. Under high load, something like this will show up:</p>
<pre>
	worker threads: 2 or 32 idle, 5/1/2/22 working,
		job queue: 0/0/1/149, scheduled: 198
</pre>
<p>From 32 worker threads,</p>
<dl class='dl-vertical'>
  <dt>
    2
  </dt>
  <dd>
    <p>are currently idle.</p>
  </dd>
  <dt>
    5
  </dt>
  <dd>
    <p>are running CRITICAL priority jobs (dispatching from sockets, etc.).</p>
  </dd>
  <dt>
    1
  </dt>
  <dd>
    <p>is currently handling a HIGH priority job. This is actually the thread currently providing this information via stroke.</p>
  </dd>
  <dt>
    2
  </dt>
  <dd>
    <p>are handling MEDIUM priority jobs, likely IKE_SA_INIT or CREATE_CHILD_SA messages.</p>
  </dd>
  <dt>
    22
  </dt>
  <dd>
    <p>are handling LOW priority jobs, probably waiting for an EAP-RADIUS response while processing IKE_AUTH messages.</p>
  </dd>

</dl>
<p>The job queue load shows how many jobs are queued for each priority, ready for execution. The single MEDIUM priority job will get executed immediately, as we have two spare threads reserved for MEDIUM class jobs.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">IKE_SA_INIT DROPPING</h2>
        <div class="sectioncontent">
<p>If a responder receives more connection requests per seconds than it can handle, it does not make sense to accept more IKE_SA_INIT messages. And if they are queued but can't get processed in time, an answer might be sent after the client has already given up and restarted its connection setup. This additionally increases the load on the responder.</p><p>To limit the responder load resulting from new connection attempts, the daemon can drop IKE_SA_INIT messages just after reception. There are two mechanisms to decide if this should happen, configured with the following options:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>charon.init_limit_half_open</strong> [0]</p>
  </dt>
  <dd>
    <p>Limit based on the number of half open IKE_SAs. Half open IKE_SAs are SAs in connecting state, but not yet established.</p>
  </dd>
  <dt>
    <p><strong>charon.init_limit_job_load</strong> [0]</p>
  </dt>
  <dd>
    <p>Limit based on the number of jobs currently queued for processing (sum over all job priorities).</p>
  </dd>

</dl>
<p>The second limit includes load from other jobs, such as rekeying. Choosing a good value is difficult and depends on the hardware and expected load.</p><p>The first limit is simpler to calculate, but includes the load from new connections only. If your responder is capable of negotiating 100 tunnels/s, you might set this limit to 1000. The daemon will then drop new connection attempts if generating a response would require more than 10 seconds. If you are allowing for a maximum response time of more than 30 seconds, consider adjusting the timeout for connecting IKE_SAs (<strong>charon.half_open_timeout</strong>). A responder, by default, deletes an IKE_SA if the initiator does not establish it within 30 seconds. Under high load, a higher value might be required.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOAD TESTS</h2>
        <div class="sectioncontent">
<p>To do stability testing and performance optimizations, the IKE daemon charon provides the <em>load-tester</em> plugin. This plugin allows one to setup thousands of tunnels concurrently against the daemon itself or a remote host.</p><p><strong>WARNING:</strong> Never enable the load-testing plugin on productive systems. It provides preconfigured credentials and allows an attacker to authenticate as any user.</p><h3>Configuration details</h3>
<p>For public key authentication, the responder uses the <strong>&quot;CN=srv, OU=load-test, O=strongSwan&quot;</strong> identity. For the initiator, each connection attempt uses a different identity in the form <strong>&quot;CN=c1-r1, OU=load-test, O=strongSwan&quot;</strong>, where the first number inidicates the client number, the second the authentication round (if multiple authentication rounds are used).</p><p>For PSK authentication, FQDN identities are used. The server uses <strong>srv.strongswan.org</strong>, the client uses an identity in the form <strong>c1-r1.strongswan.org</strong>.</p><p>For EAP authentication, the client uses a NAI in the form <strong>100000000010001@strongswan.org</strong>.</p><p>To configure multiple authentication rounds, concatenate multiple methods using, e.g.</p>
<pre>
	initiator_auth = pubkey|psk|eap-md5|eap-aka
</pre>
<p>The responder uses a hardcoded certificate based on a 1024-bit RSA key. This certificate additionally serves as CA certificate. A peer uses the same private key, but generates client certificates on demand signed by the CA certificate. Install the Responder/CA certificate on the remote host to authenticate all clients.</p><p>To speed up testing, the load tester plugin implements a special Diffie-Hellman implementation called <em>modpnull</em>. By setting</p>
<pre>
	proposal = aes128-sha1-modpnull
</pre>
<p>this wicked fast DH implementation is used. It does not provide any security at all, but allows one to run tests without DH calculation overhead.</p>
<h3>Examples</h3>
<p>In the simplest case, the daemon initiates IKE_SAs against itself using the loopback interface. This will actually establish double the number of IKE_SAs, as the daemon is initiator and responder for each IKE_SA at the same time. Installation of IPsec SAs would fail, as each SA gets installed twice. To simulate the correct behavior, a fake kernel interface can be enabled which does not install the IPsec SAs at the kernel level.</p><p>A simple loopback configuration might look like this:</p>
<pre>
	charon {
		# create new IKE_SAs for each CHILD_SA to simulate
		# different clients
		reuse_ikesa = no
		# turn off denial of service protection
		dos_protection = no

		plugins {
			load-tester {
				# enable the plugin
				enable = yes
				# use 4 threads to initiate connections
				# simultaneously
				initiators = 4
				# each thread initiates 1000 connections
				iterations = 1000
				# delay each initiation in each thread by 20ms
				delay = 20
				# enable the fake kernel interface to
				# avoid SA conflicts
				fake_kernel = yes
			}
		}
	}
</pre>
<p>This will initiate 4000 IKE_SAs within 20 seconds. You may increase the delay value if your box can not handle that much load, or decrease it to put more load on it. If the daemon starts retransmitting messages your box probably can not handle all connection attempts.</p><p>The plugin also allows one to test against a remote host. This might help to test against a real world configuration. A connection setup to do stress testing of a gateway might look like this:</p>
<pre>
	charon {
		reuse_ikesa = no
		threads = 32

		plugins {
			load-tester {
				enable = yes
				# 10000 connections, ten in parallel
				initiators = 10
				iterations = 1000
				# use a delay of 100ms, overall time is:
				# iterations * delay = 100s
				delay = 100
				# address of the gateway
				remote = 1.2.3.4
				# IKE-proposal to use
				proposal = aes128-sha1-modp1024
				# use faster PSK authentication instead
				# of 1024bit RSA
				initiator_auth = psk
				responder_auth = psk
				# request a virtual IP using configuration
				# payloads
				request_virtual_ip = yes
				# enable CHILD_SA every 60s
				child_rekey = 60
			}
		}
	}
</pre>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">IKEv2 RETRANSMISSION</h2>
        <div class="sectioncontent">
<p>Retransmission timeouts in the IKEv2 daemon charon can be configured globally using the three keys listed below:</p>
<pre>
<strong>charon.retransmit_base</strong> [1.8]
<strong>charon.retransmit_timeout</strong> [4.0]
<strong>charon.retransmit_tries</strong> [5]
</pre>
<p>The following algorithm is used to calculate the timeout:</p>
<pre>
	relative timeout = retransmit_timeout * retransmit_base ^ (n-1)
</pre>
<p>Where <em>n</em> is the current retransmission count.</p><p>Using the default values, packets are retransmitted in:</p><table class="table table-striped">
<tr>
<th>Retransmission</th>
<th>Relative Timeout</th>
<th>Absolute Timeout</th></tr>

<tr>
<td>1</td>
<td>4s</td>
<td>4s</td></tr>

<tr>
<td>2</td>
<td>7s</td>
<td>11s</td></tr>

<tr>
<td>3</td>
<td>13s</td>
<td>24s</td></tr>

<tr>
<td>4</td>
<td>23s</td>
<td>47s</td></tr>

<tr>
<td>5</td>
<td>42s</td>
<td>89s</td></tr>

<tr>
<td>giving up</td>
<td>76s</td>
<td>165s</td></tr>
</table>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VARIABLES</h2>
        <div class="sectioncontent">
<p>The variables used above are configured as follows:</p>
<pre>
${piddir}               /var/run
${prefix}               /usr
${random_device}        /dev/random
${urandom_device}       /dev/urandom
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<pre>
/etc/strongswan.conf       configuration file
/etc/strongswan.d/         directory containing included config snippets
/etc/strongswan.d/charon/  plugin specific config snippets
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO strongswan.conf&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/ipsec.conf.5.html"><strong>ipsec.conf</strong>(5)</a>, <a href="../man5/ipsec.secrets.5.html"><strong>ipsec.secrets</strong>(5)</a>, <strong>ipsec</strong>(8), <a href="../man8/charon-cmd.8.html"><strong>charon-cmd</strong>(8)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">
<p>Written for the</p><p>strongSwan project</p><p>by Tobias Brunner, Andreas Steffen and Martin Willi.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="status.5.html"><span aria-hidden="true">&larr;</span> status.5: Server status database</a></li>
   <li class="next"><a href="subgid.5.html">subgid.5: The subordinate gid file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
