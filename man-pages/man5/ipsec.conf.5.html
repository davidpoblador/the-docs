<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ipsec.conf: Ipsec configuration and connections</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Ipsec configuration and connections">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="ipsec.conf (5) manual">
  <meta name="twitter:description" content="Ipsec configuration and connections">
  <meta name="twitter:image" content="https://www.carta.tech/images/strongswan-starter-ipsec.conf-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/ipsec.conf.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ipsec.conf (5) manual" />
  <meta property="og:description" content="Ipsec configuration and connections" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/strongswan-starter-ipsec.conf-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">ipsec.conf<small> (5)</small></h1>
        <p class="lead">Ipsec configuration and connections</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/ipsec.conf.5.html">
      <span itemprop="name">ipsec.conf: Ipsec configuration and connections</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/strongswan-starter/">
      <span itemprop="name">strongswan-starter</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/ipsec.conf.5.html">
      <span itemprop="name">ipsec.conf: Ipsec configuration and connections</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The optional <em>ipsec.conf</em> file specifies most configuration and control information for the strongSwan IPsec subsystem. The major exception is secrets for authentication; see <a href="../man5/ipsec.secrets.5.html"><strong>ipsec.secrets</strong>(5)</a>. Its contents are not security-sensitive.</p><p>The file is a text file, consisting of one or more <em>sections</em>. White space followed by <strong>#</strong> followed by anything to the end of the line is a comment and is ignored, as are empty lines which are not within a section.</p><p>A line which contains <strong>include</strong> and a file name, separated by white space, is replaced by the contents of that file, preceded and followed by empty lines. If the file name is not a full pathname, it is considered to be relative to the directory containing the including file. Such inclusions can be nested. Only a single filename may be supplied, and it may not contain white space, but it may include shell wildcards (see <em>sh</em>(1)); for example:</p><p><strong>include</strong> <strong>ipsec.*.conf</strong></p><p>The intention of the include facility is mostly to permit keeping information on connections, or sets of connections, separate from the main configuration file. This permits such connection descriptions to be changed, copied to the other security gateways involved, etc., without having to constantly extract them from the configuration file and then insert them back into it. Note also the <strong>also</strong> parameter (described below) which permits splitting a single logical section (e.g. a connection description) into several actual sections.</p><p>A section begins with a line of the form:</p><p><em>type</em> <em>name</em></p><p>where <em>type</em> indicates what type of section follows, and <em>name</em> is an arbitrary name which distinguishes the section from others of the same type. Names must start with a letter and may contain only letters, digits, periods, underscores, and hyphens. All subsequent non-empty lines which begin with white space are part of the section; comments within a section must begin with white space too. There may be only one section of a given type with a given name.</p><p>Lines within the section are generally of the form</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em>parameter</em><strong>=</strong><em>value</em></p><p>(note the mandatory preceding white space). There can be white space on either side of the <strong>=</strong>. Parameter names follow the same syntax as section names, and are specific to a section type. Unless otherwise explicitly specified, no parameter name may appear more than once in a section.</p><p>An empty <em>value</em> stands for the system default value (if any) of the parameter, i.e. it is roughly equivalent to omitting the parameter line entirely. A <em>value</em> may contain white space only if the entire <em>value</em> is enclosed in double quotes (<strong>"</strong>); a <em>value</em> cannot itself contain a double quote, nor may it be continued across more than one line.</p><p>Numeric values are specified to be either an ``integer'' (a sequence of digits) or a ``decimal number'' (sequence of digits optionally followed by `.' and another sequence of digits).</p><p>There is currently one parameter which is available in any type of section:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>also</strong></p>
  </dt>
  <dd>
    <p>the value is a section name; the parameters of that section are appended to this section, as if they had been written as part of it. The specified section must exist, must follow the current one, and must have the same section type. (Nesting is permitted, and there may be more than one <strong>also</strong> in a single section, although it is forbidden to append the same section more than once.)</p>
  </dd>

</dl>
<p>A section with name <strong>%default</strong> specifies defaults for sections of the same type. For each parameter in it, any section of that type which does not have a parameter of the same name gets a copy of the one from the <strong>%default</strong> section. There may be multiple <strong>%default</strong> sections of a given type, but only one default may be supplied for any specific parameter name, and all <strong>%default</strong> sections of a given type must precede all non- .B %default sections of that type. <strong>%default</strong> sections may not contain the <strong>also</strong> parameter.</p><p>Currently there are three types of sections: a <strong>config</strong> section specifies general configuration information for IPsec, a <strong>conn</strong> section specifies an IPsec connection, while a <strong>ca</strong> section specifies special properties of a certification authority.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONN SECTIONS</h2>
        <div class="sectioncontent">
<p>A <strong>conn</strong> section contains a <em>connection specification</em>, defining a network connection to be made using IPsec. The name given is arbitrary, and is used to identify the connection. Here's a simple example:</p>
<pre>
conn snt
	left=192.168.0.1
	leftsubnet=10.1.0.0/16
	right=192.168.0.2
	rightsubnet=10.1.0.0/16
	keyingtries=%forever
	auto=add
</pre>
<p>A note on terminology: There are two kinds of communications going on: transmission of user IP packets, and gateway-to-gateway negotiations for keying, rekeying, and general control. The path to control the connection is called 'ISAKMP SA' in IKEv1 and 'IKE SA' in the IKEv2 protocol. That what is being negotiated, the kernel level data path, is called 'IPsec SA' or 'Child SA'. strongSwan previously used two separate keying daemons, <em>pluto</em> and <em>charon</em>. This manual does not discuss <em>pluto</em> options anymore, but only <em>charon</em> that since strongSwan 5.0 supports both IKEv1 and IKEv2.</p><p>To avoid trivial editing of the configuration file to suit it to each system involved in a connection, connection specifications are written in terms of <em>left</em> and <em>right</em> participants, rather than in terms of local and remote. Which participant is considered <em>left</em> or <em>right</em> is arbitrary; for every connection description an attempt is made to figure out whether the local endpoint should act as the <em>left</em> or <em>right</em> endpoint. This is done by matching the IP addresses defined for both endpoints with the IP addresses assigned to local network interfaces. If a match is found then the role (left or right) that matches is going to be considered local. If no match is found during startup, <em>left</em> is considered local. This permits using identical connection specifications on both ends. There are cases where there is no symmetry; a good convention is to use <em>left</em> for the local side and <em>right</em> for the remote side (the first letters are a good mnemonic).</p><p>Many of the parameters relate to one participant or the other; only the ones for <em>left</em> are listed here, but every parameter whose name begins with <strong>left</strong> has a <strong>right</strong> counterpart, whose description is the same but with <strong>left</strong> and <strong>right</strong> reversed.</p><p>Parameters are optional unless marked '(required)'.</p><h3>CONN PARAMETERS</h3>
<p>Unless otherwise noted, for a connection to work, in general it is necessary for the two ends to agree exactly on the values of these parameters.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>aaa_identity</strong> = &lt;id&gt;</p>
  </dt>
  <dd>
    <p>defines the identity of the AAA backend used during IKEv2 EAP authentication. This is required if the EAP client uses a method that verifies the server identity (such as EAP-TLS), but it does not match the IKEv2 gateway identity.</p>
  </dd>
  <dt>
    <p><strong>aggressive</strong> = yes | <strong>no</strong></p>
  </dt>
  <dd>
    <p>whether to use IKEv1 Aggressive or Main Mode (the default).</p>
  </dd>
  <dt>
    <p><strong>ah</strong> = &lt;cipher suites&gt;</p>
  </dt>
  <dd>
    <p>comma-separated list of AH algorithms to be used for the connection, e.g. <strong>sha1-sha256-modp1024</strong>. The notation is <strong>integrity[-dhgroup]</strong>. For IKEv2, multiple algorithms (separated by -) of the same type can be included in a single proposal. IKEv1 only includes the first algorithm in a proposal. Only either the <strong>ah</strong> or <strong>esp</strong> keyword may be used, AH+ESP bundles are not supported.</p><p>There is no default, by default ESP is used. The daemon adds its extensive default proposal to the configured value. To restrict it to the configured proposal an exclamation mark (<strong>!</strong>) can be added at the end.</p><p>If <strong>dh-group</strong> is specified, CHILD_SA/Quick Mode setup and rekeying include a separate Diffie-Hellman exchange.</p>
  </dd>
  <dt>
    <p><strong>also</strong> = &lt;name&gt;</p>
  </dt>
  <dd>
    <p>includes conn section <strong>&lt;name&gt;</strong>.</p>
  </dd>
  <dt>
    <p><strong>auth</strong> = &lt;value&gt;</p>
  </dt>
  <dd>
    <p>was used by the <strong>pluto</strong> IKEv1 daemon to use AH integrity protection for ESP encrypted packets, but is not supported in charon. The <strong>ah</strong> keyword specifies algorithms to use for integrity protection with AH, but without encryption. AH+ESP bundles are not supported.</p>
  </dd>
  <dt>
    <p><strong>authby</strong> = <strong>pubkey</strong> | rsasig | ecdsasig | psk | secret | never | xauthpsk | xauthrsasig</p>
  </dt>
  <dd>
    <p>how the two security gateways should authenticate each other; acceptable values are <strong>psk</strong> or <strong>secret</strong> for pre-shared secrets, <strong>pubkey</strong> (the default) for public key signatures as well as the synonyms <strong>rsasig</strong> for RSA digital signatures and <strong>ecdsasig</strong> for Elliptic Curve DSA signatures. <strong>never</strong> can be used if negotiation is never to be attempted or accepted (useful for shunt-only conns). Digital signatures are superior in every way to shared secrets. IKEv1 additionally supports the values <strong>xauthpsk</strong> and <strong>xauthrsasig</strong> that will enable eXtended AUTHentication (XAUTH) in addition to IKEv1 main mode based on shared secrets or digital RSA signatures, respectively. This parameter is deprecated, as two peers do not need to agree on an authentication method in IKEv2. Use the <strong>leftauth</strong> parameter instead to define authentication methods.</p>
  </dd>
  <dt>
    <p><strong>auto</strong> = <strong>ignore</strong> | add | route | start</p>
  </dt>
  <dd>
    <p>what operation, if any, should be done automatically at IPsec startup; currently-accepted values are <strong>add</strong>, <strong>route</strong>, <strong>start</strong> and <strong>ignore</strong> (the default). <strong>add</strong> loads a connection without starting it. <strong>route</strong> loads a connection and installs kernel traps. If traffic is detected between <strong>leftsubnet</strong> and <strong>rightsubnet</strong>, a connection is established. <strong>start</strong> loads a connection and brings it up immediately. <strong>ignore</strong> ignores the connection. This is equal to deleting a connection from the config file. Relevant only locally, other end need not agree on it.</p>
  </dd>
  <dt>
    <p><strong>closeaction</strong> = <strong>none</strong> | clear | hold | restart</p>
  </dt>
  <dd>
    <p>defines the action to take if the remote peer unexpectedly closes a CHILD_SA (see <strong>dpdaction</strong> for meaning of values). A <strong>closeaction should not be</strong> used if the peer uses reauthentication or uniquids checking, as these events might trigger the defined action when not desired.</p>
  </dd>
  <dt>
    <p><strong>compress</strong> = yes | <strong>no</strong></p>
  </dt>
  <dd>
    <p>whether IPComp compression of content is proposed on the connection (link-level compression does not work on encrypted data, so to be effective, compression must be done <em>before</em> encryption); acceptable values are <strong>yes</strong> and <strong>no</strong> (the default). A value of <strong>yes</strong> causes the daemon to propose both compressed and uncompressed, and prefer compressed. A value of <strong>no</strong> prevents the daemon from proposing or accepting compression.</p>
  </dd>
  <dt>
    <p><strong>dpdaction</strong> = <strong>none</strong> | clear | hold | restart</p>
  </dt>
  <dd>
    <p>controls the use of the Dead Peer Detection protocol (DPD, RFC 3706) where R_U_THERE notification messages (IKEv1) or empty INFORMATIONAL messages (IKEv2) are periodically sent in order to check the liveliness of the IPsec peer. The values <strong>clear</strong>, <strong>hold</strong>, and <strong>restart</strong> all activate DPD. If no activity is detected, all connections with a dead peer are stopped and unrouted (<strong>clear</strong>), put in the hold state (<strong>hold</strong>) or restarted (<strong>restart</strong>). The default is <strong>none</strong> which disables the active sending of DPD messages.</p>
  </dd>
  <dt>
    <p><strong>dpddelay</strong> = <strong>30s</strong> | &lt;time&gt;</p>
  </dt>
  <dd>
    <p>defines the period time interval with which R_U_THERE messages/INFORMATIONAL exchanges are sent to the peer. These are only sent if no other traffic is received. In IKEv2, a value of 0 sends no additional INFORMATIONAL messages and uses only standard messages (such as those to rekey) to detect dead peers.</p>
  </dd>
  <dt>
    <p><strong>dpdtimeout</strong> = <strong>150s</strong> | &lt;time&gt;</p>
  </dt>
  <dd>
    <p>defines the timeout interval, after which all connections to a peer are deleted in case of inactivity. This only applies to IKEv1, in IKEv2 the default retransmission timeout applies, as every exchange is used to detect dead peers.</p>
  </dd>
  <dt>
    <p><strong>inactivity</strong> = &lt;time&gt;</p>
  </dt>
  <dd>
    <p>defines the timeout interval, after which a CHILD_SA is closed if it did not send or receive any traffic. The inactivity counter is reset during CHILD_SA rekeying. This means that the inactivity timeout must be smaller than the rekeying interval to have any effect.</p>
  </dd>
  <dt>
    <p><strong>eap_identity</strong> = &lt;id&gt;</p>
  </dt>
  <dd>
    <p>defines the identity the client uses to reply to an EAP Identity request. If defined on the EAP server, the defined identity will be used as peer identity during EAP authentication. The special value <strong>%identity</strong> uses the EAP Identity method to ask the client for an EAP identity. If not defined, the IKEv2 identity will be used as EAP identity.</p>
  </dd>
  <dt>
    <p><strong>esp</strong> = &lt;cipher suites&gt;</p>
  </dt>
  <dd>
    <p>comma-separated list of ESP encryption/authentication algorithms to be used for the connection, e.g. <strong>aes128-sha256</strong>. The notation is <strong>encryption-integrity[-dhgroup][-esnmode]</strong>. For IKEv2, multiple algorithms (separated by -) of the same type can be included in a single proposal. IKEv1 only includes the first algorithm in a proposal. Only either the <strong>ah</strong> or <strong>esp</strong> keyword may be used, AH+ESP bundles are not supported.</p><p>Defaults to <strong>aes128-sha1,3des-sha1</strong>. The daemon adds its extensive default proposal to this default or the configured value.  To restrict it to the configured proposal an exclamation mark (<strong>!</strong>) can be added at the end.</p><p><strong>Note</strong>: As a responder the daemon accepts the first supported proposal received from the peer. In order to restrict a responder to only accept specific cipher suites, the strict flag (<strong>!</strong>, exclamation mark) can be used, e.g: aes256-sha512-modp4096!</p><p>If <strong>dh-group</strong> is specified, CHILD_SA/Quick Mode setup and rekeying include a separate Diffie-Hellman exchange.  Valid values for <strong>esnmode</strong> (IKEv2 only) are <strong>esn</strong> and <strong>noesn</strong>. Specifying both negotiates Extended Sequence Number support with the peer, the default is <strong>noesn.</strong></p>
  </dd>
  <dt>
    <p><strong>forceencaps</strong> = yes | <strong>no</strong></p>
  </dt>
  <dd>
    <p>force UDP encapsulation for ESP packets even if no NAT situation is detected. This may help to surmount restrictive firewalls. In order to force the peer to encapsulate packets, NAT detection payloads are faked.</p>
  </dd>
  <dt>
    <p><strong>fragmentation</strong> = yes | force | <strong>no</strong></p>
  </dt>
  <dd>
    <p>whether to use IKE fragmentation (proprietary IKEv1 extension).  Acceptable values are <strong>yes</strong>, <strong>force</strong> and <strong>no</strong> (the default). Fragmented messages sent by a peer are always accepted irrespective of the value of this option. If set to <strong>yes</strong>, and the peer supports it, larger IKE messages will be sent in fragments. If set to <strong>force</strong> the initial IKE message will already be fragmented if required.</p>
  </dd>
  <dt>
    <p><strong>ike</strong> = &lt;cipher suites&gt;</p>
  </dt>
  <dd>
    <p>comma-separated list of IKE/ISAKMP SA encryption/authentication algorithms to be used, e.g. <strong>aes128-sha1-modp2048</strong>. The notation is <strong>encryption-integrity[-prf]-dhgroup</strong>. If no PRF is given, the algorithms defined for integrity are used for the PRF. The prf keywords are the same as the integrity algorithms, but have a <strong>prf</strong> prefix (such as <strong>prfsha1</strong>, <strong>prfsha256</strong> or <strong>prfaesxcbc</strong>).</p><p>In IKEv2, multiple algorithms and proposals may be included, such as <strong>aes128-aes256-sha1-modp1536-modp2048,3des-sha1-md5-modp1024</strong>.</p><p>Defaults to <strong>aes128-sha1-modp2048,3des-sha1-modp1536</strong>. The daemon adds its extensive default proposal to this default or the configured value.  To restrict it to the configured proposal an exclamation mark (<strong>!</strong>) can be added at the end.</p><p><strong>Note</strong>: As a responder the daemon accepts the first supported proposal received from the peer.  In order to restrict a responder to only accept specific cipher suites, the strict flag (<strong>!</strong>, exclamation mark) can be used, e.g: <strong>aes256-sha512-modp4096!</strong></p>
  </dd>
  <dt>
    <p><strong>ikedscp</strong> = <strong>000000</strong> | &lt;DSCP field&gt;</p>
  </dt>
  <dd>
    <p>Differentiated Services Field Codepoint to set on outgoing IKE packets sent from this connection. The value is a six digit binary encoded string defining the Codepoint to set, as defined in RFC 2474.</p>
  </dd>
  <dt>
    <p><strong>ikelifetime</strong> = <strong>3h</strong> | &lt;time&gt;</p>
  </dt>
  <dd>
    <p>how long the keying channel of a connection (ISAKMP or IKE SA) should last before being renegotiated. Also see EXPIRY/REKEY below.</p>
  </dd>
  <dt>
    <p><strong>installpolicy</strong> = <strong>yes</strong> | no</p>
  </dt>
  <dd>
    <p>decides whether IPsec policies are installed in the kernel by the charon daemon for a given connection. Allows peaceful cooperation e.g. with the Mobile IPv6 daemon mip6d who wants to control the kernel policies. Acceptable values are <strong>yes</strong> (the default) and <strong>no</strong>.</p>
  </dd>
  <dt>
    <p><strong>keyexchange</strong> = <strong>ike</strong> | ikev1 | ikev2</p>
  </dt>
  <dd>
    <p>which key exchange protocol should be used to initiate the connection. Connections marked with <strong>ike</strong> use IKEv2 when initiating, but accept any protocol version when responding.</p>
  </dd>
  <dt>
    <p><strong>keyingtries</strong> = <strong>3</strong> | &lt;number&gt; | %forever</p>
  </dt>
  <dd>
    <p>how many attempts (a whole number or <strong>%forever</strong>) should be made to negotiate a connection, or a replacement for one, before giving up (default <strong>3</strong>). The value <strong>%forever</strong> means 'never give up'. Relevant only locally, other end need not agree on it.</p>
  </dd>
  <dt>
    <p><strong>keylife</strong></p>
  </dt>
  <dd>
    <p>synonym for <strong>lifetime</strong>.</p>
  </dd>
  <dt>
    <p><strong>left</strong> = &lt;ip address&gt; | &lt;fqdn&gt; | <strong>%any</strong> | &lt;range&gt; | &lt;subnet&gt; </p>
  </dt>
  <dd>
    <p>The IP address of the left participant's public-network interface or one of several magic values. The value <strong>%any</strong> (the default) for the local endpoint signifies an address to be filled in (by automatic keying) during negotiation. If the local peer initiates the connection setup the routing table will be queried to determine the correct local IP address. In case the local peer is responding to a connection setup then any IP address that is assigned to a local interface will be accepted.</p><p>The prefix <strong>%</strong> in front of a fully-qualified domain name or an IP address will implicitly set <strong>leftallowany</strong>=yes.</p><p>If <strong>%any</strong> is used for the remote endpoint it literally means any IP address.</p><p>To limit the connection to a  specific range of hosts, a range ( <strong>10.1.0.0-10.2.255.255</strong> ) or a subnet ( <strong>10.1.0.0/16</strong> ) can be specified, and multiple addresses, ranges and subnets can be separated by commas. While one can freely combine these items, to initiate the connection at least one non-range/subnet is required.</p><p>Please note that with the usage of wildcards multiple connection descriptions might match a given incoming connection attempt. The most specific description is used in that case.</p>
  </dd>
  <dt>
    <p><strong>leftallowany</strong> = yes | <strong>no</strong></p>
  </dt>
  <dd>
    <p>a modifier for <strong>left</strong>, making it behave as <strong>%any</strong> although a concrete IP address or domain name has been assigned.</p>
  </dd>
  <dt>
    <p><strong>leftauth</strong> = &lt;auth method&gt;</p>
  </dt>
  <dd>
    <p>Authentication method to use locally (left) or require from the remote (right) side. Acceptable values are <strong>pubkey</strong> for public key authentication (RSA/ECDSA), <strong>psk</strong> for pre-shared key authentication, <strong>eap</strong> to (require the) use of the Extensible Authentication Protocol in IKEv2, and <strong>xauth</strong> for IKEv1 eXtended Authentication. To require a trustchain public key strength for the remote side, specify the key type followed by the minimum strength in bits (for example <strong>ecdsa-384</strong> or <strong>rsa-2048-ecdsa-256</strong>). To limit the acceptable set of hashing algorithms for trustchain validation, append hash algorithms to <strong>pubkey</strong> or a key strength definition (for example <strong>pubkey-sha1-sha256</strong> or <strong>rsa-2048-ecdsa-256-sha256-sha384-sha512</strong>). For <strong>eap</strong>, an optional EAP method can be appended. Currently defined methods are <strong>eap-aka</strong>, <strong>eap-gtc</strong>, <strong>eap-md5</strong>, <strong>eap-mschapv2</strong>, <strong>eap-peap</strong>, <strong>eap-sim</strong>, <strong>eap-tls</strong>, <strong>eap-ttls</strong>, <strong>eap-dynamic</strong>, and <strong>eap-radius</strong>. Alternatively, IANA assigned EAP method numbers are accepted. Vendor specific EAP methods are defined in the form <strong>eap-type-vendor</strong> (e.g. <strong>eap-7-12345</strong>). For <strong>xauth,</strong> an XAuth authentication backend can be specified, such as <strong>xauth-generic</strong> or <strong>xauth-eap</strong>. If XAuth is used in <strong>leftauth</strong>, Hybrid authentication is used. For traditional XAuth authentication, define XAuth in <strong>lefauth2</strong>.</p>
  </dd>
  <dt>
    <p><strong>leftauth2</strong> = &lt;auth method&gt;</p>
  </dt>
  <dd>
    <p>Same as <strong>leftauth</strong>, but defines an additional authentication exchange. In IKEv1, only XAuth can be used in the second authentication round. IKEv2 supports multiple complete authentication rounds using "Multiple Authentication Exchanges" defined in RFC 4739. This allows, for example, separated authentication of host and user.</p>
  </dd>
  <dt>
    <p><strong>leftca</strong> = &lt;issuer dn&gt; | %same</p>
  </dt>
  <dd>
    <p>the distinguished name of a certificate authority which is required to lie in the trust path going from the left participant's certificate up to the root certification authority. <strong>%same</strong> means that the value configured for the right participant should be reused.</p>
  </dd>
  <dt>
    <p><strong>leftca2</strong> = &lt;issuer dn&gt; | %same</p>
  </dt>
  <dd>
    <p>Same as <strong>leftca</strong>, but for the second authentication round (IKEv2 only).</p>
  </dd>
  <dt>
    <p><strong>leftcert</strong> = &lt;path&gt;</p>
  </dt>
  <dd>
    <p>the path to the left participant's X.509 certificate. The file can be encoded either in PEM or DER format. OpenPGP certificates are supported as well. Both absolute paths or paths relative to <em>/etc/ipsec.d/certs</em> are accepted. By default <strong>leftcert</strong> sets <strong>leftid</strong> to the distinguished name of the certificate's subject. The left participant's ID can be overridden by specifying a <strong>leftid</strong> value which must be certified by the certificate, though.</p><p>A value in the form <strong>%smartcard[&lt;slot nr&gt;[@&lt;module&gt;]]:&lt;keyid&gt;</strong> defines a specific certificate to load from a PKCS#11 backend for this connection. See <a href="../man5/ipsec.secrets.5.html"><strong>ipsec.secrets</strong>(5)</a> for details about smartcard definitions. <strong>leftcert</strong> is required only if selecting the certificate with <strong>leftid</strong> is not sufficient, for example if multiple certificates use the same subject.</p><p>Multiple certificate paths or PKCS#11 backends can be specified in a comma separated list. The daemon chooses the certificate based on the received certificate requests if possible before enforcing the first.</p>
  </dd>
  <dt>
    <p><strong>leftcert2</strong> = &lt;path&gt;</p>
  </dt>
  <dd>
    <p>Same as <strong>leftcert,</strong> but for the second authentication round (IKEv2 only).</p>
  </dd>
  <dt>
    <p><strong>leftcertpolicy</strong> = &lt;OIDs&gt;</p>
  </dt>
  <dd>
    <p>Comma separated list of certificate policy OIDs the peer's certificate must have. OIDs are specified using the numerical dotted representation.</p>
  </dd>
  <dt>
    <p><strong>leftdns</strong> = &lt;servers&gt;</p>
  </dt>
  <dd>
    <p>Comma separated list of DNS server addresses to exchange as configuration attributes. On the initiator, a server is a fixed IPv4/IPv6 address, or <strong>%config4</strong>/<strong>%config6</strong> to request attributes without an address. On the responder, only fixed IPv4/IPv6 addresses are allowed and define DNS servers assigned to the client.</p>
  </dd>
  <dt>
    <p><strong>leftfirewall</strong> = yes | <strong>no</strong></p>
  </dt>
  <dd>
    <p>whether the left participant is doing forwarding-firewalling (including masquerading) using iptables for traffic from <em>leftsubnet</em>, which should be turned off (for traffic to the other subnet) once the connection is established; acceptable values are <strong>yes</strong> and <strong>no</strong> (the default). May not be used in the same connection description with <strong>leftupdown</strong>. Implemented as a parameter to the default <strong>ipsec _updown</strong> script. See notes below. Relevant only locally, other end need not agree on it.</p><p>If one or both security gateways are doing forwarding firewalling (possibly including masquerading), and this is specified using the firewall parameters, tunnels established with IPsec are exempted from it so that packets can flow unchanged through the tunnels. (This means that all subnets connected in this manner must have distinct, non-overlapping subnet address blocks.) This is done by the default <strong>ipsec _updown</strong> script.</p><p>In situations calling for more control, it may be preferable for the user to supply his own <em>updown</em> script, which makes the appropriate adjustments for his system.</p>
  </dd>
  <dt>
    <p><strong>leftgroups</strong> = &lt;group list&gt;</p>
  </dt>
  <dd>
    <p>a comma separated list of group names. If the <strong>leftgroups</strong> parameter is present then the peer must be a member of at least one of the groups defined by the parameter.</p>
  </dd>
  <dt>
    <p><strong>leftgroups2</strong> = &lt;group list&gt;</p>
  </dt>
  <dd>
    <p>Same as <strong>leftgroups,</strong> but for the second authentication round defined with <strong>leftauth2.</strong></p>
  </dd>
  <dt>
    <p><strong>lefthostaccess</strong> = yes | <strong>no</strong></p>
  </dt>
  <dd>
    <p>inserts a pair of INPUT and OUTPUT iptables rules using the default <strong>ipsec _updown</strong> script, thus allowing access to the host itself in the case where the host's internal interface is part of the negotiated client subnet. Acceptable values are <strong>yes</strong> and <strong>no</strong> (the default).</p>
  </dd>
  <dt>
    <p><strong>leftid</strong> = &lt;id&gt;</p>
  </dt>
  <dd>
    <p>how the left participant should be identified for authentication; defaults to <strong>left</strong> or the subject of the certificate configured with <strong>leftcert</strong>. Can be an IP address, a fully-qualified domain name, an email address, or a keyid. If <strong>leftcert</strong> is configured the identity has to be confirmed by the certificate.</p><p>For IKEv2 and <strong>rightid</strong> the prefix <strong>%</strong> in front of the identity prevents the daemon from sending IDr in its IKE_AUTH request and will allow it to verify the configured identity against the subject and subjectAltNames contained in the responder's certificate (otherwise it is only compared with the IDr returned by the responder).  The IDr sent by the initiator might otherwise prevent the responder from finding a config if it has configured a different value for <strong>leftid</strong>.</p>
  </dd>
  <dt>
    <p><strong>leftid2</strong> = &lt;id&gt;</p>
  </dt>
  <dd>
    <p>identity to use for a second authentication for the left participant (IKEv2 only); defaults to <strong>leftid</strong>.</p>
  </dd>
  <dt>
    <p><strong>leftikeport</strong> = &lt;port&gt;</p>
  </dt>
  <dd>
    <p>UDP port the left participant uses for IKE communication. If unspecified, port 500 is used with the port floating to 4500 if a NAT is detected or MOBIKE is enabled. Specifying a local IKE port different from the default additionally requires a socket implementation that listens on this port.</p>
  </dd>
  <dt>
    <p><strong>leftprotoport</strong> = &lt;protocol&gt;/&lt;port&gt;</p>
  </dt>
  <dd>
    <p>restrict the traffic selector to a single protocol and/or port. This option is now deprecated, protocol/port information can be defined for each subnet directly in <strong>leftsubnet</strong>.</p>
  </dd>
  <dt>
    <p><strong>leftsigkey</strong> = &lt;raw public key&gt; | &lt;path to public key&gt;</p>
  </dt>
  <dd>
    <p>the left participant's public key for public key signature authentication, in PKCS#1 format using hex (0x prefix) or base64 (0s prefix) encoding. With the optional <strong>dns:</strong> or <strong>ssh:</strong> prefix in front of 0x or 0s, the public key is expected to be in either the RFC 3110 (not the full RR, only RSA key part) or RFC 4253 public key format, respectively. Also accepted is the path to a file containing the public key in PEM, DER or SSH encoding. Both absolute paths or paths relative to <em>/etc/ipsec.d/certs</em> are accepted.</p>
  </dd>
  <dt>
    <p><strong>leftsendcert</strong> = never | no | <strong>ifasked</strong> | always | yes</p>
  </dt>
  <dd>
    <p>Accepted values are <strong>never</strong> or <strong>no</strong>, <strong>always</strong> or <strong>yes</strong>, and <strong>ifasked</strong> (the default), the latter meaning that the peer must send a certificate request payload in order to get a certificate in return.</p>
  </dd>
  <dt>
    <p><strong>leftsourceip</strong> = %config4 | %config6 | &lt;ip address&gt;</p>
  </dt>
  <dd>
    <p>Comma separated list of internal source IPs to use in a tunnel, also known as virtual IP. If the value is one of the synonyms <strong>%config</strong>, <strong>%cfg</strong>, <strong>%modeconfig</strong>, or <strong>%modecfg</strong>, an address (from the tunnel address family) is requested from the peer. With <strong>%config4</strong> and <strong>%config6</strong> an address of the given address family will be requested explicitly. If an IP address is configured, it will be requested from the responder, which is free to respond with a different address.</p>
  </dd>
  <dt>
    <p><strong>rightsourceip</strong> = %config | &lt;network&gt;/&lt;netmask&gt; | %poolname</p>
  </dt>
  <dd>
    <p>Comma separated list of internal source IPs to use in a tunnel for the remote peer. If the value is <strong>%config</strong> on the responder side, the initiator must propose an address which is then echoed back. Also supported are address pools expressed as <em>network</em><strong>/</strong><em>netmask</em> or the use of an external IP address pool using %<em>poolname</em>, where <em>poolname</em> is the name of the IP address pool used for the lookup.</p>
  </dd>
  <dt>
    <p><strong>leftsubnet</strong> = &lt;ip subnet&gt;[[&lt;proto/port&gt;]][,...]</p>
  </dt>
  <dd>
    <p>private subnet behind the left participant, expressed as <em>network</em><strong>/</strong><em>netmask</em>; if omitted, essentially assumed to be <em>left</em><strong>/32</strong>, signifying that the left end of the connection goes to the left participant only. Configured subnets of the peers may differ, the protocol narrows it to the greatest common subnet. In IKEv1, this may lead to problems with other implementations, make sure to configure identical subnets in such configurations. IKEv2 supports multiple subnets separated by commas. IKEv1 only interprets the first subnet of such a definition, unless the Cisco Unity extension plugin is enabled.</p><p>The optional part after each subnet enclosed in square brackets specifies a protocol/port to restrict the selector for that subnet.</p><p>Examples: <strong>leftsubnet=10.0.0.1[tcp/http],10.0.0.2[6/80]</strong> or <strong>leftsubnet=fec1::1[udp],10.0.0.0/16[/53]</strong>. Instead of omitting either value <strong>%any</strong> can be used to the same effect, e.g. <strong>leftsubnet=fec1::1[udp/%any],10.0.0.0/16[%any/53]</strong>.</p><p>If the protocol is <strong>icmp</strong> or <strong>ipv6-icmp</strong> the port is interpreted as ICMP message type if it is less than 256 or as type and code if it is greater or equal to 256, with the type in the most significant 8 bits and the code in the least significant 8 bits.</p><p>The port value can alternatively take the value <strong>%opaque</strong> for RFC 4301 OPAQUE selectors, or a numerical range in the form <strong>1024-65535</strong>. None of the kernel backends currently supports opaque or port ranges and uses <strong>%any</strong> for policy installation instead.</p><p>Instead of specifying a subnet, <strong>%dynamic</strong> can be used to replace it with the IKE address, having the same effect as omitting <strong>leftsubnet</strong> completely. Using <strong>%dynamic</strong> can be used to define multiple dynamic selectors, each having a potentially different protocol/port definition.</p>
  </dd>
  <dt>
    <p><strong>leftupdown</strong> = &lt;path&gt;</p>
  </dt>
  <dd>
    <p>what ``updown'' script to run to adjust routing and/or firewalling when the status of the connection changes (default <strong>ipsec _updown</strong>). May include positional parameters separated by white space (although this requires enclosing the whole string in quotes); including shell metacharacters is unwise. Relevant only locally, other end need not agree on it. Charon uses the updown script to insert firewall rules only, since routing has been implemented directly into the daemon.</p>
  </dd>
  <dt>
    <p><strong>lifebytes</strong> = &lt;number&gt;</p>
  </dt>
  <dd>
    <p>the number of bytes transmitted over an IPsec SA before it expires.</p>
  </dd>
  <dt>
    <p><strong>lifepackets</strong> = &lt;number&gt;</p>
  </dt>
  <dd>
    <p>the number of packets transmitted over an IPsec SA before it expires.</p>
  </dd>
  <dt>
    <p><strong>lifetime</strong> = <strong>1h</strong> | &lt;time&gt;</p>
  </dt>
  <dd>
    <p>how long a particular instance of a connection (a set of encryption/authentication keys for user packets) should last, from successful negotiation to expiry; acceptable values are an integer optionally followed by <strong>s</strong> (a time in seconds) or a decimal number followed by <strong>m</strong>, <strong>h</strong>, or <strong>d</strong> (a time in minutes, hours, or days respectively) (default <strong>1h</strong>, maximum <strong>24h</strong>). Normally, the connection is renegotiated (via the keying channel) before it expires (see <strong>margintime</strong>). The two ends need not exactly agree on <strong>lifetime</strong>, although if they do not, there will be some clutter of superseded connections on the end which thinks the lifetime is longer. Also see EXPIRY/REKEY below.</p>
  </dd>
  <dt>
    <p><strong>marginbytes</strong> = &lt;number&gt;</p>
  </dt>
  <dd>
    <p>how many bytes before IPsec SA expiry (see <strong>lifebytes</strong>) should attempts to negotiate a replacement begin.</p>
  </dd>
  <dt>
    <p><strong>marginpackets</strong> = &lt;number&gt;</p>
  </dt>
  <dd>
    <p>how many packets before IPsec SA expiry (see <strong>lifepackets</strong>) should attempts to negotiate a replacement begin.</p>
  </dd>
  <dt>
    <p><strong>margintime</strong> = <strong>9m</strong> | &lt;time&gt;</p>
  </dt>
  <dd>
    <p>how long before connection expiry or keying-channel expiry should attempts to negotiate a replacement begin; acceptable values as for <strong>lifetime</strong> (default <strong>9m</strong>). Relevant only locally, other end need not agree on it. Also see EXPIRY/REKEY below.</p>
  </dd>
  <dt>
    <p><strong>mark</strong> = &lt;value&gt;[/&lt;mask&gt;]</p>
  </dt>
  <dd>
    <p>sets an XFRM mark in the inbound and outbound IPsec SAs and policies. If the mask is missing then a default mask of <strong>0xffffffff</strong> is assumed.</p>
  </dd>
  <dt>
    <p><strong>mark_in</strong> = &lt;value&gt;[/&lt;mask&gt;]</p>
  </dt>
  <dd>
    <p>sets an XFRM mark in the inbound IPsec SA and policy. If the mask is missing then a default mask of <strong>0xffffffff</strong> is assumed.</p>
  </dd>
  <dt>
    <p><strong>mark_out</strong> = &lt;value&gt;[/&lt;mask&gt;]</p>
  </dt>
  <dd>
    <p>sets an XFRM mark in the outbound IPsec SA and policy. If the mask is missing then a default mask of <strong>0xffffffff</strong> is assumed.</p>
  </dd>
  <dt>
    <p><strong>mobike</strong> = <strong>yes</strong> | no</p>
  </dt>
  <dd>
    <p>enables the IKEv2 MOBIKE protocol defined by RFC 4555. Accepted values are <strong>yes</strong> (the default) and <strong>no</strong>. If set to <strong>no</strong>, the charon daemon will not actively propose MOBIKE as initiator and ignore the MOBIKE_SUPPORTED notify as responder.</p>
  </dd>
  <dt>
    <p><strong>modeconfig</strong> = push | <strong>pull</strong></p>
  </dt>
  <dd>
    <p>defines which mode is used to assign a virtual IP. Accepted values are <strong>push</strong> and <strong>pull</strong> (the default). Push mode is currently not supported with IKEv2.</p>
  </dd>
  <dt>
    <p><strong>reauth</strong> = <strong>yes</strong> | no</p>
  </dt>
  <dd>
    <p>whether rekeying of an IKE_SA should also reauthenticate the peer. In IKEv1, reauthentication is always done. In IKEv2, a value of <strong>no</strong> rekeys without uninstalling the IPsec SAs, a value of <strong>yes</strong> (the default) creates a new IKE_SA from scratch and tries to recreate all IPsec SAs.</p>
  </dd>
  <dt>
    <p><strong>rekey</strong> = <strong>yes</strong> | no</p>
  </dt>
  <dd>
    <p>whether a connection should be renegotiated when it is about to expire; acceptable values are <strong>yes</strong> (the default) and <strong>no</strong>. The two ends need not agree, but while a value of <strong>no</strong> prevents charon from requesting renegotiation, it does not prevent responding to renegotiation requested from the other end, so <strong>no</strong> will be largely ineffective unless both ends agree on it. Also see <strong>reauth</strong>.</p>
  </dd>
  <dt>
    <p><strong>rekeyfuzz</strong> = <strong>100%</strong> | &lt;percentage&gt;</p>
  </dt>
  <dd>
    <p>maximum percentage by which <strong>marginbytes</strong>, <strong>marginpackets</strong> and <strong>margintime</strong> should be randomly increased to randomize rekeying intervals (important for hosts with many connections); acceptable values are an integer, which may exceed 100, followed by a `%' (defaults to <strong>100%</strong>). The value of <strong>marginTYPE</strong>, after this random increase, must not exceed <strong>lifeTYPE</strong> (where TYPE is one of <em>bytes</em>, <em>packets</em> or <em>time</em>). The value <strong>0%</strong> will suppress randomization. Relevant only locally, other end need not agree on it. Also see EXPIRY/REKEY below.</p>
  </dd>
  <dt>
    <p><strong>rekeymargin</strong></p>
  </dt>
  <dd>
    <p>synonym for <strong>margintime</strong>.</p>
  </dd>
  <dt>
    <p><strong>replay_window</strong> = <strong>-1</strong> | &lt;number&gt;</p>
  </dt>
  <dd>
    <p>The IPsec replay window size for this connection. With the default of -1 the value configured with <em>charon.replay_window</em> in <a href="../man5/strongswan.conf.5.html"><strong>strongswan.conf</strong>(5)</a> is used. Larger values than 32 are supported using the Netlink backend only, a value of 0 disables IPsec replay protection.</p>
  </dd>
  <dt>
    <p><strong>reqid</strong> = &lt;number&gt;</p>
  </dt>
  <dd>
    <p>sets the reqid for a given connection to a pre-configured fixed value.</p>
  </dd>
  <dt>
    <p><strong>tfc</strong> = &lt;value&gt;</p>
  </dt>
  <dd>
    <p>number of bytes to pad ESP payload data to. Traffic Flow Confidentiality is currently supported in IKEv2 and applies to outgoing packets only. The special value <strong>%mtu</strong> fills up ESP packets with padding to have the size of the MTU.</p>
  </dd>
  <dt>
    <p><strong>type</strong> = <strong>tunnel</strong> | transport | transport_proxy | passthrough | drop</p>
  </dt>
  <dd>
    <p>the type of the connection; currently the accepted values are <strong>tunnel</strong> (the default) signifying a host-to-host, host-to-subnet, or subnet-to-subnet tunnel; <strong>transport</strong>, signifying host-to-host transport mode; <strong>transport_proxy</strong>, signifying the special Mobile IPv6 transport proxy mode; <strong>passthrough</strong>, signifying that no IPsec processing should be done at all; <strong>drop</strong>, signifying that packets should be discarded.</p>
  </dd>
  <dt>
    <p><strong>xauth</strong> = <strong>client</strong> | server</p>
  </dt>
  <dd>
    <p>specifies the role in the XAuth protocol if activated by <strong>authby=xauthpsk</strong> or <strong>authby=xauthrsasig.</strong> Accepted values are <strong>server</strong> and <strong>client</strong> (the default).</p>
  </dd>
  <dt>
    <p><strong>xauth_identity</strong> = &lt;id&gt;</p>
  </dt>
  <dd>
    <p>defines the identity/username the client uses to reply to an XAuth request. If not defined, the IKEv1 identity will be used as XAuth identity.</p>
  </dd>

</dl>

<h3>CONN PARAMETERS: IKEv2 MEDIATION EXTENSION</h3>
<p>The following parameters are relevant to IKEv2 Mediation Extension operation only.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>mediation</strong> = yes | <strong>no</strong></p>
  </dt>
  <dd>
    <p>whether this connection is a mediation connection, ie. whether this connection is used to mediate other connections.  Mediation connections create no child SA. Acceptable values are <strong>no</strong> (the default) and <strong>yes</strong>.</p>
  </dd>
  <dt>
    <p><strong>mediated_by</strong> = &lt;name&gt;</p>
  </dt>
  <dd>
    <p>the name of the connection to mediate this connection through.  If given, the connection will be mediated through the named mediation connection. The mediation connection must set <strong>mediation=yes</strong>.</p>
  </dd>
  <dt>
    <p><strong>me_peerid</strong> = &lt;id&gt;</p>
  </dt>
  <dd>
    <p>ID as which the peer is known to the mediation server, ie. which the other end of this connection uses as its <strong>leftid</strong> on its connection to the mediation server.  This is the ID we request the mediation server to mediate us with.  If <strong>me_peerid</strong> is not given, the <strong>rightid</strong> of this connection will be used as peer ID.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CA SECTIONS</h2>
        <div class="sectioncontent">
<p>These are optional sections that can be used to assign special parameters to a Certification Authority (CA). Because the daemons automatically import CA certificates from <em>/etc/ipsec.d/cacerts</em>, there is no need to explicitly add them with a CA section, unless you want to assign special parameters (like a CRL) to a CA.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>also</strong> = &lt;name&gt;</p>
  </dt>
  <dd>
    <p>includes ca section <strong>&lt;name&gt;</strong>.</p>
  </dd>
  <dt>
    <p><strong>auto</strong> = <strong>ignore</strong> | add</p>
  </dt>
  <dd>
    <p>currently can have either the value <strong>ignore</strong> (the default) or <strong>add</strong>.</p>
  </dd>
  <dt>
    <p><strong>cacert</strong> = &lt;path&gt;</p>
  </dt>
  <dd>
    <p>defines a path to the CA certificate either relative to <em>/etc/ipsec.d/cacerts</em> or as an absolute path.</p><p>A value in the form <strong>%smartcard[&lt;slot nr&gt;[@&lt;module&gt;]]:&lt;keyid&gt;</strong> defines a specific CA certificate to load from a PKCS#11 backend for this CA. See <a href="../man5/ipsec.secrets.5.html"><strong>ipsec.secrets</strong>(5)</a> for details about smartcard definitions.</p>
  </dd>
  <dt>
    <p><strong>crluri</strong> = &lt;uri&gt;</p>
  </dt>
  <dd>
    <p>defines a CRL distribution point (ldap, http, or file URI)</p>
  </dd>
  <dt>
    <p><strong>crluri1</strong></p>
  </dt>
  <dd>
    <p>synonym for <strong>crluri.</strong></p>
  </dd>
  <dt>
    <p><strong>crluri2</strong> = &lt;uri&gt;</p>
  </dt>
  <dd>
    <p>defines an alternative CRL distribution point (ldap, http, or file URI)</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><strong>ocspuri</strong> = &lt;uri&gt;</p>
  </dt>
  <dd>
    <p>defines an OCSP URI.</p>
  </dd>
  <dt>
    <p><strong>ocspuri1</strong></p>
  </dt>
  <dd>
    <p>synonym for <strong>ocspuri.</strong></p>
  </dd>
  <dt>
    <p><strong>ocspuri2</strong> = &lt;uri&gt;</p>
  </dt>
  <dd>
    <p>defines an alternative OCSP URI.</p>
  </dd>
  <dt>
    <p><strong>certuribase</strong> = &lt;uri&gt;</p>
  </dt>
  <dd>
    <p>defines the base URI for the Hash and URL feature supported by IKEv2. Instead of exchanging complete certificates, IKEv2 allows one to send an URI that resolves to the DER encoded certificate. The certificate URIs are built by appending the SHA1 hash of the DER encoded certificates to this base URI.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIG SECTIONS</h2>
        <div class="sectioncontent">
<p>At present, the only <strong>config</strong> section known to the IPsec software is the one named <strong>setup</strong>, which contains information used when the software is being started. The currently-accepted <em>parameter</em> names in a <strong>config</strong> <strong>setup</strong> section are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>cachecrls</strong> = yes | <strong>no</strong></p>
  </dt>
  <dd>
    <p>if enabled, certificate revocation lists (CRLs) fetched via HTTP or LDAP will be cached in <em>/etc/ipsec.d/crls/</em> under a unique file name derived from the certification authority's public key.</p>
  </dd>
  <dt>
    <p><strong>charondebug</strong> = &lt;debug list&gt;</p>
  </dt>
  <dd>
    <p>how much charon debugging output should be logged. A comma separated list containing type/level-pairs may be specified, e.g: <strong>dmn 3, ike 1, net -1.</strong> Acceptable values for types are <strong>dmn, mgr, ike, chd, job, cfg, knl, net, asn, enc, lib, esp, tls,</strong> <strong>tnc, imc, imv, pts</strong> and the level is one of <strong>-1, 0, 1, 2, 3, 4</strong> (for silent, audit, control, controlmore, raw, private).  By default, the level is set to <strong>1</strong> for all types.  For more flexibility see LOGGER CONFIGURATION in <a href="../man5/strongswan.conf.5.html"><strong>strongswan.conf</strong>(5)</a>.</p>
  </dd>
  <dt>
    <p><strong>strictcrlpolicy</strong> = yes | ifuri | <strong>no</strong></p>
  </dt>
  <dd>
    <p>defines if a fresh CRL must be available in order for the peer authentication based on RSA signatures to succeed. IKEv2 additionally recognizes <strong>ifuri</strong> which reverts to <strong>yes</strong> if at least one CRL URI is defined and to <strong>no</strong> if no URI is known.</p>
  </dd>
  <dt>
    <p><strong>uniqueids</strong> = <strong>yes</strong> | no | never | replace | keep</p>
  </dt>
  <dd>
    <p>whether a particular participant ID should be kept unique, with any new IKE_SA using an ID deemed to replace all old ones using that ID; acceptable values are <strong>yes</strong> (the default), <strong>no</strong> and <strong>never</strong>. Participant IDs normally <em>are</em> unique, so a new IKE_SA using the same ID is almost invariably intended to replace an old one. The difference between <strong>no</strong> and <strong>never</strong> is that the daemon will replace old IKE_SAs when receiving an INITIAL_CONTACT notify if the option is <strong>no</strong> but will ignore these notifies if <strong>never</strong> is configured. The daemon also accepts the value <strong>replace</strong> which is identical to <strong>yes</strong> and the value <strong>keep</strong> to reject new IKE_SA setups and keep the duplicate established earlier.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SA EXPIRY/REKEY</h2>
        <div class="sectioncontent">
<p>The IKE SAs and IPsec SAs negotiated by the daemon can be configured to expire after a specific amount of time. For IPsec SAs this can also happen after a specified number of transmitted packets or transmitted bytes. The following settings can be used to configure this:</p><table class="table table-striped">
<tr>
<th>Setting</th>
<th>Default</th>
<th>Setting</th>
<th>Default</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th></tr>

<tr>
<td>IKE SA</td>
<td>IPsec SA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td></tr>

<tr>
<td>ikelifetime</td>
<td>3h</td>
<td>lifebytes</td>
<td>-</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td></tr>

<tr>
<td></td>
<td></td>
<td>lifepackets</td>
<td>-</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td></tr>

<tr>
<td></td>
<td></td>
<td>lifetime</td>
<td>1h</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td></tr>
</table><h3>Rekeying</h3>
<p>IKE SAs as well as IPsec SAs can be rekeyed before they expire. This can be configured using the following settings:</p><table class="table table-striped">
<tr>
<th>Setting</th>
<th>Default</th>
<th>Setting</th>
<th>Default</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th></tr>

<tr>
<td>IKE and IPsec SA</td>
<td>IPsec SA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td></tr>

<tr>
<td>margintime</td>
<td>9m</td>
<td>marginbytes</td>
<td>-</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td></tr>

<tr>
<td></td>
<td></td>
<td>marginpackets</td>
<td>-</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td></tr>
</table>
<h3>Randomization</h3>
<p>To avoid collisions the specified margins are increased randomly before subtracting them from the expiration limits (see formula below). This is controlled by the <strong>rekeyfuzz</strong> setting:</p><table class="table table-striped">
<tr>
<th>Setting</th>
<th>Default</th>
<th></th>
<th></th>
<th></th></tr>

<tr>
<td>IKE and IPsec SA</td>
<td></td>
<td></td>
<td></td>
<td></td></tr>

<tr>
<td>rekeyfuzz</td>
<td>100%</td>
<td></td>
<td></td>
<td></td></tr>
</table><p>Randomization can be disabled by setting <strong>rekeyfuzz</strong> to <strong>0%</strong>.</p>
<h3>Formula</h3>
<p>The following formula is used to calculate the rekey time of IPsec SAs:</p>
<pre>
 rekeytime = lifetime - (margintime + random(0, margintime * rekeyfuzz))
</pre>
<p>It applies equally to IKE SAs and byte and packet limits for IPsec SAs.</p>
<h3>Example</h3>
<p>Let's consider the default configuration:</p>
<pre>
	lifetime = 1h
	margintime = 9m
	rekeyfuzz = 100%
</pre>
<p>From the formula above follows that the rekey time lies between:</p>
<pre>
	rekeytime_min = 1h - (9m + 9m) = 42m
	rekeytime_max = 1h - (9m + 0m) = 51m
</pre>
<p>Thus, the daemon will attempt to rekey the IPsec SA at a random time between 42 and 51 minutes after establishing the SA. Or, in other words, between 9 and 18 minutes before the SA expires.</p>
<h3>Notes</h3>

<dl class='dl-vertical'>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>Since the rekeying of an SA needs some time, the margin values must not be too low.</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>The value <strong>margin... + margin... * rekeyfuzz</strong> must not exceed the original limit. For example, specifying <strong>margintime = 30m</strong> in the default configuration is a bad idea as there is a chance that the rekey time equals zero and, thus, rekeying gets disabled.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<pre>
/etc/ipsec.conf
/etc/ipsec.d/aacerts
/etc/ipsec.d/acerts
/etc/ipsec.d/cacerts
/etc/ipsec.d/certs
/etc/ipsec.d/crls

</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO ipsec.conf&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/strongswan.conf.5.html"><strong>strongswan.conf</strong>(5)</a>, <a href="../man5/ipsec.secrets.5.html"><strong>ipsec.secrets</strong>(5)</a>, <strong>ipsec</strong>(8)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">
<p>Originally written for the FreeS/WAN project by Henry Spencer. Updated and extended for the strongSwan project &lt;http://www.strongswan.org&gt; by Tobias Brunner, Andreas Steffen and Martin Willi.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="ipptoolfile.5.html"><span aria-hidden="true">&larr;</span> ipptoolfile.5: Ipptool file format</a></li>
   <li class="next"><a href="ipsec.secrets.5.html">ipsec.secrets.5: Secrets for ike/ipsec authentication <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
