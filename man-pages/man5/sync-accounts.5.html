<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>sync-accounts: Configuration file for sync-accounts</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Configuration file for sync-accounts">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="sync-accounts (5) manual">
  <meta name="twitter:description" content="Configuration file for sync-accounts">
  <meta name="twitter:image" content="https://www.carta.tech/images/chiark-scripts-sync-accounts-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/sync-accounts.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="sync-accounts (5) manual" />
  <meta property="og:description" content="Configuration file for sync-accounts" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/chiark-scripts-sync-accounts-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">sync-accounts<small> (5)</small></h1>
        <p class="lead">Configuration file for sync-accounts</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/sync-accounts.5.html">
      <span itemprop="name">sync-accounts: Configuration file for sync-accounts</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/chiark-scripts/">
      <span itemprop="name">chiark-scripts</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/sync-accounts.5.html">
      <span itemprop="name">sync-accounts: Configuration file for sync-accounts</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>/etc/sync-accounts</strong> contains the default configuration of the <a href="../man8/sync-accounts.8.html"><strong>sync-accounts</strong>(8)</a> account synchronisation tool.</p><p>The configuration file specifies how to access and update the local password and group databases, where sync-accounts should log.</p><p>It also specifies the list of (remote) sources for account information, and which accounts and details should be copied from each source to the local system.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OVERALL SYNTAX AND SEMANTICS</h2>
        <div class="sectioncontent">
<p>The configuration file is parsed as a series of lines.  First, leading and trailing whitespace on each line is removed, and then empty lines, or lines starting with <strong>#</strong>, are removed.</p><p>Each line is parsed as a directive.  The order of directives is significant; some directives set up information which later directives rely on.</p><p>The configuration file must contain an <strong>end</strong> directive; anything after that point is ignored.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">GLOBAL DIRECTIVES</h2>
        <div class="sectioncontent">
<p>These directives may appear only at the start of the file (before any other directives), and each directive must appear only once; otherwise, sync-accounts my behave oddly.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>lockpasswd</strong>|<strong>lockgroup</strong> <em>method</em> [<em>details </em>...]</p>
  </dt>
  <dd>
    <p>Specifies how the passwd and group files should be read and/or locked. See <strong>LOCKING METHOD DIRECTIVES</strong> below.</p>
  </dd>
  <dt>
    <p><strong>logfile </strong><em>filename</em></p>
  </dt>
  <dd>
    <p>Append log messages to <em>filename</em> instead of stdout. Errors still go to stderr.</p>
  </dd>
  <dt>
    <p><strong>localformat</strong> <strong>bsd</strong>|<strong>std</strong></p>
  </dt>
  <dd>
    <p>Specifies the local password file is in the relevant format: <strong>std</strong> is the standard V7 password file (with a SysV-style /etc/shadow if /etc/shadow exists). <strong>bsd</strong> is the BSD4.4 master.passwd format, and should be used only with <strong>lockpasswd runvia vipw</strong>. The default is <strong>std</strong>.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOCKING METHOD DIRECTIVES</h2>
        <div class="sectioncontent">
<p>One <strong>lockgroup</strong> and one <strong>lockpasswd</strong> directive must be present, in the global directives at the start of the config file.</p><p>The choice of the appropriate directives can be difficult without special knowledge of the local system.  In general, it is best to use <strong>lockpasswd runvia vipw</strong> where this is available, as if this works avoids having to know the names of the lockfiles.</p><p>GNU systems (including GNU/Linux and Debian GNU/BSD) typically lock the group file separately and supply <strong>vigr</strong>, in which case you should use <strong>lockgroup vigr</strong>.</p><p>Most systems other than GNU do not lock the group file at all (or assume that all programs which modify the group file will lock the passwd file), in which case <strong>lockgroup none</strong> is appropriate.</p><p>If vigr or vipw is not available or is known to be broken (eg, because it does not lock properly), then use <strong>link</strong>.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>lockpasswd</strong>|<strong>lockgroup</strong> <strong>runvia</strong> <em>program</em></p>
  </dt>
  <dd>
    <p>sync-accounts will reinvoke itself using <em>program</em>, which must behave like <strong>vipw</strong> or <strong>vigr</strong>. sync-accounts will set the <strong>EDITOR</strong> environment variable to the path it was invoked with (Perl's <strong>$0</strong>) and put some information for its own use into <strong>SYNC_ACCOUNTS_*</strong> environment variables (which will also allow sync-accounts to tell that it has already been reinvoked via <em>program</em> and should not do so again).</p><p>If both <strong>lockpasswd runvia </strong><em>vipw</em> and <strong>lockgroup runvia </strong><em>vigr</em> are specified, then it must be possible and safe for the EDITOR run by <em>vipw</em> to invoke <em>vigr</em>, as this is what sync-accounts will do.</p>
  </dd>
  <dt>
    <p><strong>lockpasswd</strong>|<strong>lockgroup</strong> <strong>link</strong> <em>suffix</em>|<em>filename</em></p>
  </dt>
  <dd>
    <p>sync-accounts will attempt to lock the passwd or group file by making a hardlink from the real file to the specified filename. If <em>suffix</em>|<em>filename</em> starts with a <strong>/</strong> it is interpreted as a filename; otherwise it is interpreted as a suffix, to be appended to the real database filename.</p>
  </dd>
  <dt>
    <p><strong>lockpasswd</strong>|<strong>lockgroup</strong> <strong>none</strong></p>
  </dt>
  <dd>
    <p>sync-accounts will not attempt to lock the passwd or group files at all.</p><p><strong>lockgroup none</strong> is appropriate on systems where there is no separate locking for the group file (either because there is no proper support for automatic editing of the group file, or because you're expected to lock the password file), although in the absence of <strong>vigr</strong> it's inevitable that simultaneous changes to the group file made by both the human sysadmin and by sync-accounts will cause problems.</p><p><strong>lockpasswd none</strong> is very dangerous and should not normally be used.  It will cause data loss if any other tool for changing password data is used - eg, <a href="../man1/passwd.1.html"><strong>passwd</strong>(1)</a>.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PER-SOURCE DIRECTIVES</h2>
        <div class="sectioncontent">
<p>Within each source's section, all of the per-source directives must appear before any account-selection directives; otherwise sync-accounts may behave oddly.  If a per-source directive is repeated, the last setting takes effect.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>host </strong><em>source</em></p>
  </dt>
  <dd>
    <p>Starts a source's section.  Usually each source will correspond exactly to one host which is acting as a source of account data. The <strong>host</strong> directive resets the per-source parameters to the defaults. <em>source</em> need not be the source host's official name in any sense and is used only for identification.  Any <em>source</em> must be named in only one <strong>host</strong> directive, or sync-accounts may behave oddly.</p>
  </dd>
  <dt>
    <p><strong>getpasswd</strong>|<strong>getgroup</strong>|<strong>getshadow</strong> <em>command</em>...</p>
  </dt>
  <dd>
    <p>sync-accounts always fetches account data from sources by running specified commands on the local host; it does not contain any network protocols, itself.</p><p><em>command</em> is fed to <strong>sh -c</strong> and might typically contain something like</p><p><strong>    ssh syncacct@remote.host cat /etc/passwd</strong></p><p>where the user syncacct on remote.host is in group shadow, or</p><p><strong>    cat /var/local/sync-accounts/remote.host/passwd</strong> where the file named is copied across using cron.</p><p><strong>getpasswd</strong> must be specified if user data is to be transferred; <strong>getgroup</strong> must be specified if group data is to be transferred.</p><p><strong>getshadow</strong> should be specified iff getpasswd is specified but the data from getpasswd does not contain actual password information, and should emit data in Sys-V shadow password format.</p>
  </dd>
  <dt>
    <p><strong>remoteformat</strong> <strong>std</strong>|<strong>bsd</strong></p>
  </dt>
  <dd>
    <p>Specifies the format of the output of getpasswd. <strong>std</strong> is standard V7 passwd file format (optionally augmented by the use of a shadow file fetched with getshadow). <strong>bsd</strong> is the BSD4.4 master.passwd format (and getshadow should not normally be used with <strong>remoteformat bsd</strong>). The default is <strong>std</strong>.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SYNCHRONISATION SETTINGS</h2>
        <div class="sectioncontent">
<p>The following directives affect the way that account data is copied. They may be freely mixed with other directives, and repeated.  The setting in effect is the one set by the last relevant settings directive before any particular account-selection directive.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>uidmin</strong>|<strong>uidmax</strong> <em>value</em></p>
  </dt>
  <dd>
    <p>When an account is to be created locally, a uid/gid will be chosen which is one higher than the highest currently in use, except that ids below uidmin or above uidmax are ignored and will never be used. There is no default.</p>
  </dd>
  <dt>
    <p><strong>homebase </strong><em>homebase</em></p>
  </dt>
  <dd>
    <p>When an account is to be created locally, its home directory will be <em>homebase</em><strong>/</strong><em>username</em> where <em>username</em> is the name of the account.  The default is <strong>/home</strong>.</p>
  </dd>
  <dt>
    <p>[<strong>no</strong>]<strong>sameuid</strong></p>
  </dt>
  <dd>
    <p>Specifies whether uids are supposed to match.  With <strong>sameuid</strong>, it is an error for the uid or gid of a synchronised local account not to match the corresponding remote account, and new local accounts will get the remote accounts' ids. The default is <strong>nosameuid</strong>.</p>
  </dd>
  <dt>
    <p><strong>usergroups</strong> | <strong>nousergroups</strong> | <strong>defaultgid</strong> <em>gid</em></p>
  </dt>
  <dd>
    <p>Specifies whether local accounts are supposed to have corresponding groups, or all be part of a particular group.  The default is <strong>usergroups</strong>.</p><p>With <strong>usergroups</strong>, when a new account is created, the corresponding per-user group will be created as well, and per-user groups are created for existing accounts if necessary (if account creation is enabled).  If the gid or group name for a per-user group is already taken for a different group name or gid this will be logged, and processing of that account will be inhibited, but it is not a fatal error.</p><p>With <strong>defaultgid</strong>, newly-created accounts will be made a part of that group, and the groups of existing accounts will be left alone.</p><p>With <strong>nousergroups</strong>, no new accounts can be created, and existing accounts' groups will be left alone.</p>
  </dd>
  <dt>
    <p><strong>createuser</strong> [<em>command</em>] | <strong>nocreateuser</strong></p>
  </dt>
  <dd>
    <p>Specifies whether accounts found on the remote host should be created if necessary, and what command to run to do the the rest of the account setup (eg, creation of home directory, etc.).  The default is <strong>nocreateuser</strong>.</p><p>If <strong>createuser</strong> is specified without a command then <strong>sync-accounts-createuser</strong> is used; the supplied sync-accounts-createuser program is a reasonable minimal implementation.</p><p>With <strong>createuser</strong>, either sameuid, or both uidmin and uidmax, must be specified, if accounts are actually to be created.</p><p>The command is passed to <strong>sh -c</strong>. See <a href="../man8/sync-accounts-createuser.8.html"><strong>sync-accounts-createuser</strong>(8)</a> for details of <em>command</em>'s environment and functionality.</p>
  </dd>
  <dt>
    <p><strong>group</strong>|<strong>nogroup</strong> <em>glob-pattern</em></p>
  </dt>
  <dd>
    <p><strong>group</strong> specifies that the membership of the local groups specified should be adjusted adjusted whenever account data for any user is copied, so that the account will be a member of the affected group locally iff the source account it is a member of the same group on the source host.</p><p>The most recently-encountered glob-pattern for a particular group takes effect.  The default is <strong>nogroups *</strong>.</p><p>The glob patterns may contain only alphanumerics, the two glob metacharacters <strong>* ?</strong> and four punctuation characters <strong>- + . _</strong>; <strong>&#92;</strong>-quoting and character sets and ranges are not supported.</p>
  </dd>
  <dt>
    <p><strong>defaultshell </strong><em>pathname</em></p>
  </dt>
  <dd>
    <p>Local accounts' shells will, when an account is synchronised, be set to the remote account's shell if the same file exists locally and is executable.  Otherwise, this value will be used.  The default is <strong>/bin/sh</strong>.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ACCOUNT SELECTION</h2>
        <div class="sectioncontent">
<p>These directives specify that the selected accounts are to be synchronised: that is, the local account data will be unconditionally overwritten (according to the synchronisation settings) with data from the current source (according to the most recent <strong>host</strong> directive).</p><p>Any particular local username will only be synchronised once; the source and settings for first account selection directive which selects that local username will be used.</p><p>When an account is synchronised, the account password, comment field, and shell will be copied unconditionally.  If <strong>sameuid</strong> is in effect specified the uid will be checked (or copied, for new accounts).</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>user</strong> <em>username</em> [<strong>remote</strong>=<em>remoteusername</em>]</p>
  </dt>
  <dd>
    <p>Specifies that account data should be copied for local user <em>username</em> from the remote account <em>remoteusername</em> (or <em>username</em> if <em>remoteusername</em> is not specified).</p>
  </dd>
  <dt>
    <p><strong>users</strong> <em>ruidmin</em>-<em>ruidmax</em></p>
  </dt>
  <dd>
    <p>Specifies that all remote users whose remote uid is in the given range are to be synchronised to corresponding user accounts.  (Note that the remote uid will only be copied if <strong>sameuid</strong> is in effect.)</p>
  </dd>
  <dt>
    <p><strong>nouser </strong><em>username</em></p>
  </dt>
  <dd>
    <p>Specifies that data for <em>username is not to be copied, even</em> if subsequent user or users directives suggest that it should be.</p>
  </dd>
  <dt>
    <p><strong>addhere</strong></p>
  </dt>
  <dd>
    <p>This directive has no effect on sync-accounts.  However, it is used as a placeholder by grab-account: new accounts for creation are inserted just before addhere.  See <a href="../man8/grab-account.8.html"><strong>grab-account</strong>(8)</a>.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FINAL DIRECTIVE</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>end</strong></p>
  </dt>
  <dd>
    <p>must appear in the configuration file, usually at the end of the file. Nothing after it will be read.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>The advice about the correct <strong>lockpasswd</strong> and <strong>lockgroup</strong> directives is probably out of date or flatly wrong.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p><strong>sync-accounts</strong> and this manpage are part of the <strong>sync-accounts</strong> package which was written by Ian Jackson &lt;ian@chiark.greenend.org.uk&gt;. They are Copyright 1999-2000,2002 Ian Jackson &lt;ian@davenant.greenend.org.uk&gt;, and Copyright 2000-2001 nCipher Corporation Ltd.</p><p>The sync-accounts package is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3, or (at your option) any later version.</p><p>This is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.</p><p>You should have received a copy of the GNU General Public License along with this program; if not, consult the Free Software Foundation's website at www.fsf.org, or the GNU Project website at www.gnu.org.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO sync-accounts&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/sync-accounts.8.html"><strong>sync-accounts</strong>(8)</a>,  <a href="../man8/grab-account.8.html"><strong>grab-account</strong>(8)</a>,  <a href="../man8/sync-accounts-createuser.8.html"><strong>sync-accounts-createuser</strong>(8)</a>,  <a href="../man5/passwd.5.html"><strong>passwd</strong>(5)</a>,  <a href="../man5/group.5.html"><strong>group</strong>(5)</a>,  <a href="../man5/shadow.5.html"><strong>shadow</strong>(5)</a>,  <strong>master.passwd</strong>(5),  <a href="../man8/vipw.8.html"><strong>vipw</strong>(8)</a>,  <strong>vigr</strong>(8)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="svnserve.conf.5.html"><span aria-hidden="true">&larr;</span> svnserve.conf.5: Repository configuration file for svnserve</a></li>
   <li class="next"><a href="sysctl.conf.5.html">sysctl.conf.5: Sysctl preload/configuration file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
