<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>powerman.dev: Powerman device specification files</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Powerman device specification files">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="powerman.dev (5) manual">
  <meta name="twitter:description" content="Powerman device specification files">
  <meta name="twitter:image" content="https://www.carta.tech/images/powerman-powerman.dev-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/powerman.dev.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="powerman.dev (5) manual" />
  <meta property="og:description" content="Powerman device specification files" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/powerman-powerman.dev-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">powerman.dev<small> (5)</small></h1>
        <p class="lead">Powerman device specification files</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/powerman.dev.5.html">
      <span itemprop="name">powerman.dev: Powerman device specification files</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/powerman/">
      <span itemprop="name">powerman</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/powerman.dev.5.html">
      <span itemprop="name">powerman.dev: Powerman device specification files</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>PowerMan device specifications are rather wierd.  For this reason, we suggest that you leave the writing of these scripts to the PowerMan authors.  However, if you insist, here is how they work.</p><p>Note: the authors do not guarantee that the PowerMan specification language will not change, however we are open to taking on maintenance of scripts submitted by PowerMan users.  We can't guarantee that we'll be able to test new releases against all devices but we'll do our best not to break anything.  NOTE: the best way to help us in this endeavor is to provide a ``simulator'' for your power controller and associated tests in the <em>test</em> subdirectory of the powerman source code. See the examples in that directory.</p><p>By convention, device scripts are one device per file and are included as needed from a powerman.conf file, like this:</p><ul>
<li>
<pre>
include "/etc/powerman/icebox3.dev"
</pre>
</li>
</ul><p>A device script is surrounded by an outer block:</p><ul>
<li>
<pre>
specification "my_device_name" {
    # configuration settings
    # script blocks
}
</pre>
</li>
</ul><p>The possible configuration settings are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>timeout &lt;float&gt;</em></p>
  </dt>
  <dd>
    <p>(optional) device script timeout in seconds - applies to each script, the whole thing, not just a particular "expect".</p>
  </dd>
  <dt>
    <p><em>plug name { &lt;string list&gt; }</em></p>
  </dt>
  <dd>
    <p>(optional) if plug names are static, they should be defined.  Any reference to a plug name in the powerman.conf must match one of the defined plug names.</p>
  </dd>
  <dt>
    <p><em>pingperiod &lt;float&gt;</em></p>
  </dt>
  <dd>
    <p>(optional) if a ping script is defined, and pingperiod is nonzero, the ping script will be executed periodically, every &lt;float&gt; seconds.</p>
  </dd>

</dl>
<p>Script blocks have the form:</p><ul>
<li>
<pre>
script &lt;script_name&gt; {
    # statements
}
</pre>
</li>
</ul><p>Script blocks should all be grouped together with no config lines in between. Scripts are for performing particular operations such as power on, get power status, etc. The various script names are listed below.  Those marked with [%s] are called with a plug name "argument", which can be included in a send statements by including a %s (printf style). Warning: all the send strings are processed with printf and you can cause powermand to segfault if you include any printf tokens other than the appropriate zero or one %s.</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>login</em></p>
  </dt>
  <dd>
    <p>Executed immediately on (re-)connect. If you need to login to the box, do it here. This is also a good place to descend through a first layer of menus. Caveat: % occurring in passwords must be escaped as %%. Caveat: occurs outside of client session so cannot be debugged with -T. A trick when debugging is to move this code into the status script temporarily so you can see what is going on.</p>
  </dd>
  <dt>
    <p><em>logout</em></p>
  </dt>
  <dd>
    <p>Executed prior to disconnect. Get device in a state so login script will work (though hopefully disconnecting will do that too).</p>
  </dd>
  <dt>
    <p><em>status_all, status[%s]</em></p>
  </dt>
  <dd>
    <p>Obtain plug state for all plugs or only the specified plug. When all plugs of a device are involved in a plug status query, the status_all script, if defined, will be called in preference to the status script; otherwise the status script is called for each plug.</p>
  </dd>
  <dt>
    <p><em>on_all, on_range[%s], on[%s]</em></p>
  </dt>
  <dd>
    <p>Power on all plugs, a range of plugs, or the specified plug.</p>
  </dd>
  <dt>
    <p><em>off_all, off_range[%s], off[%s]</em></p>
  </dt>
  <dd>
    <p>Power off all plugs, a range of plugs, or the specified plug.</p>
  </dd>
  <dt>
    <p><em>cycle_all, cycle_range[%s], cycle[%s]</em></p>
  </dt>
  <dd>
    <p>Power cycle all plugs, a range of plugs, or the specified plug. The intent of this command was to map to the RPC's cycle command; however, device script are increasingly implementing this in terms of a power off/delay/power so the off time can be controlled by the script.</p>
  </dd>
  <dt>
    <p><em>status_soft_all, status_soft[%s]</em></p>
  </dt>
  <dd>
    <p>Obtain soft power state for all plugs or only the specified plug. Soft Power refers to the "standby state" of the node. On means the node is powered up.  Off means either the node is powered off at the plug or is powered on at the plug and in standby mode. This is really only useful on devices that include both a plug relay and a probe into the node attached to a non-standby power source.</p>
  </dd>
  <dt>
    <p><em>status_temp_all, status_temp[%s]</em></p>
  </dt>
  <dd>
    <p>Obtain temperature reading for all plugs or only the specified plug. Temperature is obtained by sampling a thermocouple in the node. Results are reported as a text string - not interpreted by Powerman beyond any regex chopping done by the script.</p>
  </dd>
  <dt>
    <p><em>status_beacon_all, status_beacon[%s]</em></p>
  </dt>
  <dd>
    <p>Obtain beacon state for all plugs or only the specified plug. Some RPC's include a way to flash a light on a node.</p>
  </dd>
  <dt>
    <p><em>beacon_on[%s]</em></p>
  </dt>
  <dd>
    <p>Flash beacon on the specified plug.</p>
  </dd>
  <dt>
    <p><em>beacon_off[%s]</em></p>
  </dt>
  <dd>
    <p>Clear beacon on the specified plug.</p>
  </dd>
  <dt>
    <p><em>reset_all, reset_range[%s], reset[%s]</em></p>
  </dt>
  <dd>
    <p>Reset all plugs, a range of plugs, or only the specified plug. Reset refers to signaling a motherboard reset butten header, not a plug cycle.</p>
  </dd>

</dl>
<p>Within a script, the following statements can be used:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>send &lt;string&gt;</em></p>
  </dt>
  <dd>
    <p>Send &lt;string&gt; to the device.</p>
  </dd>
  <dt>
    <p><em>delay &lt;float&gt;</em></p>
  </dt>
  <dd>
    <p>Pause script for &lt;float&gt; seconds.</p>
  </dd>
  <dt>
    <p><em>expect &lt;string&gt;</em></p>
  </dt>
  <dd>
    <p>&lt;string&gt; is compiled as a regular expression with <a href="../man3/regcomp.3.html"><strong>regcomp</strong>(3)</a>.  The regular expression is matched against device input.  The script blocks until the regex is matched or the device timeout occurs (in which case the script is aborted).  Upon matching, any parenthesized expressiones are assigned to variables: $1 for the first match, $2 for the second match, and so on.  Warning: some implementations of <a href="../man3/regex.3.html"><strong>regex</strong>(3)</a> silently fail if the regular expression exceeds available static storage.</p>
  </dd>
  <dt>
    <p><em>setplugstate [&lt;string&gt;|&lt;regmatch&gt;]  &lt;regmatch&gt; [off=&lt;string&gt;] [on=&lt;string&gt;]</em></p>
  </dt>
  <dd>
    <p>Set the plug state.  The first argument, if present, is the literal plug name or a &lt;regmatch&gt; from the previous expect which contains the plug name.  If omitted, the plug name is presumed to be the script argument. The off and on strings are compiled regexes, which if matched by the second argument, result in the plug state being set to off or on. Yes we are applying regexes to regmatches! If no off or on strings are provided, state will be unknown.</p>
  </dd>
  <dt>
    <p><em>ifoff, ifon</em></p>
  </dt>
  <dd>
    <p>Script statements enclosed in an ifon/ifoff block are conditional executed based on the state of the plug passed in as an argument. Ifon/ifoff blocks can only be used in single plug scripts that take an argument.</p>
  </dd>
  <dt>
    <p><em>foreachplug</em></p>
  </dt>
  <dd>
    <p>Script statements enclosed in a foreachplug block are executed iteratively with a %s argument defined for each target plug. Foreachplug blocks can only be used in all plug scripts that take no argument.</p>
  </dd>

</dl>
<p>Script terminals are  defined as follows:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>&lt;float&gt;</em></p>
  </dt>
  <dd>
    <p>decimal number - exponent forms not supported</p>
  </dd>
  <dt>
    <p><em>&lt;string&gt;</em></p>
  </dt>
  <dd>
    <p>Text surrounded by double quotes. May contain C style backslash-escaped characters, including three digit octal values, and most common backslash-escaped single character values.</p>
  </dd>
  <dt>
    <p><em>&lt;string list&gt;</em></p>
  </dt>
  <dd>
    <p>Multiple &lt;string&gt; values separated by white space.</p>
  </dd>
  <dt>
    <p><em>&lt;script_name&gt;</em></p>
  </dt>
  <dd>
    <p>Name of script (see above).</p>
  </dd>
  <dt>
    <p><em>&lt;regmatch&gt;</em></p>
  </dt>
  <dd>
    <p>Results of a parenthesized regular expression match are assigned to $1, $2, ... $N.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/etc/powerman/*.dev</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ORIGIN</h2>
        <div class="sectioncontent">
<p>PowerMan was originally developed by Andrew Uselton on LLNL's Linux clusters. This software is open source and distributed under the terms of the GNU GPL.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO powerman.dev&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/powerman.1.html"><strong>powerman</strong>(1)</a>, <a href="../man8/powermand.8.html"><strong>powermand</strong>(8)</a>, <a href="../man8/httppower.8.html"><strong>httppower</strong>(8)</a>, <a href="../man8/plmpower.8.html"><strong>plmpower</strong>(8)</a>, <a href="../man8/vpcd.8.html"><strong>vpcd</strong>(8)</a>, <a href="../man5/powerman.conf.5.html"><strong>powerman.conf</strong>(5)</a>, <a href="../man5/powerman.dev.5.html"><strong>powerman.dev</strong>(5)</a>, <a href="../man7/powerman-devices.7.html"><strong>powerman-devices</strong>(7)</a>.</p><p><strong>http://sourceforge.net/projects/powerman</strong></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="powerman.conf.5.html"><span aria-hidden="true">&larr;</span> powerman.conf.5: Configuration file for powerman</a></li>
   <li class="next"><a href="ppdcfile.5.html">ppdcfile.5: Cups ppd compiler source file format <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
