<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>super.tab: Database of restricted commands for super(1)</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Database of restricted commands for super(1)">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="super.tab (5) manual">
  <meta name="twitter:description" content="Database of restricted commands for super(1)">
  <meta name="twitter:image" content="https://www.carta.tech/images/super-super.tab-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/super.tab.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="super.tab (5) manual" />
  <meta property="og:description" content="Database of restricted commands for super(1)" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/super-super.tab-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">super.tab<small> (5)</small></h1>
        <p class="lead">Database of restricted commands for super(1)</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/super.tab.5.html">
      <span itemprop="name">super.tab: Database of restricted commands for super(1)</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/super/">
      <span itemprop="name">super</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/super.tab.5.html">
      <span itemprop="name">super.tab: Database of restricted commands for super(1)</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <em>super.tab</em> file contains the restrictions on who can execute commands with <a href="../man1/super.1.html"><strong>super</strong>(1)</a>. It may also contain options that modify the uid and/or gid under which a command is run; the list of environment variables that are discarded before executing a command, and so on. The reader is expected to be familiar with the <a href="../man1/super.1.html"><strong>super</strong>(1)</a> man page.</p><p>If you are trying to avoid reading this lengthy man page, you need to know a few simple rules.  First, for a user to successfully execute a command by typing <em>super</em>commandName<em>,</em> the minimum entry in the <em>super.tab</em> is something like <strong>commandName&nbsp;&nbsp;FullPathToCommand&nbsp;&nbsp;userName</strong></p><p>For example, the entry <strong>cdmount&nbsp;&nbsp;/usr/local/bin/cdmount&nbsp;&nbsp;wally,dolly</strong></p><p>says that users <em>wally</em> and <em>dolly</em> may execute the /usr/local/bin/cdmount program by typing <em>super</em>cdmount<em>.</em></p><p>Second, when you define options in the <em>super.tab</em> file, remember that all options are orthogonal to each other, and it doesn't matter in what order they appear on a control line. Third, <em>global</em> options (defined on a <strong>:global</strong> or <strong>:global_options</strong> line) take effect immediately after the defining line, are valid until the end of the input or until there is a countermanding global option or pattern, and are overridden by <em>local</em> (per-command) options, which are defined on a regular control line.</p><p>Although <em>super</em> has a great many options that you can set inside the <em>super.tab</em> file, none of them are required for security, so you don't have to be intimately familiar with this entire document in order to use <em>super</em> securely. The most important options that you will probably want to use are (a) a logging option like <em>logfile=</em>xxx or <em>syslog=y</em>; and (b) <em>patterns=shell</em>, so that the default regular-expression interpretation of wildcards is changed to the more convenient shell-style glob patterns.</p><p>Unless modified with options in the <em>super.tab</em> file, super executes commands using effective uid root; unchanged real uid and gid; no supplementary groups; no open file descriptors save 0, 1, and 2; no environment variables except a few with safe values (see <a href="../man1/super.1.html"><strong>super</strong>(1)</a>); and signal handling reset to the default.</p><p>When <em>super</em> uses a command from a user-supplied super file (<em>.supertab</em> in the user's home directory) these rules are modified: the real and effective uid and gid are set to the owner of the <em>.supertab</em> file, and the supplementary groups are set to the user's login groups.</p><p>If the special supplementary file named <em>super.init</em> exists, it is implictly include at the start of <em>super.tab</em> and every <em>.supertab</em> file.  The file resides in the same directory as <em>super.tab</em> and must be owned by root, and should be world-readable. This provides a uniform configuration file applied to every super-executed command.  Note that the configuration file should contain entries that are appropriate for use in both the <em>super.tab</em> file and any per-user <em>supertab</em> file. It is not a good idea to include commands in the <em>super.init</em> file. The variable <strong>IS_USERTAB</strong> is defined to be ``<em>yes</em>'' if <em>super</em> is processing a per-user .supertab file, and ``<em>no</em>'' otherwise. The following pair of entries could be used in a super.init file to allow different initialization for regular use and per-user use:</p>
<pre>
<strong>:if $IS_USERTAB == yes &nbsp;&nbsp;&nbsp;:include /etc/super.init.per-user</strong>
<strong>:if $IS_USERTAB != yes &nbsp;&nbsp;&nbsp;:include /etc/super.init.as-root</strong>
</pre>
<p>(The use of variables and conditional expressions is explained below, in the sections <em>Variables</em> and <em>Conditionally-included</em>Control<em>Lines</em>, respectively.)</p><p>The <em>super.tab</em> file is formatted as a series of control lines of the form</p><p><strong>CmdPat&nbsp;&nbsp;FullPath&nbsp;&#92;&#92;</strong> <strong>Options&nbsp;PermittedUsers&nbsp;PermittedTimes</strong></p><p>or</p><p><strong>CmdPat1::FullPath1&nbsp;CmdPat2::FullPath2&nbsp;...&nbsp;&#92;&#92;</strong> <strong>Options&nbsp;PermittedUsers&nbsp;PermittedTimes</strong></p><p>or</p><p><strong></strong><em>:</em><strong>BuiltinCmd arguments</strong></p><p>The <em>Options</em>, <em>PermittedUsers</em>, and <em>PermittedTimes</em> may be mixed together in any order. At least one <em>PermittedUsers</em> field is required, but neither <em>Options</em> nor <em>PermittedTimes</em> are required. For each control line, <em>Super</em> matches the following:</p><p>&bull; the user-entered command to a <em>CmdPat</em>; &bull; the {user,group,host} triplet to a <em>PermittedUsers</em> entry; and &bull; the current time to a <em>PermittedTimes</em> entry (the default permits any time).</p><p>If these conditions are not satisfied, <em>super</em> ``falls through'' and tries the next control line.</p><p>For example, the entry</p>
<pre>
<strong>renice&nbsp;/etc/renice&nbsp;jack@hill jill@bucket time~8-17</strong>
</pre>
<p>specifies that between hours 8:00 and 17:00, user Jack can renice any process on host hill, and user Jill can do so on host bucket, by simply typing <strong>super renice &lt;args&gt;  .</strong></p><p>Control lines begin in column 1, and the fields are whitespace-separated. Note that you can either use a single <em>CmdPat</em> and <em>FullPath</em>, separated by whitespace, or you can use a series of them in one control line by putting `<strong>::</strong>' between each <em>CmdPat</em> and <em>FullPath</em> pair.</p><p>Whitespace may be included in a field by enclosing text in single- or double-quotes.  The quoting is shell-like, in the sense that quotemarks don't have to surround the entire field, and you can switch between quotemark types in a single entry.  For instance, <strong>X"a&nbsp;b"Y'd&nbsp;e'</strong> is equivalent to <strong>"Xa&nbsp;bYd&nbsp;e"</strong>. Comments begin with a `#' and continue to the end of a line.</p><p>There can also be blank or comment lines without any control data.</p><p>A control line may be continued by preceding the newline with a backslash, and indenting the continuation line with whitespace. When the multiple-line entry is read, the text just before the backslash-newline is not modified (any whitespace before the backslash will be kept), and the backslash-newline-whitespace sequence is either eliminated entirely or treated as whitespace. The rule is simple: following a letter, digit, or underscore, it is treated as whitespace.  Otherwise, it is eliminated.  This means that</p>
<pre>
<strong>Cmd&nbsp;&nbsp;File&nbsp;&nbsp;user1&#92;</strong>
<strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user2&#92;</strong>
<strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user3</strong>
</pre>
<p>is equivalent to</p><p><strong>Cmd&nbsp;&nbsp;File&nbsp;&nbsp;user1 user2 user3</strong></p><p>On the other hand,</p>
<pre>
<strong>Cmd&nbsp;&nbsp;File&nbsp;&nbsp;{user1,&#92;</strong>
<strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user2,&#92;</strong>
<strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user3}</strong>
</pre>
<p>is equivalent to</p><p><strong>Cmd&nbsp;&nbsp;File&nbsp;&nbsp;{user1,user2,user3}</strong></p><p>That is, the sensible interpretation is done in both cases.</p><p>The indentation requirement for continuation lines helps <strong>super</strong> catch typos. Comments may be placed before each backslash-newline pair, not just at the end of a continued control line.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">The CmdPat Field</h2>
        <div class="sectioncontent">
<p>In response to the user typing</p><p><strong>super</strong> <em>cmd</em> [<em> args </em>],</p><p>the <em>cmd</em> is searched for in the <em>super.tab</em> file. The <em>cmd</em> is matched against each pattern <em>CmdPat</em>.</p><p><strong>Basic Use: Simple Command Patterns without Wildcards.</strong></p><p>Typically, a <em>CmdPat</em> just uses plain characters without any special pattern-matching characters, so a <em>cmd</em> must be the same as the <em>CmdPat</em> string.  For example:</p><p><strong></strong> skill /usr/local/bin/skill   user1 user2 user3</p><p>Here, any user in the list {user1, user2, user3} may type <strong>super skill</strong> to execute /usr/local/bin/skill.</p><p><strong>Advanced Use: Command Patterns with Wildcards.</strong></p><p>More generally, a <em>CmdPat</em> can be either an <em>ed</em>-style pattern (``regex'' &ndash; the BSD&nbsp;4.x syntax used in the re_comp()/re_exec() routines), POSIX regular expressions, or a Bourne-shell-style pattern.  You can set the pattern style using the global option <strong>patterns</strong> (see below). The default is ``regex'' for historical reasons; however, shell-style patterns are easier to use without errors, and most sites should use shell-style patterns. In all cases the patterns are extended to support csh-style brace expansion. For instance, <strong>a{x,y,z}b</strong> stands for the set of patterns <strong>axb ayb azb</strong>. Don't put any whitespace inside the braces!</p><p>For convenience, there is always an implied set of braces around an entire pattern. This means that any comma-separated list <strong>a,b,c</strong> is interpreted as <strong>{a,b,c}</strong>, and is very helpful so that you don't have to worry about getting braces just right when you build complex lists of out of (say) variables containing other lists of users.</p><p>All pattern matching is ``anchored'': patterns are forced to match the entire <em>cmd</em> string.</p><p>If the <em>CmdPat</em> is matched and the other conditions are met (such as the user being in the PermittedUser list to execute this command), <em>FullPath</em> gives the name of the actual command that will be executed with <em>execve()</em>. If <em>FullPath</em> contains an asterisk, the asterisk is first replaced by the user's <em>cmd</em>.</p><p>If you put special pattern-matching characters into the <em>CmdPat</em>, but don't put an asterisk into <em>FullPath</em>, you have simply given more ways a user can execute the same <em>FullPath.</em> This isn't useful, and in fact isn't a good idea at all. The power of using patterns in the <em>CmdPat</em> comes when <em>FullPath</em> includes an asterisk. For instance, a SysV-based host might have an entry in the <em>super.tab</em> file that looks like:</p><p><strong>/usr/bin/{lp,lpstat,disable,enable,cancel} * &#92;</strong></p><p><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:operators uid=0</strong></p><p>This would allow anybody in the "operators" group to have root access to the line printer commands (the <em>uid=0</em> tells <strong>super</strong> to set the real uid to 0, not just the effective uid). For instance, if the user typed:</p><p><strong>super /usr/bin/disable </strong><em>some_printer</em></p><p>then the <em>FullPath</em> (``<strong>*</strong>'') would be replaced by <strong>/usr/bin/disable</strong>, which would be the command to exec.</p><p>More conveniently, the <em>super.tab</em> file could have a line like:</p><p><strong>{lp,lpstat,disable,enable,cancel} /usr/bin/* &#92;</strong></p><p><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:operators uid=0</strong></p><p>In this case, the user can type</p><p><strong>super disable </strong><em>some_printer</em></p><p>The asterisk-replacement ability also lets a user execute any of an entire directory of commands, using a <em>super.tab</em> entry like the following:</p><p><strong>op/* /usr/local/super/scripts/* :operators uid=0</strong></p><p>In this case, the user can type</p><p><strong>super op/</strong><em>xyz</em></p><p>and <em>super</em> will execute <em>/usr/local/super/scripts/op/xyz.</em></p><p>The asterisk-replacement capability is useful but potentially dangerous, because it may unintentionally open the door to programs you hadn't intended to give away. It is a sensible precaution to restrict asterisk-replacement to entries where the valid-user list includes trusted users only.</p><p>If you <em>completely</em> trust some users, but want logging of all actions executed as root, you could use:</p><p><strong>/* &nbsp;&nbsp;* &nbsp;&nbsp;</strong><em>ReallyReallyTrustedUsers</em><strong></strong></p><p>or</p><p><strong>/.* &nbsp;&nbsp;* &nbsp;&nbsp;</strong><em>ReallyReallyTrustedUsers</em><strong></strong></p><p>(depending on whether <strong>patterns=shell</strong>, <strong>patterns=regex</strong>, or <strong>patterns=posix</strong>).</p><p>The trusted users can now execute any command.  Note that the pattern begins with a slash, to ensure that the <em>cmd</em> must be an absolute path &ndash; this helps avoid accidental execs of the wrong program.</p><p>If you were really going to give everything away as shown above, you'd probably want to exclude any public-area workstations, require the trusted users to periodically give their passwords, and set the real uid=root (instead of just the effective uid), so the entry might be modified to read something like:</p>
<pre>
<strong>/* &nbsp;&nbsp;* &nbsp;&nbsp;</strong><em>TrustedUsers</em><strong> &#92;</strong>
<strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!{</strong><em>PatternsOfPublicWorkstations</em><strong>} &#92;</strong><em></em>
<strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;password=y timeout=5 uid=0</strong>
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">The FullPath Field</h2>
        <div class="sectioncontent">
<p>The <em>FullPath</em> field gives the name of the actual command that will be executed, and if it contains an asterisk, the asterisk is first replaced by the user's <em>cmd</em> string. The <em>FullPath</em> can optionally contain a list of initial arguments that precede any arguments passed by the user. For example,</p><p><strong>xyz	"/usr/local/bin/blah -o1 -o2 -xrm 'a b c'" ...</strong></p><p>specifies that when a valid user types <strong>super xyz</strong>, the command to execute is <strong>/usr/local/bin/blah</strong> and its arguments will be</p><p>argv[1]: <strong>-o1</strong></p><p>argv[2]: <strong>-o2</strong></p><p>argv[3]: <strong>-xrm</strong></p><p>argv[4]: <strong>a b c</strong></p><p>followed by any arguments that the user put on the super command line. Note: asterisk replacement is only done on the filename part of the <em>FullPath</em>, not on the arguments.  You can safely include asterisks in the argument list.  For security, the user's <em>cmd</em> may not contain any whitespace or backslashes.</p><p>The <em>FullPath</em> string is parsed using rules similar to the Bourne shell rules for backslashes in quoted strings, namely:</p><p>(a) backslash-newline is discarded;</p><p>(b) Otherwise, if outside a quoted substring, <strong>&#92;</strong><em>x</em> \(-&gt; plain <em>x</em>, which will not be treated as a delimiter, quotemark, or comment character;</p><p>(c) Otherwise, inside a quoted substring of <em>FullPath</em>:</p><p><strong>&#92;&#92;</strong> \(-&gt; <strong>&#92;</strong>;</p><p><strong>&#92;</strong><em>q</em> \(-&gt; <em>q</em>, where <em>q</em> is the quote character that encloses the <em>FullPath</em> string;</p><p>other backslashes are preserved: <strong>&#92;x</strong> \(-&gt; <strong>&#92;x</strong>.</p><p>After writing a command with such backslash escapes, you should certainly use ``<strong>super</strong>-d<strong>cmd</strong>'' to check that your args are being parsed as expected before you offer this command to your users.</p><p>The same <em>cmd</em> can be listed several times in the <em>super.tab</em> file, in which case the first entry that allows the user to execute the command is chosen. The EXAMPLES section shows how this can be useful.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Permitted Users</h2>
        <div class="sectioncontent">
<p>Permitted users are those who may execute the specified <em>Cmd</em>'s. Entries for any number of permitted users are given after the <em>CmdPat</em> and <em>FullPath</em> fields. Local options &ndash; options that apply to this command only &ndash; may also appear anywhere after the <em>FullPath</em>. Options are distinguished from permitted users because options all have the form <em>key</em>=<em>value</em>, whereas permitted-user entries may not contain unescaped equal signs. Each whitespace-separated word is a pattern in one of the formats</p><p>&bull;	[<strong>user~</strong>]<em>user</em>[<strong>:</strong>][<strong>@</strong><em>host</em>]</p><p>&bull;	[<strong>user~</strong>]<strong>:</strong><em>group</em>[<strong>@</strong><em>host</em>]</p><p>&bull;	[<strong>user~</strong>]<em>user</em>[<strong>:</strong><em>group</em>][<strong>@</strong><em>host</em>]</p><p>Note that the <strong>user~</strong> part is optional. The user's login name must match the <em>user</em> pattern; the user must belong to a group whose name matches the <em>group</em> pattern; and the hostname must match the <em>host</em> pattern. If the <em>user,</em> <em>group,</em> or <em>host</em> part is not given, there are no corresponding restrictions.</p><p>If the user is root, <em>super</em> acts as if all permitted-user patterns are preceded by the pattern <strong>user~root</strong> &ndash; that is, root's rule is default-allow, instead of the default-deny rule that applies to all ordinary users.</p><p>By default, the ``group'' field is first matched against named groups to which the user belongs, and then against the user's decimal gid &ndash; this allows the user to be put in a group in the /etc/passwd file that isn't given a name in the /etc/group file. (If you want to change the rules for using decimal gid, see the use of MATCH_DECIMAL_UID and MATCH_DECIMAL_GID in <em>super.c</em> for details.)</p><p>Since you can restrict users to particular hosts, a single <em>super.tab</em> file can be shared among many different machines. If the <em>host</em> part is of the form <strong>+</strong><em>xyz</em><strong>,</strong> then <em>xyz</em> is interpreted as a netgroup name and any host in netgroup <em>xyz</em> is matched.  In that case, <em>xyz</em> is taken literally, and <em>not</em> interpreted as a pattern to be matched. Note: netgroup lookup is only implemented if the function <em>innetgr()</em> is available.</p><p>If the <em>host</em> part doesn't match the hostname, it might be because the pattern and actual hostnames contain two different (but both valid) incomplete versions of the fully-qualified domain name (FQDN). By default, if the <em>host</em> part fails to match the hostname, the FQDN is looked up and all of the ways of naming the host are matched against the pattern. For example, if the FQDN is <em>spacely.sprockets.com</em>, <strong>super</strong> will first try <em>spacely.sprockets.com</em>, then <em>spacely.sprockets</em>, and finally <em>spacely</em>. This can be turned off; see option <strong>gethostbyname</strong>. (You might want to turn it off because using nameserver lookup can reduce security a bit &ndash; your host may query a nameserver on another host to obtain the FQDN, and (a) that nameserver or an intermediate host along the way could have been subverted, or (b) another host could impersonate the nameserver. In either case your computer could receive incorrect hostnames.)</p><p>The patterns for valid users, groups, and hosts follow the same rules for the <em>CmdPat</em>s, described above: they can be entered with either <em>ed</em>-style or Bourne-shell-style patterns (depending on the setting of the <strong>patterns</strong> global option); csh-style brace expansion is allowed; and all pattern matching is ``anchored'': patterns are forced to match the entire username, groupname, or hostname.</p><p>To make it easy to exclude some users/groups/hosts, any of these patterns can be negated by prefixing the pattern with `<strong>!</strong>'.  If a negated pattern is matched, the user may <em>not</em> execute the command, even if there was a previous non-negated pattern that the user matched. All patterns are read left-to-right, and the last matched pattern ``wins''.  Thus if the user/group/host list is</p><p><strong>j.* !jo</strong></p><p>or</p><p><strong>user~j.* !user~jo</strong></p><p>then the first entry allows any username beginning with `<strong>j</strong>' to execute the command, but the second entry disallows user `<strong>jo</strong>'. If entered in the reverse order,</p><p><strong>!jo j.*</strong></p><p>then the second entry, `<strong>j.*</strong>', allows all users beginning `<strong>j</strong>', and therefore the first entry has no effect.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Permitted Times</h2>
        <div class="sectioncontent">
<p>The <strong>time</strong> condition restricts the days and times during which this command may be matched.  If the execution time isn't acceptable, then super ignores the control line, and ``falls through'' to inspect the next entry, just as it does if the user/group/host aren't acceptable. A time condition looks like: <strong>time~</strong><em>pattern</em></p><p>with <em>pattern</em>s that look like:</p><p><em>Pattern	Example</em></p><p><strong>hh</strong>[<strong>:mm</strong>]<strong>-hh</strong>[<strong>:mm</strong>][<strong>/dayname</strong>]	13:30-17/monday</p><p>{<strong>&lt;</strong>,<strong>&gt;</strong>,<strong>&lt;=</strong>,<strong>&gt;=</strong>}<strong>hh</strong>[<strong>:mm</strong>][<strong>/dayname</strong>]	&lt;17/tues</p><p><strong>dayname</strong>	Friday</p><p>The first form explicitly specifies an interval during which the command may be used.  Times may not go past midnight; to specify the night between Monday and Tuesday, you must do something like:</p><p><strong>time~{17:30-24:00/mon,0-8/tues}</strong></p><p>The second form for time patterns allows you to use logical operators. The Monday-night example could equally have been rendered as:</p><p><strong>time~{&gt;17:30/mon,&lt;8/tues}</strong></p><p>(There is a tiny difference in the two examples above: in the first example, the time range includes 17:30 and 8:00; in the second example, the time range is 17:31-07:59.  Use <strong>time~{&gt;=17:30/mon,&lt;=8/tues}</strong> to make the interpretation identical to the first example.)</p><p>If there are a series of time patterns, they are evaluated left-to-right, and the rightmost matching pattern is used. To permit execution between 17:30 Monday and 8:00 Tuesday, but exclude 0:00 to 1:00 Tuesday, use:</p><p><strong>time~{&gt;=17:30/mon,&lt;=8/tues}&nbsp;&nbsp;!time~{0-1/tues}</strong></p><p>By default, valid <em>dayname</em>s are English, but if your system supports the <em>setlocale(</em>3<em>)</em> function, the global option <strong>lang=</strong><em>zzz</em> will set the valid names to those of locale <em>zzz</em>. Valid <em>dayname</em>s are either (a) the full names of the chosen language; (b) an official abbreviated day name for that language; (c) a 3-or-more character abbreviation of the full weekday; or (d) <strong>*</strong>, meaning any day. (You can check on super's valid daynames by executing <em>super</em>-d<em>,</em> which will show the default names of the weekdays at or near the top of its debugging output, and show the new weekday names that take effect when the <strong>lang=</strong><em>zzz</em> option is encountered.)</p><p>Time patterns have a special defaulting rule when the execution time is not in one of the intervals in the time list:</p><p>&bull; if <em>all</em> time patterns are negated, <em>super</em> permits execution at any time not in one of the listed intervals;</p><p>&bull; otherwise, there is at least one non-negated pattern, and <em>super</em> defaults to deny execution at times outside the specified acceptable intervals.</p><p>The reason is that the natural interpretation of a series of negated conditions, such as</p><p><strong>!time~{0-8,17-24} !time~{sat,sun}</strong></p><p>is to infer that all other times are acceptable for execution. On the other hand, if there are any ordinary, non-negated times, such as</p><p><strong>time~8-17/{mon,tues,wed,thu,fri}</strong></p><p>the natural interpretation is that any times not explicitly mentioned are not acceptable.</p><p>Note that explicit braces are important in the above list.  If they were missing, the implied braces around the entire pattern would render this equivalent to</p><p><strong>time~8-17/mon time~tues time~wed time~thu time~fri</strong></p><p>That is, the permitted times are 8-17h on Monday, and any time on Tuesday through Friday.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Global Conditions</h2>
        <div class="sectioncontent">
<p>Global options and conditions affect the overall <strong>super</strong> processing.  To set them, you must use a line like</p><p><strong>:global</strong>		<em>Global&nbsp;Options&nbsp;And&nbsp;Patterns</em></p><p>or</p><p><strong>:global_options</strong>	<em>Global&nbsp;Options&nbsp;And&nbsp;Patterns</em></p><p>For backwards compatibility, you can alternatively use</p><p><strong>/	/	</strong><em>GlobalOptionsAndPatterns</em></p><p>but this use is discouraged.</p><p>These so-called ``global'' options and conditions actually take effect immediately after the line on which they appear, and are valid until the end of the input or until there is a countermanding global option or pattern. To have a global option or pattern affect the entire file, you must place it as the <em>first non-comment line</em> of the <em>super.tab</em> file.</p><p>If there are any PermittedUser or PermittedTime conditions on the global settings line, they are applied to each following command in the <em>super.tab</em> file. The conditions look like</p><p><strong>:global	</strong><em>cond cond ...  </em><strong>&lt;&gt;</strong><em> </em><em>cond cond ...</em></p><p>PermittedUser and PermittedTime conditions to the left of ``<strong>&lt;&gt;</strong>'' are processed <em>before</em> the local (per-command) conditions; conditions to the right of ``<strong>&lt;&gt;</strong>'' are processed <em>after</em> the per-command conditions. If ``<strong>&lt;&gt;</strong>'' is missing, all conditions are processed after the local conditions. Example 1:</p><p><strong>:global jan &lt;&gt; !@+badhosts</strong></p><p>says that user <em>jan</em> can usually execute any command, but under no circumstances will a user on any host in netgroup <em>badhosts</em> be allowed to execute any command. (User <em>jan</em> will not be allowed to execute a command if the per-command conditions disallow it, or if <em>jan</em> is on one of the <em>badhosts</em> computers).</p><p>Example 2:</p><p><strong>:global !root &lt;&gt;</strong></p><p>changes <em>root</em>'s default setting from default-allow to default-deny, just like ordinary users.  Root will only be given execute permission for entries that explicitly allow root on the per-entry line.</p><p>Global PermittedUser (PermittedTime) conditions take effect on the line on which they are defined, and are good until another set of global PermittedUser (PermittedTime) conditions is entered on another <strong>:global_option</strong> line.  That is, a new global condition line replaces any previous global conditions.</p><p>One sensible approach to using global conditions is to put conditions that allow users to execute commands <em>before</em> the per-command conditions are processed, and to put negating patterns (for users/groups/hosts that are never to be allowed to execute anything) <em>after</em> the per-command conditions.</p><p>(Global options are discussed below, together with local options).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Conditionally-included Control Lines</h2>
        <div class="sectioncontent">
<p>Control lines can be conditionally included by using the <strong>:if</strong> control line.  This can be helpful when using a single <em>super.tab</em> file for hosts with different architectures, or hosts in different NIS domains, etc. The syntax is:</p><p><strong>:if  </strong><em>left &nbsp;&nbsp;op &nbsp;&nbsp;</em><em>right</em><em> &nbsp;&nbsp;&nbsp;&nbsp;</em><em>moreText</em><em></em></p><p>The expression <em>left op right</em> is evaluated, and if true, <em>moreText</em> is evaluated as an ordinary control line.  The valid comparison operators are:</p><p>&bull;	==	string equality</p><p>&bull;	!=	string inequality</p><p>&bull;	~	glob match string <em>left</em> against pattern <em>right</em></p><p>&bull;	!~	negated glob-match.</p><p>For example, you could include a file of commands only valid on Sun4-type machines as follows:</p>
<pre>
<strong>:if $UNAME_MACHINE ~ sun* &#92;</strong>
<strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:include &nbsp;/Path/To/Sun4/File</strong>
</pre>
<p>(UNAME_MACHINE is a variable automatically defined by <em>super</em>; see the following section on variables.)</p><p>If you wanted to exclude Sun4c-type machines from using the file, you could modify this to be:</p>
<pre>
<strong>:if $UNAME_MACHINE ~ sun* &#92;</strong>
<strong>&nbsp;&nbsp;&nbsp;&nbsp;:if $UNAME_MACHINE != sun4c &#92;</strong>
<strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:include &nbsp;/Path/To/Sun4/File</strong>
</pre>
<p>There are no boolean operators provided, but note that there is an implicit boolean <strong>and</strong> available by concatenating <strong>:if</strong> commands, as shown in the second example above.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Variables</h2>
        <div class="sectioncontent">
<p><strong>Super</strong> offers variables to make it easier to handle entries that are duplicated or are constructed out of other entries. Variables are defined by typing</p><p><strong>:define VariableName VariableDefinition</strong></p><p>or they may be imported from the environment by using</p><p><strong>:getenv </strong><em>[</em><strong>EnvVarName</strong><em>...]</em></p><p>If you use the <strong>:getenv</strong> command, then the values of any imported environment variables may only contain the following ``safe'' characters: <strong>-/:+._a-zA-Z0-9.</strong> If ``bad'' characters are found in a value, the entire value is replaced with an empty string. Note that these imported variables do <em>not</em> enter the environment of any executed command; they simply become part of the super.tab variable set.</p><p>The <em>VariableName</em> should be made up only of letters, digits, and/or underscore. (You can actually use any characters you wish, but super doesn't promise to work correctly if you use characters outside the standard set.)</p><p>The <em>VariableDefinition</em> begins at the first non-whitespace character after the <em>VariableName</em> and continues up to but not including the final newline. Comments embedded on the variable definition line(s) are deleted before the variable definition is stored. A variable definition may be continued across multiple lines by preceding each newline with a backslash, and indenting the continuation line with whitespace. Just as for regular control lines, the backslash-newline-whitespace sequence is treated as whitespace if it follows a letter, digit, or underscore; otherwise, it is eliminated.  For example,</p>
<pre>
<strong></strong>
:define  Users   user1,&#92;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user2,&#92;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user3
</pre>
<p>and</p><p>:define Users   user1,user2,user3</p><p>are equivalent definitions.</p><p>Unlike Makefiles, the variable definitions are not scanned first and then the file re-scanned.  Instead, variables take effect at the point they are defined, and remain in effect until they are re-defined or end of file &ndash; thus variables definitions must precede their first use in the file.</p><p>Variables may contain other variables (which must have already been defined).  Variable substitution is done when a line is first read. A line is never re-scanned after variable substitution.</p><p>Variables are used in a file by typing</p><p><strong>$VariableName</strong></p><p>or</p><p><strong>$(VariableName)</strong></p><p>The special variable <strong>$$</strong> is replaced by a single ``<strong>$</strong>''. Any other name <strong>$</strong><em>X</em> (where <em>X</em> is not a letter, digit, or underscore) is an error.</p><p>Because a line is never re-scanned after variable substitution, the following sequence:</p>
<pre>
<strong>:define A $$</strong>
<strong>:define B A</strong>
<strong>:define C $B $$B</strong>
<strong>$C</strong>
</pre>
<p>defines <strong>C</strong> to be simply ``<strong>A</strong>$B<strong>''.</strong></p><p>Variables can be helpful in grouping users or hosts together. For example, you might restrict access to a command so that it can't be run from a public-access workstation:</p>
<pre>
<strong>:define Room103_WS hosta,hostb,hostc,hostd</strong>
<strong>:define Room105_WS hoste,hostf,hostg,hosth</strong>
<strong>:define Room106_WS +nonprivate</strong>
<strong>:define PublicWorkstations $Room103_WS,$Room105_WS,$Room106_WS</strong>
<strong>SomeCmd FullPathHere !@$(PublicWorkstations)</strong>
</pre>
<p>In the above example, we have taken advantage of the implied braces that are always placed around any pattern, so that the comma-separated list of workstations is brace-expanded into <strong>!@hosta</strong> <strong>!@hostb&nbsp;...&nbsp;!@hoste</strong> <strong>!@hostf</strong>...<strong>!@+nonprivate</strong>.</p><p>Some variables are automatically defined by <em>super.</em></p><p>After super determines whether it is processing a per-user .supertab (see <a href="../man1/super.1.html"><strong>super</strong>(1)</a>), it defines <strong>IS_USERTAB</strong> to be ``<em>yes</em>'' if <em>super</em> is processing a per-user .supertab file, and ``<em>no</em>'' otherwise. The allows the super.init to act differently depending on how it is being invoked.</p><p>When the top-level <em>super.tab</em> file is opened, <strong>SUPER_OWNER</strong> is set to the login name of the owner, and <strong>SUPER_HOME</strong> is set to the home directory of the owner. This can be useful in per-user <em>.supertab</em> files, especially when they include files shared among several accounts. For example, each person's <em>.supertab</em> file could be simply</p><p><strong>:include /opt/proj/common.supertab owner=cristy</strong></p><p>Then, the <em>/opt/proj/common.supertab</em> file can use entries like the following:</p><p><strong>:global logfile=$SUPER_HOME/.superlog</strong></p><p><strong>* /project/tools/$SUPER_OWNER/* :toolgroup</strong></p><p>Because the <strong>SUPER_HOME</strong> and <strong>SUPER_OWNER</strong> variables apply to the top-level per-user files, they always refer to per-user locations.</p><p>Super defines the built-in variable <strong>CALLER</strong> to be the the login name of the of account invoking super, and <strong>CALLER_HOME is the home directory of</strong> <strong>$CALLER</strong>. Sample use:</p>
<pre>
<strong></strong>
sam  /usr/sbin/sam  group~operator  uid=0 &#92;
		env=DISPLAY &#92;
		setenv=XAUTHORITY=$CALLER_HOME/.Xauthority

</pre>
<p>Here, the <em>operator</em> group can execute <em>sam</em> as root, and the GUI will display at the caller's display (due to the use of <strong>env=DISPLAY</strong>). Since the XAUTHORITY environment variable is set to the caller's <em>.Xauthority</em> file, this will give the caller access to the same display(s) to which s/he already has access.</p><p>The following variables are defined when super starts up. They can be useful in conditionally-included lines (<strong>:if</strong> lines).  If your host doesn't supply these functions, or doesn't support some of the values that <em>super</em> tries to fetch, the corresponding variable will be initialized to an empty string. (Use <strong>super&nbsp;-b</strong> to print the names and values of all builtin variables. This makes it simple to see what variable values to check in <strong>:if</strong> lines.)</p><p>From the <em>gethostname()</em> or <em>sysinfo()</em> function: &bull; HOSTNAME	Hostname, possibly canonicalized.</p><p>&bull; HOST	Hostname, short (unqualified).</p><p>From the <em>getdomainname()</em> function: &bull; NIS_DOMAIN	domain set for NIS purposes.</p><p>From the <em>sysinfo()</em> function: &bull; SI_SYSNAME	Name of operating system.</p><p>&bull; SI_HOSTNAME	Name of node.</p><p>&bull; SI_RELEASE	Release of operating system.</p><p>&bull; SI_VERSION	Version field of utsname.</p><p>&bull; SI_MACHINE	Kind of machine.</p><p>&bull; SI_ARCHITECTURE	Instruction set arch.</p><p>&bull; SI_HW_SERIAL	Hardware serial number.</p><p>&bull; SI_HW_PROVIDER	Hardware manufacturer.</p><p>&bull; SI_SRPC_DOMAIN	Secure RPC domain.</p><p>&bull;</p><p>From the <em>uname()</em> function: &bull; UNAME_SYSNAME	Operating system name.</p><p>&bull; UNAME_NODENAME	The nodename.</p><p>&bull; UNAME_RELEASE	Operating system release.</p><p>&bull; UNAME_VERSION	Operating system version.</p><p>&bull; UNAME_MACHINE	Machine hardware name (class).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Options</h2>
        <div class="sectioncontent">
<p>The configuration file can specify a wide variety of options, such as requiring the user's password before executing some commands, or restricting the command-line arguments to match certain patterns.</p><p><em>Options</em> are handled very differently from <em>conditions</em> (conditions include user, group, host, and time). If a control line's conditions aren't met, super falls through and tries the next control line in the file.  After finding an acceptable control line, super will execute the command if the options are satisfied; otherwise, it stops and doesn't search the <em>super.tab</em> file any further.</p><p>Options can be divided into (a) <em>local</em> options, which are defined on a regular control line, and apply only to that control line; and (b) <em>global</em> options, which are defined on a <strong>:global</strong> or <strong>:global_options</strong> line, take effect immediately after the line, and are valid until the end of the input or until there is a countermanding global option or pattern.</p><p>All options are orthogonal to each other.  It doesn't matter in what order they appear on a control line.</p><p>Some options can be given as either local or global options. If both are used, the local setting overrides the global one.</p><p>Two special names can be used with any of the options that take user or group ids as arguments: <strong>owner=</strong><em>xxx,</em> <strong>uid=</strong><em>xxx,</em> <strong>euid=</strong><em>xxx,</em> <strong>gid=</strong><em>xxx,</em> <strong>egid=</strong><em>xxx,</em> <strong>u+g=</strong><em>xxx,</em> <strong>groups=</strong><em>xxx,</em> <strong>addgroups=</strong><em>xxx.</em> These names are <strong>&lt;owner&gt;</strong>, meaning the owner of the file to be executed (or the owner's group, whichever is appropriate in the context); and <strong>&lt;caller&gt;</strong>, meaning the owner or group of the user calling super. The angle brackets are literally part of the name. These have the same values as the built-in variables <strong>CALLER</strong> and <strong>OWNER</strong> (see the <em>Variables</em> section, above). For example, the options</p><p>gid=Foo uid=&lt;caller&gt;</p><p>would change the group to <em>Foo</em>, but leave the uid unchanged.</p><p>The recognized options are:</p><p><em>Group 1.  Options Affecting How Superfiles Are Read and Processed.</em> <strong>patterns=</strong><em>xxx</em></p><p><strong>(Global)</strong> Specifies the pattern-matching type for conditions and options. The string <em>xxx</em> must be one of:</p><p><strong>posix</strong> &ndash; patterns are POSIX regular expressions. You can use ``<strong>posix/extended</strong>'' for extended regular expressions; ``<strong>posix/icase</strong>'' for case-insensitive regular expressions; or ``<strong>posix/extended/icase</strong>'' for both. See your regular-expression man pages for details. <strong>regex</strong> &ndash; patterns are ed-style regular expressions, using the rules embodied in the BSD&nbsp;4.x routines <em>re_comp()/re_exec()</em>, with the addition of csh-style brace expansion. This is the default for historical reasons, but most people prefer to use shell-style patterns here, and it is recommended that you put <strong>patterns=shell</strong> (see below) in your global options list. <strong>shell</strong> &ndash; patterns are approximately Bourne-shell style, with the addition of csh-style brace expansion and the special <strong>[[</strong><em>chars</em><strong>]]</strong> pattern.  The patterns are formed from:</p><p>&#92;x	force x to be a plain character; ?	matches any single character; *	matches any sequence of 0 or more chars; [<em>chars</em>]	matches any single character in the set; [^<em>chars</em>]	matches any single char NOT in the set; [[<em>chars</em>]]	When the pattern begins with <strong>[[</strong>, and ends with <strong>]]</strong>, then each and every character in the string must match the ordinary square-bracket pattern <strong>[</strong><em>chars</em><strong>]</strong> (or <strong>[</strong>^<em>chars</em><strong>]</strong>). ^<em>pat</em>	inverts the sense of the match &ndash; the string must NOT match the pattern.</p><p><strong>lang=</strong><em>zzz</em></p><p><strong>(Global)</strong> This option sets the language used for weekdays (in time conditions). Here, <em>zzz</em> may be any locale available on your host.  For example, <strong>lang=de</strong> would typically cause <em>super</em> to use German names.  The default is the <strong>C</strong> locale, hence English names. <strong>relative_path=</strong><em>y</em>|<em>n</em></p><p><strong>(Global)</strong> If <em>y</em>, FullPathNames can be relative instead of absolute. By default this is disallowed, because it is almost always a very foolish (unsafe) thing to do. <strong>group_slash=</strong><em>y</em>|<em>n</em></p><p><strong>(Global)</strong> If <em>y</em>, group names can contain a slash.  By default this is disallowed, so that <strong>super</strong> can catch certain typos in the <em>super.tab</em> file. (Namely, <strong>super</strong> can catch errors in which an entry is of the form <em>Cmd</em><strong>:</strong><em>File</em> instead of the required <em>Cmd</em><strong>::</strong><em>File.</em> The trouble is that <em>Cmd</em><strong>:</strong><em>File</em> looks syntactically like <em>user</em><strong>:</strong><em>group,</em> and can therefore be mistaken for a valid part of a control line. But the filename will contain a slash &ndash; unless you have unwisely enabled the <strong>relative_path</strong> option &ndash; so disallowing slashes allows <strong>super</strong> to flag the line as syntactically invalid.) <strong>gethostbyname=</strong><em>y</em>|<em>n</em></p><p><strong>(Global)</strong> Enables or disables the use of <em>gethostbyname()</em> to find the fully-qualified domain name (see the discussion in the <strong>Permitted Users</strong> section, which describes the security issues associated with enabling this option.) Default: enabled (if your host supports gethostbyname()).</p><p><em>Group 2.  Logging Options.</em> <strong>logfile=</strong><em>fname</em></p><p><strong>(Global)</strong> Enables logging to a local file. Each invocation of <strong>super</strong> (aside from ones for help) generates an entry in file <em>fname</em>. <strong>loguid=</strong><em>xxx</em></p><p><strong>(Global)</strong> If logging is enabled with logfile=<em>fname</em>, the logfile will be opened for writing using uid=<em>xxx</em> (can be either a username or numeric uid). This option allows you to have the file created/opened under another uid that does have cross-host access, such as the uid of a system manager. (See <em>timestampuid=xxx</em> for additional comments). Default: loguid=0. <strong>mail="</strong><em>mail-command</em><strong>"</strong></p><p><strong>(Local|Global)</strong> Notices of super failures are piped to the shell command <em>mail-command</em>. This is independent of the setting of the <strong>logfile</strong> and <strong>syslog</strong> options. For instance, <em>mail="mail -s Super joeblow"</em> will cause error messages to be mailed to user <em>joeblow</em> (on some systems you may need to substitute <em>mailx</em> for <em>mail</em>). Note: the <em>mail-command</em> is executed by passing it as an argument to <a href="../man3/popen.3.html"><strong>popen</strong>(3)</a></em>. This is safe to execute because of the clean environment assured by <strong>super.</strong> <strong>mailany="</strong><em>mail-command</em><strong>"</strong></p><p><strong>(Local|Global)</strong> This is identical to the <em>mail</em> option, except that <em>mailany</em> sends notification of successful invocations as well as errors. <strong>rlog_host=</strong><em>hostname</em></p><p><strong>(Global)</strong> Tells super which host's syslog daemon is to receive log messages when option <strong>syslog=y</strong> is enabled. The option has no effect if used after the first message is logged: once the logger has been opened, it is not re-opened if the <strong>rlog_host</strong> is changed. Default: the local host. Note: One could instead configure the <em>syslog.conf</em> file to forward the messages to a central machine. <strong>syslog=</strong><em>y</em>|<em>n</em></p><p><strong>(Global)</strong> Logging information is passed to the logs maintained by the <em>syslogd</em> daemon. This is independent of the setting of the <strong>logfile</strong> option (above). Error messages are by default logged at priority LOG_ERR and successful attempts to run programs are logged at priority LOG_INFO. (See options <em>syslog_error</em> and <em>syslog_success</em> to change these levels.) <strong>syslog_error=</strong><em>xxx</em></p><p><strong>(Global)</strong> If syslog is enabled (see the <em>syslog</em> option), then by default super logs error messages using <a href="../man3/syslog.3.html"><strong>syslog</strong>(3)</a></em> code <strong>LOG_ERR.</strong> This option changes the code to <em>xxx</em>, where <em>xxx</em> is any of the usual <a href="../man3/syslog.3.html"><strong>syslog</strong>(3)</a></em> priority and/or facility codes, such as <strong>LOG_WARNING</strong> or <strong>LOG_LOCAL7|LOG_ERR</strong>. The <strong>LOG_</strong><em>xxx</em> words can be separated by whitespace, dot, and/or ``|'', but of course you must use quotes if whitespace is included.  The leading "LOG_" is optional, and the value is case-insensitive. For example, <strong>LOG_LOCAL7|LOG_ERR</strong> can alternatively be written as <strong>local7.err</strong>. Super doesn't know what are sensible codes &ndash; it's up to the <em>super.tab</em> writer to choose meaningful values.  For instance, if you put <strong>syslog_error="LOG_INFO&nbsp;|&nbsp;LOG_ERR"&nbsp;</strong><em>(bad!)</em><strong></strong></p><p>then you will get both those values or'd together and passed to <em>syslog().</em> <strong>syslog_success=</strong><em>xxx</em></p><p><strong>(Global)</strong> This option is just like <strong>syslog_error</strong>, except that it applies to successful-execution messages instead of error messages.  Default: <strong>LOG_INFO .</strong></p><p><em>Group 3.  Extra Help Information for Users.</em> <strong>info=</strong><em>xxx</em></p><p><strong>(Local)</strong> The string <em>xxx</em> is printed when giving help to users.  It should be set to a helpful one-line description of the command.</p><p><em>Group 4.  Password and Other Restrictions Before Approval.</em> <strong>maxlen=</strong>[<em>mmm</em><strong>,</strong>]<em>nnn</em></p><p><strong>(Local|Global)</strong> Each argument must be no more than <em>mmm</em> characters long (including the terminating null), and the sum length of all arguments must not exceed <em>nnn</em> characters.  A negative value means that no limit is applied. The defaults for <em>mmm</em> and <em>nnn</em> are set by the compile-time manifest constants MAXLEN1ARG and MAXLENARGS, which are usually 1000 and 10,000 characters, respectively. <strong>nargs=</strong>[<em>mmm</em><strong>-</strong>]<em>nnn</em></p><p><strong>(Local|Global)</strong> The user is required to enter <em>mmm - nnn</em> arguments to the command.  If just <em>nnn</em> is given, the user must enter exactly <em>nnn</em> arguments.  These arguments are in addition to any arguments entered in the command part of the <em>super.tab</em> file.  The default is to allow the user to enter any number of arguments. <strong>arg</strong>[<em>mmm</em><strong>-</strong>]<em>nnn</em><strong>=</strong><em>sss</em></p><p><strong>(Local|Global)</strong> This means that the <em>nnn</em>'th or <em>mmm-nnn</em>'th arguments must match pattern <em>sss</em>. (Arguments are numbered from&nbsp;1.) The pattern must be enclosed in quotes if it contains whitespace. Note that this option does not <em>require</em> that there be <em>mmm</em>-<em>nnn</em> arguments; it only says what those arguments must look like, if entered. You can use this option several times on one line, with different <em>mmm</em>-<em>nnn</em> values each time, to apply different patterns to different arguments. If more than one pattern applies to a given argument, all of those patterns must be matched. An empty pattern ("") is special: it has the effect of <em>unsetting</em> (removing) any previous patterns for the matching [<em>mmm</em>-]<em>nnn</em>. This can be useful if you want to change <strong>:global</strong> settings, instead of adding to them. If there are local <strong>arg</strong>[<em>mmm</em><strong>-</strong>]<em>nnn</em> option(s), they completely replace all global <strong>arg</strong>[<em>mmm</em><strong>-</strong>]<em>nnn</em> values, even if the local <em>mmm</em>-<em>nnn</em> values do not overlap with the global values. <strong>owner=</strong><em>xxx</em></p><p><strong>(Local|Global)</strong> This option specifies that the <em>FullPath</em> (after asterisk-substitution) must be owned by user (or uid) <em>xxx</em>, or else it won't be executed. <strong>auth=</strong><em>y</em>|<em>n</em></p><p><strong>(Local|Global)</strong> If <em>y</em>, user authentication is required before the command is executed. The default authentication method is Unix password authentication. See also the options <em>authprompt</em>, <em>authtype</em>, <em>authuser</em>, <em>timeout</em>, and <em>renewtime</em>, and be sure to read the warning under <em>timestampbyhost.</em> <strong>authprompt=</strong><em>message</em></p><p><strong>(Local|Global)</strong> Specifies the prompt used when authenticating the user (usually the default prompt is fine). Variable substitution is done on the prompt before printing. <strong>authtype=</strong><em>type</em></p><p><strong>(Local|Global)</strong> Specifies the type of authentication used when <em>auth=y</em>. The <em>type</em> can be <strong>password</strong> or <strong>pam</strong> (if PAM is supported on your system). The default is <strong>password</strong>. If PAM authentication is used, <em>super</em> uses the service name ``<strong>super</strong>'' when looking for authentication in your system PAM configuration files. <strong>authuser=</strong><em>username</em></p><p><strong>(Local|Global)</strong> Specifies the user whose authentication is required when <em>auth=y</em>. The default is the password (or other authentication) for the user who invoked super. <strong>password=</strong><em>y</em>|<em>n</em></p><p><strong>(Local|Global)</strong> This is a deprecated option; it has been replaced by the <em>auth</em> and <em>authtype</em> options. <strong>Password=y</strong> is equivalent to <strong>auth=y authtype=password</strong> ; and <strong>Password=n</strong> is equivalent to <strong>auth=n.</strong> <strong>renewtime=</strong><em>y</em>|<em>n</em></p><p><strong>(Global)</strong> If <em>y</em>, the user's timestamp file is updated to the current time whenever an authentication-requiring command is executed. The result is that a user who frequently executes authentication-requiring commands won't need to re-authenticate until more than <em>timeout</em> minutes elapse since the last such command. Otherwise, the user will need to re-authenticate <em>timeout</em> minutes after last entering the password. The default is <em>n</em>. <strong>timeout=</strong><em>m</em></p><p><strong>(Local|Global)</strong> User authentication is good for <em>m</em> minutes; that is, the command may be executed without re-authenticating for <em>m</em> minutes after the previous authentication (for any command).  After <em>m</em> minutes, user authentication will be required again before the command can be executed.  If <em>timeout</em> is zero or negative, authentication is required every time the command is used. The timestamp for user <em>usr</em> is recorded in the file <strong>TIMESTAMP_DIR</strong> directory (see <strong>timestampbyhost</strong> and the FILES section, below). <strong>timestampbyhost=</strong><em>y</em>|<em>n</em></p><p><strong>(Global)</strong> If <em>y</em> (default), the timestamp files are given names that are unique on each host.  For instance, <em>jouser@somehost</em> will be given a timestamp file named <em>TIMESTAMP_DIR/somehost/jouser</em>, where <em>TIMESTAMP_DIR</em> is defined in the FILES section. If <em>timestmapbyhost=n</em>, the timestamp files are given names that are unique to each user, but not unique per host.  For instance, <em>jouser</em> on any host will be given a timestamp file named <em>TIMESTAMP_DIR/jouser</em>.</p><p><em>WARNING:</em> The hostname used is that from <em>gethostname().</em> Note that this is not necessarily unique across internet domains, since it is frequently not a fully-qualified domain name.  Therefore you should not share timestamp directories with hosts outside the local domain.  (Generally such connections don't exist, but one <em>could</em> crossmount the timestamp directory disk...) <strong>timestampuid=</strong><em>xxx</em></p><p>If a password is required, the time at which it was entered is recorded as the mtime of a timestamp file.  The timestamp file is normally created with owner=root; however, this option causes it to be created/modified using uid=<em>xxx</em> (<em>xxx</em> can be either a username or numeric uid). This option is useful when a network of hosts are sharing a cross-mounted timestamp directory.  Note that networks are typically configured to not allow root on one host to have root access to files on another host, which will forbid root on other hosts from creating the timestamp file unless it's world-writable. This option allows you to have the file created/opened under another uid that does have cross-host access, such as the uid of a system manager. Default: timestampuid=0. <strong>checkvar=</strong><em>name</em>[,...]</p><p><strong>(Local)</strong> Each <em>name</em> in the comma-separated list is a <em>super.tab</em> variable which the user must enter at a prompt from <em>super.</em> For example, you might have a <strong>super shutdown</strong> command which halts the computer.  If you execute this on the wrong host there may be some very annoyed users!  So, you can include <strong>checkvar=HOST</strong>, and the user will have to type the correct hostname in response to a prompt from <em>super.</em></p><p><em>Group 5.  Modifications to Environment Before Executing Command.</em> <strong>uid=</strong><em>xxx</em></p><p><strong>(Local)</strong> Sets the real uid to <em>xxx</em> just before executing the command. If option <strong>euid</strong> isn't used, also sets the effective uid to <em>xxx</em>. The uid <em>xxx</em> is first tried as a login name and then as a number. If the options <strong>uid</strong><em>=xxx</em> and <strong>u+g</strong><em>=yyy</em> (see below) are used together, then the <strong>u+g</strong> option only sets the group&nbsp;id, and not the user&nbsp;id. <strong>euid=</strong><em>xxx</em></p><p><strong>(Local)</strong> Sets the effective uid to <em>xxx</em> just before executing the command. The uid <em>xxx</em> is first tried as a login name and then as a number. <strong>gid=</strong><em>yyy</em></p><p><strong>(Local)</strong> Sets the real gid to <em>yyy</em> just before executing the command. If option <strong>egid</strong> isn't used, also sets the effective gid to <em>yyy</em>. The gid <em>yyy</em> is first tried as a group name and then as a number. <strong>egid=</strong><em>yyy</em></p><p><strong>(Local)</strong> Sets the effective gid to <em>yyy</em> just before executing the command. The gid <em>yyy</em> is first tried as a group name and then as a number. <strong>u+g=</strong><em>zzz</em></p><p><strong>(Local)</strong> Sets the real uid to <em>zzz</em>, the real gid to <em>zzz</em>'s login gid, and the supplementary groups list to <em>zzz</em>'s supplementary groups just before executing the command. If the <strong>euid</strong> and/or <strong>egid</strong> option aren't given, the effective uid and/or gid are also set. The options <em>u+g</em> and <strong>gid=yyy</strong> conflict with each other, and may not be used together. <strong>groups=</strong><em>name</em>[,...]</p><p><strong>(Local|Global)</strong> By default, the user's supplementary groups list is deleted before executing a command (unless the option <strong>u+g</strong> is used). This option instead sets the group list to <em>name</em>[,...] <strong>addgroups=</strong><em>name</em>[,...]</p><p><strong>(Local|Global)</strong> This option adds the listed groups to the supplementary groups list. Since the default is to provide an empty supplementary groups list, this option usually has the same effect as the plain <strong>groups</strong> option. However, if the options <strong>u+g=</strong><em>foo</em> <strong>addgroups=</strong><em>a,b,c</em> are used, then the supplementary groups list is composed of user <em>foo</em>'s supplementary groups plus <em>a, b</em>, and <em>c</em>. <strong>argv0=</strong><em>name</em></p><p><strong>(Local)</strong> Execute the command will execute with its first argument (that is, the argument conventionally denoted as <em>argv[0]</em>), set to <em>name</em>. As a convenient shorthand, the value <strong>&lt;path&gt;</strong> (the angle brackets are literally part of the name) means to use the <em>FullPath</em> specified in the <em>super.tab</em> file. By default, <em>argv[0]</em> is set to <em>Cmd</em>, the name of the <em>super</em> command invoked by the user, regardless of the actual path being invoked. However, some programs will not run properly unless <em>argv[0]</em> has a particular value. For example, suppose you want to permit users to safely mount zip disks, and you use something like: <strong>zipmount</strong> "/etc/mount -o nosuid /dev/xz10  /zip"</p><p>This command will fail if <em>/etc/mount</em> requires that it be invoked with <em>argv[0]</em> set to [<em>.../</em>]<em>mount,</em> because <em>super</em> will use the name <em>zipmount.</em> However, you can put <strong>argv0=&lt;path&gt;</strong> into your super.tab file, and then the mount command will work properly. <strong>env=</strong><em>name</em>[,...]</p><p><strong>(Global|Local)</strong> Each <em>name</em> in the comma-separated list is an environment variable which should <em>not</em> be deleted before executing the <em>Cmd</em>; these variables are in addition to the normal variables created or passed by <strong>super</strong> (TERM, IFS, PATH, USER, LOGNAME, HOME, ORIG_USER, ORIG_LOGNAME, ORIG_HOME, LINES, COLUMNS, SUPERCMD). Be careful here; environment variables can sometimes be abused to create security holes. If you use the option more than once, the later instance overrides the earlier one, instead of adding to it.  Similarly, using it as a local option completely overrides any global setting. <strong>maxenvlen=nnn</strong></p><p><strong>(Global|Local)</strong> Specifies the maximum length of an environment variable definition (including name, equal sign, value, and trailing null character). The default is given by the compile-time manifest constant MAXENVLEN, usually 1000 characters. A negative value means no limit. <strong>cd=</strong><em>dir</em></p><p><strong>(Local|Global)</strong> Just before executing the command, <em>super</em> changes the working directory to <em>dir</em>. <strong>setenv=</strong><em>var</em><strong>=</strong><em>xxx</em></p><p><strong>(Local|Global)</strong> The environment variable <em>var</em> is defined to have the value <em>xxx</em>, and is passed on when executing the <em>Cmd</em>. You can add several environment variable definitions by using the option more than once. <strong>fd=</strong><em>n</em>[,...]</p><p><strong>(Local)</strong> Each file descriptor <em>n</em> in the comma-separated list should <em>not</em> be closed before executing the <em>Cmd.</em> These descriptors are added to the usual set of descriptors kept open, namely 0, 1, 2. <strong>nice=</strong><em>n</em></p><p><strong>(Local|Global)</strong> changes the ``nice'' value of the executed command by an amount <em>n</em> from the default level.  (Positive increments reduce the command's priority; negative increments increase it.) <strong>umask=</strong><em>nnn</em></p><p><strong>(Local|Global)</strong> sets the umask of any executed command to <em>n</em>. A leading <strong>0x</strong> or <strong>0X</strong> in <em>nnn</em> means a hexadecimal value; otherwise, a leading <strong>0</strong> means octal; otherwise it's decimal.</p><p><em>Group 6.  Other Options</em> <strong>print=</strong><em>message</em></p><p><strong>(Local)</strong> If the rest of the line is matched, then <strong>super</strong> prints the specified <em>message</em> just before executing the command. <strong>die=</strong><em>message</em></p><p><strong>(Local)</strong> If the rest of the line is matched, then <strong>super</strong> does variable-substitution on the specified message <em>message</em>, prints it, and exits. This lets you conveniently set up some ``stop'' conditions, and use the die option to prevent super from looking at any line past the stop conditions.  Otherwise, you'd have to individually attach the stop conditions to every control line.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Include Files</h2>
        <div class="sectioncontent">
<p>A <em>super.tab</em> file can include other files by means of an entry like</p><p><strong>:include</strong><em></em><strong>filename</strong><em>[</em><strong></strong><em>owner=</em><strong>xxx</strong><em>]</em><strong>[</strong><em></em><strong>group=</strong><em>yyy</em><strong></strong><em>]</em></p><p>or</p><p><strong>:optinclude</strong><em></em><strong>file</strong><em>[</em><strong></strong><em>owner=</em><strong>xxx</strong><em>]</em><strong>[</strong><em></em><strong>group=</strong><em>yyy</em><strong></strong><em>]</em></p><p>If the <em>file</em> isn't an absolute path, it is taken to be relative to the directory containing the <em>super.tab</em> file.  Include files may be nested up to the system limit on the number of simultaneously-open file descriptors.</p><p>The <strong>owner=</strong><em>xxx</em> option specifies that the <em>file</em> must be owned by user <em>xxx;</em> the <strong>group=</strong><em>yyy</em> options specifies that the <em>file</em> must belong to group <em>yyy.</em> If <strong>group=</strong><em>yyy</em> is specified, then the file can be group-writable; by default, the file must be writable only by owner. This can be useful for a collection of accounts that are operated together as part of a single project &ndash; the several of accounts can share <em>.supertab</em> files by <strong>:include</strong><em>-ing</em> files belonging to the trusted user <em>xxx</em> and/or group <em>yyy.</em> Notes:</p><p>1.  The regular root-owned <em>super.tab</em> file can also use the <em>owner=</em> or <em>group=</em> constructs, but it's not a good idea.  Don't do it.</p><p>2.  Beware of the transitive nature of this trust: the file owned by <em>xxx</em> can in turn include a file owned by yet another user.  You might wind up trusting a user you didn't intend to trust!</p><p>The difference between <strong>:include</strong> and <strong>:optinclude</strong> is that the former generates an error if the named file doesn't exist, whereas the latter (optional-include) silently ignores files that don't exist.</p><p><em>WARNING:</em> You should use <strong>:optinclude</strong> with great caution, and be sure not to depend on that file being present.  It is easy to imagine a scenario in which an administrator carelessly changes an entry so that the wrong permission is granted if an :optinclude'd file was missing.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>/etc/super.tab</em></p>
  </dt>
  <dd>
    <p>The location of the <em>super.tab</em> file on your system.</p>
  </dd>
  <dt>
    <p><em>/etc/super.init</em></p>
  </dt>
  <dd>
    <p>The location of the <em>super.init</em> file on your system.</p>
  </dd>
  <dt>
    <p><em>/run/superstamps/</em>username</p>
  </dt>
  <dd>
    <p>Default location of the file whose <em>mtime</em> is used as the timestamp for the last time the user entered his or her password for password-requiring commands.  Check your installation for the directory used on your system.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Example 1. The control line</p>
<pre>
doit /usr/local/bin/doit		&#92;
	me	&#92;
	you@{h1,h32}	&#92;
	ja.*:ok_j	&#92;
	:goodguys
</pre>
<p>allows /usr/local/bin/doit to be run setuid-root by &bull; user <strong>me</strong> on any host,</p><p>&bull; user <strong>you</strong> on hosts <strong>h1</strong> and <strong>h32</strong>;</p><p>&bull; any users named <strong>ja.*</strong> in group <strong>ok_j</strong>;</p><p>&bull; and anybody in group <strong>goodguys</strong>.</p><p>Example 2. The pair of control lines</p>
<pre>
doit /usr/local/bin/doit		&#92;
	u+g=smith env=TZ,TAPE	&#92;
	password=y timeout=0	&#92;
	jo@PublicWorkstation

doit /usr/local/bin/doit		&#92;
	u+g=smith env=TZ,TAPE	&#92;
	jo
</pre>
<p>allows user <strong>jo</strong> to run /usr/local/bin/doit with uid&nbsp;=&nbsp;<strong>smith</strong>, gid&nbsp;=&nbsp;<strong>smith</strong>'s login gid, and keeping the environment variables TZ and TAPE in addition to the standard set. If user <strong>jo</strong> is at <strong>PublicWorkstation</strong>, the first entry will match, requiring jo's password every time the command is used; otherwise, <em>super</em> will match at the second entry, and no password is needed to run the command. Example 3. Here is an entry restricting CD-ROM mounting on different hosts: <strong>tas</strong> is the only user who may mount CD's on <strong>elgar</strong>; anybody in group <strong>xyz</strong> may mount CD's on <strong>alpha</strong> or <strong>delta</strong>; and anybody on a host in the netgroup <strong>india</strong> may mount a CD on the <strong>india</strong> hosts.  However, user <strong>jo</strong> may never run <em>cdmount</em>, regardless of his or her group or host (assuming that there is no overriding global pattern that permits <strong>jo</strong> to use the command).  Note that shell-style patterns are used, not regex-style patterns.</p>
<pre>
cdmount /usr/local/bin/cdmount		&#92;
	tas@elgar		&#92;
	:xyz@{alpha,delta}	&#92;
	*@+india		&#92;
	!jo

</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO super.tab&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/super.1.html"><strong>super</strong>(1)</a>.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="subuid.5.html"><span aria-hidden="true">&larr;</span> subuid.5: The subordinate uid file</a></li>
   <li class="next"><a href="svn-autoreleasedeb.conf.5.html">svn-autoreleasedeb.conf.5: Configuration for svn-autoreleasedeb <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
