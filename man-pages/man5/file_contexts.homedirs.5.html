<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>file_contexts.homedirs - userspace SELinux labeling interface and configuration file format for the file contexts backend .</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Userspace selinux labeling interface and configuration file format for the file contexts backend .">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">file_contexts.homedirs<small> (5)</small></h1>
        <p class="lead">Userspace selinux labeling interface and configuration file format for the file contexts backend .</p>
      </div>

    <ol class="breadcrumb">
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="https://www.carta.tech/man-pages/"><span itemprop="title">Linux Man Pages</span></a>
	</li>
	<li id="breadcrumb_section" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_page" itemprop="child">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man5/"><span itemprop="title">File formats and conventions</span></a>
	</li>
	<li id="breadcrumb_page" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="active">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man5/file_contexts.homedirs.5.html"><span itemprop="title">file_contexts.homedirs</span></a>
	</li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p><strong>#include &lt;selinux/label.h&gt;</strong></p>
<p class='spacer'>

<p><strong>int selabel_lookup(struct selabel_handle *</strong><em>hnd</em><strong>,</strong> <strong>char **</strong><em>context</em><strong>,</strong></p>
<p class='spacer'>

<p><strong>const char *</strong><em>path</em><strong>, int </strong><em>mode</em><strong>);</strong></p>
<p class='spacer'>

<p><strong>int selabel_lookup_raw(struct selabel_handle *</strong><em>hnd</em><strong>,</strong> <strong>char **</strong><em>context</em><strong>,</strong></p>
<p class='spacer'>

<p><strong>const char *</strong><em>path</em><strong>, int </strong><em>mode</em><strong>);</strong> .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p>The file contexts backend maps from pathname/mode combinations into security contexts. It is used to find the appropriate context for each file when relabeling a file system. The returned <em>context</em> must be freed using <strong>freecon</strong>(3).</p>
<p class='spacer'>

    <p><strong>selabel_lookup</strong>(3) describes the function with its return and error codes, however the following <em>errno</em> is clarified further for the file contexts backend:</p>
    <dl class='dl-vertical'>
      <dt><strong>ENOENT</strong></dt>
      <dd>
    <p>No context corresponding to the <em>path</em> and <em>mode</em> was found - This will also be returned when the file contexts series of files have a context of <strong>&lt;&lt;none&gt;&gt;</strong> against the <em>path</em> (see the <strong>FILE FORMAT</strong> section).</p>
      </dd>
    </dl>
<p class='spacer'>

<p>The <em>path</em> argument should be set to the full pathname of the file whose assigned context is being checked. The <em>mode</em> argument should be set to the mode bits of the file, as determined by <a href="../man2/lstat.2.html"><strong>lstat</strong>(2)</a>. <em>mode</em> may be zero, however full matching may not occur.</p>
<p class='spacer'>

<p>Any messages generated by <strong>selabel_lookup</strong>(3) are sent to <em>stderr</em> by default, although this can be changed by <strong>selinux_set_callback</strong>(3).</p>
<p class='spacer'>

<p><strong>selabel_lookup_raw</strong>(3) behaves identically to <strong>selabel_lookup</strong>(3) but does not perform context translation.</p>
<p class='spacer'>

<p>The <strong>FILES</strong> section details the configuration files used to determine a file context. .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

    <p>In addition to the global options described in <strong>selabel_open</strong>(3), this backend recognizes the following options:</p>
    <dl class='dl-vertical'>
      <dt><strong>SELABEL_OPT_PATH</strong></dt>
      <dd>
    <p>A non-null value for this option specifies a path to a file that will be opened in lieu of the standard file contexts file.  This value is also used as the base name for determining the names of local customization files.</p>
      </dd>
      <dt><strong>SELABEL_OPT_BASEONLY</strong></dt>
      <dd>
    <p>A non-null value for this option indicates that any local customizations to the file contexts mapping should be ignored.</p>
      </dd>
      <dt><strong>SELABEL_OPT_SUBSET</strong></dt>
      <dd>
    <p>A non-null value for this option is interpreted as a path prefix, for example "/etc".  Only file context specifications starting with the given prefix are loaded.  This may increase lookup performance, however any attempt to look up a path not starting with the given prefix will fail.</p>
      </dd>
    </dl>
<p>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<p>The file context files used to retrieve the default context depends on the <strong>SELABEL_OPT_PATH</strong> parameter passed to <strong>selabel_open</strong>(3). If <em>NULL</em>, then the <strong>SELABEL_OPT_PATH</strong> value will default to the active policy file contexts location (as returned by <strong>selinux_file_context_path</strong>(3)), otherwise the actual <strong>SELABEL_OPT_PATH</strong> value specified is used.</p>
<p class='spacer'>

    <p>If <strong>SELABEL_OPT_BASEONLY</strong> is set, then the following files will be processed:</p>
    <dl class='dl-horizontal'>
      <dt>1.</dt>
      <dd>
    <p>The mandatory file contexts file that is either the fully qualified file name from <em>SELABEL_OPT_PATH.value</em> or if <em>NULL</em>, then the path returned by <strong>selinux_file_context_path</strong>(3).</p>
      </dd>
      <dt>2.</dt>
      <dd>
    <p>The optional local and distribution substitution files that perform path aliasing on the 'in memory' version of the file contexts file.</p>
<p class='spacer'>

    <p>These files have the same name as the mandatory file contexts file with the extensions <em>.subs</em> and <em>.subs_dist</em> added.</p>
      </dd>
    </dl>
<p class='spacer'>

    <p>If the <strong>SELABEL_OPT_BASEONLY</strong> is not set, then the following files will be processed:</p>
    <dl class='dl-horizontal'>
      <dt>1.</dt>
      <dd>
    <p>The mandatory file contexts file that is either the fully qualified file name from <em>SELABEL_OPT_PATH.value</em> or if <em>NULL</em>, then the path returned by <strong>selinux_file_context_path</strong>(3).</p>
      </dd>
      <dt>2.</dt>
      <dd>
    <p>The optional local customizations file that has the same name as the mandatory file contexts file with the extension <em>.local</em> added.</p>
<p class='spacer'>

    <p><strong>selinux_file_context_local_path</strong>(3) will return the default path to this file.</p>
      </dd>
      <dt>3.</dt>
      <dd>
    <p>The optional user home directory customizations file that has the same name as the mandatory file contexts file with the extension <em>.homedirs</em> added.</p>
<p class='spacer'>

    <p><strong>selinux_file_context_homedir_path</strong>(3) will return the default path to this file.</p>
      </dd>
      <dt>4.</dt>
      <dd>
    <p>The optional local and distribution substitution files that perform any path aliasing on the 'in memory' version of the file contexts file (and the <em>.local</em> and/or <em>.homedirs</em> if present). These files have the same name as the mandatory file contexts file with the extensions <em>.subs</em> and <em>.subs_dist</em> added.</p>
<p class='spacer'>

    <p><strong>selinux_file_context_subs_path</strong>(3) and <strong>selinux_file_context_subs_dist_path</strong>(3) will return the default paths to these files.</p>
      </dd>
    </dl>
<p class='spacer'>

  <p>The default file context series of files are: <em>/etc/selinux/{SELINUXTYPE}/contexts/files/file_contexts</em></p>
<p class='spacer'>

  <p><em>/etc/selinux/{SELINUXTYPE}/contexts/files/file_contexts.local</em></p>
<p class='spacer'>

  <p><em>/etc/selinux/{SELINUXTYPE}/contexts/files/file_contexts.homedirs</em></p>
<p class='spacer'>

  <p><em>/etc/selinux/{SELINUXTYPE}/contexts/files/file_contexts.subs</em></p>
<p class='spacer'>

<p><em>/etc/selinux/{SELINUXTYPE}/contexts/files/file_contexts.subs_dist</em></p>
<p class='spacer'>

<p>Where <em>{SELINUXTYPE}</em> is the entry from the selinux configuration file <em>config</em> (see <strong>selinux_config</strong>(5)).</p>
<p class='spacer'>

<p>Only the <em>file_contexts</em> file is mandatory, the remainder are optional.</p>
<p class='spacer'>

<p>The entries within the file contexts series of files are shown in the <strong>FILE FORMAT</strong> section. .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILE FORMAT</h2>
        <div class="sectioncontent">

<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">File Contexts Format</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>Each line within the <em>file_contexts</em> and the two customization files (<em>.local</em> and <em>.homedirs</em>) is as follows:</p>
<p class='spacer'>

<p><em>pathname [file_type] context</em></p>
<p class='spacer'>

<p>Where:</p>
<p class='spacer'>

      <p><em>pathname</em> An entry that defines the pathname that may be in the form of a regular expression. <em>file_type</em> An optional file type consisting of: <em>-b</em> - Block Device      <em>-c</em> - Character Device</p>
<p class='spacer'>

      <p><em>-d</em> - Directory         <em>-p</em> - Named Pipe</p>
<p class='spacer'>

      <p><em>-l</em> - Symbolic Link     <em>-s</em> - Socket</p>
<p class='spacer'>

        <p><em>--</em> - Ordinary file <em>context</em> This entry can be either:</p>
        <dl class='dl-horizontal'>
          <dt>a.</dt>
          <dd>
        <p>The security context that will be assigned to the file (i.e. returned as <em>context</em>).</p>
          </dd>
          <dt>b.</dt>
          <dd>
        <p>A value of <strong>&lt;&lt;none&gt;&gt;</strong> can be used to indicate that the matching files should not be re-labeled and causes <strong>selabel_lookup</strong>(3) to return -1 with <em>errno</em> set to <strong>ENOENT</strong>.</p>
          </dd>
        </dl>
<p class='spacer'>

  <p>Example: # ./contexts/files/file_contexts</p>
<p class='spacer'>

  <p># pathname file_type  context</p>
<p class='spacer'>

  <p>/.*                   system_u:object_r:default_t:s0</p>
<p class='spacer'>

  <p>/[^/]+        --      system_u:object_r:etc_runtime_t:s0</p>
<p class='spacer'>

<p>/tmp/.*               &lt;&lt;none&gt;&gt;</p>
<p class='spacer'>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Substitution File Format</h2>
        <div class="sectioncontent">

<p class='spacer'>

<p>Each line within the substitution files (<em>.subs</em> and <em>.subs_dist</em>) has the form: <em>subs_pathname pathname</em></p>
<p class='spacer'>

<p>Where: <em>pathname</em> A path that matches an entry in one or more of the file contexts policy configuration file. <em>subs_pathname</em> The path that will be aliased (considered equivalent) with pathname by the look up process.</p>
<p class='spacer'>

  <p>Example: # ./contexts/files/file_contexts.subs</p>
<p class='spacer'>

  <p># pathname  subs_pathname</p>
<p class='spacer'>

  <p>/myweb      /var/www</p>
<p class='spacer'>

  <p>/myspool    /var/spool/mail</p>
<p class='spacer'>

  <p>Using the above example, when <strong>selabel_lookup</strong>(3) is passed a path of <em>/myweb/index.html</em> the function will substitute the <em>/myweb</em> component with <em>/var/www</em>, therefore the path used is:</p>
<p class='spacer'>

<p><em>/var/www/index.html</em> .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

  <dl class='dl-horizontal'>
    <dt>1.</dt>
    <dd>
  <p>If contexts are to be validated, then the global option <strong>SELABEL_OPT_VALIDATE</strong> must be set before calling <strong>selabel_open</strong>(3). If this is not set, then it is possible for an invalid context to be returned.</p>
    </dd>
    <dt>2.</dt>
    <dd>
  <p>If the size of file contexts series of files contain many entries, then <strong>selabel_open</strong>(3) may have a delay as it reads in the files, and if requested validates the entries. If possible use the <strong>SELABEL_OPT_SUBSET</strong> option to reduce the number of entries processed.</p>
    </dd>
    <dt>3.</dt>
    <dd>
  <p>Depending on the version of SELinux it is possible that a <em>file_contexts.template</em> file may also be present, however this is now deprecated.</p>
<p class='spacer'>

  <p>The template file has the same format as the <em>file_contexts</em> file and may also contain the keywords <strong>HOME_ROOT</strong>, <strong>HOME_DIR</strong>, <strong>ROLE</strong> and <strong>USER</strong>. This functionality has now been moved to the policy store and managed by <strong>semodule</strong>(8) and <strong>genhomedircon</strong>(8). .</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

<p><a href="../man8/selinux.8.html"><strong>selinux</strong>(8)</a>, <strong>selabel_open</strong>(3), <strong>selabel_lookup</strong>(3), <strong>selabel_stats</strong>(3), <strong>selabel_close</strong>(3), <strong>selinux_set_callback</strong>(3), <strong>selinux_file_context_path</strong>(3), <strong>freecon</strong>(3), <strong>selinux_config</strong>(5), <a href="../man2/lstat.2.html"><strong>lstat</strong>(2)</a>, selinux_file_context_subs_path<strong>(3), </strong>selinux_file_context_subs_dist_path<strong>(3), </strong>selinux_file_context_homedir_path<strong>(3), <strong>selinux_file_context_local_path</strong>(3), <strong>semodule</strong>(8), <strong>genhomedircon</strong>(8) </p>
        </div>
      </section>
<nav>
  <ul class="pager">
  <li class="previous"><a href="file_contexts.5.html"><span aria-hidden="true">&larr;</span> file_contexts.5: userspace SELinux labeling interface and configuration file format for the file contexts backend .</a></li><li class="next"><a href="file_contexts.local.5.html">file_contexts.local.5: userspace SELinux labeling interface and configuration file format for the file contexts backend . <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>
  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
