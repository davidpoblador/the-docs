<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>typerules: \*(fx file type identification and conversion rules</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="\*(fx file type identification and conversion rules">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="typerules (5) manual">
  <meta name="twitter:description" content="\*(fx file type identification and conversion rules">
  <meta name="twitter:image" content="https://www.carta.tech/images/hylafax-client-typerules-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/typerules.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="typerules (5) manual" />
  <meta property="og:description" content="\*(fx file type identification and conversion rules" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/hylafax-client-typerules-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">typerules<small> (5)</small></h1>
        <p class="lead">\*(fx file type identification and conversion rules</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/typerules.5.html">
      <span itemprop="name">typerules: \*(fx file type identification and conversion rules</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/hylafax-client/">
      <span itemprop="name">hylafax-client</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/typerules.5.html">
      <span itemprop="name">typerules: \*(fx file type identification and conversion rules</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Only three types of files are accepted by the \*(Fx server for transmission as facsimile: \*(Ps\(rg files, PDF files, and <small>TIFF</small> Class F (bilevel Group 3-encoded) files. All other types of files must be converted to one of these three formats. The facsimile submission program applies a set of rules against the contents of each input file to identify the file's type and to figure out how to convert the file to a format that is suitable for transmission. These rules are stored in the file <strong>/etc/hylafax/typerules</strong>, an <small>ASCII</small> file that is patterned after the <strong>/etc/magic</strong> file used by the System V <strong>file</strong>(1) program.  However, there are significant differences, noted below.</p><p>Type rules work by matching data patterns in a file; typically patterns that appear in the first few bytes of the file (i.e. magic numbers). There are two types of rules, <em>primary rules</em> and <em>secondary rules</em>. Secondary rules specify additional rules to apply <em>after</em> a primary rule has been matched. When secondary rules are used, rule scanning continues up to the next primary type rule in the file.</p><p>Each rule consists of a set of whitespace-separated fields:</p>
<pre>
<em>offset</em>	<em>datatype</em>	<em>match</em>	<em>result</em>	<em>command</em>

</pre>
<p>If an line is terminated wth a backslash character, the entry is continued on the next line with any leading whitespace characters compressed to a single space. Comments are marked with the ``#'' character; everything from to the end of the line is discarded. Secondary rules have a ``&gt;'' character in the first column of the line; primary rules do not.</p><p>The fields in each rule entry are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>offset</strong></p>
  </dt>
  <dd>
    <p>The byte offset in the file at which data should be extracted and compared to a matching string or value.</p>
  </dd>
  <dt>
    <p><strong>datatype</strong></p>
  </dt>
  <dd>
    <p>The type of data value to extract at the specified offset for comparison purposes; one of: ``byte'' (8 bit unsigned number), ``short'' (16 bit unsigned number), ``long'' (32 bit unsigned number), ``string'' (an array of bytes), ``istring'' (a case-insensitive array of bytes), or ``ascii'' (an array of \s-1ASCII\s+1-only bytes).</p>
  </dd>
  <dt>
    <p><strong>match</strong></p>
  </dt>
  <dd>
    <p>The value and operation to use in matching; the value used is based on the datatype field. If value is ``x'', then it is interpreted to mean <em>match anything</em>; otherwise the following operators are supported (where <em>data</em> is the value extracted from the file and <em>value</em> is specified in the match field) except for types ``string'', ``istring'', and ``ascii'':</p>
<pre>
=	data == value	!=	data != value
&gt;	data &gt; value	&lt;	data &lt; value
&lt;=	data &lt;= value	&gt;=	data &gt;= value
&	(data & value) == value	!	(data & value) != value
^	(data ^ value) != 0
</pre>

  </dd>

</dl>
<p>If no operation is specified then ``='' is used.</p><p>For ``string'', ``istring'', and ``ascii'' no operator is allowed; the implicit operation is always ``=''.  In these cases, the field is terminated by a tab or end of line, not by ``#''.  Characters in the field have their literal value; there are no C-style character escapes.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>result</strong></p>
  </dt>
  <dd>
    <p>One of ``ps'', ``tiff'', or ``error'' (case insensitive). The first two results specify whether the rule generates a \*(Ps file or a <small>TIFF/F</small> file (Group 3-encoded bilevel data), respectively. The ``error'' result indicates that a file is unsuitable for transmission and, if supplied for transmission, should cause the job to be aborted with the <em>command</em> field used in an error message.</p>
  </dd>
  <dt>
    <p><strong>command</strong></p>
  </dt>
  <dd>
    <p>A command description that is expanded and passed to the shell to convert the input file to the result format (suitable for sending as facsimile). Before the string is passed to the shell, it is scanned and the following ``%'' escape codes are substituted for:</p>
<pre>
%i	input file name
%o	output file name
%r	output horizontal resolution in pixels/mm
%R	output horizontal resolution in pixels/inch
%v	output vertical resolution in lines/mm
%V	output vertical resolution in lines/inch
%f	data format, ``1'' for 1-d encoding or ``2'' for 2-d encoding
%w	page width in pixels
%W	page width in mm
%l	page length in pixels
%L	page length in mm
%s	page size by name
%F	the directory where \*(Fx filter programs reside
%&lt;x&gt;	the &lt;x&gt; character (e.g. ``%%'' results in ``%''
</pre>

  </dd>

</dl>
<p>See below for example uses of these codes.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>The following rules are used to match the formats that are handled directly by the server:</p>
<pre>
#offset	datatype	match	result	command
0	string	%!	ps		# \*(Ps
0	string	%PDF	ps		# \*(Ps by Ghostscript
0	short	0x4d4d	tiff		# big-endian \s-1TIFF\s+1
0	short	0x4949	tiff		# little-endian \s-1TIFF\s+1
</pre>
<p>These rules are used to process the <small>ASCII</small> version of <small>IRIS</small> Inventor database files while blocking the transmission of the binary format variant:</p>
<pre>
#offset	datatype	match	result	command
0	string	#Inventor V	error	IRIS Inventor file
&gt;15	string	binary	error	binary IRIS Inventor file
&gt;15	string	ascii	ps	%F/textfmt -fCourier-Bold -p11bp&#92;
				    -U -q &gt;%o &lt;%i
</pre>
<p>This rule is typically the last entry in the file and is used to convert all unmatched \s-1ASCII\s+1 data files to \*(Ps:</p>
<pre>
#offset	datatype	match	result	command
0	ascii	x	ps	%F/textfmt -fCourier-Bold -p11bp -U -q &gt;%o &lt;%i
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>It is much better to convert data that is to be transmitted to \*(Ps because this data format permits the facsimile server to do the final imaging according to the optimal transfer parameters (resolution, binary encoding, etc.).</p><p>It might be better to allow secondary rules to augment a primary rule rather than just replace them. This would allow, for example, command line options to be selected based on file type.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO typerules&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/sendfax.1.html"><strong>sendfax</strong>(1)</a>, <a href="../man1/hylafax-client.1.html"><strong>hylafax-client</strong>(1)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="twfiles.5.html"><span aria-hidden="true">&larr;</span> twfiles.5: Overview of files used by tripwire and file backup process</a></li>
   <li class="next"><a href="tzfile.5.html">tzfile.5: Timezone information <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
