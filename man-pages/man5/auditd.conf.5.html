<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>auditd.conf: Audit daemon configuration file</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Audit daemon configuration file">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="auditd.conf (5) manual">
  <meta name="twitter:description" content="Audit daemon configuration file">
  <meta name="twitter:image" content="https://www.carta.tech/images/auditd-auditd.conf-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/auditd.conf.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="auditd.conf (5) manual" />
  <meta property="og:description" content="Audit daemon configuration file" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/auditd-auditd.conf-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">auditd.conf<small> (5)</small></h1>
        <p class="lead">Audit daemon configuration file</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/auditd.conf.5.html">
      <span itemprop="name">auditd.conf: Audit daemon configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/auditd/">
      <span itemprop="name">auditd</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/auditd.conf.5.html">
      <span itemprop="name">auditd.conf: Audit daemon configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The file <em>/etc/audit/auditd.conf</em> contains configuration information specific to the audit daemon. Each line should contain one configuration keyword, an equal sign, and then followed by appropriate configuration information. All option names and values are case insensitive. The keywords recognized are listed and described below. Each line should be limited to 160 characters or the line will be skipped. You may add comments to the file by starting the line with a '#' character.</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>log_file</em></p>
  </dt>
  <dd>
    <p>This keyword specifies the full path name to the log file where audit records will be stored. It must be a regular file.</p>
  </dd>
  <dt>
    <p><em>log_format</em></p>
  </dt>
  <dd>
    <p>The log format describes how the information should be stored on disk. There are 2 options: raw and nolog. If set to <em>RAW</em>, the audit records will be stored in a format exactly as the kernel sends it. If this option is set to <em>NOLOG</em> then all audit information is discarded instead of writing to disk. This mode does not affect data sent to the audit event dispatcher.</p>
  </dd>
  <dt>
    <p><em>log_group</em></p>
  </dt>
  <dd>
    <p>This keyword specifies the group that is applied to the log file's permissions. The default is root. The group name can be either numeric or spelled out.</p>
  </dd>
  <dt>
    <p><em>priority_boost</em></p>
  </dt>
  <dd>
    <p>This is a non-negative number that tells the audit daemon how much of a priority boost it should take. The default is 4. No change is 0.</p>
  </dd>
  <dt>
    <p><em>flush</em></p>
  </dt>
  <dd>
    <p>Valid values are <em>none</em>, <em>incremental</em>, <em>data</em>,  and <em>sync</em>. If set to <em>none</em>, no special effort is made to flush the audit records to disk. If set to <em>incremental</em>, Then the <em>freq</em> parameter is used to determine how often an explicit flush to disk is issued. The <em>data</em> parameter tells the audit daemon to keep the data portion of the disk file sync'd at all times. The <em>sync</em> option tells the audit daemon to keep both the data and meta-data fully sync'd with every write to disk.</p>
  </dd>
  <dt>
    <p><em>freq</em></p>
  </dt>
  <dd>
    <p>This is a non-negative number that tells the audit daemon how many records to write before issuing an explicit flush to disk command. This value is only valid when the <em>flush</em> keyword is set to <em>incremental</em>.</p>
  </dd>
  <dt>
    <p><em>num_logs</em></p>
  </dt>
  <dd>
    <p>This keyword specifies the number of log files to keep if rotate is given as the <em>max_log_file_action.</em> If the number is &lt; 2, logs are not rotated. This number must be 99 or less. The default is 0 - which means no rotation. As you increase the number of log files being rotated, you may need to adjust the kernel backlog setting upwards since it takes more time to rotate the files. This is typically done in /etc/audit/audit.rules. If log rotation is configured to occur, the daemon will check for excess logs and remove them in effort to keep disk space available. The excess log check is only done on startup and when a reconfigure results in a space check.</p>
  </dd>
  <dt>
    <p><em>disp_qos</em></p>
  </dt>
  <dd>
    <p>This option controls whether you want blocking/lossless or non-blocking/lossy communication between the audit daemon and the dispatcher. There is a 128k buffer between the audit daemon and dispatcher. This is good enogh for most uses. If lossy is chosen, incoming events going to the dispatcher are discarded when this queue is full. (Events are still written to disk if log_format is not nolog.) Otherwise the auditd daemon will wait for the queue to have an empty spot before logging to disk. The risk is that while the daemon is waiting for network IO, an event is not being recorded to disk. Valid values are: lossy and lossless. Lossy is the default value.</p>
  </dd>
  <dt>
    <p><em>dispatcher</em></p>
  </dt>
  <dd>
    <p>The dispatcher is a program that is started by the audit daemon when it starts up. It will pass a copy of all audit events to that application's stdin. Make sure you trust the application that you add to this line since it runs with root privileges.</p>
  </dd>
  <dt>
    <p><em>name_format</em></p>
  </dt>
  <dd>
    <p>This option controls how computer node names are inserted into the audit event stream. It has the following choices: <em>none</em>, <em>hostname</em>, <em>fqd</em>, <em>numeric</em>, and <em>user</em>. <em>None</em> means that no computer name is inserted into the audit event. <em>hostname</em> is the name returned by the gethostname syscall. The <em>fqd</em> means that it takes the hostname and resolves it with dns for a fully qualified domain name of that machine. <em>Numeric</em> is similar to fqd except it resolves the IP address of the machine. In order to use this option, you might want to test that 'hostname -i' or 'domainname -i' returns a numeric address. Also, this option is not recommended if dhcp is used because you could have different addresses over time for the same machine. <em>User</em> is an admin defined string from the name option. The default value is <em>none</em>.</p>
  </dd>
  <dt>
    <p><em>name</em></p>
  </dt>
  <dd>
    <p>This is the admin defined string that identifies the machine if <em>user</em> is given as the <em>name_format</em> option.</p>
  </dd>
  <dt>
    <p><em>max_log_file</em></p>
  </dt>
  <dd>
    <p>This keyword specifies the maximum file size in megabytes. When this limit is reached, it will trigger a configurable action. The value given must be numeric.</p>
  </dd>
  <dt>
    <p><em>max_log_file_action</em></p>
  </dt>
  <dd>
    <p>This parameter tells the system what action to take when the system has detected that the max file size limit has been reached. Valid values are <em>ignore</em>, <em>syslog</em>, <em>suspend</em>, <em>rotate</em> and <em>keep_logs.</em> If set to <em>ignore</em>, the audit daemon does nothing. <em>syslog</em> means that it will issue a warning to syslog. <em>suspend</em> will cause the audit daemon to stop writing records to the disk. The daemon will still be alive. The <em>rotate</em> option will cause the audit daemon to rotate the logs. It should be noted that logs with higher numbers are older than logs with lower numbers. This is the same convention used by the logrotate utility. The <em>keep_logs</em> option is similar to rotate except it does not use the num_logs setting. This prevents audit logs from being overwritten. The effect is that logs accumulate and are not deleted - which will trigger the <em>space_left_action</em> if the volume fills up. This is best used in combination with an external script used to archive logs on a periodic basis.</p>
  </dd>
  <dt>
    <p><em>action_mail_acct</em></p>
  </dt>
  <dd>
    <p>This option should contain a valid email address or alias. The default address is root. If the email address is not local to the machine, you must make sure you have email properly configured on your machine and network. Also, this option requires that /usr/lib/sendmail exists on the machine.</p>
  </dd>
  <dt>
    <p><em>space_left</em></p>
  </dt>
  <dd>
    <p>This is a numeric value in megabytes that tells the audit daemon when to perform a configurable action because the system is starting to run low on disk space.</p>
  </dd>
  <dt>
    <p><em>space_left_action</em></p>
  </dt>
  <dd>
    <p>This parameter tells the system what action to take when the system has detected that it is starting to get low on disk space. Valid values are <em>ignore</em>, <em>syslog</em>, <em>email</em>, <em>exec</em>, <em>suspend</em>, <em>single</em>, and <em>halt</em>. If set to <em>ignore</em>, the audit daemon does nothing. <em>syslog</em> means that it will issue a warning to syslog. <em>Email</em> means that it will send a warning to the email account specified in <em>action_mail_acct</em> as well as sending the message to syslog. <em>exec</em> /path-to-script will execute the script. You cannot pass parameters to the script. The script is also responsible for telling the auditd daemon to resume logging once its completed its action. This can be done by adding service auditd resume to the script. <em>suspend</em> will cause the audit daemon to stop writing records to the disk. The daemon will still be alive. The <em>single</em> option will cause the audit daemon to put the computer system in single user mode. The <em>halt</em> option will cause the audit daemon to shutdown the computer system.</p>
  </dd>
  <dt>
    <p><em>admin_space_left</em></p>
  </dt>
  <dd>
    <p>This is a numeric value in megabytes that tells the audit daemon when to perform a configurable action because the system <strong>is running low</strong> on disk space. This should be considered the last chance to do something before running out of disk space. The numeric value for this parameter should be lower than the number for space_left.</p>
  </dd>
  <dt>
    <p><em>admin_space_left_action</em></p>
  </dt>
  <dd>
    <p>This parameter tells the system what action to take when the system has detected that it <strong>is low on disk space.</strong> Valid values are <em>ignore</em>, <em>syslog</em>, <em>email</em>, <em>exec</em>, <em>suspend</em>, <em>single</em>, and <em>halt</em>. If set to <em>ignore</em>, the audit daemon does nothing. <em>Syslog</em> means that it will issue a warning to syslog. <em>Email</em> means that it will send a warning to the email account specified in <em>action_mail_acct</em> as well as sending the message to syslog. <em>exec</em> /path-to-script will execute the script. You cannot pass parameters to the script. The script is also responsible for telling the auditd daemon to resume logging once its completed its action. This can be done by adding service auditd resume to the script. <em>Suspend</em> will cause the audit daemon to stop writing records to the disk. The daemon will still be alive. The <em>single</em> option will cause the audit daemon to put the computer system in single user mode. The <em>halt</em> option will cause the audit daemon to shutdown the computer system.</p>
  </dd>
  <dt>
    <p><em>disk_full_action</em></p>
  </dt>
  <dd>
    <p>This parameter tells the system what action to take when the system has detected that the partition to which log files are written has become full. Valid values are <em>ignore</em>, <em>syslog</em>, <em>exec</em>, <em>suspend</em>, <em>single</em>, and <em>halt</em>. If set to <em>ignore</em>, the audit daemon will issue a syslog message but no other action is taken. <em>Syslog</em> means that it will issue a warning to syslog. <em>exec</em> /path-to-script will execute the script. You cannot pass parameters to the script. The script is also responsible for telling the auditd daemon to resume loggin g once its completed its action. This can be done by adding service auditd resume to the script. <em>Suspend</em> will cause the audit daemon to stop writing records to the disk. The daemon will still be alive. The <em>single</em> option will cause the audit daemon to put the computer system in single user mode. <em>halt</em> option will cause the audit daemon to shutdown the computer system.</p>
  </dd>
  <dt>
    <p><em>disk_error_action</em></p>
  </dt>
  <dd>
    <p>This parameter tells the system what action to take whenever there is an error detected when writing audit events to disk or rotating logs. Valid values are <em>ignore</em>, <em>syslog</em>, <em>exec</em>, <em>suspend</em>, <em>single</em>, and <em>halt</em>. If set to <em>ignore</em>, the audit daemon will not take any action. <em>Syslog</em> means that it will issue no more than 5 consecutive warnings to syslog. <em>exec</em> /path-to-script will execute the script. You cannot pass parameters to the script. <em>Suspend</em> will cause the audit daemon to stop writing records to the disk. The daemon will still be alive. The <em>single</em> option will cause the audit daemon to put the computer system in single user mode. <em>halt</em> option will cause the audit daemon to shutdown the computer system.</p>
  </dd>
  <dt>
    <p><em>tcp_listen_port</em></p>
  </dt>
  <dd>
    <p>This is a numeric value in the range 1..65535 which, if specified, causes auditd to listen on the corresponding TCP port for audit records from remote systems. The audit daemon may be linked with tcp_wrappers. You may want to control access with an entry in the hosts.allow and deny files.</p>
  </dd>
  <dt>
    <p><em>tcp_listen_queue</em></p>
  </dt>
  <dd>
    <p>This is a numeric value which indicates how many pending (requested but unaccepted) connections are allowed.  The default is 5.  Setting this too small may cause connections to be rejected if too many hosts start up at exactly the same time, such as after a power failure.</p>
  </dd>
  <dt>
    <p><em>tcp_max_per_addr</em></p>
  </dt>
  <dd>
    <p>This is a numeric value which indicates how many concurrent connections from one IP address is allowed.  The default is 1 and the maximum is 1024. Setting this too large may allow for a Denial of Service attack on the logging server. Also note that the kernel has an internal maximum that will eventually prevent this even if auditd allows it by config. The default should be adequate in most cases unless a custom written recovery script runs to forward unsent events. In this case you would increase the number only large enough to let it in too.</p>
  </dd>
  <dt>
    <p><em>use_libwrap</em></p>
  </dt>
  <dd>
    <p>This setting determines whether or not to use tcp_wrappers to discern connection attempts that are from allowed machines. Legal values are either <em>yes</em>, or <em>no</em> The default value is yes.</p>
  </dd>
  <dt>
    <p><em>tcp_client_ports</em></p>
  </dt>
  <dd>
    <p>This parameter may be a single numeric value or two values separated by a dash (no spaces allowed).  It indicates which client ports are allowed for incoming connections.  If not specified, any port is allowed.  Allowed values are 1..65535.  For example, to require the client use a priviledged port, specify <em>1-1023</em> for this parameter. You will also need to set the local_port option in the audisp-remote.conf file. Making sure that clients send from a privileged port is a security feature to prevent log injection attacks by untrusted users.</p>
  </dd>
  <dt>
    <p><em>tcp_client_max_idle</em></p>
  </dt>
  <dd>
    <p>This parameter indicates the number of seconds that a client may be idle (i.e. no data from them at all) before auditd complains. This is used to close inactive connections if the client machine has a problem where it cannot shutdown the connection cleanly. Note that this is a global setting, and must be higher than any individual client heartbeat_timeout setting, preferably by a factor of two.  The default is zero, which disables this check.</p>
  </dd>
  <dt>
    <p><em>enable_krb5</em></p>
  </dt>
  <dd>
    <p>If set to "yes", Kerberos 5 will be used for authentication and encryption.  The default is "no".</p>
  </dd>
  <dt>
    <p><em>krb5_principal</em></p>
  </dt>
  <dd>
    <p>This is the principal for this server.  The default is "auditd". Given this default, the server will look for a key named like <em>auditd/hostname@EXAMPLE.COM</em> stored in <em>/etc/audit/audit.key</em> to authenticate itself, where hostname is the canonical name for the server's host, as returned by a DNS lookup of its IP address.</p>
  </dd>
  <dt>
    <p><em>krb5_key_file</em></p>
  </dt>
  <dd>
    <p>Location of the key for this client's principal. Note that the key file must be owned by root and mode 0400. The default is <em>/etc/audit/audit.key</em></p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>In a CAPP environment, the audit trail is considered so important that access to system resources must be denied if an audit trail cannot be created. In this environment, it would be suggested that /var/log/audit be on its own partition. This is to ensure that space detection is accurate and that no other process comes along and consumes part of it.</p><p>The flush parameter should be set to sync or data.</p><p>Max_log_file and num_logs need to be adjusted so that you get complete use of your partition. It should be noted that the more files that have to be rotated, the longer it takes to get back to receiving audit events. Max_log_file_action should be set to keep_logs.</p><p>Space_left should be set to a number that gives the admin enough time to react to any alert message and perform some maintenance to free up disk space. This would typically involve running the <strong>aureport -t</strong> report and moving the oldest logs to an archive area. The value of space_left is site dependent since the rate at which events are generated varies with each deployment. The space_left_action is recommended to be set to email. If you need something like an snmp trap, you can use the exec option to send one.</p><p>Admin_space_left should be set to the amount of disk space on the audit partition needed for admin actions to be recorded. Admin_space_left_action would be set to single so that use of the machine is restricted to just the console.</p><p>The disk_full_action is triggered when no more room exists on the partition. All access should be terminated since no more audit capability exists. This can be set to either single or halt.</p><p>The disk_error_action should be set to syslog, single, or halt depending on your local policies regarding handling of hardware malfunctions.</p><p>Specifying a single allowed client port may make it difficult for the client to restart their audit subsystem, as it will be unable to recreate a connection with the same host addresses and ports until the connection closure TIME_WAIT state times out.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>/etc/audit/auditd.conf</em></p>
  </dt>
  <dd>
    <p>Audit daemon configuration file</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO auditd.conf&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/auditd.8.html"><strong>auditd</strong>(8)</a>, <a href="../man5/audisp-remote.conf.5.html"><strong>audisp-remote.conf</strong>(5)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Steve Grubb</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="audispd.conf.5.html"><span aria-hidden="true">&larr;</span> audispd.conf.5: The audit event dispatcher configuration file</a></li>
   <li class="next"><a href="ausearch-expression.5.html">ausearch-expression.5: Audit search expression format <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
