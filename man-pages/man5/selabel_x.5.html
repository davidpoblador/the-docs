<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>selabel_x: Userspace selinux labeling interface and configuration file format for the x window system contexts backend. this backend is also used to determine the default context for labeling remotely connected x clients</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Userspace selinux labeling interface and configuration file format for the x window system contexts backend. this backend is also used to determine the default context for labeling remotely connected x clients">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="selabel_x (5) manual">
  <meta name="twitter:description" content="Userspace selinux labeling interface and configuration file format for the x window system contexts backend. this backend is also used to determine the default context for labeling remotely connected x clients">
  <meta name="twitter:image" content="https://www.carta.tech/images/selinux-utils-selabel_x-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/selabel_x.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="selabel_x (5) manual" />
  <meta property="og:description" content="Userspace selinux labeling interface and configuration file format for the x window system contexts backend. this backend is also used to determine the default context for labeling remotely connected x clients" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/selinux-utils-selabel_x-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">selabel_x<small> (5)</small></h1>
        <p class="lead">Userspace selinux labeling interface and configuration file format for the x window system contexts backend. this backend is also used to determine the default context for labeling remotely connected x clients</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/selabel_x.5.html">
      <span itemprop="name">selabel_x: Userspace selinux labeling interface and configuration file format for the x window system contexts backend. this backend is also used to determine the default context for labeling remotely connected x clients</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/selinux-utils/">
      <span itemprop="name">selinux-utils</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/selabel_x.5.html">
      <span itemprop="name">selabel_x: Userspace selinux labeling interface and configuration file format for the x window system contexts backend. this backend is also used to determine the default context for labeling remotely connected x clients</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>#include &lt;selinux/label.h&gt;</strong></p><p><strong>int selabel_lookup(struct selabel_handle *</strong><em>hnd</em><strong>,</strong> <strong>char **</strong><em>context</em><strong>,</strong></p><p><strong>const char *</strong><em>object_name</em><strong>, int </strong><em>object_type</em><strong>);</strong></p><p><strong>int selabel_lookup_raw(struct selabel_handle *</strong><em>hnd</em><strong>,</strong> <strong>char **</strong><em>context</em><strong>,</strong></p><p><strong>const char *</strong><em>object_name</em><strong>, int </strong><em>object_type</em><strong>);</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The X contexts backend maps from X Window System object names into security contexts. It is used to find the appropriate context for X Window System objects whose significance and/or usage semantics are determined primarily by name. The returned <em>context</em> must be freed using <a href="../man3/freecon.3.html"><strong>freecon</strong>(3)</a>.</p><p><a href="../man3/selabel_lookup.3.html"><strong>selabel_lookup</strong>(3)</a> describes the function with its return and error codes.</p><p>This backend is also used to determine the default context for labeling remotely connected X clients.</p><p>The <em>object_type</em> argument should be set to one of the following values:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>SELABEL_X_PROP</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of a window property, such as "WM_NAME".</p>
  </dd>
  <dt>
    <p><strong>SELABEL_X_SELN</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of a selection, such as "PRIMARY".</p>
  </dd>
  <dt>
    <p><strong>SELABEL_X_EXT</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of a protocol extension, such as "RENDER".</p>
  </dd>
  <dt>
    <p><strong>SELABEL_X_EVENT</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument specifies the name of an event type, such as "X11:ButtonPress".</p>
  </dd>
  <dt>
    <p><strong>SELABEL_X_CLIENT</strong></p>
  </dt>
  <dd>
    <p>The <em>object_name</em> argument is ignored, however it should be set to either <em>*</em> (an asterisk or 'wildcard' that will select the default entry) or a specific entry such as "remote" in the X contexts file as shown in the <strong>EXAMPLE</strong> section. The default context for labeling remote X clients is then returned.</p>
  </dd>
  <dt>
    <p><strong>SELABEL_X_POLYPROP</strong></p>
  </dt>
  <dd>
    <p>Like <strong>SELABEL_X_PROP</strong>, but checks if the property was marked as being polyinstantiated. See <strong>NOTES</strong> below.</p>
  </dd>
  <dt>
    <p><strong>SELABEL_X_POLYSELN</strong></p>
  </dt>
  <dd>
    <p>Like <strong>SELABEL_X_SELN</strong>, but checks if the selection was marked as being polyinstantiated. See <strong>NOTES</strong> below.</p>
  </dd>

</dl>
<p>Any messages generated by <a href="../man3/selabel_lookup.3.html"><strong>selabel_lookup</strong>(3)</a> are sent to <em>stderr</em> by default, although this can be changed by <a href="../man3/selinux_set_callback.3.html"><strong>selinux_set_callback</strong>(3)</a>.</p><p><strong>selabel_lookup_raw</strong> behaves identically to <strong>selabel_lookup</strong> but does not perform context translation.</p><p>The <strong>FILES</strong> section details the configuration files used to determine the X object context.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p>In addition to the global options described in <a href="../man3/selabel_open.3.html"><strong>selabel_open</strong>(3)</a>, this backend recognizes the following options:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>SELABEL_OPT_PATH</strong></p>
  </dt>
  <dd>
    <p>A non-null value for this option specifies a path to a file that will be opened in lieu of the standard X contexts file (see the <strong>FILES</strong> section for details).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>The X context file used to retrieve a default context depends on the <strong>SELABEL_OPT_PATH</strong> parameter passed to <a href="../man3/selabel_open.3.html"><strong>selabel_open</strong>(3)</a>. If <em>NULL</em>, then the <strong>SELABEL_OPT_PATH</strong> value will default to the active policy X contexts location (as returned by <a href="../man3/selinux_x_context_path.3.html"><strong>selinux_x_context_path</strong>(3)</a>), otherwise the actual <strong>SELABEL_OPT_PATH</strong> value specified is used.</p><p>The default X object contexts file is:</p><p><em>/etc/selinux/{SELINUXTYPE}/contexts/x_contexts</em></p><p>Where <em>{SELINUXTYPE}</em> is the entry from the selinux configuration file <em>config</em> (see <a href="../man5/selinux_config.5.html"><strong>selinux_config</strong>(5)</a>).</p><p>The entries within the X contexts file are shown in the <strong>Object Name String Values</strong> and <strong>FILE FORMAT</strong> sections.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Object Name String Values</h2>
        <div class="sectioncontent">
<p>The string name assigned to each <em>object_type</em> argument that can be present in the X contexts file are:</p><table class="table table-striped">
<tr>
<th>object_type</th>
<th>Text Name</th>
<th></th></tr>

<tr>
<td>SELABEL_X_PROP</td>
<td>property</td>
<td></td></tr>

<tr>
<td>SELABEL_X_SELN</td>
<td>selection</td>
<td></td></tr>

<tr>
<td>SELABEL_X_EXT</td>
<td>extension</td>
<td></td></tr>

<tr>
<td>SELABEL_X_EVENT</td>
<td>event</td>
<td></td></tr>

<tr>
<td>SELABEL_X_CLIENT</td>
<td>client</td>
<td></td></tr>

<tr>
<td>SELABEL_X_POLYPROP</td>
<td>poly_property</td>
<td></td></tr>

<tr>
<td>SELABEL_X_POLYSELN</td>
<td>poly_selection</td>
<td></td></tr>
</table>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILE FORMAT</h2>
        <div class="sectioncontent">
<p>Each line within the X contexts file is as follows:</p><p><em>object_type object_name context</em></p><p>Where:</p><p><em>object_type</em></p><p>This is the string representation of the object type shown in the <strong>Object Name String Values</strong> section. There can be multiple lines with the same <em>object_type</em> string that will form a block of entries (each with a different <em>object_name</em> entry).</p><p><em>object_name</em></p><p>These are the object names of the specific X-server resource such as <strong>PRIMARY</strong>, <strong>CUT_BUFFER0</strong> etc. They are generally defined in the X-server source code (<em>protocol.txt</em> and <em>BuiltInAtoms</em> in the dix directory of the xorg-server source package). The entry can contain '*' for wildcard matching or '?' for substitution. Note that if the '*' is used, then be aware that the order of entries in the file is important. The '*' on its own is used to ensure a default fallback context is assigned and should be the last entry in the <em>object_type</em> block.</p><p><em>context</em></p><p>The security context that will be applied to the object.</p><p>Example 1:</p>
<pre>
# object_type  object_name  context
selection      PRIMARY      system_u:object_r:clipboard_xselection_t:s0
selection      *            system_u:object_r:xselection_t:s0
</pre>
<p>Example 2 - This example shows how a client entry can be configured to ensure an entry is always found:</p>
<pre>
# object_type  object_name  context
client         *            system_u:object_r:remote_t:s0
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    1.
  </dt>
  <dd>
    <p>Properties and selections are marked as either polyinstantiated or not. For these name types, the "POLY" option searches only the names marked as being polyinstantiated, while the other option searches only the names marked as not being polyinstantiated. Users of the interface should check both mappings, optionally taking action based on the result (e.g. polyinstantiating the object).</p>
  </dd>
  <dt>
    2.
  </dt>
  <dd>
    <p>If contexts are to be validated, then the global option <strong>SELABEL_OPT_VALIDATE</strong> must be set before calling <a href="../man3/selabel_open.3.html"><strong>selabel_open</strong>(3)</a>. If this is not set, then it is possible for an invalid context to be returned.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO selabel_x&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/selinux.8.html"><strong>selinux</strong>(8)</a>, <a href="../man3/selabel_open.3.html"><strong>selabel_open</strong>(3)</a>, <a href="../man3/selabel_lookup.3.html"><strong>selabel_lookup</strong>(3)</a>, <a href="../man3/selabel_stats.3.html"><strong>selabel_stats</strong>(3)</a>, <a href="../man3/selabel_close.3.html"><strong>selabel_close</strong>(3)</a>, <a href="../man3/selinux_set_callback.3.html"><strong>selinux_set_callback</strong>(3)</a>, <a href="../man3/selinux_x_context_path.3.html"><strong>selinux_x_context_path</strong>(3)</a>, <a href="../man3/freecon.3.html"><strong>freecon</strong>(3)</a>, <a href="../man5/selinux_config.5.html"><strong>selinux_config</strong>(5)</a> </p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="selabel_media.5.html"><span aria-hidden="true">&larr;</span> selabel_media.5: Userspace selinux labeling interface and configuration file format for the media contexts backend</a></li>
   <li class="next"><a href="selinux_config.5.html">selinux_config.5: The selinux sub-system configuration file. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
