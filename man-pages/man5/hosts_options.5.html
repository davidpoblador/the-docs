<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>hosts_options: Host access control language extensions</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Host access control language extensions">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="hosts_options (5) manual">
  <meta name="twitter:description" content="Host access control language extensions">
  <meta name="twitter:image" content="https://www.carta.tech/images/libwrap0-hosts_options-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/hosts_options.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="hosts_options (5) manual" />
  <meta property="og:description" content="Host access control language extensions" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libwrap0-hosts_options-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">hosts_options<small> (5)</small></h1>
        <p class="lead">Host access control language extensions</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/hosts_options.5.html">
      <span itemprop="name">hosts_options: Host access control language extensions</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libwrap0/">
      <span itemprop="name">libwrap0</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/hosts_options.5.html">
      <span itemprop="name">hosts_options: Host access control language extensions</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This document describes extensions to the language described in the <a href="../man5/hosts_access.5.html"><strong>hosts_access</strong>(5)</a> document.</p><p>The extensible language uses the following format:</p><p>daemon_list : client_list : option : option ...</p><p>The first two fields are described in the <a href="../man5/hosts_access.5.html"><strong>hosts_access</strong>(5)</a> manual page. The remainder of the rules is a list of zero or more options.  Any ":" characters within options should be protected with a backslash.</p><p>An option is of the form "keyword" or "keyword value". Options are processed in the specified order. Some options are subjected to %&lt;letter&gt; substitutions. For the sake of backwards compatibility with earlier versions, an "=" is permitted between keyword and value.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOGGING</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    severity mail.info
  </dt>
  <dd>
    
  </dd>
  <dt>
    severity notice
  </dt>
  <dd>
    <p>Change the severity level at which the event will be logged. Facility names (such as mail) are optional, and are not supported on systems with older syslog implementations. The severity option can be used to emphasize or to ignore specific events.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ACCESS CONTROL</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    allow
  </dt>
  <dd>
    
  </dd>
  <dt>
    deny
  </dt>
  <dd>
    <p>Grant (deny) service. These options must appear at the end of a rule.</p>
  </dd>

</dl>
<p>The <em>allow</em> and <em>deny</em> keywords make it possible to keep all access control rules within a single file, for example in the <em>hosts.allow</em> file.</p><p>To permit access from specific hosts only:</p><p>ALL: .friendly.domain: ALLOW ALL: ALL: DENY</p><p>To permit access from all hosts except a few trouble makers:</p><p>ALL: .bad.domain: DENY ALL: ALL: ALLOW</p><p>Notice the leading dot on the domain name patterns.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RUNNING OTHER COMMANDS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    aclexec shell_command
  </dt>
  <dd>
    <p>Execute, in a child process, the specified shell command, after performing the %&lt;letter&gt; expansions described in the <a href="../man5/hosts_access.5.html"><strong>hosts_access</strong>(5)</a> manual page.  The command is executed with stdin, stdout and stderr connected to the null device, so that it won't mess up the conversation with the client host. Example:</p>
<pre>
smtp : ALL : aclexec checkdnsbl %a
</pre>
<p>executes, in a background child process, the shell command "checkdnsbl %a" after replacing %a by the address of the remote host.</p><p>The connection will be allowed or refused depending on whether the command returns a true or false exit status.</p>
  </dd>
  <dt>
    spawn shell_command
  </dt>
  <dd>
    <p>Execute, in a child process, the specified shell command, after performing the %&lt;letter&gt; expansions described in the <a href="../man5/hosts_access.5.html"><strong>hosts_access</strong>(5)</a> manual page.  The command is executed with stdin, stdout and stderr connected to the null device, so that it won't mess up the conversation with the client host. Example:</p>
<pre>
spawn (/usr/sbin/safe_finger -l @%h | /usr/bin/mail root) &
</pre>
<p>executes, in a background child process, the shell command "safe_finger -l @%h | mail root" after replacing %h by the name or address of the remote host.</p><p>The example uses the "safe_finger" command instead of the regular "finger" command, to limit possible damage from data sent by the finger server. The "safe_finger" command is part of the daemon wrapper package; it is a wrapper around the regular finger command that filters the data sent by the remote host.</p>
  </dd>
  <dt>
    twist shell_command
  </dt>
  <dd>
    <p>Replace the current process by an instance of the specified shell command, after performing the %&lt;letter&gt; expansions described in the <a href="../man5/hosts_access.5.html"><strong>hosts_access</strong>(5)</a> manual page.  Stdin, stdout and stderr are connected to the client process. This option must appear at the end of a rule.</p><p>To send a customized bounce message to the client instead of running the real ftp daemon:</p>
<pre>
in.ftpd : ... : twist /bin/echo 421 Some bounce message
</pre>
<p>For an alternative way to talk to client processes, see the <em>banners</em> option below.</p><p>To run /some/other/in.telnetd without polluting its command-line array or its process environment:</p>
<pre>
in.telnetd : ... : twist PATH=/some/other; exec in.telnetd
</pre>
<p>Warning:  in case of UDP services, do not twist to commands that use the standard I/O or the <a href="../man2/read.2.html"><strong>read</strong>(2)</a>/<a href="../man2/write.2.html"><strong>write</strong>(2)</a> routines to communicate with the client process; UDP requires other I/O primitives.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NETWORK OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    keepalive
  </dt>
  <dd>
    <p>Causes the server to periodically send a message to the client.  The connection is considered broken when the client does not respond. The keepalive option can be useful when users turn off their machine while it is still connected to a server.  The keepalive option is not useful for datagram (UDP) services.</p>
  </dd>
  <dt>
    linger number_of_seconds
  </dt>
  <dd>
    <p>Specifies how long the kernel will try to deliver not-yet delivered data after the server process closes a connection.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USERNAME LOOKUP</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    rfc931 [ timeout_in_seconds ]
  </dt>
  <dd>
    <p>Look up the client user name with the RFC 931 (TAP, IDENT, RFC 1413) protocol.  This option is silently ignored in case of services based on transports other than TCP.  It requires that the client system runs an RFC 931 (IDENT, etc.) -compliant daemon, and may cause noticeable delays with connections from non-UNIX clients.  The timeout period is optional. If no timeout is specified a compile-time defined default value is taken.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MISCELLANEOUS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    banners /some/directory
  </dt>
  <dd>
    <p>Look for a file in `/some/directory\' with the same name as the daemon process (for example in.telnetd for the telnet service), and copy its contents to the client. Newline characters are replaced by carriage-return newline, and %&lt;letter&gt; sequences are expanded (see the <a href="../man5/hosts_access.5.html"><strong>hosts_access</strong>(5)</a> manual page).</p><p>The tcp wrappers source code distribution provides a sample makefile (Banners.Makefile) for convenient banner maintenance.</p><p>Warning: banners are supported for connection-oriented (TCP) network services only.</p>
  </dd>
  <dt>
    nice [ number ]
  </dt>
  <dd>
    <p>Change the nice value of the process (default 10).  Specify a positive value to spend more CPU resources on other processes.</p>
  </dd>
  <dt>
    setenv name value
  </dt>
  <dd>
    <p>Place a (name, value) pair into the process environment. The value is subjected to %&lt;letter&gt; expansions and may contain whitespace (but leading and trailing blanks are stripped off).</p><p>Warning: many network daemons reset their environment before spawning a login or shell process.</p>
  </dd>
  <dt>
    umask 022
  </dt>
  <dd>
    <p>Like the umask command that is built into the shell. An umask of 022 prevents the creation of files with group and world write permission. The umask argument should be an octal number.</p>
  </dd>
  <dt>
    user nobody
  </dt>
  <dd>
    
  </dd>
  <dt>
    user nobody.kmem
  </dt>
  <dd>
    <p>Assume the privileges of the "nobody" userid (or user "nobody", group "kmem"). The first form is useful with inetd implementations that run all services with root privilege. The second form is useful for services that need special group privileges only.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">
<p>When a syntax error is found in an access control rule, the error is reported to the syslog daemon; further options will be ignored, and service is denied.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO hosts_options&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/hosts_access.5.html"><strong>hosts_access</strong>(5)</a>, the default access control language</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">

<pre>
Wietse Venema (wietse@wzv.win.tue.nl)
Department of Mathematics and Computing Science
Eindhoven University of Technology
Den Dolech 2, P.O. Box 513,
5600 MB Eindhoven, The Netherlands

</pre>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="hosts_access.5.html"><span aria-hidden="true">&larr;</span> hosts_access.5: Format of host access control files</a></li>
   <li class="next"><a href="hotswaprc.5.html">hotswaprc.5: Configuration file for  hotswap <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
