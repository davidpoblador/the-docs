<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>init: Upstart init daemon job configuration</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Upstart init daemon job configuration">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="init (5) manual">
  <meta name="twitter:description" content="Upstart init daemon job configuration">
  <meta name="twitter:image" content="https://www.carta.tech/images/upstart-init-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/init.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="init (5) manual" />
  <meta property="og:description" content="Upstart init daemon job configuration" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/upstart-init-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">init<small> (5)</small></h1>
        <p class="lead">Upstart init daemon job configuration</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/init.5.html">
      <span itemprop="name">init: Upstart init daemon job configuration</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/upstart/">
      <span itemprop="name">upstart</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/init.5.html">
      <span itemprop="name">init: Upstart init daemon job configuration</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>/etc/init/</strong></p>
  </dt>
  <dd>
    <p>Default location of system job configuration files.</p>
  </dd>
  <dt>
    <p><strong>$XDG_CONFIG_HOME/upstart/, $XDG_CONFIG_DIRS/upstart/</strong></p>
  </dt>
  <dd>
    <p>Default locations of user session job configuration files.</p>
  </dd>
  <dt>
    <p><strong>$HOME/.init/</strong></p>
  </dt>
  <dd>
    <p>Deprecated location of user job configuration files (still honoured by User Session Mode).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>On startup, the Upstart <a href="../man8/init.8.html"><strong>init</strong>(8)</a> daemon reads its job configuration from files in the <em>/etc/init/</em> directory, and watches for future changes to these files using <a href="../man7/inotify.7.html"><strong>inotify</strong>(7)</a>.</p><p>If Upstart was invoked as a user process with --user option, it will run in User Session mode. See <strong>User Session Mode</strong> for further details.</p><p>To be considered by Upstart, files in this directory must have a recognized suffix and may also be present in sub-directories.  There are two recognized suffixes:</p><ul>
<li><p>Files ending in <em>.conf</em> are called configuration files, or simply "conf files" for short. These are the primary vehicle for specifying a job.</p></li><li><p>Files ending in <em>.override</em> are called override files.  If an override file is present, the stanzas it contains take precedence over those equivalently named stanzas in the corresponding configuration file contents for a particular job. The main use for override files is to modify how a job will run without having to modify its configuration file directly.  See the section <strong>Override File Handling</strong> below for further details.</p></li>
</ul><p>A job can thus be defined by either:</p>
<dl class='dl-vertical'>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>A single configuration file.</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>A single configuration file <strong>and</strong> a single override file.</p>
  </dd>

</dl>
<p>Unless explicitly stated otherwise, any reference to a jobs configuration can refer both to a configuration file or an override file.</p><p>Each configuration file defines the template for a single <em>service</em> (long-running process or daemon) or <em>task</em> (short-lived process).</p><p>Note that a configuration file is not itself a job: it is a description of an environmenta job could be run in.  A job is the runtime embodiment of a configuration file.</p><p>The configuration file name as displayed by Upstart and associated tooling is taken from its relative path within the directory without the extension.  For example a configuration file <em>/etc/init/rc-sysinit.conf</em> is named <em>rc-sysinit</em>, while a configuration file <em>/etc/init/net/apache.conf</em> is named <em>net/apache</em>. Since override files only modify the way a configuration file is interpreted, they are not named.</p><p>Configuration files are plain text and should not be executable.</p><h3>Chroot Support</h3>
<p>Upstart is able to manage jobs within a <a href="../man2/chroot.2.html"><strong>chroot</strong>(2)</a>. To control jobs within the chroot environment, use the standard <a href="../man8/initctl.8.html"><strong>initctl</strong>(8)</a> facility. Note that it is not necessary to install D-Bus within the chroot (in fact it is not recommended).</p><p>Note that this facility is distinct from the <strong>chroot</strong> stanza (see <strong>Process environment</strong> below).</p>
<h3>User Session Mode</h3>
<p>Upstart can manage complete User Sessions. In this mode it runs with a process id greater than 1 and will read job configuration files from the following list of directories in the order shown:</p><ul>
<li><p><em>$XDG_CONFIG_HOME/upstart/</em></p></li><li><p><em>$HOME/.init/</em></p></li><li><p><em>$XDG_CONFIG_DIRS/upstart/</em></p></li><li><p><em>/usr/share/upstart/sessions/</em></p></li>
</ul><p>Note that the first directory to contain a job is considered the owner of that job name: any subsequently searched directory that contains a job of the same name will be ignored. The same applies for override files: only the first override file found in the search order will be applied. Note that an override file can be in the same directory or earlier to that directory which contains the job file.</p><p>Jobs in these locations are expected to launch the user's session. Upstart will try to parent all spawned process with the aid of <a href="../man2/prctl.2.html"><strong>prctl</strong>(2)</a><strong></strong>. If successful this will ensure that even double-forking daemons will be reparented to the User Session process, and not to the <a href="../man8/init.8.html"><strong>init</strong>(8)</a> daemon running with process id 1.</p><p>When running in User Session mode, Upstart will kill all job processes on session logout or shutdown.</p><p>All log output will be in <em>$XDG_CACHE_HOME/upstart</em> which defaults to <em>$HOME/.cache/upstart</em></p>
<h3>Configuration File Format</h3>
<p>Each line begins with a configuration stanza and continues until either the end of the line or a line containing a closing stanza.  Line breaks within a stanza are permitted within single or double quotes, or if preceded by a blackslash.</p><p>If a stanza is duplicated, the last occurence will be used. Unrecognized stanzas will generate parse errors, which will stop a job from running.</p><p>Stanzas and their arguments are delimited by whitespace, which consists of one or more space or tab characters which are otherwise ignored unless placed within single or double quotes.</p><p>Comments begin with a `#' and continue until the end of the line.  Blank lines and lines consisting only of whitespace or comments are ignored.</p>
<h3>Process definition</h3>
<p>The primary use of jobs is to define services or tasks to be run by the <a href="../man8/init.8.html"><strong>init</strong>(8)</a> daemon.  Each job may have one or more different processes run as part of its lifecycle, with the most common known as the main process.</p><p>The main process is defined using either the <strong>exec</strong> or <strong>script</strong> stanzas, only one of which is permitted.  These specify the executable or shell script that will be run when the job is considered to be running. Once this process terminates, the job stops.</p><p>All processes are run with the full job environment available as environment variables in their process.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>exec </strong><em>COMMAND </em>[ <em>ARG </em>]...</p>
  </dt>
  <dd>
    <p>This stanza defines the process to be run as the name of an executable on the filesystem, and zero or more arguments to be passed to it.  Any special characters, e.g. quotes or `$' specified will result in the entire command being passed to a shell for expansion.</p>
<pre>
exec /usr/sbin/acpid -c $EVENTSDIR -s $SOCKET
</pre>

  </dd>
  <dt>
    <p><strong>script </strong>... <strong>end script</strong></p>
  </dt>
  <dd>
    <p>This stanza defines the process to be run as a shell script that will be executed using <strong>sh(1).</strong> The <em>-e</em> shell option is always used, so any command that fails will terminate the script.</p><p>The <strong>script</strong> stanza appears on its own on a line, the script is everything up until the first <strong>end script</strong> stanza appearing on its own on a line.</p>
<pre>
script
    dd bs=1 if=/proc/kmsg of=$KMSGSINK
    exec /sbin/klogd -P $KMSGSINK
end script
</pre>

  </dd>

</dl>
<p>There are an additional four processes that may be run as part of the job's lifecycle.  These are specified as the process name, followed by an <strong>exec</strong> or <strong>script</strong> stanza.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>pre-start exec</strong>|<strong>script</strong>...</p>
  </dt>
  <dd>
    <p>This process will be run after the job's <a href="../man7/starting.7.html"><strong>starting</strong>(7)</a> event has finished, but before the main process is run.  It is typically used to prepare the environment, such as making necessary directories, and it may also call the <a href="../man8/stop.8.html"><strong>stop</strong>(8)</a> command without arguments to cancel the start.</p>
  </dd>
  <dt>
    <p><strong>post-start exec</strong>|<strong>script</strong>...</p>
  </dt>
  <dd>
    <p>This process will be run before the job's <a href="../man7/started.7.html"><strong>started</strong>(7)</a> event is emitted, but after the main process has been spawned.  It is typically used to send necessary commands to the main process, or to delay the <a href="../man7/started.7.html"><strong>started</strong>(7)</a> event until the main process is ready to receive clients.</p>
  </dd>
  <dt>
    <p><strong>pre-stop exec</strong>|<strong>script</strong>...</p>
  </dt>
  <dd>
    <p>This process is run if the job is stopped by an event listed in its <strong>stop on</strong> stanza or by the <a href="../man8/stop.8.html"><strong>stop</strong>(8)</a> command.  It will be run before the job's <a href="../man7/stopping.7.html"><strong>stopping</strong>(7)</a> event is emitted and before the main process is killed.  It is typically used to send any necessary shutdown commands to the main process, and it may also call the <a href="../man8/start.8.html"><strong>start</strong>(8)</a> command without arguments to cancel the stop.</p>
  </dd>
  <dt>
    <p><strong>post-stop exec</strong>|<strong>script</strong>...</p>
  </dt>
  <dd>
    <p>This process is run after the main process has been killed and before the job's <a href="../man7/stopped.7.html"><strong>stopped</strong>(7)</a> event is emitted.  It is typically used to clean up the environment, such as removing temporary directories.</p>
  </dd>

</dl>
<p>All of these processes, including the main process, are optional. Services without a main process will appear to be running until they are stopped: this is commonly used to define states such as runlevels.  It is permissible to have no main process, but to have <strong>pre-start</strong> and <strong>post-stop</strong> processes for the state.</p>
<pre>
pre-start exec ifup -a
post-stop exec ifdown -a
</pre>

<h3>Event definition</h3>
<p>Jobs can be manually started and stopped at any time by a system administrator using the <a href="../man8/start.8.html"><strong>start</strong>(8)</a> and <a href="../man8/stop.8.html"><strong>stop</strong>(8)</a> tools, however it is far more useful for jobs to be started and stopped automatically by the <a href="../man8/init.8.html"><strong>init</strong>(8)</a> daemon when necessary.</p><p>This is done by specifying which events should cause your job to be started, and which cause your process to be stopped again.</p><p>The set of possible events is limitless, however there are a number of standard events defined by the <a href="../man8/init.8.html"><strong>init</strong>(8)</a> daemon and <a href="../man8/telinit.8.html"><strong>telinit</strong>(8)</a> tools that you will want to use.</p><p>When first started, the <a href="../man8/init.8.html"><strong>init</strong>(8)</a> daemon will emit the <a href="../man7/startup.7.html"><strong>startup</strong>(7)</a> event.  This will activate jobs that implement System V compatibility and the <a href="../man7/runlevel.7.html"><strong>runlevel</strong>(7)</a> event.  As jobs are started and stopped, the <a href="../man8/init.8.html"><strong>init</strong>(8)</a> daemon will emit the <a href="../man7/starting.7.html"><strong>starting</strong>(7)</a>, <a href="../man7/started.7.html"><strong>started</strong>(7)</a>, <a href="../man7/stopping.7.html"><strong>stopping</strong>(7)</a> and <a href="../man7/stopped.7.html"><strong>stopped</strong>(7)</a> events on their behalf.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>start on </strong><em>EVENT </em>[[<em>KEY=</em>]<em>VALUE</em>]... [<strong>and</strong>|<strong>or</strong>...]</p>
  </dt>
  <dd>
    <p>The <strong>start on</strong> stanza defines the set of events that will cause the job to be automatically started.  Each <em>EVENT</em> is given by its name.  Multiple events are permitted using the <strong>and</strong> & <strong>or</strong> operators, and complex expressions may be performed with parentheses (within which line breaks are permitted).</p><p>You may also match on the environment variables contained within the event by specifying the <em>KEY</em> and expected <em>VALUE</em>. If you know the order in which the variables are given to the event you may omit the <em>KEY</em>.</p><p><em>VALUE</em> may contain wildcard matches and globs as permitted by <a href="../man3/fnmatch.3.html"><strong>fnmatch</strong>(3)</a> and may expand the value of any variable defined with the <strong>env</strong> stanza.</p><p>Negation is permitted by using <em>!=</em> between the <em>KEY</em> and <em>VALUE</em>.</p>
<pre>
start on started gdm or started kdm

start on device-added SUBSYSTEM=tty DEVPATH=ttyS*

start on net-device-added INTERFACE!=lo
</pre>

  </dd>
  <dt>
    <p><strong>stop on </strong><em>EVENT </em>[[<em>KEY=</em>]<em>VALUE</em>]... [<strong>and</strong>|<strong>or</strong>...]</p>
  </dt>
  <dd>
    <p>The <strong>stop on</strong> stanza defines the set of events that will cause the job to be automatically stopped.  It has the same syntax as <strong>start on</strong>.</p><p><em>VALUE</em> may additionally expand the value of any variable that came from the job's start environment (either the event or the command that started it).</p>
<pre>
stop on stopping gdm or stopping kdm

stop on device-removed DEVPATH=$DEVPATH
</pre>

  </dd>
  <dt>
    <p><strong>manual</strong></p>
  </dt>
  <dd>
    <p>This stanza will disregard any <em>previously seen</em> <strong>start on</strong> definition.  By adding this stanza on any line below the <strong>start on</strong> definition, it provides the ability to stop a job from being automatically started.  When specified, the only way to start such a job is via <strong>start</strong> (8).</p>
  </dd>

</dl>

<h3>Job environment</h3>
<p>Each job is run with an environment constructed from the following categories:</p><ul>
<li><p>A minimal set of standard system variables added by Upstart.</p><p>All jobs contain the <strong>TERM</strong> and <strong>PATH</strong> variables.</p></li><li><p>Variables set using the <a href="../man8/initctl.8.html"><strong>initctl</strong>(8)</a> job environment commands (such as <em>set-env</em>).</p><p>These commands also allow unsetting of variables.</p></li><li><p>A set of special variables added by Upstart that relate to the job itself.</p><p>All jobs also contain the <strong>UPSTART_JOB</strong> and <strong>UPSTART_INSTANCE</strong> environment variables, containing the name of the job and instance.  These are mostly used by the <a href="../man8/initctl.8.html"><strong>initctl</strong>(8)</a> utility to default to acting on the job the commands are called from.</p></li><li><p>Those variables introduced by the events or command that started the job.</p><p>The special <strong>UPSTART_EVENTS</strong> environment variable contains the list of events that started the job, it will not be present if the job was started manually.</p><p>The <strong>pre-stop</strong> and <strong>post-stop</strong> scripts are run with the environment of the events or commands that stopped the job.  The <strong>UPSTART_STOP_EVENTS</strong> environment variable contains the list of events that stopped the job, it will not be present if the job was stopped manually.</p></li><li><p>Variables set within the job itself using the <strong>env</strong> and <strong>export</strong> stanzas. These provide default values - if the command or event which causes the job to start specifies alternative values, those are given priority over the defaults.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>env </strong><em>KEY</em>[=<em>VALUE</em>]</p>
  </dt>
  <dd>
    <p>Defines a default environment variable, the value of which may be overridden by the event or command that starts the job. If \'KEY=VALUE\' is specified, the variable KEY is given the value VALUE. If only \'KEY\' is given, then the value is taken from the <a href="../man8/init.8.html"><strong>init</strong>(8)</a> daemon's own environment.</p>
  </dd>
  <dt>
    <p><strong>export </strong><em>KEY</em></p>
  </dt>
  <dd>
    <p>Exports the value of an environment variable into the <a href="../man7/starting.7.html"><strong>starting</strong>(7)</a>, <a href="../man7/started.7.html"><strong>started</strong>(7)</a>, <a href="../man7/stopping.7.html"><strong>stopping</strong>(7)</a> and <a href="../man7/stopped.7.html"><strong>stopped</strong>(7)</a> events for this job and to all resultant events (not just those relating to the current job).</p>
  </dd>

</dl>
<p>The first two categories above comprise the <em>job environment table</em> which is applied to all jobs. Note that changing the job environment table will only affect newly-started jobs.</p></li>
</ul>
<h3>Services, tasks and respawning</h3>
<p>Jobs are <em>services</em> by default.  This means that the act of starting the job is considered to be finished when the job is running, and that even exiting with a zero exit status means the service will be respawned.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>task</strong></p>
  </dt>
  <dd>
    <p>This stanza may be used to specify that the job is a <em>task</em> instead.  This means that the act of starting the job is not considered to be finished until the job itself has been run and stopped again, but that exiting with a zero exit status means the task has completed successfully and will not be respawned.</p>
  </dd>

</dl>
<p>The <a href="../man8/start.8.html"><strong>start</strong>(8)</a> command, and any <a href="../man7/starting.7.html"><strong>starting</strong>(7)</a> or <a href="../man7/stopping.7.html"><strong>stopping</strong>(7)</a> events will block only until a service is running or until a task has finished.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>respawn</strong></p>
  </dt>
  <dd>
    <p>A service or task with this stanza will be automatically started if it should stop abnormally.  All reasons for a service stopping, except the <a href="../man8/stop.8.html"><strong>stop</strong>(8)</a> command itself, are considered abnormal.  Tasks may exit with a zero exit status to prevent being respawned.</p>
  </dd>
  <dt>
    <p><strong>respawn limit </strong><em>COUNT INTERVAL</em></p>
  </dt>
  <dd>
    <p>Respawning is subject to a limit, if the job is respawned more than <em>COUNT</em> times in <em>INTERVAL</em> seconds, it will be considered to be having deeper problems and will be stopped. Default COUNT is 10. Default INTERVAL is 5 seconds.</p><p>This only applies to automatic respawns and not the <a href="../man8/restart.8.html"><strong>restart</strong>(8)</a> command.</p>
  </dd>
  <dt>
    <p><strong>normal exit </strong><em>STATUS</em>|<em>SIGNAL</em>...</p>
  </dt>
  <dd>
    <p>Additional exit statuses or even signals may be added, if the job process terminates with any of these it will not be considered to have failed and will not be respawned.</p>
<pre>
normal exit 0 1 TERM HUP
</pre>

  </dd>

</dl>

<h3>Instances</h3>
<p>By default, only one instance of any job is permitted to exist at one time.  Attempting to start a job when it's already starting or running results in an error. Note that a job is considered to be running if its pre-start process is running.</p><p>Multiple instances may be permitted by defining the names of those instances.  If an instance with the same name is not already starting or running, a new instance will be started instead of returning an error.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>instance </strong><em>NAME</em></p>
  </dt>
  <dd>
    <p>This stanza defines the names of instances, on its own its not particularly useful since it would just define the name of the single permitted instance, however <em>NAME</em> expands any variable defined in the job's environment.</p><p>These will often be variables that you need to pass to the process anyway, so are an excellent way to limit the instances.</p>
<pre>
instance $CONFFILE
exec /sbin/httpd -c $CONFFILE
</pre>

<pre>
instance $TTY
exec /sbin/getty -8 38300 $TTY
</pre>
<p>These jobs appear in the <a href="../man8/initctl.8.html"><strong>initctl</strong>(8)</a> output with the instance name in parentheses, and have the <strong>INSTANCE</strong> environment variable set in their events.</p>
  </dd>

</dl>

<h3>Documentation</h3>
<p>Upstart provides several stanzas useful for documentation and external tools.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>description </strong><em>DESCRIPTION</em></p>
  </dt>
  <dd>
    <p>This stanza may contain a description of the job.</p>
<pre>
description "This does neat stuff"
</pre>

  </dd>
  <dt>
    <p><strong>author </strong><em>AUTHOR</em></p>
  </dt>
  <dd>
    <p>This stanza may contain the author of the job, often used as a contact for bug reports.</p>
<pre>
author "Scott James Remnant &lt;scott@netsplit.com&gt;"
</pre>

  </dd>
  <dt>
    <p><strong>version </strong><em>VERSION</em></p>
  </dt>
  <dd>
    <p>This stanza may contain version information about the job, such as revision control or package version number.  It is not used or interpreted by <a href="../man8/init.8.html"><strong>init</strong>(8)</a> in any way.</p>
<pre>
version "$Id$"
</pre>

  </dd>
  <dt>
    <p><strong>emits </strong><em>EVENT</em>...</p>
  </dt>
  <dd>
    <p>All processes on the system are free to emit their own events by using the <a href="../man8/initctl.8.html"><strong>initctl</strong>(8)</a> tool, or by communicating directly with the <a href="../man8/init.8.html"><strong>init</strong>(8)</a> daemon.</p><p>This stanza allows a job to document in its job configuration what events it emits itself, and may be useful for graphing possible transitions.</p><p>The <a href="../man8/initctl.8.html"><strong>initctl</strong>(8)</a> <strong>check-config</strong> command attempts to use this stanza to resolve events.</p><p><em>EVENT</em> can be either a literal string or a string including shell wildcard meta-characters (asterisk (&apos;*&apos;), question mark (&apos;?&apos;), and square brackets (&apos;[&apos; and &apos;]&apos;)). Meta-characters are useful to allow <a href="../man8/initctl.8.html"><strong>initctl</strong>(8)</a> <strong>check-config</strong> to resolve a class of events, such as those emitted by <a href="../man8/upstart-udev-bridge.8.html"><strong>upstart-udev-bridge</strong>(8)</a><strong></strong>.</p>
  </dd>
  <dt>
    <p><strong>usage </strong><em>USAGE</em></p>
  </dt>
  <dd>
    <p>This stanza may contain the text used by <a href="../man8/initctl.8.html"><strong>initctl</strong>(8)</a> <strong>usage</strong> command. This text may be also shown when commands <a href="../man8/start.8.html"><strong>start</strong>(8)</a>, <a href="../man8/stop.8.html"><strong>stop</strong>(8)</a> or <a href="../man8/status.8.html"><strong>status</strong>(8)</a> fail.</p>
<pre>
usage "tty DEV=ttyX - where X is console id"
</pre>

  </dd>

</dl>

<h3>Process environment</h3>
<p>Many common adjustments to the process environment, such as resource limits, may be configured directly in the job rather than having to handle them yourself.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>console </strong><strong>none</strong>|<strong>log</strong>|<strong>output</strong>|<strong>owner</strong></p>
  </dt>
  <dd>
    <p><strong>none</strong></p><p>If <strong>none</strong> is specified, the jobs standard input, standard output and standard error file descriptors are connected to <em>/dev/null</em>. Any output generated by a job will be discarded. This used to be the default prior to the introduction of <strong>log</strong> in Upstart 1.4.</p><p><strong>log</strong></p><p><strong></strong> If <strong>log</strong> is specified, standard input is connected to <em>/dev/null</em>, and standard output and standard error are connected to a pseudo-tty which logs all job output.</p><p>Output is logged to file <em>/var/log/upstart/&lt;job-log-file&gt;</em> or <em>$XDG_CACHE_HOME/upstart/&lt;job-log-file&gt;</em> for system and user session jobs respectively.</p><p>If a job has specified <strong>instance</strong>, <em>&lt;job-log-file&gt;</em> will equate to <em>&lt;job&gt;-&lt;instance&gt;.log</em> where &apos;&lt;instance&gt;&apos; is replaced by the specific instance value and &apos;&lt;job&gt;&apos; is replaced with the job name (job configuration file name, without the extension).  If <strong>instance</strong> is not specified, <em>&lt;job-log-file&gt;</em> will be <em>&lt;job&gt;.log</em> where &apos;&lt;job&gt;&apos; is replaced with the job name.</p><p>Jobs started from within a chroot will have their output logged to such a path within the chroot.</p><p>If log files already exist, they are appended to.</p><p>All slash (&apos;/&apos;) characters in <em>&lt;job-log-file&gt;</em> are replaced with underscore (&apos;_&apos;) characters. For example, any output from the &apos;wibble&apos; instance of the &apos;foo/bar&apos; job would be encoded in file &apos;foo_bar-wibble.log&apos; in the log file directory. This gives the log file directory a flat structure.</p><p>If the directory for system jobs does not exist, job output for each job will be cached until the job finishes. Thus, the boot process <strong>must</strong> ensure that the directory is available as soon as possible since any job that finishes before a writeable disk is available will not be able to take advantage of this facility.</p><p>If it is not possible to write to any log file due to lack of disk space, the job will be considered to have specified a <strong>console</strong> value of <strong>none</strong> and all subsequent job output will be discarded.</p><p>If the logger detects that the file it is about to write to was deleted, it will re-open the file first.</p><p>Care should be taken if the log directory is a mount point since any job that starts before that mount is available and which produces output will then attempt to write logs to the mount point, not to the mounted directory. This may give the impression that log data has not been recorded. A strategy to handle this situation is to ensure the mount point directory is not writeable such that logs will only be written when the mount has succeeded (assuming the mount itself is writeable and has sufficient space).</p><p>Note that since <strong>log</strong> utilizes pseudo-ttys, your kernel must support these. If it does not, the console value will be modified automatically to <strong>none</strong>. Further, note that it may be necessary to increase the number of available pty devices; see <a href="../man7/pty.7.html"><strong>pty</strong>(7)</a> for details.</p><p>Under Linux, full Unix 98 pty support requires that the <em>devpts</em> filesystem be mounted.</p><p>If pty setup fails for any reason, an error message will be displayed and the job's console value will be reset to <strong>none</strong>.</p><p><strong>output</strong></p><p>If <strong>output</strong> is specified, the standard input, standard output and standard error file descriptors are connected to <em>/dev/console</em>.</p><p><strong>owner</strong></p><p>The <strong>owner</strong> value is special: it not only connects the job to the system console but sets the job to be the owner of the system console, which means it will receive certain signals from the kernel when special key combinations such as Control-C are pressed.</p>
  </dd>
  <dt>
    <p><strong>umask </strong><em>UMASK</em></p>
  </dt>
  <dd>
    <p>A common configuration is to set the file mode creation mask for the process. <em>UMASK</em> should be an octal value for the mask, see <a href="../man2/umask.2.html"><strong>umask</strong>(2)</a> for more details.</p>
  </dd>
  <dt>
    <p><strong>nice </strong><em>NICE</em></p>
  </dt>
  <dd>
    <p>Another common configuration is to adjust the process's nice value, see <a href="../man1/nice.1.html"><strong>nice</strong>(1)</a> for more details.</p>
  </dd>
  <dt>
    <p><strong>oom score </strong><em>ADJUSTMENT</em>|<strong>never</strong></p>
  </dt>
  <dd>
    <p>Normally the OOM killer regards all processes equally, this stanza advises the kernel to treat this job differently.</p><p><em>ADJUSTMENT</em> may be an integer value from <em>-999</em> (very unlikely to be killed by the OOM killer) up to <em>1000</em> (very likely to be killed by the OOM killer).  It may also be the special value <strong>never</strong> to have the job ignored by the OOM killer entirely.</p>
  </dd>
  <dt>
    <p><strong>chroot </strong><em>DIR</em></p>
  </dt>
  <dd>
    <p>Runs the job's processes in a <a href="../man8/chroot.8.html"><strong>chroot</strong>(8)</a></strong> environment underneath <em>DIR</em></p><p>Note that <em>DIR</em> must have all the necessary system libraries for the process to be run, often including <em>/bin/sh</em></p>
  </dd>
  <dt>
    <p><strong>chdir </strong><em>DIR</em></p>
  </dt>
  <dd>
    <p>Runs the job's processes with a working directory of <em>DIR</em> instead of the root of the filesystem.</p>
  </dd>
  <dt>
    <p><strong>limit </strong><em>LIMIT SOFT</em>|<strong>unlimited </strong><em>HARD</em>|<strong>unlimited</strong></p>
  </dt>
  <dd>
    <p>Sets initial system resource limits for the job's processes. <em>LIMIT</em> may be one of <em>core</em>, <em>cpu</em>, <em>data</em>, <em>fsize</em>, <em>memlock</em>, <em>msgqueue</em>, <em>nice</em>, <em>nofile</em>, <em>nproc</em>, <em>rss</em>, <em>rtprio</em>, <em>sigpending</em> or <em>stack</em>.</p><p>Limits are specified as both a <em>SOFT</em> value and a <em>HARD</em> value, both of which are integers.  The special value <strong>unlimited</strong> may be specified for either.</p>
  </dd>
  <dt>
    <p><strong>setuid </strong><em>USERNAME</em></p>
  </dt>
  <dd>
    <p>Changes to the user <em>USERNAME</em> before running any job process.</p><p>If this stanza is unspecified, all job processes will run as root in the case of system jobs, and as the user in the case of user jobs.</p><p>Note that system jobs using the <strong>setuid</strong> stanza are still system jobs, and can not be controlled by an unprivileged user, even if the <strong>setuid</strong> stanza specifies that user.</p>
  </dd>
  <dt>
    <p><strong>setgid </strong><em>GROUPNAME</em></p>
  </dt>
  <dd>
    <p>Changes to the group <em>GROUPNAME</em> before running any job process.</p><p>If this stanza is unspecified, the primary group of the user specified in the <strong>setuid</strong> block is used for all job processes. If both stanzas are unspecified, all job processes will run with its group ID set to 0 in the case of system jobs, and as the primary group of the user in the case of User Session jobs.</p>
  </dd>

</dl>

<h3>Override File Handling</h3>
<p>Override files allow a jobs environment to be changed without modifying the jobs configuration file. Rules governing override files:</p>
<dl class='dl-vertical'>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>If a job is embodied with only a configuration file, the contents of this file define the job.</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>If an override files exists where there is no existing cofiguration file, the override file is ignored.</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>If both a configuration file <strong>and</strong> an override file exist for a job and both files are syntactically correct:</p>
<dl class='dl-vertical'>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>stanzas in the override file will take precedence over stanzas present in the corresponding configuration file.</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>stanzas in the override file which are not present in the corresponding configuration file will be honoured when the job runs.</p>
  </dd>

</dl>

  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>If both a configuration file and an override file exist for a job and subsequently the override file is deleted, the configuration file is automatically reloaded with the effect that any changes introduced by the override file are undone and the configuration file alone now defines the job.</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>If both a configuration file and an override file exist for a job and subsequently the configuration file is deleted, a new instance of the job can no longer be started (since without a corresponding configuration file an override file is ignored).</p>
  </dd>
  <dt>
    \[bu]
  </dt>
  <dd>
    <p>If both a configuration file and an override file exist for a job and any of the contents of the override file are invalid, the override file is ignored and only the contents of the configuration file are considered.</p>
  </dd>

</dl>

<h3>AppArmor support</h3>
<p>Upstart provides several stanzas for loading and switching to different AppArmor profiles. If AppArmor isn't enabled in the currently running kernel, the stanzas will be silently ignored.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>apparmor load </strong><em>PROFILE</em></p>
  </dt>
  <dd>
    <p>This stanza specifies an AppArmor profile to load into the Linux kernel at job start. The AppArmor profile will confine a main process automatically using path attachment, or manually by using the <strong>apparmor switch</strong> stanza. <em>PROFILE</em> must be an absolute path to a profile and a failure will occur if the file doesn't exist.</p>
<pre>
apparmor load /etc/apparmor.d/usr.sbin.cupsd
</pre>

  </dd>
  <dt>
    <p><strong>apparmor switch </strong><em>NAME</em></p>
  </dt>
  <dd>
    <p>This stanza specifies the name of an AppArmor profile name to switch to before running the main process. <em>NAME</em> must be the name of a profile already loaded into the running Linux kernel, and will result in a failure if not available.</p>
<pre>
apparmor switch /usr/sbin/cupsd
</pre>

  </dd>

</dl>

<h3>Miscellaneous</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>kill signal </strong><em>SIGNAL</em></p>
  </dt>
  <dd>
    <p>Specifies the stopping signal, <em>SIGTERM</em> by default, a job's main process will receive when stopping the running job.</p>
<pre>
kill signal INT
</pre>

  </dd>
  <dt>
    <p><strong>reload signal </strong><em>SIGNAL</em></p>
  </dt>
  <dd>
    <p>Specifies the reload signal, <em>SIGHUP</em> by default, a job's main process will receive when reloading the running job.</p>
<pre>
reload signal USR1
</pre>

  </dd>
  <dt>
    <p><strong>kill timeout </strong><em>INTERVAL</em></p>
  </dt>
  <dd>
    <p>Specifies the interval between sending the job's main process the "stopping" (see above) and <em>SIGKILL</em> signals when stopping the running job. Default is 5 seconds.</p>
  </dd>
  <dt>
    <p><strong>expect stop</strong></p>
  </dt>
  <dd>
    <p>Specifies that the job's main process will raise the <em>SIGSTOP</em> signal to indicate that it is ready. <a href="../man8/init.8.html"><strong>init</strong>(8)</a> will wait for this signal before running the job's post-start script, or considering the job to be running.</p><p><a href="../man8/init.8.html"><strong>init</strong>(8)</a> will send the process the <em>SIGCONT</em> signal to allow it to continue.</p>
  </dd>
  <dt>
    <p><strong>expect daemon</strong></p>
  </dt>
  <dd>
    <p>Specifies that the job's main process is a daemon, and will fork twice after being run. <a href="../man8/init.8.html"><strong>init</strong>(8)</a> will follow this daemonisation, and will wait for this to occur before running the job's post-start script or considering the job to be running.</p><p>Without this stanza <a href="../man8/init.8.html"><strong>init</strong>(8)</a> is unable to supervise daemon processes and will believe them to have stopped as soon as they daemonise on startup.</p>
  </dd>
  <dt>
    <p><strong>expect fork</strong></p>
  </dt>
  <dd>
    <p>Specifies that the job's main process will fork once after being run. <a href="../man8/init.8.html"><strong>init</strong>(8)</a> will follow this fork, and will wait for this to occur before running the job's post-start script or considering the job to be running.</p><p>Without this stanza <a href="../man8/init.8.html"><strong>init</strong>(8)</a> is unable to supervise forking processes and will believe them to have stopped as soon as they fork on startup.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RESTRICTIONS</h2>
        <div class="sectioncontent">
<p>The use of symbolic links in job configuration file directories is not supported since it can lead to unpredicable behaviour resulting from broken or inaccessible links (such as would be caused by a link crossing a filesystem boundary to a filesystem that has not yet been mounted).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>The <strong>and</strong> and <strong>or</strong> operators allowed with <strong>start on</strong> and <strong>stop on</strong> do not work intuitively: operands to the right of either operator are only evaluated once and state information is then discarded. This can lead to jobs with complex <strong>start on</strong> or <strong>stop on</strong> conditions not behaving as expected <em>when restarted</em>. For example, if a job encodes the following condition:</p>
<pre>
start on A and (B or C)
</pre>
<p>When &apos;A&apos; and &apos;B&apos; become true, the condition is satisfied so the job will be run. However, if the job ends and subsequently &apos;A&apos; and &apos;C&apos; become true, the job will <em>not</em> be re-run even though the condtion is satisfied.  Avoid using complex conditions with jobs which need to be restarted.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>/etc/init/*.conf</em></p>
  </dt>
  <dd>
    <p>System job configuration files.</p>
  </dd>
  <dt>
    <p><em>/etc/init/*.override</em></p>
  </dt>
  <dd>
    <p>System job override files.</p>
  </dd>
  <dt>
    <p><em>$HOME/.init/*.conf</em></p>
  </dt>
  <dd>
    <p>User job configuration files <strong>(deprecated)</strong>.</p>
  </dd>
  <dt>
    <p><em>$HOME/.init/*.override</em></p>
  </dt>
  <dd>
    <p>User job override files. <strong>(deprecated)</strong>.</p>
  </dd>
  <dt>
    <p><em>$XDG_CONFIG_HOME/upstart/*.conf</em></p>
  </dt>
  <dd>
    <p>User session job configuration files. See <strong>User Session Mode</strong> for other locations.</p>
  </dd>
  <dt>
    <p><em>$XDG_CONFIG_HOME/upstart/*.override</em></p>
  </dt>
  <dd>
    <p>User session job override files. See <strong>User Session Mode</strong> for other locations.</p>
  </dd>
  <dt>
    <p><em>/var/log/upstart/*.log</em></p>
  </dt>
  <dd>
    <p>Default location of system job output logs.</p>
  </dd>
  <dt>
    <p><em>$XDG_CACHE_HOME/upstart/*.log</em></p>
  </dt>
  <dd>
    <p>Default location of user session job output logs.</p>
  </dd>
  <dt>
    <p><em>$XDG_RUNTIME_DIR/upstart/sessions/*.session</em></p>
  </dt>
  <dd>
    <p>Location of session files created when running in User Session mode.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Manual page written by Scott James Remnant &lt;<strong>scott@netsplit.com</strong>&gt; and James Hunt &lt;<strong>james.hunt@canonical.com</strong>&gt;<strong>.</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">REPORTING BUGS</h2>
        <div class="sectioncontent">
<p>Report bugs at &lt;<strong>https://launchpad.net/upstart/+bugs</strong>&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2009-2013 Canonical Ltd.</p><p>This is free software; see the source for copying conditions.  There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO init&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/init.8.html"><strong>init</strong>(8)</a> <a href="../man8/initctl.8.html"><strong>initctl</strong>(8)</a> <a href="../man2/prctl.2.html"><strong>prctl</strong>(2)</a> <a href="../man7/pty.7.html"><strong>pty</strong>(7)</a> <strong>sh</strong>(1) <strong>upstart-events</strong>(7) <strong>apparmor</strong>(7)</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="info.5.html"><span aria-hidden="true">&larr;</span> info.5: Readable online documentation</a></li>
   <li class="next"><a href="init-d-script.5.html">init-d-script.5: Interpreter for short and simple init.d scripts. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
