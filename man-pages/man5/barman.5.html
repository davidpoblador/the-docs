<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>barman: Backup and recovery manager for postgresql</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Backup and recovery manager for postgresql">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="barman (5) manual">
  <meta name="twitter:description" content="Backup and recovery manager for postgresql">
  <meta name="twitter:image" content="https://www.carta.tech/images/barman-barman-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/barman.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="barman (5) manual" />
  <meta property="og:description" content="Backup and recovery manager for postgresql" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/barman-barman-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">barman<small> (5)</small></h1>
        <p class="lead">Backup and recovery manager for postgresql</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/barman.5.html">
      <span itemprop="name">barman: Backup and recovery manager for postgresql</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/barman/">
      <span itemprop="name">barman</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/barman.5.html">
      <span itemprop="name">barman: Backup and recovery manager for postgresql</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION FILE LOCATIONS</h2>
        <div class="sectioncontent">
<p>The system-level Barman configuration file is located at</p>
<pre>
/etc/barman.conf
</pre>
<p>or</p>
<pre>
/etc/barman/barman.conf
</pre>
<p>and is overridden on a per-user level by</p>
<pre>
$HOME/.barman.conf
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION FILE SYNTAX</h2>
        <div class="sectioncontent">
<p>The Barman configuration file is a plain ini file. There is a general section called [barman] and a section [servername] for each server you want to backup. Rows starting with ; are comments.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION FILE DIRECTORY</h2>
        <div class="sectioncontent">
<p>Barman supports the inclusion of multiple configuration files, through the configuration_files_directory option. Included files must contain only server specifications, not global configurations. If the value of configuration_files_directory is a directory, Barman reads all files with .conf extension that exist in that folder. For example, if you set it to /etc/barman.d, you can specify your PostgreSQL servers placing each section in a separate .conf file inside the /etc/barman.d folder.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p><strong>active</strong></p><p>Ignored. Server.</p><p><strong>description</strong></p><p>A human readable description of a server. Server.</p><p><strong>ssh_command</strong></p><p>Command used by Barman to login to the Postgres server via ssh. Server.</p><p><strong>conninfo</strong></p><p>Connection string used by Barman to connect to the Postgres server. Server.</p><p><strong>basebackups_directory</strong></p><p>Directory where base backups will be placed. Global/Server.</p><p><strong>wals_directory</strong></p><p>Directory which contains WAL files. Global/Server.</p><p><strong>incoming_wals_directory</strong></p><p>Directory where incoming WAL files are archived into. Global/Server.</p><p><strong>lock_file</strong></p><p>Lock file for a backup in progress. Global/Server.</p><p><strong>log_file</strong></p><p>Location of Barman\(cqs log file. Global.</p><p><strong>log_level</strong></p><p>Level of logging (DEBUG, INFO, WARNING, ERROR, CRITICAL). Global.</p><p><strong>custom_compression_filter</strong></p><p>Compression algorithm applied to WAL files. Global/Server.</p><p><strong>custom_decompression_filter</strong></p><p>Decompression algorithm applied to compressed WAL files; this must match the compression algorithm. Global/Server.</p><p><strong>pre_backup_script</strong></p><p>Hook script launched before a base backup. Global/Server.</p><p><strong>post_backup_script</strong></p><p>Hook script launched after a base backup. Global/Server.</p><p><strong>pre_archive_script</strong></p><p>Hook script launched before a base backup. Global/Server.</p><p><strong>post_archive_script</strong></p><p>Hook script launched after a base backup. Global/Server.</p><p><strong>minimum_redundancy</strong></p><p>Minimum number of backups to be retained. Default 0. Global/Server.</p><p><strong>retention_policy</strong></p><p>Policy for retention of periodical backups and archive logs. If left empty, retention policies are not enforced. For redundancy based retention policy use "REDUNDANCY i" (where i is an integer &gt; 0 and defines the number of backups to retain). For recovery window retention policy use "RECOVERY WINDOW OF i DAYS" or "RECOVERY WINDOW OF i WEEKS" or "RECOVERY WINDOW OF i MONTHS" where i is a positive integer representing, specifically, the number of days, weeks or months to retain your backups. For more detailed information, refer to the official documentation. Default value is empty. Global/Server.</p><p><strong>wal_retention_policy</strong></p><p>Policy for retention of archive logs (WAL files). Currently only "MAIN" is available. Global/Server.</p><p><strong>retention_policy_mode</strong></p><p>Currently only "auto" is implemented. Global/Server.</p><p><strong>bandwidth_limit</strong></p><p>This option allows you to specify a maximum transfer rate in kilobytes per second. A value of zero specifies no limit (default). Global/Server.</p><p><strong>tablespace_bandwidth_limit</strong></p><p>This option allows you to specify a maximum transfer rate in kilobytes per second, by specifying a comma separated list of tablespaces (pairs TBNAME:BWLIMIT). A value of zero specifies no limit (default). Global/Server.</p><p><strong>immediate_checkpoint</strong></p><p>This option allows you to control the way PostgreSQL handles checkpoint at the start of the backup. If set to false (default), Postgres will wait for a checkpoint to happen before allowing the start of the backup. If set to true, an immediate checkpoint is requested. Global/Server.</p><p><strong>network_compression</strong></p><p>This option allows you to enable data compression for network transfers. If set to false (default), no compression is used. If set to true, compression is enabled, reducing network usage. Global/Server.</p><p><strong>backup_options</strong></p><p>This option allows you to enable to control the way PostgreSQL handles backups: If set to exclusive_backup (default), barman backup executes backup operations using the standard exclusive backup approach (technically through pg_start_backup/pg_stop_backup). If set to concurrent_backup, Barman requires the pgespresso module to be installed on the PostgreSQL server (this allows to perform backup from a standby server). Global/Server.</p><p><strong>last_backup_maximum_age</strong></p><p>This option identifies a time frame that must contain the latest backup. If the latest backup is older than the time frame, barman check command will report an error to the user. If empty (default), latest backup is always considered valid. Syntax for this option is: "i (DAYS | WEEKS | MONTHS)" where i is a integer greater than zero, representing the number of days | weeks | months of the time frame. Global/Server.</p><p><strong>basebackup_retry_times</strong></p><p>Number of retries of data copy during base backup after an error. Positive integer, default 0. Global/Server.</p><p><strong>basebackup_retry_sleep</strong></p><p>Number of seconds of wait after a failed copy, before retrying Positive integer, default 30. Global/Server.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HOOK SCRIPTS</h2>
        <div class="sectioncontent">
<p>The script definition is passed to a shell and can return any exit code.</p><p>The shell environment will contain the following variables:</p><p>BARMAN_CONFIGURATION</p><p>configuration file used by barman</p><p>BARMAN_ERROR</p><p>error message, if any (only for the <em>post</em> phase)</p><p>BARMAN_PHASE</p><p><em>pre</em> or <em>post</em></p><p>BARMAN_SERVER</p><p>name of the server</p><p>Backup scripts specific variables:</p><p>BARMAN_BACKUP_DIR</p><p>backup destination directory</p><p>BARMAN_BACKUP_ID</p><p>ID of the backup</p><p>BARMAN_PREVIOUS_ID</p><p>ID of the previous backup (if present)</p><p>BARMAN_STATUS</p><p>status of the backup</p><p>BARMAN_VERSION</p><p>version of Barman</p><p>Archive scripts specific variables:</p><p>BARMAN_SEGMENT</p><p>name of the WAL file</p><p>BARMAN_FILE</p><p>full path of the WAL file</p><p>BARMAN_SIZE</p><p>size of the WAL file</p><p>BARMAN_TIMESTAMP</p><p>WAL file timestamp</p><p>BARMAN_COMPRESSION</p><p>type of compression used for the WAL file</p><p>No check is performed on the exit code of the script. The result will be simply written in the log file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>Example of the configuration file:</p>
<pre>
[barman]
; Main directory
barman_home = /var/lib/barman

; System user
barman_user = barman

; Log location
log_file = /var/log/barman/barman.log

; Default compression level
;compression = gzip

; &apos;main&apos; PostgreSQL Server configuration
[main]
; Human readable description
description =  "Main PostgreSQL Database"

; SSH options
ssh_command = ssh postgres@pg

; PostgreSQL connection string
conninfo = host=pg user=postgres

; Minimum number of required backups (redundancy)
minimum_redundancy = 1

; Retention policy (based on redundancy)
retention_policy = REDUNDANCY 2
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>In alphabetical order:</p><p>Gabriele Bartolini &lt;gabriele.bartolini@2ndquadrant.it&gt; (core team, project leader)</p><p>Giuseppe Broccolo &lt;giuseppe.broccolo@2ndquadrant.it&gt; (core team, QA/testing)</p><p>Giulio Calacoci &lt;giulio.calacoci@2ndquadrant.it&gt; (core team, developer)</p><p>Francesco Canovai &lt;francesco.canovai@2ndquadrant.it&gt; (core team, QA/testing)</p><p>Marco Nenciarini &lt;marco.nenciarini@2ndquadrant.it&gt; (core team, team leader)</p><p>Past contributors:</p><p>Carlo Ascani</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RESOURCES</h2>
        <div class="sectioncontent">
<p>Homepage: http://www.pgbarman.org/</p><p>Documentation: http://docs.pgbarman.org/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYING</h2>
        <div class="sectioncontent">
<p>Barman is the exclusive property of 2ndQuadrant Italia and its code is distributed under GNU General Public License v3.</p><p>Copyright &copy; 2011-2014 2ndQuadrant Italia (Devise.IT S.r.l.) - http://www.2ndQuadrant.it/.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="bandwidthd-pgsql-bandwidthd.conf.5.html"><span aria-hidden="true">&larr;</span> bandwidthd.conf.5: Configuration file for bandwidthd</a></li>
   <li class="next"><a href="bbackupd.conf.5.html">bbackupd.conf.5: Box backup client daemon configuration file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
