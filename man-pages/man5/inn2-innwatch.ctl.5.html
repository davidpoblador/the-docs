<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>innwatch.ctl: Control usenet supervision by innwatch</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Control usenet supervision by innwatch">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="innwatch.ctl (5) manual">
  <meta name="twitter:description" content="Control usenet supervision by innwatch">
  <meta name="twitter:image" content="https://www.carta.tech/images/inn2-innwatch.ctl-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/inn2-innwatch.ctl.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="innwatch.ctl (5) manual" />
  <meta property="og:description" content="Control usenet supervision by innwatch" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/inn2-innwatch.ctl-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">innwatch.ctl<small> (5)</small></h1>
        <p class="lead">Control usenet supervision by innwatch</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/innwatch.ctl.5.html">
      <span itemprop="name">innwatch.ctl: Control usenet supervision by innwatch</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/inn2/">
      <span itemprop="name">inn2</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/innwatch.ctl.5.html">
      <span itemprop="name">innwatch.ctl: Control usenet supervision by innwatch</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The file <em>&lt;pathetc in inn.conf&gt;/innwatch.ctl</em> is used to determine what actions are taken during the periodic supervisions by <em>innwatch</em>.</p><p>The file consists of a series of lines; blank lines and lines beginning with a number sign (``#'') are ignored. All other lines consist of seven fields, each preceded by a delimiting character, for example:</p>
<pre>
:label:state:condition:test:limit:command:reason
</pre>
<p>or</p><p>@label@state@condition@test@limit@command@reason</p><p>The delimiter can be any one of several non-alphanumeric characters that does not appear elsewhere in the line; there is no way to quote it to include it in any of the fields. Any of ``!'', ``,'', ``:'', ``@'', ``;'', or ``?'' is a good choice. Each line can have a different delimiter; the first character on each line is the delimiter for that line. White space surrounding delimiters, except before the first, is ignored, and does not form part of the fields; white space within fields is permitted. All delimiters must be present.</p><p>The first field is a label for this control line. It is used as an internal state indicator and in <em>ctlinnd</em> messages to control the server. If this field is empty, the line number is used.</p><p>The second field specifies when this control line should be used. It consists of a list of labels and special indicators, separated by whitespace. If the current state matches against any of the labels in this field, this line will be used as described below. The values that may be used are:</p>
<dl class='dl-vertical'>
  <dt>
    -
  </dt>
  <dd>
    <p>This line matches if the current state is the same as the label on this line, or if the current state is ``run'', the initial state. This is also the default state if this field is empty.</p>
  </dd>
  <dt>
    +
  </dt>
  <dd>
    <p>This line matches if the current state is ``run''.</p>
  </dd>
  <dt>
    *
  </dt>
  <dd>
    <p>This line always matches.</p>
  </dd>
  <dt>
    label
  </dt>
  <dd>
    <p>This line matches if the current state is the specified ``label''.</p>
  </dd>
  <dt>
    -label
  </dt>
  <dd>
    <p>This line matches if the current state is not the specified ``label''.</p>
  </dd>

</dl>
<p>The third field specifies a shell command that is invoked if this line matches. Do not use any shell filename expansion characters such as ``*'', ``?'', or ``['' (even quoted, they're not likely to work as intended). If the command succeeds, as indicated by its exit status, it is expected to have printed a single integer to standard output. This gives the value of this control line, to be used below. If the command fails, the line is ignored. The command is executed with its current directory set to the news spool articles directory, <em>&lt;patharticles</em>in<em>inn.conf&gt;</em>.</p><p>The fourth field specifies the operator to use to test the value returned above. It should be one of the two letter numeric test operators defined in <a href="../man1/test.1.html"><strong>test</strong>(1)</a> such as ``eq'', ``lt'' and the like. The leading dash (``-'') should not be included.</p><p>The fifth field specifies a constant with which to compare the value using the operator just defined. This is done by invoking the command:</p><p>test value -operator constant</p><p>The line is said to ``succeed'' if it returns true.</p><p>The sixth field specifies what should be done if the line succeeds, and in some cases if it fails. Any of the following words may be used:</p>
<dl class='dl-vertical'>
  <dt>
    throttle
  </dt>
  <dd>
    <p>Causes <em>innwatch</em> to throttle the server if this line succeeds. It also sets the state to the value of the line's label. If the line fails, and the state was previously equal to the label on this line (that is, this line had previously succeeded), then a <em>go</em> command will be sent to the server, and <em>innwatch</em> will return to the ``run'' state. The ``throttle'' is only performed if the current state is ``run'' or a state other than the label of this line, regardless of whether the command succeeds.</p>
  </dd>
  <dt>
    pause
  </dt>
  <dd>
    <p>Is identical to ``throttle'' except that the server is paused.</p>
  </dd>
  <dt>
    shutdown
  </dt>
  <dd>
    <p>Sends a ``shutdown'' command to the server. It is for emergency use only.</p>
  </dd>
  <dt>
    flush
  </dt>
  <dd>
    <p>Sends a ``flush'' command to the server.</p>
  </dd>
  <dt>
    go
  </dt>
  <dd>
    <p>Causes <em>innwatch</em> to send a ``go'' command to the server and to set the state to ``run''.</p>
  </dd>
  <dt>
    exit
  </dt>
  <dd>
    <p>Causes <em>innwatch</em> to exit.</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    skip
  </dt>
  <dd>
    <p>The remainder of the control file is skipped for the current pass.</p>
  </dd>

</dl>
<p>The last field specifies the reason that is used in those <em>ctlinnd</em> commands that require one. More strictly, it is part of the reason &ndash; <em>innwatch</em> appends some information to it. In order to enable other sites to recognize the state of the local <em>innd</em> server, this field should usually be set to one of several standard values. Use ``No&nbsp;space'' if the server is rejecting articles because of a lack of filesystem resources. Use ``loadav'' if the server is rejecting articles because of a lack of CPU resources.</p><p>Once <em>innwatch</em> has taken some action as a consequence of its control line, it skips the rest of the control file for this pass. If the action was to restart the server (that is, issue a ``go'' command), then the next pass will commence almost immediately, so that <em>innwatch</em> can discover any other condition that may mean that the server should be suspended again.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">

<pre>
@@@inndf .@lt@10000@throttle@No space
@@@inndf -i .@lt@1000@throttle@No space (inodes)
</pre>
<p>The first line causes the server to be throttled if the free space drops below 10000 units (using whatever units <strong>inndf</strong>(8) uses), and restarted again when free space increases above the threshold.</p><p>The second line does the same for inodes.</p><p>The next three lines act as a group and should appear in the following order. It is easier to explain them, however, if they are described from the last up.</p>
<pre>
!load!load hiload!loadavg!lt!5!go!
:hiload:+ load:loadavg:gt:8:throttle:loadav
/load/+/loadavg/ge/6/pause/loadav
</pre>
<p>The final line causes the server to be paused if <em>innwatch</em> is in the ``run'' state and the load average rises to, or above, six. The state is set to ``load'' when this happens. The previous line causes the server to be throttled when <em>innwatch</em> is in the ``run'' or ``load'' state, and the load average rises above eight. The state is set to ``hiload'' when this happens. Note that <em>innwatch</em> can switch the server from ``paused'' to ``throttled'' if the load average rises from below six to between six and seven, and then to above eight. The first line causes the server to be sent a ``go'' command if <em>innwatch</em> is in the ``load'' or ``hiload'' state, and the load average drops below five.</p><p>Note that all three lines assume a mythical command <em>loadavg</em> that is assumed to print the current load average as an integer. In more practical circumstances, a pipe of <em>uptime</em> into <em>awk</em> is more likely to be useful.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>This file must be tailored for each individual site, the sample supplied is truly no more than a sample. The file should be ordered so that the more common problems are tested first.</p><p>The ``run'' state is not actually identified by the label with that three letter name, and using it will not work as expected.</p><p>Using an ``unusual'' character for the delimiter such as ``('', ``*'', ``&'', ``\(ga'', ``\(aa'', and the like, is likely to lead to obscure and hard to locate bugs.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">
<p>Written by &lt;kre@munnari.oz.au&gt; for InterNetNews. This is revision &#92;$3, dated &#92;$4.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO innwatch.ctl&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/inn.conf.5.html"><strong>inn.conf</strong>(5)</a>, <a href="../man8/innd.8.html"><strong>innd</strong>(8)</a>, <strong>inndf</strong>(8), <a href="../man8/ctlinnd.8.html"><strong>ctlinnd</strong>(8)</a>, <a href="../man8/news.daily.8.html"><strong>news.daily</strong>(8)</a>.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="inn-innwatch.ctl.5.html"><span aria-hidden="true">&larr;</span> innwatch.ctl.5: Control usenet supervision by innwatch</a></li>
   <li class="next"><a href="input.5.html">input.5: Input data file format <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
