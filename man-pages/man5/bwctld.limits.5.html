<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>bwctld.limits: Bandwidth control daemon policy configuration file</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Bandwidth control daemon policy configuration file">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="bwctld.limits (5) manual">
  <meta name="twitter:description" content="Bandwidth control daemon policy configuration file">
  <meta name="twitter:image" content="https://www.carta.tech/images/bwctl-server-bwctld.limits-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/bwctld.limits.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="bwctld.limits (5) manual" />
  <meta property="og:description" content="Bandwidth control daemon policy configuration file" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/bwctl-server-bwctld.limits-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">bwctld.limits<small> (5)</small></h1>
        <p class="lead">Bandwidth control daemon policy configuration file</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/bwctld.limits.5.html">
      <span itemprop="name">bwctld.limits: Bandwidth control daemon policy configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/bwctl-server/">
      <span itemprop="name">bwctl-server</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/bwctld.limits.5.html">
      <span itemprop="name">bwctld.limits: Bandwidth control daemon policy configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <strong>bwctld.limits</strong> file is used to define the policy configuration for the <strong>bwctld</strong> program. It allows the system administrator to allocate the resources in a variety of ways.</p><p>There are two parts to the policy configuration:</p>
<dl class='dl-vertical'>
  <dt>
    <p>Authentication</p>
  </dt>
  <dd>
    <p>Who is making the request? This can be very specific to an individual user or it can be more general in that the connection is coming from some particular network.</p>
  </dd>
  <dt>
    <p>Authorization</p>
  </dt>
  <dd>
    <p>Now that the connection has been generally identified, what will <strong>bwctld</strong> allow it to do?</p>
  </dd>

</dl>
<p>The authentication is done by assigning a <em>userclass</em> to each new connection as it comes in. Each <em>userclass</em> has a set of limits associated with it. The <em>userclass</em>es are hierarchical, so a connection must pass the limit restrictions of the given <em>userclass</em> as well as all parent classes.</p><p>Within the <strong>bwcltd.limits</strong> file, <em>assign</em> lines are used to assign a <em>userclass</em> to a given connection. <em>limit</em> lines are used to define a <em>userclass</em> and set the limits associated with that <em>userclass</em>. The file is read sequentially, and it is not permitted to use a <em>classname</em> before it is defined using a limit line.</p><p>The format of this file is:</p><ul>
<li><p>Comment lines are any line where the first non-whitespace character is '#'. These lines are counted to return line numbers in error messages but are otherwise ignored by <strong>bwctld</strong>.</p></li><li><p>Lines may be continued using the semi-standard '&#92;' character followed immediately by a newline. This is the only valid place for the '&#92;' character. If it is found elsewhere a syntax error is reported.</p></li><li><p>Blank lines are treated as comment lines.</p></li><li><p>All other lines must conform to the syntax of a <em>limit</em> line or an <em>assign</em> line.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>limit</em></p>
  </dt>
  <dd>
    <p>This directive is used to define the <em>userclass</em> hierarchy. It defines the <em>classname</em> as well as the limits associated with that class. A <em>classname</em> may only be defined once. The format of the <em>limit</em> directive is:</p>
  </dd>

</dl>
<p>limit <em>classname</em> with <em>limtype</em>=<em>value</em>[,<em>limtype</em>=<em>value</em>]*</p><p><em>classname</em> defines the name of the class with the given limits. Whitespace is used as a separator but is otherwise ignored. <em>classname</em> may be used as a directory name component within <strong>bwctld</strong>, so take care not to use characters that would be invalid. (i.e. '*' or '/' would be particularly bad.)</p><p><em>limtype</em> and <em>value</em> indicate the particular type of limit and value to apply to this <em>userclass</em>. The available settings for <em>limtype</em> are:</p><table class="table table-striped">
<tr>
<th></th>
<th></th>
<th></th>
<th></th></tr>

<tr>
<td>limtype</td>
<td>valid values</td>
<td>default</td>
<td></td></tr>

<tr>
<td>allow_open_mode</td>
<td>on/off</td>
<td>on</td>
<td></td></tr>

<tr>
<td>allow_tcp</td>
<td>on/off</td>
<td>on</td>
<td></td></tr>

<tr>
<td>allow_udp</td>
<td>on/off</td>
<td>off</td>
<td></td></tr>

<tr>
<td>bandwidth</td>
<td>integer (b/s)</td>
<td>0 (unlimited)</td>
<td></td></tr>

<tr>
<td>duration</td>
<td>integer (seconds)</td>
<td>0 (unlimited)</td>
<td></td></tr>

<tr>
<td>event_horizon</td>
<td>integer (seconds)</td>
<td>0 (unlimited)</td>
<td></td></tr>

<tr>
<td>max_time_error</td>
<td>integer (seconds)</td>
<td>0 (unlimited)</td>
<td></td></tr>

<tr>
<td>parent</td>
<td>previously defined <em>classname</em></td>
<td>null</td>
<td></td></tr>

<tr>
<td>pending</td>
<td>integer</td>
<td>0 (unlimited)</td>
<td></td></tr>
</table>
<dl class='dl-vertical'>
  <dt>
    <p><em>allow_open_mode</em></p>
  </dt>
  <dd>
    <p>This limit is only useful if the class is assigned to a netmask. It is used to limit specific IP/netmask identities to only encrypted or authenticated mode transactions or to allow open mode.</p>
  </dd>
  <dt>
    <p><em>allow_tcp</em></p>
  </dt>
  <dd>
    <p>Allow TCP <strong>Iperf</strong> tests for <em>userclass</em>.</p>
  </dd>
  <dt>
    <p><em>allow_udp</em></p>
  </dt>
  <dd>
    <p>Allow UDP <strong>Iperf</strong> tests for <em>userclass</em>.</p>
  </dd>
  <dt>
    <p><em>bandwidth</em></p>
  </dt>
  <dd>
    <p>Maximum amount of bandwidth to allow <em>userclass</em> to use in a UDP <strong>Iperf</strong> test.  0 indicates unlimited by policy, but remember this is checked all the way to the root of the hierarchy. (If you want an unlimited <em>userclass</em>, your root must be unlimited, and the whole path down to the given <em>userclass</em>.)</p>
  </dd>
  <dt>
    <p><em>duration</em></p>
  </dt>
  <dd>
    <p>Maximum duration of a single <strong>Iperf</strong> test for this <em>userclass</em>.</p>
  </dd>
  <dt>
    <p><em>event_horizon</em></p>
  </dt>
  <dd>
    <p>Maximum window into the future to look when trying to schedule a test for this <em>userclass</em>.</p>
  </dd>
  <dt>
    <p><em>max_time_error</em></p>
  </dt>
  <dd>
    <p>Maximum amount of time error to allow for tests in this class. The time error is the sum of the errors reported by NTP on the two involved systems. The larger the time error, the larger the duration of the reservation because the time error is used to ensure tests don't overlap. There is a limit on this to defend against DOS attacks where a client could report large errors to ensure other clients can not allocate test reservations.</p>
  </dd>
  <dt>
    <p><em>parent</em></p>
  </dt>
  <dd>
    <p>The first <em>limit</em> line cannot have a parent since none have been defined yet. As such, the first line defines the root of your class hierarchy. All remaining limit lines <strong>MUST</strong> assign a parent. (It is hierarchical, after all.)</p>
  </dd>
  <dt>
    <p><em>pending</em></p>
  </dt>
  <dd>
    <p>Maximum number of <em>pending</em> reservations for this <em>userclass</em>.</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    <p><em>assign</em></p>
  </dt>
  <dd>
    <p>The <em>assign</em> directive is used to assign a <em>userclass</em> to a given connection. Basically, it authenticates the connection. The format of the <em>assign</em> directive is:</p>
  </dd>

</dl>
<p>assign <em>authtype</em> [<em>args</em>] <em>classname</em></p><p><em>authtype</em> identifies the type of authentication being used. Whitespace is used as a separator but is otherwise ignored. <em>classname</em> must have been previously defined with the <em>limit</em> directive earlier in the file.</p><p>The available settings for <em>authtype</em> are:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>default</strong></p>
  </dt>
  <dd>
    <p>Used if no other assignment matches. It takes no <em>args</em>.</p>
  </dd>
  <dt>
    <p><strong>net</strong><em> subnet</em></p>
  </dt>
  <dd>
    <p>Assign a specific <em>subnet</em> to a given <em>userclass</em>. <em>subnet</em> must be specified using VLSM notation (IP/nbits). The only <em>arg</em> is the <em>subnet</em>. For example:</p>
<dl class='dl-vertical'>
  <dt>
    <p>127.0.0.1/32</p>
  </dt>
  <dd>
    <p>would match only the loopback IPv4 address.</p>
  </dd>
  <dt>
    <p>::1/128</p>
  </dt>
  <dd>
    <p>would match only the loopback IPv6 address.</p>
  </dd>
  <dt>
    <p>192.168.1.0/24</p>
  </dt>
  <dd>
    <p>would match all hosts on the 192.168.1.XXX network.</p>
  </dd>

</dl>
<p>There must be no set bits in the non-masked portion of the address part of the <em>subnet</em> specification. i.e., 192.168.1.1/24 would be an invalid <em>subnet</em> due to the bit set in the fourth octet.</p>
  </dd>
  <dt>
    <p><strong>user</strong><em> user</em></p>
  </dt>
  <dd>
    <p>Assign a specific <em>user</em> to a given <em>userclass</em>. The <em>user</em> must be defined in the <strong>bwctld.keys</strong> file.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHENTICATION PROCESS</h2>
        <div class="sectioncontent">
<p><strong>bwctld</strong> determines if it should allow a connection from the client based upon the authentication mode of the request and the source IP address of the connection. If the client connection is in authenticated or encrypted mode, the daemon does not do any filtering based upon the source address of the connection. (See the <strong>-A</strong> option to <strong>bwctl</strong> and the <em>authmode</em> option in <strong>bwctld.conf</strong>.) In these modes, <strong>bwctld</strong> simply uses the <em>identity</em> of the connection to determine the <em>userclass</em> limits. If the connection is made in open mode,  then <strong>bwctld</strong> first uses the source address to determine if <strong>bwctld</strong> should allow an open mode connection from that subnet at all. (This is the purpose of the <em>allow_open_mode limtype</em> described above.) If open mode is allowed from this subnet, then the <em>userclass</em> is determined by the closest subnet match defined by the <em>assign net</em> lines in the <strong>bwctld.limits</strong> file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>An initial <em>limit</em> line might look like:</p><p>limit root with &#92;</p><p>bandwidth=900m, &#92;</p><p>duration=0, &#92;</p><p>allow_udp=on, &#92;</p><p>allow_tcp=on, &#92;</p><p>allow_open_mode=off</p><p>This would create a <em>userclass</em> named <strong>root</strong>. Because no <em>parent</em> is specified, this must be the first <em>userclass</em> defined in the file. This <em>userclass</em> has very liberal limits (UDP enabled with 900m limit). However, open mode authentication is not enabled for this <em>userclass</em>, so the connections that get these limits must successfully authenticate using an AES key.</p><p>If an administrator also wants to create a <em>userclass</em> that is used to deny all requests, they might add:</p><p>limit jail with &#92;</p><p>parent=root, &#92;</p><p>allow_udp=off, &#92;</p><p>allow_tcp=off, &#92;</p><p>allow_open_mode=off</p><p>This would create a <em>userclass</em> named <strong>jail</strong>. Because UDP and TCP tests have both been denied, no tests will be allowed. Also, <em>allow_open_mode</em> is off, so initial connections that are not in authenticated or encrypted mode would be dropped immediately anyway. (It would not make much sense to assign a <em>user</em> identity to this <em>userclass</em>. If you don't want connections from a particular <em>user</em>, the best thing to do is to remove that <em>user</em> from the <strong>bwctld.keys</strong> file.</p><p>If the administrator wanted to allow a limited amount of open tests, they could define a <em>userclass</em> like:</p><p>limit open with &#92;</p><p>parent=root, &#92;</p><p>allow_open_mode=on, &#92;</p><p>allow_udp=off, &#92;</p><p>allow_tcp=on, &#92;</p><p>duration=30, &#92;</p><p>event_horizon=300, &#92;</p><p>pending=5</p><p>This could be used to allow TCP throughput tests by random connections. It limits those tests to 30 seconds in duration, and only allows them to be scheduled within the next 5 minutes (<em>event_horizon</em>=300). Additionally, it only allows this <em>userclass</em> to have 5 currently <em>pending</em> reservations. This ensures that this <em>userclass</em> can only schedule 50% of the next 5 minutes. The advantage of this kind of setup is that the administrator can define other <em>userclasses</em> with a larger <em>event_horizon</em> allowing then to have priority over this class. (Suggestions for other methods of priority scheduling should be sent to bwctl-users@internet2.edu.)</p><p>Now, these three <em>userclasses</em> might be assigned to specific connections in the following ways:</p><p># default open</p><p>assign default <strong>open</strong></p><p># badguys subnet</p><p>assign net 192.168.1.0/24 <strong>jail</strong></p><p># network admins</p><p>assign user joe <strong>root</strong></p><p>assign user jim <strong>root</strong></p><p>assign user bob <strong>root</strong></p><p>This set of <em>assign</em> lines specifically denies access from any open mode connection from the <strong>badguys</strong> subnet. It specifically allows access to authenticated or encrypted mode transactions that can authenticate as the <em>identities</em> <strong>joe jim</strong> or <strong>bob</strong> (even from the <strong>badguys</strong> subnet). All other connections would match the <em>assign default</em> rule and get the limits associated with the <strong>open</strong> <em>userclass</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO bwctld.limits&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/bwctl.1.html"><strong>bwctl</strong>(1)</a>, <a href="../man8/bwctld.8.html"><strong>bwctld</strong>(8)</a>, <a href="../man5/bwctld.limits.5.html"><strong>bwctld.limits</strong>(5)</a>, <a href="../man5/bwctld.keys.5.html"><strong>bwctld.keys</strong>(5)</a>, and the http://e2epi.internet2.edu/bwctl/ web site.</p><p>For details on <strong>Iperf</strong>, see the http://sourceforge.net/projects/iperf web site.</p><p>For details on <strong>Nuttcp</strong>, see the http://www.wcisd.hpc.mil/nuttcp/Nuttcp-HOWTO.html web site.</p><p>For details on <strong>Thrulay</strong>, see the http://e2epi.internet2.edu/thrulay/ web site.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ACKNOWLEDGMENTS</h2>
        <div class="sectioncontent">
<p>This material is based in part on work supported by the National Science Foundation (NSF) under Grant No. ANI-0314723. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the NSF.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="bwctld.keys.5.html"><span aria-hidden="true">&larr;</span> bwctld.keys.5: Bandwidth control daemon aes keyfile database</a></li>
   <li class="next"><a href="bwctlrc.5.html">bwctlrc.5: Bandwidth control configuration file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
