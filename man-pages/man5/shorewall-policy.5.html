<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>shorewall-policy: Shorewall policy file</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Shorewall policy file">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="shorewall-policy (5) manual">
  <meta name="twitter:description" content="Shorewall policy file">
  <meta name="twitter:image" content="https://www.carta.tech/images/shorewall-shorewall-policy-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/shorewall-policy.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="shorewall-policy (5) manual" />
  <meta property="og:description" content="Shorewall policy file" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/shorewall-shorewall-policy-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">shorewall-policy<small> (5)</small></h1>
        <p class="lead">Shorewall policy file</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/shorewall-policy.5.html">
      <span itemprop="name">shorewall-policy: Shorewall policy file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/shorewall/">
      <span itemprop="name">shorewall</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/shorewall-policy.5.html">
      <span itemprop="name">shorewall-policy: Shorewall policy file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>/etc/shorewall/policy</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This file defines the high-level policy for connections between zones defined in \m[blue]<strong>shorewall-zones</strong>\m[]\s-2\u[1]\d\s+2(5).</p><p><strong>Important</strong></p><p>The order of entries in this file is important</p><p>This file determines what to do with a new connection request if we don&apos;t get a match from the /etc/shorewall/rules file . For each source/destination pair, the file is processed in order until a match is found ("all" will match any client or server).</p><p><strong>Important</strong></p><p>Intra-zone policies are pre-defined</p><p>For $FW and for all of the zones defined in /etc/shorewall/zones, the POLICY for connections from the zone to itself is ACCEPT (with no logging or TCP connection rate limiting) but may be overridden by an entry in this file. The overriding entry must be explicit (specifying the zone name in both SOURCE and DEST) or it must use "all+" (Shorewall 4.5.17 or later).</p><p>Similarly, if you have IMPLICIT_CONTINUE=Yes in shorewall.conf, then the implicit policy to/from any sub-zone is CONTINUE. These implicit CONTINUE policies may also be overridden by an explicit entry in this file.</p><p>The columns in the file are as follows (where the column name is followed by a different name in parentheses, the different name is used in the alternate specification syntax).</p><p><strong>SOURCE</strong> - <em>zone</em>|<strong>$FW</strong>|<strong>all</strong>|<strong>all+</strong></p><p>Source zone. Must be the name of a zone defined in \m[blue]<strong>shorewall-zones</strong>\m[]\s-2\u[1]\d\s+2(5), $FW, "all" or "all+".</p><p>Support for "all+" was added in Shorewall 4.5.17. "all" does not override the implicit intra-zone ACCEPT policy while "all+" does.</p><p><strong>DEST</strong> - <em>zone</em>|<strong>$FW</strong>|<strong>all</strong>|<strong>all+</strong></p><p>Destination zone. Must be the name of a zone defined in \m[blue]<strong>shorewall-zones</strong>\m[]\s-2\u[1]\d\s+2(5), $FW, "all" or "all+". If the DEST is a bport zone, then the SOURCE must be "all", "all+", another bport zone associated with the same bridge, or it must be an ipv4 zone that is associated with only the same bridge.</p><p>Support for "all+" was added in Shorewall 4.5.17. "all" does not override the implicit intra-zone ACCEPT policy while "all+" does.</p><p><strong>POLICY</strong> - {<strong>ACCEPT</strong>|<strong>DROP</strong>|<strong>REJECT</strong>|<strong>CONTINUE</strong>|<strong>QUEUE</strong>|<strong>NFQUEUE</strong>[(<em>queuenumber</em>)]|<strong>NONE</strong>}[<strong>:</strong>{<em>default-action-or-macro</em>[:level]|<strong>None</strong>}]</p><p>Policy if no match from the rules file is found.</p><p>If the policy is neither CONTINUE nor NONE then the policy may be followed by ":" and one of the following:</p><p>The word "None" or "none". This causes any default action defined in \m[blue]<strong>shorewall.conf</strong>\m[]\s-2\u[2]\d\s+2(5) to be omitted for this policy.</p><p>The name of an action. The action will be invoked before the policy is enforced.</p><p>Actions can have parameters specified.</p><p>Beginning with Shorewall 4.5.10, the action name can be followed optionally by a colon and a log level. The level will be applied to each rule in the action or body that does not already have a log level.</p><p>Possible actions are:</p><p><strong>ACCEPT</strong></p><p>Accept the connection.</p><p><strong>DROP</strong></p><p>Ignore the connection request.</p><p><strong>REJECT</strong></p><p>For TCP, send RST. For all other, send an "unreachable" ICMP.</p><p><strong>QUEUE</strong></p><p>Queue the request for a user-space application such as Snort-inline.</p><p><strong>NFQUEUE</strong></p><p>Queue the request for a user-space application using the nfnetlink_queue mechanism. If a <em>queuenumber</em> is not given, queue zero (0) is assumed.</p><p><strong>CONTINUE</strong></p><p>Pass the connection request past any other rules that it might also match (where the source or destination zone in those rules is a superset of the SOURCE or DEST in this policy). See \m[blue]<strong>shorewall-nesting</strong>\m[]\s-2\u[3]\d\s+2(5) for additional information.</p><p><strong>NONE</strong></p><p>Assume that there will never be any packets from this SOURCE to this DEST. Shorewall will not create any infrastructure to handle such packets and you may not have any rules with this SOURCE and DEST in the /etc/shorewall/rules file. If such a packet <strong>is</strong> received, the result is undefined. NONE may not be used if the SOURCE or DEST columns contain the firewall zone ($FW) or "all".</p><p><strong>LOG LEVEL</strong> (loglevel) - [<em>log-level</em>|<strong>ULOG|NFLOG</strong>]</p><p>Optional - if supplied, each connection handled under the default POLICY is logged at that level. If not supplied, no log message is generated. See <strong>syslog.conf</strong>(5) for a description of log levels.</p><p>You may also specify ULOG or NFLOG (must be in upper case). This will log to the ULOG or NFLOG target and will send to a separate log through use of ulogd (\m[blue]<strong>http://www.netfilter.org/projects/ulogd/index.html</strong>\m[]).</p><p>For a description of log levels, see \m[blue]<strong>http://www.shorewall.net/shorewall_logging.html</strong>\m[]\s-2\u[4]\d\s+2.</p><p>If you don&apos;t want to log but need to specify the following column, place "-" here.</p><p><strong>BURST:LIMIT</strong> (limit) - [{<em>s</em>|<strong>d</strong>}:[[<em>name</em>]:]]]<em>rate</em><strong>/</strong>{<strong>second</strong>|<strong>minute</strong>}[:<em>burst</em>]</p><p>If passed, specifies the maximum TCP connection <em>rate</em> and the size of an acceptable <em>burst</em>. If not specified, TCP connections are not limited. If the <em>burst</em> parameter is omitted, a value of 5 is assumed.</p><p>When <strong>s:</strong> or <strong>d:</strong> is specified, the rate applies per source IP address or per destination IP address respectively. The <em>name</em> may be chosen by the user and specifies a hash table to be used to count matching connections. If not give, the name <strong>shorewall</strong> is assumed. Where more than one POLICY specifies the same name, the connections counts for the policies are aggregated and the individual rates apply to the aggregated count.</p><p><strong>CONNLIMIT</strong> - <em>limit</em>[:<em>mask</em>]</p><p>May be used to limit the number of simultaneous connections from each individual host to <em>limit</em> connections. While the limit is only checked on connections to which this policy could apply, the number of current connections is calculated over all current connections from the SOURCE host. By default, the limit is applied to each host individually but can be made to apply to networks of hosts by specifying a <em>mask</em>. The <em>mask</em> specifies the width of a VLSM mask to be applied to the source address; the number of current connections is then taken over all hosts in the subnet <em>source-address</em>/<em>mask</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>All connections from the local network to the internet are allowed</p><p>All connections from the internet are ignored but logged at syslog level KERNEL.INFO.</p><p>All other connection requests are rejected and logged at level KERNEL.INFO.</p>
<pre>
        #SOURCE         DEST            POLICY          LOG           BURST:LIMIT
        #                                               LEVEL
        loc             net             ACCEPT
        net             all             DROP            info
        #
        # THE FOLLOWING POLICY MUST BE LAST
        #
        all             all             REJECT          info
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/etc/shorewall/policy</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO shorewall-policy&hellip;</h2>
        <div class="sectioncontent">
<p>\m[blue]<strong>http://www.shorewall.net/configuration_file_basics.htm#Pairs</strong>\m[]\s-2\u[5]\d\s+2</p><p><strong>shorewall</strong>(8), <a href="../man5/shorewall-accounting.5.html"><strong>shorewall-accounting</strong>(5)</a>, <a href="../man5/shorewall-actions.5.html"><strong>shorewall-actions</strong>(5)</a>, <a href="../man5/shorewall-blacklist.5.html"><strong>shorewall-blacklist</strong>(5)</a>, <a href="../man5/shorewall-hosts.5.html"><strong>shorewall-hosts</strong>(5)</a>, <strong>shorewall_interfaces</strong>(5), <a href="../man5/shorewall-ipsets.5.html"><strong>shorewall-ipsets</strong>(5)</a>, <a href="../man5/shorewall-maclist.5.html"><strong>shorewall-maclist</strong>(5)</a>, <a href="../man5/shorewall-masq.5.html"><strong>shorewall-masq</strong>(5)</a>, <a href="../man5/shorewall-nat.5.html"><strong>shorewall-nat</strong>(5)</a>, <a href="../man5/shorewall-netmap.5.html"><strong>shorewall-netmap</strong>(5)</a>, <a href="../man5/shorewall-params.5.html"><strong>shorewall-params</strong>(5)</a>, <a href="../man5/shorewall-policy.5.html"><strong>shorewall-policy</strong>(5)</a>, <a href="../man5/shorewall-providers.5.html"><strong>shorewall-providers</strong>(5)</a>, <a href="../man5/shorewall-proxyarp.5.html"><strong>shorewall-proxyarp</strong>(5)</a>, <a href="../man5/shorewall-rtrules.5.html"><strong>shorewall-rtrules</strong>(5)</a>, <a href="../man5/shorewall-routestopped.5.html"><strong>shorewall-routestopped</strong>(5)</a>, <a href="../man5/shorewall-rules.5.html"><strong>shorewall-rules</strong>(5)</a>, <strong>shorewall.conf</strong>(5), <a href="../man5/shorewall-secmarks.5.html"><strong>shorewall-secmarks</strong>(5)</a>, <a href="../man5/shorewall-tcclasses.5.html"><strong>shorewall-tcclasses</strong>(5)</a>, <a href="../man5/shorewall-tcdevices.5.html"><strong>shorewall-tcdevices</strong>(5)</a>, <a href="../man5/shorewall-mangle.5.html"><strong>shorewall-mangle</strong>(5)</a>, <a href="../man5/shorewall-tos.5.html"><strong>shorewall-tos</strong>(5)</a>, <a href="../man5/shorewall-tunnels.5.html"><strong>shorewall-tunnels</strong>(5)</a>, <a href="../man5/shorewall-zones.5.html"><strong>shorewall-zones</strong>(5)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
     1.
  </dt>
  <dd>
    <p>shorewall-zones</p><p>http://www.shorewall.net/manpages/shorewall-zones.html</p>
  </dd>
  <dt>
     2.
  </dt>
  <dd>
    <p>shorewall.conf</p><p>http://www.shorewall.net/manpages/shorewall.conf.html</p>
  </dd>
  <dt>
     3.
  </dt>
  <dd>
    <p>shorewall-nesting</p><p>http://www.shorewall.net/manpages/shorewall-nesting.html</p>
  </dd>
  <dt>
     4.
  </dt>
  <dd>
    <p>http://www.shorewall.net/shorewall_logging.html</p><p>http://www.shorewall.net/shorewall_logging.html</p>
  </dd>
  <dt>
     5.
  </dt>
  <dd>
    <p>http://www.shorewall.net/configuration_file_basics.htm#Pairs</p><p>http://www.shorewall.net/configuration_file_basics.htm#Pairs</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="shorewall-params.5.html"><span aria-hidden="true">&larr;</span> shorewall-params.5: Shorewall parameters file</a></li>
   <li class="next"><a href="shorewall-providers.5.html">shorewall-providers.5: Shorewall providers file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
