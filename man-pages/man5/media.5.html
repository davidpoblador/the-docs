<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>media - userspace SELinux labeling interface and configuration file format for the media contexts backend .</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Userspace selinux labeling interface and configuration file format for the media contexts backend .">
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">media<small> (5)</small></h1>
        <p class="lead">Userspace selinux labeling interface and configuration file format for the media contexts backend .</p>
      </div>

    <ol class="breadcrumb">
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="/"><span itemprop="title">Carta.tech</span></a>
	</li>
	<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_section">
		<a itemprop="url" href="https://www.carta.tech/man-pages/"><span itemprop="title">man-pages</span></a>
	</li>
	<li id="breadcrumb_section" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb_page" itemprop="child">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man5/"><span itemprop="title">File formats and conventions</span></a>
	</li>
	<li id="breadcrumb_page" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="active">
		<a itemprop="url" href="https://www.carta.tech/man-pages/man5/media.5.html"><span itemprop="title">media</span></a>
	</li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<p><strong>#include &lt;selinux/label.h&gt;</strong></p>
<p class='spacer'>

<p><strong>int selabel_lookup(struct selabel_handle *</strong><em>hnd</em><strong>,</strong> <strong>char **</strong><em>context</em><strong>,</strong></p>
<p class='spacer'>

<p><strong>const char *</strong><em>device_name</em><strong>, int </strong><em>unused</em><strong>);</strong></p>
<p class='spacer'>

<p><strong>int selabel_lookup_raw(struct selabel_handle *</strong><em>hnd</em><strong>,</strong> <strong>char **</strong><em>context</em><strong>,</strong></p>
<p class='spacer'>

<p><strong>const char *</strong><em>device_name</em><strong>, int </strong><em>unused</em><strong>);</strong> .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">

<p>The media contexts backend maps from media device names such as "cdrom" or "floppy" into security contexts. It is used to find the appropriate context for establishing context mounts on these devices. The returned <em>context</em> must be freed using <a href="../man3/freecon.3.html"><strong>freecon</strong>(3)</a>.</p>
<p class='spacer'>

<p><a href="../man3/selabel_lookup.3.html"><strong>selabel_lookup</strong>(3)</a> describes the function with its return and error codes.</p>
<p class='spacer'>

<p>The integer lookup argument is currently unused and should be set to zero.</p>
<p class='spacer'>

<p>Any messages generated by <a href="../man3/selabel_lookup.3.html"><strong>selabel_lookup</strong>(3)</a> are sent to <em>stderr</em> by default, although this can be changed by <a href="../man3/selinux_set_callback.3.html"><strong>selinux_set_callback</strong>(3)</a>.</p>
<p class='spacer'>

<p><a href="../man3/selabel_lookup_raw.3.html"><strong>selabel_lookup_raw</strong>(3)</a> behaves identically to <a href="../man3/selabel_lookup.3.html"><strong>selabel_lookup</strong>(3)</a> but does not perform context translation.</p>
<p class='spacer'>

<p>The <strong>FILES</strong> section details the configuration files used to determine the media context. .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

  <p>In addition to the global options described in <a href="../man3/selabel_open.3.html"><strong>selabel_open</strong>(3)</a>, this backend recognizes the following options:</p>
  <dl class='dl-vertical'>
    <dt><strong>SELABEL_OPT_PATH</strong></dt>
    <dd>
  <p>A non-null value for this option specifies a path to a file that will be opened in lieu of the standard <em>media</em> contexts file. .</p>
    </dd>
  </dl>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<p>The media context file used to retrieve a default context depends on the <strong>SELABEL_OPT_PATH</strong> parameter passed to <strong>selabel_open\FR(3). If <em>NULL</em>, then the SELABEL_OPT_PATH</strong> value will default to the active policy media contexts location (as returned by <a href="../man3/selinux_media_context_path.3.html"><strong>selinux_media_context_path</strong>(3)</a>), otherwise the actual <strong>SELABEL_OPT_PATH</strong> value specified is used.</p>
<p class='spacer'>

<p>The default media contexts file is: <em>/etc/selinux/{SELINUXTYPE}/contexts/files/media</em></p>
<p class='spacer'>

<p>Where <em>{SELINUXTYPE}</em> is the entry from the selinux configuration file <em>config</em> (see <a href="../man5/selinux_config.5.html"><strong>selinux_config</strong>(5)</a>).</p>
<p class='spacer'>

<p>Should there not be a valid entry in the <em>media</em> file, then the default <em>removable_context</em> file will be read (see <a href="../man5/removable_context.5.html"><strong>removable_context</strong>(5)</a>). .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILE FORMAT</h2>
        <div class="sectioncontent">

<p>Each line within the <em>media</em> file is as follows: <em>device_name context</em></p>
<p class='spacer'>

<p>Where: <em>device_name</em> The media identifier (e.g. cdrom, floppy, disk and usb). <em>context</em> The context to be used for labeling the device.</p>
<p class='spacer'>

  <p>Example: # contexts/files/media</p>
<p class='spacer'>

  <p>cdrom system_u:object_r:removable_device_t</p>
<p class='spacer'>

  <p>floppy system_u:object_r:removable_device_t</p>
<p class='spacer'>

  <p>disk system_u:object_r:fixed_disk_device_t .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

  <p>If contexts are to be validated, then the global option <strong>SELABEL_OPT_VALIDATE</strong> must be set before calling <a href="../man3/selabel_open.3.html"><strong>selabel_open</strong>(3)</a>. If this is not set, then it is possible for an invalid context to be returned. .</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SEE ALSO</h2>
        <div class="sectioncontent">

  <p><a href="../man8/selinux.8.html"><strong>selinux</strong>(8)</a>, <a href="../man3/selabel_open.3.html"><strong>selabel_open</strong>(3)</a>, <a href="../man3/selabel_lookup.3.html"><strong>selabel_lookup</strong>(3)</a>, <a href="../man3/selabel_stats.3.html"><strong>selabel_stats</strong>(3)</a>, <a href="../man3/selabel_close.3.html"><strong>selabel_close</strong>(3)</a>, <a href="../man3/selinux_set_callback.3.html"><strong>selinux_set_callback</strong>(3)</a>, <a href="../man3/selinux_media_context_path.3.html"><strong>selinux_media_context_path</strong>(3)</a>, <a href="../man3/freecon.3.html"><strong>freecon</strong>(3)</a>, <a href="../man5/selinux_config.5.html"><strong>selinux_config</strong>(5)</a>, <a href="../man5/removable_context.5.html"><strong>removable_context</strong>(5)</a> </p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="mdadm.conf.5.html"><span aria-hidden="true">&larr;</span> mdadm.conf.5: configuration for management of Software RAID with mdadm</a></li>
   <li class="next"><a href="memcache_table.5.html">memcache_table.5: Postfix memcache client configuration <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
