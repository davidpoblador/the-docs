<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>dhcp_probe.cf: Configuration file for dhcp_probe</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Configuration file for dhcp_probe">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="dhcp_probe.cf (5) manual">
  <meta name="twitter:description" content="Configuration file for dhcp_probe">
  <meta name="twitter:image" content="https://www.carta.tech/images/dhcp-probe-dhcp_probe.cf-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/dhcp_probe.cf.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="dhcp_probe.cf (5) manual" />
  <meta property="og:description" content="Configuration file for dhcp_probe" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/dhcp-probe-dhcp_probe.cf-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">dhcp_probe.cf<small> (5)</small></h1>
        <p class="lead">Configuration file for dhcp_probe</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/dhcp_probe.cf.5.html">
      <span itemprop="name">dhcp_probe.cf: Configuration file for dhcp_probe</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/dhcp-probe/">
      <span itemprop="name">dhcp-probe</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/dhcp_probe.cf.5.html">
      <span itemprop="name">dhcp_probe.cf: Configuration file for dhcp_probe</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNPOSIS</h2>
        <div class="sectioncontent">
<p>/etc/dhcp_probe.cf</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The file <strong>/etc/dhcp_probe.cf</strong> contains configuration information used by the <a href="../man8/dhcp_probe.8.html"><strong>dhcp_probe</strong>(8)</a> daemon. dhcp_probe reads the file when it begins (and whenever it receives a SIGHUP signal).</p><p>The location of this file defaults to <strong>/etc/dhcp_probe.cf</strong>, but may be overridden by a command-line option to <a href="../man8/dhcp_probe.8.html"><strong>dhcp_probe</strong>(8)</a>.</p><p>The file consists of a series of statements, one per line. Each statement begins with a keyword followed by one or more arguments (depending on the keyword); keywords and arguments are separated by spaces or tabs. Statements may be specified in any order.</p><p>Some keywords take an <em>ethernet-address</em> argument. Ethernet address values must be written in a form that <a href="../man3/ether_aton.3.html"><strong>ether_aton</strong>(3)</a> recognizes; e.g. 1:2:3:4:5:6 or 00:A5:b2:0:BB:c.</p><p>Some keywords take an <em>ip-address</em> as a value. IP address values must be written in a form that <a href="../man3/inet_aton.3.html"><strong>inet_aton</strong>(3)</a> recognizes; e.g. 192.168.1.2.</p><p>Blank lines are ignored. Lines for which the first non-blank character is a '#' are treated as comments. Trailing comments on statements are <em>not</em> supported.</p><p>Because all presently-defined keywords are optional, the file may be empty, however, it must exist.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">KEYWORDS</h2>
        <div class="sectioncontent">
<p>The keywords are as follows:</p><h3>\fBchaddr\fP</h3>
<p>The <strong>chaddr</strong> statement is optional, and is used to specify the value of the <em>chaddr</em> field in the request packets sent by the program. This value is also used to compute the DHCP Client Identifier option in some of the request packets sent by the program (by prepending x'01').</p><p>Specify:</p><ul>
<li><p>chaddr <em>ethernet-address</em></p></li>
</ul><p>If not specified, this value defaults to the Ethernet address corresponding to the interface you specified on the commandline.</p><p>You might want to use the <strong>chaddr</strong> statement if the interface is also a DHCP client, so that sending requests with the interface's own chaddr/DHCP Client Identifier will not interfere with that functionality.</p><p>If you specify a value, be sure to specify a unicast Ethernet address that does not belong to any valid client on your network.</p><p>Correctly-functioning BootP and DHCP servers that respond will send any responses to the <em>chaddr</em> address, or in some cases, to the Ethernet broadcast address. Therefore, if you specify a value here (and it differs from your interface's Ethernet address), the program will have to place the interface into promiscuous mode to be sure it hears unicast responses.</p><p>Note that the <em>chaddr</em> value does not affect the Ethernet source address of the Ethernet frames sent by the program.</p><p>If you specify this value, you may also wish to specify the same value in the <strong>ether_src</strong> statement. See the description of that statement for further discussion.</p>
<h3>\fBether_src\fP</h3>
<p>The <strong>ether_src</strong> statement is optional, and is used to specify the value of the <em>ether_src</em> field in the Ethernet frames sent by the program.</p><p>Specify:</p><ul>
<li><p>ether_src <em>ethernet-address</em></p></li>
</ul><p>If not specified, this value defaults to the Ethernet address corresponding to the interface you specified on the commandline.</p><p>If you specify a value, be sure to specify a unicast Ethernet address that does not belong to any valid client on your network.</p><p>Note that this value does not affect the <em>chaddr</em> field or the DHCP Client Identifier option field in request packets sent by the program.</p><p>If you specified a <em>chaddr</em> value, you may also wish to specify an equal <em>ether_src</em> value. While not strictly necessary, doing so will cause any Layer 2 switches on the network to learn that this hardware address is on your leg of the network, so they will not need to flood response packets directed to that hardware address, but instead can direct the response packets only to your leg of the network.</p><p>Additionally, specifying the same <em>ether_src value</em> could help you discover any buggy BootP or DHCP servers that mistakenly direct their responses to the sender's ether_src (instead of to the sender's bootp_chaddr).</p>
<h3>\fBserver_id\fP</h3>
<p>The <strong>server_id</strong> statement is optional, and is used to specify the value of the DHCP Server Identifer option in some of the request packets sent by the program.</p><p>Specify:</p><ul>
<li><p>server_id <em>ip-address</em></p></li>
</ul><p>If not specified, this value defaults to 10.254.254.254.</p><p>The DHCP Server Identifer option appears in the packets the program sends when it mimics a DHCP client in the SELECTING state.</p><p>It's best that the DHCP Server Identifier option the program uses not match the IP address of any valid DHCP server on your network, to avoid confusing them. Other than that, any IP address is a reasonable value; you may wish to specify one that could never be a valid address on your network.</p>
<h3>\fBclient_ip_address\fP</h3>
<p>The <strong>client_ip_address</strong> statement is optional, and is used to specify the IP address that the program should request, or claim to have a lease on.</p><p>Specify:</p><ul>
<li><p>client_ip_address <em>ip-address</em></p></li>
</ul><p>If not specified, this value defaults to 172.31.254.254.</p><p>When the program generates a DHCPREQUEST packet that mimics a DHCP client that is in the INIT-REBOOT or SELECTING state, the packet contains a Requested IP Address option containing this value. When the program generates a DHCPREQUEST packet that mimics a DHCP client that is in the REBINDING state, the packet contains a <em>ciaddr</em> field containing this value.</p><p>It's best that the value the program uses not match the IP address of any valid DHCP client on your network, to avoid confusing valid DHCP servers.</p><p>It's extremely useful if the value the program uses <em>not</em> be valid (topologically speaking) for the physical network on which the program sends the packets. Sending a topologically inappropriate value may stimulate some DHCP servers to respond with a DHCPNAK, which helps the program flush out DHCP servers.</p>
<h3>\fBresponse_wait_time\fP</h3>
<p>The <strong>response_wait_time</strong> statement is optional, and is used to specify how long the program should wait for responses after sending a single request packet.</p><p>Specify</p><ul>
<li><p>response_wait_time <em>num_milliseconds</em></p></li>
</ul><p>If not specified, this value defaults to 5000 milliseconds (5 seconds).</p><p>The value is specified in milliseconds, and must fit into an 'int' on your host. (Values larger than an 'int' may be silently misinterpreted.) Typical values are on the order of a few thousand milliseconds; i.e. several seconds.</p>
<h3>\fBcycle_time\fP</h3>
<p>The <strong>cycle_time</strong> statement is optional, and is used to specify how long the program should sleep between each probe cycle.</p><p>Specify</p><ul>
<li><p>cycle_time <em>num_seconds</em></p></li>
</ul><p>If not specified, this value defaults to 300 seconds.</p><p>The value is specified in seconds, and must into into an 'unsigned int' on your host. (Values larger than an 'unsigned int' may be silently misinterpreted.) Typical valus range from several hundred to several thousand seconds (i.e. several minutes to several hours).</p><p>During each probe cycle, the program sends one of the request packet flavors, captures any responses that arrive during the <em>response_wait_time</em>, then repeats this for each of the other request packet flavors. After doing this for each flavor of request packet, the probe cycle is complete, and the program sleeps for the <em>cycle_time</em>.</p>
<h3>\fBlegal_server\fP</h3>
<p>The <strong>legal_server</strong> statement is optional, and is used to specify the IP source address of responses that come from a legal BootP or DHCP server on your network. The statement may be specified multiple times.</p><p>Specify</p><ul>
<li><p>legal_server <em>ip-address</em></p></li>
</ul><p>If not specified, the program assumes there are no legal BootP and DHCP servers on your network; all responses will be treated as coming from an unknown DHCP server.</p><p>When the program receives a response packet, it compares the packet's IP source address to all the addresses you have specified in <strong>legal_server</strong> statements. If the IP source address matches one of these values, the response is deemed to have come from a known DHCP server, and is ignored. If the IP source address does not match any of these values (or you do not specify any <strong>legal_server</strong>), then the program logs a message that reports the packet's IP source address and Ethernet source address. Additionally, if the program was started with the <strong>-o</strong> commandline option, the packet is also written to a packet capture file.</p><p>If both <strong>legal_server</strong> and <strong>legal_server_ethersrc</strong> statements appear, then a response must have both a valid IP source and a valid ethernet source to be considered to have come from a known DHCP server.</p><p>When relaying a response from a server to a client, some BootP Relay Agents may change the response's IP source address, replacing the server's IP address with that of the BootP Relay Agent. If BootP Relay Agents on your network do this, you will need to specify their IP addresses here instead.</p>
<h3>\fBlegal_server_ethersrc\fP</h3>
<p>The <strong>legal_server_ethersrc</strong> statement is optional, and is used to specify the Ethernet source address of responses that come from a legal BootP or DHCP server on your network. The statement may be specified multiple times.</p><p>Specify</p><ul>
<li><p>legal_server_ethersrc <em>ethernet-address</em></p></li>
</ul><p>If not specified, the program does not check the Ethernet source address of responses.</p><p>If you have specified at least one <strong>legal_server_ethersrc</strong> value, when the program receives a response packet, the program compares the packet's Ethernet source address to all the addresses you have specified in <strong>legal_server_ethersrc</strong> statements. If the Ethernet source does not match one of these values, the response is deemed to have come from an unknown DHCP server; the program logs a message that reports the packet's IP source address and Ethernet source address. Additionally, if the program was started with the <strong>-o</strong> commandline option, the packet is also written to a packet capture file.</p><p>If both <strong>legal_server</strong> and <strong>legal_server_ethersrc</strong> statements appear, then a response must have both a valid IP source and a valid ethernet source to be considered to have come from a known DHCP server.</p><p>Each router on the path from the DHCP server to the DHCP client will overwrite the Ethernet source address field. So if you specify any <strong>legal_server_ethersrc</strong> statements, also list the Ethernet source value(s) for the last hop router(s). A BootP Relay Agent on the path from the DHCP server to the DHCP client will overwrite the Ethernet field. So also list the Ethernet source value(s) for the BootP Relay Agent. (The BootP Relay Agent is often co-resident in the last-hop IP router, so you may have already taken care of this when you listed the last-hop router(s).</p><p>The <strong>legal_server_ethersrc</strong> statement is considered experimental in version 1.3.0, as it has received only limited testing.</p>
<h3>\fBlease_network_of_concern\fP</h3>
<p>The <strong>lease_network_of_concern</strong> statement is optional, and may be specified multiple times. The statement is used to specify one or more network ranges that are of concern relative to the IP addresses distributed by a rogue BootP/DHCP server.</p><p>Specify</p><ul>
<li><p>lease_network_of_concern <em>network-ip-address network-mask</em></p></li>
</ul><p>Specifying one or more <strong>lease_network_of_concern</strong> statements activates the "Lease Networks of Concern" feature.</p><p>When the program receives a response packet that it determines to be from a rogue BootP/DHCP server, if the "Lease Networks of Concern" feature is active, the program will examine the packet further. If the packet's <strong>yiaddr</strong> field is non-zero, the value in that field is tested to see if it falls within any of the "Leases Networks of Concern." If it does, then the message the program logs is extended to also report this fact, and to include the value of the <strong>yiaddr</strong> field. Furthermore, if an <strong>alert_program_name2</strong> was specified, when that program is called, it is called with an additional <strong>-y yiaddr</strong> option. (This is not supported if an <strong>alert_program_name</strong> was specified, as the older <strong>alert_program_name</strong> uses a syntax that cannot be extended.)</p><p>The "Lease Networks of Concern" feature does not change the way the program probes for or detects rogue BootP/DHCP servers. Upon detection of a rogue BootP/DHCP server, the feature only may cause additional information to be added to the message logged (and passed to <strong>alert_program_name2</strong>).</p><p>This feature may be used, for example, by specifying your networks' legitimate address ranges as "Lease Networks of Concern". While most rogue BootP/DHCP servers distribute private IP addresses, or send DHCPNAKs to legitimate clients, other more damaging rogue BootP/DHCP servers may distribute IP addresses that fall within your legitimate network ranges. This will help differentiate those more damaging incidents from the more common ones.</p>
<h3>\fBalert_program_name\fP</h3>
<p>The <strong>alert_program_name</strong> statement is optional, and may be used to specify the name of an external program that should be run every time a response packet is received from an unexpected server.</p><p>Note that using the newer <strong>alert_program_name2</strong> statement is preferrable.</p><p>Specify</p><ul>
<li><p>alert_program_name <em>/absolute/path/name</em></p></li>
</ul><p>Unexpected response packets are reported as a matter of course, and optionally written to a packet capture file. You may use an <strong>alert_program_name</strong> to provide additional handling of the event, for example, to alert an appropriate party via mail or paging. The <strong>alert_program_name</strong> you specify is called with four arguments in the following order: the name of the calling program (e.g. <strong>dhcp_probe</strong>), the name of the interface on which the unexpected response packet was received, the IP source address of the packet, and the Ethernet source address of the packet.</p><p>As the <strong>alert_program_name</strong> is called with the same privileges as <strong>dhcp_probe</strong> (i.e. root), you should exercise caution to ensure that the alert program is safe for a privileged user to execute.</p><p>Because the syntax supported by the external program is not extensible, the use of <strong>alert_program_name2</strong> is preferrable.</p><p>You may not specify both <strong>alert_program_name</strong> and <strong>alert_program_name2</strong>.</p>
<h3>\fBalert_program_name2\fP</h3>
<p>The <strong>alert_program_name2</strong> statement is optional, and may be used to specify the name of an external program that should be run every time a response packet is received from an unexpected server.</p><p>Specify</p><ul>
<li><p>alert_program_name2 <em>/absolute/path/name</em></p></li>
</ul><p>Unexpected response packets are reported as a matter of course, and optionally written to a packet capture file. You may use an <strong>alert_program_name2</strong> to provide additional handling of the event, for example, to alert an appropriate party via mail or paging. The <strong>alert_program_name2</strong> you specify is called with the following required options:</p>
<pre>
-p the name of the calling program (e.g. dhcp_probe),
-I the name of the interface on which the unexpected response packet was received
-i the IP source address of the packet
-m Ethernet source address of the packet
</pre>
<p>The following non-required options may also be passed:</p>
<pre>
-y the non-zero yiaddr value from the packet, when it falls inside a "Lease Network of Concern"
</pre>
<p>The <strong>alert_program_name2</strong> program you specify must ignore options or arguments it does not recognize; this is to ensure it remains forward-compatible with future enhancements to <strong>dhcp_probe</strong>. It must be prepared to accept options in any order.</p><p>As the <strong>alert_program_name2</strong> is called with the same privileges as <strong>dhcp_probe</strong> (i.e. root), you should exercise caution to ensure that the alert program is safe for a privileged user to execute.</p><p>You may not specify both <strong>alert_program_name</strong> and <strong>alert_program_name2</strong>.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>An example <strong>/etc/dhcp_probe.cf</strong> file follows:</p>
<pre>
# dhcp_probe.cf: config file for dhcp_probe
#
# General syntax:
#  Comment lines start with '#' (trailing comments not permitted).
#  Blank lines are OK.
#  Tokens within a line should be separated with spaces and/or tabs.
#  Entries in the file may be in any order.
#  Any 'ethernet-address' must be written in a form that <a href="../man3/ether_aton.3.html"><strong>ether_aton</strong>(3)</a> recognizes; e.g.
#      1:2:3:4:5:6   00:A5:b2:0:BB:c
#  Any 'ip-address' must be written in a form that <a href="../man3/inet_aton.3.html"><strong>inet_aton</strong>(3)</a> recognizes; e.g.
#      192.168.1.2
#
# ----------------------------------------------------------------------------------
#
# CLIENT HARDWARE ADDRESS
#
# By default, for the 'chaddr' field in the BootP header, we use the Ethernet
# address corresponding to the interface you specified.
# We also use this value to compute the DHCP Client Identifier option (by prepending x'01').
# You may optionally override this value.
# (Note that this does not override the Ethernet Src address in the Ethernet frame we send.)
#
# You might want to do this if our interface is also a DHCP client, so
# sending requests with the interface's own chaddr/DHCP Client Identifier would interfere with
# that functionality.
#
# If you specify a value, be sure to specify an Ethernet address that does not belong to
# any valid client on your network.  Be sure to specify a unicast Ethernet address.
#
# Syntax:
#    chaddr enet-addr

chaddr 0:0:0:1:2:3


# ----------------------------------------------------------------------------------
#
# ETHERNET SOURCE ADDRESS
#
# By default, for the 'ether_shost' field in the Ethernet header, we use the Ethernet
# address corresponding to the interface you specified.
# You may optionally override this value.
# (Note that this does not override the 'chaddr' in the BootP header, nor the DHCP Client Identifier.)
#
# If you are specify the 'chaddr' statement, you might want to also do this, so you don't miss buggy
# DHCP servers that respond (incorrectly) to ether_src instead of to chaddr.
#
# If you specify a value, be sure to specify an Ethernet address that does not belong to
# any valid client on your network.  Be sure to specify a unicast Ethernet address.
#
# Syntax:
#    ether_src enet-addr

ether_src 0:0:0:1:2:3


# ----------------------------------------------------------------------------------
#
# DHCP SERVER IDENTIFIER
#
# When we generate a DHCPREQUEST packet corresponding to a client that is in the SELECTING
# state, the options field must contain a 'DHCP Server Identifier' option, indicating the
# IP address of the DHCP server the client is selecting.   It's best that the value we use
# not match the IP address of any valid DHCP server, to avoid confusing them.  The program
# provides a default value of 10.254.254.254, which you may override here.
#
# Syntax:
#    server_id ip-addr

server_id 10.1.2.3

# ----------------------------------------------------------------------------------
#
# CLIENT IP ADDRESS
#
# When we generate a DHCPREQUEST packet corresponding to a client that is in the INIT-REBOOT
# or SELECTING state, the options field must containg a 'Requested IP Address' option, indicating
# the IP address the client is requesting.    When we generate a DHCPREQUEST packet corresponding
# to a client that is in the REBINDING state, the 'ciaddr' field in the BootP header must contain
# the IP address that the DHCP client presently has leased and wishes to renew.
#
# In all these cases, it's best that the value we use not match the IP address of any valid DHCP client,
# to avoid confusing the valid DHCP servers.
#
# Furthermore, it is extremely useful if the value we use *not* be valid (topologically speaking) for the
# physical network on which we send the packets.  Sending a topologically inappropriate value
# may stimulate some DHCP servers to respond with a DHCPNAK, which helps us flush out DHCP servers.
# (This will probably happen only in response to the packets we sending when pretending to be in REBINDING state.)
#
# The program provides a default value of 172.31.254.254, which you may override here.
#
# Syntax:
#   client_ip_address ip-addr

# client_ip_address 172.31.254.254

# ----------------------------------------------------------------------------------
#
# RESPONSE WAIT TIME
#
# After sending one packet, we wait for responses.  The length of time we wait
# is the 'response_wait_time'.  The program provides a default value of 5000, which you
# may override here.  The value is measured in milliseconds, and must fit into
# an 'int' on your host.  (Values larger than an 'int' may be silently misinterpreted.)
# Typical values are on the order of a few thousand milliseconds; i.e. several seconds.
#
# Syntax:
#    response_wait_time num_milliseconds

# response_wait_time 5000

# ----------------------------------------------------------------------------------
#
# CYCLE WAIT TIME
#
# For each flavor packet, we send the packet and listen for responses to that packet.
# After doing this for all flavor packets, we go to sleep for the "cycle_time",
# then repeat the process.  The program provides a default value of 300, which you
# may override here.  The value is measured in seconds, and must fit into an
# 'unsigned int' on your host.  (Values larger than an 'unsigned int' may be silently
# misinterpreted.)  Typical valus range from several hundred to several thousand
# seconds (i.e. several minutes to several hours).
#
# Syntax:
#    cycle_time num_seconds

cycle_time 1200

# ----------------------------------------------------------------------------------
#
# LEGAL SERVERS' IP SOURCE ADDRESSES
#
# After sending one packet, we wait for responses.  Responses from legal BootP or DHCP
# servers are ignored; presumably you aren't interesting in discovering them.
# Specify a legal server's IP source address with the 'legal_server' statement.
# The value you specify is compared to the IPsrc field in each response's IP header.
#
# If you have multiple legal servers, specify each in a separate statement.
# If your BootP Relay Agents overwrite the server's IP address in the IPsrc field
# with their own IP addresses, you will need to list the IP addresses of the
# BootP Relay Agents.
#
# Alternatively, do not specify any legal_server statements at all, so *no* responses
# will be considered legal.
# (This is different from the way legal_server_ethersrc statements are handled.)
#
# If both legal_server and legal_server_ethersrc statements appear, then a response
# must have both a valid IP source and a valid ethernet source to be considered legal.
#
# Syntax:
#   legal_server ip-addr

legal_server 192.168.1.2
legal_server 192.168.3.4

# ----------------------------------------------------------------------------------
#
# LEGAL SERVERS' ETHERNET SOURCE ADDRESSES
#
# Specify a legal server's Ethernet source address with the 'legal_server_ethersrc' statement.
# The value you specify is compared to the ethernet_src field in each response's IP header.
#
# If you have multiple legal ethernet sources, specify each in a separate statement.
# Each router on the path from the DHCP server to the DHCP client will overwrite
# the ethernet_src field.  So also list the ethernet_src value(s) for the last hop router(s).
# The BootP Relay Agent on the path from the DHCP server to the DHCP client will overwrite
# the ethernet_src field.  So also list the ethernet_src value(s) for the BootP Relay Agent.
# (This is often co-resident in the last-hop IP router, so you may have already taken care
# of this when you listed the last-hop router(s).
#
# Alternatively, do not specify any legal_server_ethersrc statements at all.
# If none are specified, then all ethernet_src values are considered legal.
# (This is different from the way legal_server statements are handled.)
#
# If both legal_server and legal_server_ethersrc statements appear, then a response
# must have both a valid IP source and a valid ethernet source to be considered legal.
#
# Syntax:
#   legal_server_ethersrc enet-addr

# legal_server_ethersrc 0:2:4:ab:cd:ef
# legal_server_ethersrc 0:17:30:1:0A:3

# ----------------------------------------------------------------------------------
#
# ALERT PROGRAM NAME
#
# In addition to logging a response received from an unexpected server, we will optionally
# call a user-specified 'alert program' if one is specified here.  To use this feature,
# specify the absolute pathname of a program we should execute for each unexpected response.
# Either specify it using the older 'alert_program_name' statement, or (preferrably) using
# the newer 'alert_program_name2' statement.  (The newer statement is preferrable because
# it calls the alert program with a more extensible syntax.)  You may not specify
# both alert_program_name and alert_program_name2.
#
# Old style alert program:
#
# Syntax:
#   alert_program_name /absolute/path/name
#
# The program specified via 'alert_program_name' will be called as follows:
#   /absolute/path/name  name_of_calling_program  name_of_interface_on_which_the_response_was_received  IP_source_of_the_response  ether_src_of_the_response
#
#
# Newer style alert program:
#
# Syntax:
#   alert_program_name2 /absolute/path/name
#
# The program specified via 'alert_program_name2' will be called as follows:
#   /absolute/path/name  -p name_of_calling_program  -I name_of_interface_on_which_the_response_was_received  -i IP_source_of_the_response  -m ether_src_of_the_response [-y yiaddr_when_in_lease_networks_of_concern]
# The options may appear in any order.
# The program must silently ignore any options or arguments it does not recognize,
# so as to be forward-compatible with future enhancements to dhcp_probe.


alert_program_name2 /usr/local/etc/dhcp_probe_notify2


# ----------------------------------------------------------------------------------
#
# LEASE NETWORKS OF CONCERN
#
# Optionally define one or more network ranges that are to be treated as
# being of special concern when a rogue BootP/DHCP server is detected sending response
# that contains a 'yiaddr' value that falls into any of these ranges.
# Specify each such network ranges of concern in a separate statement.
# When the yiaddr value in a rogue server's response falls into any of these ranges,
# the message logged will contain additional text remarking on this fact.
# And if an alert_program_name2 is used, that alert program
# will be called with an extra option so it can also act on that fact.
#
# If you specify all your networks' legitimate IP ranges, this can help you
# take additional notice of rogue BootP/DHCP servers that distribute *your*
# network addresess, rather than simply distribute private IP address or
# send DHCPNAKs to legitimate clients.
#
# Syntax:
#    lease_network_of_concern  IP-network-address network-mask


lease_network_of_concern 128.112.0.0 255.255.0.0
lease_network_of_concern 140.180.0.0 255.255.0.0



</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO dhcp_probe.cf&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/dhcp_probe.8.html"><strong>dhcp_probe</strong>(8)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="dhcp-options.5.html"><span aria-hidden="true">&larr;</span> dhcp-options.5: Dynamic host configuration protocol options</a></li>
   <li class="next"><a href="dhcpd.conf.5.html">dhcpd.conf.5: Dhcpd configuration file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
