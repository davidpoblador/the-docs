<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>schroot.conf: Chroot definition file for schroot</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Chroot definition file for schroot">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="schroot.conf (5) manual">
  <meta name="twitter:description" content="Chroot definition file for schroot">
  <meta name="twitter:image" content="https://www.carta.tech/images/schroot-schroot.conf-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/schroot.conf.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="schroot.conf (5) manual" />
  <meta property="og:description" content="Chroot definition file for schroot" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/schroot-schroot.conf-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">schroot.conf<small> (5)</small></h1>
        <p class="lead">Chroot definition file for schroot</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/schroot.conf.5.html">
      <span itemprop="name">schroot.conf: Chroot definition file for schroot</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/schroot/">
      <span itemprop="name">schroot</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/schroot.conf.5.html">
      <span itemprop="name">schroot.conf: Chroot definition file for schroot</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><em>schroot.conf</em> is a plain UTF-8 text file, describing the chroots available for use with schroot.</p><p>Comments are introduced following a \[oq]\[sh]\[cq] (\[lq]hash\[rq]) character at the beginning of a line, or following any other text.  All text right of the \[oq]\[sh]\[cq] is treated as a comment.</p><p>The configuration format is an INI-style format, split into groups of key-value pairs separated by section names in square brackets.</p><h3>General options</h3>
<p>A chroot is defined as a group of key-value pairs, which is started by a name in square brackets on a line by itself.  The file may contain multiple groups which therefore define multiple chroots.</p><p>A chroot definition is started by the name of the chroot in square brackets. For example,</p><ul>
<li><p>\[lB]sid\[rB]</p></li>
</ul><p>The name is subject to certain naming restrictions.  For further details, see the section \[lq]<em>Chroot Names</em>\[rq] below.</p><p>This is then followed by several key-value pairs, one per line:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>type=</em><em>type</em></p>
  </dt>
  <dd>
    <p>The type of the chroot.  Valid types are \[oq]plain\[cq], \[oq]directory\[cq], \[oq]file\[cq], \[oq]loopback\[cq], \[oq]block-device\[cq], \[oq]btrfs-snapshot\[cq] and \[oq]lvm-snapshot\[cq].  If empty or omitted, the default type is \[oq]plain\[cq].  Note that \[oq]plain\[cq] chroots do not run setup scripts and mount filesystems; \[oq]directory\[cq] is recommended for normal use (see \[lq]<em>Plain and directory chroots</em>\[rq], below).</p>
  </dd>
  <dt>
    <p><em>description=</em><em>description</em></p>
  </dt>
  <dd>
    <p>A short description of the chroot.  This may be localised for different languages; see the section \[lq]<em>Localisation</em>\[rq] below.</p>
  </dd>
  <dt>
    <p><em>priority=</em><em>number</em></p>
  </dt>
  <dd>
    <p>Set the priority of a chroot.  <em>number</em> is a positive integer indicating whether a distribution is older than another.  For example, \[lq]oldstable\[rq] and \[lq]oldstable-security\[rq] might be \[oq]0\[cq], while \[lq]stable\[rq] and \[lq]stable-security\[rq] are \[oq]1\[cq], \[lq]testing\[rq] is \[oq]2\[cq] and \[lq]unstable\[rq] is \[oq]3\[cq].  The values are not important, but the difference between them is.  This option is deprecated and no longer used by schroot, but is still permitted to be used; it will be obsoleted and removed in a future release.</p>
  </dd>
  <dt>
    <p><em>message-verbosity=</em><em>verbosity</em></p>
  </dt>
  <dd>
    <p>Set the verbosity of messages printed by schroot when setting up, running commands and cleaning up the chroot.  Valid settings are \[oq]quiet\[cq] (suppress most messages), \[oq]normal\[cq] (the default) and \[oq]verbose\[cq] (show all messages).  This setting is overridden by the options <em>--quiet</em> and <em>--verbose</em>.</p>
  </dd>
  <dt>
    <p><em>users=</em><em>user1,user2,...</em></p>
  </dt>
  <dd>
    <p>A comma-separated list of users which are allowed access to the chroot.  If empty or omitted, no users will be allowed access (unless a group they belong to is also specified in <em>groups</em>).</p>
  </dd>
  <dt>
    <p><em>groups=</em><em>group1,group2,...</em></p>
  </dt>
  <dd>
    <p>A comma-separated list of groups which are allowed access to the chroot.  If empty or omitted, no groups of users will be allowed access.</p>
  </dd>
  <dt>
    <p><em>root-users=</em><em>user1,user2,...</em></p>
  </dt>
  <dd>
    <p>A comma-separated list of users which are allowed <strong>password-less</strong> root access to the chroot.  If empty or omitted, no users will be allowed root access without a password (but if a user or a group they belong to is in <em>users</em> or <em>groups</em>, respectively, they may gain access with a password).  See the section \[lq]<em>Security</em>\[rq] below.</p>
  </dd>
  <dt>
    <p><em>root-groups=</em><em>group1,group2,...</em></p>
  </dt>
  <dd>
    <p>A comma-separated list of groups which are allowed <strong>password-less</strong> root access to the chroot.  If empty or omitted, no users will be allowed root access without a password (but if a user or a group they belong to is in <em>users</em> or <em>groups</em>, respectively, they may gain access with a password).  See the section \[lq]<em>Security</em>\[rq] below.</p>
  </dd>
  <dt>
    <p><em>aliases=</em><em>alias1,alias2,...</em></p>
  </dt>
  <dd>
    <p>A comma-separated list of aliases (alternate names) for this chroot.  For example, a chroot named \[lq]sid\[rq] might have an \[oq]unstable\[cq] alias for convenience.  Aliases are subject to the same naming restrictions as the chroot name itself.</p>
  </dd>
  <dt>
    <p><em>profile=</em><em>directory</em></p>
  </dt>
  <dd>
    
  </dd>
  <dt>
    <p><em>script-config=</em><em>filename</em></p>
  </dt>
  <dd>
    <p>The behaviour of the chroot setup scripts may be customised on a per-chroot basis by setting a specific configuration profile.  The directory is relative to <em>\*[SCHROOT_SYSCONF_DIR]</em>.  The default is \[oq]default\[cq].  The files in this directory are sourced by the setup scripts, and so their behaviour may be customised by selecting the appropriate profile.  Alternatives are \[oq]minimal\[cq] (minimal configuration), \[oq]desktop\[cq] (for running desktop applications in the chroot, making more functionality from the host system available in the chroot) and \[oq]sbuild\[cq] (for using the chroot for Debian package building).  Other packages may provide additional profiles.  The default values of the keys <em>setup.config</em>, <em>setup.copyfiles</em>, <em>setup.fstab</em> and <em>setup.nssdatabases</em> are set based upon the <em>profile</em> setting.</p><ul>
<li><p>Note that the <em>profile</em> key replaces the older <em>script-config</em> key.  The <em>script-config</em> key is exactly the same as <em>profile</em>, but has \[lq]<em>/config</em>\[rq] appended to it.  The default filename is \[oq]default/config\[cq].  Either of these keys may be used.  If both are present, then <em>script-config</em> will take precedence (<em>profile</em> will be unset).  <em>script-config</em> is deprecated and will be removed in a future release.  Note that <em>profile</em> is equivalent to <em>script-config</em> if the file sourced by <em>script-config</em> only contains the standard variables provided by schroot; if any additional variables or shell script fragments have been added, please also set <em>setup.config</em>, which will continue to allow this file to be sourced. It is recommended to replace the use of the sourced file with additional keys in schroot.conf where possible, but it will continue to be possible to source an additional configuration file using <em>setup.config</em>.</p></li><li><p>Desktop users should note that the fstab file <em>desktop/fstab</em> will need editing if you use gdm3; please see the comments in this file for further instructions.  The <em>preserve-environment</em> key should also be set to \[oq]true\[cq] so that the environment is preserved inside the chroot.</p></li><li><p>If none of the configuration profiles provided above meet your needs, then they may be edited to further customise them, and/or copied and used as a template for entirely new profiles.</p></li><li><p>Note that the different profiles have different security implications; see the section \[lq]<em>Security</em>\[rq] below for further details.</p></li>
</ul>
  </dd>
  <dt>
    <p><em>setup.config=</em><em>filename</em></p>
  </dt>
  <dd>
    <p>This key specifies a file which the setup scripts will source when they are run.  This defaults to the same value as set by <em>script-config</em>.  The file is a Bourne shell script, and in consequence may contain any valid shell code, in addition to simple variable assignments.  This will, for example, allow behaviour to be customised according to the specific chroot type or name. Note that the script will be sourced once for each and every script invocation, and must be idempotent.</p><ul>
<li><p>All the default settings in this file are now settable using configuration keys in <em>schroot.conf</em>, as detailed below.  Existing configuration should be modified to use these keys in place of this file.  See <a href="../man5/schroot-script-config.5.html"><strong>schroot-script-config</strong>(5)</a> for further details.  This type of setup script configuration file is no longer provided as part of the standard profiles, but will continue to be sourced if present and this key is set.</p></li>
</ul>
  </dd>
  <dt>
    <p><em>setup.copyfiles=</em><em>filename</em></p>
  </dt>
  <dd>
    <p>A file containing a list of files to copy into the chroot (one file per line). The file will have the same absolute location inside the chroot.</p>
  </dd>
  <dt>
    <p><em>setup.fstab=</em><em>filename</em></p>
  </dt>
  <dd>
    <p>The filesystem table file to be used to mount filesystems within the chroot. The format of this file is the same as for <em>/etc/fstab</em>, documented in <a href="../man5/fstab.5.html"><strong>fstab</strong>(5)</a>. The only difference is that the mountpoint path <em>fs_dir</em> is relative to the chroot, rather than the root.  Also note that mountpoints are canonicalised on the host, which will ensure that absolute symlinks point inside the chroot, but complex paths containing multiple symlinks may be resolved incorrectly; it is inadvisable to use nested symlinks as mountpoints.</p>
  </dd>
  <dt>
    <p><em>setup.nssdatabases=</em><em>filename</em></p>
  </dt>
  <dd>
    <p>A file listing the system databases to copy into the chroot.  The default databases are \[oq]passwd\[cq], \[oq]shadow\[cq], \[oq]group\[cq] and \[oq]gshadow\[cq].  Other potential databases which could be added include \[oq]services\[cq], \[oq]protocols\[cq], \[oq]networks\[cq], and \[oq]hosts\[cq].  The databases are copied using <a href="../man1/getent.1.html"><strong>getent</strong>(1)</a> so all database sources listed in <em>/etc/nsswitch.conf</em> will be used for each database.</p>
  </dd>
  <dt>
    <p><em>setup.services=</em><em>service1,service2,...</em></p>
  </dt>
  <dd>
    <p>A comma-separated list of services to run in the chroot.  These will be started when the session is started, and stopped when the session is ended.</p>
  </dd>
  <dt>
    <p><em>command-prefix=</em><em>command,option1,option2,...</em></p>
  </dt>
  <dd>
    <p>A comma-separated list of a command and the options for the command.  This command and its options will be prefixed to all commands run inside the chroot. This is useful for adding commands such as nice, ionice or eatmydata for all commands run inside the chroot.  nice and ionice will affect CPU and I/O scheduling.  eatmydata ingores filesystem fsync operations, and is useful for throwaway snapshot chroots where you don't care about dataloss, but do care about high speed.</p>
  </dd>
  <dt>
    <p><em>personality=</em><em>persona</em></p>
  </dt>
  <dd>
    <p>Set the personality (process execution domain) to use.  This option is useful when using a 32-bit chroot on 64-bit system, for example.  Valid options on Linux are \[oq]bsd\[cq], \[oq]hpux\[cq], \[oq]irix32\[cq], \[oq]irix64\[cq], \[oq]irixn32\[cq], \[oq]iscr4\[cq], \[oq]linux\[cq], \[oq]linux32\[cq], \[oq]linux_32bit\[cq], \[oq]osf4\[cq], \[oq]osr5\[cq], \[oq]riscos\[cq], \[oq]scorvr3\[cq], \[oq]solaris\[cq], \[oq]sunos\[cq], \[oq]svr4\[cq], \[oq]uw7\[cq], \[oq]wysev386\[cq], and \[oq]xenix\[cq].  The default value is \[oq]linux\[cq].  There is also the special option \[oq]undefined\[cq] (personality not set).  For a 32-bit chroot on a 64-bit system, \[oq]linux32\[cq] is the option required.  The only valid option for non-Linux systems is \[oq]undefined\[cq].  The default value for non-Linux systems is \[oq]undefined\[cq].</p>
  </dd>
  <dt>
    <p><em>preserve-environment=</em><em>true</em>|<em>false</em></p>
  </dt>
  <dd>
    <p>By default, the environment will not be preserved inside the chroot, instead a minimal environment will be used.  Set to <em>true</em> to always preserve the environment.  This is useful for example when running X applications inside the chroot, which need the environment to function correctly.  The environment may also be preserved using the <em>--preserve-environment</em> option.</p>
  </dd>
  <dt>
    <p><em>shell=</em><em>shell</em></p>
  </dt>
  <dd>
    <p>When running a login shell a number of potential shells will be considered, in this order: the command in the SHELL environment variable (if <em>--preserve-environment</em> is used, or <em>preserve-environment</em> is enabled), the user's shell in the \[oq]passwd\[cq] database, <em>/bin/bash</em> and finally <em>/bin/sh</em>.  This setting overrides this list, and will use the shell specified.  It may be overridden using the <em>--shell</em> option.</p>
  </dd>
  <dt>
    <p><em>environment-filter=</em><em>regex</em></p>
  </dt>
  <dd>
    <p>The environment to be set in the chroot will be filtered in order to remove environment variables which may pose a security risk.  Any environment variable matching the specified POSIX extended regular expression will be removed prior to executing any command in the chroot.</p><ul>
<li><p>Potentially dangerous environment variables are removed for safety by default using the following regular expression: \[lq]^(BASH_ENV|CDPATH|ENV|HOSTALIASES|IFS|KRB5_CONFIG|KRBCONFDIR|KRBTKFILE|KRB_CONF|LD_.*|LOCALDOMAIN|NLSPATH|PATH_LOCALE|RES_OPTIONS|TERMINFO|TERMINFO_DIRS|TERMPATH)$\[rq].</p></li>
</ul>
  </dd>

</dl>

<h3>Plain and directory chroots</h3>
<p>Chroots of type \[oq]plain\[cq] or \[oq]directory\[cq] are directories accessible in the filesystem.  The two types are equivalent except for the fact that directory chroots run setup scripts, whereas plain chroots do not.  In consequence, filesystems such as <em>/proc</em> are not mounted in plain chroots; it is the responsibility of the system administrator to configure such chroots by hand, whereas directory chroots are automatically configured.  Additionally, directory chroots implement the <strong>filesystem union chroot</strong> options (see \[lq]<em>Filesystem Union chroot options</em>\[rq], below).</p><p>These chroot types have an additional (mandatory) configuration option:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>directory=</em><em>directory</em></p>
  </dt>
  <dd>
    <p>The directory containing the chroot environment.  This is where the root will be changed to when executing a login shell or a command.  The directory must exist and have read and execute permissions to allow users access to it.  Note that on Linux systems it will be bind-mounted elsewhere for use as a chroot; the directory for \[oq]plain\[cq] chroots is mounted with the <em>--rbind</em> option to <a href="../man8/mount.8.html"><strong>mount</strong>(8)</a>, while for \[oq]directory\[cq] chroots <em>--bind</em> is used instead so that sub-mounts are not preserved (they should be set in the <em>fstab</em> file just like in <em>/etc/fstab</em> on the host).</p>
  </dd>

</dl>

<h3>File chroots</h3>
<p>Chroots of type \[oq]file\[cq] are files on the current filesystem containing an archive of the chroot files.  They implement the <strong>source chroot</strong> options (see \[lq]<em>Source chroot options</em>\[rq], below).  Note that a corresponding source chroot (of type \[oq]file\[cq]) will be created for each chroot of this type; this is for convenient access to the source archive, e.g. for the purpose of updating. These additional options are also implemented:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>file=</em><em>filename</em></p>
  </dt>
  <dd>
    <p>The file containing the archived chroot environment (mandatory).  This must be a tar (tape archive), optionally compressed with gzip or bzip2.  The file extensions used to determine the type are are <em>.tar</em>, <em>.tar.gz</em>, <em>.tar.bz2</em>, <em>.tgz</em>, and <em>.tbz</em>.  This file must be owned by the root user, and not be writable by other.  Note that zip archives are no longer supported; zip was not able to archive named pipes and device nodes, so was not suitable for archiving chroots.</p>
  </dd>
  <dt>
    <p><em>location=</em><em>path</em></p>
  </dt>
  <dd>
    <p>This is the path to the chroot <em>inside</em> the archive.  For example, if the archive contains a chroot in <em>/squeeze</em>, you would specify \[lq]/squeeze\[rq] here.  If the chroot is the only thing in the archive, i.e. <em>/</em> is the root filesystem for the chroot, this option should be left blank, or omitted entirely.</p>
  </dd>

</dl>

<h3>Loopback chroots</h3>
<p>Chroots of type \[oq]loopback\[cq] are a filesystem available as a file on disk, accessed via a loopback mount.  The file will be loopback mounted and unmounted on demand.  Loopback chroots implement the <strong>mountable chroot</strong> and <strong>filesystem union chroot</strong> options (see \[lq]<em>Mountable chroot</em> options\[rq] and \[lq]<em>Filesystem Union chroot options</em>\[rq], below), plus an additional option:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>file=</em><em>filename</em></p>
  </dt>
  <dd>
    <p>This is the filename of the file containing the filesystem, including the absolute path.  For example \[lq]/srv/chroot/sid\[rq].</p>
  </dd>

</dl>

<h3>Block device chroots</h3>
<p>Chroots of type \[oq]block-device\[cq] are a filesystem available on an unmounted block device.  The device will be mounted and unmounted on demand. Block device chroots implement the <strong>mountable chroot</strong> and <strong>filesystem</strong> union chroot options (see \[lq]<em>Mountable chroot options</em>\[rq] and \[lq]<em>Filesystem Union chroot options</em>\[rq], below), plus an additional option:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>device=</em><em>device</em></p>
  </dt>
  <dd>
    <p>This is the device name of the block device, including the absolute path.  For example, \[lq]/dev/sda5\[rq].</p>
  </dd>

</dl>

<h3>Btrfs snapshot chroots</h3>
<p>Chroots of type \[oq]btrfs-snapshot\[cq] are a Btrfs snapshot created from an existing Btrfs subvolume on a mounted Btrfs filesystem.  A snapshot will be created from this source subvolume on demand at the start of a session, and then the snapshot will be mounted.  At the end of the session, the snapshot will be unmounted and deleted.  This chroot type implements the <strong>source</strong> chroot options (see \[lq]<em>Source chroot options</em>\[rq], below).  Note that a corresponding source chroot (of type \[oq]directory\[cq]) will be created for each chroot of this type; this is for convenient access to the source volume. These additional options are also implemented:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>btrfs-source-subvolume=</em><em>directory</em></p>
  </dt>
  <dd>
    <p>The directory containing the source subvolume.</p>
  </dd>
  <dt>
    <p><em>btrfs-snapshot-directory=</em><em>directory</em></p>
  </dt>
  <dd>
    <p>The directory in which to store the snapshots of the above source subvolume.</p>
  </dd>

</dl>

<h3>LVM snapshot chroots</h3>
<p>Chroots of type \[oq]lvm-snapshot\[cq] are a filesystem available on an LVM logical volume (LV).  A snapshot LV will be created from this LV on demand, and then the snapshot will be mounted.  At the end of the session, the snapshot LV will be unmounted and removed.</p><p>LVM snapshot chroots implement the <strong>source chroot</strong> options (see \[lq]<em>Source chroot options</em>\[rq], below), and all the options for \[oq]block-device\[cq].  Note that a corresponding source chroot (of type \[oq]block-device\[cq]) will be created for each chroot of this type; this is for convenient access to the source device. This additional option is also implemented:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>lvm-snapshot-options=</em><em>snapshot_options</em></p>
  </dt>
  <dd>
    <p>Snapshot options.  These are additional options to pass to <a href="../man8/lvcreate.8.html"><strong>lvcreate</strong>(8)</a>.  For example, \[lq]-L 2g\[rq] to create a snapshot 2 GiB in size. <strong>Note:</strong> the LV name (<em>-n</em>), the snapshot option (<em>-s</em>) and the original LV path may not be specfied here; they are set automatically by schroot.</p>
  </dd>

</dl>

<h3>Custom chroots</h3>
<p>Chroots of type \[oq]custom\[cq] are a special type of chroot, used for implementing new types of chroot not supported by any of the above chroot types.  This may be useful for implementing and testing a new chroot type without needing to write any C++ code.  However, you will need to write your own setup script to do the setup work, since by itself this chroot type does very little.  You will also need to add custom keys to your chroot definition for use in the setup script; unlike the configuration for the above chroot types, no validation of the options will take place unless you do it yourself in your custom setup script.  These additional options are also implemented:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>custom-session-cloneable=</em><em>true</em>|<em>false</em></p>
  </dt>
  <dd>
    <p>Set whether or not sessions may be cloned using this chroot (enabled by default).</p>
  </dd>
  <dt>
    <p><em>custom-session-purgeable=</em><em>true</em>|<em>false</em></p>
  </dt>
  <dd>
    <p>Set whether or not sessions may be cloned using this chroot (disabled by default).</p>
  </dd>
  <dt>
    <p><em>custom-source-cloneable=</em><em>true</em>|<em>false</em></p>
  </dt>
  <dd>
    <p>Set whether or not source chroots may be cloned using this chroot (disabled by default).</p>
  </dd>

</dl>

<h3>Source chroot options</h3>
<p>The \[oq]btrfs-snapshot\[cq], \[oq]file\[cq] and \[oq]lvm-snapshot\[cq] chroot types implement source chroots.  Additionally, chroot types with union support enabled implement source chroots (see \[lq]<em>Filesystem Union chroot</em> options\[rq], below).  These are chroots which automatically create a copy of themselves before use, and are usually session managed.  These chroots additionally provide an extra chroot in the <em>source:</em> namespace, to allow convenient access to the original (non-snapshotted) data, and to aid in chroot maintenance.  I.e. for a chroot named <em>wheezy</em> (<em>chroot:wheezy</em>), a corresponding <em>source:wheezy</em> chroot will be created.  For compatibility with older versions of schroot which did not support namespaces, a chroot with a <em>-source</em> suffix appended to the chroot name will be created in addition (i.e. <em>wheezy-source</em> using the above example).  Note that these compatibility names will be removed in schroot 1.5.0, so the use of the <em>source:</em> namespace is preferred over the use of the <em>-source</em> suffix form.  See <a href="../man1/schroot.1.html"><strong>schroot</strong>(1)</a> for further details.</p><p>These chroots provide the following additional options:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>source-clone=</em><em>true</em>|<em>false</em></p>
  </dt>
  <dd>
    <p>Set whether the source chroot should be automatically cloned (created) for this chroot.  The default is <em>true</em> to automatically clone, but if desired may be disabled by setting to <em>false</em>.  If disabled, the source chroot will be inaccessible.</p>
  </dd>
  <dt>
    <p><em>source-users=</em><em>user1,user2,...</em></p>
  </dt>
  <dd>
    <p>A comma-separated list of users which are allowed access to the source chroot. If empty or omitted, no users will be allowed access.  This will become the <em>users</em> option in the source chroot.</p>
  </dd>
  <dt>
    <p><em>source-groups=</em><em>group1,group2,...</em></p>
  </dt>
  <dd>
    <p>A comma-separated list of groups which are allowed access to the source chroot. If empty or omitted, no users will be allowed access.  This will become the <em>groups</em> option in the source chroot.</p>
  </dd>
  <dt>
    <p><em>source-root-users=</em><em>user1,user2,...</em></p>
  </dt>
  <dd>
    <p>A comma-separated list of users which are allowed <strong>password-less</strong> root access to the source chroot.  If empty or omitted, no users will be allowed root access without a password (but if a user is in <em>users</em>, they may gain access with a password).  This will become the <em>root-users</em> option in the source chroot.  See the section \[lq]<em>Security</em>\[rq] below.</p>
  </dd>
  <dt>
    <p><em>source-root-groups=</em><em>group1,group2,...</em></p>
  </dt>
  <dd>
    <p>A comma-separated list of groups which are allowed <strong>password-less</strong> root access to the source chroot.  If empty or omitted, no users will be allowed root access without a password (but if a user's group is in <em>groups</em>, they may gain access with a password).  This will become the <em>root-groups</em> option in the source chroot.  See the section \[lq]<em>Security</em>\[rq] below.</p>
  </dd>

</dl>

<h3>Mountable chroot options</h3>
<p>The \[oq]block-device\[cq], \[oq]loopback\[cq] and \[oq]lvm-snapshot\[cq] chroot types implement device mounting.  These are chroots which require the mounting of a device in order to access the chroot.  These chroots provide the following additional options:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>mount-options=</em><em>options</em></p>
  </dt>
  <dd>
    <p>Mount options for the block device.  These are additional options to pass to <a href="../man8/mount.8.html"><strong>mount</strong>(8)</a>. For example, \[lq]-o atime,sync,user_xattr\[rq].</p>
  </dd>
  <dt>
    <p><em>location=</em><em>path</em></p>
  </dt>
  <dd>
    <p>This is the path to the chroot <em>inside</em> the filesystem on the device.  For example, if the filesystem contains a chroot in <em>/chroot/sid</em>, you would specify \[lq]/chroot/sid\[rq] here.  If the chroot is the only thing on the filesystem, i.e. <em>/</em> is the root filesystem for the chroot, this option should be left blank, or omitted entirely.</p>
  </dd>

</dl>

<h3>Filesystem Union chroot options</h3>
<p>The \[oq]block-device\[cq], \[oq]directory\[cq] and \[oq]loopback\[cq] chroot types allow for the creation of a session using filesystem unions to overlay the original filesystem with a separate writable directory.  The original filesystem is read-only, with any modifications made to the filesystem made in the overlying writable directory, leaving the original filesystem unchanged.  A union permits multiple sessions to access and make changes to a single chroot simultaneously, while keeping the changes private to each session.  To enable this feature, set <em>union-type</em> to any supported value.  If enabled, the chroot will also be a <strong>source chroot</strong>, which will provide additional options (see \[lq]<em>Source chroot options</em>\[rq], above).  All entries are optional.</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>union-type=</em><em>type</em></p>
  </dt>
  <dd>
    <p>Set the union filesystem type.  Currently supported filesystems are \[oq]aufs\[cq], \[oq]overlayfs\[cq] and \[oq]unionfs\[cq].  The default is \[oq]none\[cq], which disables this feature.</p>
  </dd>
  <dt>
    <p><em>union-mount-options=</em><em>options</em></p>
  </dt>
  <dd>
    <p>Union filesystem mount options (branch configuration), used for mounting the union filesystem specified with <em>union-type</em>.  This replaces the complete \[lq]-o\[rq] string for mount and allows for the creation of complex filesystem unions.  Note that \[oq]aufs\[cq], \[oq]overlayfs\[cq] and \[oq]unionfs\[cq] each have different supported mount options. <strong>Note:</strong> One can use the variables \[lq]${CHROOT_UNION_OVERLAY_DIRECTORY}\[rq] and \[lq]${CHROOT_UNION_UNDERLAY_DIRECTORY}\[rq] to refer to the writable overlay session directory and read-only underlying directory which are to form the union.  See <a href="../man5/schroot-setup.5.html"><strong>schroot-setup</strong>(5)</a> for a complete variable list.</p>
  </dd>
  <dt>
    <p><em>union-overlay-directory</em><em>=directory</em></p>
  </dt>
  <dd>
    <p>Specify the directory where the writeable overlay session directories will be created.  The default is \[oq]\*[SCHROOT_OVERLAY_DIR]\[cq].</p>
  </dd>
  <dt>
    <p><em>union-underlay-directory</em><em>=directory</em></p>
  </dt>
  <dd>
    <p>Specify the directory where the read-only underlying directories will be created.  The default is \[oq]\*[SCHROOT_UNDERLAY_DIR]\[cq].</p>
  </dd>

</dl>

<h3>Customisation</h3>
<p>In addition to the configuration keys listed above, it is possible to add custom keys.  These keys will be used to add additional environment variables to the setup script environment when setup scripts are run.  The only restriction is that the key name consists only of alphanumeric characters and hyphens, begins with an alphabet character and contains at least one period. That is to say, that it matches the extended regular expression \[lq]^([a-z][a-z0-9]*&#92;.)+[a-z][a-z0-9-]*$\[rq].</p><p>For example:</p>
<pre>
debian.apt-update=true
debian.distribution=unstable
</pre>
<p>would set the following environment:</p>
<pre>
DEBIAN_APT_UPDATE=true
DEBIAN_DISTRIBUTION=unstable
</pre>
<p>Note that it is an error to use different key names which would set the same environment variable by mixing periods and hyphens.</p><p>Custom configuration keys may also be modified at runtime using the <em>--option</em> option.  However, for security, only selected keys may be modified.  These keys are specified using the following options:</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>user-modifiable-keys=</em><em>key1,key2,..</em></p>
  </dt>
  <dd>
    <p>Set the keys which users may modify using <em>--option</em>.</p>
  </dd>
  <dt>
    <p><em>root-modifiable-keys=</em><em>key1,key2,..</em> Set the keys which the</p>
  </dt>
  <dd>
    <p>root user may modify using <em>--option</em>.  Note that the root user may use the keys specified in <em>user-modifiable-keys</em> in addition to those specified here.</p>
  </dd>

</dl>

<h3>Localisation</h3>
<p>Some keys may be localised in multiple languages.  This is achieved by adding the locale name in square brackets after the key name.  For example:</p>
<pre>
description[en_GB]=<em>British English translation</em>
</pre>
<p>This will localise the <em>description</em> key for the en_GB locale.</p>
<pre>
description[fr]=<em>French translation</em>
</pre>
<p>This will localise the <em>description</em> key for all French locales.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CHROOT NAMES</h2>
        <div class="sectioncontent">
<p>A number of characters or words are not permitted in a chroot name, session name or configuration filename.  The name may not contain a leading period (\[oq].\[cq]).  The characters \[oq]:\[cq] (colon), \[oq],\[cq] (comma) and \[oq]/\[cq] (forward slash) are not permitted anywhere in the name.  The name may also not contain a trailing tilde (\[oq]~\[cq]).  The rationale for these restrictions is given below.</p>
<dl class='dl-vertical'>
  <dt>
    <p>\[oq]<strong>.</strong>\[cq]</p>
  </dt>
  <dd>
    <p>A leading period could be used to create a name with a relative path in it, in combination with \[oq]/\[cq], and this could allow overwriting of files on the host filesystem.  Not allowing this character also means hidden files cannot be created.  It also means some editor backups are automatically ignored.  Periods are allowed anywhere else in the name.</p>
  </dd>
  <dt>
    <p>\[oq]<strong>:</strong>\[cq]</p>
  </dt>
  <dd>
    <p>A colon is used as a namespace delimiter, and so is not permitted as part of a chroot or session name.  LVM snapshot names may also not contain this character due to a naming restriction by <a href="../man8/lvcreate.8.html"><strong>lvcreate</strong>(8)</a>.</p>
  </dd>
  <dt>
    <p>\[oq]<strong>/</strong>\[cq]</p>
  </dt>
  <dd>
    <p>Names containing this character are not valid filenames.  A forward slash would potentially allow creation of files in subdirectories.</p>
  </dd>
  <dt>
    <p>\[oq]<strong>,</strong>\[cq]</p>
  </dt>
  <dd>
    <p>Commas are used to separate items in lists.  Aliases are separated by commas and hence can't contain commas in their name.</p>
  </dd>
  <dt>
    <p>\[oq]<strong>~</strong>\[cq]</p>
  </dt>
  <dd>
    <p>Filenames containing trailing tildes are used for editor backup files, which are ignored.  Tildes are allowed anywhere else in the name.</p>
  </dd>
  <dt>
    <p>\[oq]<strong>dpkg-old</strong>\[cq] \[oq]<strong>dpkg-dist</strong>\[cq] \[oq]<strong>dpkg-new</strong>\[cq] \[oq]<strong>dpkg-tmp</strong>\[cq]</p>
  </dt>
  <dd>
    <p>These names may not appear at the end of a name.  These are saved copies of conffiles used by the dpkg package manager, and will be ignored.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SECURITY</h2>
        <div class="sectioncontent">
<h3>Untrusted users</h3>
<p>Note that giving untrusted users root access to chroots is a <strong>serious</strong> security risk!  Although the untrusted user will only have root access to files inside the chroot, in practice there are many obvious ways of breaking out of the chroot and of disrupting services on the host system.  As always, this boils down to <em>trust</em>.</p><p><strong>Do not give chroot root access to users you would not trust</strong> <strong>with root access to the host system.</strong></p>
<h3>Profiles</h3>
<p>Depending upon which profile you have configured with the <em>script-config</em> option, different filesystems will be mounted inside the chroot, and different files will be copied into the chroot from the host. Some profiles will mount the host's <em>/dev</em>, while others will not.  Some profiles also bind mount additional parts of the host filesystem in order to allow use of certain features, including user's home directories and specific parts of <em>/var</em>.  Check the profile's <em>fstab</em> file to be certain of what will be mounted, and the other profile files to see which files and system databases will be copied into the chroot.  Choose a different profile or edit the files to further restrict what is made available inside the chroot.</p><p>There is a tradeoff between security (keeping the chroot as minimal as possible) and usability (which sometimes requires access to parts of the host filesystem).  The different profiles make different tradeoffs, and it is important that you assess which meets the security/usability tradeoff you require.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">

<pre>
# Sample configuration

[sid]
type=plain
description=Debian unstable
description[fr_FR]=Debian instable
directory=/srv/chroot/sid
priority=3
users=jim
groups=sbuild
root-users=rleigh
aliases=unstable,default

[etch]
type=block-device
description=Debian testing (32-bit)
priority=2
groups=users
#groups=sbuild-security
aliases=testing
device=/dev/hda_vg/etch_chroot
mount-options=-o atime
personality=linux32

[sid-file]
type=file
description=Debian sid file-based chroot
priority=3
groups=sbuild
file=/srv/chroots/sid.tar.gz

[sid-snapshot]
type=lvm-snapshot
description=Debian unstable LVM snapshot
priority=3
groups=sbuild
users=rleigh
source-root-users=rleigh
source-root-groups=admin
device=/dev/hda_vg/sid_chroot
mount-options=-o atime,sync,user_xattr
lvm-snapshot-options=--size 2G
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<h3>Chroot definitions</h3>

<dl class='dl-vertical'>
  <dt>
    <p><em>\*[SCHROOT_CONF]</em></p>
  </dt>
  <dd>
    <p>The system-wide chroot definition file.  This file must be owned by the root user, and not be writable by other.</p>
  </dd>
  <dt>
    <p><em>\*[SCHROOT_CONF_CHROOT_D]</em></p>
  </dt>
  <dd>
    <p>Additional chroot definitions may be placed in files under this directory. They are treated in exactly that same manner as <em>\*[SCHROOT_CONF]</em>.  Each file may contain one or more chroot definitions.</p>
  </dd>

</dl>

<h3>Setup script configuration</h3>
<p>The directory <em>\*[SCHROOT_SYSCONF_DIR]/default</em> contains the default settings used by setup scripts.</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>config</em></p>
  </dt>
  <dd>
    <p>Main configuration file read by setup scripts.  The format of this file is described in <a href="../man5/schroot-script-config.5.html"><strong>schroot-script-config</strong>(5)</a>. This is the default value for the <em>script-config</em> key.  Note that this was formerly named <em>\*[SCHROOT_SYSCONF_DIR]/script-defaults</em>.  The following files are referenced by default:</p>
  </dd>
  <dt>
    <p><em>copyfiles</em></p>
  </dt>
  <dd>
    <p>A list of files to copy into the chroot from the host system.  Note that this was formerly named <em>\*[SCHROOT_SYSCONF_DIR]/copyfiles-defaults</em>.</p>
  </dd>
  <dt>
    <p><em>fstab</em></p>
  </dt>
  <dd>
    <p>A file in the format decribed in <a href="../man5/fstab.5.html"><strong>fstab</strong>(5)</a>, used to mount filesystems inside the chroot.  The mount location is relative to the root of the chroot.  Note that this was formerly named <em>\*[SCHROOT_SYSCONF_DIR]/mount-defaults</em>.</p>
  </dd>
  <dt>
    <p><em>nssdatabases</em></p>
  </dt>
  <dd>
    <p>System databases (as described in <em>/etc/nsswitch.conf</em> on GNU/Linux systems) to copy into the chroot from the host.  Note that this was formerly named <em>\*[SCHROOT_SYSCONF_DIR]/nssdatabases-defaults</em>.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Roger Leigh.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2005-2012  Roger Leigh &lt;rleigh@debian.org&gt;</p><p><strong>\*[PROGRAM]</strong> is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO schroot.conf&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/sbuild.1.html"><strong>sbuild</strong>(1)</a>, <a href="../man1/schroot.1.html"><strong>schroot</strong>(1)</a>, <a href="../man5/schroot-script-config.5.html"><strong>schroot-script-config</strong>(5)</a>, <strong>schroot-faq</strong>(7), <a href="../man8/mount.8.html"><strong>mount</strong>(8)</a>.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="schroot-setup.5.html"><span aria-hidden="true">&larr;</span> schroot-setup.5: Schroot chroot setup scripts</a></li>
   <li class="next"><a href="script.5.html">script.5: Boot script <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
