<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>dhcpd.leases: Dhcp client lease database</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Dhcp client lease database">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="dhcpd.leases (5) manual">
  <meta name="twitter:description" content="Dhcp client lease database">
  <meta name="twitter:image" content="https://www.carta.tech/images/isc-dhcp-server-dhcpd.leases-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/dhcpd.leases.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="dhcpd.leases (5) manual" />
  <meta property="og:description" content="Dhcp client lease database" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/isc-dhcp-server-dhcpd.leases-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">dhcpd.leases<small> (5)</small></h1>
        <p class="lead">Dhcp client lease database</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/dhcpd.leases.5.html">
      <span itemprop="name">dhcpd.leases: Dhcp client lease database</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/isc-dhcp-server/">
      <span itemprop="name">isc-dhcp-server</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/dhcpd.leases.5.html">
      <span itemprop="name">dhcpd.leases: Dhcp client lease database</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The Internet Systems Consortium DHCP Server keeps a persistent database of leases that it has assigned.  This database is a free-form ASCII file containing a series of lease declarations.  Every time a lease is acquired, renewed or released, its new value is recorded at the end of the lease file.  So if more than one declaration appears for a given lease, the last one in the file is the current one.</p><p>When dhcpd is first installed, there is no lease database.   However, dhcpd requires that a lease database be present before it will start. To make the initial lease database, just create an empty file called DBDIR/dhcpd.leases.   You can do this with:</p>
<pre>
	touch DBDIR/dhcpd.leases
</pre>
<p>In order to prevent the lease database from growing without bound, the file is rewritten from time to time.   First, a temporary lease database is created and all known leases are dumped to it.   Then, the old lease database is renamed DBDIR/dhcpd.leases~.   Finally, the newly written lease database is moved into place.</p><p>In order to process both DHCPv4 and DHCPv6 messages you will need to run two separate instances of the dhcpd process.  Each of these instances will need it's own lease file.  You can use the <em>-lf</em> option on the server's command line to specify a different lease file name for one or both servers.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FORMAT</h2>
        <div class="sectioncontent">
<p>Lease descriptions are stored in a format that is parsed by the same recursive descent parser used to read the <a href="../man5/dhcpd.conf.5.html"><strong>dhcpd.conf</strong>(5)</a></strong> and <a href="../man5/dhclient.conf.5.html"><strong>dhclient.conf</strong>(5)</a></strong> files.  Lease files can contain lease declarations, and also group and subgroup declarations, host declarations and failover state declarations.  Group, subgroup and host declarations are used to record objects created using the OMAPI protocol.</p><p>The lease file is a log-structured file - whenever a lease changes, the contents of that lease are written to the end of the file.   This means that it is entirely possible and quite reasonable for there to be two or more declarations of the same lease in the lease file at the same time.   In that case, the instance of that particular lease that appears last in the file is the one that is in effect.</p><p>Group, subgroup and host declarations in the lease file are handled in the same manner, except that if any of these objects are deleted, a <em>rubout</em> is written to the lease file.   This is just the same declaration, with <strong>{ deleted; }</strong> in the scope of the declaration.   When the lease file is rewritten, any such rubouts that can be eliminated are eliminated.   It is possible to delete a declaration in the <strong>dhcpd.conf</strong> file; in this case, the rubout can never be eliminated from the <strong>dhcpd.leases</strong> file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COMMON STATEMENTS FOR LEASE DECLARATIONS</h2>
        <div class="sectioncontent">
<p>While the lease file formats for DHCPv4 and DHCPv6 are different they share many common statements and structures.  This section describes the common statements while the succeeding sections describe the protocol specific statements.</p><p><strong>Dates</strong></p><p>A <em>date</em> is specified in two ways, depending on the configuration value for the <strong>db-time-format</strong> parameter.  If it was set to <em>default</em>, then the <em>date</em> fields appear as follows:</p><p><em>weekday year</em><strong>/</strong><em>month</em><strong>/</strong><em>day hour</em><strong>:</strong><em>minute</em><strong>:</strong><em>second</em></p><p>The weekday is present to make it easy for a human to tell when a lease expires - it's specified as a number from zero to six, with zero being Sunday.  The day of week is ignored on input.  The year is specified with the century, so it should generally be four digits except for really long leases.  The month is specified as a number starting with 1 for January.  The day of the month is likewise specified starting with 1.  The hour is a number between 0 and 23, the minute a number between 0 and 59, and the second also a number between 0 and 59.</p><p>Lease times are specified in Universal Coordinated Time (UTC), not in the local time zone.  There is probably nowhere in the world where the times recorded on a lease are always the same as wall clock times.  On most unix machines, you can display the current time in UTC by typing <strong>date -u</strong>.</p><p>If the <strong>db-time-format</strong> was configured to <em>local</em>, then the <em>date</em> fields appear as follows:</p><p> <strong>epoch</strong> <em>&lt;seconds-since-epoch&gt;</em><strong>; #</strong> <em>&lt;day-name&gt; &lt;month-name&gt;</em> &lt;day-number&gt; &lt;hours&gt;<strong>:</strong><em>&lt;minutes&gt;</em><strong>:</strong><em>&lt;seconds&gt; &lt;year&gt;</em></p><p>The <em>seconds-since-epoch</em> is as according to the system's local clock (often referred to as "unix time").  The <strong>#</strong> symbol supplies a comment that describes what actual time this is as according to the system's configured timezone, at the time the value was written.  It is provided only for human inspection.</p><p>If a lease will never expire, <em>date</em> is <strong>never</strong> instead of an actual date.</p><p><strong>General Variables</strong></p><p>As part of the processing of a lease information may be attached to the lease structure, for example the DDNS information or if you specify a variable in your configuration file.  Some of these, like the DDNS information, have specific descriptions below.  For others, such as any you might define, a generic line of the following will be included.</p><p><strong>set </strong><em>variable</em><strong> = </strong><em>value</em><strong>;</strong></p><p>The <strong>set</strong> statement sets the value of a variable on the lease. For general information on variables, see the <a href="../man5/dhcp-eval.5.html"><strong>dhcp-eval</strong>(5)</a></strong> manual page.</p><p><strong>DDNS Variables</strong></p>
<pre>
<strong>The </strong><em>ddns-text</em><strong> and </strong><em>ddns-dhcid</em><strong> variables</strong>

These variables are used to record the value of the client's identification
record when the server has updated DNS for a particular lease.  The text
record is used with the interim DDNS update style while the dhcid record
is used for the standard DDNS update style.

<strong>The </strong><em>ddns-fwd-name</em><strong> variable</strong>

This variable records the value of the name used in
updating the client's A record if a DDNS update has been successfully
done by the server.   The server may also have used this name to
update the client's PTR record.

<strong>The </strong><em>ddns-client-fqdn</em><strong> variable</strong>

If the server is configured both to use the interim or standard DDNS update
style, and to allow clients to update their own FQDNs, then if the
client did in fact update its own FQDN, the
<em>ddns-client-fqdn</em> variable records the name that the client has
indicated it is using.   This is the name that the server will have
used to update the client's PTR record in this case.

<strong>The </strong><em>ddns-rev-name</em><strong> variable</strong>

If the server successfully updates the client's PTR record, this
variable will record the name that the DHCP server used for the PTR
record.   The name to which the PTR record points will be either the
<em>ddns-fwd-name</em> or the <em>ddns-client-fqdn</em>.

<strong>Executable Statements</strong>

<strong>on </strong><em>events</em><strong> { </strong><em>statements...</em><strong> }</strong>
The <strong>on</strong> statement records a list of statements to execute if a
certain event occurs.   The possible events that can occur for an
active lease are <strong>release</strong> and <strong>expiry</strong>.   More than one event
can be specified - if so, the events are separated by '|' characters.

</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THE DHCPv4 LEASE DECLARATION</h2>
        <div class="sectioncontent">
<p><strong>lease </strong><em>ip-address</em><strong> { </strong><em>statements...</em><strong> }</strong></p><p>Each lease declaration includes the single IP address that has been leased to the client.   The statements within the braces define the duration of the lease and to whom it is assigned.</p>
<pre>
<strong>starts </strong><em>date</em><strong>;</strong>
<strong>ends </strong><em>date</em><strong>;</strong>
<strong>tstp </strong><em>date</em><strong>;</strong>
<strong>tsfp </strong><em>date</em><strong>;</strong>
<strong>atsfp </strong><em>date</em><strong>;</strong>
<strong>cltt </strong><em>date</em><strong>;</strong>
</pre>
<p>The start and end time of a lease are recorded using the <strong>starts</strong> and <strong>ends</strong> statements.   The <strong>tstp</strong> statement is present if the failover protocol is being used, and indicates what time the peer has been told the lease expires.   The <strong>tsfp</strong> statement is also present if the failover protocol is being used, and indicates the lease expiry time that the peer has acknowledged. The <strong>atsfp</strong> statement is the actual time sent from the failover partner. The <strong>cltt</strong> statement is the client's last transaction time.</p><p>See the description of dates in the section on common structures.</p><p><strong>hardware </strong><em>hardware-type mac-address</em><strong>;</strong></p><p>The hardware statement records the MAC address of the network interface on which the lease will be used.   It is specified as a series of hexadecimal octets, separated by colons.</p><p><strong>uid </strong><em>client-identifier</em><strong>;</strong></p><p>The <strong>uid</strong> statement records the client identifier used by the client to acquire the lease.   Clients are not required to send client identifiers, and this statement only appears if the client did in fact send one.   Client identifiers are normally an ARP type (1 for ethernet) followed by the MAC address, just like in the <strong>hardware</strong><em></em> statement, but this is not required.</p><p>The client identifier is recorded as a colon-separated hexadecimal list or as a quoted string.   If it is recorded as a quoted string and it contains one or more non-printable characters, those characters are represented as octal escapes - a backslash character followed by three octal digits.</p><p><strong>client-hostname </strong><em>hostname</em><strong> ;</strong></p><p>Most DHCP clients will send their hostname in the <em>host-name</em> option.  If a client sends its hostname in this way, the hostname is recorded on the lease with a <strong>client-hostname</strong> statement.   This is not required by the protocol, however, so many specialized DHCP clients do not send a host-name option.</p><p><strong>abandoned;</strong></p><p>The <strong>abandoned</strong> statement indicates that the DHCP server has abandoned the lease.   In that case, the <strong>abandoned</strong> statement will be used to indicate that the lease should not be reassigned. Please see the <a href="../man5/dhcpd.conf.5.html"><strong>dhcpd.conf</strong>(5)</a></strong> manual page for information about abandoned leases.</p>
<pre>
<strong>binding state </strong><em>state</em><strong>;</strong>
<strong>next binding state </strong><em>state</em><strong>;</strong>
</pre>
<p>The <strong>binding state</strong> statement declares the lease's binding state. When the DHCP server is not configured to use the failover protocol, a lease's binding state will be either <strong>active</strong> or <strong>free</strong>.   The failover protocol adds some additional transitional states, as well as the <strong>backup</strong> state, which indicates that the lease is available for allocation by the failover secondary.</p><p>The <strong>next binding state</strong> statement indicates what state the lease will move to when the current state expires.   The time when the current state expires is specified in the <em>ends</em> statement.</p><p><strong>rewind binding state </strong><em>state</em><strong>;</strong></p><p>This statement is part of an optimization for use with failover.  This helps a server rewind a lease to the state most recently transmitted to its peer.</p>
<pre>
<strong>option agent.circuit-id </strong><em>string</em>;
<strong>option agent.remote-id </strong><em>string</em>;
</pre>
<p>These statements are used to record the circuit ID and remote ID options sent by the relay agent, if the relay agent uses the <em>relay agent</em> information option.   This allows these options to be used consistently in conditional evaluations even when the client is contacting the server directly rather than through its relay agent.</p><p><strong>The </strong><em>vendor-class-identifier</em><strong> variable</strong></p><p>The server retains the client-supplied Vendor Class Identifier option for informational purposes, and to render them in DHCPLEASEQUERY responses.</p>
<pre>
<strong>bootp;</strong>
<strong>reserved;</strong>
</pre>
<p>If present, they indicate that the BOOTP and RESERVED failover flags (respectively) should be set.  BOOTP and RESERVED dynamic leases are treated differently than normal dynamic leases, as they may only be used by the client to which they are currently allocated.</p><p><strong>Other</strong> Additional options or executable statements may be included, see the description of them in the section on common structures.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THE DHCPv6 LEASE (IA) DECLARATION</h2>
        <div class="sectioncontent">

<pre>
<strong>ia_ta </strong><em> IAID_DUID</em><strong> { </strong><em>statements...</em><strong> }</strong>
<strong>ia_na </strong><em> IAID_DUID</em><strong> { </strong><em>statements...</em><strong> }</strong>
<strong>ia_pd </strong><em> IAID_DUID</em><strong> { </strong><em>statements...</em><strong> }</strong>
</pre>
<p>Each lease declaration starts with a tag indicating the type of the lease. ia_ta is for temporary addresses, ia_na is for non-temporary addresses and ia_pd is for prefix delegation.  Following this tag is the combined IAID and DUID from the client for this lease.</p><p>The IAID_DUID value is recorded as a colon-separated hexadecimal list or as a quoted string.   If it is recorded as a quoted string and it contains one or more non-printable characters, those characters are represented as octal escapes - a backslash character followed by three octal digits.</p><p><strong>cltt </strong><em>date</em><strong>;</strong></p><p>The <strong>cltt</strong> statement is the client's last transaction time.</p><p>See the description of dates in the section on common structures.</p>
<pre>
<strong>iaaddr </strong><em>ipv6-address</em><strong> { </strong><em>statements...</em><strong> }</strong>
<strong>iaprefix </strong><em>ipv6-address/prefix-length</em><strong> { </strong><em>statements...</em><strong> }</strong>

Within a given lease there can be multiple iaaddr and iaprefix statements.
Each will have either an IPv6 address or an IPv6 prefix (an address and
a prefix length indicating a CIDR style block of addresses).  The following
statements may occur Within each iaaddr or iaprefix.

<strong>binding state </strong><em>state</em><strong>;</strong>

The <strong>binding state</strong> statement declares the lease's binding state.
In DHCPv6 you will normally see this as <em>active</em> or <em>expired</em>.

<strong>preferred-life </strong><em>lifetime</em><strong>;</strong>

The IPv6 preferred lifetime associated with this address, in seconds.

<strong>max-life </strong><em>lifetime</em><strong>;</strong>

The valid lifetime associated with this address, in seconds.

<strong>ends </strong><em>date</em><strong>;</strong>

The end time of the lease.  See the description of dates in the section on
common structures.

Additional options or executable statements may be included.  See the description
of them in the section on common structures.

</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THE FAILOVER PEER STATE DECLARATION</h2>
        <div class="sectioncontent">
<p>The state of any failover peering arrangements is also recorded in the lease file, using the <strong>failover peer</strong> statement:</p>
<pre>
<strong>failover peer </strong><em>name</em><strong> state {</strong>
<strong>my state </strong><em>state</em><strong> at </strong><em>date</em><strong>;</strong>
<strong>peer state </strong><em>state</em><strong> at </strong><em>date</em><strong>;</strong>
<strong>}</strong>
</pre>
<p>The states of the peer named <em>name</em> is being recorded.   Both the state of the running server (<strong>my state</strong>) and the other failover partner (<em>peer state</em>) are recorded.   The following states are possible: <strong>unknown-state</strong>, <strong>partner-down</strong>, <strong>normal</strong>, <strong>communications-interrupted</strong>, <strong>resolution-interrupted</strong>, <strong>potential-conflict</strong>, <strong>recover</strong>, <strong>recover-done</strong>, <strong>shutdown</strong>, <strong>paused</strong>, and <strong>startup</strong>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p><strong>DBDIR/dhcpd.leases DBDIR/dhcpd.leases~</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO dhcpd.leases&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/dhcpd.8.html"><strong>dhcpd</strong>(8)</a>, <a href="../man5/dhcp-options.5.html"><strong>dhcp-options</strong>(5)</a>, <a href="../man5/dhcp-eval.5.html"><strong>dhcp-eval</strong>(5)</a>, <a href="../man5/dhcpd.conf.5.html"><strong>dhcpd.conf</strong>(5)</a>, RFC2132, RFC2131.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p><a href="../man8/dhcpd.8.html"><strong>dhcpd</strong>(8)</a></strong> is maintained by ISC. Information about Internet Systems Consortium can be found at: <strong>https://www.isc.org/</strong></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="dhcpd.conf.5.html"><span aria-hidden="true">&larr;</span> dhcpd.conf.5: Dhcpd configuration file</a></li>
   <li class="next"><a href="dhcpy6d-clients.conf.5.html">dhcpy6d-clients.conf.5: Clients configuration file for dhcpv6 server dhcpy6d <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
