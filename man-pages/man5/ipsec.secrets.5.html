<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ipsec.secrets: Secrets for ike/ipsec authentication</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Secrets for ike/ipsec authentication">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="ipsec.secrets (5) manual">
  <meta name="twitter:description" content="Secrets for ike/ipsec authentication">
  <meta name="twitter:image" content="https://www.carta.tech/images/strongswan-starter-ipsec.secrets-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/ipsec.secrets.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ipsec.secrets (5) manual" />
  <meta property="og:description" content="Secrets for ike/ipsec authentication" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/strongswan-starter-ipsec.secrets-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">ipsec.secrets<small> (5)</small></h1>
        <p class="lead">Secrets for ike/ipsec authentication</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/ipsec.secrets.5.html">
      <span itemprop="name">ipsec.secrets: Secrets for ike/ipsec authentication</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/strongswan-starter/">
      <span itemprop="name">strongswan-starter</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/ipsec.secrets.5.html">
      <span itemprop="name">ipsec.secrets: Secrets for ike/ipsec authentication</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The file <em>ipsec.secrets</em> holds a table of secrets. These secrets are used by the strongSwan Internet Key Exchange (IKE) daemons pluto (IKEv1) and charon (IKEv2) to authenticate other hosts.</p><p>It is vital that these secrets be protected.  The file should be owned by the super-user, and its permissions should be set to block all access by others.</p><p>The file is a sequence of entries and include directives. Here is an example.</p>
<pre>
# /etc/ipsec.secrets - strongSwan IPsec secrets file
192.168.0.1 %any : PSK "v+NkxY9LLZvwj4qCC2o/gGrWDF2d21jL"

: RSA moonKey.pem

alice@strongswan.org : EAP "x3.dEhgN"

carol : XAUTH "4iChxLT3"

dave  : XAUTH "ryftzG4A"

# get secrets from other files
include ipsec.*.secrets
</pre>
<p>Each entry in the file is a list of optional ID selectors, followed by a secret. The two parts are separated by a colon (<strong>:</strong>) that is surrounded by whitespace. If no ID selectors are specified the line must start with a colon.</p><p>A selector is an IP address, a Fully Qualified Domain Name, user@FQDN, <strong>%any</strong> or <strong>%any6</strong> (other kinds may come).</p><p>Matching IDs with selectors is fairly straightforward: they have to be equal.  In the case of a ``Road Warrior'' connection, if an equal match is not found for the Peer's ID, and it is in the form of an IP address, a selector of <strong>%any</strong> will match the peer's IP address if IPV4 and <strong>%any6</strong> will match a the peer's IP address if IPV6. Currently, the obsolete notation <strong>0.0.0.0</strong> may be used in place of <strong>%any</strong>.</p><p>In IKEv1 an additional complexity arises in the case of authentication by preshared secret: the responder will need to look up the secret before the Peer's ID payload has been decoded, so the ID used will be the IP address.</p><p>To authenticate a connection between two hosts, the entry that most specifically matches the host and peer IDs is used.  An entry with no selectors will match any host and peer.  More specifically, an entry with one selector will match a host and peer if the selector matches the host's ID (the peer isn't considered).  Still more specifically, an entry with multiple selectors will match a host and peer if the host ID and peer ID each match one of the selectors.  If the key is for an asymmetric authentication technique (i.e. a public key system such as RSA), an entry with multiple selectors will match a host and peer even if only the host ID matches a selector (it is presumed that the selectors are all identities of the host). It is acceptable for two entries to be the best match as long as they agree about the secret or private key.</p><p>Authentication by preshared secret requires that both systems find the identical secret (the secret is not actually transmitted by the IKE protocol).  If both the host and peer appear in the selector list, the same entry will be suitable for both systems so verbatim copying between systems can be used.  This naturally extends to larger groups sharing the same secret.  Thus multiple-selector entries are best for PSK authentication.</p><p>Authentication by public key systems such as RSA requires that each host have its own private key.  A host could reasonably use a different private keys for different interfaces and for different peers.  But it would not be normal to share entries between systems.  Thus thus no-selector and one-selector forms of entry often make sense for public key authentication.</p><p>The key part of an entry must start with a token indicating the kind of key.  The following types of secrets are currently supported:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>PSK</strong></p>
  </dt>
  <dd>
    <p>defines a pre-shared key</p>
  </dd>
  <dt>
    <p><strong>RSA</strong></p>
  </dt>
  <dd>
    <p>defines an RSA private key</p>
  </dd>
  <dt>
    <p><strong>ECDSA</strong></p>
  </dt>
  <dd>
    <p>defines an ECDSA private key</p>
  </dd>
  <dt>
    <p><strong>P12</strong></p>
  </dt>
  <dd>
    <p>defines a PKCS#12 container</p>
  </dd>
  <dt>
    <p><strong>EAP</strong></p>
  </dt>
  <dd>
    <p>defines EAP credentials</p>
  </dd>
  <dt>
    <p><strong>NTLM</strong></p>
  </dt>
  <dd>
    <p>defines NTLM credentials</p>
  </dd>
  <dt>
    <p><strong>XAUTH</strong></p>
  </dt>
  <dd>
    <p>defines XAUTH credentials</p>
  </dd>
  <dt>
    <p><strong>PIN</strong></p>
  </dt>
  <dd>
    <p>defines a smartcard PIN</p>
  </dd>

</dl>
<p>Details on each type of secret are given below.</p><p>Whitespace at the end of a line is ignored. At the start of a line or after whitespace, <strong>#</strong> and the following text up to the end of the line is treated as a comment.</p><p>An include directive causes the contents of the named file to be processed before continuing with the current file.  The filename is subject to ``globbing'' as in <em>sh</em>(1), so every file with a matching name is processed.  Includes may be nested to a modest depth (10, currently).  If the filename doesn't start with a <strong>/</strong>, the directory containing the current file is prepended to the name.  The include directive is a line that starts with the word <strong>include</strong>, followed by whitespace, followed by the filename (which must not contain whitespace).</p><h3>TYPES OF SECRETS</h3>

<dl class='dl-vertical'>
  <dt>
    <p><strong>[ &lt;selectors&gt; ] : PSK &lt;secret&gt;</strong></p>
  </dt>
  <dd>
    <p>A preshared <em>secret</em> is most conveniently represented as a sequence of characters, which is delimited by double-quote characters (<strong>"</strong>). The sequence cannot contain newline or double-quote characters.</p><p>Alternatively, preshared secrets can be represented as hexadecimal or Base64 encoded binary values. A character sequence beginning with <strong>0x</strong> is interpreted as sequence of hexadecimal digits. Similarly, a character sequence beginning with <strong>0s</strong> is interpreted as Base64 encoded binary data.</p>
  </dd>
  <dt>
    <p><strong>: RSA &lt;private key file&gt; [ &lt;passphrase&gt; | %prompt ]</strong> <strong>: ECDSA &lt;private key file&gt; [ &lt;passphrase&gt; | %prompt ]</strong></p>
  </dt>
  <dd>
    <p>For the private key file both absolute paths or paths relative to <em>/etc/ipsec.d/private</em> are accepted. If the private key file is encrypted, the <em>passphrase</em> must be defined. Instead of a passphrase <strong>%prompt</strong> can be used which then causes the daemon to ask the user for the password whenever it is required to decrypt the key.</p>
  </dd>
  <dt>
    <p><strong>: P12 &lt;PKCS#12 file&gt; [ &lt;passphrase&gt; | %prompt ]</strong></p>
  </dt>
  <dd>
    <p>For the PKCS#12 file both absolute paths or paths relative to <em>/etc/ipsec.d/private</em> are accepted. If the container is encrypted, the <em>passphrase</em> must be defined. Instead of a passphrase <strong>%prompt</strong> can be used which then causes the daemon to ask the user for the password whenever it is required to decrypt the container. Private keys, client and CA certificates are extracted from the container. To use such a client certificate in a connection set leftid to one of the subjects of the certificate.</p>
  </dd>
  <dt>
    <p><strong>&lt;user id&gt; : EAP &lt;secret&gt;</strong></p>
  </dt>
  <dd>
    <p>The format of <em>secret</em> is the same as that of <strong>PSK</strong> secrets.</p><p><strong>EAP</strong> secrets are IKEv2 only.</p>
  </dd>
  <dt>
    <p><strong>&lt;user id&gt; : NTLM &lt;secret&gt;</strong></p>
  </dt>
  <dd>
    <p>The format of <em>secret</em> is the same as that of <strong>PSK</strong> secrets, but the secret is stored as NTLM hash, which is MD4(UTF-16LE(secret)), instead of as cleartext.</p><p><strong>NTLM</strong> secrets can only be used with the <strong>eap-mschapv2</strong> plugin.</p>
  </dd>
  <dt>
    <p><strong>[ &lt;servername&gt; ] &lt;username&gt; : XAUTH &lt;password&gt;</strong></p>
  </dt>
  <dd>
    <p>The format of <em>password</em> is the same as that of <strong>PSK</strong> secrets. <strong>XAUTH</strong> secrets are IKEv1 only.</p>
  </dd>
  <dt>
    <p><strong>: PIN %smartcard[&lt;slot nr&gt;[@&lt;module&gt;]]:&lt;keyid&gt; &lt;pin code&gt; | %prompt</strong></p>
  </dt>
  <dd>
    <p>The smartcard selector always requires a keyid to uniquely select the correct key. The slot number defines the slot on the token, the module name refers to the module name defined in <a href="../man5/strongswan.conf.5.html"><strong>strongswan.conf</strong>(5)</a>. Instead of specifying the pin code statically, <strong>%prompt</strong> can be specified, which causes the daemon to ask the user for the pin code.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/etc/ipsec.secrets</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO ipsec.secrets&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/ipsec.conf.5.html"><strong>ipsec.conf</strong>(5)</a>, <a href="../man5/strongswan.conf.5.html"><strong>strongswan.conf</strong>(5)</a>, <strong>ipsec</strong>(8)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HISTORY</h2>
        <div class="sectioncontent">
<p>Originally written for the FreeS/WAN project by D. Hugh Redelmeier. Updated and extended for the strongSwan project &lt;http://www.strongswan.org&gt; by Tobias Brunner and Andreas Steffen.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>If an ID is <strong>0.0.0.0</strong>, it will match <strong>%any</strong>; if it is <strong>0::0</strong>, it will match <strong>%any6</strong>.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="ipsec.conf.5.html"><span aria-hidden="true">&larr;</span> ipsec.conf.5: Ipsec configuration and connections</a></li>
   <li class="next"><a href="ipsvd-instruct.5.html">ipsvd-instruct.5: Format of the ipsvd(8) instructions directory <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
