<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>unlang: Freeradius processing un-language</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Freeradius processing un-language">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="unlang (5) manual">
  <meta name="twitter:description" content="Freeradius processing un-language">
  <meta name="twitter:image" content="https://www.carta.tech/images/freeradius-common-unlang-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/unlang.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="unlang (5) manual" />
  <meta property="og:description" content="Freeradius processing un-language" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/freeradius-common-unlang-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">unlang<small> (5)</small></h1>
        <p class="lead">Freeradius processing un-language</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/unlang.5.html">
      <span itemprop="name">unlang: Freeradius processing un-language</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/freeradius-common/">
      <span itemprop="name">freeradius-common</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/unlang.5.html">
      <span itemprop="name">unlang: Freeradius processing un-language</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>FreeRADIUS supports a simple processing language in its configuration files.  We call it an "un-language" because the intention is NOT to create yet another programming language.  If you need something more complicated than what is described here, we suggest using the Perl or Python modules rlm_perl, or rlm_python.</p><p>The goal of the language is to allow simple policies to be written with minimal effort.  Those policies are then applied when a request is being processed.  Requests are processed through virtual servers (including the default one), in the sections titled "authorize", "authenticate", "post-auth", "preacct", "accounting", "pre-proxy", "post-proxy", and "session".</p><p>These policies cannot be used in any other part of the configuration files, such as module or client configuration.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">KEYWORDS</h2>
        <div class="sectioncontent">
<p>The keywords for the language are a combination of pre-defined keywords, and references to loadable module names.  We document only the pre-defined keywords here.</p><p>Subject to a few limitations described below, any keyword can appear in any context.  The language consists of a series of entries, each one one line.  Each entry begins with a keyword.  Entries are organized into lists.  Processing of the language is line by line, from the start of the list to the end.  Actions are executed per-keyword.</p>
<dl class='dl-vertical'>
  <dt>
    module-name
  </dt>
  <dd>
    <p>A reference to the named module.  When processing reaches this point, the pre-compiled module is called.  The module may succeed or fail, and will return a status to "unlang" if so.  This status can be tested in a condition.  See the "Simple Conditions" text in the CONDITIONS section, and MODULE RETURN CODES, below.</p>
<pre>
	chap  # call the CHAP module

	sql   # call the SQL module

	...
</pre>

  </dd>
  <dt>
    if
  </dt>
  <dd>
    <p>Checks for a particular condition.  If true, the block after the condition is processed.  Otherwise, the block is ignored.  See CONDITIONS, below, for documentation on the format of the conditions.</p><p>	if (condition) {</p><p>		...</p><p>	}</p>
  </dd>
  <dt>
    else
  </dt>
  <dd>
    <p>Define a block to be executed only if the previous "if" condition returned false.</p><p>	else {</p><p>		...</p><p>	}</p>
  </dd>
  <dt>
    elsif
  </dt>
  <dd>
    <p>Define a block to be executed only if the previous "if" condition returned false, and if the specified condition evaluates to true.</p><p>	elsif (condition) {</p><p>		...</p><p>	}</p>
  </dd>
  <dt>
    switch
  </dt>
  <dd>
    <p>Evaluate the given string, and choose the first matching "case" statement inside of the current block.  If the string is surrounded by double quotes, it is expanded as described in the DATA TYPES section, below.</p><p>No statement other than "case" can appear in a "switch" block.</p><p>	switch "string" {</p><p>		...</p><p>	}</p>
  </dd>
  <dt>
    case
  </dt>
  <dd>
    <p>Define a static string to match a parent "switch" statement.  The strings given here are not expanded as is done with the parent "switch" statement.</p><p>A "case" statement cannot appear outside of a "switch" block.</p><p>	case string {</p><p>		...</p><p>	}</p><p>A default entry can be defined by omitting the static string.  This entry will be used if no other "case" entry matches.  Only one default entry can exist in a "switch" section.</p><p>	case {</p><p>		...</p><p>	}</p>
  </dd>
  <dt>
    update
  </dt>
  <dd>
    <p>Update a particular attribute list, based on the attributes given in the current block.</p><p>	update &lt;list&gt; {</p><p>		attribute = value</p><p>		...</p><p>	}</p><p>The &lt;list&gt; can be one of "request", "reply", "proxy-request", "proxy-reply", "coa", "disconnect", or "control".  The "control" list is the list of attributes maintainted internally by the server that controls how the server processes the request.  Any attribute that does not go in a packet on the network will generally be placed in the "control" list.</p><p>For backwards compatibility with older versions, "check" is accepted as a synonym for "control".  The use of "check" is deprecated, and will be removed in a future release.</p><p>For EAP methods with tunneled authentication sessions (i.e. PEAP and EAP-TTLS), the inner tunnel session can also reference "outer.request", "outer.reply", and "outer.control".  Those references allow you to address the relevant list in the outer tunnel session.</p><p>The "coa" and "disconnect" sections can only be used when the server receives an Access-Request or Accounting-Request.  Use "request" and "reply" instead of "coa" when the server receives a CoA-Request or Disconnect-Request packet.</p><p>Adding one or more attributes to either of the "coa" or "disconnect" list causes server to originate a CoA-Request or Disconnect-Request packet.  That packet is sent when the current Access-Request or Accounting-Request has been finished, and a reply sent to the NAS. See raddb/sites-available/originate-coa for additional information.</p><p>The only contents permitted in an "update" section are attributes and values.  The contents of the "update" section are described in the ATTRIBUTES section below.</p>
  </dd>
  <dt>
    redundant
  </dt>
  <dd>
    <p>This section contains a simple list of modules.  The first module is called when the section is being processed.  If the first module succeeds in its operation, then the server stops processing the section, and returns to the parent section.</p><p>If, however, the module fails, then the next module in the list is tried, as described above.  The processing continues until one module succeeds, or until the list has been exhausted.</p><p>Redundant sections can contain only a list of modules, and cannot contain keywords that perform conditional operations (if, else, etc) or update an attribute list.</p><p>	redundant {</p><p>		sql1	# try this</p><p>		sql2	# try this only if sql1 fails.</p><p>		...</p><p>	}</p>
  </dd>
  <dt>
    load-balance
  </dt>
  <dd>
    <p>This section contains a simple list of modules.  When the section is entered, one module is chosen at random to process the request.  All of the modules in the list should be the same type (e.g. ldap or sql). All of the modules in the list should behave identically, otherwise the load-balance section will return different results for the same request.</p><p>Load-balance sections can contain only a list of modules, and cannot contain keywords that perform conditional operations (if, else, etc) or update an attribute list.</p><p>	load-balance {</p><p>		ldap1	# 50% of requests go here</p><p>		ldap2	# 50% of requests go here</p><p>	}</p><p>In general, we recommend using "redundant-load-balance" instead of "load-balance".</p>
  </dd>
  <dt>
    redundant-load-balance
  </dt>
  <dd>
    <p>This section contains a simple list of modules.  When the section is entered, one module is chosen at random to process the request.  If that module succeeds, then the server stops processing the section. If, however, the module fails, then one of the remaining modules is chosen at random to process the request.  This process repeats until one module succeeds, or until the list has been exhausted.</p><p>All of the modules in the list should be the same type (e.g. ldap or sql).  All of the modules in the list should behave identically, otherwise the load-balance section will return different results for the same request.</p><p>Load-balance sections can contain only a list of modules, and cannot contain keywords that perform conditional operations (if, else, etc) or update an attribute list.</p><p>	redundant-load-balance {</p><p>		ldap1	# 50%, unless ldap2 is down, then 100%</p><p>		ldap2	# 50%, unless ldap1 is down, then 100%</p><p>	}</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONDITIONS</h2>
        <div class="sectioncontent">
<p>The conditions are similar to C conditions in syntax, though quoted strings are supported, as with the Unix shell.</p>
<dl class='dl-vertical'>
  <dt>
    Simple
  </dt>
  <dd>
    <p>conditions</p><p>	(foo)</p><p>Evalutes to true if 'foo' is a non-empty string (single quotes, double quotes, or back-quoted).  Also evaluates to true if 'foo' is a non-zero number.  Note that the language is poorly typed, so the string "0000" can be interpreted as a numerical zero.  This issue can be avoided by comparings strings to an empty string, rather than by evaluating the string by itself.</p><p>If the word 'foo' is not a quoted string, then it can be taken as a reference to a named attribute.  See "Referencing attribute lists", below, for examples of attribute references.  The condition evaluates to true if the named attribute exists.</p><p>Otherwise, if the word 'foo' is not a quoted string, and is not an attribute reference, then it is interpreted as a reference to a module return code.  The condition evaluates to true if the most recent module return code matches the name given here.  Valid module return codes are given in MODULE RETURN CODES, below.</p>
  </dd>
  <dt>
    Negation
  </dt>
  <dd>
    <p>	(!foo)</p><p>Evalutes to true if 'foo' evaluates to false, and vice-versa.</p>
  </dd>

</dl>
<p>Short-circuit operators</p><p>	(foo || bar)</p><p>	(foo && bar)</p><p>"&&" and "||" are short-circuit operators.  "&&" evaluates the first condition, and evaluates the second condition if and only if the result of the first condition is true.  "||" is similar, but executes the second command if and only if the result of the first condition is false.</p>
<dl class='dl-vertical'>
  <dt>
    Comparisons
  </dt>
  <dd>
    <p>	(foo == bar)</p><p>Compares 'foo' to 'bar', and evaluates to true if the comparison holds true.  Valid comparison operators are "==", "!=", "&lt;", "&lt;=", "&gt;", "&gt;=", "=~", and "!~", all with their usual meanings.  Invalid comparison operators are ":=" and "=".</p>
  </dd>

</dl>
<p>Conditions may be nested to any depth, subject only to line length limitations (8192 bytes).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DATA TYPES</h2>
        <div class="sectioncontent">
<p>There are only a few data types supported in the language.  Reference to attributes, numbers, and strings.  Any data type can appear in stand-alone condition, in which case they are evaluated as described in "Simple conditions", above.  They can also appear (with some exceptions noted below) on the left-hand or on the right-hand side of a comparison.</p>
<dl class='dl-vertical'>
  <dt>
    numbers
  </dt>
  <dd>
    <p>Numbers are composed of decimal digits.  Floating point, hex, and octal numbers are not supported.  The maximum value for a number is machine-dependent, but is usually 32-bits, including one bit for a sign value.</p>
  </dd>

</dl>
<p>word</p><p>Text that is not enclosed in quotes is interpreted differently depending on where it occurs in a condition.  On the left hand side of a condition, it is interpreted as a reference to an attribute.  On the right hand side, it is interpreted as a simple string, in the same manner as a single-quoted string.</p><p>Using attribute references permits limited type-specific comparisons, as seen in the examples below.</p><p>	if (User-Name == "bob") {</p><p>		...</p><p>	if (Framed-IP-Address &gt; 127.0.0.1) {</p><p>		...</p><p>	if (Service-Type == Login-User) {</p><ul>
<li><p>Double-quoted strings are expanded by inserting the value of any variables (see VARIABLES, below) before being evaluated.  If the result is a number it is evaluated in a numerical context.</p><p>String length is limited by line-length, usually about 8000 characters.  A double quote character can be used in a string via the normal back-slash escaping method.  ("like  .RE</p>
<dl class='dl-vertical'>
  <dt>
    'strings'
  </dt>
  <dd>
    <p>Single-quoted strings are evaluated as-is.  Their values are not expanded as with double-quoted strings above, and they are not interpreted as attribute references.</p>
  </dd>
  <dt>
    `strings`
  </dt>
  <dd>
    <p>Back-quoted strings are evaluated by expanding the contents of the string, as described above for double-quoted strings.  The resulting command given inside of the string in a sub-shell, and taking the output as a string.  This behavior is much the same as that of Unix shells.</p><p>Note that for security reasons, the input string is split into command and arguments before variable expansion is done.</p><p>For performance reasons, we suggest that the use of back-quoted strings be kept to a minimum.  Executing external programs is relatively expensive, and executing a large number of programs for every request can quickly use all of the CPU time in a server.  If you believe that you need to execute many programs, we suggest finding alternative ways to achieve the same result.  In some cases, using a real language may be sufficient.</p>
  </dd>
  <dt>
    /regex/i
  </dt>
  <dd>
    <p>These strings are valid only on the right-hand side of a comparison, and then only when the comparison operator is "=~" or "!~".  They are regular expressions, as implemented by the local regular expression library on the system.  This is usually Posix regular expressions.</p><p>The trailing 'i' is optional, and indicates that the regular expression match should be done in a case-insensitive fashion.</p><p>If the comparison operator is "=~", then parantheses in the regular expression will define variables containing the matching text, as described below in the VARIABLES section.</p>
  </dd>

</dl>
</li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">VARIABLES</h2>
        <div class="sectioncontent">
<p>Run-time variables are referenced using the following syntax</p><p>	%{Variable-Name}</p><p>Note that unlike C, there is no way to declare variables, or to refer to them outside of a string context.  All references to variables MUST be contained inside of a double-quoted or back-quoted string.</p><p>Many potential variables are defined in the dictionaries that accompany the server.  These definitions define only the name and type, and do not define the value of the variable.  When the server receives a packet, it uses the packet contents to look up entries in the dictionary, and instantiates variables with a name taken from the dictionaries, and a value taken from the packet contents.  This process means that if a variable does not exist, it is usually because it was not mentioned in a packet that the server received.</p><p>Once the variable is instantiated, it is added to an appropriate attribute list, as described below.  In many cases, attributes and variables are inter-changeble, and are often talked about that way. However, variables can also refer to run-time calls to modules, which may perform operations like SQL SELECTs, and which may return the result as the value of the variable.</p><p>Referencing attribute lists</p><p>Attribute lists may be referenced via the following syntax</p><p>	%{&lt;list&gt;:Attribute-Name}</p><p>Where &lt;list&gt; is one of "request", "reply", "control", "proxy-request", "proxy-reply", or "outer.request", "outer.reply", "outer.control", "outer.proxy-request", or "outer.proxy-reply". just as with the "update" section, above.  The "&lt;list&gt;:" prefix is optional, and if omitted, is assumed to refer to the "request" list.</p><p>When a variable is encountered, the given list is examined for an attribute of the given name.  If found, the variable reference in the string is replaced with the value of that attribute.  Some examples are:</p><p>	%{User-Name}</p><p>	%{request:User-Name} # same as above</p><p>	%{reply:User-Name}</p><p>	%{outer.request:User-Name} # from inside of a TTLS/PEAP tunnel</p><p>Results of regular expression matches</p><p>If a regular expression match has previously been performed, then the special variable %{0} will contain a copy of the input string.  The variables %{1} through %{8} will contain the substring matches, starting from the left-most parantheses, and onwards.  If there are more than 8 parantheses, the additional results will not be placed into any variables.</p><p>Obtaining results from databases</p><p>It is useful to query a database for some information, and to use the result in a condition.  The following syntax will call a module, pass it the given string, and replace the variable reference with the resulting string returned from the module.</p><p>	%{module: string ...}</p><p>The syntax of the string is module-specific.  Please read the module documentation for additional details.</p><p>Conditional Syntax</p><p>Conditional syntax similar to that used in Unix shells may also be used.</p>
<dl class='dl-vertical'>
  <dt>
    %{%{Foo}:-bar}
  </dt>
  <dd>
    <p>If %{Foo} has a value, returns that value.</p><p>Otherwise, returns literal string "bar".</p>
  </dd>
  <dt>
    %{%{Foo}:-%{Bar}}
  </dt>
  <dd>
    <p>If %{Foo} has a value, returns that value.</p><p>Otherwise, returns the expansion of %{Bar}.</p><p>These conditional expansions can be nested to almost any depth, such as with %{%{One}:-%{%{Two}:-%{Three}}}</p>
  </dd>

</dl>
<p>String lengths and arrays</p><p>Similar to a Unix shell, there are ways to reference string lenths, and the second or more instance of an attribute in a list.  If you need this functionality, we recommend using a real language.</p>
<dl class='dl-vertical'>
  <dt>
    %{#string}
  </dt>
  <dd>
    <p>The number of characters in %{string}.  If %{string} is not set, then the length is not set.</p><p>e.g. %{#Junk-junk:-foo} will yeild the string "foo".</p>
  </dd>
  <dt>
    %{Attribute-Name#}
  </dt>
  <dd>
    <p>Will print the integer value of the attribute, rather than a decoded VALUE or date.  This feature applies only to attributes of type "date", "integer", "byte", and "short".  It has no effect on any other attributes.  It is used when the numerical value is needed (e.g. Unix seconds), rather than a humanly-readable string.</p><p>e.g. If a request contains "Service-Type = Login-User", the expansion of %{Service-Type#} will yeild "1".</p>
  </dd>
  <dt>
    %{Attribute-Name[index]}
  </dt>
  <dd>
    <p>Reference the N'th occurance of the given attribute.  The syntax %{&lt;list&gt;:Attribute-Name[index]} may also be used.  The indexes start at zero.  This feature is NOT available for non-attribute dynamic translations, like %{sql:...}.</p><p>For example, %{User-Name[0]} is the same as %{User-Name}</p><p>The variable %{Cisco-AVPair[2]} will reference the value of the THIRD Cisco-AVPair attribute (if it exists) in the request packet,</p>
  </dd>
  <dt>
    %{Attribute-Name[#]}
  </dt>
  <dd>
    <p>Returns the total number of attributes of that name in the relevant attribute list.  The number will usually be between 0 and 200.</p><p>For most requests, %{request:User-Name[#]} == 1</p>
  </dd>
  <dt>
    %{Attribute-Name[*]}
  </dt>
  <dd>
    <p>Expands to a single string, with the value of each array member separated by a newline.</p>
  </dd>
  <dt>
    %{#Attribute-Name[index]}
  </dt>
  <dd>
    <p>Expands to the length of the string %{Attribute-Name[index]}.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ATTRIBUTES</h2>
        <div class="sectioncontent">
<p>The attribute lists described above may be edited by listing one or more attributes in an "update" section.  Once the attributes have been defined, they may be referenced as described above in the VARIABLES section.</p><p>The following syntax defines attributes in an "update" section.  Each attribute and value has to be all on one line in the configuration file.  There is no need for commas or semi-colons after the value.</p><p>	Attribute-Name = value</p><p>Attribute names</p><p>The Attribute-Name must be a name previously defined in a dictionary. If an undefined name is used, the server will return an error, and will not start.</p>
<dl class='dl-vertical'>
  <dt>
    Operators
  </dt>
  <dd>
    <p>The operator used to assign the value of the attribute may be one of the following, with the given meaning.</p>
<dl class='dl-vertical'>
  <dt>
    =
  </dt>
  <dd>
    <p>Add the attribute to the list, if and only if an attribute of the same name is not already present in that list.</p>
  </dd>
  <dt>
    :=
  </dt>
  <dd>
    <p>Add the attribute to the list.  If any attribute of the same name is already present in that list, its value is replaced with the value of the current attribute.</p>
  </dd>
  <dt>
    +=
  </dt>
  <dd>
    <p>Add the attribute to the tail of the list, even if attributes of the same name are already present in the list.</p>
  </dd>

</dl>

  </dd>

</dl>
<p>Enforcement and Filtering Operators</p><p>The following operators may also be used in addition to the ones listed above.  Their function is to perform enforcement or filtering on attributes in a list.</p>
<dl class='dl-vertical'>
  <dt>
    -=
  </dt>
  <dd>
    <p>Remove all matching attributes from the list.  Both the attribute name and value have to match in order for the attribute to be removed from the list.</p>
  </dd>
  <dt>
    ==
  </dt>
  <dd>
    <p>Keep all matching attributes.  Both the attribute name and value have to match in order for the attribute to remain in the list.</p><p>Note that this operator is very different than the '=' operator listed above!</p>
  </dd>
  <dt>
    &lt;=
  </dt>
  <dd>
    <p>Keep all attributes having values less than, or equal to, the value given here.  Any larger value is replaced by the value given here.  If no attribute exists, it is added with the value given here, as with "+=".</p><p>This operator is valid only for attributes of integer type.</p>
  </dd>
  <dt>
    &gt;=
  </dt>
  <dd>
    <p>Keep all attributes having values greater than, or equal to, the value given here.  Any larger value is replaced by the value given here.  If no attribute exists, it is added with the value given here, as with "+=".</p><p>This operator is valid only for attributes of integer type.</p>
  </dd>
  <dt>
    !*
  </dt>
  <dd>
    <p>Delete all occurances of the named attribute, no matter what the value.</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    Values
  </dt>
  <dd>
    <p>The format of the value is attribute-specific, and is usually a string, integer, IP address, etc.  Prior to the attribute being instantiated, the value may be expanded as described above in the DATA TYPES section, above.  This flexibility means that, for example, you can assign an IP address value to an attribute by specifying the IP address directly, or by having the address returned from a database query, or by having the address returned as the output of a program that is executed.</p><p>When string values are finally assigned to a variable, they can have a maximum length of 253 characters.  This limit is due in part to both protocol and internal server requirements.  That is, the strings in the language can be nearly 8k in length, say for a long SQL query. However, the output of that SQL query should be no more than 253 characters in length.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OTHER KEYWORDS</h2>
        <div class="sectioncontent">
<p>Other keywords in the language are taken from the names of modules loaded by the server.  These keywords are dependent on both the modules, and the local configuration.</p><p>Some use keywords that are defined in the default configuration file are:</p>
<dl class='dl-vertical'>
  <dt>
    fail
  </dt>
  <dd>
    <p>Cause the request to be treated as if a database failure had occurred.</p>
  </dd>
  <dt>
    noop
  </dt>
  <dd>
    <p>Do nothing.  This also serves as an instruction to the configurable failover tracking that nothing was done in the current section.</p>
  </dd>
  <dt>
    ok
  </dt>
  <dd>
    <p>Instructs the server that the request was processed properly.  This keyword can be used to over-ride earlier failures, if the local administrator determines that the faiures are not catastrophic.</p>
  </dd>
  <dt>
    reject
  </dt>
  <dd>
    <p>Causes the request to be immediately rejected</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MODULE RETURN CODES</h2>
        <div class="sectioncontent">
<p>When a module is called, it returns one of the following codes to "unlang", with the following meaning.</p><p>	notfound        information was not found</p><p>	noop            the module did nothing</p><p>	ok              the module succeeded</p><p>	updated         the module updated the request</p><p>	fail            the module failed</p><p>	reject          the module rejected the request</p><p>	userlock        the user was locked out</p><p>	invalid         the configuration was invalid</p><p>	handled         the module has handled the request itself</p><p>These return codes can be tested for in a condition, as described above in the CONDITIONS section.</p><p>See also the file doc/configurable_failover for additional methods of trapping and modifying module return codes.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/etc/raddb/radiusd.conf</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO unlang&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man5/radiusd.conf.5.html"><strong>radiusd.conf</strong>(5)</a>, <a href="../man5/dictionary.5.html"><strong>dictionary</strong>(5)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Alan DeKok &lt;aland@deployingradius.com&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="unifont.5.html"><span aria-hidden="true">&larr;</span> unifont.5: A bitmapped font with full unicode plane 0 (bmp) coverage</a></li>
   <li class="next"><a href="up2date.5.html">up2date.5: Configuration file for red hat network client programs. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
