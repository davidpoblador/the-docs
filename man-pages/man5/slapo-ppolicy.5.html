<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>slapo-ppolicy: Password policy overlay to slapd</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Password policy overlay to slapd">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="slapo-ppolicy (5) manual">
  <meta name="twitter:description" content="Password policy overlay to slapd">
  <meta name="twitter:image" content="https://www.carta.tech/images/slapd-slapo-ppolicy-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/slapo-ppolicy.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="slapo-ppolicy (5) manual" />
  <meta property="og:description" content="Password policy overlay to slapd" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/slapd-slapo-ppolicy-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">slapo-ppolicy<small> (5)</small></h1>
        <p class="lead">Password policy overlay to slapd</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/slapo-ppolicy.5.html">
      <span itemprop="name">slapo-ppolicy: Password policy overlay to slapd</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/slapd/">
      <span itemprop="name">slapd</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/slapo-ppolicy.5.html">
      <span itemprop="name">slapo-ppolicy: Password policy overlay to slapd</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p>/etc/ldap/slapd.conf</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <strong>ppolicy</strong> overlay is an implementation of the most recent IETF Password Policy proposal for LDAP.   When instantiated, it intercepts, decodes and applies specific password policy controls to overall use of a backend database, changes to user password fields, etc.</p><p>The overlay provides a variety of password control mechanisms.  They include password aging -- both minimum and maximum ages, password reuse and duplication control, account time-outs, mandatory password resets, acceptable password content, and even grace logins. Different groups of users may be associated with different password policies, and there is no limit to the number of password policies that may be created.</p><p>Note that some of the policies do not take effect when the operation is performed with the <strong>rootdn</strong> identity; all the operations, when performed with any other identity, may be subjected to constraints, like access control.</p><p>Note that the IETF Password Policy proposal for LDAP makes sense when considering a single-valued password attribute, while the userPassword attribute allows multiple values.  This implementation enforces a single value for the userPassword attribute, despite its specification.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION</h2>
        <div class="sectioncontent">
<p>These <strong>slapd.conf</strong> configuration options apply to the ppolicy overlay. They should appear after the <strong>overlay</strong> directive.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>ppolicy_default &lt;policyDN&gt;</strong></p>
  </dt>
  <dd>
    <p>Specify the DN of the pwdPolicy object to use when no specific policy is set on a given user's entry. If there is no specific policy for an entry and no default is given, then no policies will be enforced.</p>
  </dd>
  <dt>
    <p><strong>ppolicy_forward_updates</strong></p>
  </dt>
  <dd>
    <p>Specify that policy state changes that result from Bind operations (such as recording failures, lockout, etc.) on a consumer should be forwarded to a master instead of being written directly into the consumer's local database. This setting is only useful on a replication consumer, and also requires the <strong>updateref</strong> setting and <strong>chain</strong> overlay to be appropriately configured.</p>
  </dd>
  <dt>
    <p><strong>ppolicy_hash_cleartext</strong></p>
  </dt>
  <dd>
    <p>Specify that cleartext passwords present in Add and Modify requests should be hashed before being stored in the database. This violates the X.500/LDAP information model, but may be needed to compensate for LDAP clients that don't use the Password Modify extended operation to manage passwords.  It is recommended that when this option is used that compare, search, and read access be denied to all directory users.</p>
  </dd>
  <dt>
    <p><strong>ppolicy_use_lockout</strong></p>
  </dt>
  <dd>
    <p>A client will always receive an LDAP <strong>InvalidCredentials</strong> response when Binding to a locked account. By default, when a Password Policy control was provided on the Bind request, a Password Policy response will be included with no special error code set. This option changes the Password Policy response to include the <strong>AccountLocked</strong> error code. Note that sending the <strong>AccountLocked</strong> error code provides useful information to an attacker; sites that are sensitive to security issues should not enable this option.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OBJECT CLASS</h2>
        <div class="sectioncontent">
<p>The <strong>ppolicy</strong> overlay depends on the <strong>pwdPolicy</strong> object class.  The definition of that class is as follows:</p><p>(  1.3.6.1.4.1.42.2.27.8.2.1</p>
<pre>
    NAME 'pwdPolicy'
    AUXILIARY
    SUP top
    MUST ( pwdAttribute )
    MAY (
        pwdMinAge $ pwdMaxAge $ pwdInHistory $
        pwdCheckQuality $ pwdMinLength $
        pwdExpireWarning $ pwdGraceAuthnLimit $
        pwdLockout $ pwdLockoutDuration $
        pwdMaxFailure $ pwdFailureCountInterval $
        pwdMustChange $ pwdAllowUserChange $
        pwdSafeModify ) )
</pre>
<p>This implementation also provides an additional <strong>pwdPolicyChecker</strong> objectclass, used for password quality checking (see below).</p><p>(  1.3.6.1.4.1.4754.2.99.1</p>
<pre>
    NAME 'pwdPolicyChecker'
    AUXILIARY
    SUP top
    MAY ( pwdCheckModule ) )
</pre>
<p>Every account that should be subject to password policy control should have a <strong></strong> pwdPolicySubentry attribute containing the DN of a valid <strong>pwdPolicy</strong> entry, or they can simply use the configured default. In this way different users may be managed according to different policies.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OBJECT CLASS ATTRIBUTES</h2>
        <div class="sectioncontent">
<p>Each one of the sections below details the meaning and use of a particular attribute of this <strong>pwdPolicy</strong> object class.</p><p><strong>pwdAttribute</strong></p><p>This attribute contains the name of the attribute to which the password policy is applied. For example, the password policy may be applied to the <strong>userPassword</strong> attribute.</p><p>Note: in this implementation, the only value accepted for <strong>pwdAttribute</strong> is <em> userPassword </em>.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.1</p>
<pre>
   NAME 'pwdAttribute'
   EQUALITY objectIdentifierMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.38 )
</pre>
<p><strong>pwdMinAge</strong></p><p>This attribute contains the number of seconds that must elapse between modifications allowed to the password. If this attribute is not present, zero seconds is assumed (i.e. the password may be modified whenever and however often is desired).</p><p>(  1.3.6.1.4.1.42.2.27.8.1.2</p>
<pre>
   NAME 'pwdMinAge'
   EQUALITY integerMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE )
</pre>
<p><strong>pwdMaxAge</strong></p><p>This attribute contains the number of seconds after which a modified password will expire.  If this attribute is not present, or if its value is zero (0), then passwords will not expire.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.3</p>
<pre>
   NAME 'pwdMaxAge'
   EQUALITY integerMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE )
</pre>
<p><strong>pwdInHistory</strong></p><p>This attribute is used to specify the maximum number of used passwords that will be stored in the <strong>pwdHistory</strong> attribute.  If the <strong>pwdInHistory</strong> attribute is not present, or if its value is zero (0), used passwords will not be stored in <strong>pwdHistory</strong> and thus any previously-used password may be reused. No history checking occurs if the password is being modified by the <strong>rootdn</strong>, although the password is saved in the history.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.4</p>
<pre>
   NAME 'pwdInHistory'
   EQUALITY integerMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE )
</pre>
<p><strong>pwdCheckQuality</strong></p><p>This attribute indicates if and how password syntax will be checked while a password is being modified or added. If this attribute is not present, or its value is zero (0), no syntax checking will be done. If its value is one (1), the server will check the syntax, and if the server is unable to check the syntax, whether due to a client-side hashed password or some other reason, it will be accepted. If its value is two (2), the server will check the syntax, and if the server is unable to check the syntax it will return an error refusing the password.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.5</p>
<pre>
   NAME 'pwdCheckQuality'
   EQUALITY integerMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE )
</pre>
<p><strong>pwdMinLength</strong></p><p>When syntax checking is enabled (see also the <strong>pwdCheckQuality</strong> attribute), this attribute contains the minimum number of characters that will be accepted in a password. If this attribute is not present, minimum password length is not enforced. If the server is unable to check the length of the password, whether due to a client-side hashed password or some other reason, the server will, depending on the value of <strong>pwdCheckQuality</strong>, either accept the password without checking it (if <strong>pwdCheckQuality</strong> is zero (0) or one (1)) or refuse it (if <strong>pwdCheckQuality</strong> is two (2)).</p><p>(  1.3.6.1.4.1.42.2.27.8.1.6</p>
<pre>
   NAME 'pwdMinLength'
   EQUALITY integerMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE )
</pre>
<p><strong>pwdExpireWarning</strong></p><p>This attribute contains the maximum number of seconds before a password is due to expire that expiration warning messages will be returned to a user who is authenticating to the directory. If this attribute is not present, or if the value is zero (0), no warnings will be sent.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.7</p>
<pre>
   NAME 'pwdExpireWarning'
   EQUALITY integerMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE )
</pre>
<p><strong>pwdGraceAuthnLimit</strong></p><p>This attribute contains the number of times that an expired password may be used to authenticate a user to the directory. If this attribute is not present or if its value is zero (0), users with expired passwords will not be allowed to authenticate to the directory.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.8</p>
<pre>
   NAME 'pwdGraceAuthnLimit'
   EQUALITY integerMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE )
</pre>
<p><strong>pwdLockout</strong></p><p>This attribute specifies the action that should be taken by the directory when a user has made a number of failed attempts to authenticate to the directory.  If <strong>pwdLockout</strong> is set (its value is "TRUE"), the user will not be allowed to attempt to authenticate to the directory after there have been a specified number of consecutive failed bind attempts.  The maximum number of consecutive failed bind attempts allowed is specified by the <strong>pwdMaxFailure</strong> attribute.  If <strong>pwdLockout</strong> is not present, or if its value is "FALSE", the password may be used to authenticate no matter how many consecutive failed bind attempts have been made.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.9</p>
<pre>
   NAME 'pwdLockout'
   EQUALITY booleanMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.7
   SINGLE-VALUE )
</pre>
<p><strong>pwdLockoutDuration</strong></p><p>This attribute contains the number of seconds during which the password cannot be used to authenticate the user to the directory due to too many consecutive failed bind attempts. (See also <strong>pwdLockout</strong> and <strong>pwdMaxFailure</strong>.) If <strong>pwdLockoutDuration</strong> is not present, or if its value is zero (0), the password cannot be used to authenticate the user to the directory again until it is reset by an administrator.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.10</p>
<pre>
   NAME 'pwdLockoutDuration'
   EQUALITY integerMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE )
</pre>
<p><strong>pwdMaxFailure</strong></p><p>This attribute contains the number of consecutive failed bind attempts after which the password may not be used to authenticate a user to the directory. If <strong>pwdMaxFailure</strong> is not present, or its value is zero (0), then a user will be allowed to continue to attempt to authenticate to the directory, no matter how many consecutive failed bind attempts have occurred with that user's DN. (See also <strong>pwdLockout</strong> and <strong>pwdLockoutDuration</strong>.)</p><p>(  1.3.6.1.4.1.42.2.27.8.1.11</p>
<pre>
   NAME 'pwdMaxFailure'
   EQUALITY integerMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE )
</pre>
<p><strong>pwdFailureCountInterval</strong></p><p>This attribute contains the number of seconds after which old consecutive failed bind attempts are purged from the failure counter, even though no successful authentication has occurred. If <strong>pwdFailureCountInterval</strong> is not present, or its value is zero (0), the failure counter will only be reset by a successful authentication.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.12</p>
<pre>
   NAME 'pwdFailureCountInterval'
   EQUALITY integerMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE )
</pre>
<p><strong>pwdMustChange</strong></p><p>This attribute specifies whether users must change their passwords when they first bind to the directory after a password is set or reset by the administrator, or not.  If <strong>pwdMustChange</strong> has a value of "TRUE", users must change their passwords when they first bind to the directory after a password is set or reset by the administrator.  If <strong>pwdMustChange</strong> is not present, or its value is "FALSE", users are not required to change their password upon binding after the administrator sets or resets the password.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.13</p>
<pre>
  NAME 'pwdMustChange'
  EQUALITY booleanMatch
  SYNTAX 1.3.6.1.4.1.1466.115.121.1.7
  SINGLE-VALUE )
</pre>
<p><strong>pwdAllowUserChange</strong></p><p>This attribute specifies whether users are allowed to change their own passwords or not.  If <strong>pwdAllowUserChange</strong> is set to "TRUE", or if the attribute is not present, users will be allowed to change their own passwords.  If its value is "FALSE", users will not be allowed to change their own passwords.</p><p>Note: this implies that when <strong>pwdAllowUserChange</strong> is set to "TRUE", users will still be able to change the password of another user, subjected to access control. This restriction only applies to modifications of ones's own password. It should also be noted that <strong>pwdAllowUserChange</strong> was defined in the specification to provide rough access control to the password attribute in implementations that do not allow fine-grain access control. Since OpenLDAP provides fine-grain access control, the use of this attribute is discouraged; ACLs should be used instead (see <a href="../man5/slapd.access.5.html"><strong>slapd.access</strong>(5)</a> for details).</p><p>(  1.3.6.1.4.1.42.2.27.8.1.14</p>
<pre>
   NAME 'pwdAllowUserChange'
   EQUALITY booleanMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.7
   SINGLE-VALUE )
</pre>
<p><strong>pwdSafeModify</strong></p><p>This attribute denotes whether the user's existing password must be sent along with their new password when changing a password.  If <strong>pwdSafeModify</strong> is set to "TRUE", the existing password must be sent along with the new password.  If the attribute is not present, or its value is "FALSE", the existing password need not be sent along with the new password.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.15</p>
<pre>
   NAME 'pwdSafeModify'
   EQUALITY booleanMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.7
   SINGLE-VALUE )
</pre>
<p><strong>pwdCheckModule</strong></p><p>This attribute names a user-defined loadable module that must instantiate the check_password() function.  This function will be called to further check a new password if <strong>pwdCheckQuality</strong> is set to one (1) or two (2), after all of the built-in password compliance checks have been passed.  This function will be called according to this function prototype:</p><p>int <em>check_password</em> (char *pPasswd, char **ppErrStr, Entry *pEntry);</p><p>The <strong>pPasswd</strong> parameter contains the clear-text user password, the <strong>ppErrStr</strong> parameter contains a double pointer that allows the function to return human-readable details about any error it encounters. The optional <strong>pEntry</strong> parameter, if non-NULL, carries a pointer to the entry whose password is being checked. If <strong>ppErrStr</strong> is NULL, then <em>funcName</em> must NOT attempt to use it/them. A return value of LDAP_SUCCESS from the called function indicates that the password is ok, any other value indicates that the password is unacceptable.  If the password is unacceptable, the server will return an error to the client, and <strong>ppErrStr</strong> may be used to return a human-readable textual explanation of the error. The error string must be dynamically allocated as it will be free()'d by slapd.</p><p>(  1.3.6.1.4.1.4754.1.99.1</p>
<pre>
   NAME 'pwdCheckModule'
   EQUALITY caseExactIA5Match
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.26
   SINGLE-VALUE )
</pre>
<p>Note: The user-defined loadable module named by <strong>pwdCheckModule</strong> must be in <strong>slapd's</strong> standard executable search PATH.</p><p>Note: <strong>pwdCheckModule</strong> is a non-standard extension to the LDAP password policy proposal.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPERATIONAL ATTRIBUTES</h2>
        <div class="sectioncontent">
<p>The operational attributes used by the <strong>ppolicy</strong> module are stored in the user's entry.  Most of these attributes are not intended to be changed directly by users; they are there to track user activity.  They have been detailed here so that administrators and users can both understand the workings of the <strong>ppolicy</strong> module.</p><p>Note that the current IETF Password Policy proposal does not define how these operational attributes are expected to behave in a replication environment. In general, authentication attempts on a slave server only affect the copy of the operational attributes on that slave and will not affect any attributes for a user's entry on the master server. Operational attribute changes resulting from authentication attempts on a master server will usually replicate to the slaves (and also overwrite any changes that originated on the slave). These behaviors are not guaranteed and are subject to change when a formal specification emerges.</p><p><strong>userPassword</strong></p><p>The <strong>userPassword</strong> attribute is not strictly part of the <strong>ppolicy</strong> module.  It is, however, the attribute that is tracked and controlled by the module.  Please refer to the standard OpenLDAP schema for its definition.</p><p><strong>pwdPolicySubentry</strong></p><p>This attribute refers directly to the <strong>pwdPolicy</strong> subentry that is to be used for this particular directory user. If <strong>pwdPolicySubentry</strong> exists, it must contain the DN of a valid <strong>pwdPolicy</strong> object.  If it does not exist, the <strong>ppolicy</strong> module will enforce the default password policy rules on the user associated with this authenticating DN. If there is no default, or the referenced subentry does not exist, then no policy rules will be enforced.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.23</p>
<pre>
   NAME 'pwdPolicySubentry'
   DESC 'The pwdPolicy subentry in effect for
       this object'
   EQUALITY distinguishedNameMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.12
   SINGLE-VALUE
   NO-USER-MODIFICATION
   USAGE directoryOperation)
</pre>
<p><strong>pwdChangedTime</strong></p><p>This attribute denotes the last time that the entry's password was changed.  This value is used by the password expiration policy to determine whether the password is too old to be allowed to be used for user authentication.  If <strong>pwdChangedTime</strong> does not exist, the user's password will not expire.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.16</p>
<pre>
   NAME 'pwdChangedTime'
   DESC 'The time the password was last changed'
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.24
   EQUALITY generalizedTimeMatch
   ORDERING generalizedTimeOrderingMatch
   SINGLE-VALUE
   NO-USER-MODIFICATION
   USAGE directoryOperation)
</pre>
<p><strong>pwdAccountLockedTime</strong></p><p>This attribute contains the time that the user's account was locked. If the account has been locked, the password may no longer be used to authenticate the user to the directory.  If <strong>pwdAccountLockedTime</strong> is set to 000001010000Z, the user's account has been permanently locked and may only be unlocked by an administrator. Note that account locking only takes effect when the <strong>pwdLockout</strong> password policy attribute is set to "TRUE".</p><p>(  1.3.6.1.4.1.42.2.27.8.1.17</p>
<pre>
   NAME 'pwdAccountLockedTime'
   DESC 'The time an user account was locked'
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.24
   EQUALITY generalizedTimeMatch
   ORDERING generalizedTimeOrderingMatch
   SINGLE-VALUE
   NO-USER-MODIFICATION
   USAGE directoryOperation)
</pre>
<p><strong>pwdFailureTime</strong></p><p>This attribute contains the timestamps of each of the consecutive authentication failures made upon attempted authentication to this DN (i.e. account).  If too many timestamps accumulate here (refer to the <strong>pwdMaxFailure</strong> password policy attribute for details), and the <strong>pwdLockout</strong> password policy attribute is set to "TRUE", the account may be locked. (Please also refer to the <strong>pwdLockout</strong> password policy attribute.) Excess timestamps beyond those allowed by <strong>pwdMaxFailure</strong> may also be purged.  If a successful authentication is made to this DN (i.e. to this user account), then <strong>pwdFailureTime</strong> will be cleansed of entries.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.19</p>
<pre>
   NAME 'pwdFailureTime'
   DESC 'The timestamps of the last consecutive
       authentication failures'
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.24
   EQUALITY generalizedTimeMatch
   ORDERING generalizedTimeOrderingMatch
   NO-USER-MODIFICATION
   USAGE directoryOperation )
</pre>
<p><strong>pwdHistory</strong></p><p>This attribute contains the history of previously used passwords for this DN (i.e. for this user account). The values of this attribute are stored in string format as follows:</p><p>pwdHistory=</p><p>time "#" syntaxOID "#" length "#" data</p><p>time=</p><p>GeneralizedTime as specified in section 3.3.13 of [RFC4517]</p><p>syntaxOID = numericoid</p><p>This is the string representation of the dotted-decimal OID that defines the syntax used to store the password.  numericoid is described in section 1.4 of [RFC4512].</p><p>length = NumericString</p><p>The number of octets in the data.  NumericString is described in section 3.3.23 of [RFC4517].</p><p>data =</p><p>Octets representing the password in the format specified by syntaxOID.</p><p>This format allows the server to store and transmit a history of passwords that have been used.  In order for equality matching on the values in this attribute to function properly, the time field is in GMT format.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.20</p>
<pre>
   NAME 'pwdHistory'
   DESC 'The history of user passwords'
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
   EQUALITY octetStringMatch
   NO-USER-MODIFICATION
   USAGE directoryOperation)
</pre>
<p><strong>pwdGraceUseTime</strong> This attribute contains the list of timestamps of logins made after the user password in the DN has expired.  These post-expiration logins are known as "<em>grace logins</em>". If too many <em>grace logins</em> have been used (please refer to the <strong>pwdGraceLoginLimit</strong> password policy attribute), then the DN will no longer be allowed to be used to authenticate the user to the directory until the administrator changes the DN's <strong>userPassword</strong> attribute.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.21</p>
<pre>
   NAME 'pwdGraceUseTime'
   DESC 'The timestamps of the grace login once the password has expired'
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.24
   EQUALITY generalizedTimeMatch
   NO-USER-MODIFICATION
   USAGE directoryOperation)
</pre>
<p><strong>pwdReset</strong></p><p>This attribute indicates whether the user's password has been reset by the administrator and thus must be changed upon first use of this DN for authentication to the directory.  If <strong>pwdReset</strong> is set to "TRUE", then the password was reset and the user must change it upon first authentication.  If the attribute does not exist, or is set to "FALSE", the user need not change their password due to administrative reset.</p><p>(  1.3.6.1.4.1.42.2.27.8.1.22</p>
<pre>
   NAME 'pwdReset'
   DESC 'The indication that the password has
       been reset'
   EQUALITY booleanMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.7
   SINGLE-VALUE
   USAGE directoryOperation)
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">

<pre>
database bdb
suffix dc=example,dc=com
\|...
overlay ppolicy
ppolicy_default "cn=Standard,ou=Policies,dc=example,dc=com"
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO slapo-ppolicy&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man3/ldap.3.html"><strong>ldap</strong>(3)</a>, <a href="../man5/slapd.conf.5.html"><strong>slapd.conf</strong>(5)</a>, <a href="../man5/slapd-config.5.html"><strong>slapd-config</strong>(5)</a>, <a href="../man5/slapo-chain.5.html"><strong>slapo-chain</strong>(5)</a>.</p><p>"OpenLDAP Administrator's Guide" (http://www.OpenLDAP.org/doc/admin/)</p><p>IETF LDAP password policy proposal by P. Behera, L.  Poitou and J. Sermersheim:  documented in IETF document "draft-behera-ldap-password-policy-09.txt".</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>The LDAP Password Policy specification is not yet an approved standard, and it is still evolving. This code will continue to be in flux until the specification is finalized.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ACKNOWLEDGEMENTS</h2>
        <div class="sectioncontent">
<p>This module was written in 2004 by Howard Chu of Symas Corporation with significant input from Neil Dunbar and Kartik Subbarao of Hewlett-Packard.</p><p>This manual page borrows heavily and shamelessly from the specification upon which the password policy module it describes is based.  This source is the IETF LDAP password policy proposal by P. Behera, L. Poitou and J. Sermersheim. The proposal is fully documented in the IETF document named draft-behera-ldap-password-policy-09.txt, written in July of 2005.</p><p><strong>OpenLDAP Software</strong> is developed and maintained by The OpenLDAP Project &lt;http://www.openldap.org/&gt;. <strong>OpenLDAP Software</strong> is derived from University of Michigan LDAP 3.3 Release.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="slapo-pcache.5.html"><span aria-hidden="true">&larr;</span> slapo-pcache.5: Proxy cache overlay to slapd</a></li>
   <li class="next"><a href="slapo-refint.5.html">slapo-refint.5: Referential integrity overlay to slapd <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
