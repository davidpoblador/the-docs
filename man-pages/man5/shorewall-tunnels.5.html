<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>shorewall-tunnels: Shorewall vpn definition file</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Shorewall vpn definition file">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="shorewall-tunnels (5) manual">
  <meta name="twitter:description" content="Shorewall vpn definition file">
  <meta name="twitter:image" content="https://www.carta.tech/images/shorewall-shorewall-tunnels-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/shorewall-tunnels.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="shorewall-tunnels (5) manual" />
  <meta property="og:description" content="Shorewall vpn definition file" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/shorewall-shorewall-tunnels-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">shorewall-tunnels<small> (5)</small></h1>
        <p class="lead">Shorewall vpn definition file</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/shorewall-tunnels.5.html">
      <span itemprop="name">shorewall-tunnels: Shorewall vpn definition file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/shorewall/">
      <span itemprop="name">shorewall</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/shorewall-tunnels.5.html">
      <span itemprop="name">shorewall-tunnels: Shorewall vpn definition file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>/etc/shorewall/tunnels</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The tunnels file is used to define rules for encapsulated (usually encrypted) traffic to pass between the Shorewall system and a remote gateway. Traffic flowing through the tunnel is handled using the normal zone/policy/rule mechanism. See \m[blue]<strong>http://www.shorewall.net/VPNBasics.html</strong>\m[]\s-2\u[1]\d\s+2 for details.</p><p>The columns in the file are as follows.</p><p><strong>TYPE</strong> - {<strong>ipsec</strong>[<strong>:{noah</strong>|ah}]|<strong>ipsecnat</strong>|<strong>ipip</strong>|<strong>gre</strong>|l2tp|<strong>pptpclient</strong>|<strong>pptpserver</strong>|[?]COMMENT|{<strong>openvpn</strong>|<strong>openvpnclient</strong>|<strong>openvpnserver</strong>}[:{<strong>tcp</strong>|<strong>udp</strong>}]<strong>[</strong>:<em>port</em>]|<strong>generic</strong><strong>:</strong><em>protocol</em>[<strong>:</strong><em>port</em>]}</p><p>Types are as follows:</p>
<pre>
        <strong>6to4</strong> or <strong>6in4</strong>  - 6to4 or 6in4 tunnel. The <strong>6in4</strong> synonym was added in 4.4.24.
        <strong>ipsec</strong>         - IPv4 IPSEC
        <strong>ipsecnat</strong>      - IPv4 IPSEC with NAT Traversal (UDP port 4500 encapsulation)
        <strong>ipip</strong>          - IPv4 encapsulated in IPv4 (Protocol 4)
        <strong>gre</strong>           - Generalized Routing Encapsulation (Protocol 47)
        <strong>l2tp</strong>          - Layer 2 Tunneling Protocol (UDP port 1701)
        <strong>pptpclient</strong>    - PPTP Client runs on the firewall
        <strong>pptpserver</strong>    - PPTP Server runs on the firewall
        <strong>openvpn</strong>       - OpenVPN in point-to-point mode
        <strong>openvpnclient</strong> - OpenVPN client runs on the firewall
        <strong>openvpnserver</strong> - OpenVPN server runs on the firewall
        <strong>generic</strong>       - Other tunnel type
</pre>
<p>If the type is <strong>ipsec</strong>, it may be followed by <strong>:ah</strong> to indicate that the Authentication Headers protocol (51) is used by the tunnel (the default is <strong>:noah</strong> which means that protocol 51 is not used). NAT traversal is only supported with ESP (protocol 50) so <strong>ipsecnat</strong> tunnels don&apos;t allow the <strong>ah</strong> option (<strong>ipsecnat:noah</strong> may be specified but is redundant).</p><p>If type is <strong>openvpn</strong>, <strong>openvpnclient</strong> or <strong>openvpnserver</strong> it may optionally be followed by ":" and <strong>tcp</strong> or <strong>udp</strong> to specify the protocol to be used. If not specified, <strong>udp</strong> is assumed.</p><p>If type is <strong>openvpn</strong>, <strong>openvpnclient</strong> or <strong>openvpnserver</strong> it may optionally be followed by ":" and the port number used by the tunnel. if no ":" and port number are included, then the default port of 1194 will be used. . Where both the protocol and port are specified, the protocol must be given first (e.g., openvpn:tcp:4444).</p><p>If type is <strong>generic</strong>, it must be followed by ":" and a protocol name (from /etc/protocols) or a protocol number. If the protocol is <strong>tcp</strong> or <strong>udp</strong> (6 or 17), then it may optionally be followed by ":" and a port number.</p><p>Comments may be attached to Netfilter rules generated from entries in this file through the use of COMMENT lines. These lines begin with the word COMMENT; the remainder of the line is treated as a comment which is attached to subsequent rules until another COMMENT line is found or until the end of the file is reached. To stop adding comments to rules, use a line with only the word COMMENT.</p><p><strong>Note</strong></p><p>Beginning with Shorewall 4.5.11, ?COMMENT is a synonym for COMMENT and is preferred.</p><p><strong>ZONE</strong> - <em>zone</em></p><p>The <em>zone</em> of the physical interface through which tunnel traffic passes. This is normally your internet zone.</p><p><strong>GATEWAY</strong>(S) (gateway or gateways) - <em>address-or-range</em> <strong>[ , ... ]</strong></p><p>The IP address of the remote tunnel gateway. If the remote gateway has no fixed address (Road Warrior) then specify the gateway as <strong>0.0.0.0/0</strong>. May be specified as a network address and if your kernel and iptables include iprange match support then IP address ranges are also allowed.</p><p>Beginning with Shorewall 4.5.3, a list of addresses or ranges may be given. Exclusion (\m[blue]<strong>shorewall-exclusion</strong>\m[]\s-2\u[2]\d\s+2 (5) ) is not supported.</p><p><strong>GATEWAY ZONES</strong> (gateway_zone or gateway_zones) - [<em>zone</em>[<strong>,</strong><em>zone</em>]...]</p><p>Optional. If the gateway system specified in the third column is a standalone host then this column should contain a comma-separated list of the names of the zones that the host might be in. This column only applies to IPSEC tunnels where it enables ISAKMP traffic to flow through the tunnel to the remote gateway(s).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>Example 1:</p><p>IPSec tunnel.</p><p>The remote gateway is 4.33.99.124 and the remote subnet is 192.168.9.0/24. The tunnel does not use the AH protocol</p>
<pre>
        #TYPE           ZONE    GATEWAY
        ipsec:noah      net     4.33.99.124
</pre>
<p>Example 2:</p><p>Road Warrior (LapTop that may connect from anywhere) where the "gw" zone is used to represent the remote LapTop</p>
<pre>
        #TYPE           ZONE    GATEWAY         GATEWAY ZONES
        ipsec           net     0.0.0.0/0       gw
</pre>
<p>Example 3:</p><p>Host 4.33.99.124 is a standalone system connected via an ipsec tunnel to the firewall system. The host is in zone gw.</p>
<pre>
        #TYPE           ZONE    GATEWAY         GATEWAY ZONES
        ipsec           net     4.33.99.124     gw
</pre>
<p>Example 4:</p><p>Road Warriors that may belong to zones vpn1, vpn2 or vpn3. The FreeS/Wan _updown script will add the host to the appropriate zone using the <strong>shorewall add</strong> command on connect and will remove the host from the zone at disconnect time.</p>
<pre>
        #TYPE           ZONE    GATEWAY         GATEWAY ZONES
        ipsec           net     0.0.0.0/0       vpn1,vpn2,vpn3
</pre>
<p>Example 5:</p><p>You run the Linux PPTP client on your firewall and connect to server 192.0.2.221.</p>
<pre>
        #TYPE           ZONE    GATEWAY         GATEWAY ZONES
        pptpclient      net     192.0.2.221
</pre>
<p>Example 6:</p><p>You run a PPTP server on your firewall.</p>
<pre>
        #TYPE           ZONE    GATEWAY         GATEWAY ZONES
        pptpserver      net     0.0.0.0/0
</pre>
<p>Example 7:</p><p>OPENVPN tunnel. The remote gateway is 4.33.99.124 and openvpn uses port 7777.</p>
<pre>
        #TYPE           ZONE    GATEWAY         GATEWAY ZONES
        openvpn:7777    net     4.33.99.124
</pre>
<p>Example 8:</p><p>You have a tunnel that is not one of the supported types. Your tunnel uses UDP port 4444. The other end of the tunnel is 4.3.99.124.</p>
<pre>
        #TYPE            ZONE    GATEWAY         GATEWAY ZONES
        generic:udp:4444 net     4.3.99.124
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/etc/shorewall/tunnels</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO shorewall-tunnels&hellip;</h2>
        <div class="sectioncontent">
<p>\m[blue]<strong>http://www.shorewall.net/configuration_file_basics.htm#Pairs</strong>\m[]\s-2\u[3]\d\s+2</p><p><strong>shorewall</strong>(8), <a href="../man5/shorewall-accounting.5.html"><strong>shorewall-accounting</strong>(5)</a>, <a href="../man5/shorewall-actions.5.html"><strong>shorewall-actions</strong>(5)</a>, <a href="../man5/shorewall-blacklist.5.html"><strong>shorewall-blacklist</strong>(5)</a>, <a href="../man5/shorewall-hosts.5.html"><strong>shorewall-hosts</strong>(5)</a>, <strong>shorewall_interfaces</strong>(5), <a href="../man5/shorewall-ipsets.5.html"><strong>shorewall-ipsets</strong>(5)</a>, <a href="../man5/shorewall-maclist.5.html"><strong>shorewall-maclist</strong>(5)</a>, <a href="../man5/shorewall-masq.5.html"><strong>shorewall-masq</strong>(5)</a>, <a href="../man5/shorewall-nat.5.html"><strong>shorewall-nat</strong>(5)</a>, <a href="../man5/shorewall-netmap.5.html"><strong>shorewall-netmap</strong>(5)</a>, <a href="../man5/shorewall-params.5.html"><strong>shorewall-params</strong>(5)</a>, <a href="../man5/shorewall-policy.5.html"><strong>shorewall-policy</strong>(5)</a>, <a href="../man5/shorewall-providers.5.html"><strong>shorewall-providers</strong>(5)</a>, <a href="../man5/shorewall-proxyarp.5.html"><strong>shorewall-proxyarp</strong>(5)</a>, <a href="../man5/shorewall-rtrules.5.html"><strong>shorewall-rtrules</strong>(5)</a>, <a href="../man5/shorewall-routestopped.5.html"><strong>shorewall-routestopped</strong>(5)</a>, <a href="../man5/shorewall-rules.5.html"><strong>shorewall-rules</strong>(5)</a>, <strong>shorewall.conf</strong>(5), <a href="../man5/shorewall-secmarks.5.html"><strong>shorewall-secmarks</strong>(5)</a>, <a href="../man5/shorewall-tcclasses.5.html"><strong>shorewall-tcclasses</strong>(5)</a>, <a href="../man5/shorewall-tcdevices.5.html"><strong>shorewall-tcdevices</strong>(5)</a>, <a href="../man5/shorewall-mangle.5.html"><strong>shorewall-mangle</strong>(5)</a>, <a href="../man5/shorewall-tos.5.html"><strong>shorewall-tos</strong>(5)</a>, <a href="../man5/shorewall-zones.5.html"><strong>shorewall-zones</strong>(5)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
     1.
  </dt>
  <dd>
    <p>http://www.shorewall.net/VPNBasics.html</p><p>http://www.shorewall.net/VPNBasics.html</p>
  </dd>
  <dt>
     2.
  </dt>
  <dd>
    <p>shorewall-exclusion</p><p>http://www.shorewall.net/manpages/shorewall-exclusion.html</p>
  </dd>
  <dt>
     3.
  </dt>
  <dd>
    <p>http://www.shorewall.net/configuration_file_basics.htm#Pairs</p><p>http://www.shorewall.net/configuration_file_basics.htm#Pairs</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="shorewall-tos.5.html"><span aria-hidden="true">&larr;</span> shorewall-tos.5: Shorewall type of service rules file</a></li>
   <li class="next"><a href="shorewall-vardir.5.html">shorewall-vardir.5: Shorewall file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
