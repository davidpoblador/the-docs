<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pam_krb5: Kerberos pam module</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Kerberos pam module">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="pam_krb5 (5) manual">
  <meta name="twitter:description" content="Kerberos pam module">
  <meta name="twitter:image" content="https://www.carta.tech/images/libpam-heimdal-pam_krb5-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/libpam-heimdal-pam_krb5.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="pam_krb5 (5) manual" />
  <meta property="og:description" content="Kerberos pam module" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/libpam-heimdal-pam_krb5-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">pam_krb5<small> (5)</small></h1>
        <p class="lead">Kerberos pam module</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/pam_krb5.5.html">
      <span itemprop="name">pam_krb5: Kerberos pam module</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/libpam-heimdal/">
      <span itemprop="name">libpam-heimdal</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/pam_krb5.5.html">
      <span itemprop="name">pam_krb5: Kerberos pam module</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<pre>
  auth            sufficient      pam_krb5.so minimum_uid=1000
  session         required        pam_krb5.so minimum_uid=1000
  account         required        pam_krb5.so minimum_uid=1000
  password        sufficient      pam_krb5.so minimum_uid=1000
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The Kerberos service module for \s-1PAM\s0, typically installed at <em>/lib/security/pam_krb5.so</em>, provides functionality for the four \s-1PAM\s0 operations: authentication, account management, session management, and password management.  <em>pam_krb5.so</em> is a shared object that is dynamically loaded by the \s-1PAM\s0 subsystem as necessary, based on the system \s-1PAM\s0 configuration.  \s-1PAM\s0 is a system for plugging in external authentication and session management modules so that each application doesn't have to know the best way to check user authentication or create a user session on that system.  For details on how to configure \s-1PAM\s0 on your system, see the \s-1PAM\s0 man page, often <em>pam</em>\|(7).</p><p>Here are the actions of this module when called from each group:</p>
<dl class='dl-vertical'>
  <dt>
    auth
  </dt>
  <dd>
    <p>Provides implementations of <em>pam_authenticate()</em> and <em>pam_setcred()</em>.  The former takes the username from the \s-1PAM\s0 session, prompts for the user's password (unless configured to use an already-entered password), and then performs a Kerberos initial authentication, storing the obtained credentials (if successful) in a temporary ticket cache.  The latter, depending on the flags it is called with, either takes the contents of the temporary ticket cache and writes it out to a persistent ticket cache owned by the user or uses the temporary ticket cache to refresh an existing user ticket cache. After doing the initial authentication, the Kerberos \s-1PAM\s0 module will attempt to obtain tickets for a key in the local system keytab and then verify those tickets.  Unless this step is performed, the authentication is vulnerable to \s-1KDC\s0 spoofing, but it requires that the system have a local key and that the \s-1PAM\s0 module be running as a user that can read the keytab file (normally <em>/etc/krb5.keytab</em>.  You can point the Kerberos \s-1PAM\s0 module at a different keytab with the <em>keytab</em> option.  If that keytab cannot be read or if no keys are found in it, the default (potentially insecure) behavior is to skip this check.  If you want to instead fail authentication if the obtained tickets cannot be checked, set \*(C`verify_ap_req_nofail\*(C' to true in the [libdefaults] section of <em>/etc/krb5.conf</em>.  Note that this will affect applications other than this \s-1PAM\s0 module. By default, whenever the user is authenticated, a basic authorization check will also be done using <em>krb5_kuserok()</em>.  The default behavior of this function is to check the user's account for a <em>.k5login</em> file and, if one is present, ensure that the user's principal is listed in that file.  If <em>.k5login</em> is not present, the default check is to ensure that the user's principal is in the default local realm and the user portion of the principal matches the account name (this can be changed by configuring a custom aname to localname mapping in <em>krb5.conf</em>; see the Kerberos documentation for details).  This can be customized with several configuration options; see below. If the username provided to \s-1PAM\s0 contains an \*(C`@\*(C' and Kerberos can, treating the username as a principal, map it to a local account name, <em>pam_authenticate()</em> will change the \s-1PAM\s0 user to that local account name. This allows users to log in with their Kerberos principal and let Kerberos do the mapping to an account.  Be aware, however, that this facility cannot be used with OpenSSH.  OpenSSH will reject usernames that don't match local accounts before this remapping can be done and will pass an invalid password to the \s-1PAM\s0 module.  Also be aware that several other common \s-1PAM\s0 modules, such as pam_securetty, expect to be able to look up the user with <em>getpwnam()</em> and cannot be called before pam_krb5 if this feature is used. When <em>pam_setcred()</em> is called to initialize a new ticket cache, the environment variable \s-1KRB5CCNAME\s0 is set to the path to that ticket cache. By default, the cache will be named <em>/tmp/krb5cc_UID_RANDOM</em> where \s-1UID\s0 is the user's \s-1UID\s0 and \s-1RANDOM\s0 is six randomly-chosen letters.  This can be configured with the <em>ccache</em> and <em>ccache_dir</em> options. If <em>pam_setcred()</em> initializes a new ticket cache, it will also set up that ticket cache so that it will be deleted when the \s-1PAM\s0 session is closed. Normally, the calling program (<strong>login</strong>, <strong>sshd</strong>, etc.) will run the user's shell as a sub-process, wait for it to exit, and then close the \s-1PAM\s0 session, thereby cleaning up the user's session.</p>
  </dd>
  <dt>
    session
  </dt>
  <dd>
    <p>Provides implementations of <em>pam_open_session()</em>, which is equivalent to calling <em>pam_setcred()</em> with the \s-1PAM_ESTABLISH_CRED\s0 flag, and <em>pam_close_session()</em>, which destroys the ticket cache created by <em>pam_setcred()</em>.</p>
  </dd>
  <dt>
    account
  </dt>
  <dd>
    <p>Provides an implementation of <em>pam_acct_mgmt()</em>.  All it does is do the same authorization check as performed by the <em>pam_authenticate()</em> implementation described above.</p>
  </dd>
  <dt>
    password
  </dt>
  <dd>
    <p>Provides an implementation of <em>pam_chauthtok()</em>, which implements password changes.  The user is prompted for their existing password (unless configured to use an already entered one) and the \s-1PAM\s0 module then obtains credentials for the special Kerberos principal \*(C`kadmin/changepw\*(C'.  It then prompts the user for a new password, twice to ensure that the user entered it properly (again, unless configured to use an already entered password), and then does a Kerberos password change. Unlike the normal Unix password module, this module will allow any user to change any other user's password if they know the old password.  Also, unlike the normal Unix password module, root will always be prompted for the old password, since root has no special status in Kerberos.  (To change passwords in Kerberos without knowing the old password, use <em>kadmin</em>\|(8) instead.)</p>
  </dd>

</dl>
<p>Both the account and session management calls of the Kerberos \s-1PAM\s0 module will return \s-1PAM_IGNORE\s0 if called in the context of a \s-1PAM\s0 session for a user who did not authenticate with Kerberos (a return code of \*(C`ignore\*(C' in the Linux \s-1PAM\s0 configuration language).</p><p>Note that this module assumes the network is available in order to do a Kerberos authentication, and if the network is not available, some Kerberos libraries have timeouts longer than the timeout imposed by the login process.  This means that using this module incautiously can make it impossible to log on to console as root.  For this reason, you should always use the <em>ignore_root</em> or <em>minimum_uid</em> options, list a local authentication module such as <strong>pam_unix</strong> first with a control field of \*(C`sufficient\*(C' so that the Kerberos \s-1PAM\s0 module will be skipped if local password authentication was successful.</p><p>This is not the same \s-1PAM\s0 module as the Kerberos \s-1PAM\s0 module available from Sourceforge.  It supports many of the same options, has some additional options, and doesn't support some of the options the Sourceforge module does.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURATION</h2>
        <div class="sectioncontent">
<p>The Kerberos \s-1PAM\s0 module takes many options, not all of which are relevant to every \s-1PAM\s0 group; options that are not relevant will be silently ignored.  Any of these options can be set in the \s-1PAM\s0 configuration as arguments listed after \*(C`pam_krb5.so\*(C'.  Some of the options can also be set in the system <em>krb5.conf</em> file; if this is possible, it will be noted below in the option description.</p><p>To set a boolean option in the \s-1PAM\s0 configuration file, just give the name of the option in the arguments.  To set an option that takes an argument, follow the option name with an equal sign (=) and the value, with no separating whitespace.  Whitespace in option arguments is not supported in the \s-1PAM\s0 configuration.</p><p>To set an option for the \s-1PAM\s0 module in the system <em>krb5.conf</em> file, put that option in the [appdefaults] section.  All options must be followed by an equal sign (=) and a value, so for boolean options add \*(C`= true\*(C'.  The Kerberos \s-1PAM\s0 module will look for options either at the top level of the [appdefaults] section or in a subsection named \*(C`pam\*(C', inside or outside a section for the realm.  For example, the following fragment of a <em>krb5.conf</em> file would set <em>forwardable</em> to true, <em>minimum_uid</em> to 1000, and set <em>ignore_k5login</em> only if the realm is \s-1EXAMPLE\s0.COM.</p><p>    [appdefaults]         forwardable = true         pam = {             minimum_uid = 1000             EXAMPLE.COM = {                 ignore_k5login = true             }         }</p><p>For more information on the syntax of <em>krb5.conf</em>, see <em>krb5.conf</em>\|(5). Note that options that depend on the realm will be set only on the basis of the default realm, either as configured in <em>krb5.conf</em>\|(5) or as set by the <em>realm</em> option described below.  If the user authenticates to an account qualified with a realm, that realm will not be used when determining which options will apply.</p><p>There is no difference to the \s-1PAM\s0 module whether options are specified at the top level or in a \*(C`pam\*(C' section; the \*(C`pam\*(C' section is supported in case there are options that should be set for the \s-1PAM\s0 module but not for other applications.</p><p>If the same option is set in <em>krb5.conf</em> and in the \s-1PAM\s0 configuration, the latter takes precedent.  Note, however, that due to the configuration syntax, there's no way to turn off a boolean option in the \s-1PAM\s0 configuration that was turned on in <em>krb5.conf</em>.</p><h3>Authorization</h3>

<dl class='dl-vertical'>
  <dt>
    alt_auth_map=&lt;format&gt;
  </dt>
  <dd>
    <p>This functions similarly to the <em>search_k5login</em> option.  The &lt;format&gt; argument is used as the authentication Kerberos principal, with any %s in &lt;format&gt; replaced with the username.  If the username contains an \*(C`@\*(C', only the part of the username before the realm is used to replace %s. If &lt;format&gt; contains a realm, it will be used; otherwise, the realm of the username (if any) will be appended to the result.  There is no quote removal. If this option is present, the default behavior is to try this alternate principal first and then fall back to the standard behavior if it fails. The primary usage is to allow alternative principals to be used for authentication in programs like <strong>sudo</strong>.  Most examples will look like:     alt_auth_map=%s/root which attempts authentication as the root instance of the username first and then falls back to the regular username (but see <em>force_alt_auth</em> and <em>only_alt_auth</em>). This option also allows a cheap way to attempt authentication in an alternative realm first and then fall back to the primary realm.  A setting like:     alt_auth_map=%s@EXAMPLE.COM will attempt authentication in the \s-1EXAMPLE\s0.COM realm first and then fall back on the local default realm.  This is more convenient than running the module multiple times with multiple default realms set with <em>realm</em>, but it is very limited: only two realms can be tried, and the alternate realm is always tried first. This option can be set in <em>krb5.conf</em>, although normally it doesn't make sense to do that; normally it is used in the \s-1PAM\s0 options of configuration for specific programs.  It is only applicable to the auth and account groups.  If this option is set for the auth group, be sure to set it for the account group as well or account authorization may fail.</p>
  </dd>
  <dt>
    force_alt_auth
  </dt>
  <dd>
    <p>This option is used with <em>alt_auth_map</em> and forces authentication as the mapped principal if that principal exists in the \s-1KDC\s0.  Only if the \s-1KDC\s0 returns principal unknown does the Kerberos \s-1PAM\s0 module fall back to normal authentication.  This can be used to force authentication with an alternate instance.  If <em>alt_auth_map</em> is not set, it has no effect. This option can be set in <em>krb5.conf</em> and is only applicable to the auth group.</p>
  </dd>
  <dt>
    ignore_k5login
  </dt>
  <dd>
    <p>Never look for a <em>.k5login</em> file in the user's home directory.  Instead, only check that the Kerberos principal maps to the local account name. The default check is to ensure the realm matches the local realm and the user portion of the principal matches the local account name, but this can be customized by setting up an aname to localname mapping in <em>krb5.conf</em>. This option can be set in <em>krb5.conf</em> and is only applicable to the auth and account groups.</p>
  </dd>
  <dt>
    ignore_root
  </dt>
  <dd>
    <p>Do not do anything if the username is \*(C`root\*(C'.  The authentication and password calls will silently fail (allowing that status to be ignored via a control of \*(C`optional\*(C' or \*(C`sufficient\*(C'), and the account and session calls (including pam_setcred) will return \s-1PAM_IGNORE\s0, telling the \s-1PAM\s0 library to proceed as if they weren't mentioned in the \s-1PAM\s0 configuration. This option is supported and will remain, but normally you want to use <em>minimum_uid</em> instead. This option can be set in <em>krb5.conf</em>.</p>
  </dd>
  <dt>
    minimum_uid=&lt;uid&gt;
  </dt>
  <dd>
    <p>Do not do anything if the authenticated account name corresponds to a local account and that local account has a \s-1UID\s0 lower than &lt;uid&gt;.  If both of those conditions are true, the authentication and password calls will silently fail (allowing that status to be ignored via a control of \*(C`optional\*(C' or \*(C`sufficient\*(C'), and the account and session calls (including pam_setcred) will return \s-1PAM_IGNORE\s0, telling the \s-1PAM\s0 library to proceed as if they weren't mentioned in the \s-1PAM\s0 configuration. Using this option is highly recommended if you don't need to use Kerberos to authenticate password logins to the root account (which isn't recommended since Kerberos requires a network connection).  It provides some defense in depth against user principals that happen to match a system account incorrectly authenticating as that system account. This option can be set in <em>krb5.conf</em>.</p>
  </dd>
  <dt>
    only_alt_auth
  </dt>
  <dd>
    <p>This option is used with <em>alt_auth_map</em> and forces the use of the mapped principal for authentication.  It disables fallback to normal authentication in all cases and overrides <em>search_k5login</em> and <em>force_alt_auth</em>.  If <em>alt_auth_map</em> is not set, it has no effect and the standard authentication behavior is used. This option can be set in <em>krb5.conf</em> and is only applicable to the auth group.</p>
  </dd>
  <dt>
    search_k5login
  </dt>
  <dd>
    <p>Normally, the Kerberos implementation of pam_authenticate attempts to obtain tickets for the authenticating username in the local realm.  If this option is set and the local user has a <em>.k5login</em> file in their home directory, the module will instead open and read that <em>.k5login</em> file, attempting to use the supplied password to authenticate as each principal listed there in turn.  If any of those authentications succeed, the user will be successfully authenticated; otherwise, authentication will fail. This option is useful for allowing password authentication (via console or sshd without GSS-API support) to shared accounts.  If there is no <em>.k5login</em> file, the behavior is the same as normal.  Using this option requires that the user's <em>.k5login</em> file be readable at the time of authentication. This option can be set in <em>krb5.conf</em> and is only applicable to the auth group.</p>
  </dd>

</dl>

<h3>Kerberos Behavior</h3>

<dl class='dl-vertical'>
  <dt>
    anon_fast
  </dt>
  <dd>
    <p>Attempt to use Flexible Authentication Secure Tunneling (\s-1FAST\s0) by first authenticating as the anonymous user (\s-1WELLKNOWN/ANONYMOUS\s0) and using its credentials as the \s-1FAST\s0 armor.  This requires anonymous \s-1PKINIT\s0 be enabled for the local realm, that \s-1PKINIT\s0 be configured on the local system, and that the Kerberos library support \s-1FAST\s0 and anonymous \s-1PKINIT\s0. \s-1FAST\s0 is a mechanism to protect Kerberos against password guessing attacks and provide other security improvements.  To work, \s-1FAST\s0 requires that a ticket be obtained with a strong key to protect exchanges with potentially weaker user passwords.  This option uses anonymous authentication to obtain that key and then uses it to protect the subsequent authentication. If anonymous \s-1PKINIT\s0 is not available or fails, \s-1FAST\s0 will not be used and the authentication will proceed as normal. To instead use an existing ticket cache for the \s-1FAST\s0 credentials, use <em>fast_ccache</em> instead of this option.  If both <em>fast_ccache</em> and <em>anon_fast</em> are set, the ticket cache named by <em>fast_ccache</em> will be tried first, and the Kerberos \s-1PAM\s0 module will fall back on attempting anonymous \s-1PKINIT\s0 if that cache could not be used. This option can be set in <em>krb5.conf</em> and is only applicable to the auth and password groups. The operation is the same as if using the <em>fast_ccache</em> option, but the cache is created and destroyed automatically.  If both <em>fast_ccache</em> and <em>anon_fast</em> options are used, the <em>fast_ccache</em> takes precedent and no anonymous authentication is done.</p>
  </dd>
  <dt>
    fast_ccache=&lt;ccache_name&gt;
  </dt>
  <dd>
    <p>The same as <em>anon_fast</em>, but use an existing Kerberos ticket cache rather than anonymous \s-1PKINIT\s0.  This allows use of \s-1FAST\s0 with a realm that doesn't support \s-1PKINIT\s0 or doesn't support anonymous authentication. &lt;ccache_name&gt; should be a credential cache containing a ticket obtained using a strong key, such as the randomized key for the host principal of the local system.  If &lt;ccache_name&gt; names a ticket cache that is readable by the authenticating process and has tickets then \s-1FAST\s0 will be attempted. The easiest way to use this option is to use a program like <strong>k5start</strong> to maintain a ticket cache using the host's keytab.  This ticket cache should normally only be readable by root, so this option will not be able to protect authentications done as non-root users (such as screensavers). If no credentials are present in the ticket cache, or if the ticket cache does not exist or is not readable, \s-1FAST\s0 will not used and authentication will proceed as normal.  However, if the credentials in that ticket cache are expired, authentication will fail if the \s-1KDC\s0 supports \s-1FAST\s0. To use anonymous \s-1PKINIT\s0 to protect the \s-1FAST\s0 exchange, use the <em>anon_fast</em> option instead.  <em>anon_fast</em> is easier to configure, since no existing ticket cache is required, but requires \s-1PKINIT\s0 be available and configured and that the local realm support anonymous authentication.  If both <em>fast_ccache</em> and <em>anon_fast</em> are set, the ticket cache named by <em>fast_ccache</em> will be tried first, and the Kerberos \s-1PAM\s0 module will fall back on attempting anonymous \s-1PKINIT\s0 if that cache could not be used. This option can be set in <em>krb5.conf</em> and is only applicable to the auth and password groups.</p>
  </dd>
  <dt>
    forwardable
  </dt>
  <dd>
    <p>Obtain forwardable tickets.  If set (to either true or false, although it can only be set to false in <em>krb5.conf</em>), this overrides the Kerberos library default set in the [libdefaults] section of <em>krb5.conf</em>. This option can be set in <em>krb5.conf</em> and is only applicable to the auth group.</p>
  </dd>
  <dt>
    keytab=&lt;path&gt;
  </dt>
  <dd>
    <p>Specifies the keytab to use when validating the user's credentials.  The default is the default system keytab (normally <em>/etc/krb5.keytab</em>), which is usually only readable by root.  Applications not running as root that use this \s-1PAM\s0 module for authentication may wish to point it to another keytab the application can read.  The first principal found in the keytab will be used as the principal for credential verification. This option can be set in <em>krb5.conf</em> and is only applicable to the auth group.</p>
  </dd>
  <dt>
    realm=&lt;realm&gt;
  </dt>
  <dd>
    <p>Set the default Kerberos realm and obtain credentials in that realm, rather than in the normal default realm for this system.  If this option is used, it should be set for all groups being used for consistent results.  This setting will affect authorization decisions since it changes the default realm.  This setting will also change the service principal used to verify the obtained credentials to be in the specified realm. If you only want to set the realm assumed for user principals without changing the realm for authorization decisions or the service principal used to verify credentials, see the <em>user_realm</em> option.</p>
  </dd>
  <dt>
    renew_lifetime=&lt;lifetime&gt;
  </dt>
  <dd>
    <p>Obtain renewable tickets with a maximum renewable lifetime of &lt;lifetime&gt;. &lt;lifetime&gt; should be a Kerberos lifetime string such as \*(C`2d4h10m\*(C' or a time in minutes.  If set, this overrides the Kerberos library default set in the [libdefaults] section of <em>krb5.conf</em>. This option can be set in <em>krb5.conf</em> and is only applicable to the auth group.</p>
  </dd>
  <dt>
    ticket_lifetime=&lt;lifetime&gt;
  </dt>
  <dd>
    <p>Obtain tickets with a maximum lifetime of &lt;lifetime&gt;.  &lt;lifetime&gt; should be a Kerberos lifetime string such as \*(C`2d4h10m\*(C' or a time in minutes.  If set, this overrides the Kerberos library default set in the [libdefaults] section of <em>krb5.conf</em>. This option can be set in <em>krb5.conf</em> and is only applicable to the auth group.</p>
  </dd>
  <dt>
    user_realm
  </dt>
  <dd>
    <p>Obtain credentials in the specified realm rather than in the default realm for this system.  If this option is used, it should be set for all groups being used for consistent results (although the account group currently doesn't care about realm).  This will not change authorization decisions. If the obtained credentials are supposed to allow access to a shell account, the user will need an appropriate <em>.k5login</em> file entry or the system will have to have a custom aname_to_localname mapping.</p>
  </dd>

</dl>

<h3>\s-1PAM\s0 Behavior</h3>

<dl class='dl-vertical'>
  <dt>
    clear_on_fail
  </dt>
  <dd>
    <p>When changing passwords, \s-1PAM\s0 first does a preliminary check through the complete password stack, and then calls each module again to do the password change.  After that preliminary check, the order of module invocation is fixed.  This means that even if the Kerberos password change fails (or if one of the other password changes in the stack fails), other password \s-1PAM\s0 modules in the stack will still be called even if the failing module is marked required or requisite.  When using multiple password \s-1PAM\s0 modules to synchronize passwords between multiple systems when they change, this behavior can cause unwanted differences between the environments. Setting this option provides a way to work around this behavior.  If this option is set and a Kerberos password change is attempted and fails (due to network errors or password strength checking on the \s-1KDC\s0, for example), this module will clear the stored password in the \s-1PAM\s0 stack.  This will force any subsequent modules that have use_authtok set to fail so that those environments won't get out of sync with the password in Kerberos. The Kerberos \s-1PAM\s0 module will not meddle with the stored password if it skips the user due to configuration such as minimum_uid. Unfortunately, setting this option interferes with other desirable \s-1PAM\s0 configurations, such as attempting to change the password in Kerberos first and falling back on the local Unix password database if that fails. It therefore isn't the default.  Turn it on (and list pam_krb5 first after pam_cracklib if used) when synchronizing passwords between multiple environments. This option can be set in <em>krb5.conf</em> and is only applicable to the password group.</p>
  </dd>
  <dt>
    debug
  </dt>
  <dd>
    <p>Log more verbose trace and debugging information to syslog at \s-1LOG_DEBUG\s0 priority, including entry and exit from each of the external \s-1PAM\s0 interfaces (except pam_close_session). This option can be set in <em>krb5.conf</em>.</p>
  </dd>
  <dt>
    defer_pwchange
  </dt>
  <dd>
    <p>By default, pam-krb5 lets the Kerberos library handle prompting for a password change if an account's password is expired during the auth group.  If this fails, <em>pam_authenticate()</em> returns an error. According to the \s-1PAM\s0 standard, this is not the correct way to handle expired passwords.  Instead, <em>pam_authenticate()</em> should return success without attempting a password change, and then <em>pam_acct_mgmt()</em> should return \s-1PAM_NEW_AUTHTOK_REQD\s0, at which point the calling application is responsible for either rejecting the authentication or calling <em>pam_chauthtok()</em>.  However, following the standard requires that all applications call <em>pam_acct_mgmt()</em> and check its return status; otherwise, expired accounts may be able to successfully authenticate.  Many applications do not do this. If this option is set, pam-krb5 uses the fully correct \s-1PAM\s0 mechanism for handling expired accounts instead of failing in <em>pam_authenticate()</em>.  Due to the security risk of widespread broken applications, be very careful about enabling this option.  It should normally only be turned on to solve a specific problem (such as using Solaris Kerberos libraries that don't support prompting for password changes during authentication), and then only for specific applications known to call <em>pam_acct_mgmt()</em> and check its return status properly. This option can be set in <em>krb5.conf</em> and is only applicable to the auth group.</p>
  </dd>
  <dt>
    fail_pwchange
  </dt>
  <dd>
    <p>By default, pam-krb5 lets the Kerberos library handle prompting for a password change if an account's password is expired during the auth group.  If this option is set, expired passwords are instead treated as an authentication failure identical to an incorrect password.  Also see <em>defer_pwchange</em> and <em>force_pwchange</em>. This option can be set in <em>krb5.conf</em> and is only applicable to the auth group.</p>
  </dd>
  <dt>
    force_pwchange
  </dt>
  <dd>
    <p>If this option is set and authentication fails with a Kerberos error indicating the user's password is expired, attempt to immediately change their password during the authenticate step.  Under normal circumstances, this is unnecessary.  Most Kerberos libraries will do this for you, and setting this option will prompt the user twice to change their password if the first attempt (done by the Kerberos library) fails.  However, some system Kerberos libraries (such as Solaris's) have password change prompting disabled in the Kerberos library; on those systems, you can set this option to simulate the normal library behavior. This option can be set in <em>krb5.conf</em> and is only applicable to the auth group.</p>
  </dd>
  <dt>
    silent
  </dt>
  <dd>
    <p>Don't show messages and errors from Kerberos, such as warnings of expiring passwords, to the user via the prompter.  This is equivalent to the behavior when the application passes in \s-1PAM_SILENT\s0, but can be set in the \s-1PAM\s0 configuration. This option is only applicable to the auth and password groups.</p>
  </dd>
  <dt>
    trace=&lt;log-file&gt;
  </dt>
  <dd>
    <p>Enables Kerberos library trace logging to the specified log file if it is supported by the Kerberos library.  This is intended for temporary debugging.  The specified file will be appended to without further security checks, so do not specify a file in a publicly writable directory like <em>/tmp</em>.</p>
  </dd>

</dl>

<h3>\s-1PKINIT\s0</h3>

<dl class='dl-vertical'>
  <dt>
    pkinit_anchors=&lt;anchors&gt;
  </dt>
  <dd>
    <p>When doing \s-1PKINIT\s0 authentication, use &lt;anchors&gt; as the client trust anchors.  This is normally a reference to a file containing the trusted certificate authorities.  This option is only used if <em>try_pkinit</em> or <em>use_pkinit</em> are set. This option can be set in <em>krb5.conf</em> and is only applicable to the auth and password groups.</p>
  </dd>
  <dt>
    pkinit_prompt
  </dt>
  <dd>
    <p>Before attempting \s-1PKINIT\s0 authentication, prompt the user to insert a smart card.  You may want to set this option for programs such as <strong>gnome-screensaver</strong> that call \s-1PAM\s0 as soon as the mouse is touched and don't give the user an opportunity to enter the smart card first.  Any information entered at the first prompt is ignored.  If <em>try_pkinit</em> is set, a user who wishes to use a password instead can just press Enter and then enter their password as normal.  This option is only used if <em>try_pkinit</em> or <em>use_pkinit</em> are set. This option can be set in <em>krb5.conf</em> and is only applicable to the auth and password groups.</p>
  </dd>
  <dt>
    pkinit_user=&lt;userid&gt;
  </dt>
  <dd>
    <p>When doing \s-1PKINIT\s0 authentication, use &lt;userid&gt; as the user \s-1ID\s0.  The value of this string is highly dependent on the type of \s-1PKINIT\s0 implementation you're using, but will generally be something like:     PKCS11:/usr/lib/pkcs11/lib/soft-pkcs11.so to specify the module to use with a smart card.  It may also point to a user certificate or to other types of user IDs.  See the Kerberos library documentation for more details.  This option is only used if <em>try_pkinit</em> or <em>use_pkinit</em> are set. This option can be set in <em>krb5.conf</em> and is only applicable to the auth and password groups.</p>
  </dd>
  <dt>
    preauth_opt=&lt;option&gt;
  </dt>
  <dd>
    <p>Sets a preauth option (currently only applicable when built with \s-1MIT\s0 Kerberos).  &lt;option&gt; is either a key/value pair with the key separated from the value by \*(C`=\*(C' or a boolean option (in which case it's turned on).  In <em>krb5.conf</em>, multiple options should be separated by whitespace.  In the \s-1PAM\s0 configuration, this option can be given multiple times to set multiple options.  In either case, &lt;option&gt; may not contain whitespace. The primary use of this option, at least in the near future, will be to set options for the \s-1MIT\s0 Kerberos \s-1PKINIT\s0 support.  For the full list of possible options, see the \s-1PKINIT\s0 plugin documentation.  At the time of this writing, \*(C`X509_user_identity\*(C' is equivalent to <em>pkinit_user</em> and \*(C`X509_anchors\*(C' is equivalent to <em>pkinit_anchors</em>.  \*(C`flag_DSA_PROTOCOL\*(C' can only be set via this option. Any settings made with this option are applied after the <em>pkinit_anchors</em> and <em>pkinit_user</em> options, so if an equivalent setting is made via <em>preauth_opt</em>, it will probably override the other setting. This option can be set in <em>krb5.conf</em> and is only applicable to the auth and password groups.  Note that there is no way to remove a setting made in <em>krb5.conf</em> using the \s-1PAM\s0 configuration, but options set in the \s-1PAM\s0 configuration are applied after options set in <em>krb5.conf</em> and therefore may override earlier settings.</p>
  </dd>
  <dt>
    try_pkinit
  </dt>
  <dd>
    <p>Attempt \s-1PKINIT\s0 authentication before trying a regular password.  You will probably also need to set the <em>pkinit_user</em> configuration option.  If \s-1PKINIT\s0 fails, the \s-1PAM\s0 module will fall back on regular password authentication.  This option is currently only supported if pam-krb5 was built against Heimdal 0.8rc1 or later or \s-1MIT\s0 Kerberos 1.6.3 or later. If this option is set and pam-krb5 is built against \s-1MIT\s0 Kerberos, and \s-1PKINIT\s0 fails and the module falls back to password authentication, the user's password will not be stored in the \s-1PAM\s0 stack for subsequent modules.  This is a bug in the interaction between the module and \s-1MIT\s0 Kerberos that requires some rearchitecting of the \s-1PKINIT\s0 authentication method to fix. This option can be set in <em>krb5.conf</em> and is only applicable to the auth and password groups.</p>
  </dd>
  <dt>
    use_pkinit
  </dt>
  <dd>
    <p>Require \s-1PKINIT\s0 authentication.  You will probably also need to set the <em>pkinit_user</em> configuration option.  If \s-1PKINIT\s0 fails, authentication will fail.  This option is currently only supported if pam-krb5 was built against Heimdal 0.8rc1 or later.  \s-1MIT\s0 Kerberos doesn't provide a method to enforce use of \s-1PKINIT\s0, so <em>try_pkinit</em> must be used with that implementation instead. This option can be set in <em>krb5.conf</em> and is only applicable to the auth and password groups.</p>
  </dd>

</dl>

<h3>Prompting</h3>

<dl class='dl-vertical'>
  <dt>
    banner=&lt;banner&gt;
  </dt>
  <dd>
    <p>By default, the prompts when a user changes their password are:     Current Kerberos password:     Enter new Kerberos password:     Retype new Kerberos password: The string \*(L"Kerberos\*(R" is inserted so that users aren't confused about which password they're changing.  Setting this option replaces the word \*(L"Kerberos\*(R" with whatever this option is set to.  Setting this option to the empty string removes the word before \*(L"password:\*(R" entirely. If set in the \s-1PAM\s0 configuration, &lt;banner&gt; may not contain whitespace.  If you want a value containing whitespace, set it in <em>krb5.conf</em>. This option can be set in <em>krb5.conf</em> and is only applicable to the password group.</p>
  </dd>
  <dt>
    expose_account
  </dt>
  <dd>
    <p>By default, the Kerberos \s-1PAM\s0 module password prompt is simply \*(L"Password:\*(R".  This avoids leaking any information about the system realm or account to principal conversions.  If this option is set, the string \*(L"for &lt;principal&gt;\*(R" is added before the colon, where &lt;principal&gt; is the user's principal.  This string is also added before the colon on prompts when changing the user's password. Enabling this option with ChallengeResponseAuthentication enabled in OpenSSH may cause problems for some ssh clients that only recognize \*(L"Password:\*(R" as a prompt.  This option is automatically disabled if <em>search_k5login</em> is enabled since the principal displayed would be inaccurate. This option can be set in <em>krb5.conf</em> and is only applicable to the auth and password groups.</p>
  </dd>
  <dt>
    force_first_pass
  </dt>
  <dd>
    <p>Use the password obtained by a previous authentication or password module to authenticate the user without prompting the user again.  If no previous module obtained the user's password, fail without prompting the user. Also see <em>try_first_pass</em> and <em>use_first_pass</em> for weaker versions of this option. This option is only applicable to the auth and password groups.  For the password group, it applies only to the old password.  See <em>use_authtok</em> for a similar setting for the new password.</p>
  </dd>
  <dt>
    no_prompt
  </dt>
  <dd>
    <p>Never prompt for the current password.  Instead, pass in a \s-1NULL\s0 password to the Kerberos library and let the Kerberos library do the prompting. This may be needed if, for example, the Kerberos library is configured to use other authentication mechanisms than passwords and needs full control over the prompting process. The major disadvantage of this option is that it means the \s-1PAM\s0 module will never see the user's password and therefore cannot save it in the \s-1PAM\s0 module data for any subsequent modules.  In other words, this option cannot be used if another module is in the stack behind the Kerberos \s-1PAM\s0 module and wants to use <em>use_first_pass</em>.  The Kerberos library also usually includes the principal in the prompt, and therefore this option implies behavior similar to <em>expose_account</em>.  Similar to <em>expose_account</em>, this can cause problems with OpenSSH if ChallengeResponseAuthentication is enabled, since clients may not recognize password prompts other than \*(L"Password:\*(R". Using this option with <em>search_k5login</em> would result in a password prompt for every principal listed in the user's <em>.k5login</em> file.  This is probably not desired behavior, although it's not prohibited by the module. This option is only applicable to the auth and password groups.  For the password group, it applies only to the authentication process; the user will still be prompted for a new password.</p>
  </dd>
  <dt>
    prompt_principal
  </dt>
  <dd>
    <p>Before prompting for the user's password (or using the previously entered password, if <em>try_first_pass</em>, <em>use_first_pass</em>, or <em>force_first_pass</em> are set), prompt the user for the Kerberos principal to use for authentication.  This allows the user to authenticate with a different principal than the one corresponding to the local username, provided that either a <em>.k5login</em> file or local Kerberos principal to account mapping authorize that principal to access the local account. Be cautious when using this configuration option and don't use it with OpenSSH PasswordAuthentication, only ChallengeResponseAuthentication. Some PAM-enabled applications expect \s-1PAM\s0 modules to only prompt for passwords and may even blindly give the password to the first prompt, no matter what it is.  Such applications, in combination with this option, may expose the user's password in log messages and Kerberos requests.</p>
  </dd>
  <dt>
    try_first_pass
  </dt>
  <dd>
    <p>If the authentication module isn't the first on the stack, and a previous module obtained the user's password, use that password to authenticate the user without prompting them again.  If that authentication fails, fall back on prompting the user for their password.  This option has no effect if the authentication module is first in the stack or if no previous module obtained the user's password.  Also see <em>use_first_pass</em> and <em>force_first_pass</em> for stronger versions of this option. This option is only applicable to the auth and password groups.  For the password group, it applies only to the old password.</p>
  </dd>
  <dt>
    use_authtok
  </dt>
  <dd>
    <p>Use the new password obtained by a previous password module when changing passwords rather than prompting for the new password.  If the new password isn't available, fail.  This can be used to require passwords be checked by another, prior module, such as <strong>pam_cracklib</strong>. This option is only applicable to the password group.</p>
  </dd>
  <dt>
    use_first_pass
  </dt>
  <dd>
    <p>Use the password obtained by a previous authentication module to authenticate the user without prompting the user again.  If no previous module obtained the user's password for either an authentication or password change, fall back on prompting the user.  If a previous module did obtain the user's password but authentication with that password fails, fail without further prompting the user.  Also see <em>try_first_pass</em> and <em>force_first_pass</em> for other versions of this option. This option is only applicable to the auth and password groups.  For the password group, it applies only to the old password.  See <em>use_authtok</em> for a similar setting for the new password.</p>
  </dd>

</dl>

<h3>Ticket Caches</h3>

<dl class='dl-vertical'>
  <dt>
    ccache=&lt;pattern&gt;
  </dt>
  <dd>
    <p>Use &lt;pattern&gt; as the pattern for creating credential cache names. &lt;pattern&gt; must be in the form &lt;type&gt;:&lt;residual&gt; where &lt;type&gt; and the following colon are optional if a file cache should be used.  The special token %u, anywhere in &lt;pattern&gt;, is replaced with the user's numeric \s-1UID\s0.  The special token %p, anywhere in &lt;pattern&gt;, is replaced with the current process \s-1ID\s0. If &lt;pattern&gt; ends in the literal string \*(C`XXXXXX\*(C' (six X's), that string will be replaced by randomly generated characters and the ticket cache will be created using <em>mkstemp</em>\|(3).  This is strongly recommended if &lt;pattern&gt; points to a world-writable directory. This option can be set in <em>krb5.conf</em> and is only applicable to the auth and session groups.</p>
  </dd>
  <dt>
    ccache_dir=&lt;directory&gt;
  </dt>
  <dd>
    <p>Store both the temporary ticket cache used during authentication and user ticket caches in &lt;directory&gt; instead of in <em>/tmp</em>.  The algorithm for generating the ticket cache name is otherwise unchanged.  &lt;directory&gt; may be prefixed with \*(C`FILE:\*(C' to make the cache type unambiguous (and this may be required on systems that use a cache type other than file as the default). Be aware that pam_krb5 creates and stores a temporary ticket cache file owned by root during the login process.  If you set <em>ccache</em> above to avoid using the system <em>/tmp</em> directory for user ticket caches, you may also want to set <em>ccache_dir</em> to move those temporary caches to some other location.  This will allow pam_krb5 to continue working even if the system <em>/tmp</em> directory is full. This option can be set in <em>krb5.conf</em> and is only applicable to the auth and session groups.</p>
  </dd>
  <dt>
    no_ccache
  </dt>
  <dd>
    <p>Do not create a ticket cache after authentication.  This option shouldn't be set in general, but is useful as part of the \s-1PAM\s0 configuration for a particular service that uses \s-1PAM\s0 for authentication but isn't creating user sessions and doesn't want the overhead of ever writing the user credentials to disk.  When using this option, the application should only call <em>pam_authenticate()</em>; other functions like <em>pam_setcred()</em>, <em>pam_start_session()</em>, and <em>pam_acct_mgmt()</em> don't make sense with this option.  Don't use this option if the application needs \s-1PAM\s0 account and session management calls. This option is only applicable to the auth group.</p>
  </dd>
  <dt>
    retain_after_close
  </dt>
  <dd>
    <p>Normally, the user's ticket cache is destroyed when either <em>pam_end()</em> or <em>pam_close_session()</em> is called by the authenticating application so that ticket caches aren't left behind after the user logs out.  In some cases, however, this isn't desireable.  (On Solaris 8, for instance, the default behavior means login will destroy the ticket cache before running the user's shell.)  If this option is set, the \s-1PAM\s0 module will never destroy the user's ticket cache.  If you set this, you may want to call <strong>kdestroy</strong> in the shell's logout configuration or run a temporary file removal program to avoid accumulating hundreds of ticket caches in <em>/tmp</em>. This option can be set in <em>krb5.conf</em> and is only applicable to the auth and session groups.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    \s-1KRB5CCNAME\s0
  </dt>
  <dd>
    <p>Set by <em>pam_setcred()</em> with the \s-1PAM_ESTABLISH_CRED\s0 option, and therefore also by <em>pam_open_session()</em>, to point to the new credential cache for the user.  See the <em>ccache</em> and <em>ccache_dir</em> options.  By default, the cache name will be prefixed with \*(C`FILE:\*(C' to make the cache type unambiguous.</p>
  </dd>
  <dt>
    \s-1PAM_KRB5CCNAME\s0
  </dt>
  <dd>
    <p>Set by <em>pam_authenticate()</em> to point to the temporary ticket cache used for authentication (unless the <em>no_ccache</em> option was given).  <em>pam_setcred()</em> then uses that environment variable to locate the temporary cache even if it was not called in the same \s-1PAM\s0 session as <em>pam_authenticate()</em> (a problem with <strong>sshd</strong> running in some modes).  This environment variable is only used internal to the \s-1PAM\s0 module.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <em>/tmp/krb5cc_UID_RANDOM</em>
  </dt>
  <dd>
    <p>The default credential cache name.  \s-1UID\s0 is the decimal \s-1UID\s0 of the local user and \s-1RANDOM\s0 is a random six-character string.  The pattern may be changed with the <em>ccache</em> option and the directory with the <em>ccache_dir</em> option.</p>
  </dd>
  <dt>
    <em>/tmp/krb5cc_pam_RANDOM</em>
  </dt>
  <dd>
    <p>The credential cache name used for the temporary credential cache created by <em>pam_authenticate()</em>.  This cache is removed again when the \s-1PAM\s0 session is ended or when <em>pam_setcred()</em> is called and will normally not be user-visible.  \s-1RANDOM\s0 is a random six-character string.</p>
  </dd>
  <dt>
    <em>~/.k5login</em>
  </dt>
  <dd>
    <p>File containing Kerberos principals that are allowed access to that account.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>If <em>try_pkinit</em> is set and pam-krb5 is built with \s-1MIT\s0 Kerberos, the user's password is not saved in the \s-1PAM\s0 data if \s-1PKINIT\s0 fails and the module falls back to password authentication.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CAVEATS</h2>
        <div class="sectioncontent">
<p>Be sure to list this module in the session group as well as the auth group when using it for interactive logins.  Otherwise, some applications (such as OpenSSH) will not set up the user's ticket cache correctly.</p><p>The Kerberos library, via pam-krb5, will prompt the user to change their password if their password is expired, but when using OpenSSH, this will only work when ChallengeResponseAuthentication is enabled.  Unless this option is enabled, OpenSSH doesn't pass \s-1PAM\s0 messages to the user and can only respond to a simple password prompt.</p><p>If you are using \s-1MIT\s0 Kerberos, be aware that users whose passwords are expired will not be prompted to change their password unless the \s-1KDC\s0 configuration for your realm in [realms] in krb5.conf contains a master_kdc setting or, if using \s-1DNS\s0 \s-1SRV\s0 records, you have a \s-1DNS\s0 entry for _kerberos-master as well as _kerberos.</p><p><em>pam_authenticate()</em> returns failure when called for an ignored account, requiring the system administrator to use \*(C`optional\*(C' or \*(C`sufficient\*(C' to ignore the module and move on to the next module.  It's arguably more correct to return \s-1PAM_IGNORE\s0, which causes the module to be ignored as if it weren't in the configuration, but this increases the risk of inadvertent security holes when listing pam-krb5 as the only authentication module.</p><p>This module treats the empty password as an authentication failure rather than attempting to use that password to avoid unwanted prompting behavior in the Kerberos libraries.  If you have a Kerberos principal that intentionally has an empty password, it won't work with this module.</p><p>This module will not refresh an existing ticket cache if called with an effective \s-1UID\s0 or \s-1GID\s0 different than the real \s-1UID\s0 or \s-1GID\s0, since refreshing an existing ticket cache requires trusting the \s-1KRB5CCNAME\s0 environment variable and the environment should not be trusted in a setuid context.</p><p>Old versions of OpenSSH are known to call pam_authenticate followed by pam_setcred(\s-1PAM_REINITIALIZE_CRED\s0) without first calling pam_open_session, thereby requesting that an existing ticket cache be renewed (similar to what a screensaver would want) rather than requesting a new ticket cache be created.  Since this behavior is indistinguishable at the \s-1PAM\s0 level from a screensaver, pam-krb5 when used with these old versions of OpenSSH will refresh the ticket cache of the OpenSSH daemon rather than setting up a new ticket cache for the user.  The resulting ticket cache will have the correct permissions, but will not be named correctly or referenced in the user's environment and will be overwritten by the next user login.  The best solution to this problem is to upgrade OpenSSH.  I'm not sure exactly when this problem was fixed, but at the very least OpenSSH 4.3 and later do not exhibit it.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO pam_krb5&hellip;</h2>
        <div class="sectioncontent">
<p><em>kadmin</em>\|(8), <em>kdestroy</em>\|(1), <em>krb5.conf</em>\|(5), <em>pam</em>\|(7), <em>passwd</em>\|(1), <em>syslog</em>\|(3)</p><p>The current version of this module is available from its web page at http://www.eyrie.org/~eagle/software/pam-krb5/ &lt;http://www.eyrie.org/~eagle/software/pam-krb5/&gt;.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pam_env.conf.5.html"><span aria-hidden="true">&larr;</span> pam_env.conf.5: The environment variables config file</a></li>
   <li class="next"><a href="libpam-krb5-pam_krb5.5.html">pam_krb5.5: Kerberos pam module <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
