<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>schroot-setup: Schroot chroot setup scripts</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Schroot chroot setup scripts">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="schroot-setup (5) manual">
  <meta name="twitter:description" content="Schroot chroot setup scripts">
  <meta name="twitter:image" content="https://www.carta.tech/images/schroot-schroot-setup-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/schroot-setup.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="schroot-setup (5) manual" />
  <meta property="og:description" content="Schroot chroot setup scripts" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/schroot-schroot-setup-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">schroot-setup<small> (5)</small></h1>
        <p class="lead">Schroot chroot setup scripts</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/schroot-setup.5.html">
      <span itemprop="name">schroot-setup: Schroot chroot setup scripts</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/schroot/">
      <span itemprop="name">schroot</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/schroot-setup.5.html">
      <span itemprop="name">schroot-setup: Schroot chroot setup scripts</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>schroot</strong> uses scripts to set up and then clean up the chroot environment. The directory <em>\*[SCHROOT_CONF_SETUP_D]</em> contains scripts run when a chroot is created and destroyed.  Several environment variables are set while the scripts are being run, which allows their behaviour to be customised, depending upon, for example, the type of chroot in use.</p><p>The scripts are run in name order, like those run by <a href="../man8/init.8.html"><strong>init</strong>(8)</a>, by using the same style of execution as <a href="../man8/run-parts.8.html"><strong>run-parts</strong>(8)</a>.</p><p>The setup scripts are all invoked with two options:</p>
<dl class='dl-vertical'>
  <dt>
    1
  </dt>
  <dd>
    <p>The action to perform.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>When a session is first started, the chroot is set up by running the scripts in \*[SCHROOT_CONF_SETUP_D] with the \[oq]setup-start\[cq] option.  When the session is ended, the scripts in <em>\*[SCHROOT_CONF_SETUP_D]</em> are run in reverse order with the \[oq]setup-stop\[cq] option.</p>
  </dd>
  <dt>
    2
  </dt>
  <dd>
    <p>The chroot status.</p>
  </dd>
  <dt>
    
  </dt>
  <dd>
    <p>This is either \[oq]ok\[cq] if there are no problems, or \[oq]fail\[cq] if something went wrong.  For example, particular actions may be skipped on failure.</p>
  </dd>

</dl>
<p>Note that the scripts should be <em>idempotent</em>.  They <strong>must</strong> be idempotent during the \[oq]setup-stop\[cq] phase, because they may be run more than once, for example on failure.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">
<h3>General variables</h3>

<dl class='dl-vertical'>
  <dt>
    <p>AUTH_USER</p>
  </dt>
  <dd>
    <p>The username of the user the command in the chroot will run as.</p>
  </dd>
  <dt>
    <p>CHROOT_NAME</p>
  </dt>
  <dd>
    <p>The chroot name.  Note that this is the name of the orignal chroot before session creation; you probably want SESSION_ID.</p>
  </dd>
  <dt>
    <p>LIBEXEC_DIR</p>
  </dt>
  <dd>
    <p>The directory under which helper programs are located.</p>
  </dd>
  <dt>
    <p>MOUNT_DIR</p>
  </dt>
  <dd>
    <p>The directory under which non-filesystem chroots are mounted (e.g. block devices and LVM snapshots).</p>
  </dd>
  <dt>
    <p>PID</p>
  </dt>
  <dd>
    <p>The process ID of the schroot process.</p>
  </dd>
  <dt>
    <p>PLATFORM</p>
  </dt>
  <dd>
    <p>The operating system platform schroot is running upon.  This may be used to introduce platform-specific behaviour into the setup scripts where required. Note that the HOST variables are probably what are required.  In the context of schroot, the platform is the supported configuration and behaviour for a given architecture, and may be identical between different architectures.</p>
  </dd>
  <dt>
    <p>SESSION_ID</p>
  </dt>
  <dd>
    <p>The session identifier.</p>
  </dd>
  <dt>
    <p>VERBOSE</p>
  </dt>
  <dd>
    <p>Set to \[oq]quiet\[cq] if only error messages should be printed, \[oq]normal\[cq] if other messages may be printed as well, and \[oq]verbose\[cq] if all messages may be printed.  Previously called AUTH_VERBOSITY.</p>
  </dd>
  <dt>
    <p>CHROOT_SESSION_CREATE</p>
  </dt>
  <dd>
    <p>Set to \[oq]true\[cq] if a session will be created, otherwise \[oq]false\[cq].</p>
  </dd>
  <dt>
    <p>CHROOT_SESSION_CLONE</p>
  </dt>
  <dd>
    <p>Set to \[oq]true\[cq] if a session will be cloned, otherwise \[oq]false\[cq].</p>
  </dd>
  <dt>
    <p>CHROOT_SESSION_PURGE</p>
  </dt>
  <dd>
    <p>Set to \[oq]true\[cq] if a session will be purged, otherwise \[oq]false\[cq].</p>
  </dd>
  <dt>
    <p>CHROOT_TYPE</p>
  </dt>
  <dd>
    <p>The type of the chroot.  This is useful for restricting a setup task to particular types of chroot (e.g. only block devices or LVM snapshots).</p>
  </dd>
  <dt>
    <p>CHROOT_NAME</p>
  </dt>
  <dd>
    <p>The name of the chroot.  This is useful for restricting a setup task to a particular chroot, or set of chroots.</p>
  </dd>
  <dt>
    <p>CHROOT_ALIAS</p>
  </dt>
  <dd>
    <p>The name of the alias used to select the chroot.  This is useful for specialising a setup task based upon one of its alternative alias names, or the default chroot name.  For example, it could be used to specify additional sources in <em>/etc/apt/sources.list</em>, such as a stable-security alias for a stable chroot, or an experimental alias for an unstable chroot.</p>
  </dd>
  <dt>
    <p>CHROOT_DESCRIPTION</p>
  </dt>
  <dd>
    <p>The description of the chroot.</p>
  </dd>
  <dt>
    <p>CHROOT_MOUNT_LOCATION</p>
  </dt>
  <dd>
    <p>The location to mount the chroot.  It is used for mount point creation and mounting.</p>
  </dd>
  <dt>
    <p>CHROOT_LOCATION</p>
  </dt>
  <dd>
    <p>The location of the chroot inside the mount point.  This is to allow multiple chroots on a single filesystem.  Set for all mountable chroot types.</p>
  </dd>
  <dt>
    <p>CHROOT_PATH</p>
  </dt>
  <dd>
    <p>The absolute path to the chroot.  This is typically CHROOT_MOUNT_LOCATION and CHROOT_LOCATION concatenated together.  This is the path which should be used to access the chroots.</p>
  </dd>

</dl>

<h3>Plain and directory chroot variables</h3>
<p>These chroot types use only general variables.</p>
<h3>File variables</h3>

<dl class='dl-vertical'>
  <dt>
    <p>CHROOT_FILE</p>
  </dt>
  <dd>
    <p>The file containing the chroot files.</p>
  </dd>
  <dt>
    <p>CHROOT_FILE_REPACK</p>
  </dt>
  <dd>
    <p>Set to \[oq]true\[cq] to repack the chroot into an archive file on ending a session, otherwise \[oq]false\[cq].</p>
  </dd>

</dl>

<h3>Mountable chroot variables</h3>
<p>These variables are only set for directly mountable chroot types.</p>
<dl class='dl-vertical'>
  <dt>
    <p>CHROOT_MOUNT_DEVICE</p>
  </dt>
  <dd>
    <p>The device to mount containing the chroot. mounting.</p>
  </dd>
  <dt>
    <p>CHROOT_MOUNT_OPTIONS</p>
  </dt>
  <dd>
    <p>Options to pass to <a href="../man8/mount.8.html"><strong>mount</strong>(8)</a>.</p>
  </dd>
  <dt>
    <p>CHROOT_LOCATION</p>
  </dt>
  <dd>
    <p>The location of the chroot inside the mount point.  This allows the existence of multiple chroots on a single filesystem.</p>
  </dd>

</dl>

<h3>Filesystem union variables</h3>

<dl class='dl-vertical'>
  <dt>
    <p>CHROOT_UNION_TYPE</p>
  </dt>
  <dd>
    <p>Union filesystem type.</p>
  </dd>
  <dt>
    <p>CHROOT_UNION_MOUNT_OPTIONS</p>
  </dt>
  <dd>
    <p>Union filesystem mount options.</p>
  </dd>
  <dt>
    <p>CHROOT_UNION_OVERLAY_DIRECTORY</p>
  </dt>
  <dd>
    <p>Union filesystem overlay directory (writable).</p>
  </dd>
  <dt>
    <p>CHROOT_UNION_UNDERLAY_DIRECTORY</p>
  </dt>
  <dd>
    <p>Union filesystem underlay directory (read-only).</p>
  </dd>

</dl>

<h3>Block device variables</h3>

<dl class='dl-vertical'>
  <dt>
    <p>CHROOT_DEVICE</p>
  </dt>
  <dd>
    <p>The device containing the chroot root filesystem.  This is usually, but not necessarily, the device which will be mounted.  For example, an LVM snapshot this will be the original logical volume.</p>
  </dd>

</dl>

<h3>LVM snapshot variables</h3>

<dl class='dl-vertical'>
  <dt>
    <p>CHROOT_LVM_SNAPSHOT_NAME</p>
  </dt>
  <dd>
    <p>Snapshot name to pass to <a href="../man8/lvcreate.8.html"><strong>lvcreate</strong>(8)</a>.</p>
  </dd>
  <dt>
    <p>CHROOT_LVM_SNAPSHOT_DEVICE</p>
  </dt>
  <dd>
    <p>The name of the LVM snapshot device.</p>
  </dd>
  <dt>
    <p>CHROOT_LVM_SNAPSHOT_OPTIONS</p>
  </dt>
  <dd>
    <p>Options to pass to <a href="../man8/lvcreate.8.html"><strong>lvcreate</strong>(8)</a>.</p>
  </dd>

</dl>

<h3>Custom variables</h3>
<p>Custom keys set in <em>schroot.conf</em> will be uppercased and set in the environment as described in <a href="../man5/schroot.conf.5.html"><strong>schroot.conf</strong>(5)</a>.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<h3>Setup script configuration</h3>
<p>The directory <em>\*[SCHROOT_SYSCONF_DIR]/default</em> contains the default settings used by setup scripts.</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>config</em></p>
  </dt>
  <dd>
    <p>Main configuration file read by setup scripts.  The format of this file is described in <a href="../man5/schroot-script-config.5.html"><strong>schroot-script-config</strong>(5)</a>. This is the default value for the <em>script-config</em> key.  Note that this was formerly named <em>\*[SCHROOT_SYSCONF_DIR]/script-defaults</em>.  The following files are referenced by default:</p>
  </dd>
  <dt>
    <p><em>copyfiles</em></p>
  </dt>
  <dd>
    <p>A list of files to copy into the chroot from the host system.  Note that this was formerly named <em>\*[SCHROOT_SYSCONF_DIR]/copyfiles-defaults</em>.</p>
  </dd>
  <dt>
    <p><em>fstab</em></p>
  </dt>
  <dd>
    <p>A file in the format decribed in <a href="../man5/fstab.5.html"><strong>fstab</strong>(5)</a>, used to mount filesystems inside the chroot.  The mount location is relative to the root of the chroot.  Note that this was formerly named <em>\*[SCHROOT_SYSCONF_DIR]/mount-defaults</em>.</p>
  </dd>
  <dt>
    <p><em>nssdatabases</em></p>
  </dt>
  <dd>
    <p>System databases (as described in <em>/etc/nsswitch.conf</em> on GNU/Linux systems) to copy into the chroot from the host.  Note that this was formerly named <em>\*[SCHROOT_SYSCONF_DIR]/nssdatabases-defaults</em>.</p>
  </dd>

</dl>

<h3>Setup scripts</h3>
<p>The directory <em>\*[SCHROOT_CONF_SETUP_D]</em> contains the chroot setup scripts.</p>
<dl class='dl-vertical'>
  <dt>
    <p><em>00check</em></p>
  </dt>
  <dd>
    <p>Print debugging diagnostics and perform basic sanity checking.</p>
  </dd>
  <dt>
    <p><em>05file</em></p>
  </dt>
  <dd>
    <p>Unpack, clean up, and repack file-based chroots.</p>
  </dd>
  <dt>
    <p><em>05fsunion</em></p>
  </dt>
  <dd>
    <p>Create and remove union filesystems.</p>
  </dd>
  <dt>
    <p><em>05lvm</em></p>
  </dt>
  <dd>
    <p>Create and remove LVM snapshots.</p>
  </dd>
  <dt>
    <p><em>10mount</em></p>
  </dt>
  <dd>
    <p>Mount and unmount filesystems.</p>
  </dd>
  <dt>
    <p><em>15binfmt</em></p>
  </dt>
  <dd>
    <p>Sets up the QEMU user emulator using binfmt-support.  This permits a chroot for a different CPU architecture to be used transparently, providing an alternative to cross-compiling or whole-machine emulation.</p>
  </dd>
  <dt>
    <p><em>15killprocs</em></p>
  </dt>
  <dd>
    <p>Kill processes still running inside the chroot when ending a session, which would prevent unmounting of filesystems and cleanup of any other resources.</p>
  </dd>
  <dt>
    <p><em>20copyfiles</em></p>
  </dt>
  <dd>
    <p>Copy files from the host system into the chroot.  Configure networking by copying <em>hosts</em> and <em>resolv.conf</em>, for example.</p>
  </dd>
  <dt>
    <p><em>20nssdatabases</em></p>
  </dt>
  <dd>
    <p>Configure system databases by copying passwd, shadow, group etc. into the chroot.</p>
  </dd>
  <dt>
    <p><em>50chrootname</em></p>
  </dt>
  <dd>
    <p>Set the chroot name (<em>/etc/debian_chroot</em>) in the chroot.  This may be used by the shell prompt to display the current chroot.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p>Roger Leigh.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2005-2012  Roger Leigh &lt;rleigh@debian.org&gt;</p><p><strong>\*[PROGRAM]</strong> is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO schroot-setup&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/schroot.1.html"><strong>schroot</strong>(1)</a>, <a href="../man5/fstab.5.html"><strong>fstab</strong>(5)</a>, <a href="../man5/schroot.conf.5.html"><strong>schroot.conf</strong>(5)</a>, <a href="../man5/schroot-script-config.5.html"><strong>schroot-script-config</strong>(5)</a>, <a href="../man8/run-parts.8.html"><strong>run-parts</strong>(8)</a>.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="schroot-script-config.5.html"><span aria-hidden="true">&larr;</span> schroot-script-config.5: Schroot chroot setup script configuration</a></li>
   <li class="next"><a href="schroot.conf.5.html">schroot.conf.5: Chroot definition file for schroot <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
