<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>shorewall6-rules: Shorewall6 rules file</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Shorewall6 rules file">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="shorewall6-rules (5) manual">
  <meta name="twitter:description" content="Shorewall6 rules file">
  <meta name="twitter:image" content="https://www.carta.tech/images/shorewall6-shorewall6-rules-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/shorewall6-rules.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="shorewall6-rules (5) manual" />
  <meta property="og:description" content="Shorewall6 rules file" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/shorewall6-shorewall6-rules-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">shorewall6-rules<small> (5)</small></h1>
        <p class="lead">Shorewall6 rules file</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/shorewall6-rules.5.html">
      <span itemprop="name">shorewall6-rules: Shorewall6 rules file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/shorewall6/">
      <span itemprop="name">shorewall6</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/shorewall6-rules.5.html">
      <span itemprop="name">shorewall6-rules: Shorewall6 rules file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>/etc/shorewall6/rules</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Entries in this file govern connection establishment by defining exceptions to the policies laid out in \m[blue]<strong>shorewall6-policy</strong>\m[]\s-2\u[1]\d\s+2(5). By default, subsequent requests and responses are automatically allowed using connection tracking. For any particular (source,dest) pair of zones, the rules are evaluated in the order in which they appear in this file and the first terminating match is the one that determines the disposition of the request. All rules are terminating except LOG and QUEUE rules.</p><p>The rules file is divided into sections. Each section is introduced by a "Section Header" which is a line beginning with [?]SECTION and followed by the section name.</p><p>The optional "?" was added in Shorewalll 4.6.0 and is preferred. Existing configurations may be converted to use this form using the <strong>shorewall6 update</strong> command.</p><p>Sections are as follows and must appear in the order listed:</p><p><strong>ALL</strong></p><p>This section was added in Shorewall 4.4.23. rules in this section are applied, regardless of the connection tracking state of the packet.</p><p><strong>ESTABLISHED</strong></p><p>Packets in the ESTABLISHED state are processed by rules in this section.</p><p>The only ACTIONs allowed in this section are ACCEPT, DROP, REJECT, LOG and QUEUE</p><p>There is an implicit ACCEPT rule inserted at the end of this section.</p><p><strong>RELATED</strong></p><p>Packets in the RELATED state are processed by rules in this section.</p><p>The only ACTIONs allowed in this section are ACCEPT, DROP, REJECT, LOG and QUEUE</p><p>There is an implicit rule added at the end of this section that invokes the RELATED_DISPOSITION (\m[blue]<strong>shorewall6.conf</strong>\m[]\s-2\u[2]\d\s+2(5)).</p><p><strong>INVALID</strong></p><p>Added in Shorewall 4.5.13. Packets in the INVALID state are processed by rules in this section.</p><p>The only Actions allowed in this section are ACCEPT, DROP, REJECT, LOG and QUEUE.</p><p>There is an implicit rule added at the end of this section that invokes the INVALID_DISPOSITION (\m[blue]<strong>shorewall6.conf</strong>\m[]\s-2\u[2]\d\s+2(5)).</p><p><strong>UNTRACKED</strong></p><p>Added in Shorewall 4.5.13. Packets in the UNTRACKED state are processed by rules in this section.</p><p>The only Actions allowed in this section are ACCEPT, DROP, REJECT, LOG and QUEUE.</p><p>There is an implicit rule added at the end of this section that invokes the UNTRACKED_DISPOSITION (\m[blue]<strong>shorewall6.conf</strong>\m[]\s-2\u[2]\d\s+2(5)).</p><p><strong>NEW</strong></p><p>Packets in the NEW, INVALID and UNTRACKED states are processed by rules in this section.</p><p><strong>Note</strong></p><p>If you are not familiar with Netfilter to the point where you are comfortable with the differences between the various connection tracking states, then it is suggested that you omit the <strong>ESTABLISHED</strong> and <strong>RELATED</strong> sections and place all of your rules in the NEW section (That&apos;s after the line that reads SECTION NEW&apos;).</p><p><strong>Warning</strong></p><p>If you specify FASTACCEPT=Yes in \m[blue]<strong>shorewall6.conf</strong>\m[]\s-2\u[2]\d\s+2(5) then the <strong>ESTABLISHED</strong> and <strong>RELATED</strong> sections must be empty.</p><p>An except is made if you are running Shorewall 4.4.27 or later and you have specified a non-default value for RELATED_DISPOSITION or RELATED_LOG_LEVEL. In that case, you may have rules in the RELATED section of this file.</p><p>You may omit any section that you don&apos;t need. If no Section Headers appear in the file then all rules are assumed to be in the NEW section.</p><p>The columns in the file are as follows (where the column name is followed by a different name in parentheses, the different name is used in the alternate specification syntax).</p><p><strong>ACTION</strong> - <strong></strong><em>target</em><strong>[:</strong>{<em>log-level</em>|<strong>none</strong>}[<strong></strong><strong>!</strong>][<strong>:</strong><em>tag</em>]]</p><p>Specifies the action to be taken if the connection request matches the rule. <em>target</em> must be one of the following.</p><p><strong>ACCEPT</strong></p><p>Allow the connection request.</p><p><strong>ACCEPT+</strong></p><p>like ACCEPT but also excludes the connection from any subsequent matching <strong>DNAT</strong>[<strong>-</strong>] or <strong>REDIRECT</strong>[<strong>-</strong>] rules. Requires Shorewall 4.5.14 or later.</p><p><strong>ACCEPT!</strong></p><p>like ACCEPT but exempts the rule from being suppressed by OPTIMIZE=1 in \m[blue]<strong>shorewall6.conf</strong>\m[]\s-2\u[2]\d\s+2(5).</p><p><em>action</em></p><p>The name of an <em>action</em> declared in \m[blue]<strong>shorewall6-actions</strong>\m[]\s-2\u[3]\d\s+2(5) or in /usr/share/shorewall/actions.std.</p><p><strong>ADD(</strong><strong></strong><em>ipset</em><strong>:</strong><strong></strong><em>flags</em><strong>)</strong></p><p>Added in Shorewall 4.4.12. Causes addresses and/or port numbers to be added to the named <em>ipset</em>. The <em>flags</em> specify the address or tuple to be added to the set and must match the type of ipset involved. For example, for an iphash ipset, either the SOURCE or DESTINATION address can be added using <em>flags</em> <strong>src</strong> or <strong>dst</strong> respectively (see the -A command in ipset (8)).</p><p>ADD is non-terminating. Even if a packet matches the rule, it is passed on to the next rule.</p><p>AUDIT[(accept|drop|reject)]</p><p>Added in Shorewall 4.5.10. Audits the packet with the specified type; if the type is omitted, then <strong>drop</strong> is assumed. Require AUDIT_TARGET support in the kernel and iptables.</p><p>A_ACCEPT, and A_ACCEPT!</p><p>Added in Shorewall 4.4.20. Audited versions of ACCEPT and ACCEPT! respectively. Require AUDIT_TARGET support in the kernel and iptables.</p><p>A_DROP and A_DROP!</p><p>Added in Shorewall 4.4.20. Audited versions of DROP and DROP! respectively. Require AUDIT_TARGET support in the kernel and iptables.</p><p>A_REJECT AND A_REJECT!</p><p>Added in Shorewall 4.4.20. Audited versions of REJECT and REJECT! respectively. Require AUDIT_TARGET support in the kernel and iptables.</p><p><strong>[?]COMMENT</strong></p><p>the rest of the line will be attached as a comment to the Netfilter rule(s) generated by the following entries. The comment will appear delimited by "/* ... */" in the output of "shorewall show &lt;chain&gt;". To stop the comment from being attached to further rules, simply include COMMENT on a line by itself.</p><p><strong>Note</strong></p><p>Beginning with Shorewall 4.5.11, ?COMMENT is a synonym for COMMENT and is preferred.</p><p><strong>CONTINUE</strong></p><p>For experts only.</p><p>Do not process any of the following rules for this (source zone,destination zone). If the source and/or destination IP address falls into a zone defined later in \m[blue]<strong>shorewall6-zones</strong>\m[]\s-2\u[4]\d\s+2(5) or in a parent zone of the source or destination zones, then this connection request will be passed to the rules defined for that (those) zone(s). See \m[blue]<strong>shorewall6-nesting</strong>\m[]\s-2\u[5]\d\s+2(5) for additional information.</p><p><strong>CONTINUE!</strong></p><p>like CONTINUE but exempts the rule from being suppressed by OPTIMIZE=1 in \m[blue]<strong>shorewall6.conf</strong>\m[]\s-2\u[2]\d\s+2(5).</p><p><strong>COUNT</strong></p><p>Simply increment the rule&apos;s packet and byte count and pass the packet to the next rule.</p><p><strong>DEL(</strong><strong></strong><em>ipset</em><strong>:</strong><strong></strong><em>flags</em><strong>)</strong></p><p>Added in Shorewall 4.4.12. Causes an entry to be deleted from the named <em>ipset</em>. The <em>flags</em> specify the address or tuple to be deleted from the set and must match the type of ipset involved. For example, for an iphash ipset, either the SOURCE or DESTINATION address can be deleted using <em>flags</em> <strong>src</strong> or <strong>dst</strong> respectively (see the -D command in ipset (8)).</p><p>DEL is non-terminating. Even if a packet matches the rule, it is passed on to the next rule.</p><p><strong>DNAT</strong></p><p>Forward the request to another system (and optionally another port). Requires Shorewall 4.5.14 or later.</p><p><strong>DNAT-</strong></p><p>Advanced users only.</p><p>Like <strong>DNAT</strong> but only generates the <strong>DNAT</strong> iptables rule and not the companion <strong>ACCEPT</strong> rule. Requires Shorewall 4.5.14 or later.</p><p><strong>DROP</strong></p><p>Ignore the request.</p><p><strong>DROP!</strong></p><p>like DROP but exempts the rule from being suppressed by OPTIMIZE=1 in \m[blue]<strong>shorewall6.conf</strong>\m[]\s-2\u[2]\d\s+2(5).</p><p>HELPER</p><p>Added in Shorewall 4.5.7. This action requires that the HELPER column contains the name of the Netfilter helper to be associated with connections matching this connection. May only be specified in the NEW section and is useful for being able to specify a helper when the applicable policy is ACCEPT. No destination zone should be specified in HELPER rules.</p><p><strong>INLINE</strong>[(<em>action</em>)]</p><p>Added in Shorewall 4.5.16. This action allows you to construct most of the rule yourself using ip6tables syntax. The part that you specify must follow a semicolon (&apos;;&apos;) and is completely free-form. If the target of the rule (the part following &apos;j&apos;) is something that Shorewall supports in the ACTION column, then you may enclose it in parentheses (e.g., INLINE(ACCEPT)). Otherwise, you can include it after the semicolon. In this case, you must declare the target as a builtin action in \m[blue]<strong>shorewall6-actions</strong>\m[]\s-2\u[3]\d\s+2(5).</p><p>Some considerations when using INLINE:</p><p>The <strong>p</strong>, <strong>s</strong>, <strong>d</strong>, <strong>i</strong>, <strong>o</strong>, <strong>policy</strong>, and state match (<strong>state</strong> or <strong>conntrack --ctstate</strong>) matches will always appear in the front of the rule in that order.</p><p>When multiple matches are specified, the compiler will keep them in the order in which they appear (excluding the above listed ones), but they will not necessarily be at the end of the generated rule. For example, if addresses are specified in the SOURCE and/or DEST columns, their generated matches will appear after those specified using &apos;;&apos;.</p><p>IP6TABLES({<em>ip6tables-target</em> [<em>option</em> ...])</p><p>This action allows you to specify an ip6tables target with options (e.g., &apos;IPTABLES(MARK --set-xmark 0x01/0xff)&apos;. If the <em>ip6tables-target</em> is not one recognized by Shorewall, the following error message will be issued:</p>
<pre>
    ERROR: Unknown target (<em>ip6tables-target</em>)
</pre>
<p>This error message may be eliminated by adding the<em> ip6tables-</em><em>target</em> as a builtin action in \m[blue]<strong>shorewall6-actions</strong>\m[]\s-2\u[6]\d\s+2(5).</p><p><strong>Important</strong></p><p>If you specify REJECT as the <em>ip6tables-target</em>, the target of the rule will be the i6ptables REJECT target and not Shorewall&apos;s builtin &apos;reject&apos; chain which is used when REJECT (see below) is specified as the <em>target</em> in the ACTION column.</p><p><strong>LOG:</strong><strong></strong><em>level</em></p><p>Simply log the packet and continue with the next rule.</p><p><em>macro</em><strong>[(</strong><strong></strong><em>macrotarget</em><strong>)]</strong></p><p>The name of a macro defined in a file named macro.<em>macro</em>. If the macro accepts an action parameter (Look at the macro source to see if it has PARAM in the TARGET column) then the <em>macro</em> name is followed by the parenthesized <em>macrotarget</em> (<strong>ACCEPT</strong>, <strong>DROP</strong>, <strong>REJECT</strong>, ...) to be substituted for the parameter.</p><p>Example: FTP(ACCEPT).</p><p>The older syntax where the macro name and the target are separated by a slash (e.g. FTP/ACCEPT) is still allowed but is deprecated.</p><p><strong>NFLOG</strong>[(<em>nflog-parameters</em>)]</p><p>Added in Shorewall 4.5.9.3. Queues matching packets to a back end logging daemon via a netlink socket then continues to the next rule. See \m[blue]<strong>http://www.shorewall.net/shorewall_logging.html</strong>\m[]\s-2\u[7]\d\s+2.</p><p>Similar to<strong> LOG:NFLOG</strong>[(<em>nflog-parameters</em>)], except that the log level is not changed when this ACTION is used in an action or macro and the invocation of that action or macro specifies a log level.</p><p><strong>NFQUEUE</strong>[(<em>queuenumber</em>)]</p><p>Queues the packet to a user-space application using the nfnetlink_queue mechanism. If a <em>queuenumber</em> is not specified, queue zero (0) is assumed.</p><p><strong>NFQUEUE![(</strong><strong></strong><em>queuenumber</em><strong>)]</strong></p><p>like NFQUEUE but exempts the rule from being suppressed by OPTIMIZE=1 in \m[blue]<strong>shorewall6.conf</strong>\m[]\s-2\u[2]\d\s+2(5).</p><p><strong>NONAT</strong></p><p>Excludes the connection from any subsequent <strong>DNAT</strong>[-] or <strong>REDIRECT</strong>[-] rules but doesn&apos;t generate a rule to accept the traffic. Requires Shorewall 4.5.14 or later.</p><p><strong>QUEUE</strong></p><p>Queue the packet to a user-space application such as ftwall (http://p2pwall.sf.net). The application may reinsert the packet for further processing.</p><p><strong>QUEUE!</strong></p><p>like QUEUE but exempts the rule from being suppressed by OPTIMIZE=1 in \m[blue]<strong>shorewall6.conf</strong>\m[]\s-2\u[2]\d\s+2(5).</p><p><strong>REDIRECT</strong></p><p>Redirect the request to a server running on the firewall. Requires Shorewall 4.5.14 or later.</p><p><strong>REDIRECT-</strong></p><p>Advanced users only.</p><p>Like <strong>REDIRECT</strong> but only generates the <strong>REDIRECT</strong> iptables rule and not the companion <strong>ACCEPT</strong> rule. Requires Shorewall 4.5.14 or later.</p><p><strong>REJECT</strong></p><p>disallow the request and return an icmp-unreachable or an RST packet.</p><p><strong>REJECT!</strong></p><p>like REJECT but exempts the rule from being suppressed by OPTIMIZE=1 in \m[blue]<strong>shorewall6.conf</strong>\m[]\s-2\u[2]\d\s+2(5).</p><p>The <em>target</em> may optionally be followed by ":" and a syslog log level (e.g, REJECT:info or Web(ACCEPT):debug). This causes the packet to be logged at the specified level. Note that if the <strong>ACTION</strong> involves destination network address translation (DNAT, REDIRECT, etc.) then the packet is logged <strong>before</strong> the destination address is rewritten.</p><p>If the <strong>ACTION</strong> names an <em>action</em> declared in \m[blue]<strong>shorewall-actions</strong>\m[]\s-2\u[8]\d\s+2(5) or in /usr/share/shorewall/actions.std then:</p><p>If the log level is followed by "!&apos; then all rules in the action are logged at the log level.</p><p>If the log level is not followed by "!" then only those rules in the action that do not specify logging are logged at the specified level.</p><p>The special log level <strong>none!</strong> suppresses logging by the action.</p><p>You may also specify <strong>ULOG</strong> or <strong>NFLOG</strong> (must be in upper case) as a log level.This will log to the ULOG or NFLOG target for routing to a separate log through use of ulogd (\m[blue]<strong>http://www.netfilter.org/projects/ulogd/index.html</strong>\m[]).</p><p>Actions specifying logging may be followed by a log tag (a string of alphanumeric characters) which is appended to the string generated by the LOGPREFIX (in \m[blue]<strong>shorewall6.conf</strong>\m[]\s-2\u[2]\d\s+2(5)).</p><p>Example: ACCEPT:info:ftp would include &apos;ftp &apos; at the end of the log prefix generated by the LOGPREFIX setting.</p><p><strong>SOURCE</strong> - {<em>zone</em>|<em>zone-list</em>[+]|<strong>{all|any}</strong>[<strong>+</strong>][<strong>-</strong>]}<strong>[:</strong><em>interface</em>][<strong>:</strong><strong></strong><strong>&lt;</strong>{<em>address-or-range</em>[,<em>address-or-range</em>]...[<em>exclusion</em>]<strong>&gt;</strong>|<em>exclusion</em>|<strong>+</strong><em>ipset</em>|<em>^countrycode-list</em>}</p><p>Source hosts to which the rule applies. May be a zone declared in /etc/shorewall6/zones, <strong>$FW</strong> to indicate the firewall itself, <strong>all</strong>, <strong>all+</strong>, <strong>all-</strong>, <strong>all+-</strong> or <strong>none</strong>.</p><p>Beginning with Shorewall 4.4.13, you may use a <em>zone-list </em>which consists of a comma-separated list of zones declared in \m[blue]<strong>shorewall6-zones</strong>\m[]\s-2\u[4]\d\s+2 (5). This <em>zone-list</em> may be optionally followed by "+" to indicate that the rule is to apply to intra-zone traffic as well as inter-zone traffic.</p><p>When <strong>none</strong> is used either in the <strong>SOURCE</strong> or <strong>DEST</strong> column, the rule is ignored.</p><p><strong>all</strong> means "All Zones", including the firewall itself. <strong>all-</strong> means "All Zones, except the firewall itself". When <strong>all</strong>[<strong>-</strong>] is used either in the <strong>SOURCE</strong> or <strong>DEST</strong> column intra-zone traffic is not affected. When <strong>all+</strong>[<strong>-</strong>] is "used, intra-zone traffic is affected. Beginning with Shorewall 4.4.13, exclusion is supported -- see see \m[blue]<strong>shorewall6-exclusion</strong>\m[]\s-2\u[9]\d\s+2(5).</p><p>Except when <strong>all</strong>[<strong>+</strong>][<strong>-</strong>] or <strong>any</strong>[<strong>+</strong>][<strong>-</strong>] is specified, clients may be further restricted to a list of networks and/or hosts by appending ":" and a comma-separated list of network and/or host addresses. Hosts may be specified by IP or MAC address; mac addresses must begin with "~" and must use "-" as a separator.</p><p><strong>any</strong> is equivalent to <strong>all</strong> when there are no nested zones. When there are nested zones, <strong>any</strong> only refers to top-level zones (those with no parent zones). Note that <strong>any</strong> excludes all vserver zones, since those zones are nested within the firewall zone.</p><p>Hosts may also be specified as an IP address range using the syntax <em>lowaddress</em>-<em>highaddress</em>. This requires that your kernel and ip6tables contain iprange match support. If your kernel and ip6tables have ipset match support then you may give the name of an ipset prefaced by "+". The ipset name may be optionally followed by a number from 1 to 6 enclosed in square brackets ([]) to indicate the number of levels of source bindings to be matched.</p><p>Beginning with Shorewall6 4.4.17, the primary IP address of a firewall interface can be specified by an ampersand (&apos;&&apos;) followed by the logical name of the interface as found in the INTERFACE column of \m[blue]<strong>shorewall6-interfaces</strong>\m[]\s-2\u[10]\d\s+2 (5).</p><p>Beginning with Shorewall 4.5.4, A <em>countrycode-list</em> may be specified. A countrycode-list is a comma-separated list of up to 15 two-character ISO-3661 country codes enclosed in square brackets (&apos;[...]&apos;) and preceded by a caret (&apos;^&apos;). When a single country code is given, the square brackets may be omitted. A list of country codes supported by Shorewall may be found at \m[blue]<strong>http://www.shorewall.net/ISO-3661.html</strong>\m[]\s-2\u[11]\d\s+2. Specifying a <em>countrycode-list</em> requires GeoIP Match support in your ip6tables and Kernel.</p><p>When an <em>interface</em> is not specified, you may omit the angled brackets (&apos;&lt;&apos; and &apos;&gt;&apos;) around the address(es) or you may supply them to improve readability.</p><p>You may exclude certain hosts from the set already defined through use of an <em>exclusion</em> (see \m[blue]<strong>shorewall6-exclusion</strong>\m[]\s-2\u[9]\d\s+2(5)).</p><p>Examples:</p><p>dmz:2002:ce7c::92b4:1::2</p><p>Host 2002:ce7c:92b4:1::2 in the DMZ</p><p>net:2001:4d48:ad51:24::/64</p><p>Subnet 2001:4d48:ad51:24::/64 on the Internet</p><p>loc:&lt;2002:cec792b4:1::2,2002:cec792b4:1::44&gt;</p><p>Hosts 2002:cec792b4:1::2 and 2002:cec792b4:1::44 in the local zone.</p><p>loc:~00-A0-C9-15-39-78</p><p>Host in the local zone with MAC address 00:A0:C9:15:39:78.</p><p>net:2001:4d48:ad51:24::/64!2001:4d48:ad51:24:6:/80!2001:4d48:ad51:24:6:/80</p><p>Subnet 2001:4d48:ad51:24::/64 on the Internet except for 2001:4d48:ad51:24:6:/80.</p><p>$FW:&eth0</p><p>The primary IP address of eth0 in the firewall zone (Shorewall6 4.4.17 and later).</p><p>Alternatively, clients may be specified by interface by appending ":" to the zone name followed by the interface name. For example, <strong>loc:eth1</strong> specifies a client that communicates with the firewall system through eth1. This may be optionally followed by another colon (":") and an IP/MAC/subnet address as described above (e.g., <strong>loc:eth1:&lt;2002:ce7c::92b4:1::2&gt;</strong>).</p><p>Examples:</p><p>loc:eth1:&lt;2002:cec792b4:1::2,2002:cec792b4:1::44&gt;</p><p>Hosts 2002:cec792b4:1::2 and 2002:cec792b4:1::44 in the Local zone, with <strong>both</strong> originating from eth1</p><p><strong></strong><strong>DEST</strong><strong> - {</strong><strong></strong><em>zone|zone-list</em><strong>[+]|</strong><strong></strong><strong>all</strong><strong>[</strong><strong></strong><strong>+</strong><strong>][</strong><strong></strong><strong>-</strong><strong>]}</strong><strong></strong><strong>[:</strong><strong></strong><em>interface</em><strong>][</strong><strong></strong><strong>:</strong><strong></strong><strong>&lt;</strong><strong>{</strong><strong></strong><em>address-or-range</em><strong>[,</strong><strong></strong><em>address-or-range</em><strong>]...[</strong><strong></strong><em>exclusion</em><strong>]</strong><strong></strong><strong>&gt;</strong><strong>|</strong><strong></strong><em>exclusion</em><strong>|</strong><strong></strong><strong>+</strong><strong></strong><em>ipset</em><strong>|^</strong><strong></strong><em>countrycode-list</em><strong>}[</strong><strong></strong><strong>:</strong><strong></strong><em>port</em><strong>[:</strong><strong></strong><strong>random</strong><strong>]]</strong></p><p>Location of Server. May be a zone declared in \m[blue]<strong>shorewall6-zones</strong>\m[]\s-2\u[4]\d\s+2(5), $<strong>FW</strong> to indicate the firewall itself, <strong>all</strong>. <strong>all+</strong> or <strong>none</strong>.</p><p>Beginning with Shorewall 4.4.13, you may use a <em>zone-list </em>which consists of a comma-separated list of zones declared in \m[blue]<strong>shorewall6-zones</strong>\m[]\s-2\u[4]\d\s+2 (5). Ths <em>zone-list</em> may be optionally followed by "+" to indicate that the rule is to apply to intra-zone traffic as well as inter-zone traffic. Beginning with Shorewall-4.4.13, exclusion is supported -- see see \m[blue]<strong>shorewall6-exclusion</strong>\m[]\s-2\u[9]\d\s+2(5).</p><p>Beginning with Shorewall6 4.4.17, the primary IP address of a firewall interface can be specified by an ampersand (&apos;&&apos;) followed by the logical name of the interface as found in the INTERFACE column of \m[blue]<strong>shorewall6-interfaces</strong>\m[]\s-2\u[10]\d\s+2 (5).</p><p>Beginning with Shorewall 4.5.4, A <em>countrycode-list</em> may be specified. A countrycode-list is a comma-separated list of up to 15 two-character ISO-3661 country codes enclosed in square brackets (&apos;[...]&apos;) and preceded by a caret (&apos;^&apos;). When a single country code is given, the square brackets may be omitted. A list of country codes supported by Shorewall may be found at \m[blue]<strong>http://www.shorewall.net/ISO-3661.html</strong>\m[]\s-2\u[11]\d\s+2. Specifying a <em>countrycode-list</em> requires GeoIP Match support in your ip6tables and Kernel.</p><p>When <strong>none</strong> is used either in the <strong>SOURCE</strong> or <strong>DEST</strong> column, the rule is ignored.</p><p>When <strong>all</strong> is used either in the <strong>SOURCE</strong> or <strong>DEST</strong> column intra-zone traffic is not affected. When <strong>all+</strong> is used, intra-zone traffic is affected.</p><p>If the DEST <em>zone</em> is a bport zone, then either:</p><p>the SOURCE must be <strong>all[+][-]</strong>, or</p><p>the SOURCE <em>zone</em> must be another bport zone associated with the same bridge, or</p><p>the SOURCE <em>zone</em> must be an ipv4 zone that is associated with only the same bridge.</p><p>Except when <strong>all</strong>[<strong>+]|[-</strong>] is specified, the server may be further restricted to a particular network, host or interface by appending ":" and the network, host or interface. See <strong>SOURCE</strong> above.</p><p>You may exclude certain hosts from the set already defined through use of an <em>exclusion</em> (see \m[blue]<strong>shorewall6-exclusion</strong>\m[]\s-2\u[9]\d\s+2(5)).</p><p>Restriction: MAC addresses are not allowed (this is a Netfilter restriction).</p><p>If you kernel and ip6tables have ipset match support then you may give the name of an ipset prefaced by "+". The ipset name may be optionally followed by a number from 1 to 6 enclosed in square brackets ([]) to indicate the number of levels of destination bindings to be matched. Only one of the <strong>SOURCE</strong> and <strong>DEST</strong> columns may specify an ipset name.</p><p>The <em>port</em> that the server is listening on may be included and separated from the server&apos;s IP address by ":". If omitted, the firewall will not modify the destination port. A destination port may only be included if the <strong>ACTION</strong> is <strong>DNAT</strong> or <strong>REDIRECT</strong>.</p><p>Example 1:</p><p><strong>loc:[2001:470:b:227::44]:3128</strong> specifies a local server at IP address 2001:470:b:227::44 and listening on port 3128.</p><p>Example 2:</p><p><strong>loc:[]:3128</strong> specifies that the destination port should be changed to 3128 but the IP address should remain the same.</p><p>The <em>port</em> may be specified as a service name. You may specify a port range in the form <em>lowport-highport</em> to cause connections to be assigned to ports in the range in round-robin fashion. When a port range is specified, <em>lowport</em> and <em>highport</em> must be given as integers; service names are not permitted. Additionally, the port range may be optionally followed by <strong>:random</strong> which causes assignment to ports in the list to be random.</p><p>If the <strong>ACTION</strong> is <strong>REDIRECT</strong> or <strong>REDIRECT-</strong>, this column needs only to contain the port number on the firewall that the request should be redirected to. That is equivalent to specifying <strong>$FW</strong>::<em>port</em>.</p><p><strong>PROTO</strong> - {<strong>-</strong>|<strong>tcp:syn</strong>|<strong>ipp2p</strong>|<strong>ipp2p:udp</strong>|<strong>ipp2p:all</strong>|<em>protocol-number</em>|<em>protocol-name</em>|<strong>all}</strong></p><p>Optional protocol - <strong>ipp2p</strong>* requires ipp2p match support in your kernel and ip6tables. <strong>tcp:syn</strong> implies <strong>tcp</strong> plus the SYN flag must be set and the RST,ACK and FIN flags must be reset.</p><p>Beginning with Shorewall6 4.4.19, this column can contain a comma-separated list of protocol-numbers and/or protocol names (e.g., <strong>tcp,udp</strong>).</p><p><strong>DEST PORT(S) </strong>(dport) - {<strong>-</strong>|<em>port-name-number-or-range</em>[<strong>,</strong><em>port-name-number-or-range</em>]...|+<em>ipset</em>}</p><p>Optional destination Ports. A comma-separated list of Port names (from <a href="../man5/services.5.html"><strong>services</strong>(5)</a>), port numbers or port ranges; if the protocol is <strong>icmp</strong>, this column is interpreted as the destination icmp-type(s). ICMP types may be specified as a numeric type, a numeric type and code separated by a slash (e.g., 3/4), or a typename. See \m[blue]<strong>http://www.shorewall.net/configuration_file_basics.htm#ICMP</strong>\m[]\s-2\u[12]\d\s+2. Note that prior to Shorewall6 4.4.19, only a single ICMP type may be listed.</p><p>If the protocol is <strong>ipp2p</strong>, this column is interpreted as an ipp2p option without the leading "--" (example <strong>bit</strong> for bit-torrent). If no port is given, <strong>ipp2p</strong> is assumed.</p><p>A port range is expressed as <em>lowport</em>:<em>highport</em>.</p><p>This column is ignored if <strong>PROTO</strong> = <strong>all</strong> but must be entered if any of the following columns are supplied. In that case, it is suggested that this field contain a dash (<strong>-</strong>).</p><p>If your kernel contains multi-port match support, then only a single Netfilter rule will be generated in this list and the <strong>CLIENT PORT(S)</strong> list below if:</p><p>1. There are 15 or less ports listed.</p><p>2. No port ranges are included or your kernel and ip6tables contain extended multi-port match support.</p><p>Beginning with Shorewall 4.6.0, an <em>ipset</em> name can be specified in this column. This is intended to be used with bitmap:port ipsets.</p><p><strong>SOURCE PORT(S)</strong> (sport) - {<strong>-</strong>|<em>port-name-number-or-range</em>[<strong>,</strong><em>port-name-number-or-range</em>]...|+<em>ipset</em>}</p><p>Optional source port(s). If omitted, any source port is acceptable. Specified as a comma- separated list of port names, port numbers or port ranges.</p><p>Beginning with Shorewall 4.5.15, you may place &apos;=&apos; in this column, provided that the DEST PORT(S) column is non-empty. This causes the rule to match when either the source port or the destination port in a packet matches one of the ports specified in DEST PORTS(S). Use of &apos;=&apos; requires multi-port match in your iptables and kernel.</p><p><strong>Warning</strong></p><p>Unless you really understand IP, you should leave this column empty or place a dash (<strong>-</strong>) in the column. Most people who try to use this column get it wrong.</p><p>If you don&apos;t want to restrict client ports but need to specify a later column, then place "-" in this column.</p><p>If your kernel contains multi-port match support, then only a single Netfilter rule will be generated if in this list and the <strong>DEST PORT(S)</strong> list above:</p><p>1. There are 15 or less ports listed.</p><p>2. No port ranges are included or your kernel and ip6tables contain extended multi-port match support.</p><p>Beginning with Shorewall 4.6.0, an ipset name can be specified in this column. This is intended to be used with bitmap:port ipsets.</p><p><strong>ORIGINAL DEST</strong> (origdest) - [<strong>-</strong>]</p><p>Included for compatibility with Shorewall. Enter &apos;-&apos; in this column if you need to specify one of the later columns.</p><p><strong>RATE LIMIT</strong> (rate) - [<strong>-</strong>|[{<em>s</em>|<strong>d</strong>}:[[<em>name</em>]:]]]<em>rate</em><strong>/</strong>{<strong>sec</strong>|<strong>min</strong>|<strong>hour</strong>|<strong>day</strong>}[:<em>burst</em>]</p><p>You may optionally rate-limit the rule by placing a value in this column:</p><p><em>rate</em> is the number of connections per interval (<strong>sec</strong> or <strong>min</strong>) and <em>burst</em> is the largest burst permitted. If no <em>burst</em> is given, a value of 5 is assumed. There may be no no white-space embedded in the specification.</p><p>Example: <strong>10/sec:20</strong></p><p>When <strong>s:</strong> or <strong>d:</strong> is specified, the rate applies per source IP address or per destination IP address respectively. The <em>name</em> may be chosen by the user and specifies a hash table to be used to count matching connections. If not given, the name <strong>shorewallN</strong> (where N is a unique integer) is assumed. Where more than one POLICY specifies the same name, the connections counts for the rules are aggregated and the individual rates apply to the aggregated count.</p><p><strong>USER/GROUP</strong> (user) - [<strong>!</strong>][<em>user-name-or-number-or-range</em>][<strong>:</strong><em>group-name-or-number-or-range</em>]</p><p>This optional column may only be non-empty if the SOURCE is the firewall itself.</p><p>When this column is non-empty, the rule applies only if the program generating the output is running under the effective <em>user</em> and/or <em>group</em> specified (or is NOT running under that id if "!" is given).</p><p>Beginning with Shorewall 4.5.8, multiple user or group names/ids separated by commas may be specified.</p><p>Examples:</p><p>joe</p><p>program must be run by joe</p><p>:kids</p><p>program must be run by a member of the &apos;kids&apos; group</p><p>!:kids</p><p>program must not be run by a member of the &apos;kids&apos; group</p><p>2001-2099</p><p>UIDs 2001 through 2099 (Shorewall 4.5.6 and later)</p><p><strong>MARK</strong> - [<strong>!</strong>]<em>value</em>[/<em>mask</em>][<strong>:C</strong>]</p><p>Defines a test on the existing packet or connection mark. The rule will match only if the test returns true.</p><p>If you don&apos;t want to define a test but need to specify anything in the following columns, place a "-" in this field.</p><p>!</p><p>Inverts the test (not equal)</p><p><em>value</em></p><p>Value of the packet or connection mark.</p><p><em>mask</em></p><p>A mask to be applied to the mark before testing.</p><p><strong>:C</strong></p><p>Designates a connection mark. If omitted, the packet mark&apos;s value is tested.</p><p><strong>CONNLIMIT</strong> - [<strong>!</strong>]<em>limit</em>[:<em>mask</em>]</p><p>May be used to limit the number of simultaneous connections from each individual host to <em>limit</em> connections. Requires connlimit match in your kernel and ip6tables. While the limit is only checked on rules specifying CONNLIMIT, the number of current connections is calculated over all current connections from the SOURCE host. By default, the limit is applied to each host but can be made to apply to networks of hosts by specifying a <em>mask</em>. The <em>mask</em> specifies the width of a VLSM mask to be applied to the source address; the number of current connections is then taken over all hosts in the subnet <em>source-address</em>/<em>mask</em>. When<strong> !</strong> is specified, the rule matches when the number of connection exceeds the <em>limit</em>.</p><p><strong>TIME</strong> - <em>timeelement</em>[&<em>timeelement</em>...]</p><p>May be used to limit the rule to a particular time period each day, to particular days of the week or month, or to a range defined by dates and times. Requires time match support in your kernel and ip6tables.</p><p><em>timeelement</em> may be:</p><p>timestart=<em>hh</em>:<em>mm</em>[:<em>ss</em>]</p><p>Defines the starting time of day.</p><p>timestop=<em>hh</em>:<em>mm</em>[:<em>ss</em>]</p><p>Defines the ending time of day.</p><p>utc</p><p>Times are expressed in Greenwich Mean Time.</p><p>localtz</p><p>Deprecated by the Netfilter team in favor of <strong>kerneltz</strong>. Times are expressed in Local Civil Time (default).</p><p>kerneltz</p><p>Added in Shorewall 4.5.2. Times are expressed in Local Kernel Time (requires iptables 1.4.12 or later).</p><p>weekdays=ddd[,ddd]...</p><p>where <em>ddd</em> is one of <strong>Mon</strong>, <strong>Tue</strong>, <strong>Wed</strong>, <strong>Thu</strong>, <strong>Fri</strong>, <strong>Sat</strong> or <strong>Sun</strong></p><p>monthdays=dd[,dd],...</p><p>where <em>dd</em> is an ordinal day of the month</p><p>datestart=<em>yyyy</em>[-<em>mm</em>[-<em>dd</em>[<strong>T</strong><em>hh</em>[:<em>mm</em>[:<em>ss</em>]]]]]</p><p>Defines the starting date and time.</p><p>datestop=<em>yyyy</em>[-<em>mm</em>[-<em>dd</em>[<strong>T</strong><em>hh</em>[:<em>mm</em>[:<em>ss</em>]]]]]</p><p>Defines the ending date and time.</p><p><strong>HEADERS - [!][any:|exactly:]</strong><em>header-list </em>(Optional - Added in Shorewall 4.4.15)</p><p>The <em>header-list</em> consists of a comma-separated list of headers from the following list.</p><p><strong>auth</strong>, <strong>ah</strong>, or <strong>51</strong></p><p>Authentication Headers extension header.</p><p><strong>esp</strong>, or <strong>50</strong></p><p>Encrypted Security Payload extension header.</p><p><strong>hop</strong>, <strong>hop-by-hop</strong> or <strong>0</strong></p><p>Hop-by-hop options extension header.</p><p><strong>route</strong>, <strong>ipv6-route</strong> or <strong>41</strong></p><p>IPv6 Route extension header.</p><p><strong>frag</strong>, <strong>ipv6-frag</strong> or <strong>44</strong></p><p>IPv6 fragmentation extension header.</p><p><strong>none</strong>, <strong>ipv6-nonxt</strong> or <strong>59</strong></p><p>No next header</p><p><strong>proto</strong>, <strong>protocol</strong> or <strong>255</strong></p><p>Any protocol header.</p><p>If <strong>any:</strong> is specified, the rule will match if any of the listed headers are present. If <strong>exactly:</strong> is specified, the will match packets that exactly include all specified headers. If neither is given, <strong>any:</strong> is assumed.</p><p>If <strong>!</strong> is entered, the rule will match those packets which would not be matched when <strong>!</strong> is omitted.</p><p><strong>SWITCH - [!]</strong><strong></strong><em>switch-name</em><strong>[={0|1}]</strong></p><p>Added in Shorewall6 4.4.24 and allows enabling and disabling the rule without requiring <strong>shorewall6 restart</strong>.</p><p>Enables the rule if the value stored in /proc/net/nf_condition/<em>switch-name</em> is 1. Disables the rule if that file contains 0 (the default). If &apos;!&apos; is supplied, the test is inverted such that the rule is enabled if the file contains 0.</p><p>Within the <em>switch-name</em>, &apos;@0&apos; and &apos;@{0}&apos; are replaced by the name of the chain to which the rule is a added. The <em>switch-name</em> (after &apos;@...&apos; expansion) must begin with a letter and be composed of letters, decimal digits, underscores or hyphens. Switch names must be 30 characters or less in length.</p><p>Switches are normally <strong>off</strong>. To turn a switch <strong>on</strong>:</p><p><strong>echo 1 &gt;</strong></p>
<pre>
            /proc/net/nf_condition/<strong></strong><em>switch-name</em>
</pre>
<p>To turn it <strong>off</strong> again:</p><p><strong>echo 0 &gt;</strong></p>
<pre>
            /proc/net/nf_condition/<strong></strong><em>switch-name</em>
</pre>
<p>Switch settings are retained over <strong>shorewall6 restart</strong>.</p><p>Beginning with Shorewall 4.5.10, when the <em>switch-name</em> is followed by <strong>=0</strong> or <strong>=1</strong>, then the switch is initialized to off or on respectively by the <strong>start</strong> command. Other commands do not affect the switch setting.</p><p><strong>HELPER</strong> - [helper]</p><p>Added in Shorewall 4.5.7.</p><p>In the NEW section, causes the named conntrack <em>helper</em> to be associated with this connection; the contents of this column are ignored unless ACTION is ACCEPT*, DNAT* or REDIRECT*.</p><p>In the RELATED section, will only match if the related connection has the named <em>helper</em> associated with it.</p><p>The <em>helper</em> may be one of:</p><p><strong>amanda</strong></p><p><strong>ftp</strong></p><p><strong>irc</strong></p><p><strong>netbios-ns</strong></p><p><strong>pptp</strong></p><p><strong>Q.931</strong></p><p><strong>RAS</strong></p><p><strong>sane</strong></p><p><strong>sip</strong></p><p><strong>snmp</strong></p><p><strong>tftp</strong></p><p>If the HELPERS option is specified in \m[blue]<strong>shorewall6.conf</strong>\m[]\s-2\u[2]\d\s+2(5), then any module specified in this column must be listed in the HELPERS setting.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>Example 1:</p><p>Accept SMTP requests from the DMZ to the internet</p>
<pre>
         #ACTION SOURCE  DEST PROTO      DEST    SOURCE  ORIGINAL
         #                               PORT    PORT(S) DEST
         ACCEPT  dmz     net       tcp   smtp
</pre>
<p>Example 4:</p><p>You want to accept SSH connections to your firewall only from internet IP addresses 2002:ce7c::92b4:1::2 and 2002:ce7c::92b4:1::22</p>
<pre>
        #ACTION  SOURCE DEST            PROTO   DEST    SOURCE  ORIGINAL
        #                                       PORT    PORT(S) DEST
        ACCEPT   net:&lt;2002:ce7c::92b4:1::2,2002:ce7c::92b4:1::22&gt; &#92;
                        $FW              tcp     22
</pre>
<p>Example 5:</p><p>You wish to limit SSH connections from remote systems to 1/min with a burst of three (to allow for limited retry):</p>
<pre>
        #ACTION     SOURCE          DEST       PROTO       DEST         SOURCE    ORIGINAL         RATE
        #                                                  PORT(S)      PORT(S)   DEST             LIMIT
        SSH(ACCEPT) net             all        -           -            -         -                s:1/min:3
</pre>
<p>Example 6:</p><p>Forward port 80 to dmz host $BACKUP if switch &apos;primary_down&apos; is set.</p>
<pre>
        #ACTION     SOURCE          DEST        PROTO       DEST         SOURCE    ORIGINAL   RATE      USER/     MARK    CONNLIMIT     TIME     HEADERS    SWITCH
        #                                                   PORT(S)      PORT(S)   DEST       LIMIT     GROUP
        DNAT        net             dmz:$BACKUP tcp         80           -         -          -         -         -       -             -        -          primary_down
</pre>
<p>Example 7:</p><p>Drop all email from IP addresses in the country whose ISO-3661 country code is ZZ.</p>
<pre>
        #ACTION                       SOURCE           DEST           PROTO       DEST
        #                                                                         PORT(S)
        DROP                          net:^ZZ          fw             tcp         25
</pre>
<p>Example 8:</p><p>You want to generate your own rule involving ip6tables targets and matches not supported by Shorewall.</p>
<pre>
        #ACTION                       SOURCE           DEST           PROTO       DEST
        #                                                                         PORT(S)
        INLINE                        $FW              net ; -p 6 -m mickey-mouse --name test -m set --match-set set1 src -m mickey-mouse --name test2 -j SECCTX --name test3
</pre>
<p>The above will generate the following ip6tables-restore input:</p>
<pre>
        -A fw2net -p 6 -m mickey-mouse --name test -m set --match-set set1 src -m mickey-mouse --name test2 -j SECCTX --name test3
</pre>
<p>Note that SECCTX must be defined as a builtin action in \m[blue]<strong>shorewall6-actions</strong>\m[]\s-2\u[3]\d\s+2(5):</p>
<pre>
        #ACTION            OPTIONS
        SECCTX             builtin
</pre>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/etc/shorewall6/rules</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO shorewall6-rules&hellip;</h2>
        <div class="sectioncontent">
<p>\m[blue]<strong>http://www.shorewall.net/shorewall_logging.html</strong>\m[]\s-2\u[7]\d\s+2</p><p>\m[blue]<strong>http://www.shorewall.net/configuration_file_basics.htm#Pairs</strong>\m[]\s-2\u[13]\d\s+2</p><p><strong>shorewall6</strong>(8), <a href="../man5/shorewall6-accounting.5.html"><strong>shorewall6-accounting</strong>(5)</a>, <a href="../man5/shorewall6-actions.5.html"><strong>shorewall6-actions</strong>(5)</a>, <a href="../man5/shorewall6-blacklist.5.html"><strong>shorewall6-blacklist</strong>(5)</a>, <a href="../man5/shorewall6-blrules.5.html"><strong>shorewall6-blrules</strong>(5)</a>, <a href="../man5/shorewall6-hosts.5.html"><strong>shorewall6-hosts</strong>(5)</a>, <a href="../man5/shorewall6-interfaces.5.html"><strong>shorewall6-interfaces</strong>(5)</a>, <a href="../man5/shorewall6-maclist.5.html"><strong>shorewall6-maclist</strong>(5)</a>, <a href="../man5/shorewall6-netmap.5.html"><strong>shorewall6-netmap</strong>(5)</a>,<a href="../man5/shorewall6-params.5.html"><strong>shorewall6-params</strong>(5)</a>, <a href="../man5/shorewall6-policy.5.html"><strong>shorewall6-policy</strong>(5)</a>, <a href="../man5/shorewall6-providers.5.html"><strong>shorewall6-providers</strong>(5)</a>, <a href="../man5/shorewall6-rtrules.5.html"><strong>shorewall6-rtrules</strong>(5)</a>, <a href="../man5/shorewall6-routestopped.5.html"><strong>shorewall6-routestopped</strong>(5)</a>, <a href="../man5/shorewall6.conf.5.html"><strong>shorewall6.conf</strong>(5)</a>, <a href="../man5/shorewall6-secmarks.5.html"><strong>shorewall6-secmarks</strong>(5)</a>, <a href="../man5/shorewall6-tcclasses.5.html"><strong>shorewall6-tcclasses</strong>(5)</a>, <a href="../man5/shorewall6-tcdevices.5.html"><strong>shorewall6-tcdevices</strong>(5)</a>, <a href="../man5/shorewall6-mangle.5.html"><strong>shorewall6-mangle</strong>(5)</a>, <a href="../man5/shorewall6-tos.5.html"><strong>shorewall6-tos</strong>(5)</a>, <a href="../man5/shorewall6-tunnels.5.html"><strong>shorewall6-tunnels</strong>(5)</a>, <a href="../man5/shorewall6-zones.5.html"><strong>shorewall6-zones</strong>(5)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
     1.
  </dt>
  <dd>
    <p>shorewall6-policy</p><p>http://www.shorewall.net/manpages6/shorewall6-policy.html</p>
  </dd>
  <dt>
     2.
  </dt>
  <dd>
    <p>shorewall6.conf</p><p>http://www.shorewall.net/manpages6/shorewall6.conf.html</p>
  </dd>
  <dt>
     3.
  </dt>
  <dd>
    <p>shorewall6-actions</p><p>http://www.shorewall.net/manpages6/shorewall6-actions.html</p>
  </dd>
  <dt>
     4.
  </dt>
  <dd>
    <p>shorewall6-zones</p><p>http://www.shorewall.net/manpages6/shorewall6-zones.html</p>
  </dd>
  <dt>
     5.
  </dt>
  <dd>
    <p>shorewall6-nesting</p><p>http://www.shorewall.net/manpages6/shorewall6-nesting.html</p>
  </dd>
  <dt>
     6.
  </dt>
  <dd>
    <p>shorewall6-actions</p><p>http://www.shorewall.netshorewall6-actions.html</p>
  </dd>
  <dt>
     7.
  </dt>
  <dd>
    <p>http://www.shorewall.net/shorewall_logging.html</p><p>http://www.shorewall.net/shorewall_logging.html</p>
  </dd>
  <dt>
     8.
  </dt>
  <dd>
    <p>shorewall-actions</p><p>http://www.shorewall.net/manpages/shorewall-actions.html</p>
  </dd>
  <dt>
     9.
  </dt>
  <dd>
    <p>shorewall6-exclusion</p><p>http://www.shorewall.net/manpages6/shorewall6-exclusion.html</p>
  </dd>
  <dt>
    10.
  </dt>
  <dd>
    <p>shorewall6-interfaces</p><p>http://www.shorewall.net/manpages6/shorewall6-interfaces.html</p>
  </dd>
  <dt>
    11.
  </dt>
  <dd>
    <p>http://www.shorewall.net/ISO-3661.html</p><p>http://www.shorewall.net/ISO-3661.html</p>
  </dd>
  <dt>
    12.
  </dt>
  <dd>
    <p>http://www.shorewall.net/configuration_file_basics.htm#ICMP</p><p>http://www.shorewall.net/configuration_file_basics.htm#ICMP</p>
  </dd>
  <dt>
    13.
  </dt>
  <dd>
    <p>http://www.shorewall.net/configuration_file_basics.htm#Pairs</p><p>http://www.shorewall.net/configuration_file_basics.htm#Pairs</p>
  </dd>

</dl>

        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="shorewall6-rtrules.5.html"><span aria-hidden="true">&larr;</span> shorewall6-rtrules.5: Shorewall6 routing rules file</a></li>
   <li class="next"><a href="shorewall6-secmarks.5.html">shorewall6-secmarks.5: Shorewall6 file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
