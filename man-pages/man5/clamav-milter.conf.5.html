<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>clamav-milter.conf: Configuration file for clamav-milter</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Configuration file for clamav-milter">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="clamav-milter.conf (5) manual">
  <meta name="twitter:description" content="Configuration file for clamav-milter">
  <meta name="twitter:image" content="https://www.carta.tech/images/clamav-milter-clamav-milter.conf-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/clamav-milter.conf.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="clamav-milter.conf (5) manual" />
  <meta property="og:description" content="Configuration file for clamav-milter" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/clamav-milter-clamav-milter.conf-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">clamav-milter.conf<small> (5)</small></h1>
        <p class="lead">Configuration file for clamav-milter</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/clamav-milter.conf.5.html">
      <span itemprop="name">clamav-milter.conf: Configuration file for clamav-milter</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/clamav-milter/">
      <span itemprop="name">clamav-milter</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/clamav-milter.conf.5.html">
      <span itemprop="name">clamav-milter.conf: Configuration file for clamav-milter</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>clamav-milter.conf contains the configuration options for <a href="../man8/clamav-milter.8.html"><strong>clamav-milter</strong>(8)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILE FORMAT</h2>
        <div class="sectioncontent">
<p>The file consists of comments and options with arguments. Each line which starts with a hash (<strong>#</strong>) symbol is ignored by the parser. Options and arguments are case sensitive and of the form <strong>Option Argument</strong>. The arguments are of the following types:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>BOOL</strong></p>
  </dt>
  <dd>
    <p>Boolean value (yes/no or true/false or 1/0).</p>
  </dd>
  <dt>
    <p><strong>STRING</strong></p>
  </dt>
  <dd>
    <p>String without blank characters.</p>
  </dd>
  <dt>
    <p><strong>SIZE</strong></p>
  </dt>
  <dd>
    <p>Size in bytes. You can use 'M' or 'm' modifiers for megabytes and 'K' or 'k' for kilobytes.</p>
  </dd>
  <dt>
    <p><strong>NUMBER</strong></p>
  </dt>
  <dd>
    <p>Unsigned integer.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MAIN OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>Example</strong></p>
  </dt>
  <dd>
    <p>If this option is set clamav-milter will not run.</p>
  </dd>
  <dt>
    <p><strong>MilterSocket STRING</strong></p>
  </dt>
  <dd>
    <p>Define the interface through which we communicate with sendmail. This option is mandatory!</p><p>Possible formats are:</p><p>[[unix|local\]:\]/path/to/file - to specify a unix domain socket</p><p>inet:port@[hostname|ip-address] - to specify an ipv4 socket</p><p>inet6:port@[hostname|ip-address] - to specify an ipv6 socket</p><p>Default: unset</p>
  </dd>
  <dt>
    <p><strong>MilterSocketGroup STRING</strong></p>
  </dt>
  <dd>
    <p>Define the group ownership for the (unix) milter socket.</p><p>Default: disabled (the primary group of the user running clamd)</p>
  </dd>
  <dt>
    <p><strong>MilterSocketMode STRING</strong></p>
  </dt>
  <dd>
    <p>Sets the permissions on the (unix) milter socket to the specified mode.</p><p>Default: disabled (obey umask)</p>
  </dd>
  <dt>
    <p><strong>FixStaleSocket BOOL</strong></p>
  </dt>
  <dd>
    <p>Remove stale socket after unclean shutdown.</p><p>Default: yes</p>
  </dd>
  <dt>
    <p><strong>User STRING</strong></p>
  </dt>
  <dd>
    <p>Run as another user (clamav-milter must be started by root for this option to work)</p><p>Default: unset (don\'t drop privileges)</p>
  </dd>
  <dt>
    <p><strong>ReadTimeout NUMBER</strong></p>
  </dt>
  <dd>
    <p>Waiting for data from clamd will timeout after this time (seconds).</p><p>Default: 120</p>
  </dd>
  <dt>
    <p><strong>Foreground BOOL</strong></p>
  </dt>
  <dd>
    <p>Don\'t fork into background.</p><p>Default: no</p>
  </dd>
  <dt>
    <p><strong>Chroot STRING</strong></p>
  </dt>
  <dd>
    <p>Chroot to the specified directory. Chrooting is performed just after reading the config file and before dropping privileges.</p><p>Default: unset (don\'t chroot)</p>
  </dd>
  <dt>
    <p><strong>PidFile STRING</strong></p>
  </dt>
  <dd>
    <p>Save the process identifier of a clamav-milter (main thread) to a specified file.</p><p>Default: disabled</p>
  </dd>
  <dt>
    <p><strong>TemporaryDirectory STRING</strong></p>
  </dt>
  <dd>
    <p>Optional path to the global temporary directory.</p><p>Default: system specific (usually /tmp or /var/tmp).</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CLAMD OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>ClamdSocket STRING</strong></p>
  </dt>
  <dd>
    <p>Define the clamd socket to connect to for scanning. This option is mandatory! Syntax:</p><p>ClamdSocket unix:path</p><p>ClamdSocket tcp:host:port</p><p>The first syntax specifies a local unix socket (needs an absolute path) e.g.:</p><p>ClamdSocket unix:/var/run/clamd/clamd.socket</p><p>The second syntax specifies a tcp local or remote tcp socket: the host can be a hostname or an ip address; the ":port" field is only required for IPv6 addresses, otherwise it defaults to 3310 e.g.:</p><p>ClamdSocket tcp:192.168.0.1</p><p>This option can be repeated several times with different sockets or even with the same socket: clamd servers will be selected in a round-robin fashion.</p><p>Default: no default</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXCLUSIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>LocalNet STRING</strong></p>
  </dt>
  <dd>
    <p>Messages originating from these hosts/networks will not be scanned. This option takes a host(name)/mask pair in CIRD notation and can be repeated several times. If "/mask" is omitted, a host is assumed. To specify a locally orignated, non-smtp, email use the keyword "local"</p><p>Default: unset (scan everything regardless of the origin)</p>
  </dd>
  <dt>
    <p><strong>Whitelist STRING</strong></p>
  </dt>
  <dd>
    <p>This option specifies a file which contains a list of basic POSIX regular expressions. Addresses (sent to or from - see below) matching these regexes  will not be scanned.  Optionally each line can start with the string "From:" or "To:" (note: no whitespace after the colon) indicating if it is,  respectively, the sender or recipient that is to be whitelisted. If the field is missing, "To:" is assumed.  Lines starting with #, : or ! are ignored.</p><p>Default: unset (no exclusion applied)</p>
  </dd>
  <dt>
    <p><strong>SkipAuthenticated STRING</strong></p>
  </dt>
  <dd>
    <p>Messages from authenticated SMTP users matching this extended POSIX regular expression (egrep-like) will not be scanned.  As an alternative, a file containing a plain (not regex) list of names (one per line) can be specified using the prefix "file:".  e.g. SkipAuthenticated file:/etc/good_guys. Note: this is the AUTH login name!</p><p>Default: unset (no whitelisting based on SMTP auth)</p>
  </dd>
  <dt>
    <p><strong>MaxFileSize SIZE</strong></p>
  </dt>
  <dd>
    <p>Messages larger than this value won\'t be scanned. Make sure this value is lower or equal than StreamMaxLength in clamd.conf</p><p>Default: 25M</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ACTIONS</h2>
        <div class="sectioncontent">
<p>The following group of options controls the delievery process under  different circumstances. The following actions are available:</p><p>- Accept: The message is accepted for delievery</p><p>- Reject: Immediately refuse delievery (a 5xx error is returned to the peer)</p><p>- Defer: Return a temporary failure message (4xx) to the peer</p><p>- Blackhole (not available for OnFail): Like Accept but the message is sent to oblivion</p><p>- Quarantine (not available for OnFail): Like Accept but message is quarantined instead of being delivered. NOTE: In Sendmail the quarantine queue can be examined via mailq -qQ. For Postfix this causes the message to be placed on hold.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>OnClean STRING</strong></p>
  </dt>
  <dd>
    <p>Action to be performed on clean messages (mostly useful for testing)</p><p>Default: Accept</p>
  </dd>
  <dt>
    <p><strong>OnInfected STRING</strong></p>
  </dt>
  <dd>
    <p>Action to be performed on infected messages</p><p>Default: Quarantine</p>
  </dd>
  <dt>
    <p><strong>OnFail STRING</strong></p>
  </dt>
  <dd>
    <p>Action to be performed on error conditions (this includes failure to allocate data structures, no scanners available, network timeouts, unknown scanner replies and the like)</p><p>Default: Defer</p>
  </dd>
  <dt>
    <p><strong>RejectMsg STRING</strong></p>
  </dt>
  <dd>
    <p>This option allows you to set a specific rejection reason for infected messages and it\'s therefore only useful together with "OnInfected Reject". The string "%v", if present, will be replaced with the virus name.</p><p>Default: MTA specific</p>
  </dd>
  <dt>
    <p><strong>AddHeader STRING</strong></p>
  </dt>
  <dd>
    <p>If this option is set to "Replace" (or "Yes"), an "X-Virus-Scanned" and an "X-Virus-Status" headers will be attached to each processed message, possibly replacing existing headers.  If it is set to Add, the X-Virus headers are added possibly on top of the existing ones. Note that while "Replace" can potentially break DKIM signatures, "Add" may confuse procmail and similar filters.</p><p>Default: no</p>
  </dd>
  <dt>
    <p><strong>ReportHostname STRING</strong></p>
  </dt>
  <dd>
    <p>When AddHeader is in use, this option allows you to set the reported hostname. This may be desirable in order to avoid leaking internal names. If unset the real machine name is used.</p><p>Default: disabled</p>
  </dd>
  <dt>
    <p><strong>VirusAction STRING</strong></p>
  </dt>
  <dd>
    <p>Execute a command (possibly searching PATH) when an infected message is found. The following parameters are passed to the invoked program in this order: virus name, queue id, sender, destination, subject, message id, message date. Note #1: this requires MTA macroes to be available (see LogInfected below). Note #2: the process is invoked in the context of clamav-milter. Note #3: clamav-milter will wait for the process to exit. Be quick or fork to avoid unnecessary delays in email delievery.</p><p>Default: disabled</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOGGING OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>LogFile STRING</strong></p>
  </dt>
  <dd>
    <p>Enable logging to selected file.</p><p>Default: no</p>
  </dd>
  <dt>
    <p><strong>LogFileUnlock BOOL</strong></p>
  </dt>
  <dd>
    <p>Disable a system lock that protects against running clamd with the same configuration file multiple times.</p><p>Default: no</p>
  </dd>
  <dt>
    <p><strong>LogFileMaxSize SIZE</strong></p>
  </dt>
  <dd>
    <p>Limit the size of the log file. The logger will be automatically disabled if the file is greater than SIZE. Value of 0 disables the limit.</p><p>Default: 1M</p>
  </dd>
  <dt>
    <p><strong>LogTime BOOL</strong></p>
  </dt>
  <dd>
    <p>Log time for each message.</p><p>Default: no</p>
  </dd>
  <dt>
    <p><strong>LogSyslog BOOL</strong></p>
  </dt>
  <dd>
    <p>Use system logger (can work together with LogFile).</p><p>Default: no</p>
  </dd>
  <dt>
    <p><strong>LogFacility STRING</strong></p>
  </dt>
  <dd>
    <p>Specify the type of syslog messages - please refer to 'man syslog' for facility names.</p><p>Default: LOG_LOCAL6</p>
  </dd>
  <dt>
    <p><strong>LogVerbose BOOL</strong></p>
  </dt>
  <dd>
    <p>Enable verbose logging.</p><p>Default: no</p>
  </dd>
  <dt>
    <p><strong>LogInfected STRING</strong></p>
  </dt>
  <dd>
    <p>This option allows you to tune what is logged when a message is infected. Possible values are Off (the default - nothing is logged), Basic (minimal info logged), Full (verbose info logged)</p><p>Note: For this to work properly in sendmail, make sure the msg_id, mail_addr, rcpt_addr and i macroes are available in eom. In other words add a line like: Milter.macros.eom={msg_id}, {mail_addr}, {rcpt_addr}, i to your .cf file. Alternatively use the macro: define(`confMILTER_MACROS_EOM', `{msg_id}, {mail_addr}, {rcpt_addr}, i')</p><p>Postfix should be working fine with the default settings.</p><p>Default: disabled</p>
  </dd>
  <dt>
    <p><strong>LogClean STRING</strong></p>
  </dt>
  <dd>
    <p>This option allows you to tune what is logged when no threat is found in a scanned message.</p><p>See LogInfected for possible values and caveats.</p><p>Useful in debugging but drastically increases the log size.</p><p>Default: disabled</p>
  </dd>
  <dt>
    <p><strong>SupportMultipleRecipients BOOL</strong></p>
  </dt>
  <dd>
    <p>This option affects the behaviour of LogInfected, LogClean and VirusAction  when a message with multiple recipients is scanned:</p><p>If SupportMultipleRecipients is off (the default) then one single log entry is generated for the message and, in case the message is determined to be malicious, the command indicated by VirusAction is executed just once. In both cases only the last recipient is reported.</p><p>If SupportMultipleRecipients is on then one line is logged for each recipient and the command indicated by VirusAction is also executed once for each recipient.</p><p>Note: although it's probably a good idea to enable this option, the default value is currently set to off for legacy reasons.</p><p>Default: no</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">NOTES</h2>
        <div class="sectioncontent">
<p>All options expressing a size are limited to max 4GB. Values in excess will be resetted to the maximum.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/etc/clamav/clamav-milter.conf</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>aCaB &lt;acab@clamav.net&gt;</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO clamav-milter.conf&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/clamav-milter.8.html"><strong>clamav-milter</strong>(8)</a>, <a href="../man8/clamd.8.html"><strong>clamd</strong>(8)</a>, <a href="../man5/clamd.conf.5.html"><strong>clamd.conf</strong>(5)</a></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="chrony.conf.5.html"><span aria-hidden="true">&larr;</span> chrony.conf.5: Chronyd configuration file</a></li>
   <li class="next"><a href="clamd.conf.5.html">clamd.conf.5: Configuration file for clam antivirus daemon <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
