<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>perditiondb: Perdition modular popmap support</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Perdition modular popmap support">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="perditiondb (5) manual">
  <meta name="twitter:description" content="Perdition modular popmap support">
  <meta name="twitter:image" content="https://www.carta.tech/images/perdition-perditiondb-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/perditiondb.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="perditiondb (5) manual" />
  <meta property="og:description" content="Perdition modular popmap support" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/perdition-perditiondb-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">perditiondb<small> (5)</small></h1>
        <p class="lead">Perdition modular popmap support</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/perditiondb.5.html">
      <span itemprop="name">perditiondb: Perdition modular popmap support</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/perdition/">
      <span itemprop="name">perdition</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/perditiondb.5.html">
      <span itemprop="name">perditiondb: Perdition modular popmap support</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>Perdition supports a dynamic library mechanism to access arbitrary databases that resolve a user to a host and port.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DATABASE ACCESS LIBRARIES</h2>
        <div class="sectioncontent">
<p>If you are using the -s|--default server option then creating an empty database will cause all users to use the default server. Alternatively, setting no popmap by passing an empty string to the -m|--map_name option will cause no map lookups to take place and only the default server to be used.</p><p>E.g.: perdition -m ""</p><p>In this case, if no default server is set then perdition will still run but users will not be able to connect to a real server.</p><p><strong>GDBM</strong></p><p>This is the default library used by perdition. The gdbm library reads server and port information from a GDBM database. The database is opened each time perdition looks up a server and port pair.  The information for each lookup key is stored in a flat file, popmap with the format:</p><p>&lt;key&gt;:[&lt;username&gt;&lt;domain_delimiter&gt;]&lt;host&gt;[:&lt;port&gt;]</p>
<dl class='dl-vertical'>
  <dt>
    <p>Where:</p>
  </dt>
  <dd>
    <p>host: hostname or ip address</p><p>port: port name or number</p>
  </dd>

</dl>
<p>E.g.</p><p>horms:foo.bar:110</p><p>jain:jane@foo.bar</p><p>A domain_delimiter of "@" is used in the example above. For more information on keys and the domain delimiter, see <a href="../man8/perdition.8.html"><strong>perdition</strong>(8)</a>.</p><p>If the -n|--no_lookup option is in effect, then ip addresses and port names should be used as host and port names will not be resolved.</p><p>To build the flat file into a binary format the makegdbm utility, which is provided as part of perdition should be used.</p><p>makegdbm popmap.gdbm.db &lt; popmap</p><p>A makefile is provided and you can simply run make to rebuild the popmap. This is installed into /etc/perdition/ in the RPM and Debian distributions.</p><p>An alternate location for the popmap.gdbm.db can be specified using the -m|--map_library_opt command line option or configuration file option.</p><p>E.g.</p><p>perdition -m /etc/my_popmap.gdbm.db</p><p>This map library is the default. It may also be used explicitly, used by specifying the full path to the library using the -M|--map_library command line option or configuration file option.</p><p>E.g.</p><p>perdition -M /usr/lib/libperditiondb_gdbm.so.0</p><p>Where /usr/lib is the directory in which the perdition libraries were installed.</p><p><strong></strong> Berkeley DB</p><p>This is analogous to the GDBM library, except that a popmap.bdb.db should be created using makebdb.</p><p>This library may be used by specifying the full path to the library using the -M|--map_library command line option or configuration file option.</p><p>E.g.</p><p>perdition -M /usr/lib/libperditiondb_bdb.so.0</p><p>Where /usr/lib is the directory in which the perdition libraries were installed.</p><p><strong></strong> YP/NIS</p><p>The NIS library reads a YP/NIS map, the key is the userid, the value is the servername.</p><p>The default map name is 'user_mail_server', and can be changed by specifying the map name with the -m flag.</p><p>To use this library, you need to specify:</p><p>perdition -M /usr/lib/libperditiondb_nis.so.0</p><p>Where /usr/lib is the directory in which the perdition libraries were installed. You will need to customise your yp server's Makefile to actually get a new map on the server. This map library is intended for sites that already have a significant infrastructure based around YP/NIS.</p><p><strong></strong> POSIX REGULAR EXPRESSIONS</p><p>This library allows users to be looked matched against a list of regular expressions.</p><p>This library can be used by specifying the full path to the library using the -M|--map_library command line option or configuration file option.</p><p>E.g.</p><p>perdition -M /usr/lib/libperditiondb_posix_regex.so.0</p><p>Where /usr/lib is the directory in which the perdition libraries were installed.</p><p>The regular expression is kept in a flat file, by default /etc/perdition/popmap.re .  A sample map file is shipped with the source and can be found in etc/perdition/popmap.re, this is installed into /etc/perdition/popmap.re in the RPM and Debian distributions. The format for the flat file is:</p><p>&lt;regular expression&gt;: [&lt;username&gt;&lt;domain_delimiter&gt;]&lt;server&gt;[:&lt;port&gt;]</p><p>A single colon <strong>may</strong> follow a regular_expression Some amount of white space must follow this colon or the regular_expression if the colon is omitted.  Blank lines are ignored, as is anything including and after a # (hash) on a line. If a &nbsp;precedes a new line then the lines will be concatenated.  If a &nbsp;precedes any other character, including a # (hash) it will be treated as a literal. Anything inside single quotes (') will be treated as a literal. Anything other than a (') inside double quotes (") will be treated as a literal. Whitespace in a regular_expression must be escaped or quoted. Whitespace in a substitution need not be escaped or quoted.</p><p>Information on setting the domain_delimiter is found in <a href="../man8/perdition.8.html"><strong>perdition</strong>(8)</a>, "@" is used in this example.</p><p>E.g.</p><p>^[a-k]: localhost</p><p>^[^a-k]: localhost:110</p><p>^user: user2@localhost</p><p>(.*)@(.*): $1_$2@localhost</p><p>The first matching regular expression will be used. The regular expressions are extended posix regular expressions. The last example illustrates the ability to expand backreferances.  Backreferences may be used by inserting $n in the substitution where n is in the range 1..9. The backreference substitution code in this library is courtesy of Wim Bonis and in turn the PHP3 project.</p><p>E.g.</p><p>For the regex (.*)@(.*): $1_$2@localhost</p><p>user@x.y.z.de</p><p>would return</p><p>user_x.y.z.de@localhost</p><p>Note that there is no implicit ^ or $ around the regular expressions. The popmap entry "flim: localhost" will match "flim", "flimstix", "itsflim" and "totallyflimless". To only match "flim" you need the popmap entry "^flim$: localhost".</p><p>The map file is read once on startup and cached. This is to increase performance as the regular expressions must be compiled internally before they can be used. The map file can be re read by sending perdition a SIGHUP. An alternate location for the popmap.re can be specified using the -m|--map_library_opt command line option or configuration file option.</p><p>E.g.</p><p>perdition -m /etc/perdition/my_popmap.re</p><p><strong>MYSQL</strong></p><p>This map library can be used by specifying the full path to the library using the -M|--map_library command line option or configuration file option.</p><p>E.g.</p><p>perdition -M /usr/lib/libperditiondb_mysql.so.0</p><p>Where /usr/lib is the directory in which the perdition libraries were installed.</p><p>The library will connect to a MySQL database and do a query on a table expected to have the columns:</p>
<pre>
+------------+--------------+------+-----+---------+-------+
| Field      | Type         | Null | Key | Default | Extra |
+------------+--------------+------+-----+---------+-------+
| user       | varchar(128) |      | PRI |         |       |
| servername | varchar(255) |      |     |         |       |
| port       | <strong>varchar</strong>(8)   | YES  |     | NULL    |       |
+------------+--------------+------+-----+---------+-------+
</pre>
<p>The fields may be in a different order and other, non-perdition fields may also be present in this table. The names of the columns can be other than their above defaults by using the library option string described below. All fields must be literal character strings. The allowed length of the strings is not important, however, it is recommended that the length of the user field be kept under 128 to avoid exceeding perdition's internal query length limit, PERDITIONDB_MYSQL_QUERY_LENGTH which is 256 by default. This may be altered by recompiling perdition.  The user field must also be a unique index as an exact match will be made of this field from the username supplied by the user.</p><p>The servername is of the form.</p><p>[&lt;username&gt;&lt;domain_delimiter&gt;]&lt;host&gt;[:&lt;port&gt;]</p>
<dl class='dl-vertical'>
  <dt>
    <p>Where:</p>
  </dt>
  <dd>
    <p>host: hostname or ip address</p><p>port: port name or number</p>
  </dd>

</dl>
<p>If the -n|--no_lookup option is in effect then ip addresses and port numbers should be used as host and port names will not be resolved.</p><p>The port is the TCP port to use when connecting to the server. This field can be specified if the back-end server answers on a non-standard port (standard ports being 110 for POP3 and 143 for IMAP). Only specify this field in the database if you intend to use POP3 or IMAP exclusively as it will try to use this port no matter what protocol is being used. If POP3 and IMAP are both being used on non-standard back-end server ports, those ports can be specified with the -p argument when you invoke the perdition executable.</p><p>The database is accessed each time perdition needs to find the host and port for a user.  The default database values are as follows:</p><p>database host:     localhost</p><p>database port:     (MySQL Client Default: usually 3306)</p><p>database name:     dbPerdition</p><p>database table:    tblPerdition</p><p>database user:     perdition</p><p>database password: perdition</p><p>user column:       user</p><p>server column:     servername</p><p>port column:       port</p><p>A script, perditiondb_mysql_makedb, is provided to initialise such a database.  Alternate values can be set using the -m|--map_library_opt command line option or configuration file option with an argument of the following form. (N.B.: this example has been split over multiple lines for ease of reading)</p><p>&lt;dbhost&gt;[:&lt;dbport&gt;[:&lt;dbname&gt;[:&lt;dbtable&gt;[:&lt;dbuser&gt;</p><p>[:&lt;dbpwd&gt;[:&lt;dbservercol&gt;[:&lt;dbusercol&gt;[:&lt;dbportcol&gt;]]]]]]]]</p><p>E.g.</p><p>perdition -m "some.host.com:3306:aDb:bTable:cUser:"&#92;</p><p>"dPassword:eSrvCol:fUserCol:gPortCol"</p><p>Arguments may be omitted from the end of the option string with no consequence other than that the default value for any omitted argument will be used. Arguments may not be omitted if any argument to its right is defined. Someone seeking to set only the server and password to something other than the default might attempt the following:</p><p>perdition -m some.host.com:::::OddPassword</p><p>This will not work. It will set the server and password to the values shown, but all arguments in between will be set as NULL rather than the default. In the author's opinion it is always best to specify all of the arguments to avoid confusion.</p><p>Database servers may be grouped together for higher performance or high availability by using ODBC and accessing them using the ODBC module.</p><p><strong>Multiple MySQL Servers</strong></p><p>It is possible to specify multiple MySQL servers by specifying them, comma separated (without any space), in the dbhost column.  In this case all MySQL servers need to have an identical configuration, because all other options are shared.  If the first server is not reachable, perdition will fall back to the second etc.</p><p><strong></strong> POSTGRESQL</p><p>This is a port of the MySQL library to PostgreSQL, The library can be used by specifying the full path to the library using the -M|--map_library command line option or configuration file option.</p><p>E.g.</p><p>perdition -M /usr/lib/libperditiondb_postgresql.so.0</p><p>Where /usr/lib is the directory in which the perdition libraries were installed. A script, perditiondb_postgresql_makedb is provided to initialise the database. For more information please see the MySQL documentation above.</p><p><strong></strong> ODBC</p><p>This is a port of the MySQL library to ODBC. It may be used to access databases that do not have a perditiondb module. It may also be used to group database servers into clusters.</p><p>The library can be used by specifying the full path to the library using the -M|--map_library command line option or configuration file option.</p><p>E.g.</p><p>perdition -M /usr/lib/libperditiondb_odbc.so.0</p><p>Where /usr/lib is the directory in which the perdition libraries were installed. A script, perditiondb_odbc_makedb is provided to seed the. For more information please see the MySQL documentation above. The database options passed using -m are the same as for MySQL except that the database name (dbname) is the Data Source Name (DSN).</p><p>&lt;dbhost&gt;[:&lt;dbport&gt;[:&lt;DSN&gt;[:&lt;dbtable&gt;[:&lt;dbuser&gt;</p><p>[:&lt;dbpwd&gt;[:&lt;dbsrvcol&gt;[:&lt;dbusercol&gt;[:&lt;dbportcol&gt;]]]]]]]]</p><p>E.g.</p><p>perdition -m "some.host.com:3306:aDb:bTable:cUser:"&#92;</p><p>"dPassword:eSrvCol:fUserCol:gPortCol"</p><p>As per the notes in the MySQL documentation above, please avoid omitting values.</p><p><strong></strong> LDAP</p><p>This library allows access to LDAP based popmaps. This library can be used by specifying the full path to the library using the -M|--map_library command line option or configuration file option.</p><p>E.g.</p><p>perdition -M /usr/lib/libperditiondb_ldap.so.0</p><p>Where /usr/lib is the directory in which the perdition libraries were installed.</p><p>Options are parsed to this module using the -m|--map_library_opt command line option or configuration file option. It has the form:</p><p>[ldap_version:][ldap_url]</p><p>The ldap_version is the version of the ldap procotol used. It should be a numeric value. At the time of writing, OpenLdap supports 2 or 3, and defaults to 2. This may vary between different ldap implementations. If you inspect the local ldap.h file, the values of LDAP_VERSION_MIN, LDAP_VERSION_MAX and LDAP_VERSION should reflect the minimum, maximum and default ldap protocol versions respectively.</p><p>The ldap_url is the query made to the ldap server. The default URL is as follows. Note that this has been split onto multiple lines for ease of reading.</p><p>ldap://localhost/ou=mailbox,dc=nodomain?</p><p>username,mailhost,port?one?(uid=%s)</p><p>Perdition will replace any instance of %s with the key being used for the lookup. Optionally, there may be an integer between the % and the s, in which case the key will be white-space padded to this width, with the key right justified.</p><p>The attribute names (username, mailhost and port) may be changed. But the first attribute will be used as the username, the second attribute as the host and the third atribute as the port. Any subsequent attributes will be ignored.  Trailing attributes may also be omitted. So if there are only two attributes the port will not be read from the database.</p><p>A script, perditiondb_ldap_makedb is provided to initialise LDAP.</p><p><strong>x-bindpw bindname</strong></p><p>Perdition can be configured to use use an alternate bind name, and the non-standard "x-bindpw". In fact perdition can use any extensions that are supported by openldap. (N.B.: these examples have been split over multiple lines for ease or reading)</p><p>ldap://ldap.mydomain.com/o=domain.com?</p><p>uid,mailhost,port?sub?(uid=%s)?!bindname=uid=perdition%2co=domain.com</p><p>ldap://ldap.mydomain.com/o=domain.com?uid,mailhost,port?</p><p>sub?(uid=%s)?!BINDNAME=uid=perdition%2co=domain.com,X-BINDPW=secret</p><p>The first example does the usual LDAP lookup, but tries to bind to the server with "uid=perdition,o=domain.com" rather than the usual anonymous binding.  Note: The commas inside the bind string itself must be URL encoded, thus the %2c.</p><p>The second example is the same as the first, but in addition to specifying a bind string it also uses the non-standard "x-bindpw" extension to specify a password, in this case "secret".</p><p>The "!" character is used to ensure Perdition supports the "bindname" extension.  If it didn't, the LDAP connection would be aborted.  Right now it isn't really needed, but it may become useful as other extensions appear.  For full details of this, take a look at RFC2255.</p><p><strong>Multiple LDAP Servers</strong></p><p>It is possible to specify multiple LDAP servers by specifying them, space delimited, in the LDAP UDL. If this is the case an attempt will be made to open a connection to each host in order, the first host to which a connection is successfully made will be used.</p><p>For example: (N.B.: this example has been split over multiple lines for ease or reading)</p><p>ldap://host1&nbsp;host2&nbsp;host3/ou=mailbox,dc=nodomain?</p><p>username,mailhost,port?one?(uid=%s)</p><p><strong>perdition.schema</strong></p><p>A schema has been defined for perdition and is supplied as part of perdition. To use this you should install it on the LDAP server in the LDAP daemon's schema directory and include it in slapd.conf, after other includes and before any database definitions.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LIBRARY FUNCTIONS</h2>
        <div class="sectioncontent">
<p>The database is accessed using the <a href="../man3/dlopen.3.html"><strong>dlopen</strong>(3)</a> mechanism on a library. The library should define the symbol dbserver_get with the following semantics.</p><p><strong></strong> int (*dbserver_get)(char *, char *, char **, size_t *)</p><p>Find the server (value) given the user (key)</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>pre:</strong></p>
  </dt>
  <dd>
    <p><strong>key_str:</strong> Key as a null terminated string</p><p><strong>options_str:</strong> Options string. The usage of this is implementation dependent.</p><p><strong>str_return:</strong> Value is returned here</p><p><strong>len_return:</strong> Length of value is returned here</p>
  </dd>
  <dt>
    <p><strong>post:</strong></p>
  </dt>
  <dd>
    <p>The str_key is looked up and the corresponding value is returned in str_return and len_return.</p>
  </dd>
  <dt>
    <p><strong>return:</strong></p>
  </dt>
  <dd>
    <p>0 on success</p><p>-1 on db access error This includes file, connection and other data access errors. It does not cover memory allocation problems.</p><p>-2 if key cannot be found in map</p><p>-3 on other error</p>
  </dd>
  <dt>
    <p><strong>Note:</strong></p>
  </dt>
  <dd>
    <p>The string returned in str_return should be in the following form. Setting the domain_delimiter is discussed in the <a href="../man8/perdition.8.html"><strong>perdition</strong>(8)</a>, "@" is used in this example.</p><p>[&lt;username&gt;&lt;domain_delimiter&gt;]&lt;servername&gt;[:&lt;port&gt;]</p><p>E.g.:</p><p>localhost:110</p><p>user@localhost:110</p><p>user@localhost</p><p>localhost</p>
  </dd>

</dl>
<p>As the library is opened using the <a href="../man3/dlopen.3.html"><strong>dlopen</strong>(3)</a> mechanism the library may also export functions _init and _fini that will be executed when the library is opened and closed respectively. In addition if the symbols following  symbols are defined then these are run when the library is opened and closed respectively.  If defined these symbols should have the following semantics.</p><p><strong></strong> <strong></strong></p><p><strong></strong> int *(*dbserver_init)(char *)</p><p>Initialise db as necessary</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>pre:</strong></p>
  </dt>
  <dd>
    <p><strong>options_str:</strong> Options string. The usage of this is implementation dependent.</p>
  </dd>
  <dt>
    <p><strong>post:</strong></p>
  </dt>
  <dd>
    <p>db is initialised</p>
  </dd>
  <dt>
    <p><strong>return:</strong></p>
  </dt>
  <dd>
    <p>0 on success</p><p>-1 on db access error This includes file, connection and other data access errors. It does not cover memory allocation problems.</p><p>-2 if key cannot be found in map</p><p>-3 on other error</p>
  </dd>

</dl>
<p><strong></strong> int *(*dbserver_fini)(void)</p><p>Shut down db as necessary</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>pre:</strong></p>
  </dt>
  <dd>
    <p>none</p>
  </dd>
  <dt>
    <p><strong>post:</strong></p>
  </dt>
  <dd>
    <p>db is shut down</p>
  </dd>
  <dt>
    <p><strong>return:</strong></p>
  </dt>
  <dd>
    <p>0 on success</p><p>-1 on db access error This includes file, connection and other data access errors. It does not cover memory allocation problems.</p><p>-2 if key cannot be found in map</p><p>-3 on other error</p>
  </dd>

</dl>
<p>In addition, if a SIGHUP is sent to a process then a signal handler will call dbserver_fini if it is defined and then dbserver_init if it is defined. Note: dbserver_init will be called if defined, even if dbserver_fini is not defined.</p><p>In the case of the posix regular expressions library this will cause popmap.re to be re-parsed, hence effecting any changes that have been made to that file. For the GDBM library it will reopen the database and for the other libraries it will reinitialise its connection to the database, LDAP or NIS server.</p><p>The shared library has access to the following global symbols exported by perdition.</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong>struct utsname *system_uname</strong></p>
  </dt>
  <dd>
    <p>The uname information for the system as per <a href="../man2/uname.2.html"><strong>uname</strong>(2)</a></p>
  </dd>
  <dt>
    <p><strong>struct sockaddr_in *peername</strong></p>
  </dt>
  <dd>
    <p>The sockaddr_in for address and port of the client end of the connection.</p>
  </dd>
  <dt>
    <p><strong>struct sockaddr_in *sockname</strong></p>
  </dt>
  <dd>
    <p>The sockaddr_in for the local address and port that the client connected to. Note: Under Solaris 7 and above, this is actually the sockaddr_in bound to, not the address and port the connection was accepted on.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO perditiondb&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/perdition.8.html"><strong>perdition</strong>(8)</a>, <a href="../man1/makegdbm.1.html"><strong>makegdbm</strong>(1)</a>, <a href="../man1/makebdb.1.html"><strong>makebdb</strong>(1)</a>, <a href="../man1/make.1.html"><strong>make</strong>(1)</a>, <a href="../man8/perditiondb_mysql_makedb.8.html"><strong>perditiondb_mysql_makedb</strong>(8)</a>, <a href="../man8/perditiondb_postgresql_makedb.8.html"><strong>perditiondb_postgresql_makedb</strong>(8)</a> <a href="../man8/perditiondb_ldap_makedb.8.html"><strong>perditiondb_ldap_makedb</strong>(8)</a>, <a href="../man8/perditiondb_odbc_makedb.8.html"><strong>perditiondb_odbc_makedb</strong>(8)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p><strong>Lead</strong></p><p>Horms &lt;horms@vergenet.net&gt;</p><p><strong>Perditiondb Library Authors</strong></p><p>Frederic Delchambre &lt;dedel@freegates.be&gt;      (MySQL)</p><p>Chris Stratford: &lt;chriss@uk.uu.net&gt;           (LDAP and BDB)</p><p>Nathan Neulinger &lt;nneul@umr.edu&gt;              (NIS)</p><p><strong>Contributing Authors</strong></p><p>Daniel Roesen &lt;droesen@entire-systems.com&gt;</p><p>Clinton Work &lt;work@scripty.com&gt;</p><p>Youri &lt;ya@linkline.be&gt;</p><p>Jeremy Nelson &lt;jnelson@optusnet.com.au&gt;</p><p>Wim Bonis &lt;bonis@solution-service.de&gt;</p><p>Arvid Requate &lt;arvid@Team.OWL-Online.DE&gt;</p><p>Mikolaj J. Habryn &lt;dichro@rcpt.to&gt;</p><p>Ronny Cook &lt;ronny@asiaonline.net&gt;</p><p>Geoff Mitchell &lt;g.mitchell@videonetworks.com&gt;</p><p>Willi Langenberger &lt;wlang@wu-wien.ac.at&gt;</p><p>Matt Prigge &lt;mprigge@pobox.com&gt;</p><p>Wolfgang Breyha &lt;wolfgang.breyha@uta.at&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="pdmenurc.5.html"><span aria-hidden="true">&larr;</span> pdmenurc.5: Menu definitions file for pdmenu</a></li>
   <li class="next"><a href="persistence.conf.5.html">persistence.conf.5: Configuration file for persistence media in live-boot <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
