<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>smd-config: Configuration file for smd-pull and smd-push</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Configuration file for smd-pull and smd-push">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="smd-config (5) manual">
  <meta name="twitter:description" content="Configuration file for smd-pull and smd-push">
  <meta name="twitter:image" content="https://www.carta.tech/images/syncmaildir-smd-config-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/smd-config.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="smd-config (5) manual" />
  <meta property="og:description" content="Configuration file for smd-pull and smd-push" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/syncmaildir-smd-config-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">smd-config<small> (5)</small></h1>
        <p class="lead">Configuration file for smd-pull and smd-push</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/smd-config.5.html">
      <span itemprop="name">smd-config: Configuration file for smd-pull and smd-push</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/syncmaildir/">
      <span itemprop="name">syncmaildir</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/smd-config.5.html">
      <span itemprop="name">smd-config: Configuration file for smd-pull and smd-push</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">GENERAL SETUP</h2>
        <div class="sectioncontent">
<p>To generate a template config file run <a href="../man1/smd-pull.1.html"><strong>smd-pull</strong>(1)</a> with the <strong>-t</strong> option. If no endpoint is specified, the configuration file is named ~/.smd/config.default, otherwise it is named ~/.smd/config.endpoint. That file is composed by the following fields</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>CLIENTNAME name of the client host</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>SERVERNAME name of the server host</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>MAILBOX list of directories, separated by space</p>
  </dd>

</dl>
<p>The field SERVERNAME must be a valid name for ssh, thus can be an alias like smd-server-foo. The default configuration file contains an example of how to set up an alias for ssh.</p><p>The field CLIENTNAME is just an ID for the local host. If you plan to sync the same host with multiple remote hosts, you MUST use different values for CLIENTNAME for every configuration file.</p><p>The field MAILBOX is a space separated list or roots that will be scanned for maildirs. Typically it is just one directory name, Mail or Maildir. The roots must be paths relative to the home directory. In the simplest case, the roots are named the same on both the local and the remote hosts.</p><p>If the roots have different names on the local and remote hosts, but their internal structure is the same, the simplest solution is to just use a symlink on one of the two hosts so that a single name can be used to refer to both.</p><p>If the internal sub folder structure differ, for example because on the remote hosts sub folders names are prefixed with a dot but it is not the case on the local one, refer to the MAIL FOLDER RENAMING section of this document.</p><p>The configuration file is a regular shell script, refer to <a href="../man1/bash.1.html"><strong>bash</strong>(1)</a> for its syntax.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">HOOKS</h2>
        <div class="sectioncontent">
<p>The content of the directories ~/.smd/hooks/{pre,post}<strong>-pull.d</strong>/ is executed respectively before and after smd-pull does it's job. They receive four arguments: "pre" or "post", "pull", the endpoint name and the status. The status is always 0 (meaning success) for pre hooks, while can be 1 (for failure) for post hooks. Hooks should not fail, if they do so then smd-pull will fail too.</p><p>The content of the directories ~/.smd/hooks/{pre,post}<strong>-push.d</strong>/ is executed respectively before and after smd-push does it's job. They receive four arguments: "pre" or "post", "push", the endpoint name and the status. The status is always 0 (meaning success) for pre hooks, while can be 1 (for failure) for post hooks. Hooks should not fail, if they do so then smd-push will fail too.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">MAIL FOLDER RENAMING</h2>
        <div class="sectioncontent">
<p>To make the transition from other synchronization tools smooth, the folders structure on the local and remote host are allowed to differ. For example, offlineimap usually removes trailing dots from the names of sub folders.</p><p>To take advantage of folder renaming, the configuration file can contain the following fields:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>MAILBOX_LOCAL the local roots of maildirs</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>MAILBOX_REMOTE the remote roots of maildirs</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>TRANSLATOR_RL a program to translate remote mailbox names to local ones</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>TRANSLATOR_LR a program to translate local mailbox names to remote ones</p>
  </dd>

</dl>
<p>The fields MAILBOX_LOCAL and MAILBOX_REMOTE must substitute the MAILBOX fields explained above.</p><p>The fields TRANSLATOR_RL and TRANSLATOR_LR must define two translator programs that will be run to translate remote mailbox names to local ones (TRANSLATOR_RL) and vice versa (TRANSLATOR_LR). A translator program must fulfil the following requirements:</p><ul>
<li><p>must be an absolute path or relative to the $HOME directory or in the user $PATH and must be executable</p></li><li><p>receives in standard input one or more paths starting with one of the roots listed in MAILBOX_LOCAL (for TRANSLATOR_LR) or MAILBOX_REMOTE (for TRANSLATOR_RL) and ending with cur, new or tmp</p></li><li><p>it can fail, returning 1 and writing on standard output the string ERROR followed by a new line and a human readable error message in the following lines</p></li><li><p>it can succeed, returning 0 and printing on standard output the corresponding translated paths</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PATHS EXCLUSION</h2>
        <div class="sectioncontent">
<p>In case some paths need to be skipped, they can be specified as space separated <a href="../man7/glob.7.html"><strong>glob</strong>(7)</a> expressions in the variable:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>EXCLUDE glob expressions identifying paths to be excluded</p>
  </dd>

</dl>
<p>Note that these expressions must match real paths, no translation operation is applied to them, so it may be necessary to specify different expressions for the local and remote endpoint. In that case the following variables can be set:</p>
<dl class='dl-vertical'>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>EXCLUDE_LOCAL glob expressions identifying local paths to be excluded</p>
  </dd>
  <dt>
    <p><strong></strong></p>
  </dt>
  <dd>
    <p>EXCLUDE_REMOTE glob expressions identifying remote paths to be excluded</p>
  </dd>

</dl>
<p>Matching is performed using <a href="../man3/fnmatch.3.html"><strong>fnmatch</strong>(3)</a> with no special flags, thus `*' and `?' match any character including `/'. Last, note that spaces in glob expressions must be replaced by %20. For example, to exclude all paths matching the expression `Mail/delayed [1-5] days/*' the variable EXCLUDE must be set to `Mail/delayed%20[1-5]%20days/*'</p><p>Last, matching is performed every time a directory is entered, and if the matching succeeds the directory and all its subdirectories are skipped. Thus there is no need to specify a trailing '/*' in every expression.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">LOCAL SYNCHRONIZATION</h2>
        <div class="sectioncontent">
<p>If the local and remote mailboxes are on the same host the following option must be added to the configuration file:</p><p>SMDCLIENTOPTS=<strong>-l</strong></p><p>Note that this options has also the effect that ssh is not used. A a simple pair of pipes is used instead.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DELETIONS</h2>
        <div class="sectioncontent">
<p>In some cases, usually unidirectional synchronizations, one may want to not propagate deletions. E.g. one keeps a slim working mailbox but pushes to a backup mailbox to save every email. For that scenario smd-pull and smd-push accept a <strong>-n</strong>, <strong>--no-delete</strong>, option. To avoid specifying this option every time one can put it in the configuration file:</p><p>SMDSERVEROPTS=<strong>-n</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>~/.smd/config.* ~/.smd/hooks/pre-pull.d/ ~/.smd/hooks/post-pull.d/ ~/.smd/hooks/pre-push.d/ ~/.smd/hooks/post-push.d/</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO smd-config&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man1/mddiff.1.html"><strong>mddiff</strong>(1)</a>, <a href="../man1/smd-server.1.html"><strong>smd-server</strong>(1)</a>, <a href="../man1/smd-client.1.html"><strong>smd-client</strong>(1)</a>, <a href="../man1/smd-push.1.html"><strong>smd-push</strong>(1)</a>, <a href="../man1/smd-loop.1.html"><strong>smd-loop</strong>(1)</a>, <a href="../man1/smd-translate.1.html"><strong>smd-translate</strong>(1)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Enrico Tassi &lt;gares@fettunta.org&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="smbpasswd.5.html"><span aria-hidden="true">&larr;</span> smbpasswd.5: The samba encrypted password file</a></li>
   <li class="next"><a href="snapper-configs.5.html">snapper-configs.5: Configuration files for snapper configs <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
