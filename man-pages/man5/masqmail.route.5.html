<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>masqmail.route: Masqmail route configuration file</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Masqmail route configuration file">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="masqmail.route (5) manual">
  <meta name="twitter:description" content="Masqmail route configuration file">
  <meta name="twitter:image" content="https://www.carta.tech/images/masqmail-masqmail.route-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/masqmail.route.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="masqmail.route (5) manual" />
  <meta property="og:description" content="Masqmail route configuration file" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/masqmail-masqmail.route-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">masqmail.route<small> (5)</small></h1>
        <p class="lead">Masqmail route configuration file</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/masqmail.route.5.html">
      <span itemprop="name">masqmail.route: Masqmail route configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/masqmail/">
      <span itemprop="name">masqmail</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/masqmail.route.5.html">
      <span itemprop="name">masqmail.route: Masqmail route configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This man page describes the syntax of the route configuration files of <strong>masqmail (8)</strong>. Their usual locations are in <em>/etc/masqmail/</em>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>protocol</strong> = <em>string</em></p>
  </dt>
  <dd>
    <p><em>string</em> can be one of `smtp' or `pipe', default is `smtp'. If set to `smtp', mail will be sent with the SMTP protocol to its destination. If set to `pipe', you also have to set `pipe' to a command, the message will then be piped to a program. See option `pipe' below.</p>
  </dd>
  <dt>
    <p><strong>mail_host</strong> = <em>string</em></p>
  </dt>
  <dd>
    <p>This is preferably the mail server of your ISP. All outgoing messages will be sent to this host which will distribute them to their destinations. If you do not set this mails will be sent directly. Because the mail server is probably `near' to you, mail transfer will be much faster if you use it.</p><p>You can optionally give a port number following the host name and a colon, eg mail_host="mail.foo.com:25".</p>
  </dd>
  <dt>
    <p><strong>resolve_list</strong> = <em>list</em></p>
  </dt>
  <dd>
    <p>Specify the method how the domain of the server is resolved. Possible values are dns_mx, dns_a, byname. For `dns_mx', the domain is assumed to be an MX pointer to a list of host names, these will be tried each in order (lowest preference value first, equal preference values in random order). For `dns_a', the domain is assumed to be an A pointer. For `byname', the library function <a href="../man3/gethostbyname.3.html"><strong>gethostbyname</strong>(3)</a></strong> will be used.</p><p>The default is "dns_mx;dns_a;byname".</p>
  </dd>
  <dt>
    <p><strong>connect_error_fail</strong> = <em>boolean</em></p>
  </dt>
  <dd>
    <p>If this is set, a connection error will cause a mail delivery to fail, ie. it will be bounced. If it is unset, it will just be defered.</p><p>Default is false. The reason for this is that masqmail is designed for non permanent internet connections, where such errors may occur quite often, and a bounce would be annoying.</p><p>For the default local_net route it is set to true.</p>
  </dd>
  <dt>
    <p><strong>helo_name</strong> = <em>string</em></p>
  </dt>
  <dd>
    <p>Set the name given with the HELO/EHLO command. If this is not set, <strong>host_name</strong> from <em>masqmail.conf</em> will be used, if the <strong>do_correct_helo</strong> option (see below) is unset.</p>
  </dd>
  <dt>
    <p><strong>do_correct_helo</strong> = <em>boolean</em></p>
  </dt>
  <dd>
    <p>If this is set, masqmail tries to look up your host name as it appears on the internet and sends this in the HELO/EHLO command. Some servers are so picky that they want this. Which is really crazy. It just does not make any sense to lie about ones own identity, because it can always be looked up by the server. Nobody should believe in the name given by HELO/EHLO anyway. If this is not set, <strong>host_name</strong> from <em>masqmail.conf</em> or as given with the <strong>helo_name</strong> (see above) will be used.</p>
  </dd>
  <dt>
    <p><strong>instant_helo</strong> = <em>boolean</em></p>
  </dt>
  <dd>
    <p>If this is set, masqmail does not wait for the greeting of the SMTP server after opening the connection. Instead it says EHLO right away (ESMTP is assumed). Use this option with wrappers that eat the 220 greeting of the SMTP server. Common examples are STARTTLS wrappers, like `openssl -starttls smtp ...'.</p><p>If this option is set and a 220 greeting is received though, everything should still work. Please don't rely on that and keep in mind that RFC 2821 says that the client SHOULD wait for the 220 greeting of the server.</p><p>Default: false</p>
  </dd>
  <dt>
    <p><strong>do_pipelining</strong> = <em>boolean</em></p>
  </dt>
  <dd>
    <p>If this is set to false, masqmail will not use ESMTP PIPELINING, even if the server announces that it is able to cope with it. Default is true.</p><p>You do not want to set this to false unless the mail setup on the remote server side is really broken. Keywords: wingate.</p>
  </dd>
  <dt>
    <p><strong>allowed_mail_locals</strong> = <em>list</em></p>
  </dt>
  <dd>
    <p>This is a semicolon `;' separated list of local parts which will be allowed to send mail through this connection. If unset and <strong>not_allowed_mail_locals</strong> is also unset, all users are allowed.</p>
  </dd>
  <dt>
    <p><strong>not_allowed_mail_locals</strong> = <em>list</em></p>
  </dt>
  <dd>
    <p>This is a semicolon `;' separated list of local parts which will be not allowed to send mail through this connection. Local parts in this list will not be allowed to use this route even if they are part of <strong>allowed_mail_locals</strong> (see above).</p>
  </dd>
  <dt>
    <p><strong>allowed_return_paths</strong> = <em>list</em></p>
  </dt>
  <dd>
    <p>This is a semicolon `;' separated list of addresses. Messages which have one of these addresses as the return path will be used using this route (if not also in <strong>not_allowed_return_paths</strong> or an item in <strong>not_allowed_mail_locals</strong> matches).</p><p>Patterns containing `?' and `*' can be used. The special item "&lt;&gt;" matches the null sender address (eg. failure notices or delivery notifications).</p>
  </dd>
  <dt>
    <p><strong>not_allowed_return_paths</strong> = <em>list</em></p>
  </dt>
  <dd>
    <p>This is a semicolon `;' separated list of addresses. Messages which have one of these addresses as the return path will not be used using this route (even if also in <strong>allowed_return_paths</strong> or an item in <strong>allowed_mail_locals</strong> matches).</p><p>Patterns containing `?' and `*' can be used. The special item "&lt;&gt;" matches the null sender address (eg. failure notices or delivery notifications).</p>
  </dd>
  <dt>
    <p><strong>allowed_rcpt_domains</strong> = <em>list</em></p>
  </dt>
  <dd>
    <p>A list of recipient domains where mail will be sent to. This is for example useful if you use this route configuration when connected to another LAN via ppp. Patterns containing `?' and `*' can be used.</p>
  </dd>
  <dt>
    <p><strong>not_allowed_rcpt_domains</strong> = <em>list</em></p>
  </dt>
  <dd>
    <p>A list of recipient domains where mail will not be sent to. This is for example useful if you send mail directly (<strong>mail_host</strong> is not set) and you know of hosts that will not accept mail from you because they use a dialup list (eg. <strong>http://maps.vix.com/dul/</strong>). If any domain matches both <strong>allowed_rcpt_domains</strong> and <strong>not_allowed_rcpt_domains</strong>, mail will not be sent to this domain. Patterns containing `?' and `*' can be used.</p>
  </dd>
  <dt>
    <p><strong>set_h_from_domain</strong> = <em>string</em></p>
  </dt>
  <dd>
    <p>Replace the domain part in `From:' headers with this value. This may be useful if you use a private, outside unknown address on your local LAN and want this to be replaced by the domain of the address of your email address on the internet. Note that this is different to <strong>set_return_path_domain</strong>, see below.</p>
  </dd>
  <dt>
    <p><strong>set_h_reply_to_domain</strong> = <em>string</em></p>
  </dt>
  <dd>
    <p>Same as <strong>set_h_from_domain</strong>, but for the `Reply-To' header.</p>
  </dd>
  <dt>
    <p><strong>set_return_path_domain</strong> = <em>string</em></p>
  </dt>
  <dd>
    <p>Sets the domain part of the envelope from address. Some hosts check whether this is the same as the net the connection is coming from. If not, they reject the mail because they suspect spamming. It should be a valid address, because some mail servers also check that. You can also use this to set it to your usual address on the internet and put a local address only known on your LAN in the configuration of your mailer. Only the domain part will be changed, the local part remains unchanged. Use <strong>map_return_path_addresses</strong> for rewriting local parts.</p>
  </dd>
  <dt>
    <p><strong>map_h_from_addresses</strong> = <em>list</em></p>
  </dt>
  <dd>
    <p>This is similar to <strong>set_h_from_domain</strong>, but more flexible. Set this to a list which maps local parts to a full RFC 822 compliant email address, the local parts (the keys) are separated from the addresses (the values) by colons (`:').</p><p>Example:</p>
<pre>
map_h_from_addresses = "john: John Smith &lt;jsmith@mail.academic.edu&gt;; charlie: Charlie Miller &lt;cmiller@mx.commercial.com&gt;"
</pre>
<p>You can use patterns, eg. * as keys.</p>
  </dd>
  <dt>
    <p><strong>map_h_reply_to_addresses</strong> = <em>list</em></p>
  </dt>
  <dd>
    <p>Same as <strong>map_h_from_addresses</strong>, but for the `Reply-To:' header.</p>
  </dd>
  <dt>
    <p><strong>map_h_mail_followup_to_addresses</strong> = <em>list</em></p>
  </dt>
  <dd>
    <p>Same as <strong>map_h_from_addresses</strong>, but for the `Mail-Followup-To:' header. Useful when replying to mailing lists.</p>
  </dd>
  <dt>
    <p><strong>map_return_path_addresses</strong> = <em>list</em></p>
  </dt>
  <dd>
    <p>This is similar to <strong>set_return_path_domain</strong>, but more flexible. Set this to a list which maps local parts to a full RFC 821 compliant email address, the local parts (the keys) are separated from the addresses (the values) by colons (`:'). Note that this option takes RFC 821 addresses while <strong>map_h_from_addresses</strong> takes RFC 822 addresses. The most important difference is that RFC 821 addresses have no full name.</p><p>Example:</p>
<pre>
map_return_path_addresses = "john: &lt;jsmith@mail.academic.edu&gt;; charlie: &lt;cmiller@mx.commercial.com&gt;"
</pre>
<p>You can use patterns, eg. * as keys.</p>
  </dd>
  <dt>
    <p><strong>expand_h_sender_address</strong> = <em>boolean</em></p>
  </dt>
  <dd>
    <p>This sets the domain of the sender address as given by the Sender: header to the same address as in the envelope return path address (which can be set by either <strong>set_return_path_domain</strong> or <strong>map_return_path_addresses</strong>). This is for mail clients (eg. Microsoft Outlook) which use this address as the sender address. Though they should use the From: address, see RFC 821. If <strong>fetchmail</strong>(1)</strong> encounters an unqualified Sender: address, it will be expanded to the domain of the pop server, which is almost never correct. Default is true.</p>
  </dd>
  <dt>
    <p><strong>expand_h_sender_domain</strong> = <em>boolean</em></p>
  </dt>
  <dd>
    <p>Like <strong>expand_h_sender_address</strong>, but sets the domain only. Deprecated, will be removed in a later version.</p>
  </dd>
  <dt>
    <p><strong>last_route</strong> = <em>boolean</em></p>
  </dt>
  <dd>
    <p>If this is set, a mail which would have been delivered using this route, but has failed temporarily, will not be tried to be delivered using the next route.</p><p>If you have set up a special route with filters using the lists `allowed_rcpt_domains', `allowed_return_paths', and `allowed_mail_locals' or their complements (not_), and the mail passing these rules should be delivered using this route only, you should set this to `true'. Otherwise the mail would be passed to the next route (if any), unless that route has rules which prevent that.</p><p>Default is false.</p>
  </dd>
  <dt>
    <p><strong>auth_name</strong> = <em>string</em></p>
  </dt>
  <dd>
    <p>Set the authentication type for ESMTP AUTH authentication. Currently only `cram-md5' and `login' are supported.</p>
  </dd>
  <dt>
    <p><strong>auth_login</strong> = <em>string</em></p>
  </dt>
  <dd>
    <p>Your account name for ESMTP AUTH authentication.</p>
  </dd>
  <dt>
    <p><strong>auth_secret</strong> = <em>string</em></p>
  </dt>
  <dd>
    <p>Your secret for ESMTP AUTH authentication.</p>
  </dd>
  <dt>
    <p><strong>pop3_login</strong> = <em>file</em></p>
  </dt>
  <dd>
    <p>If your Mail server requires SMTP-after-POP, set this to a get configuration (see <a href="../man5/masqmail.get.5.html"><strong>masqmail.get</strong>(5)</a></strong>). If you login to the POP server before you send, this is not necessary.</p>
  </dd>
  <dt>
    <p><strong>wrapper</strong> = <em>command</em></p>
  </dt>
  <dd>
    <p>If set, instead of opening a connection to a remote server, <em>command</em> will be called and all traffic will be piped to its stdin and from its stdout. Purpose is to tunnel ip traffic, eg. for ssl.</p><p>Example for SMTP over SSL tunneling:</p>
<pre>
wrapper="/usr/bin/openssl s_client -quiet -connect mail.gmx.net:465 2&gt;/dev/null"
</pre>
<p>SMTP over SSL is supported since masqmail-0.1.8. It is now deprecated by the IETF but still in use.</p><p>Example for encryption with STARTTLS (RFC-3207):</p>
<pre>
# don't forget the instant_helo, otherwise it won't work
instant_helo=true
wrapper="/usr/bin/openssl s_client -quiet -starttls smtp -connect mail.gmx.net:25 2&gt;/dev/null"
</pre>
<p>This is supported since masqmail-0.2.28. STARTTLS supersedes SMTP over SSL.</p><p>Note for openssl: Ensure that stderr is redirected. Do *not* use -crlf in the wrapper command, because masqmail does already insert CRLF. However, you might want to specify -crlf if you want to test your wrapper command interactively on the command line.</p>
  </dd>
  <dt>
    <p><strong>pipe</strong> = <em>command</em></p>
  </dt>
  <dd>
    <p>If set, and protocol is set to `pipe', <em>command</em> will be called and the message will be piped to its stdin. Purpose is to use gateways to uucp, fax, sms or whatever else.</p><p>You can use variables to give as arguments to the command, these are the same as for the mda in the main configuration, see <a href="../man5/masqmail.conf.5.html"><strong>masqmail.conf</strong>(5)</a></strong>.</p>
  </dd>
  <dt>
    <p><strong>pipe_fromline = </strong><em>boolean</em></p>
  </dt>
  <dd>
    <p>If this is set, and protocol is set to `pipe', a from line will be prepended to the output stream whenever a pipe command is called. Default is false.</p>
  </dd>
  <dt>
    <p><strong>pipe_fromhack = </strong><em>boolean</em></p>
  </dt>
  <dd>
    <p>If this is set, and protocol is set to `pipe', each line beginning with `From ' is replaced with `&gt;From ' whenever a pipe command is called. You probably want this if you have set <strong>pipe_fromline</strong> above. Default is false.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Masqmail was written by Oliver Kurth. It is now maintained by Markus Schnalke &lt;meillo@marmaro.de&gt;.</p><p>You will find the newest version of masqmail at <strong>http://marmaro.de/prog/masqmail/</strong>. There is also a mailing list, you will find information about it at masqmail's main site.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>Please report bugs to the mailing list.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO masqmail.route&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/masqmail.8.html"><strong>masqmail</strong>(8)</a></strong>, <a href="../man5/masqmail.conf.5.html"><strong>masqmail.conf</strong>(5)</a></strong>, <a href="../man5/masqmail.get.5.html"><strong>masqmail.get</strong>(5)</a></strong></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="masqmail.get.5.html"><span aria-hidden="true">&larr;</span> masqmail.get.5: Masqmail get configuration file</a></li>
   <li class="next"><a href="matrix.conf.5.html">matrix.conf.5: Matrix.pl configuration file <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
