<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>rlm_policy: Freeradius module</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Freeradius module">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="rlm_policy (5) manual">
  <meta name="twitter:description" content="Freeradius module">
  <meta name="twitter:image" content="https://www.carta.tech/images/freeradius-common-rlm_policy-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/rlm_policy.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="rlm_policy (5) manual" />
  <meta property="og:description" content="Freeradius module" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/freeradius-common-rlm_policy-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">rlm_policy<small> (5)</small></h1>
        <p class="lead">Freeradius module</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/rlm_policy.5.html">
      <span itemprop="name">rlm_policy: Freeradius module</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/freeradius-common/">
      <span itemprop="name">freeradius-common</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/rlm_policy.5.html">
      <span itemprop="name">rlm_policy: Freeradius module</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>The <strong>rlm_policy</strong> module implements a simple "policy" language.</p><p>The policy language implemented by this module is simple, and specific to RADIUS.  It does not implement variables, arrays, loops, goto's, or any other feature of a real language.  If those features are needed for your system, we suggest using <strong>rlm_perl</strong>.</p><p>What the policy module implements is a simple way to look for attributes in the request packet (or other places), and to add attributes to the reply packet (or other places) based on those decisions.  Where the module shines is that it is significantly more flexible than the old-style <strong>users</strong> file.</p><p>The module has one configuration item:</p>
<dl class='dl-vertical'>
  <dt>
    filename
  </dt>
  <dd>
    <p>The file where the policy is stored.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">POLICY LANGUAGE</h2>
        <div class="sectioncontent">
<h3>Named policies</h3>
<p>The policy is composed of a series of named policies.  The following example defines a policy named "foo".</p>
<pre>
	policy foo {

		...

	}
</pre>
<p>Policy names MAY NOT be the same as attributes in the dictionary. Defining a policy with the same name as a dictionary attribute will cause an error message to be printed, and the policy will not be loaded.</p><p>When the policy module is listed in a module section like "authorize", the module calls a policy named "authorize".  The "post-auth", etc. sections behave the same.  These names cannot be changed.</p><p>	include "policy.txt"</p><p>The filename must be in a double-quoted string, and is assumed to be relative to the location of the current file.  If the filename ends with a '/', then it is assumed to be a directory, and all files in that directory will be read.</p><p>	include "dir/"</p><p>All file in "dir/" will be read and included into the policy definition.  Any dot files (".", "..", etc.) will not be included, however.</p>
<h3>Including multiple files</h3>
<p>The main file referred to from the <em>radiusd.conf</em> may include one or more other files, as in the following example.</p>
<h3>Referencing a named policy</h3>
<p>The following example references a named policy 	foo() While the brackets are required, no arguments may be passed.</p>
<h3>Conditions</h3>
<p>"if" statements are supported.</p><p>	if (expression) {</p><p>		...</p><p>	}</p><p>and "else"</p><p>	if (expression) {</p><p>		...</p><p>	} else {</p><p>		...</p><p>	}</p><p>also, "else if"</p><p>	if (expression) {</p><p>		...</p><p>	} else if (expression) {</p><p>		...</p><p>	}</p>
<h3>Expressions within if statements</h3>
<p>Always have to have brackets around them.  Sorry.</p><p>The following kinds of expressions may be used, with their meanings.</p>
<dl class='dl-vertical'>
  <dt>
    (attribute-reference)
  </dt>
  <dd>
    <p>TRUE if the referenced attribute exists, FALSE otherwise.  See below for details on attribute references.</p>
  </dd>
  <dt>
    (!(expression))
  </dt>
  <dd>
    <p>FALSE if the expression returned TRUE, and TRUE if the nested expression returned FALSE.</p>
  </dd>
  <dt>
    (attribute-reference == value)
  </dt>
  <dd>
    <p>Compares the attribute to the value.  The operators here can be "==", "!=", "=~", "!~", "&lt;", "&lt;=", "&gt;", and "&gt;=".</p>
  </dd>
  <dt>
    (string1 == string2)
  </dt>
  <dd>
    <p>A special case of the above.  The "string1" is dynamically expanded at run time, while "string2" is not.  The operators here can be "==", "!=", "=~",and "!~".  Of these, the most useful is "=~', which lets you do things like ("%{ldap:query...}" =~ "foo=(.*) ").  The results of the regular expression match are put into %{1}, and can be used later.  See "doc/variables.txt" for more information.</p>
  </dd>
  <dt>
    ((expression1) || (expression2))
  </dt>
  <dd>
    <p>Short-circuit "or".  If expression1 is TRUE, expression2 is not evaluated.</p>
  </dd>
  <dt>
    ((expression1) && (expression2))
  </dt>
  <dd>
    <p>Short-circuit "and".  If expression1 is FALSE, expression2 is not evaluated.</p>
  </dd>
  <dt>
    Limitations.
  </dt>
  <dd>
    <p>The && and || operators have equal precedence. You can't call a function as a expression.</p>
  </dd>

</dl>

<h3>Attribute references</h3>
<p>Attribute references are:</p>
<dl class='dl-vertical'>
  <dt>
    Attribute-Name
  </dt>
  <dd>
    <p>Refers to an attribute of that name in the Access-Request or Accounting-Request packet.  May also refer to "server-side" attributes, which are not documented anywhere.</p>
  </dd>
  <dt>
    request:Attribute-Name
  </dt>
  <dd>
    <p>An alternate way of referencing an attribute in the request packet.</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    reply:Attribute-Name
  </dt>
  <dd>
    <p>An attribute in the reply packet</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    proxy-request:Attribute-Name
  </dt>
  <dd>
    <p>An attribute in the Access-Request or Accounting-Request packet which will be proxied to the home server.</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    proxy-reply:Attribute-Name
  </dt>
  <dd>
    <p>An attribute in the Access-Accept or other packet which was received from a home server.</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    control:Attribute-Name
  </dt>
  <dd>
    <p>An attribute in the per-request configuration and control attributes. Also known as "check" attributes (doc/variables.txt).</p>
  </dd>

</dl>

<h3>Adding attributes to reply packet (or other location)</h3>
<p>	reply .= {</p><p>		attribute-name = value</p><p>		...</p><p>		attribute-name = value</p><p>	}</p><p>The first name can be "request", "reply", "control", "proxy-request", or "proxy-reply".</p><p>The operator can be</p><p> .= - appends attributes to end of the list</p><p> := - replaces existing list with the attributes in the list (bad idea)</p><p> = - use operators from "attribute = value" to decide what to do. (see "users")</p><p>The block must contain only attributes and values.  Nothing else is permitted.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SECTIONS</h2>
        <div class="sectioncontent">
<p><strong>authorize</strong> <strong>post-auth</strong> <strong>pre-proxy</strong> <strong>post-proxy</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p><em>/etc/raddb/radiusd.conf</em></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO rlm_policy&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/radiusd.8.html"><strong>radiusd</strong>(8)</a>, <a href="../man5/users.5.html"><strong>users</strong>(5)</a>, <a href="../man5/radiusd.conf.5.html"><strong>radiusd.conf</strong>(5)</a></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Alan DeKok &lt;aland@ox.org&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="rlm_passwd.5.html"><span aria-hidden="true">&larr;</span> rlm_passwd.5: Freeradius module</a></li>
   <li class="next"><a href="rlm_realm.5.html">rlm_realm.5: Freeradius module <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
