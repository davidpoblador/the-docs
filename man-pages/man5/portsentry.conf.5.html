<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>portsentry.conf: Portsentry´s main configuration file</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Portsentry´s main configuration file">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="portsentry.conf (5) manual">
  <meta name="twitter:description" content="Portsentry´s main configuration file">
  <meta name="twitter:image" content="https://www.carta.tech/images/portsentry-portsentry.conf-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/portsentry.conf.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="portsentry.conf (5) manual" />
  <meta property="og:description" content="Portsentry´s main configuration file" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/portsentry-portsentry.conf-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">portsentry.conf<small> (5)</small></h1>
        <p class="lead">Portsentry´s main configuration file</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/portsentry.conf.5.html">
      <span itemprop="name">portsentry.conf: Portsentry´s main configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/portsentry/">
      <span itemprop="name">portsentry</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/portsentry.conf.5.html">
      <span itemprop="name">portsentry.conf: Portsentry´s main configuration file</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This manual page documents briefly the format of <strong>portsentry</strong>´s(8) configuration file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>TCP_PORTS</strong></p>
  </dt>
  <dd>
    <p>A comma delimited string of TCP ports you want PortSentry to listen to. This string can NOT have any spaces in it. You can put in as many sockets as you want. PortSentry will try to bind them all up until the default limit of 64.</p><p>For the stealth scan detection modes, the ports are not "bound" per se, but they are monitored at the socket level for connections.</p><p>For the Advanced Stealth Scan Detection (see below) this list is *ignored*</p>
  </dd>
  <dt>
    <p><strong>UDP_PORTS</strong></p>
  </dt>
  <dd>
    <p>The same as above, except for UDP ports. You need to be very careful with UDP mode as an attacker can forge a port sweep and make you block any number of hosts. Use this option with caution, or not at all if your host is a well-known Internet connected system.</p><p>For the Advanced Stealth Scan Detection (see below) this list is *ignored*</p>
  </dd>
  <dt>
    <p><strong>ADVANCED_PORTS_TCP</strong></p>
  </dt>
  <dd>
    <p>A number indicating the highest port number to monitor down from. Any port *below* this number is then monitored. The default is 1024 (reserved port range), but can be made as large as 65535 (system max). It's recommended going over 1024 with this option.</p>
  </dd>
  <dt>
    <p><strong>ADVANCED_PORTS_UDP</strong></p>
  </dt>
  <dd>
    <p>Same as above, except for UDP.</p>
  </dd>
  <dt>
    <p><strong>ADVANCED_EXCLUDE_TCP</strong></p>
  </dt>
  <dd>
    <p>A comma delimited string of TCP ports that should be manually excluded from monitoring in Advanced mode. These are normally ports that may get hit by mistake by remote clients and shouldn't cause alarms (ident, SSL, etc).</p>
  </dd>
  <dt>
    <p><strong>ADVANCED_EXCLUDE_UDP</strong></p>
  </dt>
  <dd>
    <p>Same as above, except for UDP.</p>
  </dd>
  <dt>
    <p><strong>IGNORE_FILE</strong></p>
  </dt>
  <dd>
    <p>The path to the file that contains IP addresses of hosts you want to always be ignored.</p>
  </dd>
  <dt>
    <p><strong>BLOCKED_FILE</strong></p>
  </dt>
  <dd>
    <p>The path to the file that contains the IP addresses of blocked hosts.</p>
  </dd>
  <dt>
    <p><strong>RESOLVE_HOST - This option turns off DNS resolution for</strong></p>
  </dt>
  <dd>
    <p>hosts. If you have a slow DNS server it may be more effective to turn off resolution.</p>
  </dd>
  <dt>
    <p><strong>BLOCK_UDP</strong></p>
  </dt>
  <dd>
    <p>This option disables all automatic responses to UDP probes. Because UDP can be easily forged, it may allow an attacker to start a denial of service attack against the protected host, causing it to block all manner of hosts that should normally be left alone. Setting this option to "0" will disable all responses, although the connects are still logged. This option is mainly useful for Internet exposed hosts. For internal hosts you should leave this enabled. If someone internally is firing spoofed packets at you, then you have a much bigger problem than a denial of service.</p>
  </dd>
  <dt>
    <p><strong>BLOCK_TCP</strong></p>
  </dt>
  <dd>
    <p>Same as above, but for TCP. Packet forgery is not as big a problem though because PortSentry waits for a full connect to occur and this is much harder to forge in the basic modes. Leave this enabled, even for Internet connected hosts. For stealth scan detection modes the UDP warning applies:</p><p>	An attacker can cause you to block hosts you don't want to 	through packet forgery. I wouldn't worry about this until it is a 	problem, but you should be aware of it.</p>
  </dd>
  <dt>
    <p><strong>KILL_ROUTE</strong></p>
  </dt>
  <dd>
    <p>This is the command to run to drop the offending route(see <a href="../man8/route.8.html"><strong>route</strong>(8)</a>) if an attack is detected. This is the *full path* to the route command along with the necessary parameters to make the command work. The macro <strong>$TARGET$</strong> will be substituted with the attacking host IP and is REQUIRED in this option. Your gateway should be a *dead host* on the local subnet. On some systems though you can just put in the localhost address (127.0.0.1) and this will probably work. All packets from the target host will get routed to this address so don't mess this up. More modern route commands will include a "-blackhole" or "-reject" flag. Check your <a href="../man1/man.1.html"><strong>man</strong>(1)</a> pages and if your route command supports this feature you should use it (although it's recommend using packet filtering instead, see below).</p><p>Also be aware that this creates what is known as an "asynchronous route" which basically means packets enter your host via one route and are sent out on another (dead) route. This works OK for full TCP connect requests, but for UDP and stealth scan modes it still allows packets to activate PortSentry and you may get a series of "already blocked" alarms by PortSentry. For UDP scans this method prevents ICMP messages from returning to the attacker so all ports appear open. However, if the attacker is performing an actual exploit with UDP the drop route method will not work. The asynchronous route allows the packet to hit the system and the attacker could perform a "blind" attack with UDP if they know what the responses are going to be.</p><p>By far the best method is to use the local packet filter (see <strong>ipfwadm</strong>(8), <strong>ipchains</strong>(8), or <a href="../man8/iptables.8.html"><strong>iptables</strong>(8)</a>). This is a much cleaner solution and is detailed in the config file. The macro <strong>$PORT$</strong> will substitute the port that was connected to by the attacker, but this is NOT required for this option. The macro $MODE$ reports what mode the blocking occurred in (tcp, udp, stcp, sudp, atcp, audp) but is also NOT required.</p>
  </dd>
  <dt>
    <p><strong>KILL_HOSTS_DENY</strong></p>
  </dt>
  <dd>
    <p>This is the format of the string to drop into the hosts.deny file that TCP wrappers uses(see <a href="../man5/hosts_access.5.html"><strong>hosts_access</strong>(5)</a>, and <a href="../man5/hosts_options.5.html"><strong>hosts_options</strong>(5)</a>). Again the <strong>$TARGET$</strong> macro is expanded out to be the IP of the attacker and is required. You can also drop in any TCP wrapper escape codes here as well (%h, twist, etc). The macro <strong>$PORT$</strong> will substitute the port that was connected to by the attacker, but this is NOT required for this option. The macro $MODE$ reports what mode the blocking occurred in (tcp, udp, stcp, sudp, atcp, audp) but is also NOT required.</p>
  </dd>
  <dt>
    <p><strong>KILL_RUN_CMD</strong></p>
  </dt>
  <dd>
    <p>This is a command you want run *before* the route is dropped to the attacker. You can put in any program/script you want executed when an attack is detected. WE NEVER RECOMMEND PUTTING IN RETALIATORY ACTION AGAINST AN ATTACKING HOST. Virtually every time you're are port scanned the host doing the scanning has been compromised itself. Therefore, if you retaliate you are probably attacking an innocent(?) party. Also the goal of security is to make the person GO AWAY. You don't want to irritate them into making a personal vendetta against you. Remember, even a 13 year old can run a [insert favorite D.O.S. program here] attack against you from their Windows box to make your life miserable. As above, the <strong>$TARGET$</strong>, <strong>$PORT$</strong> and <strong>$MODE$</strong> macros are available to you but they are not required with this option as above.</p>
  </dd>
  <dt>
    <p><strong>KILL_RUN_CMD_FIRST</strong></p>
  </dt>
  <dd>
    <p>Setting this to "1" makes the command above run before the route is dropped. Setting it to "0" makes the command run aftter the blocking has occurred.</p>
  </dd>
  <dt>
    <p><strong>SCAN_TRIGGER</strong></p>
  </dt>
  <dd>
    <p>PortSentry has a state engine that will remember hosts that connected to it. Setting this value will tell PortSentry to allow X number of grace port hits before it reacts. This will detect both sequential and random port sweeps. The default is 0 which will react immediately. A setting of 1 or 2 will reduce false alarms, anything higher is probably too much as anything more than 3 hits to different ports is pretty suspicious behavior. Usually you can leave this at 0 without any consequence, with the exception of Advanced stealth scan detection modes where you may create a "hair trigger" if you aren't careful. Use your own discretion.</p>
  </dd>
  <dt>
    <p><strong>PORT_BANNER</strong></p>
  </dt>
  <dd>
    <p>A text banner you want displayed to the connecting host if the PortSentry is activated. Leave this commented out if you don't want this feature. If you do use it, try not to taunt the person too badly. It's recommended keeping it professional and to the point. The banner is *not* displayed when stealth scan detection modes are used.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO portsentry.conf&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/portsentry.8.html"><strong>portsentry</strong>(8)</a>,</strong> <a href="../man5/hosts_access.5.html"><strong>hosts_access</strong>(5)</a>,</strong> <a href="../man5/hosts_options.5.html"><strong>hosts_options</strong>(5)</a>,</strong> <a href="../man8/route.8.html"><strong>route</strong>(8)</a>,</strong> <strong>ipfwadm</strong>(8),</strong> <strong>ipchains</strong>(8)</strong></p><p><strong>/usr/share/doc/portsentry/README.install</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p><strong>portsentry</strong> was written by Craig H. Howland <strong>&lt;crowland@users.sf.net&gt;.</strong></p><p>This manual page is essentially just a "cut and paste" from the README.install file and was done by Guido Guenther &lt;agx@debian.org&gt;(hopefully without adding too many errors), for the Debian GNU/Linux system (but may be used by others).</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="polish.5.html"><span aria-hidden="true">&larr;</span> polish.5: A list of polish words</a></li>
   <li class="next"><a href="postconf.5.html">postconf.5: Postfix configuration parameters <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
