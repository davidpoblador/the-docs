<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>kdump-tools: Configuration file for the kdump-tools init script</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Configuration file for the kdump-tools init script">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="kdump-tools (5) manual">
  <meta name="twitter:description" content="Configuration file for the kdump-tools init script">
  <meta name="twitter:image" content="https://www.carta.tech/images/kdump-tools-kdump-tools-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/kdump-tools.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="kdump-tools (5) manual" />
  <meta property="og:description" content="Configuration file for the kdump-tools init script" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/kdump-tools-kdump-tools-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">kdump-tools<small> (5)</small></h1>
        <p class="lead">Configuration file for the kdump-tools init script</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/kdump-tools.5.html">
      <span itemprop="name">kdump-tools: Configuration file for the kdump-tools init script</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/kdump-tools/">
      <span itemprop="name">kdump-tools</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/kdump-tools.5.html">
      <span itemprop="name">kdump-tools: Configuration file for the kdump-tools init script</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>/etc/default/kdump-tools</strong></p>
  </dt>
  <dd>
    
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>kdump-tools</strong> manages the kdump feature of the Linux kernel.  The <em>/etc/default/kdump-tools</em> file contains local configuration settings of kdump.</p><p>This file is sourced into a shell script, so it's format should be consistent with shell scripting.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><strong>USE_KDUMP</strong></p>
  </dt>
  <dd>
    <p>Controls whether or not <strong>kdump-tools</strong> will take any action. If not set or 0, the <strong>kdump-tools</strong> init script will not run.</p>
  </dd>
  <dt>
    <p><strong>KDUMP_SYSCTL</strong></p>
  </dt>
  <dd>
    <p>Controls when a panic occurs, using the <a href="../man8/sysctl.8.html"><strong>sysctl</strong>(8)</a> interface.  Each time a kdump kernel is loaded, &ldquo;<em>sysctl -w $KDUMP_SYSCTL</em>&rdquo; is also executed, thus allowing the system adiminstrator to maintain customizable conditions for a kdump. The contents of this variable should be the &ldquo;<em>variable=value ...</em>&rdquo; portion of the &ldquo;<em>sysctl -w</em>&rdquo; command.  If not set, &ldquo;<em>kernel.panic_on_oops=1</em>&rdquo; will be used.  This feature can be disabled by setting</p><p><strong>KDUMP_SYSCTL=&ldquo; &rdquo;</strong></p><p>See <a href="../man8/sysctl.8.html"><strong>sysctl</strong>(8)</a> for more info.</p>
  </dd>
  <dt>
    <p><strong>KDUMP_KERNEL</strong></p>
  </dt>
  <dd>
    <p>A full pathname to a kdump kernel (the kernel that is kexec'd at crash time in a reserved memory area, exposing the old kernel's memory for dumping).  If not set, <strong>kdump-config</strong> will use the boot kernel as the kdump kernel if it is relocatable; otherwise you must set <strong>KDUMP_KERNEL</strong> in order for <strong>kdump-tools</strong> to work.</p>
  </dd>
  <dt>
    <p><strong>KDUMP_INITRD</strong></p>
  </dt>
  <dd>
    <p>A full pathname to the kdump initrd (if used).  If <em>KDUMP_KERNEL</em> is set and <em>KDUMP_INITRD</em> is not set, a warning message will be printed, and an initrd will not be used.</p>
  </dd>
  <dt>
    <p><strong>KDUMP_COREDIR</strong></p>
  </dt>
  <dd>
    <p>Full path to a directory where the vmcore will be saved. Date stamped subdirectories are created each time a vmcore file is processed. If not set, <em>/var/crash</em> will be used.</p>
  </dd>
  <dt>
    <p><strong>KDUMP_FAIL_CMD</strong></p>
  </dt>
  <dd>
    <p>This variable specifies a command to run if the vmcore save fails. If not set, no special action is taken.</p>
  </dd>
  <dt>
    <p><strong>DEBUG_KERNEL</strong></p>
  </dt>
  <dd>
    <p>A debug version of the running kernel.  If not set, <strong>kdump-config</strong> will use /usr/lib/debug/vmlinux-$(uname-r) if it exists.  Otherwise, kdump will still work, but the dump will take longer and will be much larger.</p>
  </dd>
  <dt>
    <p><strong>MAKEDUMP_ARGS</strong></p>
  </dt>
  <dd>
    <p>Extra arguments passed to <a href="../man8/makedumpfile.8.html"><strong>makedumpfile</strong>(8)</a>. If not set, &ldquo;<em>-c -d 31</em>&rdquo; will be used.  This tells makedumpfile to use compression, and reduce the corefile to in-use kernel pages only.  See <a href="../man8/makedumpfile.8.html"><strong>makedumpfile</strong>(8)</a> for details.</p>
  </dd>
  <dt>
    <p><strong>KDUMP_KEXEC_ARGS</strong></p>
  </dt>
  <dd>
    <p>Additional arguments to the kexec command used to load the kdump kernel.</p>
  </dd>
  <dt>
    <p><strong>KDUMP_CMDLINE</strong></p>
  </dt>
  <dd>
    <p>Normally, the current kernel commandline is obtained from <em>/proc/cmdline</em>. Set this variable to override <em>/proc/cmdline</em>.</p>
  </dd>
  <dt>
    <p><strong>KDUMP_CMDLINE_APPEND</strong></p>
  </dt>
  <dd>
    <p>Additional arguments to append to the command line for the kdump kernel. If not set, &ldquo;<em>irqpoll maxcpus=1 nousb</em>&rdquo; will be used.</p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">USAGE</h2>
        <div class="sectioncontent">
<p><strong>kdump-tools</strong> is as automated as can be at this point but there are some prerequisites to using it.  Additionally, some manual configuration is still required.</p><h3>Manual Configuration</h3>

<dl class='dl-vertical'>
  <dt>
    1.
  </dt>
  <dd>
    <p><strong>USE_KDUMP</strong> is set to 0 by default.  To enable <strong>kdump-tools</strong>, edit the <em>/etc/default/kdump-tools</em> configuration file and set <strong>USE_KDUMP=1</strong>.</p>
  </dd>
  <dt>
    2.
  </dt>
  <dd>
    <p><strong>Kernel Command line parameters</strong> - the kernel must be booted with a <em>crashkernel</em>= command line parameter.  Some example crashkernel parameters:</p>
<pre>
    ia64:       <em>crashkernel=384M</em>
    x86:        <em>crashkernel=128M</em>
    x86_64:     <em>crashkernel=256M</em>
</pre>
<p>Some users may also want to add <em>nmi_watchdog=1</em> on certain systems.  The nmi watchdog will cause the kernel to panic (and kdump) if a system hang is detected.</p><p>The kernel command line parameter is generally set in one of these files: <em>/etc/default/grub</em>, <em>/boot/grub/menu.lst</em>, <em>/etc/elilo.conf</em>, or <em>/etc/lilo.conf</em>. If the command line parameter is changed, a reboot is required in order for it to take effect.</p>
  </dd>
  <dt>
    3.
  </dt>
  <dd>
    <p><strong>Architectural considerations</strong></p>
<dl class='dl-vertical'>
  <dt>
    A)
  </dt>
  <dd>
    <p><strong></strong> x86 && PAE && memory &gt; 4 Gigabytes - use <em></em> KDUMP_KEXEC_ARGS="--elf64-core-headers"</p>
  </dd>
  <dt>
    B)
  </dt>
  <dd>
    <p><strong></strong> x86 and x86_64 - Some systems can take advantage of the nmi watchdog.  Add <em></em> nmi_watchdog=1 to the boot commandline to turn on the watchdog. The nmi interrupt will call panic if activated.</p>
  </dd>
  <dt>
    C)
  </dt>
  <dd>
    <p><strong></strong> ia64 - Some systems may need <em>KDUMP_KEXEC_ARGS="--noio"</em>. Use this if the system hangs after a panic, but before the kdump kernel begins to boot.</p>
  </dd>

</dl>

  </dd>

</dl>

<h3>Prerequisites</h3>

<dl class='dl-vertical'>
  <dt>
    1.
  </dt>
  <dd>
    <p><strong>Boot Kernel Configuration</strong> - The boot kernel must be configured with <em>CONFIG_KEXEC=y</em> and, if it is also to be used as the kdump kernel, <em>CONFIG_CRASHDUMP=y</em>.</p><p>For ia64, only makedumpfile level 1 will work if the memory model selected is <em>CONFIG_DISCONTIG</em>. <em>CONFIG_SPARSEMEM</em> is recommended instead.</p>
  </dd>
  <dt>
    2.
  </dt>
  <dd>
    <p><strong>Kdump Kernel Configuration</strong> - The kdump kernel must be relocated or relocatable.  ia64 is relocatable by default, but x86, x86_64, and powerpc must be built with <em>CONFIG_RELOCATABLE=y</em>. Other architectures may require a predermined start location via <em>CONFIG_PHYSICAL_START</em>. If the boot kernel is relocatable, <strong>kdump-tools</strong> will automatically use that kernel. Otherwise, a relocatable or relocated kernel will need to be provided. The kdump kernel can be specified in the <em>/etc/default/kdump-tools</em> file. Set the <strong>KDUMP_KERNEL</strong> variable and if necessary the <strong>KDUMP_INITRD</strong> variable to point to the provided kernel and its initrd.</p><p>The kdump kernel must be configured with: <strong>CONFIG_CRASH_DUMP=y</strong></p>
  </dd>
  <dt>
    3.
  </dt>
  <dd>
    <p><strong>Debug Kernel</strong> - An uncompressed debug kernel <em>should</em> be provided in order for makedumpfile to process the vmcore file. Without a debug kernel, the transfer process is reduced to using &ldquo;<em>makedumpfile -c -d 1</em>&rdquo;. If <em>/usr/lib/debug/vmlinux-$(uname -r)</em> exists, <strong>kdump-tools</strong> will automatically use that kernel.</p><p>Otherwise, A) set <strong>DEBUG_KERNEL</strong> in <em>/etc/default/kdump-tools</em> to point to a debug version of the currently booted kernel or B) do without - makedumpfile will still work, but the dumpfile will be larger and take longer to save to disk.</p>
  </dd>

</dl>


        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLES</h2>
        <div class="sectioncontent">
<p>Also panic and kdump on oom:</p><p>KDUMP_SYSCTL="kernel.panic_on_oops=1 vm.panic_on_oom=1"</p><p>Use this option on x86 systems with PAE and more than 4 gig of memory:</p><p>KDUMP_KEXEC_ARGS="--elf64-core-headers"</p><p>This option starts a shell if <strong>kdump-tools</strong> cannot save the vmcore file:</p><p>KDUMP_FAIL_CMD="/bin/bash; reboot -f"</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">

<dl class='dl-vertical'>
  <dt>
    <p><em>/etc/init.d/kdump-tools</em></p>
  </dt>
  <dd>
    <p>an init script to automatically load a kdump kernel, or save a vmcore and reboot.</p>
  </dd>
  <dt>
    <p><em>/etc/default/kdump-tools</em></p>
  </dt>
  <dd>
    <p>the <strong>kdump-tools</strong> configuration file</p>
  </dd>
  <dt>
    <p><em>/var/crash/kernel_link</em></p>
  </dt>
  <dd>
    <p>a link to the current debug kernel</p>
  </dd>
  <dt>
    <p><em>/var/crash/kexec_cmd</em></p>
  </dt>
  <dd>
    <p>the last kexec_cmd executed by <strong>kdump-config</strong></p>
  </dd>

</dl>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DIAGNOSTICS</h2>
        <div class="sectioncontent">
<p>See <a href="../man8/kdump-config.8.html"><strong>kdump-config</strong>(8)</a> for explanations of various error messages.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO kdump-tools&hellip;</h2>
        <div class="sectioncontent">
<p><em>/usr/share/doc/kdump-tools/README</em></p><p><em>/usr/share/doc/kdump-tools/README.Debian</em></p><p><a href="../man8/kdump-config.8.html"><strong>kdump-config</strong>(8)</a>, <a href="../man8/kexec.8.html"><strong>kexec</strong>(8)</a>, <a href="../man8/sysctl.8.html"><strong>sysctl</strong>(8)</a>, <a href="../man8/makedumpfile.8.html"><strong>makedumpfile</strong>(8)</a>, <a href="../man8/crash.8.html"><strong>crash</strong>(8)</a>, <strong>gdb</strong>(1),</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHOR</h2>
        <div class="sectioncontent">
<p>Terry Loftin &lt;terry.loftin@hp.com&gt;</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="kdm.options.5.html"><span aria-hidden="true">&larr;</span> kdm.options.5: Configuration options for x display manager</a></li>
   <li class="next"><a href="keepalived.conf.5.html">keepalived.conf.5: Configuration file for keepalived <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
