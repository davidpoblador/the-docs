<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>plugin-runner.conf: Run mandos plugins, pass data from first to succeed.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Run mandos plugins, pass data from first to succeed.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="plugin-runner.conf (5mandos) manual">
  <meta name="twitter:description" content="Run mandos plugins, pass data from first to succeed.">
  <meta name="twitter:image" content="https://www.carta.tech/images/mandos-client-plugin-runner.conf-5mandos.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5mandos/plugin-runner.conf.5mandos.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="plugin-runner.conf (5mandos) manual" />
  <meta property="og:description" content="Run mandos plugins, pass data from first to succeed." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/mandos-client-plugin-runner.conf-5mandos.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">plugin-runner.conf<small> (5mandos)</small></h1>
        <p class="lead">Run mandos plugins, pass data from first to succeed.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5mandos/">
      <span itemprop="name">MISSING SECTION</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5mandos/plugin-runner.conf.5mandos.html">
      <span itemprop="name">plugin-runner.conf: Run mandos plugins, pass data from first to succeed.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/mandos-client/">
      <span itemprop="name">mandos-client</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5mandos/plugin-runner.conf.5mandos.html">
      <span itemprop="name">plugin-runner.conf: Run mandos plugins, pass data from first to succeed.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">SYNOPSIS</h2>
        <div class="sectioncontent">
<p><strong>plugin-runner</strong> [<strong>--global-env=</strong><strong></strong><em>ENV</em><strong>=</strong><strong></strong><em>value</em> | <strong>-G&nbsp;</strong><strong></strong><em>ENV</em><strong>=</strong><strong></strong><em>value</em><strong>&nbsp;</strong>...]</p><p>[<strong>--env-for=</strong><strong></strong><em>PLUGIN</em><strong>:</strong><strong></strong><em>ENV</em><strong>=</strong><strong></strong><em>value</em> | <strong>-E</strong><strong></strong><em>&nbsp;PLUGIN</em><strong>:</strong><strong></strong><em>ENV</em><strong>=</strong><strong></strong><em>value</em><strong>&nbsp;</strong>...]</p><p>[<strong>--global-options=</strong><strong></strong><em>OPTIONS</em> | <strong>-g</strong><strong></strong><em>&nbsp;OPTIONS</em><strong>&nbsp;</strong>...]</p><p>[<strong>--options-for=</strong><strong></strong><em>PLUGIN</em><strong>:</strong><strong></strong><em>OPTIONS</em> | <strong>-o</strong><strong></strong><em>&nbsp;PLUGIN</em><strong>:</strong><strong></strong><em>OPTIONS</em><strong>&nbsp;</strong>...]</p><p>[<strong>--disable=</strong><strong></strong><em>PLUGIN</em> | <strong>-d&nbsp;</strong><strong></strong><em>PLUGIN</em><strong>&nbsp;</strong>...]</p><p>[<strong>--enable=</strong><strong></strong><em>PLUGIN</em> | <strong>-e&nbsp;</strong><strong></strong><em>PLUGIN</em><strong>&nbsp;</strong>...]</p><p>[<strong>--groupid=</strong><strong></strong><em>ID</em>]</p><p>[<strong>--userid=</strong><strong></strong><em>ID</em>]</p><p>[<strong>--plugin-dir=</strong><strong></strong><em>DIRECTORY</em>]</p><p>[<strong>--config-file=</strong><strong></strong><em>FILE</em>]</p><p>[<strong>--debug</strong>] <strong>plugin-runner</strong> {<strong>--help</strong> | <strong>-?</strong>} <strong>plugin-runner</strong> <strong>--usage</strong> <strong>plugin-runner</strong> {<strong>--version</strong> | <strong>-V</strong>}</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p><strong>plugin-runner</strong> is a program which is meant to be specified as a &ldquo;keyscript&rdquo; for the root disk in <a href="../man5/crypttab.5.html"><strong>crypttab</strong>(5)</a>. The aim of this program is therefore to output a password, which then <a href="../man8/cryptsetup.8.html"><strong>cryptsetup</strong>(8)</a> will use to unlock the root disk.</p><p>This program is not meant to be invoked directly, but can be in order to test it. Note that any password obtained will simply be output on standard output.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PURPOSE</h2>
        <div class="sectioncontent">
<p>The purpose of this is to enable <em>remote and unattended rebooting</em> of client host computer with an <em>encrypted root file system</em>. See the section called &ldquo;OVERVIEW&rdquo; for details.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OPTIONS</h2>
        <div class="sectioncontent">
<p><strong>--global-env </strong><strong></strong><em>ENV</em><strong>=</strong><strong></strong><em>value</em>, <strong>-G </strong><strong></strong><em>ENV</em><strong>=</strong><strong></strong><em>value</em></p><p>This option will add an environment variable setting to all plugins. This will override any inherited environment variable.</p><p><strong>--env-for </strong><strong></strong><em>PLUGIN</em><strong>:</strong><strong></strong><em>ENV</em><strong>=</strong><strong></strong><em>value</em>, <strong>-E </strong><strong></strong><em>PLUGIN</em><strong>:</strong><strong></strong><em>ENV</em><strong>=</strong><strong></strong><em>value</em></p><p>This option will add an environment variable setting to the <em>PLUGIN</em> plugin. This will override any inherited environment variables or environment variables specified using <strong>--global-env</strong>.</p><p><strong>--global-options </strong><strong></strong><em>OPTIONS</em>, <strong>-g </strong><strong></strong><em>OPTIONS</em></p><p>Pass some options to <em>all</em> plugins. <em>OPTIONS</em> is a comma separated list of options. This is not a very useful option, except for specifying the &ldquo;<strong>--debug</strong>&rdquo; option to all plugins.</p><p><strong>--options-for </strong><strong></strong><em>PLUGIN</em><strong>:</strong><strong></strong><em>OPTION</em>, <strong>-o </strong><strong></strong><em>PLUGIN</em><strong>:</strong><strong></strong><em>OPTION</em></p><p>Pass some options to a specific plugin. <em>PLUGIN</em> is the name (file basename) of a plugin, and <em>OPTIONS</em> is a comma separated list of options.</p><p>Note that since options are not split on whitespace, the way to pass, to the plugin &ldquo;foo&rdquo;, the option <strong>--bar</strong> with the option argument &ldquo;baz&rdquo; is either <strong>--options-for=foo:--bar=baz</strong> or <strong>--options-for=foo:--bar,baz</strong>. Using <strong>--options-for="foo:--bar baz"</strong>. will <em>not</em> work.</p><p><strong>--disable </strong><strong></strong><em>PLUGIN</em>, <strong>-d </strong><strong></strong><em>PLUGIN</em></p><p>Disable the plugin named <em>PLUGIN</em>. The plugin will not be started.</p><p><strong>--enable </strong><strong></strong><em>PLUGIN</em>, <strong>-e </strong><strong></strong><em>PLUGIN</em></p><p>Re-enable the plugin named <em>PLUGIN</em>. This is only useful to undo a previous <strong>--disable</strong> option, maybe from the configuration file.</p><p><strong>--groupid </strong><strong></strong><em>ID</em></p><p>Change to group ID <em>ID</em> on startup. The default is 65534. All plugins will be started using this group ID. <em>Note:</em> This must be a number, not a name.</p><p><strong>--userid </strong><strong></strong><em>ID</em></p><p>Change to user ID <em>ID</em> on startup. The default is 65534. All plugins will be started using this user ID. <em>Note:</em> This must be a number, not a name.</p><p><strong>--plugin-dir </strong><strong></strong><em>DIRECTORY</em></p><p>Specify a different plugin directory. The default is /lib/mandos/plugins.d, which will exist in the initial RAM disk environment.</p><p><strong>--config-file </strong><strong></strong><em>FILE</em></p><p>Specify a different file to read additional options from. See the section called &ldquo;FILES&rdquo;. Other command line options will override options specified in the file.</p><p><strong>--debug</strong></p><p>Enable debug mode. This will enable a lot of output to standard error about what the program is doing. The program will still perform all other functions normally. The default is to <em>not</em> run in debug mode.</p><p>The plugins will <em>not</em> be affected by this option. Use <strong></strong><strong>--global-options=--debug</strong> if complete debugging eruption is desired.</p><p><strong>--help</strong>, <strong>-?</strong></p><p>Gives a help message about options and their meanings.</p><p><strong>--usage</strong></p><p>Gives a short usage message.</p><p><strong>--version</strong>, <strong>-V</strong></p><p>Prints the program version.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">OVERVIEW</h2>
        <div class="sectioncontent">
<p>This is part of the Mandos system for allowing computers to have encrypted root file systems and at the same time be capable of remote and/or unattended reboots. The computers run a small client program in the initial RAM disk environment which will communicate with a server over a network. All network communication is encrypted using TLS. The clients are identified by the server using an OpenPGP key; each client has one unique to it. The server sends the clients an encrypted password. The encrypted password is decrypted by the clients using the same OpenPGP key, and the password is then used to unlock the root file system, whereupon the computers can continue booting normally.</p><p>This program will run on the client side in the initial RAM disk environment, and is responsible for getting a password. It does this by running plugins, one of which will normally be the actual client program communicating with the server.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">PLUGINS</h2>
        <div class="sectioncontent">
<p>This program will get a password by running a number of plugins, which are simply executable programs in a directory in the initial RAM disk environment. The default directory is /lib/mandos/plugins.d, but this can be changed with the <strong>--plugin-dir</strong> option. The plugins are started in parallel, and the first plugin to output a password <em>and</em> exit with a successful exit code will make this plugin-runner output the password from that plugin, stop any other plugins, and exit.</p><h3>WRITING PLUGINS</h3>
<p>A plugin is simply a program which prints a password to its standard output and then exits with a successful (zero) exit status. If the exit status is not zero, any output on standard output will be ignored by the plugin runner. Any output on its standard error channel will simply be passed to the standard error of the plugin runner, usually the system console.</p><p>If the password is a single-line, manually entered passprase, a final trailing newline character should <em>not</em> be printed.</p><p>The plugin will run in the initial RAM disk environment, so care must be taken not to depend on any files or running services not available there.</p><p>The plugin must exit cleanly and free all allocated resources upon getting the TERM signal, since this is what the plugin runner uses to stop all other plugins when one plugin has output a password and exited cleanly.</p><p>The plugin must not use resources, like for instance reading from the standard input, without knowing that no other plugin is also using it.</p><p>It is useful, but not required, for the plugin to take the <strong>--debug</strong> option.</p>

        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FALLBACK</h2>
        <div class="sectioncontent">
<p>If no plugins succeed, this program will, as a fallback, ask for a password on the console using <a href="../man3/getpass.3.html"><strong>getpass</strong>(3)</a>, and output it. This is not meant to be the normal mode of operation, as there is a separate plugin for getting a password from the console.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXIT STATUS</h2>
        <div class="sectioncontent">
<p>Exit status of this program is zero if no errors were encountered, and otherwise not. The fallback (see the section called &ldquo;FALLBACK&rdquo;) may or may not have succeeded in either case.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">ENVIRONMENT</h2>
        <div class="sectioncontent">
<p>This program does not use any environment variables itself, it only passes on its environment to all the plugins. The environment passed to plugins can be modified using the <strong>--global-env</strong> and <strong>--env-for</strong> options.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">FILES</h2>
        <div class="sectioncontent">
<p>/conf/conf.d/mandos/plugin-runner.conf</p><p>Since this program will be run as a keyscript, there is little to no opportunity to pass command line arguments to it. Therefore, it will <em>also</em> read this file and use its contents as whitespace-separated command line options. Also, everything from a &ldquo;#&rdquo; character to the end of a line is ignored.</p><p>This program is meant to run in the initial RAM disk environment, so that is where this file is assumed to exist. The file does not need to exist in the normal file system.</p><p>This file will be processed <em>before</em> the normal command line options, so the latter can override the former, if need be.</p><p>This file name is the default; the file to read for arguments can be changed using the <strong>--config-file</strong> option.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">BUGS</h2>
        <div class="sectioncontent">
<p>The <strong>--config-file</strong> option is ignored when specified from within a configuration file.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">EXAMPLE</h2>
        <div class="sectioncontent">
<p>Normal invocation needs no options:</p><p><strong>plugin-runner</strong></p><p>Run the program, but not the plugins, in debug mode:</p><p><strong>plugin-runner --debug</strong></p><p>Run all plugins, but run the &ldquo;foo&rdquo; plugin in debug mode:</p><p><strong>plugin-runner --options-for=foo:--debug</strong></p><p>Run all plugins, but not the program, in debug mode:</p><p><strong>plugin-runner --global-options=--debug</strong></p><p>Run plugins from a different directory, read a different configuration file, and add two options to the <strong>mandos-client</strong>(8mandos) plugin:</p><p><strong>cd /etc/keys/mandos; plugin-runner --config-file=/etc/mandos/plugin-runner.conf --plugin-dir /usr/lib/mandos/plugins.d --options-for=mandos-client:--pubkey=pubkey.txt,--seckey=seckey.txt</strong></p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">SECURITY</h2>
        <div class="sectioncontent">
<p>This program will, when starting, try to switch to another user. If it is started as root, it will succeed, and will by default switch to user and group 65534, which are assumed to be non-privileged. This user and group is then what all plugins will be started as. Therefore, the only way to run a plugin as a privileged user is to have the set-user-ID or set-group-ID bit set on the plugin executable file (see <a href="../man2/execve.2.html"><strong>execve</strong>(2)</a>).</p><p>If this program is used as a keyscript in <a href="../man5/crypttab.5.html"><strong>crypttab</strong>(5)</a>, there is a slight risk that if this program fails to work, there might be no way to boot the system except for booting from another media and editing the initial RAM disk image to not run this program. This is, however, unlikely, since the <strong>password-prompt</strong>(8mandos) plugin will read a password from the console in case of failure of the other plugins, and this plugin runner will also, in case of catastrophic failure, itself fall back to asking and outputting a password on the console (see the section called &ldquo;FALLBACK&rdquo;).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO plugin-runner.conf&hellip;</h2>
        <div class="sectioncontent">
<p><strong>intro</strong>(8mandos), <a href="../man8/cryptsetup.8.html"><strong>cryptsetup</strong>(8)</a>, <a href="../man5/crypttab.5.html"><strong>crypttab</strong>(5)</a>, <a href="../man2/execve.2.html"><strong>execve</strong>(2)</a>, <strong>mandos</strong>(8), <strong>password-prompt</strong>(8mandos), <strong>mandos-client</strong>(8mandos)</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">COPYRIGHT</h2>
        <div class="sectioncontent">
<p>Copyright &copy; 2008-2009, 2012 Teddy Hogeborn, Bj\(:orn P\(oahlsson</p><p>This manual page is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p><p>This manual page is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p><p>You should have received a copy of the GNU General Public License along with this program. If not, see \m[blue]<strong>http://www.gnu.org/licenses/</strong>\m[].</p>
        </div>
      </section>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
