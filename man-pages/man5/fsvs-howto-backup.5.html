<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>fsvs-howto-backup: This document is a step-by-step explanation how to do backups using fsvs. this document is a step-by-step explanation how to do backups using fsvs.</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="This document is a step-by-step explanation how to do backups using fsvs. this document is a step-by-step explanation how to do backups using fsvs.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="fsvs-howto-backup (5) manual">
  <meta name="twitter:description" content="This document is a step-by-step explanation how to do backups using fsvs. this document is a step-by-step explanation how to do backups using fsvs.">
  <meta name="twitter:image" content="https://www.carta.tech/images/fsvs-fsvs-howto-backup-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/fsvs-howto-backup.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="fsvs-howto-backup (5) manual" />
  <meta property="og:description" content="This document is a step-by-step explanation how to do backups using fsvs. this document is a step-by-step explanation how to do backups using fsvs." />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/fsvs-fsvs-howto-backup-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">fsvs-howto-backup<small> (5)</small></h1>
        <p class="lead">This document is a step-by-step explanation how to do backups using fsvs. this document is a step-by-step explanation how to do backups using fsvs.</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/fsvs-howto-backup.5.html">
      <span itemprop="name">fsvs-howto-backup: This document is a step-by-step explanation how to do backups using fsvs. this document is a step-by-step explanation how to do backups using fsvs.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/fsvs/">
      <span itemprop="name">fsvs</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/fsvs-howto-backup.5.html">
      <span itemprop="name">fsvs-howto-backup: This document is a step-by-step explanation how to do backups using fsvs. this document is a step-by-step explanation how to do backups using fsvs.</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">Preparation</h2>
        <div class="sectioncontent">
<p>If you're going to back up your system, you have to decide what you want to have stored in your backup, and what should be left out.</p><p>Depending on your system usage and environment you first have to decide:</p>
<dl class='dl-vertical'>
  <dt>
    *
  </dt>
  <dd>
    <p>Do you only want to backup your data in /home?</p>
  </dd>
  <dt>
      &bull;
  </dt>
  <dd>
    <p>Less storage requirements</p>
  </dd>
  <dt>
      &bull;
  </dt>
  <dd>
    <p>In case of hardware crash the OS must be set up again</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    *
  </dt>
  <dd>
    <p>Do you want to keep track of your configuration in /etc?</p>
  </dd>
  <dt>
      &bull;
  </dt>
  <dd>
    <p>Very small storage overhead</p>
  </dd>
  <dt>
      &bull;
  </dt>
  <dd>
    <p>Not much use for backup/restore, but shows what has been changed</p>
  </dd>

</dl>

<dl class='dl-vertical'>
  <dt>
    *
  </dt>
  <dd>
    <p>Or do you want to backup your whole installation, from / on?</p>
  </dd>
  <dt>
      &bull;
  </dt>
  <dd>
    <p>Whole system versioned, restore is only a few commands</p>
  </dd>
  <dt>
      &bull;
  </dt>
  <dd>
    <p>Much more storage space needed - typically you'd need at least a few GB free space.</p>
  </dd>

</dl>
<p>The next few moments should be spent thinking about the storage space for the repository - will it be on the system harddisk, a secondary or an external harddisk, or even off-site?</p><p><strong>Note:</strong></p><p>If you just created a fresh repository, you probably should create the 'default' directory structure for subversion - trunk, branches, tags; this layout might be useful for your backups.</p><p> The URL you'd use in fsvs would go to trunk.</p><p>Possibly you'll have to take the available bandwidth into your considerations; a single home directory may be backed up on a 56k modem, but a complete system installation would likely need at least some kind of DSL or LAN.</p><p><strong>Note:</strong></p><p>If this is a production box with sparse, small changes, you could take the initial backup on a local harddisk, transfer the directory with some media to the target machine, and switch the URLs.</p><p>A fair bit of time should go to a small investigation which file patterns and paths you <strong>not</strong> want to back-up.</p><ul>
<li><p>Backup files like *.bak, *~, *.tmp, and similar</p></li><li><p>History files: .sh-history and similar in the home-directories</p></li><li><p>Cache directories: your favourite browser might store many MB of cached data in you home-directories</p></li><li><p>Virtual system directories, like /proc and /sys, /dev/shmfs.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Telling FSVS what to do</h2>
        <div class="sectioncontent">
<p>Given $WC as the <em>working directory</em> - the base of the data you'd like backed up (/<em>, /home</em>), and $URL<em> as a valid subversion URL to your (already created) repository path.</em></p><p>Independent of all these details the first steps look like these:</p>
<pre>
         cd $WC
         fsvs urls $URL

</pre>
<p> Now you have to say what should be ignored - that'll differ depending on your needs/wishes.</p>
<pre>
         fsvs ignore './**~' './**.tmp' './**.bak'
         fsvs ignore ./proc/ ./sys/ ./tmp/
         fsvs ignore ./var/tmp/ ./var/spool/lpd/
         fsvs ignore './var/log/*.gz'
         fsvs ignore ./var/run/ /dev/pts/
         fsvs ignore './etc/*.dpkg-dist' './etc/*.dpkg-new'
         fsvs ignore './etc/*.dpkg-old' './etc/*.dpkg-bak'

</pre>
<p><strong>Note:</strong></p><p>/var/run is for transient files; I've heard reports that <strong>reverting</strong> files there can cause problems with running programs.</p><p> Similar for /dev/pts - if that's a devpts filesystem, you'll run into problems on <strong>update</strong> or <strong>revert</strong> - as FSVS won't be allowed to create entries in this directory.</p><p>Now you may find that you'd like to have some files encrypted in your backup - like /etc/shadow, or your .ssh/id_* files. So you tell fsvs to en/decrypt these files:</p>
<pre>
         fsvs propset fsvs:commit-pipe 'gpg -er {your backup key}' /etc/shadow /etc/gshadow
         fsvs propset fsvs:update-pipe 'gpg -d' /etc/shadow /etc/gshadow

</pre>
<p><strong>Note:</strong></p><p>This are just examples. You'll probably have to exclude some other paths and patterns from your backup, and mark some others as to-be-filtered.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">The first backup</h2>
        <div class="sectioncontent">

<pre>
        fsvs commit -m 'First commit.'
</pre>
<p> That's all there is to it!</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Further use and maintenance</h2>
        <div class="sectioncontent">
<p>The further usage is more or less the commit command from the last section.</p><p> When do you have to do some manual work?</p>
<dl class='dl-vertical'>
  <dt>
    *
  </dt>
  <dd>
    <p>When ignore patterns change.</p>
  </dd>
  <dt>
      &bull;
  </dt>
  <dd>
    <p>New filesystems that should be ignored, or would be ignored but shouldn't</p>
  </dd>
  <dt>
      &bull;
  </dt>
  <dd>
    <p>You find that your favorite word-processor leaves many *.segv files behind, and similar things</p>
  </dd>

</dl>
<ul>
<li><p>If you get an error message from fsvs, check the arguments and retry. In desperate cases (or just because it's quicker than debugging yourself) ask on dev [at] fsvs.tigris.org.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Restoration in a working system</h2>
        <div class="sectioncontent">
<p>Depending on the circumstances you can take different ways to restore data from your repository.</p><ul>
<li><p> 'fsvs export' allows you to just dump some repository data into your filesystem - eg. into a temporary directory to sort things out.</p></li><li><p>Using 'fsvs revert' you can get older revisions of a given file, directory or directory tree inplace.</p></li><li><p>Or you can do a fresh checkout - set an URL in an (empty) directory, and update to the needed revision.</p></li><li><p>If everything else fails (no backup media with fsvs on it), you can use subversion commands (eg. export) to restore needed parts, and update the rest with fsvs.</p></li>
</ul>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Recovery for a non-booting system</h2>
        <div class="sectioncontent">
<p>In case of a real emergency, when your harddisks crashed or your filesystem was eaten and you have to re-partition or re-format, you should get your system working again by</p><ul>
<li><p>booting from a knoppix or some other Live-CD (with FSVS on it),</p></li><li><p>partition/format as needed,</p></li><li><p>mount your harddisk partitions below eg. /mnt,</p></li><li><p>and then recovering by</p></li>
</ul>
<pre>
      $ cd /mnt
        $ export FSVS_CONF=/etc/fsvs                    # if non-standard
        $ export FSVS_WAA=/var/spool/fsvs           # if non-standard
        $ fsvs checkout -o softroot=/mnt
</pre>
<p>If somebody asks really nice I'd possibly even create a recovery command that deduces the softroot parameter from the current working directory.</p><p>For more information please take a look at <strong>Using an alternate root directory</strong>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Feedback</h2>
        <div class="sectioncontent">
<p>If you've got any questions, ideas, wishes or other feedback, please tell us in the mailing list users [at] fsvs.tigris.org.</p><p>Thank you!</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">Author</h2>
        <div class="sectioncontent">
<p>Generated automatically by Doxygen for fsvs from the source code.</p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="fsvs-groups.5.html"><span aria-hidden="true">&larr;</span> fsvs-groups.5: Patterns are used to define groups for new entries; a group can be used to ignore the given entries, or to automatically set properties when the entry is taken on the entry list. patterns are used to define groups for new entries; a group can be used to ignore the given entries, or to automatically set properties when the entry is taken on the entry list.  so the auto-props are assigned when the entry gets put on the internal list; that happens for the add, prop-set or prop-del, and of course commit commands.   to override the auto-props of some new entry just use the property commands.</a></li>
   <li class="next"><a href="fsvs-howto-master_local.5.html">fsvs-howto-master_local.5: This howto describes how to use a single working copy with multiple repositories. this howto describes how to use a single working copy with multiple repositories.  please read the howto: backup first, to know about basic steps using fsvs. <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
