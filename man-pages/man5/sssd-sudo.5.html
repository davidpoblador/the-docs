<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700&effect=destruction%7Cshadow-multiple" rel="stylesheet" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>sssd-sudo: Configuring sudo with the sssd back end</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/manpage.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Configuring sudo with the sssd back end">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@CartaTech">
  <meta name="twitter:creator" content="@CartaTech">
  <meta name="twitter:title" content="sssd-sudo (5) manual">
  <meta name="twitter:description" content="Configuring sudo with the sssd back end">
  <meta name="twitter:image" content="https://www.carta.tech/images/sssd-common-sssd-sudo-5.png">
  <meta property="og:url" content="https://www.carta.tech/man-pages/man5/sssd-sudo.5.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="sssd-sudo (5) manual" />
  <meta property="og:description" content="Configuring sudo with the sssd back end" />
  <meta property="fb:app_id" content="1241677679199500" />
  <meta property="og:image" content="https://www.carta.tech/images/sssd-common-sssd-sudo-5.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="315" />
</head>
<body>
  <div class="container final">
          <div class="page-header">
        <h1 class="font-effect-destruction">sssd-sudo<small> (5)</small></h1>
        <p class="lead">Configuring sudo with the sssd back end</p>
      </div>

    <ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/">
      <span itemprop="name">Man Pages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/">
      <span itemprop="name">File formats and conventions</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/sssd-sudo.5.html">
      <span itemprop="name">sssd-sudo: Configuring sudo with the sssd back end</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
<ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/">
      <span itemprop="name">Carta.tech</span>
    </a>
    <meta itemprop="position" content="1" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/">
      <span itemprop="name">Packages</span>
    </a>
    <meta itemprop="position" content="2" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/packages/sssd-common/">
      <span itemprop="name">sssd-common</span>
    </a>
    <meta itemprop="position" content="3" />
  </li>
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/man-pages/man5/sssd-sudo.5.html">
      <span itemprop="name">sssd-sudo: Configuring sudo with the sssd back end</span>
    </a>
    <meta itemprop="position" content="4" />
  </li>
</ol>
    
      <section>
        <h2 class="font-effect-shadow-multiple">DESCRIPTION</h2>
        <div class="sectioncontent">
<p>This manual page describes how to configure <strong>sudo</strong>(8) to work with <a href="../man8/sssd.8.html"><strong>sssd</strong>(8)</a> and how SSSD caches sudo rules.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURING SUDO TO COOPERATE WITH SSSD</h2>
        <div class="sectioncontent">
<p>To enable SSSD as a source for sudo rules, add <em>sss</em> to the <em>sudoers</em> entry in <a href="../man5/nsswitch.conf.5.html"><strong>nsswitch.conf</strong>(5)</a>.</p><p>For example, to configure sudo to first lookup rules in the standard <strong>sudoers</strong>(5) file (which should contain rules that apply to local users) and then in SSSD, the nsswitch.conf file should contain the following line:</p>
<pre>
sudoers: files sss
</pre>
<p>More information about configuring the sudoers search order from the nsswitch.conf file as well as information about the LDAP schema that is used to store sudo rules in the directory can be found in <strong>sudoers.ldap</strong>(5).</p><p><em>Note</em>: in order to use netgroups or IPA hostgroups in sudo rules, you also need to correctly set <a href="../man1/nisdomainname.1.html"><strong>nisdomainname</strong>(1)</a> to your NIS domain name (which equals to IPA domain name when using hostgroups).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">CONFIGURING SSSD TO FETCH SUDO RULES</h2>
        <div class="sectioncontent">
<p>All configuration that is needed on SSSD side is to extend the list of <em>services</em> with "sudo" in [sssd] section of <a href="../man5/sssd.conf.5.html"><strong>sssd.conf</strong>(5)</a>. To speed up the LDAP lookups, you can also set search base for sudo rules using <em>ldap_sudo_search_base</em> option.</p><p>The following example shows how to configure SSSD to download sudo rules from an LDAP server.</p>
<pre>
[sssd]
config_file_version = 2
services = nss, pam, sudo
domains = EXAMPLE

[domain/EXAMPLE]
id_provider = ldap
sudo_provider = ldap
ldap_uri = ldap://example.com
ldap_sudo_search_base = ou=sudoers,dc=example,dc=com
</pre>
<p>When the SSSD is configured to use IPA as the ID provider, the sudo provider is automatically enabled. The sudo search base is configured to use the compat tree (ou=sudoers,$DC).</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">THE SUDO RULE CACHING MECHANISM</h2>
        <div class="sectioncontent">
<p>The biggest challenge, when developing sudo support in SSSD, was to ensure that running sudo with SSSD as the data source provides the same user experience and is as fast as sudo but keeps providing the most current set of rules as possible. To satisfy these requirements, SSSD uses three kinds of updates. They are referred to as full refresh, smart refresh and rules refresh.</p><p>The <em>smart refresh</em> periodically downloads rules that are new or were modified after the last update. Its primary goal is to keep the database growing by fetching only small increments that do not generate large amounts of network traffic.</p><p>The <em>full refresh</em> simply deletes all sudo rules stored in the cache and replaces them with all rules that are stored on the server. This is used to keep the cache consistent by removing every rule which was deleted from the server. However, full refresh may produce a lot of traffic and thus it should be run only occasionally depending on the size and stability of the sudo rules.</p><p>The <em>rules refresh</em> ensures that we do not grant the user more permission than defined. It is triggered each time the user runs sudo. Rules refresh will find all rules that apply to this user, check their expiration time and redownload them if expired. In the case that any of these rules are missing on the server, the SSSD will do an out of band full refresh because more rules (that apply to other users) may have been deleted.</p><p>If enabled, SSSD will store only rules that can be applied to this machine. This means rules that contain one of the following values in <em>sudoHost</em> attribute:</p><p>keyword ALL</p><p>wildcard</p><p>netgroup (in the form "+netgroup")</p><p>hostname or fully qualified domain name of this machine</p><p>one of the IP addresses of this machine</p><p>one of the IP addresses of the network (in the form "address/mask")</p><p>There are many configuration options that can be used to adjust the behavior. Please refer to "ldap_sudo_*" in <a href="../man5/sssd-ldap.5.html"><strong>sssd-ldap</strong>(5)</a> and "sudo_*" in <a href="../man5/sssd.conf.5.html"><strong>sssd.conf</strong>(5)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">RELATED TO sssd-sudo&hellip;</h2>
        <div class="sectioncontent">
<p><a href="../man8/sssd.8.html"><strong>sssd</strong>(8)</a>, <a href="../man5/sssd.conf.5.html"><strong>sssd.conf</strong>(5)</a>, <a href="../man5/sssd-ldap.5.html"><strong>sssd-ldap</strong>(5)</a>, <a href="../man5/sssd-krb5.5.html"><strong>sssd-krb5</strong>(5)</a>, <a href="../man5/sssd-simple.5.html"><strong>sssd-simple</strong>(5)</a>, <a href="../man5/sssd-ipa.5.html"><strong>sssd-ipa</strong>(5)</a>, <a href="../man5/sssd-ad.5.html"><strong>sssd-ad</strong>(5)</a>, <a href="../man5/sssd-sudo.5.html"><strong>sssd-sudo</strong>(5)</a>,<a href="../man8/sss_cache.8.html"><strong>sss_cache</strong>(8)</a>, <a href="../man8/sss_debuglevel.8.html"><strong>sss_debuglevel</strong>(8)</a>, <a href="../man8/sss_groupadd.8.html"><strong>sss_groupadd</strong>(8)</a>, <a href="../man8/sss_groupdel.8.html"><strong>sss_groupdel</strong>(8)</a>, <a href="../man8/sss_groupshow.8.html"><strong>sss_groupshow</strong>(8)</a>, <a href="../man8/sss_groupmod.8.html"><strong>sss_groupmod</strong>(8)</a>, <a href="../man8/sss_useradd.8.html"><strong>sss_useradd</strong>(8)</a>, <a href="../man8/sss_userdel.8.html"><strong>sss_userdel</strong>(8)</a>, <a href="../man8/sss_usermod.8.html"><strong>sss_usermod</strong>(8)</a>, <a href="../man8/sss_obfuscate.8.html"><strong>sss_obfuscate</strong>(8)</a>, <a href="../man8/sss_seed.8.html"><strong>sss_seed</strong>(8)</a>, <a href="../man8/sssd_krb5_locator_plugin.8.html"><strong>sssd_krb5_locator_plugin</strong>(8)</a>, <strong>sss_ssh_authorizedkeys</strong>(8), <strong>sss_ssh_knownhostsproxy</strong>(8),<a href="../man5/sssd-ifp.5.html"><strong>sssd-ifp</strong>(5)</a>,<a href="../man8/pam_sss.8.html"><strong>pam_sss</strong>(8)</a>.</p>
        </div>
      </section>

      <section>
        <h2 class="font-effect-shadow-multiple">AUTHORS</h2>
        <div class="sectioncontent">
<p><strong>The SSSD upstream - http://fedorahosted.org/sssd</strong></p>
        </div>
      </section>
<nav>
  <ul class="pager">
   <li class="previous"><a href="sssd-simple.5.html"><span aria-hidden="true">&larr;</span> sssd-simple.5: The configuration file for sssds simple access-control provider</a></li>
   <li class="next"><a href="sssd.conf.5.html">sssd.conf.5: The configuration file for sssd <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>

  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60781387-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
